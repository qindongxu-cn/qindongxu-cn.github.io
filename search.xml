<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>æœ‰è¨€é¡¹ç›®ç†Ÿæ‚‰</title>
      <link href="/2025/12/09/you-yan-xiang-mu-shou-xi/"/>
      <url>/2025/12/09/you-yan-xiang-mu-shou-xi/</url>
      
        <content type="html"><![CDATA[<h1 id="æœ‰è¨€é¡¹ç›®ç†Ÿæ‚‰"><a href="#æœ‰è¨€é¡¹ç›®ç†Ÿæ‚‰" class="headerlink" title="æœ‰è¨€é¡¹ç›®ç†Ÿæ‚‰"></a>æœ‰è¨€é¡¹ç›®ç†Ÿæ‚‰</h1><p><strong>Youyan Multi é¡¹ç›®æŠ€æœ¯æ‰‹å†Œ</strong></p><p>ç‰ˆæœ¬ï¼šv1.0.0</p><p>æ›´æ–°æ—¥æœŸï¼š2025-10-30</p><p>é€‚ç”¨äººå‘˜ï¼šå‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆ</p><h2 id="ğŸ“‹-ç›®å½•"><a href="#ğŸ“‹-ç›®å½•" class="headerlink" title="ğŸ“‹ ç›®å½•"></a>ğŸ“‹ ç›®å½•</h2><ul><li><a href="#é¡¹ç›®æ¦‚è§ˆ">é¡¹ç›®æ¦‚è§ˆ</a></li><li><a href="#æŠ€æœ¯æ ˆ">æŠ€æœ¯æ ˆ</a></li><li><a href="#é¡¹ç›®æ¶æ„">é¡¹ç›®æ¶æ„</a></li><li><a href="#å¼€å‘ç¯å¢ƒé…ç½®">å¼€å‘ç¯å¢ƒé…ç½®</a></li><li><a href="#ä»£ç è§„èŒƒ">ä»£ç è§„èŒƒ</a></li><li><a href="#æ ¸å¿ƒæ¨¡å—è¯´æ˜">æ ¸å¿ƒæ¨¡å—è¯´æ˜</a></li><li><a href="#å¼€å‘æµç¨‹">å¼€å‘æµç¨‹</a></li><li><a href="#å¸¸è§é—®é¢˜">å¸¸è§é—®é¢˜</a></li><li><a href="#éƒ¨ç½²è¯´æ˜">éƒ¨ç½²è¯´æ˜</a></li></ul><h2 id="é¡¹ç›®æ¦‚è§ˆ"><a href="#é¡¹ç›®æ¦‚è§ˆ" class="headerlink" title="é¡¹ç›®æ¦‚è§ˆ"></a>é¡¹ç›®æ¦‚è§ˆ</h2><h3 id="é¡¹ç›®ç®€ä»‹"><a href="#é¡¹ç›®ç®€ä»‹" class="headerlink" title="é¡¹ç›®ç®€ä»‹"></a>é¡¹ç›®ç®€ä»‹</h3><p>Youyan Multi æ˜¯ä¸€ä¸ªåŸºäº Monorepo æ¶æ„çš„å¤šç«¯åº”ç”¨é¡¹ç›®ï¼Œä¸»è¦åŒ…å«ï¼š</p><ul><li><strong>Platformï¼ˆæœåŠ¡å¹³å°ï¼‰</strong>ï¼šåŸºäº Nuxt 3 çš„ SSR åº”ç”¨ï¼Œé¢å‘ C ç«¯ç”¨æˆ·çš„å®˜ç½‘å’Œè¥é”€é¡µé¢</li><li><strong>Workspaceï¼ˆå·¥ä½œå°ï¼‰</strong>ï¼šåŸºäº Vite + Vue 3 çš„ SPA åº”ç”¨ï¼Œç”¨æˆ·å·¥ä½œç©ºé—´</li><li><strong>Commonï¼ˆå…¬å…±åº“ï¼‰</strong>ï¼šå…±äº«çš„ä¸šåŠ¡é€»è¾‘ã€ç±»å‹å®šä¹‰ã€API æ¥å£ç­‰</li><li><strong>Designï¼ˆè®¾è®¡ç³»ç»Ÿï¼‰</strong>ï¼šUI ç»„ä»¶åº“å’Œè®¾è®¡è§„èŒƒ</li></ul><h3 id="é¡¹ç›®ç‰¹ç‚¹"><a href="#é¡¹ç›®ç‰¹ç‚¹" class="headerlink" title="é¡¹ç›®ç‰¹ç‚¹"></a>é¡¹ç›®ç‰¹ç‚¹</h3><ul><li>ğŸŒ <strong>å›½é™…åŒ–æ”¯æŒ</strong>ï¼šæ”¯æŒä¸­æ–‡ï¼ˆCNï¼‰å’Œæµ·å¤–ï¼ˆUSï¼‰ä¸¤ä¸ªåŒºåŸŸç‰ˆæœ¬</li><li>ğŸ¨ <strong>å¤šä¸»é¢˜</strong>ï¼šæ”¯æŒæ˜æš—ä¸»é¢˜åˆ‡æ¢</li><li>ğŸ“± <strong>å“åº”å¼è®¾è®¡</strong>ï¼šæ”¯æŒ PC å’Œç§»åŠ¨ç«¯</li><li>ğŸš€ <strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šSSRã€ä»£ç åˆ†å‰²ã€CDN éƒ¨ç½²</li><li>ğŸ” <strong>æƒé™ç®¡ç†</strong>ï¼šå®Œå–„çš„ç”¨æˆ·æƒé™å’Œç»„ç»‡æ¶æ„ç®¡ç†</li></ul><h2 id="æŠ€æœ¯æ ˆ"><a href="#æŠ€æœ¯æ ˆ" class="headerlink" title="æŠ€æœ¯æ ˆ"></a>æŠ€æœ¯æ ˆ</h2><h3 id="æ ¸å¿ƒæ¡†æ¶"><a href="#æ ¸å¿ƒæ¡†æ¶" class="headerlink" title="æ ¸å¿ƒæ¡†æ¶"></a>æ ¸å¿ƒæ¡†æ¶</h3><table><thead><tr><th>æŠ€æœ¯</th><th>ç‰ˆæœ¬</th><th>ç”¨é€”</th></tr></thead><tbody><tr><td>Vue</td><td>3.4.29</td><td>å‰ç«¯æ¡†æ¶</td></tr><tr><td>Nuxt</td><td>3.13.0</td><td>SSR æ¡†æ¶ï¼ˆPlatformï¼‰</td></tr><tr><td>Vite</td><td>6.2.6</td><td>æ„å»ºå·¥å…·ï¼ˆWorkspaceï¼‰</td></tr><tr><td>TypeScript</td><td>5.9.2</td><td>ç±»å‹ç³»ç»Ÿ</td></tr><tr><td>pnpm</td><td>9.x</td><td>åŒ…ç®¡ç†å™¨</td></tr></tbody></table><h3 id="UI-æ¡†æ¶"><a href="#UI-æ¡†æ¶" class="headerlink" title="UI æ¡†æ¶"></a>UI æ¡†æ¶</h3><ul><li><strong>Ant Design Vue</strong> 4.2.3 - ä¸»è¦ UI ç»„ä»¶åº“</li><li><strong>TailwindCSS</strong> 3.4.10 - åŸå­åŒ– CSS æ¡†æ¶</li><li><strong>@iconpark</strong> - å›¾æ ‡åº“</li></ul><h3 id="çŠ¶æ€ç®¡ç†"><a href="#çŠ¶æ€ç®¡ç†" class="headerlink" title="çŠ¶æ€ç®¡ç†"></a>çŠ¶æ€ç®¡ç†</h3><ul><li><strong>Pinia</strong> 3.0.3 - Vue çŠ¶æ€ç®¡ç†</li><li><strong>VueUse</strong> 12.0.0 - Vue Composition API å·¥å…·é›†</li></ul><h3 id="å·¥å…·åº“"><a href="#å·¥å…·åº“" class="headerlink" title="å·¥å…·åº“"></a>å·¥å…·åº“</h3><ul><li><strong>dayjs</strong> 1.11.11 - æ—¥æœŸå¤„ç†</li><li><strong>lodash-es</strong> 4.17.21 - å·¥å…·å‡½æ•°</li><li><strong>axios</strong> 1.11.0 - HTTP è¯·æ±‚</li><li><strong>vue-i18n</strong> 11.1.12 - å›½é™…åŒ–</li><li><strong>video.js</strong> 8.19.0 - è§†é¢‘æ’­æ”¾</li><li><strong>ali-oss</strong> 6.23.0 - é˜¿é‡Œäº‘ OSS</li></ul><h3 id="å¼€å‘å·¥å…·"><a href="#å¼€å‘å·¥å…·" class="headerlink" title="å¼€å‘å·¥å…·"></a>å¼€å‘å·¥å…·</h3><ul><li><strong>ESLint</strong> 9.35.0 - ä»£ç æ£€æŸ¥</li><li><strong>Prettier</strong> 3.6.2 - ä»£ç æ ¼å¼åŒ–</li><li><strong>Husky</strong> 9.1.7 - Git hooks</li><li><strong>Commitlint</strong> 19.8.1 - æäº¤è§„èŒƒæ£€æŸ¥</li></ul><h2 id="é¡¹ç›®æ¶æ„"><a href="#é¡¹ç›®æ¶æ„" class="headerlink" title="é¡¹ç›®æ¶æ„"></a>é¡¹ç›®æ¶æ„</h2><h3 id="ç›®å½•ç»“æ„"><a href="#ç›®å½•ç»“æ„" class="headerlink" title="ç›®å½•ç»“æ„"></a>ç›®å½•ç»“æ„</h3><pre><code>youyan-multi/â”œâ”€â”€ app/                          # åº”ç”¨ç›®å½•â”‚   â”œâ”€â”€ platform/                 # æœåŠ¡å¹³å°ï¼ˆNuxt 3ï¼‰â”‚   â”‚   â”œâ”€â”€ api/                  # API æ¥å£å®šä¹‰â”‚   â”‚   â”‚   â”œâ”€â”€ interface/        # æ¥å£ç±»å‹â”‚   â”‚   â”‚   â”œâ”€â”€ module/           # API æ¨¡å—â”‚   â”‚   â”‚   â”œâ”€â”€ index.tsâ”‚   â”‚   â”‚   â””â”€â”€ request.ts        # è¯·æ±‚å°è£…â”‚   â”‚   â”œâ”€â”€ assets/               # é™æ€èµ„æºâ”‚   â”‚   â”‚   â”œâ”€â”€ css/â”‚   â”‚   â”‚   â”œâ”€â”€ fonts/â”‚   â”‚   â”‚   â”œâ”€â”€ images/â”‚   â”‚   â”‚   â”œâ”€â”€ scss/â”‚   â”‚   â”‚   â””â”€â”€ svg/â”‚   â”‚   â”œâ”€â”€ components/           # é€šç”¨ç»„ä»¶â”‚   â”‚   â”œâ”€â”€ components-mobile/    # ç§»åŠ¨ç«¯ç»„ä»¶â”‚   â”‚   â”œâ”€â”€ composables/          # ç»„åˆå¼å‡½æ•°â”‚   â”‚   â”œâ”€â”€ constants/            # å¸¸é‡å®šä¹‰â”‚   â”‚   â”œâ”€â”€ design/               # è®¾è®¡ç›¸å…³â”‚   â”‚   â”œâ”€â”€ directives/           # è‡ªå®šä¹‰æŒ‡ä»¤â”‚   â”‚   â”œâ”€â”€ features/             # åŠŸèƒ½æ¨¡å—â”‚   â”‚   â”œâ”€â”€ hooks/                # React-style hooksâ”‚   â”‚   â”œâ”€â”€ layouts/              # å¸ƒå±€ç»„ä»¶â”‚   â”‚   â”œâ”€â”€ middleware/           # ä¸­é—´ä»¶â”‚   â”‚   â”œâ”€â”€ pages/                # é¡µé¢ç»„ä»¶â”‚   â”‚   â”œâ”€â”€ plugins/              # Nuxt æ’ä»¶â”‚   â”‚   â”œâ”€â”€ server/               # æœåŠ¡ç«¯ä»£ç â”‚   â”‚   â”œâ”€â”€ utils/                # å·¥å…·å‡½æ•°â”‚   â”‚   â”œâ”€â”€ nuxt.config.ts        # Nuxt é…ç½®â”‚   â”‚   â””â”€â”€ package.jsonâ”‚   â”‚â”‚   â””â”€â”€ workspace/                # å·¥ä½œå°ï¼ˆVite + Vue 3ï¼‰â”‚       â”œâ”€â”€ src/â”‚       â”‚   â”œâ”€â”€ core/             # æ ¸å¿ƒæ¨¡å—â”‚       â”‚   â”‚   â”œâ”€â”€ routes.ts     # è·¯ç”±é…ç½®â”‚       â”‚   â”‚   â”œâ”€â”€ types.ts      # ç±»å‹å®šä¹‰â”‚       â”‚   â”‚   â””â”€â”€ ui/           # æ ¸å¿ƒ UI ç»„ä»¶â”‚       â”‚   â”œâ”€â”€ pages/            # é¡µé¢â”‚       â”‚   â”‚   â”œâ”€â”€ home/         # é¦–é¡µâ”‚       â”‚   â”‚   â”œâ”€â”€ space/        # ç©ºé—´ç®¡ç†â”‚       â”‚   â”‚   â”œâ”€â”€ favorites/    # æ”¶è—â”‚       â”‚   â”‚   â”œâ”€â”€ brand-guide/  # å“ç‰ŒæŒ‡å—â”‚       â”‚   â”‚   â””â”€â”€ user-center/  # ç”¨æˆ·ä¸­å¿ƒâ”‚       â”‚   â”œâ”€â”€ shared/           # å…±äº«æ¨¡å—â”‚       â”‚   â”‚   â”œâ”€â”€ composables/  # ç»„åˆå¼å‡½æ•°â”‚       â”‚   â”‚   â”œâ”€â”€ store/        # çŠ¶æ€ç®¡ç†â”‚       â”‚   â”‚   â”œâ”€â”€ ui/           # UI ç»„ä»¶â”‚       â”‚   â”‚   â””â”€â”€ utils/        # å·¥å…·å‡½æ•°â”‚       â”‚   â”œâ”€â”€ widgets/          # ä¸šåŠ¡ç»„ä»¶â”‚       â”‚   â”œâ”€â”€ locales/          # å›½é™…åŒ–æ–‡ä»¶â”‚       â”‚   â”œâ”€â”€ main.tsx          # å…¥å£æ–‡ä»¶â”‚       â”‚   â””â”€â”€ App.vue           # æ ¹ç»„ä»¶â”‚       â”œâ”€â”€ vite.config.ts        # Vite é…ç½®â”‚       â””â”€â”€ package.jsonâ”‚â”œâ”€â”€ packages/                     # å…±äº«åŒ…â”‚   â”œâ”€â”€ common/                   # å…¬å…±ä¸šåŠ¡é€»è¾‘â”‚   â”‚   â”œâ”€â”€ src/â”‚   â”‚   â”‚   â”œâ”€â”€ composables/      # ç»„åˆå¼å‡½æ•°â”‚   â”‚   â”‚   â”œâ”€â”€ entities/         # å®ä½“å®šä¹‰â”‚   â”‚   â”‚   â”œâ”€â”€ features/         # åŠŸèƒ½æ¨¡å—â”‚   â”‚   â”‚   â”œâ”€â”€ locales/          # å›½é™…åŒ–â”‚   â”‚   â”‚   â”œâ”€â”€ services/         # æœåŠ¡å±‚â”‚   â”‚   â”‚   â”œâ”€â”€ store/            # çŠ¶æ€ç®¡ç†â”‚   â”‚   â”‚   â”œâ”€â”€ types/            # ç±»å‹å®šä¹‰â”‚   â”‚   â”‚   â””â”€â”€ utils/            # å·¥å…·å‡½æ•°â”‚   â”‚   â””â”€â”€ package.jsonâ”‚   â”‚â”‚   â”œâ”€â”€ design/                   # è®¾è®¡ç³»ç»Ÿâ”‚   â”‚   â”œâ”€â”€ src/â”‚   â”‚   â”‚   â”œâ”€â”€ assets/           # å›¾æ ‡ç­‰èµ„æºâ”‚   â”‚   â”‚   â”œâ”€â”€ components/       # UI ç»„ä»¶â”‚   â”‚   â”‚   â”œâ”€â”€ libs/             # å·¥å…·åº“â”‚   â”‚   â”‚   â””â”€â”€ styles/           # å…¨å±€æ ·å¼â”‚   â”‚   â””â”€â”€ package.jsonâ”‚   â”‚â”‚   â””â”€â”€ tools/                    # å¼€å‘å·¥å…·â”‚       â”œâ”€â”€ lib/â”‚       â”‚   â”œâ”€â”€ font-minify.ts    # å­—ä½“å‹ç¼©â”‚       â”‚   â””â”€â”€ svg-processor.ts  # SVG å¤„ç†â”‚       â””â”€â”€ package.jsonâ”‚â”œâ”€â”€ pnpm-workspace.yaml           # pnpm workspace é…ç½®â”œâ”€â”€ package.json                  # æ ¹ package.jsonâ”œâ”€â”€ eslint.config.js              # ESLint é…ç½®â”œâ”€â”€ commitlint.config.js          # Commitlint é…ç½®â””â”€â”€ .vscode/                      # VSCode é…ç½®</code></pre><h3 id="Monorepo-æ¶æ„è¯´æ˜"><a href="#Monorepo-æ¶æ„è¯´æ˜" class="headerlink" title="Monorepo æ¶æ„è¯´æ˜"></a>Monorepo æ¶æ„è¯´æ˜</h3><p>æœ¬é¡¹ç›®é‡‡ç”¨ pnpm workspace å®ç° Monorepoï¼š</p><pre class="line-numbers language-yaml"><code class="language-yaml"><span class="token comment" spellcheck="true"># pnpm-workspace.yaml</span><span class="token key atrule">packages</span><span class="token punctuation">:</span>  <span class="token punctuation">-</span> <span class="token string">"app/*"</span>  <span class="token punctuation">-</span> <span class="token string">"packages/*"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ä¼˜åŠ¿ï¼š</strong></p><ul><li><strong>ä»£ç å¤ç”¨</strong>ï¼šå…±äº«ç»„ä»¶å’Œé€»è¾‘</li><li><strong>ç»Ÿä¸€ä¾èµ–</strong>ï¼šé”å®šç‰ˆæœ¬ï¼Œå‡å°‘å†²çª</li><li><strong>å¼€å‘æ•ˆç‡</strong>ï¼šä¸€é”®å®‰è£…ã€æ„å»ºã€å‘å¸ƒ</li><li><strong>ç±»å‹å®‰å…¨</strong>ï¼šworkspace å†…éƒ¨ä¾èµ–ç±»å‹å®Œæ•´</li></ul><h2 id="å¼€å‘ç¯å¢ƒé…ç½®"><a href="#å¼€å‘ç¯å¢ƒé…ç½®" class="headerlink" title="å¼€å‘ç¯å¢ƒé…ç½®"></a>å¼€å‘ç¯å¢ƒé…ç½®</h2><h3 id="å‰ç½®è¦æ±‚"><a href="#å‰ç½®è¦æ±‚" class="headerlink" title="å‰ç½®è¦æ±‚"></a>å‰ç½®è¦æ±‚</h3><ul><li><strong>Node.js</strong>ï¼š&gt;= 20.10.1</li><li><strong>pnpm</strong>ï¼š&gt;= 9.0.0</li><li><strong>Git</strong>ï¼šæœ€æ–°ç‰ˆæœ¬</li></ul><h3 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h3><h4 id="1-å…‹éš†é¡¹ç›®"><a href="#1-å…‹éš†é¡¹ç›®" class="headerlink" title="1. å…‹éš†é¡¹ç›®"></a>1. å…‹éš†é¡¹ç›®</h4><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">git</span> clone <span class="token operator">&lt;</span>repository-url<span class="token operator">></span><span class="token function">cd</span> youyan-multi<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="2-å®‰è£…-pnpm"><a href="#2-å®‰è£…-pnpm" class="headerlink" title="2. å®‰è£… pnpm"></a>2. å®‰è£… pnpm</h4><p>ä½¿ç”¨ corepackï¼ˆNode.js 16.9+ å†…ç½®ï¼‰ï¼š</p><pre class="line-numbers language-bash"><code class="language-bash">corepack <span class="token function">enable</span>corepack prepare pnpm@9.0.0 --activate<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æˆ–æ‰‹åŠ¨å®‰è£…ï¼š</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> -g pnpm<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="3-å®‰è£…ä¾èµ–"><a href="#3-å®‰è£…ä¾èµ–" class="headerlink" title="3. å®‰è£…ä¾èµ–"></a>3. å®‰è£…ä¾èµ–</h4><pre class="line-numbers language-bash"><code class="language-bash">pnpm <span class="token function">install</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="4-VSCode-é…ç½®"><a href="#4-VSCode-é…ç½®" class="headerlink" title="4. VSCode é…ç½®"></a>4. VSCode é…ç½®</h4><p>é¡¹ç›®å·²åŒ…å« .vscode é…ç½®ï¼Œæ¨èå®‰è£…ä»¥ä¸‹æ’ä»¶ï¼š</p><ul><li><strong>ESLint</strong> - ä»£ç æ£€æŸ¥</li><li><strong>Prettier</strong> - ä»£ç æ ¼å¼åŒ–</li><li><strong>Volar</strong> - Vue è¯­è¨€æ”¯æŒ</li><li><strong>i18n Ally</strong> - å›½é™…åŒ–ç®¡ç†</li><li><strong>TailwindCSS IntelliSense</strong> - TailwindCSS æ™ºèƒ½æç¤º</li></ul><p>ä¿å­˜æ—¶è‡ªåŠ¨æ ¼å¼åŒ–å·²é…ç½®å®Œæˆã€‚</p><h3 id="å¯åŠ¨é¡¹ç›®"><a href="#å¯åŠ¨é¡¹ç›®" class="headerlink" title="å¯åŠ¨é¡¹ç›®"></a>å¯åŠ¨é¡¹ç›®</h3><h4 id="Platformï¼ˆæœåŠ¡å¹³å°ï¼‰"><a href="#Platformï¼ˆæœåŠ¡å¹³å°ï¼‰" class="headerlink" title="Platformï¼ˆæœåŠ¡å¹³å°ï¼‰"></a>Platformï¼ˆæœåŠ¡å¹³å°ï¼‰</h4><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># å¼€å‘ç¯å¢ƒï¼ˆä¸­å›½ï¼‰</span><span class="token function">cd</span> app/platformpnpm run dev:cn<span class="token comment" spellcheck="true"># å¼€å‘ç¯å¢ƒï¼ˆæµ·å¤–ï¼‰</span>pnpm run dev:us<span class="token comment" spellcheck="true"># æµ‹è¯•ç¯å¢ƒ</span>pnpm run qa:cnpnpm run qa:us<span class="token comment" spellcheck="true"># é¢„å‘ç¯å¢ƒ</span>pnpm run pre:cnpnpm run pre:us<span class="token comment" spellcheck="true"># ç”Ÿäº§ç¯å¢ƒï¼ˆæœ¬åœ°é¢„è§ˆï¼‰</span>pnpm run main:cnpnpm run main:us<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è®¿é—®ï¼š<a href="http://localhost:3000">http://localhost:3000</a></p><h4 id="Workspaceï¼ˆå·¥ä½œå°ï¼‰"><a href="#Workspaceï¼ˆå·¥ä½œå°ï¼‰" class="headerlink" title="Workspaceï¼ˆå·¥ä½œå°ï¼‰"></a>Workspaceï¼ˆå·¥ä½œå°ï¼‰</h4><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># å¼€å‘ç¯å¢ƒï¼ˆä¸­å›½ï¼‰</span><span class="token function">cd</span> app/workspacepnpm run dev:cn<span class="token comment" spellcheck="true"># å¼€å‘ç¯å¢ƒï¼ˆæµ·å¤–ï¼‰</span>pnpm run dev:us<span class="token comment" spellcheck="true"># æµ‹è¯•ç¯å¢ƒ</span>pnpm run qa:cnpnpm run qa:us<span class="token comment" spellcheck="true"># é¢„å‘ç¯å¢ƒ</span>pnpm run pre:cnpnpm run pre:us<span class="token comment" spellcheck="true"># ç”Ÿäº§ç¯å¢ƒ</span>pnpm run prod:cnpnpm run prod:us<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è®¿é—®ï¼š<a href="http://localhost:8888">http://localhost:8888</a></p><h3 id="ç¯å¢ƒå˜é‡è¯´æ˜"><a href="#ç¯å¢ƒå˜é‡è¯´æ˜" class="headerlink" title="ç¯å¢ƒå˜é‡è¯´æ˜"></a>ç¯å¢ƒå˜é‡è¯´æ˜</h3><h4 id="Platform-ç¯å¢ƒå˜é‡ï¼ˆapp-platform-env-ï¼‰"><a href="#Platform-ç¯å¢ƒå˜é‡ï¼ˆapp-platform-env-ï¼‰" class="headerlink" title="Platform ç¯å¢ƒå˜é‡ï¼ˆapp/platform/env/ï¼‰"></a>Platform ç¯å¢ƒå˜é‡ï¼ˆ<code>app/platform/env/</code>ï¼‰</h4><ul><li><code>.env.dev</code> - å¼€å‘ç¯å¢ƒï¼ˆä¸­å›½ï¼‰</li><li><code>.env.us.dev</code> - å¼€å‘ç¯å¢ƒï¼ˆæµ·å¤–ï¼‰</li><li><code>.env.test</code> - æµ‹è¯•ç¯å¢ƒï¼ˆä¸­å›½ï¼‰</li><li><code>.env.us.test</code> - æµ‹è¯•ç¯å¢ƒï¼ˆæµ·å¤–ï¼‰</li><li><code>.env.pre</code> - é¢„å‘ç¯å¢ƒï¼ˆä¸­å›½ï¼‰</li><li><code>.env.us.pre</code> - é¢„å‘ç¯å¢ƒï¼ˆæµ·å¤–ï¼‰</li><li><code>.env.production</code> - ç”Ÿäº§ç¯å¢ƒï¼ˆä¸­å›½ï¼‰</li><li><code>.env.us.production</code> - ç”Ÿäº§ç¯å¢ƒï¼ˆæµ·å¤–ï¼‰</li></ul><p>å…³é”®é…ç½®é¡¹ï¼š</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># API åœ°å€</span>NUXT_PUBLIC_API_BASE<span class="token operator">=</span>https://api.example.comNUXT_PUBLIC_API_DOMAIN<span class="token operator">=</span>example.comNUXT_PUBLIC_API_CMS<span class="token operator">=</span>https://cms.example.com<span class="token comment" spellcheck="true"># ç¯å¢ƒæ ‡è¯†</span>NUXT_PUBLIC_ENV<span class="token operator">=</span>dev<span class="token operator">|</span>qa<span class="token operator">|</span>pre<span class="token operator">|</span>productionNUXT_PUBLIC_AREA<span class="token operator">=</span>CN<span class="token operator">|</span>US<span class="token comment" spellcheck="true"># OSS é…ç½®</span>NUXT_PUBLIC_FE_OSS<span class="token operator">=</span>https://fe-assets-cdn.example.comNUXT_PUBLIC_BE_OSS<span class="token operator">=</span>https://media.example.com<span class="token comment" spellcheck="true"># å·¥ä½œå°åœ°å€</span>NUXT_PUBLIC_WORKSPACE_URL<span class="token operator">=</span>https://workspace.example.com<span class="token comment" spellcheck="true"># ç¥ç­–åŸ‹ç‚¹</span>NUXT_PUBLIC_SHENCE_URL<span class="token operator">=</span>https://analytics.example.com<span class="token comment" spellcheck="true"># é£ä¹¦ AppID</span>NUXT_PUBLIC_FEISHU_APP_ID<span class="token operator">=</span>cli_xxxxx<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Workspace-ç¯å¢ƒå˜é‡ï¼ˆapp-workspace-env-ï¼‰"><a href="#Workspace-ç¯å¢ƒå˜é‡ï¼ˆapp-workspace-env-ï¼‰" class="headerlink" title="Workspace ç¯å¢ƒå˜é‡ï¼ˆapp/workspace/env/ï¼‰"></a>Workspace ç¯å¢ƒå˜é‡ï¼ˆ<code>app/workspace/env/</code>ï¼‰</h4><p>ä¸ Platform ç±»ä¼¼ï¼Œä½†ä½¿ç”¨ Vite ç¯å¢ƒå˜é‡å‰ç¼€ã€‚</p><h2 id="ä»£ç è§„èŒƒ"><a href="#ä»£ç è§„èŒƒ" class="headerlink" title="ä»£ç è§„èŒƒ"></a>ä»£ç è§„èŒƒ</h2><h3 id="ç¼–ç è§„èŒƒ"><a href="#ç¼–ç è§„èŒƒ" class="headerlink" title="ç¼–ç è§„èŒƒ"></a>ç¼–ç è§„èŒƒ</h3><h4 id="1-CSS-æ ·å¼è§„èŒƒ"><a href="#1-CSS-æ ·å¼è§„èŒƒ" class="headerlink" title="1. CSS/æ ·å¼è§„èŒƒ"></a>1. CSS/æ ·å¼è§„èŒƒ</h4><p>ä¼˜å…ˆä½¿ç”¨ BEM è§„èŒƒï¼Œä¸”è®© AI å¸®ä½ ç”Ÿæˆåå­—ï¼Œä¸è¦è‡ªå·±å†™ã€‚</p><p>ä¸è¦ä½¿ç”¨ promptï¼Œå› ä¸ºé¡¹ç›®çš„å…¨åŸ‹ç‚¹ä¾èµ–æ¸…æ™°çš„ class å†…å®¹ã€‚</p><h4 id="2-å›½é™…åŒ–è§„èŒƒ"><a href="#2-å›½é™…åŒ–è§„èŒƒ" class="headerlink" title="2. å›½é™…åŒ–è§„èŒƒ"></a>2. å›½é™…åŒ–è§„èŒƒ</h4><p>âœ… <strong>æ‰€æœ‰ä¸­æ–‡æ–‡æœ¬å¿…é¡»ä½¿ç”¨ i18nï¼š</strong></p><pre class="line-numbers language-vue"><code class="language-vue"><template>  <!-- ä½¿ç”¨ $t å‡½æ•° -->  <button>{{ $t("deng-lu") }}</button>  <a-button>{{ $t("que-ren") }}</a-button></template><script setup lang="ts">const { t } = useI18n();const message = t("huan-ying-shi-yong");</script><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>æ“ä½œæµç¨‹ï¼š</strong></p><ol><li>ç¼–å†™ä¸­æ–‡æ–‡æœ¬</li><li>ä½¿ç”¨ i18n Ally æ’ä»¶ï¼ˆVSCodeï¼‰æå–åˆ° locale æ–‡ä»¶</li><li>è¡¥å……è‹±æ–‡ç¿»è¯‘</li></ol><p><strong>locale æ–‡ä»¶ä½ç½®ï¼š</strong></p><ul><li>Platform: <code>app/platform/locales/langs/zh-CN.json</code>, <code>en-US.json</code></li><li>Workspace: <code>app/workspace/src/locales/zh-CN.json</code>, <code>en-US.json</code></li><li>Common: <code>packages/common/src/locales/zh-CN.json</code>, <code>en-US.json</code></li></ul><h4 id="3-API-å‘½åè§„èŒƒ"><a href="#3-API-å‘½åè§„èŒƒ" class="headerlink" title="3. API å‘½åè§„èŒƒ"></a>3. API å‘½åè§„èŒƒ</h4><p>âœ… <strong>API æ–¹æ³•å‘½åä¸åç«¯è·¯å¾„å¯¹é½ï¼š</strong></p><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// app/platform/api/module/order.ts</span><span class="token comment" spellcheck="true">// åç«¯æ¥å£ï¼šGET /order/coin_list</span><span class="token keyword">export</span> <span class="token keyword">const</span> getOrderCoinList <span class="token operator">=</span> <span class="token punctuation">(</span>params<span class="token punctuation">:</span> <span class="token keyword">any</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> request<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">"/order/coin_list"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> params <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// åç«¯æ¥å£ï¼šPOST /order/create</span><span class="token keyword">export</span> <span class="token keyword">const</span> postOrderCreate <span class="token operator">=</span> <span class="token punctuation">(</span>data<span class="token punctuation">:</span> <span class="token keyword">any</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> request<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">"/order/create"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// åç«¯æ¥å£ï¼šPUT /order/update</span><span class="token keyword">export</span> <span class="token keyword">const</span> putOrderUpdate <span class="token operator">=</span> <span class="token punctuation">(</span>data<span class="token punctuation">:</span> <span class="token keyword">any</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> request<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"/order/update"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// åç«¯æ¥å£ï¼šDELETE /order/delete</span><span class="token keyword">export</span> <span class="token keyword">const</span> deleteOrder <span class="token operator">=</span> <span class="token punctuation">(</span>id<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> request<span class="token punctuation">.</span><span class="token keyword">delete</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`/order/delete/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>å‘½åè§„åˆ™ï¼š</strong></p><ul><li>ä½¿ç”¨ HTTP method å¼€å¤´ï¼š<code>get</code>ã€<code>post</code>ã€<code>put</code>ã€<code>delete</code>ã€<code>patch</code></li><li>è·¯å¾„è½¬æ¢ä¸ºé©¼å³°ï¼š<code>/order/coin_list</code> â†’ <code>getOrderCoinList</code></li><li>ä¾¿äº AI ä»£ç è¡¥å…¨ï¼ˆCodeiumã€Copilot ç­‰ï¼‰</li></ul><h4 id="4-TypeScript-è§„èŒƒ"><a href="#4-TypeScript-è§„èŒƒ" class="headerlink" title="4. TypeScript è§„èŒƒ"></a>4. TypeScript è§„èŒƒ</h4><p>âœ… <strong>æ¨èï¼š</strong></p><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// å®šä¹‰æ¥å£ç±»å‹</span><span class="token keyword">interface</span> <span class="token class-name">UserInfo</span> <span class="token punctuation">{</span>  id<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">;</span>  name<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">;</span>  avatar<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">;</span>  role<span class="token punctuation">:</span> <span class="token string">"admin"</span> <span class="token operator">|</span> <span class="token string">"user"</span> <span class="token operator">|</span> <span class="token string">"guest"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// ä½¿ç”¨æ³›å‹</span><span class="token keyword">function</span> fetchData<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">)</span><span class="token punctuation">:</span> Promise<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// ä½¿ç”¨è”åˆç±»å‹</span>type Status <span class="token operator">=</span> <span class="token string">"pending"</span> <span class="token operator">|</span> <span class="token string">"success"</span> <span class="token operator">|</span> <span class="token string">"error"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>âŒ <strong>é¿å…ï¼š</strong></p><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// é¿å…ä½¿ç”¨ any</span><span class="token keyword">function</span> <span class="token function">fetchData</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">)</span><span class="token punctuation">:</span> Promise<span class="token operator">&lt;</span><span class="token keyword">any</span><span class="token operator">></span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// é¿å…è¿‡åº¦ä½¿ç”¨å¯é€‰é“¾</span><span class="token keyword">const</span> name <span class="token operator">=</span> user<span class="token operator">?</span><span class="token punctuation">.</span>info<span class="token operator">?</span><span class="token punctuation">.</span>profile<span class="token operator">?</span><span class="token punctuation">.</span>name<span class="token operator">?</span><span class="token punctuation">.</span>firstName<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="5-ç»„ä»¶è§„èŒƒ"><a href="#5-ç»„ä»¶è§„èŒƒ" class="headerlink" title="5. ç»„ä»¶è§„èŒƒ"></a>5. ç»„ä»¶è§„èŒƒ</h4><p><strong>æ–‡ä»¶å‘½åï¼š</strong></p><ul><li>ç»„ä»¶ï¼š<code>PascalCase.vue</code></li><li>å·¥å…·å‡½æ•°ï¼š<code>camelCase.ts</code></li><li>Composablesï¼š<code>use*.ts</code></li></ul><p><strong>ç»„ä»¶ç»“æ„ï¼š</strong></p><pre class="line-numbers language-vue"><code class="language-vue"><template>  <!-- æ¨¡æ¿ --></template><script setup lang="ts">// 1. å¯¼å…¥import { ref, computed } from "vue";// 2. Props å®šä¹‰interface Props {  title: string;  count?: number;}const props = withDefaults(defineProps<Props>(), {  count: 0,});// 3. Emits å®šä¹‰const emit = defineEmits<{  (e: "update", value: string): void;}>();// 4. å“åº”å¼æ•°æ®const visible = ref(false);// 5. è®¡ç®—å±æ€§const displayCount = computed(() => props.count + 1);// 6. æ–¹æ³•const handleClick = () => {  emit("update", "new value");};// 7. ç”Ÿå‘½å‘¨æœŸonMounted(() => {  // åˆå§‹åŒ–é€»è¾‘});</script><style scoped lang="scss">/* æ ·å¼ */</style><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Git-æäº¤è§„èŒƒ"><a href="#Git-æäº¤è§„èŒƒ" class="headerlink" title="Git æäº¤è§„èŒƒ"></a>Git æäº¤è§„èŒƒ</h3><p>é¡¹ç›®ä½¿ç”¨ Commitlint + Husky å¼ºåˆ¶è§„èŒƒï¼š</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># æäº¤æ ¼å¼</span><span class="token operator">&lt;</span>type<span class="token operator">></span><span class="token punctuation">(</span><span class="token operator">&lt;</span>scope<span class="token operator">></span><span class="token punctuation">)</span>: <span class="token operator">&lt;</span>subject<span class="token operator">></span><span class="token comment" spellcheck="true"># ç¤ºä¾‹</span>feat<span class="token punctuation">(</span>workspace<span class="token punctuation">)</span>: æ·»åŠ æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½fix<span class="token punctuation">(</span>platform<span class="token punctuation">)</span>: ä¿®å¤ç™»å½•é¡µæ ·å¼é—®é¢˜docs: æ›´æ–°æŠ€æœ¯æ‰‹å†Œrefactor<span class="token punctuation">(</span>common<span class="token punctuation">)</span>: é‡æ„ API è¯·æ±‚å°è£…<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>Type ç±»å‹ï¼š</strong></p><ul><li><code>feat</code>: æ–°åŠŸèƒ½</li><li><code>fix</code>: ä¿®å¤ bug</li><li><code>docs</code>: æ–‡æ¡£æ›´æ–°</li><li><code>style</code>: ä»£ç æ ¼å¼ï¼ˆä¸å½±å“åŠŸèƒ½ï¼‰</li><li><code>refactor</code>: é‡æ„</li><li><code>perf</code>: æ€§èƒ½ä¼˜åŒ–</li><li><code>test</code>: æµ‹è¯•ç›¸å…³</li><li><code>chore</code>: æ„å»ºã€å·¥å…·é…ç½®ç­‰</li></ul><p><strong>ä½¿ç”¨ czg äº¤äº’å¼æäº¤ï¼š</strong></p><pre class="line-numbers language-bash"><code class="language-bash">pnpm run commit<span class="token comment" spellcheck="true"># æˆ–</span><span class="token function">git</span> cz<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="ä»£ç æ£€æŸ¥å’Œæ ¼å¼åŒ–"><a href="#ä»£ç æ£€æŸ¥å’Œæ ¼å¼åŒ–" class="headerlink" title="ä»£ç æ£€æŸ¥å’Œæ ¼å¼åŒ–"></a>ä»£ç æ£€æŸ¥å’Œæ ¼å¼åŒ–</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># æ£€æŸ¥ lint é”™è¯¯</span>pnpm run lint:check<span class="token comment" spellcheck="true"># è‡ªåŠ¨ä¿®å¤ lint é”™è¯¯</span>pnpm run lint<span class="token comment" spellcheck="true"># æ ¼å¼åŒ–ä»£ç </span>pnpm run <span class="token function">format</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>è‡ªåŠ¨åŒ–ï¼š</strong></p><ul><li>ä¿å­˜æ—¶è‡ªåŠ¨æ ¼å¼åŒ–ï¼ˆVSCode é…ç½®ï¼‰</li><li>æäº¤å‰è‡ªåŠ¨æ£€æŸ¥ï¼ˆlint-staged + huskyï¼‰</li></ul><h2 id="æ ¸å¿ƒæ¨¡å—è¯´æ˜"><a href="#æ ¸å¿ƒæ¨¡å—è¯´æ˜" class="headerlink" title="æ ¸å¿ƒæ¨¡å—è¯´æ˜"></a>æ ¸å¿ƒæ¨¡å—è¯´æ˜</h2><h3 id="1-è·¯ç”±ç³»ç»Ÿ"><a href="#1-è·¯ç”±ç³»ç»Ÿ" class="headerlink" title="1. è·¯ç”±ç³»ç»Ÿ"></a>1. è·¯ç”±ç³»ç»Ÿ</h3><h4 id="Platform-è·¯ç”±ï¼ˆNuxtï¼‰"><a href="#Platform-è·¯ç”±ï¼ˆNuxtï¼‰" class="headerlink" title="Platform è·¯ç”±ï¼ˆNuxtï¼‰"></a>Platform è·¯ç”±ï¼ˆNuxtï¼‰</h4><p>Platform ä½¿ç”¨è‡ªå®šä¹‰è·¯ç”±é…ç½®è€Œé Nuxt è‡ªåŠ¨ç”Ÿæˆï¼š</p><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// app/platform/app/router.options.ts (ä¸­å›½åŒº)</span><span class="token comment" spellcheck="true">// app/platform/app/router.options.us.ts (æµ·å¤–)</span><span class="token keyword">import</span> type <span class="token punctuation">{</span> RouterConfig <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@nuxt/schema"</span><span class="token punctuation">;</span><span class="token keyword">const</span> routes<span class="token punctuation">:</span> RouteRecordRaw<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>  <span class="token punctuation">{</span>    name<span class="token punctuation">:</span> PageKey<span class="token punctuation">.</span>LANDING<span class="token punctuation">,</span>    path<span class="token punctuation">:</span> <span class="token string">"/"</span><span class="token punctuation">,</span>    component<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">"~/pages/main/index.vue"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    meta<span class="token punctuation">:</span> <span class="token punctuation">{</span>      layout<span class="token punctuation">:</span> <span class="token string">"landing"</span><span class="token punctuation">,</span>      track<span class="token punctuation">:</span> TRACK_EVENT<span class="token punctuation">.</span>PAGE_LANDING_PAGE<span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">{</span>    name<span class="token punctuation">:</span> PageKey<span class="token punctuation">.</span>LOGIN<span class="token punctuation">,</span>    path<span class="token punctuation">:</span> <span class="token string">"/login"</span><span class="token punctuation">,</span>    component<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">"~/pages/login/index.vue"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    meta<span class="token punctuation">:</span> <span class="token punctuation">{</span>      layout<span class="token punctuation">:</span> <span class="token string">"exposed"</span><span class="token punctuation">,</span>      track<span class="token punctuation">:</span> TRACK_EVENT<span class="token punctuation">.</span>PAGE_LOGIN<span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true">// ...</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token operator">&lt;</span>RouterConfig<span class="token operator">></span><span class="token punctuation">{</span>  routes<span class="token punctuation">:</span> <span class="token punctuation">(</span>_routes<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> routes<span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>SSR è§„åˆ™ï¼ˆ<code>nuxt.config.ts</code>ï¼‰ï¼š</strong></p><pre class="line-numbers language-typescript"><code class="language-typescript">routeRules<span class="token punctuation">:</span> <span class="token punctuation">{</span>  <span class="token string">'/'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> ssr<span class="token punctuation">:</span> <span class="token keyword">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>               <span class="token comment" spellcheck="true">// é¦–é¡µ SSR</span>  <span class="token string">'/auth'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> ssr<span class="token punctuation">:</span> <span class="token keyword">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>          <span class="token comment" spellcheck="true">// æˆæƒé¡µ CSR</span>  <span class="token string">'/template/**'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> ssr<span class="token punctuation">:</span> <span class="token keyword">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token comment" spellcheck="true">// æ¨¡æ¿é¡µ SSR</span>  <span class="token string">'/center/**'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> ssr<span class="token punctuation">:</span> <span class="token keyword">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>     <span class="token comment" spellcheck="true">// ä¸ªäººä¸­å¿ƒ CSR</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Workspace-è·¯ç”±ï¼ˆVue-Routerï¼‰"><a href="#Workspace-è·¯ç”±ï¼ˆVue-Routerï¼‰" class="headerlink" title="Workspace è·¯ç”±ï¼ˆVue Routerï¼‰"></a>Workspace è·¯ç”±ï¼ˆVue Routerï¼‰</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// app/workspace/src/core/routes.ts</span><span class="token keyword">import</span> type <span class="token punctuation">{</span> RouteRecordRaw <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vue-router"</span><span class="token punctuation">;</span><span class="token keyword">export</span> <span class="token keyword">const</span> routes<span class="token punctuation">:</span> RouteRecordRaw<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>  <span class="token punctuation">{</span>    path<span class="token punctuation">:</span> <span class="token string">"/"</span><span class="token punctuation">,</span>    redirect<span class="token punctuation">:</span> <span class="token string">"/home"</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">{</span>    path<span class="token punctuation">:</span> <span class="token string">"/home"</span><span class="token punctuation">,</span>    name<span class="token punctuation">:</span> <span class="token string">"Home"</span><span class="token punctuation">,</span>    component<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">"~/pages/home/index.vue"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    meta<span class="token punctuation">:</span> <span class="token punctuation">{</span> title<span class="token punctuation">:</span> <span class="token string">"é¦–é¡µ"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">{</span>    path<span class="token punctuation">:</span> <span class="token string">"/space"</span><span class="token punctuation">,</span>    name<span class="token punctuation">:</span> <span class="token string">"Space"</span><span class="token punctuation">,</span>    component<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">"~/pages/space/Personal.vue"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    meta<span class="token punctuation">:</span> <span class="token punctuation">{</span> title<span class="token punctuation">:</span> <span class="token string">"æˆ‘çš„ç©ºé—´"</span><span class="token punctuation">,</span> requiresAuth<span class="token punctuation">:</span> <span class="token keyword">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true">// ...</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>è·¯ç”±å®ˆå«ï¼š</strong></p><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// app/workspace/src/main.tsx</span>router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> <span class="token keyword">from</span><span class="token punctuation">,</span> next<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// æƒé™æ£€æŸ¥</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>requiresAuth <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">isLoggedIn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-çŠ¶æ€ç®¡ç†ï¼ˆPiniaï¼‰"><a href="#2-çŠ¶æ€ç®¡ç†ï¼ˆPiniaï¼‰" class="headerlink" title="2. çŠ¶æ€ç®¡ç†ï¼ˆPiniaï¼‰"></a>2. çŠ¶æ€ç®¡ç†ï¼ˆPiniaï¼‰</h3><h4 id="Store-ç»“æ„"><a href="#Store-ç»“æ„" class="headerlink" title="Store ç»“æ„"></a>Store ç»“æ„</h4><pre><code>packages/common/src/store/â”œâ”€â”€ index.ts          # Store å¯¼å‡ºâ”œâ”€â”€ user.ts           # ç”¨æˆ·ä¿¡æ¯â”œâ”€â”€ rights.ts         # æƒé™ä¿¡æ¯â”œâ”€â”€ permission.ts     # æƒé™åˆ¤æ–­â””â”€â”€ option.ts         # é…ç½®é¡¹</code></pre><h4 id="ç¤ºä¾‹ï¼šUser-Store"><a href="#ç¤ºä¾‹ï¼šUser-Store" class="headerlink" title="ç¤ºä¾‹ï¼šUser Store"></a>ç¤ºä¾‹ï¼šUser Store</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// packages/common/src/store/user.ts</span><span class="token keyword">import</span> <span class="token punctuation">{</span> defineStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"pinia"</span><span class="token punctuation">;</span><span class="token keyword">export</span> <span class="token keyword">const</span> useUserStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// State</span>  <span class="token keyword">const</span> userInfo <span class="token operator">=</span> ref<span class="token operator">&lt;</span>UserInfo <span class="token operator">|</span> <span class="token keyword">null</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> token <span class="token operator">=</span> ref<span class="token operator">&lt;</span><span class="token keyword">string</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// Getters</span>  <span class="token keyword">const</span> isLoggedIn <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">!</span><span class="token operator">!</span>token<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> userName <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> userInfo<span class="token punctuation">.</span>value<span class="token operator">?</span><span class="token punctuation">.</span>name <span class="token operator">||</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// Actions</span>  <span class="token keyword">const</span> login <span class="token operator">=</span> async <span class="token punctuation">(</span>credentials<span class="token punctuation">:</span> LoginParams<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> res <span class="token operator">=</span> await <span class="token function">postAuthLogin</span><span class="token punctuation">(</span>credentials<span class="token punctuation">)</span><span class="token punctuation">;</span>    token<span class="token punctuation">.</span>value <span class="token operator">=</span> res<span class="token punctuation">.</span>token<span class="token punctuation">;</span>    userInfo<span class="token punctuation">.</span>value <span class="token operator">=</span> res<span class="token punctuation">.</span>userInfo<span class="token punctuation">;</span>    <span class="token function">setToken</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> logout <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    token<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>    userInfo<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token function">removeToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token punctuation">{</span>    userInfo<span class="token punctuation">,</span>    token<span class="token punctuation">,</span>    isLoggedIn<span class="token punctuation">,</span>    userName<span class="token punctuation">,</span>    login<span class="token punctuation">,</span>    logout<span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ä½¿ç”¨-Store"><a href="#ä½¿ç”¨-Store" class="headerlink" title="ä½¿ç”¨ Store"></a>ä½¿ç”¨ Store</h4><pre class="line-numbers language-vue"><code class="language-vue"><script setup lang="ts">import { useUserStore } from "@rendora/common/store/user";const userStore = useUserStore();const handleLogin = async () => {  await userStore.login({ username, password });  router.push("/home");};</script><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-API-è¯·æ±‚å°è£…"><a href="#3-API-è¯·æ±‚å°è£…" class="headerlink" title="3. API è¯·æ±‚å°è£…"></a>3. API è¯·æ±‚å°è£…</h3><h4 id="è¯·æ±‚æ‹¦æˆªå™¨"><a href="#è¯·æ±‚æ‹¦æˆªå™¨" class="headerlink" title="è¯·æ±‚æ‹¦æˆªå™¨"></a>è¯·æ±‚æ‹¦æˆªå™¨</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// app/platform/api/request.ts</span><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">"axios"</span><span class="token punctuation">;</span><span class="token keyword">const</span> request <span class="token operator">=</span> axios<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  baseURL<span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>NUXT_PUBLIC_API_BASE<span class="token punctuation">,</span>  timeout<span class="token punctuation">:</span> <span class="token number">30000</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// è¯·æ±‚æ‹¦æˆª</span>request<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>request<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> token <span class="token operator">=</span> <span class="token function">getToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span>    config<span class="token punctuation">.</span>headers<span class="token punctuation">.</span>Authorization <span class="token operator">=</span> <span class="token template-string"><span class="token string">`Bearer </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>token<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> config<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// å“åº”æ‹¦æˆª</span>request<span class="token punctuation">.</span>interceptors<span class="token punctuation">.</span>response<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>  <span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> code<span class="token punctuation">,</span> data<span class="token punctuation">,</span> msg <span class="token punctuation">}</span> <span class="token operator">=</span> response<span class="token punctuation">.</span>data<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>code <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">return</span> data<span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>      message<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>response<span class="token operator">?</span><span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">401</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token comment" spellcheck="true">// è·³è½¬ç™»å½•</span>      router<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">export</span> <span class="token keyword">default</span> request<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="API-æ¨¡å—åŒ–"><a href="#API-æ¨¡å—åŒ–" class="headerlink" title="API æ¨¡å—åŒ–"></a>API æ¨¡å—åŒ–</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// app/platform/api/module/user.ts</span><span class="token keyword">import</span> request <span class="token keyword">from</span> <span class="token string">"../request"</span><span class="token punctuation">;</span><span class="token keyword">import</span> type <span class="token punctuation">{</span> UserInfo<span class="token punctuation">,</span> LoginParams <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"../interface/user"</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// ç™»å½•</span><span class="token keyword">export</span> <span class="token keyword">const</span> postAuthLogin <span class="token operator">=</span> <span class="token punctuation">(</span>data<span class="token punctuation">:</span> LoginParams<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> request<span class="token punctuation">.</span>post<span class="token operator">&lt;</span><span class="token punctuation">{</span> token<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">;</span> userInfo<span class="token punctuation">:</span> UserInfo <span class="token punctuation">}</span><span class="token operator">></span><span class="token punctuation">(</span>    <span class="token string">"/auth/login"</span><span class="token punctuation">,</span>    data  <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// è·å–ç”¨æˆ·ä¿¡æ¯</span><span class="token keyword">export</span> <span class="token keyword">const</span> getUserInfo <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> request<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token operator">&lt;</span>UserInfo<span class="token operator">></span><span class="token punctuation">(</span><span class="token string">"/user/info"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// æ›´æ–°ç”¨æˆ·ä¿¡æ¯</span><span class="token keyword">export</span> <span class="token keyword">const</span> putUserUpdate <span class="token operator">=</span> <span class="token punctuation">(</span>data<span class="token punctuation">:</span> Partial<span class="token operator">&lt;</span>UserInfo<span class="token operator">></span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> request<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"/user/update"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-æƒé™ç®¡ç†"><a href="#4-æƒé™ç®¡ç†" class="headerlink" title="4. æƒé™ç®¡ç†"></a>4. æƒé™ç®¡ç†</h3><h4 id="æƒé™æšä¸¾"><a href="#æƒé™æšä¸¾" class="headerlink" title="æƒé™æšä¸¾"></a>æƒé™æšä¸¾</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// packages/common/src/types/enums.ts</span><span class="token comment" spellcheck="true">// ç”¨æˆ·è§’è‰²</span><span class="token keyword">export</span> <span class="token keyword">enum</span> USER_ADMIN <span class="token punctuation">{</span>  SUPER_ADMIN <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// è¶…çº§ç®¡ç†å‘˜</span>  ORG_ADMIN_USER <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// ç»„ç»‡ç®¡ç†å‘˜</span>  MANAGEMENT_PLATFORM <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// å¹³å°ç®¡ç†å‘˜</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// ç”¨æˆ·ç­‰çº§</span><span class="token keyword">export</span> <span class="token keyword">enum</span> USER_LEVEL_KEY <span class="token punctuation">{</span>  TASTE <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// ä½“éªŒç‰ˆ</span>  PERSONAL <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// ä¸ªäººç‰ˆ</span>  TEAM_LIGHT <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// å›¢é˜Ÿè½»é‡ç‰ˆ</span>  ORG_STANDARD <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// ä¼ä¸šæ ‡å‡†ç‰ˆ</span>  ORG_FLAGSHIP <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// ä¼ä¸šæ——èˆ°ç‰ˆ</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="æƒé™åˆ¤æ–­"><a href="#æƒé™åˆ¤æ–­" class="headerlink" title="æƒé™åˆ¤æ–­"></a>æƒé™åˆ¤æ–­</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// packages/common/src/store/permission.ts</span><span class="token keyword">export</span> <span class="token keyword">const</span> usePermissionStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">"permission"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> userStore <span class="token operator">=</span> <span class="token function">useUserStore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// æ£€æŸ¥æ˜¯å¦æœ‰æƒé™</span>  <span class="token keyword">const</span> hasPermission <span class="token operator">=</span> <span class="token punctuation">(</span>requiredRole<span class="token punctuation">:</span> USER_ADMIN<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> userStore<span class="token punctuation">.</span>userInfo<span class="token operator">?</span><span class="token punctuation">.</span>role <span class="token operator">===</span> requiredRole<span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// æ£€æŸ¥ç”¨æˆ·ç­‰çº§</span>  <span class="token keyword">const</span> hasLevel <span class="token operator">=</span> <span class="token punctuation">(</span>requiredLevel<span class="token punctuation">:</span> USER_LEVEL_KEY<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> userStore<span class="token punctuation">.</span>userInfo<span class="token operator">?</span><span class="token punctuation">.</span>level <span class="token operator">>=</span> requiredLevel<span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token punctuation">{</span> hasPermission<span class="token punctuation">,</span> hasLevel <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ä½¿ç”¨æƒé™"><a href="#ä½¿ç”¨æƒé™" class="headerlink" title="ä½¿ç”¨æƒé™"></a>ä½¿ç”¨æƒé™</h4><pre class="line-numbers language-vue"><code class="language-vue"><template>  <!-- æ¡ä»¶æ¸²æŸ“ -->  <div v-if="hasPermission(USER_ADMIN.SUPER_ADMIN)">ç®¡ç†å‘˜åŠŸèƒ½</div>  <!-- æŒ‡ä»¤æ–¹å¼ -->  <a-button v-auth="USER_ADMIN.ORG_ADMIN_USER"> ç»„ç»‡ç®¡ç† </a-button></template><script setup lang="ts">import { usePermissionStore } from "@rendora/common/store/permission";const { hasPermission } = usePermissionStore();</script><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-å›½é™…åŒ–ï¼ˆi18nï¼‰"><a href="#5-å›½é™…åŒ–ï¼ˆi18nï¼‰" class="headerlink" title="5. å›½é™…åŒ–ï¼ˆi18nï¼‰"></a>5. å›½é™…åŒ–ï¼ˆi18nï¼‰</h3><h4 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h4><p><strong>Platformï¼ˆNuxtï¼‰ï¼š</strong></p><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// app/platform/plugins/00.boot.ts</span><span class="token keyword">import</span> <span class="token punctuation">{</span> createI18nService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@rendora/common/services/i18n"</span><span class="token punctuation">;</span><span class="token keyword">import</span> CHS <span class="token keyword">from</span> <span class="token string">"../locales/langs/zh-CN.json"</span><span class="token punctuation">;</span><span class="token keyword">import</span> EN <span class="token keyword">from</span> <span class="token string">"../locales/langs/en-US.json"</span><span class="token punctuation">;</span><span class="token keyword">const</span> i18nSrv <span class="token operator">=</span> <span class="token function">createI18nService</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  legacy<span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">,</span>  globalInjection<span class="token punctuation">:</span> <span class="token keyword">true</span><span class="token punctuation">,</span>  defaultLocale<span class="token punctuation">:</span> <span class="token function">isChinese</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">"zh-CN"</span> <span class="token punctuation">:</span> <span class="token string">"en-US"</span><span class="token punctuation">,</span>  messages<span class="token punctuation">:</span> <span class="token punctuation">{</span>    <span class="token string">"zh-CN"</span><span class="token punctuation">:</span> CHS<span class="token punctuation">,</span>    <span class="token string">"en-US"</span><span class="token punctuation">:</span> EN<span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>await i18nSrv<span class="token punctuation">.</span><span class="token function">initialize</span><span class="token punctuation">(</span>vueApp<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>Workspaceï¼ˆViteï¼‰ï¼š</strong></p><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// app/workspace/src/main.tsx</span><span class="token keyword">import</span> <span class="token punctuation">{</span> createI18n <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vue-i18n"</span><span class="token punctuation">;</span><span class="token keyword">import</span> zhCN <span class="token keyword">from</span> <span class="token string">"./locales/zh-CN.json"</span><span class="token punctuation">;</span><span class="token keyword">import</span> enUS <span class="token keyword">from</span> <span class="token string">"./locales/en-US.json"</span><span class="token punctuation">;</span><span class="token keyword">const</span> i18n <span class="token operator">=</span> <span class="token function">createI18n</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  legacy<span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">,</span>  locale<span class="token punctuation">:</span> <span class="token string">"zh-CN"</span><span class="token punctuation">,</span>  messages<span class="token punctuation">:</span> <span class="token punctuation">{</span>    <span class="token string">"zh-CN"</span><span class="token punctuation">:</span> zhCN<span class="token punctuation">,</span>    <span class="token string">"en-US"</span><span class="token punctuation">:</span> enUS<span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>i18n<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h4><pre class="line-numbers language-vue"><code class="language-vue"><template>  <!-- æ¨¡æ¿ä¸­ -->  <h1>{{ $t("huan-ying") }}</h1>  <p>{{ $t("yong-hu-shu-liang", { count: 100 }) }}</p></template><script setup lang="ts">const { t } = useI18n();// è„šæœ¬ä¸­const title = t("biao-ti");const message = t("xiao-xi-nei-rong", { name: "John" });</script><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="locale-æ–‡ä»¶ç¤ºä¾‹"><a href="#locale-æ–‡ä»¶ç¤ºä¾‹" class="headerlink" title="locale æ–‡ä»¶ç¤ºä¾‹"></a>locale æ–‡ä»¶ç¤ºä¾‹</h4><pre class="line-numbers language-json"><code class="language-json">// zh-CN.json<span class="token punctuation">{</span>  <span class="token property">"huan-ying"</span><span class="token operator">:</span> <span class="token string">"æ¬¢è¿"</span><span class="token punctuation">,</span>  <span class="token property">"yong-hu-shu-liang"</span><span class="token operator">:</span> <span class="token string">"ç”¨æˆ·æ•°é‡ï¼š{count}"</span><span class="token punctuation">,</span>  <span class="token property">"xiao-xi-nei-rong"</span><span class="token operator">:</span> <span class="token string">"ä½ å¥½ï¼Œ{name}"</span><span class="token punctuation">}</span>// en-US.json<span class="token punctuation">{</span>  <span class="token property">"huan-ying"</span><span class="token operator">:</span> <span class="token string">"Welcome"</span><span class="token punctuation">,</span>  <span class="token property">"yong-hu-shu-liang"</span><span class="token operator">:</span> <span class="token string">"User Count: {count}"</span><span class="token punctuation">,</span>  <span class="token property">"xiao-xi-nei-rong"</span><span class="token operator">:</span> <span class="token string">"Hello, {name}"</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="6-OSS-æ–‡ä»¶ä¸Šä¼ "><a href="#6-OSS-æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="6. OSS æ–‡ä»¶ä¸Šä¼ "></a>6. OSS æ–‡ä»¶ä¸Šä¼ </h3><h4 id="é…ç½®-1"><a href="#é…ç½®-1" class="headerlink" title="é…ç½®"></a>é…ç½®</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// app/platform/nuxt.config.ts</span>nuxtOss<span class="token punctuation">:</span> <span class="token punctuation">{</span>  ossRoot<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`youyan-service-platform/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>NUXT_PUBLIC_ENV<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">,</span>  region<span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>NUXT_PUBLIC_AREA <span class="token operator">===</span> <span class="token string">'CN'</span>    <span class="token operator">?</span> <span class="token string">'oss-cn-hangzhou'</span>    <span class="token punctuation">:</span> <span class="token string">'oss-cn-hongkong'</span><span class="token punctuation">,</span>  accessKeyId<span class="token punctuation">:</span> <span class="token string">'YOUR_ACCESS_KEY_ID'</span><span class="token punctuation">,</span>  accessKeySecret<span class="token punctuation">:</span> <span class="token string">'YOUR_ACCESS_KEY_SECRET'</span><span class="token punctuation">,</span>  bucket<span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>NUXT_PUBLIC_AREA <span class="token operator">===</span> <span class="token string">'CN'</span>    <span class="token operator">?</span> <span class="token string">'fe-assets-oss'</span>    <span class="token punctuation">:</span> <span class="token string">'fe-assets-oss-hk'</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ä½¿ç”¨-1"><a href="#ä½¿ç”¨-1" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// packages/common/src/composables/useOSSUpload.ts</span><span class="token keyword">import</span> OSS <span class="token keyword">from</span> <span class="token string">"ali-oss"</span><span class="token punctuation">;</span><span class="token keyword">export</span> <span class="token keyword">const</span> useOSSUpload <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OSS</span><span class="token punctuation">(</span><span class="token punctuation">{</span>    region<span class="token punctuation">:</span> <span class="token string">"oss-cn-hangzhou"</span><span class="token punctuation">,</span>    accessKeyId<span class="token punctuation">:</span> <span class="token string">"xxx"</span><span class="token punctuation">,</span>    accessKeySecret<span class="token punctuation">:</span> <span class="token string">"xxx"</span><span class="token punctuation">,</span>    bucket<span class="token punctuation">:</span> <span class="token string">"your-bucket"</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> uploadFile <span class="token operator">=</span> async <span class="token punctuation">(</span>file<span class="token punctuation">:</span> File<span class="token punctuation">,</span> path<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>      <span class="token keyword">const</span> result <span class="token operator">=</span> await client<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> file<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">return</span> result<span class="token punctuation">.</span>url<span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"ä¸Šä¼ å¤±è´¥"</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">throw</span> error<span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token punctuation">{</span> uploadFile <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="7-åŸ‹ç‚¹ç»Ÿè®¡ï¼ˆç¥ç­–ï¼‰"><a href="#7-åŸ‹ç‚¹ç»Ÿè®¡ï¼ˆç¥ç­–ï¼‰" class="headerlink" title="7. åŸ‹ç‚¹ç»Ÿè®¡ï¼ˆç¥ç­–ï¼‰"></a>7. åŸ‹ç‚¹ç»Ÿè®¡ï¼ˆç¥ç­–ï¼‰</h3><h4 id="åˆå§‹åŒ–"><a href="#åˆå§‹åŒ–" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// app/platform/plugins/06.buried.ts</span><span class="token keyword">import</span> sensors <span class="token keyword">from</span> <span class="token string">"sa-sdk-javascript"</span><span class="token punctuation">;</span>sensors<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  server_url<span class="token punctuation">:</span> runtimeConfig<span class="token punctuation">.</span><span class="token keyword">public</span><span class="token punctuation">.</span>shence<span class="token punctuation">,</span>  is_track_single_page<span class="token punctuation">:</span> <span class="token keyword">true</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ä½¿ç”¨-2"><a href="#ä½¿ç”¨-2" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// é¡µé¢è®¿é—®åŸ‹ç‚¹</span>sensors<span class="token punctuation">.</span><span class="token function">quick</span><span class="token punctuation">(</span><span class="token string">"autoTrackSinglePage"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// è‡ªå®šä¹‰äº‹ä»¶</span>sensors<span class="token punctuation">.</span><span class="token function">track</span><span class="token punctuation">(</span><span class="token string">"ButtonClick"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>  button_name<span class="token punctuation">:</span> <span class="token string">"ç™»å½•"</span><span class="token punctuation">,</span>  page<span class="token punctuation">:</span> <span class="token string">"login"</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// ç”¨æˆ·å±æ€§</span>sensors<span class="token punctuation">.</span><span class="token function">setProfile</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  name<span class="token punctuation">:</span> <span class="token string">"John"</span><span class="token punctuation">,</span>  email<span class="token punctuation">:</span> <span class="token string">"john@example.com"</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å¼€å‘æµç¨‹"><a href="#å¼€å‘æµç¨‹" class="headerlink" title="å¼€å‘æµç¨‹"></a>å¼€å‘æµç¨‹</h2><h3 id="1-æ–°åŠŸèƒ½å¼€å‘æµç¨‹"><a href="#1-æ–°åŠŸèƒ½å¼€å‘æµç¨‹" class="headerlink" title="1. æ–°åŠŸèƒ½å¼€å‘æµç¨‹"></a>1. æ–°åŠŸèƒ½å¼€å‘æµç¨‹</h3><h4 id="Step-1-åˆ›å»ºåŠŸèƒ½åˆ†æ”¯"><a href="#Step-1-åˆ›å»ºåŠŸèƒ½åˆ†æ”¯" class="headerlink" title="Step 1: åˆ›å»ºåŠŸèƒ½åˆ†æ”¯"></a>Step 1: åˆ›å»ºåŠŸèƒ½åˆ†æ”¯</h4><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">git</span> checkout -b feature/new-feature<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="Step-2-å¼€å‘"><a href="#Step-2-å¼€å‘" class="headerlink" title="Step 2: å¼€å‘"></a>Step 2: å¼€å‘</h4><ol><li><strong>åˆ›å»ºé¡µé¢/ç»„ä»¶</strong></li></ol><pre class="line-numbers language-vue"><code class="language-vue"><!-- app/workspace/src/pages/my-page/index.vue --><template>  <div class="my-page">    <h1>{{ $t("biao-ti") }}</h1>  </div></template><script setup lang="ts">// é€»è¾‘</script><style scoped lang="scss">.my-page {  // æ ·å¼}</style><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="2"><li><strong>æ·»åŠ è·¯ç”±</strong></li></ol><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// app/workspace/src/core/routes.ts</span><span class="token punctuation">{</span>  path<span class="token punctuation">:</span> <span class="token string">'/my-page'</span><span class="token punctuation">,</span>  name<span class="token punctuation">:</span> <span class="token string">'MyPage'</span><span class="token punctuation">,</span>  component<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'~/pages/my-page/index.vue'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  meta<span class="token punctuation">:</span> <span class="token punctuation">{</span> title<span class="token punctuation">:</span> <span class="token string">'æˆ‘çš„é¡µé¢'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="3"><li><strong>API æ¥å£</strong></li></ol><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// app/platform/api/module/myModule.ts</span><span class="token keyword">export</span> <span class="token keyword">const</span> getMyData <span class="token operator">=</span> <span class="token punctuation">(</span>params<span class="token punctuation">:</span> <span class="token keyword">any</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> request<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">"/my/data"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> params <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><ol start="4"><li><strong>çŠ¶æ€ç®¡ç†ï¼ˆå¦‚éœ€è¦ï¼‰</strong></li></ol><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// app/workspace/src/shared/store/myStore.ts</span><span class="token keyword">export</span> <span class="token keyword">const</span> useMyStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">"my"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> fetchData <span class="token operator">=</span> async <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    data<span class="token punctuation">.</span>value <span class="token operator">=</span> await <span class="token function">getMyData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token punctuation">{</span> data<span class="token punctuation">,</span> fetchData <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="5"><li><strong>å›½é™…åŒ–</strong></li></ol><pre class="line-numbers language-json"><code class="language-json">// zh-CN.json<span class="token punctuation">{</span>  <span class="token property">"biao-ti"</span><span class="token operator">:</span> <span class="token string">"æˆ‘çš„é¡µé¢"</span><span class="token punctuation">}</span>// en-US.json<span class="token punctuation">{</span>  <span class="token property">"biao-ti"</span><span class="token operator">:</span> <span class="token string">"My Page"</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Step-3-æµ‹è¯•"><a href="#Step-3-æµ‹è¯•" class="headerlink" title="Step 3: æµ‹è¯•"></a>Step 3: æµ‹è¯•</h4><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># å¯åŠ¨å¼€å‘æœåŠ¡å™¨</span>pnpm run dev:cn<span class="token comment" spellcheck="true"># åŠŸèƒ½æµ‹è¯•</span><span class="token comment" spellcheck="true"># æµè§ˆå™¨æµ‹è¯•å„ç§åœºæ™¯</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Step-4-ä»£ç æ£€æŸ¥"><a href="#Step-4-ä»£ç æ£€æŸ¥" class="headerlink" title="Step 4: ä»£ç æ£€æŸ¥"></a>Step 4: ä»£ç æ£€æŸ¥</h4><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># Lint æ£€æŸ¥</span>pnpm run lint:check<span class="token comment" spellcheck="true"># è‡ªåŠ¨ä¿®å¤</span>pnpm run lint<span class="token comment" spellcheck="true"># ç±»å‹æ£€æŸ¥</span>pnpm run type-check<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Step-5-æäº¤ä»£ç "><a href="#Step-5-æäº¤ä»£ç " class="headerlink" title="Step 5: æäº¤ä»£ç "></a>Step 5: æäº¤ä»£ç </h4><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># æ·»åŠ æ–‡ä»¶</span><span class="token function">git</span> add <span class="token keyword">.</span><span class="token comment" spellcheck="true"># æäº¤ï¼ˆä½¿ç”¨äº¤äº’å¼å·¥å…·ï¼‰</span>pnpm run commit<span class="token comment" spellcheck="true"># æˆ–</span><span class="token function">git</span> commit -m <span class="token string">"feat(workspace): æ·»åŠ æˆ‘çš„é¡µé¢åŠŸèƒ½"</span><span class="token comment" spellcheck="true"># æ¨é€</span><span class="token function">git</span> push origin feature/new-feature<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Step-6-åˆ›å»º-Pull-Request"><a href="#Step-6-åˆ›å»º-Pull-Request" class="headerlink" title="Step 6: åˆ›å»º Pull Request"></a>Step 6: åˆ›å»º Pull Request</h4><p>åœ¨ Git å¹³å°åˆ›å»º PRï¼Œç­‰å¾… Code Reviewã€‚</p><h3 id="2-Bug-ä¿®å¤æµç¨‹"><a href="#2-Bug-ä¿®å¤æµç¨‹" class="headerlink" title="2. Bug ä¿®å¤æµç¨‹"></a>2. Bug ä¿®å¤æµç¨‹</h3><h4 id="Step-1-å®šä½é—®é¢˜"><a href="#Step-1-å®šä½é—®é¢˜" class="headerlink" title="Step 1: å®šä½é—®é¢˜"></a>Step 1: å®šä½é—®é¢˜</h4><ul><li>å¤ç° bug</li><li>æŸ¥çœ‹é”™è¯¯æ—¥å¿—</li><li>ä½¿ç”¨ Vue DevTools è°ƒè¯•</li><li>æ£€æŸ¥ç½‘ç»œè¯·æ±‚</li></ul><h4 id="Step-2-ä¿®å¤"><a href="#Step-2-ä¿®å¤" class="headerlink" title="Step 2: ä¿®å¤"></a>Step 2: ä¿®å¤</h4><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">git</span> checkout -b fix/bug-description<span class="token comment" spellcheck="true"># ä¿®æ”¹ä»£ç </span><span class="token function">git</span> commit -m <span class="token string">"fix(platform): ä¿®å¤ç™»å½•é¡µæ ·å¼é—®é¢˜"</span><span class="token function">git</span> push origin fix/bug-description<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="Step-3-æµ‹è¯•éªŒè¯"><a href="#Step-3-æµ‹è¯•éªŒè¯" class="headerlink" title="Step 3: æµ‹è¯•éªŒè¯"></a>Step 3: æµ‹è¯•éªŒè¯</h4><p>ç¡®ä¿ä¿®å¤åä¸å½±å“å…¶ä»–åŠŸèƒ½ã€‚</p><h3 id="3-Code-Review-æ¸…å•"><a href="#3-Code-Review-æ¸…å•" class="headerlink" title="3. Code Review æ¸…å•"></a>3. Code Review æ¸…å•</h3><ul><li><input disabled="" type="checkbox"> ä»£ç é£æ ¼ç¬¦åˆè§„èŒƒ</li><li><input disabled="" type="checkbox"> æ²¡æœ‰ console.log ç­‰è°ƒè¯•ä»£ç </li><li><input disabled="" type="checkbox"> å›½é™…åŒ–æ–‡æœ¬å·²æå–</li><li><input disabled="" type="checkbox"> ç±»å‹å®šä¹‰å®Œæ•´</li><li><input disabled="" type="checkbox"> ç»„ä»¶å¯å¤ç”¨æ€§</li><li><input disabled="" type="checkbox"> æ€§èƒ½è€ƒè™‘ï¼ˆé¿å…ä¸å¿…è¦çš„æ¸²æŸ“ï¼‰</li><li><input disabled="" type="checkbox"> é”™è¯¯å¤„ç†</li><li><input disabled="" type="checkbox"> æµ‹è¯•è¦†ç›–</li></ul><h2 id="å¸¸è§é—®é¢˜"><a href="#å¸¸è§é—®é¢˜" class="headerlink" title="å¸¸è§é—®é¢˜"></a>å¸¸è§é—®é¢˜</h2><h3 id="1-ä¾èµ–å®‰è£…é—®é¢˜"><a href="#1-ä¾èµ–å®‰è£…é—®é¢˜" class="headerlink" title="1. ä¾èµ–å®‰è£…é—®é¢˜"></a>1. ä¾èµ–å®‰è£…é—®é¢˜</h3><p><strong>é—®é¢˜ï¼š</strong> <code>pnpm install</code> å¤±è´¥</p><p><strong>è§£å†³ï¼š</strong></p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># æ¸…ç†ç¼“å­˜</span>pnpm store prune<span class="token comment" spellcheck="true"># åˆ é™¤ node_modules</span><span class="token function">rm</span> -rf node_modules<span class="token comment" spellcheck="true"># åˆ é™¤ lock æ–‡ä»¶ï¼ˆè°¨æ…ï¼‰</span><span class="token function">rm</span> pnpm-lock.yaml<span class="token comment" spellcheck="true"># é‡æ–°å®‰è£…</span>pnpm <span class="token function">install</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-ç«¯å£å ç”¨"><a href="#2-ç«¯å£å ç”¨" class="headerlink" title="2. ç«¯å£å ç”¨"></a>2. ç«¯å£å ç”¨</h3><p><strong>é—®é¢˜ï¼š</strong> ç«¯å£ 3000 æˆ– 8888 è¢«å ç”¨</p><p><strong>è§£å†³ï¼š</strong></p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># æŸ¥æ‰¾å ç”¨è¿›ç¨‹ï¼ˆWindowsï¼‰</span><span class="token function">netstat</span> -ano <span class="token operator">|</span> findstr :3000<span class="token comment" spellcheck="true"># æ€æ­»è¿›ç¨‹</span>taskkill /PID <span class="token operator">&lt;</span>PID<span class="token operator">></span> /F<span class="token comment" spellcheck="true"># æˆ–ä¿®æ”¹ç«¯å£</span><span class="token comment" spellcheck="true"># Platform: nuxt.config.ts -> devServer.port</span><span class="token comment" spellcheck="true"># Workspace: vite.config.ts -> server.port</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-TypeScript-ç±»å‹é”™è¯¯"><a href="#3-TypeScript-ç±»å‹é”™è¯¯" class="headerlink" title="3. TypeScript ç±»å‹é”™è¯¯"></a>3. TypeScript ç±»å‹é”™è¯¯</h3><p><strong>é—®é¢˜ï¼š</strong> å¯¼å…¥ workspace åŒ…æ—¶ç±»å‹æ‰¾ä¸åˆ°</p><p><strong>è§£å†³ï¼š</strong></p><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// tsconfig.json</span><span class="token punctuation">{</span>  <span class="token string">"compilerOptions"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>    <span class="token string">"paths"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>      <span class="token string">"@rendora/common/*"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"../../packages/common/src/*"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>      <span class="token string">"@rendora/design/*"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"../../packages/design/src/*"</span><span class="token punctuation">]</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-æ ·å¼ä¸ç”Ÿæ•ˆ"><a href="#4-æ ·å¼ä¸ç”Ÿæ•ˆ" class="headerlink" title="4. æ ·å¼ä¸ç”Ÿæ•ˆ"></a>4. æ ·å¼ä¸ç”Ÿæ•ˆ</h3><p><strong>é—®é¢˜ï¼š</strong> TailwindCSS ç±»åä¸ç”Ÿæ•ˆ</p><p><strong>è§£å†³ï¼š</strong></p><p>æ£€æŸ¥ <code>tailwind.config.js</code> çš„ content é…ç½®ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>  content<span class="token punctuation">:</span> <span class="token punctuation">[</span>    <span class="token string">"./src/**/*.{vue,js,ts,jsx,tsx}"</span><span class="token punctuation">,</span>    <span class="token string">"../../packages/common/src/**/*.{vue,js,ts,jsx,tsx}"</span><span class="token punctuation">,</span>    <span class="token string">"../../packages/design/src/**/*.{vue,js,ts,jsx,tsx}"</span><span class="token punctuation">,</span>  <span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-è·¨åŸŸé—®é¢˜"><a href="#5-è·¨åŸŸé—®é¢˜" class="headerlink" title="5. è·¨åŸŸé—®é¢˜"></a>5. è·¨åŸŸé—®é¢˜</h3><p><strong>é—®é¢˜ï¼š</strong> æœ¬åœ°å¼€å‘ API è¯·æ±‚è·¨åŸŸ</p><p><strong>è§£å†³ï¼š</strong></p><p>å†…ç½‘å¼€å‘å·²å¼€å¯è·¨åŸŸï¼Œæ— éœ€é…ç½®ã€‚å¦‚é‡ç‰¹æ®Šæƒ…å†µï¼Œä½¿ç”¨ whistle.js ä»£ç†ï¼š</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># å®‰è£… whistle</span><span class="token function">npm</span> <span class="token function">install</span> -g whistle<span class="token comment" spellcheck="true"># å¯åŠ¨</span>w2 start<span class="token comment" spellcheck="true"># é…ç½®è§„åˆ™ï¼ˆwhistle ç•Œé¢ï¼‰</span>api.example.com 127.0.0.1:3000<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="6-Nuxt-æ„å»ºé”™è¯¯"><a href="#6-Nuxt-æ„å»ºé”™è¯¯" class="headerlink" title="6. Nuxt æ„å»ºé”™è¯¯"></a>6. Nuxt æ„å»ºé”™è¯¯</h3><p><strong>é—®é¢˜ï¼š</strong> <code>nuxt build</code> å¤±è´¥</p><p><strong>è§£å†³ï¼š</strong></p><p><strong>æ¸…ç†ç¼“å­˜</strong></p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">rm</span> -rf .nuxt .output node_modules/.cache<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>æ£€æŸ¥åŠ¨æ€å¯¼å…¥</strong></p><p>ç¡®ä¿æ‰€æœ‰å¼‚æ­¥ç»„ä»¶æ­£ç¡®å¯¼å…¥ï¼š</p><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// âœ… æ­£ç¡®</span>component<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">"~/pages/home/index.vue"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// âŒ é”™è¯¯</span>component<span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"~/pages/home/index.vue"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="7-i18n-æå–å¤±è´¥"><a href="#7-i18n-æå–å¤±è´¥" class="headerlink" title="7. i18n æå–å¤±è´¥"></a>7. i18n æå–å¤±è´¥</h3><p><strong>é—®é¢˜ï¼š</strong> i18n Ally æ— æ³•æå–æ–‡æœ¬</p><p><strong>è§£å†³ï¼š</strong></p><ul><li>æ£€æŸ¥ <code>.vscode/settings.json</code> é…ç½®</li><li>ç¡®ä¿å®‰è£…äº† i18n Ally æ’ä»¶</li><li>é‡å¯ VSCode</li></ul><h3 id="8-Git-Hooks-ä¸ç”Ÿæ•ˆ"><a href="#8-Git-Hooks-ä¸ç”Ÿæ•ˆ" class="headerlink" title="8. Git Hooks ä¸ç”Ÿæ•ˆ"></a>8. Git Hooks ä¸ç”Ÿæ•ˆ</h3><p><strong>é—®é¢˜ï¼š</strong> æäº¤æ—¶æ²¡æœ‰è§¦å‘ lint æ£€æŸ¥</p><p><strong>è§£å†³ï¼š</strong></p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># é‡æ–°å®‰è£… husky</span>pnpm run prepare<span class="token comment" spellcheck="true"># æ£€æŸ¥ .husky ç›®å½•</span><span class="token function">ls</span> -la .husky<span class="token comment" spellcheck="true"># ç¡®ä¿è„šæœ¬æœ‰æ‰§è¡Œæƒé™</span><span class="token function">chmod</span> +x .husky/*<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="éƒ¨ç½²è¯´æ˜"><a href="#éƒ¨ç½²è¯´æ˜" class="headerlink" title="éƒ¨ç½²è¯´æ˜"></a>éƒ¨ç½²è¯´æ˜</h2><h3 id="æ„å»º"><a href="#æ„å»º" class="headerlink" title="æ„å»º"></a>æ„å»º</h3><h4 id="Platform-æ„å»º"><a href="#Platform-æ„å»º" class="headerlink" title="Platform æ„å»º"></a>Platform æ„å»º</h4><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">cd</span> app/platform<span class="token comment" spellcheck="true"># æ„å»ºå¼€å‘ç¯å¢ƒ</span>pnpm run build:dev:cnpnpm run build:dev:us<span class="token comment" spellcheck="true"># æ„å»ºæµ‹è¯•ç¯å¢ƒ</span>pnpm run build:qa:cnpnpm run build:qa:us<span class="token comment" spellcheck="true"># æ„å»ºé¢„å‘ç¯å¢ƒ</span>pnpm run build:pre:cnpnpm run build:pre:us<span class="token comment" spellcheck="true"># æ„å»ºç”Ÿäº§ç¯å¢ƒ</span>pnpm run build:main:cnpnpm run build:main:us<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>äº§ç‰©ï¼š<code>.output/</code> ç›®å½•</p><h4 id="Workspace-æ„å»º"><a href="#Workspace-æ„å»º" class="headerlink" title="Workspace æ„å»º"></a>Workspace æ„å»º</h4><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">cd</span> app/workspace<span class="token comment" spellcheck="true"># æ„å»ºå¼€å‘ç¯å¢ƒ</span>pnpm run build:dev:cnpnpm run build:dev:us<span class="token comment" spellcheck="true"># æ„å»ºæµ‹è¯•ç¯å¢ƒ</span>pnpm run build:qa:cnpnpm run build:qa:us<span class="token comment" spellcheck="true"># æ„å»ºé¢„å‘ç¯å¢ƒ</span>pnpm run build:pre:cnpnpm run build:pre:us<span class="token comment" spellcheck="true"># æ„å»ºç”Ÿäº§ç¯å¢ƒ</span>pnpm run build:main:cnpnpm run build:main:us<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>äº§ç‰©ï¼š<code>dist/</code> ç›®å½•</p><h3 id="éƒ¨ç½²æ–¹å¼"><a href="#éƒ¨ç½²æ–¹å¼" class="headerlink" title="éƒ¨ç½²æ–¹å¼"></a>éƒ¨ç½²æ–¹å¼</h3><h4 id="1-Nginx-éƒ¨ç½²"><a href="#1-Nginx-éƒ¨ç½²" class="headerlink" title="1. Nginx éƒ¨ç½²"></a>1. Nginx éƒ¨ç½²</h4><p><strong>Platformï¼ˆSSRï¼‰ï¼š</strong></p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># å¯åŠ¨ Nuxt æœåŠ¡</span>node .output/server/index.mjs<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>Nginx é…ç½®ï¼š</strong></p><pre class="line-numbers language-nginx"><code class="language-nginx"><span class="token keyword">server</span> <span class="token punctuation">{</span>  <span class="token keyword">listen</span> <span class="token number">80</span><span class="token punctuation">;</span>  <span class="token keyword">server_name</span> youyan3d<span class="token punctuation">.</span>com<span class="token punctuation">;</span>  <span class="token keyword">location</span> <span class="token operator">/</span> <span class="token punctuation">{</span>    <span class="token keyword">proxy_pass</span> <span class="token keyword">http</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token punctuation">:</span><span class="token number">3000</span><span class="token punctuation">;</span>    <span class="token keyword">proxy_http_version</span> <span class="token number">1.1</span><span class="token punctuation">;</span>    <span class="token keyword">proxy_set_header</span> Upgrade <span class="token variable">$http_upgrade</span><span class="token punctuation">;</span>    <span class="token keyword">proxy_set_header</span> Connection <span class="token string">'upgrade'</span><span class="token punctuation">;</span>    <span class="token keyword">proxy_set_header</span> Host <span class="token variable">$host</span><span class="token punctuation">;</span>    <span class="token keyword">proxy_cache_bypass</span> <span class="token variable">$http_upgrade</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>Workspaceï¼ˆSPAï¼‰ï¼š</strong></p><p><strong>Nginx é…ç½®ï¼š</strong></p><pre class="line-numbers language-nginx"><code class="language-nginx"><span class="token keyword">server</span> <span class="token punctuation">{</span>  <span class="token keyword">listen</span> <span class="token number">80</span><span class="token punctuation">;</span>  <span class="token keyword">server_name</span> workspace<span class="token punctuation">.</span>youyan3d<span class="token punctuation">.</span>com<span class="token punctuation">;</span>  <span class="token keyword">root</span> <span class="token operator">/</span>var<span class="token operator">/</span>www<span class="token operator">/</span>workspace<span class="token operator">/</span>dist<span class="token punctuation">;</span>  <span class="token keyword">index</span> <span class="token keyword">index</span><span class="token punctuation">.</span>html<span class="token punctuation">;</span>  <span class="token keyword">location</span> <span class="token operator">/</span> <span class="token punctuation">{</span>    <span class="token keyword">try_files</span> <span class="token variable">$uri</span> <span class="token variable">$uri</span><span class="token operator">/</span> <span class="token operator">/</span><span class="token keyword">index</span><span class="token punctuation">.</span>html<span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token comment" spellcheck="true"># é™æ€èµ„æºç¼“å­˜</span>  <span class="token keyword">location</span> <span class="token operator">~</span><span class="token operator">*</span> \<span class="token punctuation">.</span><span class="token punctuation">(</span>js<span class="token operator">|</span>css<span class="token operator">|</span>png<span class="token operator">|</span>jpg<span class="token operator">|</span>jpeg<span class="token operator">|</span>gif<span class="token operator">|</span>ico<span class="token operator">|</span>svg<span class="token operator">|</span>woff<span class="token operator">|</span>woff2<span class="token operator">|</span>ttf<span class="token punctuation">)</span>$ <span class="token punctuation">{</span>    <span class="token keyword">expires</span> 1y<span class="token punctuation">;</span>    <span class="token keyword">add_header</span> Cache<span class="token operator">-</span>Control <span class="token string">"public, immutable"</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-Docker-éƒ¨ç½²"><a href="#2-Docker-éƒ¨ç½²" class="headerlink" title="2. Docker éƒ¨ç½²"></a>2. Docker éƒ¨ç½²</h4><p><strong>Platform Dockerfileï¼š</strong></p><pre class="line-numbers language-dockerfile"><code class="language-dockerfile"># app/platform/dockerfileFROM node:20-alpineWORKDIR /appCOPY .output /app/.outputENV HOST=0.0.0.0ENV PORT=3000EXPOSE 3000CMD ["node", ".output/server/index.mjs"]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>Workspace Dockerfileï¼š</strong></p><pre class="line-numbers language-dockerfile"><code class="language-dockerfile"># app/workspace/dockerfileFROM nginx:alpineCOPY dist /usr/share/nginx/htmlCOPY nginx.conf /etc/nginx/conf.d/default.confEXPOSE 80CMD ["nginx", "-g", "daemon off;"]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>æ„å»ºå’Œè¿è¡Œï¼š</strong></p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># Platform</span>docker build -t youyan-platform -f app/platform/dockerfile app/platformdocker run -p 3000:3000 youyan-platform<span class="token comment" spellcheck="true"># Workspace</span>docker build -t youyan-workspace -f app/workspace/dockerfile app/workspacedocker run -p 80:80 youyan-workspace<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3-PM2-éƒ¨ç½²"><a href="#3-PM2-éƒ¨ç½²" class="headerlink" title="3. PM2 éƒ¨ç½²"></a>3. PM2 éƒ¨ç½²</h4><p><strong>å®‰è£… PM2ï¼š</strong></p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> -g pm2<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>Platform é…ç½®ï¼š</strong></p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// app/platform/ecosystem.config.cjs</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>  apps<span class="token punctuation">:</span> <span class="token punctuation">[</span>    <span class="token punctuation">{</span>      name<span class="token punctuation">:</span> <span class="token string">"youyan-platform"</span><span class="token punctuation">,</span>      script<span class="token punctuation">:</span> <span class="token string">".output/server/index.mjs"</span><span class="token punctuation">,</span>      instances<span class="token punctuation">:</span> <span class="token string">"max"</span><span class="token punctuation">,</span>      exec_mode<span class="token punctuation">:</span> <span class="token string">"cluster"</span><span class="token punctuation">,</span>      env<span class="token punctuation">:</span> <span class="token punctuation">{</span>        NODE_ENV<span class="token punctuation">:</span> <span class="token string">"production"</span><span class="token punctuation">,</span>        PORT<span class="token punctuation">:</span> <span class="token number">3000</span><span class="token punctuation">,</span>      <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>å¯åŠ¨ï¼š</strong></p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">cd</span> app/platformpm2 start ecosystem.config.cjspm2 savepm2 startup<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="CDN-éƒ¨ç½²"><a href="#CDN-éƒ¨ç½²" class="headerlink" title="CDN éƒ¨ç½²"></a>CDN éƒ¨ç½²</h3><p><strong>è‡ªåŠ¨ä¸Šä¼ åˆ° OSSï¼š</strong></p><p>æ„å»ºæ—¶è‡ªåŠ¨ä¸Šä¼ é™æ€èµ„æºåˆ°é˜¿é‡Œäº‘ OSSï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰ï¼š</p><ul><li>Platform: nuxt-oss æ’ä»¶</li><li>Workspace: vite-plugin-oss-upload æ’ä»¶</li></ul><p><strong>é…ç½®ï¼š</strong></p><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// app/workspace/vite.config.ts</span><span class="token function">vitePluginOSSUpload</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  region<span class="token punctuation">:</span> <span class="token string">"oss-cn-hangzhou"</span><span class="token punctuation">,</span>  accessKeyId<span class="token punctuation">:</span> <span class="token string">"YOUR_KEY"</span><span class="token punctuation">,</span>  accessKeySecret<span class="token punctuation">:</span> <span class="token string">"YOUR_SECRET"</span><span class="token punctuation">,</span>  bucket<span class="token punctuation">:</span> <span class="token string">"fe-assets-oss"</span><span class="token punctuation">,</span>  remotePath<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`workspace/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>GIT_COMMIT_SHA<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">,</span>  gzip<span class="token punctuation">:</span> <span class="token keyword">true</span><span class="token punctuation">,</span>  cacheControl<span class="token punctuation">:</span> <span class="token string">"public, max-age=31536000"</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>è®¿é—®ï¼š</strong></p><pre><code>https://fe-assets-cdn.youyan3d.com/workspace/latest/assets/index.js</code></pre><h3 id="ç¯å¢ƒå˜é‡"><a href="#ç¯å¢ƒå˜é‡" class="headerlink" title="ç¯å¢ƒå˜é‡"></a>ç¯å¢ƒå˜é‡</h3><p>ç”Ÿäº§ç¯å¢ƒéœ€é…ç½®ç¯å¢ƒå˜é‡ï¼ˆé€šè¿‡ .env æ–‡ä»¶æˆ–å®¹å™¨ç¯å¢ƒå˜é‡ï¼‰ï¼š</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># API</span>NUXT_PUBLIC_API_BASE<span class="token operator">=</span>https://api.youyan3d.comNUXT_PUBLIC_API_DOMAIN<span class="token operator">=</span>youyan3d.com<span class="token comment" spellcheck="true"># ç¯å¢ƒ</span>NUXT_PUBLIC_ENV<span class="token operator">=</span>productionNUXT_PUBLIC_AREA<span class="token operator">=</span>CN<span class="token comment" spellcheck="true"># OSS</span>NUXT_PUBLIC_FE_OSS<span class="token operator">=</span>https://fe-assets-cdn.youyan3d.comNUXT_PUBLIC_BE_OSS<span class="token operator">=</span>https://media.youyan3d.com<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="é™„å½•"><a href="#é™„å½•" class="headerlink" title="é™„å½•"></a>é™„å½•</h2><h3 id="å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥"><a href="#å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥" class="headerlink" title="å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥"></a>å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># å®‰è£…ä¾èµ–</span>pnpm <span class="token function">install</span><span class="token comment" spellcheck="true"># å¯åŠ¨å¼€å‘æœåŠ¡å™¨</span><span class="token function">cd</span> app/platform <span class="token operator">&amp;&amp;</span> pnpm run dev:cn<span class="token function">cd</span> app/workspace <span class="token operator">&amp;&amp;</span> pnpm run dev:cn<span class="token comment" spellcheck="true"># æ„å»º</span><span class="token function">cd</span> app/platform <span class="token operator">&amp;&amp;</span> pnpm run build:main:cn<span class="token function">cd</span> app/workspace <span class="token operator">&amp;&amp;</span> pnpm run build:main:cn<span class="token comment" spellcheck="true"># ä»£ç æ£€æŸ¥</span>pnpm run lint:check          <span class="token comment" spellcheck="true"># æ£€æŸ¥</span>pnpm run lint                <span class="token comment" spellcheck="true"># è‡ªåŠ¨ä¿®å¤</span>pnpm run <span class="token function">format</span>              <span class="token comment" spellcheck="true"># æ ¼å¼åŒ–</span><span class="token comment" spellcheck="true"># ç±»å‹æ£€æŸ¥</span>pnpm run type-check<span class="token comment" spellcheck="true"># Git æäº¤</span>pnpm run commit              <span class="token comment" spellcheck="true"># äº¤äº’å¼æäº¤</span><span class="token function">git</span> commit -m <span class="token string">"feat: xxx"</span>    <span class="token comment" spellcheck="true"># ç›´æ¥æäº¤</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="VSCode-æ¨èæ’ä»¶"><a href="#VSCode-æ¨èæ’ä»¶" class="headerlink" title="VSCode æ¨èæ’ä»¶"></a>VSCode æ¨èæ’ä»¶</h3><ul><li><strong>Vue Language Features (Volar)</strong> - Vue 3 æ”¯æŒ</li><li><strong>TypeScript Vue Plugin (Volar)</strong> - Vue TS æ”¯æŒ</li><li><strong>ESLint</strong> - ä»£ç æ£€æŸ¥</li><li><strong>Prettier</strong> - ä»£ç æ ¼å¼åŒ–</li><li><strong>i18n Ally</strong> - å›½é™…åŒ–ç®¡ç†</li><li><strong>TailwindCSS IntelliSense</strong> - TailwindCSS æç¤º</li><li><strong>Error Lens</strong> - è¡Œå†…é”™è¯¯æç¤º</li><li><strong>GitLens</strong> - Git å¢å¼º</li><li><strong>Path Intellisense</strong> - è·¯å¾„è‡ªåŠ¨è¡¥å…¨</li><li><strong>Auto Rename Tag</strong> - è‡ªåŠ¨é‡å‘½åæ ‡ç­¾</li><li><strong>Code Spell Checker</strong> - æ‹¼å†™æ£€æŸ¥</li></ul><h3 id="å…³é”®é…ç½®æ–‡ä»¶"><a href="#å…³é”®é…ç½®æ–‡ä»¶" class="headerlink" title="å…³é”®é…ç½®æ–‡ä»¶"></a>å…³é”®é…ç½®æ–‡ä»¶</h3><table><thead><tr><th>æ–‡ä»¶</th><th>ç”¨é€”</th></tr></thead><tbody><tr><td><code>pnpm-workspace.yaml</code></td><td>Monorepo é…ç½®</td></tr><tr><td><code>package.json</code></td><td>ä¾èµ–å’Œè„šæœ¬</td></tr><tr><td><code>eslint.config.js</code></td><td>ESLint é…ç½®</td></tr><tr><td><code>commitlint.config.js</code></td><td>æäº¤è§„èŒƒ</td></tr><tr><td><code>app/platform/nuxt.config.ts</code></td><td>Nuxt é…ç½®</td></tr><tr><td><code>app/workspace/vite.config.ts</code></td><td>Vite é…ç½®</td></tr><tr><td><code>tailwind.config.js</code></td><td>TailwindCSS é…ç½®</td></tr><tr><td><code>tsconfig.json</code></td><td>TypeScript é…ç½®</td></tr></tbody></table><h3 id="æŠ€æœ¯æ–‡æ¡£é“¾æ¥"><a href="#æŠ€æœ¯æ–‡æ¡£é“¾æ¥" class="headerlink" title="æŠ€æœ¯æ–‡æ¡£é“¾æ¥"></a>æŠ€æœ¯æ–‡æ¡£é“¾æ¥</h3><ul><li><a href="https://cn.vuejs.org/">Vue 3 å®˜æ–¹æ–‡æ¡£</a></li><li><a href="https://nuxt.com/">Nuxt 3 å®˜æ–¹æ–‡æ¡£</a></li><li><a href="https://cn.vitejs.dev/">Vite å®˜æ–¹æ–‡æ¡£</a></li><li><a href="https://pinia.vuejs.org/zh/">Pinia å®˜æ–¹æ–‡æ¡£</a></li><li><a href="https://tailwindcss.com/">TailwindCSS å®˜æ–¹æ–‡æ¡£</a></li><li><a href="https://antdv.com/">Ant Design Vue å®˜æ–¹æ–‡æ¡£</a></li><li><a href="https://www.typescriptlang.org/zh/">TypeScript å®˜æ–¹æ–‡æ¡£</a></li><li><a href="https://pnpm.io/zh/">pnpm å®˜æ–¹æ–‡æ¡£</a></li></ul><h3 id="é¡¹ç›®è”ç³»äºº"><a href="#é¡¹ç›®è”ç³»äºº" class="headerlink" title="é¡¹ç›®è”ç³»äºº"></a>é¡¹ç›®è”ç³»äºº</h3><ul><li>å‰ç«¯è´Ÿè´£äººï¼š[è”ç³»æ–¹å¼]</li><li>æŠ€æœ¯æ”¯æŒï¼š[è”ç³»æ–¹å¼]</li><li>é¡¹ç›®æ–‡æ¡£ï¼š[æ–‡æ¡£åœ°å€]</li><li>ä»£ç ä»“åº“ï¼š[Git åœ°å€]</li></ul><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> é¡¹ç›®æ–‡æ¡£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue3 </tag>
            
            <tag> Monorepo </tag>
            
            <tag> é¡¹ç›®æ–‡æ¡£ </tag>
            
            <tag> Nuxt3 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœ‰çµ Pro</title>
      <link href="/2025/12/01/youling-pro/"/>
      <url>/2025/12/01/youling-pro/</url>
      
        <content type="html"><![CDATA[<h1 id="æœ‰çµ-Pro"><a href="#æœ‰çµ-Pro" class="headerlink" title="æœ‰çµ Pro"></a>æœ‰çµ Pro</h1><h2 id="1-ç›®å½•ç»“æ„"><a href="#1-ç›®å½•ç»“æ„" class="headerlink" title="1. ç›®å½•ç»“æ„"></a>1. ç›®å½•ç»“æ„</h2><pre class="line-numbers language-json"><code class="language-json">- electron                        // Electron ä¸»çº¿ç¨‹éƒ¨åˆ†ä»£ç - envs                            // ç¯å¢ƒå˜é‡- plugins                         // Vite æ’ä»¶- public                          // æ¸²æŸ“çº¿ç¨‹èµ„æºæ–‡ä»¶- resources                       // åº”ç”¨ç¨‹åºèµ„æºæ–‡ä»¶- src                             // æ¸²æŸ“çº¿ç¨‹æºç   - apis                          // åç«¯æ¥å£  - components                    // å…¬å…±ç»„ä»¶  - core    - interaction-composite       // é€šç”¨äº¤äº’é€»è¾‘    - speech-recognizer           // è¯­éŸ³è¯†åˆ«å¼•æ“    - ttsa-renderer               // ttsa æ¸²æŸ“å™¨  - hooks                         // é€šç”¨ hooks  - layout                        // Electron åº”ç”¨è‡ªç»˜ç•Œé¢å¸ƒå±€  - pages    - face                        // æœ¬åœ°äººè„¸è¯†åˆ«æœåŠ¡å¯åŠ¨çš„ç‹¬ç«‹é¡µé¢    - home                        // ä¸»è¦ä¸šåŠ¡é€»è¾‘é¡µé¢    - login                       // ç™»å½•é¡µ    - preview                     // Web æ¨¡å¼ä¸‹è‡ªåŠ¨ç™»å½•é¡µé¢    - setting                     // è®¾ç½®é¡µé¢  - router                        // è·¯ç”±é…ç½®  - shared                        // å…¨å±€å…±äº«å˜é‡  - stores    - store-asr                   // è¯­éŸ³è¯†åˆ«æœåŠ¡    - store-awaken                // æœ¬åœ°è¯­éŸ³å”¤é†’æœåŠ¡    - store-dev                   // å¼€å‘è€…å·¥å…·    - store-face                  // äººè„¸è¯†åˆ«æœåŠ¡    - store-setting               // æœ¬åœ°é…ç½®é¡¹    - store-state                 // åº”ç”¨çŠ¶æ€    - store-ttsa                  // æ•°å­—äººæœåŠ¡    - store-user                  // ç”¨æˆ·çŠ¶æ€  - styles                        // æ ·å¼  - ui                            // ä¸šåŠ¡ç»„ä»¶    - ui-asr-animation            // è¯­éŸ³è¯†åˆ«åŠ¨æ•ˆ    - ui-asr-result               // è¯­éŸ³è¯†åˆ«ç»“æœ    - ui-entry-bubble             // å¿«é€Ÿå…¥å£    - ui-entry-display            // ç‰©æ–™å¼¹å‡ºå±•ç¤ºçª—å£    - ui-material                 // å¤šæ¨¡æ€å†…å®¹å±•ç¤ºç»„ä»¶    - ui-multimodal-conversation  // æ°”æ³¡æ¨¡å¼ä¼šè¯åˆ—è¡¨    - ui-subtitle                 // å­—å¹•æ¨¡å¼    - ui-welcome-bubble           // æ¬¢è¿è¯­æ–™  - utils                         // é€šç”¨å·¥å…·- types                           // ç±»å‹å£°æ˜<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="2-æ¶æ„è®¾è®¡"><a href="#2-æ¶æ„è®¾è®¡" class="headerlink" title="2. æ¶æ„è®¾è®¡"></a>2. æ¶æ„è®¾è®¡</h2><h3 id="2-1-æ•°å­—äºº"><a href="#2-1-æ•°å­—äºº" class="headerlink" title="2.1 æ•°å­—äºº"></a>2.1 æ•°å­—äºº</h3><p>é€šè¿‡æ•°å­—äºº SDKï¼ˆ<code>public/libs/ttsa.*.js</code>ï¼‰å’Œåç«¯ API ï¼ˆ<code>src/apis/action.ts</code>ï¼‰è¿›è¡Œé©±åŠ¨ã€‚</p><p>å…¶çŠ¶æ€é€šè¿‡ <code>src/stores/store-ttsa/store-ttsa.ts</code> è¿›è¡Œç®¡ç†ã€‚</p><p>è¯·æ³¨æ„ï¼Œä½ éœ€è¦è‡ªè¡Œç®¡ç†æ•°å­—äººçš„çŠ¶æ€ï¼Œå¹¶åœ¨ä¸šåŠ¡éœ€è¦çš„èŠ‚ç‚¹ä¸»åŠ¨è°ƒç”¨é©±åŠ¨æˆ–æ‰“æ–­æ–¹æ³•ã€‚</p><h3 id="2-2-è¯­éŸ³è¯†åˆ«"><a href="#2-2-è¯­éŸ³è¯†åˆ«" class="headerlink" title="2.2 è¯­éŸ³è¯†åˆ«"></a>2.2 è¯­éŸ³è¯†åˆ«</h3><p>è¯­éŸ³è¯†åˆ«æœåŠ¡è¢«æ‹†åˆ†ä¸ºäº†ä¸¤å±‚ï¼šæœåŠ¡åº•å±‚å’Œé€‚é…å±‚ã€‚</p><p>åº•å±‚å¯¹åº”è¯†åˆ«æœåŠ¡å•†ï¼Œé€šè¿‡æœåŠ¡å•†çš„ SDK æˆ–è‡ªè¡Œç¼–å†™ä»£ç è¿›è¡Œæ¥å…¥ï¼ˆåœ¨å½“å‰åº”ç”¨ä¸­ï¼ŒåŒ…å«è…¾è®¯è¯­éŸ³è¯†åˆ«æœåŠ¡å’Œç“¦åŠ›è¯†åˆ«æœåŠ¡ï¼‰ã€‚ç”±äºæœåŠ¡å•†æä¾›çš„è¿”å›å†…å®¹å¤§ç›¸å¾„åº­ï¼Œå› æ­¤è¿™é‡Œéœ€è¦ç¬¬äºŒå±‚ï¼Œä¹Ÿå°±æ˜¯é€‚é…å±‚çš„èƒ½åŠ›ã€‚</p><p>é€‚é…å±‚çš„å…³é”®åœ¨äºå®ç° <code>SpeechRecognizerEngine</code> æ ‡å‡†æ¥å£ï¼ˆä½äº<code>src/core/speech-recognizer/types.ts</code>ï¼‰ã€‚è¯¥æ¥å£çº¦å®šäº†è¯­éŸ³è¯†åˆ«çš„ 3 ä¸ªä¸»è¦é˜¶æ®µï¼šå¥å­å¼€å§‹ã€å¥å­æ›´æ–°ã€å¥å­ç»“æŸã€‚</p><p>ä»¥å…¸å‹ä¸šåŠ¡ï¼ˆè¯†åˆ«ä¸€å¥è¯ç„¶åå‘ç»™æ¶ˆè´¹è€…ï¼‰ä¸ºä¾‹ï¼Œå…¶ RxJS å®ç°å¤§æ¦‚å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-ts"><code class="language-ts"><span class="token keyword">declare</span> <span class="token keyword">const</span> asr_start$<span class="token punctuation">:</span> Subject<span class="token operator">&lt;</span><span class="token keyword">string</span><span class="token operator">></span><span class="token punctuation">;</span><span class="token keyword">declare</span> <span class="token keyword">const</span> asr_update$<span class="token punctuation">:</span> Subject<span class="token operator">&lt;</span><span class="token keyword">string</span><span class="token operator">></span><span class="token punctuation">;</span><span class="token keyword">declare</span> <span class="token keyword">const</span> asr_end$<span class="token punctuation">:</span> Subject<span class="token operator">&lt;</span><span class="token keyword">string</span><span class="token operator">></span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">/** ä½ å¯èƒ½éœ€è¦å®æ—¶æ˜¾ç¤ºè¯†åˆ«çš„ç»“æœ */</span><span class="token keyword">const</span> asrContent <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>asr_start$  <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>    <span class="token function">switchMap</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>      <span class="token keyword">return</span> asr_update$<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>        <span class="token function">tap</span><span class="token punctuation">(</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>          asrContent<span class="token punctuation">.</span>value <span class="token operator">=</span> text<span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        <span class="token function">takeUntil</span><span class="token punctuation">(</span>asr_end$<span class="token punctuation">)</span><span class="token punctuation">,</span>        <span class="token function">finalize</span><span class="token punctuation">(</span>async <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>          await <span class="token function">getAnswer</span><span class="token punctuation">(</span>asrContent<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span>      <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token punctuation">)</span>  <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€‚é…å±‚çš„å­˜åœ¨ï¼Œä½¿å¾—ä¸šåŠ¡å¼€å‘ä¸éœ€è¦ç®¡ç†è¯­éŸ³è¯†åˆ«æœåŠ¡å•†åº•å±‚ä¸åŒçš„ç»†èŠ‚ã€‚</p><h3 id="2-3-è¯­éŸ³å”¤é†’"><a href="#2-3-è¯­éŸ³å”¤é†’" class="headerlink" title="2.3 è¯­éŸ³å”¤é†’"></a>2.3 è¯­éŸ³å”¤é†’</h3><p>è¯­éŸ³å”¤é†’æ˜¯ä¸€ä¸ªæœ¬åœ°æœåŠ¡ï¼Œå› æ­¤åªèƒ½åœ¨ Electron ç¯å¢ƒä¸‹ä½¿ç”¨ã€‚</p><p>è¯­éŸ³å”¤é†’æœåŠ¡é€»è¾‘ä»£ç ä½äº <code>electron/main/hooks/useAwakenServer.ts</code>ï¼Œå…¶æœåŠ¡æœ¬ä½“ä½äº <code>public/server/awaken</code>ã€‚</p><p>ä¸»çº¿ç¨‹é€šè¿‡ <code>child_process.execFile</code> ä½¿ç”¨å­çº¿ç¨‹æ¥å¯åŠ¨è¯­éŸ³å”¤é†’æœåŠ¡ï¼ŒæœåŠ¡ä¼šå¯åŠ¨ <code>WebSocket</code> æ¥ä¸æ¸²æŸ“çº¿ç¨‹è¿›è¡Œé€šä¿¡ã€‚</p><h3 id="2-4-äººè„¸è¯†åˆ«"><a href="#2-4-äººè„¸è¯†åˆ«" class="headerlink" title="2.4 äººè„¸è¯†åˆ«"></a>2.4 äººè„¸è¯†åˆ«</h3><p>äººè„¸è¯†åˆ«æœ‰ä¸¤å¥—ï¼šæœ¬åœ°äººè„¸è¯†åˆ«ã€åŸºäºç“¦åŠ›æœåŠ¡çš„äººè„¸è¯†åˆ«ï¼ˆåè€…éœ€è¦ç¡¬ä»¶æ”¯æŒï¼‰ã€‚</p><h4 id="2-4-1-æœ¬åœ°äººè„¸è¯†åˆ«"><a href="#2-4-1-æœ¬åœ°äººè„¸è¯†åˆ«" class="headerlink" title="2.4.1 æœ¬åœ°äººè„¸è¯†åˆ«"></a>2.4.1 æœ¬åœ°äººè„¸è¯†åˆ«</h4><p>æœ¬åœ°äººè„¸è¯†åˆ«æœåŠ¡çš„é€»è¾‘ä»£ç ä½äº <code>electron/main/hooks/useFaceDetectWindow.ts</code>ï¼Œå…¶æ¨¡å‹ä½äº <code>public/weights</code>ã€‚</p><p>ä¸»çº¿ç¨‹é€šè¿‡ <code>BrowserWindow</code> å¯åŠ¨ä¸å¯è§å­é¡µé¢ï¼Œè¯¥é¡µé¢é€šè¿‡ <code>BroadcastChannel</code> ä¸ä¸»é¡µé¢è¿›è¡Œé€šä¿¡ã€‚</p><h4 id="2-4-2-åŸºäºç“¦åŠ›çš„äººè„¸è¯†åˆ«"><a href="#2-4-2-åŸºäºç“¦åŠ›çš„äººè„¸è¯†åˆ«" class="headerlink" title="2.4.2 åŸºäºç“¦åŠ›çš„äººè„¸è¯†åˆ«"></a>2.4.2 åŸºäºç“¦åŠ›çš„äººè„¸è¯†åˆ«</h4><p>æ­¤äººè„¸è¯†åˆ«éœ€è¦è®¿é—®ç“¦åŠ›å¼•æ“çš„åº•å±‚ï¼Œé€šè¿‡è®¢é˜…å…¶ <code>videoFrame</code> äº‹ä»¶æµè·å–ã€‚åœ¨ <code>src/stores/store-asr</code> ä¸­å®ç°äº†æ­¤é€»è¾‘ï¼Œå¹¶å°†äººè„¸äº‹ä»¶è½¬å‘ç»™ <code>src/stores/store-face/store-face.ts</code> è¿›è¡Œæ¶ˆè´¹ã€‚</p><p>å› æ­¤å¯ä»¥å°† <code>store-face</code> è§†ä¸ºäººè„¸è¯†åˆ«æœåŠ¡çš„é€‚é…å±‚ï¼Œåªè¦æ¶ˆè´¹å…¶æš´éœ²å‡ºæ¥çš„ <code>subjects</code> å³å¯ã€‚</p><h2 id="3-å¼€å‘éš¾ç‚¹"><a href="#3-å¼€å‘éš¾ç‚¹" class="headerlink" title="3. å¼€å‘éš¾ç‚¹"></a>3. å¼€å‘éš¾ç‚¹</h2><p>ä¸€ä¸ªå®Œæ•´ä¸šåŠ¡é—­ç¯å¾€å¾€åŒ…å«ã€äººè„¸è¯†åˆ«ã€‘ã€ã€è¯­éŸ³å”¤é†’ã€‘ã€ã€è¯­éŸ³è¯†åˆ«ã€‘ã€ã€æ•°å­—äººé©±åŠ¨ã€‘ç­‰å¤šä¸ªå­ç¯èŠ‚ï¼Œä¸”å„ç¯èŠ‚çš„è°ƒç”¨å‡ä¸ºå¼‚æ­¥æ“ä½œï¼Œä½ éœ€è¦è°¨æ…å¤„ç†å…¶ã€æ—¶åºçŠ¶æ€ã€‘ï¼Œç”šè‡³åœ¨å¿…è¦æ—¶å¯¹å¼‚æ­¥ç¯èŠ‚è¿›è¡Œã€æ‰“æ–­æ“ä½œã€‘ã€‚</p><pre class="line-numbers language-ts"><code class="language-ts"><span class="token comment" spellcheck="true">/** é©±åŠ¨æ•°å­—äººå‘è¨€ */</span><span class="token keyword">declare</span> <span class="token keyword">const</span> speak<span class="token punctuation">:</span> <span class="token punctuation">(</span>text<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> Promise<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span><span class="token comment" spellcheck="true">/** æ•°å­—äºº SDK è¿”å›çš„ voice_end äº‹ä»¶ */</span><span class="token keyword">declare</span> <span class="token keyword">const</span> voice_end$<span class="token punctuation">:</span> Subject<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">/** ä¸šåŠ¡æµç¨‹ */</span><span class="token keyword">const</span> main <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  await <span class="token function">speak</span><span class="token punctuation">(</span><span class="token string">'ä½ å¥½ï¼Œå¾ˆé«˜å…´é‡è§ä½ ã€‚'</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">// æ³¨æ„ï¼Œæ­¤å¼‚æ­¥æ–¹æ³•è°ƒç”¨å®Œæ¯•å¹¶ä¸ç­‰äºæ•°å­—äººå‘è¨€å®Œæ¯•ï¼Œæ•°å­—äººæ­¤åˆ»å¯èƒ½ä»åœ¨å‘è¨€ï¼Œä½ éœ€è¦ç­‰å¾…å…¶ SDK è¿”å›çš„ voice_end äº‹ä»¶</span>  await <span class="token function">firstValueFrom</span><span class="token punctuation">(</span>voice_end$<span class="token punctuation">)</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="4-å‚è€ƒæ–‡æ¡£"><a href="#4-å‚è€ƒæ–‡æ¡£" class="headerlink" title="4. å‚è€ƒæ–‡æ¡£"></a>4. å‚è€ƒæ–‡æ¡£</h2><blockquote><ol><li><a href="https://rxjs.dev/">RxJS æ–‡æ¡£</a></li><li><a href="https://rxmarbles.com/">RxJS äº¤äº’å¼å¼¹ç å›¾</a></li><li><a href="https://gxhdvps5xn.feishu.cn/wiki/EqlmwVBCSi7V0MkxUTLcFVEynob">ç“¦åŠ›åè®®</a> (ç”±æ´²æ˜ç§‘æŠ€æä¾›ï¼Œå¯èƒ½ä¸æ˜¯æœ€æ–°çš„)</li><li><a href="https://aiui-doc.xf-yun.com/project-1/doc-16/">è®¯é£æ–‡æ¡£</a></li><li><a href="https://cloud.tencent.com/document/product/1093/48982">è…¾è®¯è¯­éŸ³è¯†åˆ«æ–‡æ¡£</a></li></ol></blockquote><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> é¡¹ç›®æ–‡æ¡£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Electron </tag>
            
            <tag> è¯­éŸ³è¯†åˆ« </tag>
            
            <tag> äººè„¸è¯†åˆ« </tag>
            
            <tag> æ•°å­—äºº </tag>
            
            <tag> è¯­éŸ³å”¤é†’ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯é¡¹ç›®å®¹å™¨åŒ– CI/CD é…ç½®æŒ‡å—ï¼šä»å…¥é—¨åˆ°å®æˆ˜</title>
      <link href="/2025/11/15/cicd-guide/"/>
      <url>/2025/11/15/cicd-guide/</url>
      
        <content type="html"><![CDATA[<h1 id="å‰ç«¯é¡¹ç›®å®¹å™¨åŒ–-CI-CD-é…ç½®æŒ‡å—ï¼šä»å…¥é—¨åˆ°å®æˆ˜"><a href="#å‰ç«¯é¡¹ç›®å®¹å™¨åŒ–-CI-CD-é…ç½®æŒ‡å—ï¼šä»å…¥é—¨åˆ°å®æˆ˜" class="headerlink" title="å‰ç«¯é¡¹ç›®å®¹å™¨åŒ– CI/CD é…ç½®æŒ‡å—ï¼šä»å…¥é—¨åˆ°å®æˆ˜"></a>å‰ç«¯é¡¹ç›®å®¹å™¨åŒ– CI/CD é…ç½®æŒ‡å—ï¼šä»å…¥é—¨åˆ°å®æˆ˜</h1><p>è¿™ä»½æ–‡æ¡£å°†å¸¦ä½ ç†è§£ä¸€å¥—<strong>é€šä¿—æ˜“æ‡‚ã€å¯å¤ç”¨</strong>çš„å‰ç«¯ CI/CDï¼ˆæŒç»­é›†æˆ/æŒç»­éƒ¨ç½²ï¼‰æ–¹æ¡ˆã€‚è¿™å¥—æ–¹æ¡ˆçš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š<strong>â€œé…ç½®å³ä»£ç ï¼Œç¯å¢ƒå…¨æ‰“åŒ…â€</strong>ã€‚</p><hr><h2 id="1-æ ¸å¿ƒç†å¿µï¼šåƒç‚¹å¤–å–ä¸€æ ·å‘ç‰ˆ"><a href="#1-æ ¸å¿ƒç†å¿µï¼šåƒç‚¹å¤–å–ä¸€æ ·å‘ç‰ˆ" class="headerlink" title="1. æ ¸å¿ƒç†å¿µï¼šåƒç‚¹å¤–å–ä¸€æ ·å‘ç‰ˆ"></a>1. æ ¸å¿ƒç†å¿µï¼šåƒç‚¹å¤–å–ä¸€æ ·å‘ç‰ˆ</h2><p>æ²¡æœ‰ CI/CD ä¹‹å‰ï¼Œä¸Šçº¿å°±åƒ<strong>è‡ªå·±åœ¨å®¶åšé¥­</strong>ï¼šä¹°èœã€æ´—èœã€ç‚’èœã€ç«¯ä¸Šæ¡Œï¼Œæ¯ä¸ªæ­¥éª¤éƒ½å¯èƒ½å‡ºé”™ï¼Œè€Œä¸”æ¯ä¸ªäººçš„å¨æˆ¿ï¼ˆå¼€å‘ç¯å¢ƒï¼‰éƒ½ä¸ä¸€æ ·ã€‚</p><p>æœ‰äº† CI/CD ä¹‹åï¼Œä¸Šçº¿å°±åƒ<strong>å…¨è‡ªåŠ¨ä¸­å¤®å¨æˆ¿</strong>ï¼š</p><ol><li><strong>æäº¤ä»£ç  (ä¸‹å•)</strong>ï¼šä½ åªéœ€è¦æŠŠå†™å¥½çš„ä»£ç ï¼ˆèœå•ï¼‰æäº¤ä¸Šå»ã€‚</li><li><strong>CI æµæ°´çº¿ (æµæ°´çº¿åˆ¶ä½œ)</strong>ï¼šGitLab Runner è‡ªåŠ¨åœ¨ä¸€ä¸ªå¹²å‡€çš„å®¹å™¨é‡Œå®‰è£…ä¾èµ–ã€æ‰“åŒ…ä»£ç ã€‚</li><li><strong>Docker é•œåƒ (æ‰“åŒ…æˆç›’)</strong>ï¼šæŠŠæ‰“åŒ…å¥½çš„é™æ€æ–‡ä»¶ + Nginx æœåŠ¡å™¨ + é…ç½®æ–‡ä»¶ï¼Œä¸€èµ·å°è¿›ä¸€ä¸ª Docker é•œåƒé‡Œã€‚</li><li><strong>CD éƒ¨ç½² (éª‘æ‰‹é…é€)</strong>ï¼šæŠŠé•œåƒæ¨é€åˆ°æœåŠ¡å™¨é›†ç¾¤ï¼Œè‡ªåŠ¨æ›¿æ¢æ—§ç‰ˆæœ¬ã€‚</li></ol><hr><h2 id="2-Docker-åŸºç¡€ï¼šä¸ºä»€ä¹ˆå‰ç«¯é¡¹ç›®éœ€è¦å®¹å™¨åŒ–ï¼Ÿ"><a href="#2-Docker-åŸºç¡€ï¼šä¸ºä»€ä¹ˆå‰ç«¯é¡¹ç›®éœ€è¦å®¹å™¨åŒ–ï¼Ÿ" class="headerlink" title="2. Docker åŸºç¡€ï¼šä¸ºä»€ä¹ˆå‰ç«¯é¡¹ç›®éœ€è¦å®¹å™¨åŒ–ï¼Ÿ"></a>2. Docker åŸºç¡€ï¼šä¸ºä»€ä¹ˆå‰ç«¯é¡¹ç›®éœ€è¦å®¹å™¨åŒ–ï¼Ÿ</h2><h3 id="2-1-Docker-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#2-1-Docker-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="2.1 Docker æ˜¯ä»€ä¹ˆï¼Ÿ"></a>2.1 Docker æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><strong>Docker</strong> æ˜¯ä¸€ä¸ªå¼€æºçš„å®¹å™¨åŒ–å¹³å°ï¼Œå®ƒå¯ä»¥æŠŠåº”ç”¨ç¨‹åºåŠå…¶æ‰€æœ‰ä¾èµ–ï¼ˆä»£ç ã€è¿è¡Œæ—¶ã€ç³»ç»Ÿå·¥å…·ã€åº“ç­‰ï¼‰æ‰“åŒ…æˆä¸€ä¸ªè½»é‡çº§ã€å¯ç§»æ¤çš„å®¹å™¨ã€‚</p><p><strong>ç®€å•ç†è§£</strong>ï¼šDocker å°±åƒæ˜¯ä¸€ä¸ª<strong>æ ‡å‡†åŒ–çš„å¿«é€’ç®±</strong>ï¼Œæ— è®ºé‡Œé¢è£…çš„æ˜¯ä»€ä¹ˆï¼ˆå‰ç«¯é¡¹ç›®ã€åç«¯æœåŠ¡ã€æ•°æ®åº“ï¼‰ï¼Œéƒ½èƒ½ç”¨åŒæ ·çš„æ–¹å¼æ‰“åŒ…ã€è¿è¾“ã€éƒ¨ç½²ã€‚</p><h3 id="2-2-ä¸ºä»€ä¹ˆå‰ç«¯é¡¹ç›®éœ€è¦-Dockerï¼Ÿ"><a href="#2-2-ä¸ºä»€ä¹ˆå‰ç«¯é¡¹ç›®éœ€è¦-Dockerï¼Ÿ" class="headerlink" title="2.2 ä¸ºä»€ä¹ˆå‰ç«¯é¡¹ç›®éœ€è¦ Dockerï¼Ÿ"></a>2.2 ä¸ºä»€ä¹ˆå‰ç«¯é¡¹ç›®éœ€è¦ Dockerï¼Ÿ</h3><p>å¾ˆå¤šå‰ç«¯å¼€å‘è€…ä¼šé—®ï¼š<em>â€œå‰ç«¯ä¸å°±æ˜¯é™æ€æ–‡ä»¶å—ï¼Ÿä¸ºä»€ä¹ˆéœ€è¦ Dockerï¼Ÿâ€</em></p><p><strong>ç­”æ¡ˆï¼šå‰ç«¯é¡¹ç›®ä¸ä»…ä»…æ˜¯é™æ€æ–‡ä»¶ï¼Œè¿˜åŒ…æ‹¬ï¼š</strong></p><ol><li><strong>è¿è¡Œç¯å¢ƒ</strong>ï¼šéœ€è¦ Nginx æœåŠ¡å™¨æ¥æä¾› HTTP æœåŠ¡</li><li><strong>é…ç½®æ–‡ä»¶</strong>ï¼šéœ€è¦ nginx.conf æ¥æ”¯æŒ SPA è·¯ç”±</li><li><strong>æ„å»ºç¯å¢ƒ</strong>ï¼šéœ€è¦ Node.js æ¥ç¼–è¯‘ä»£ç ï¼ˆè™½ç„¶æœ€ç»ˆé•œåƒé‡Œä¸éœ€è¦ï¼‰</li><li><strong>ç‰ˆæœ¬ç®¡ç†</strong>ï¼šéœ€è¦èƒ½å¿«é€Ÿå›æ»šåˆ°ä»»æ„ç‰ˆæœ¬</li></ol><p><strong>ä¸ä½¿ç”¨ Docker çš„ä¼ ç»Ÿæ–¹å¼ï¼š</strong></p><pre class="line-numbers language-text"><code class="language-text">å¼€å‘ â†’ æœ¬åœ° npm run build â†’ æ‰‹åŠ¨ä¸Šä¼  dist/ â†’ æœåŠ¡å™¨é…ç½® Nginx â†’ é‡å¯æœåŠ¡<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>ä½¿ç”¨ Docker çš„æ–¹å¼ï¼š</strong></p><pre class="line-numbers language-text"><code class="language-text">å¼€å‘ â†’ æäº¤ä»£ç  â†’ CI è‡ªåŠ¨æ„å»ºé•œåƒ â†’ æœåŠ¡å™¨æ‹‰å–é•œåƒ â†’ å¯åŠ¨å®¹å™¨<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>ä¼˜åŠ¿æ˜æ˜¾ï¼š</strong></p><ul><li>âœ… è‡ªåŠ¨åŒ–ï¼Œæ— éœ€äººå·¥å¹²é¢„</li><li>âœ… ç¯å¢ƒä¸€è‡´ï¼Œä¸ä¼šå‡ºé”™</li><li>âœ… å¿«é€Ÿå›æ»šï¼Œç§’çº§åˆ‡æ¢</li><li>âœ… é…ç½®å³ä»£ç ï¼Œç‰ˆæœ¬å¯æ§</li></ul><h3 id="2-3-Docker-çš„ä¸‰å¤§æ ¸å¿ƒä½œç”¨"><a href="#2-3-Docker-çš„ä¸‰å¤§æ ¸å¿ƒä½œç”¨" class="headerlink" title="2.3 Docker çš„ä¸‰å¤§æ ¸å¿ƒä½œç”¨"></a>2.3 Docker çš„ä¸‰å¤§æ ¸å¿ƒä½œç”¨</h3><h4 id="ä½œç”¨-1ï¼šç¯å¢ƒæ ‡å‡†åŒ–ï¼ˆä¸€æ¬¡æ„å»ºï¼Œåˆ°å¤„è¿è¡Œï¼‰"><a href="#ä½œç”¨-1ï¼šç¯å¢ƒæ ‡å‡†åŒ–ï¼ˆä¸€æ¬¡æ„å»ºï¼Œåˆ°å¤„è¿è¡Œï¼‰" class="headerlink" title="ä½œç”¨ 1ï¼šç¯å¢ƒæ ‡å‡†åŒ–ï¼ˆä¸€æ¬¡æ„å»ºï¼Œåˆ°å¤„è¿è¡Œï¼‰"></a>ä½œç”¨ 1ï¼šç¯å¢ƒæ ‡å‡†åŒ–ï¼ˆä¸€æ¬¡æ„å»ºï¼Œåˆ°å¤„è¿è¡Œï¼‰</h4><p><strong>ä¼ ç»Ÿéƒ¨ç½²çš„é—®é¢˜ï¼š</strong></p><pre class="line-numbers language-text"><code class="language-text">å¼€å‘ç¯å¢ƒï¼šNode 16 + npm 8 + Ubuntu 20.04æµ‹è¯•ç¯å¢ƒï¼šNode 18 + npm 9 + CentOS 7  â† ç¯å¢ƒä¸ä¸€è‡´ï¼ç”Ÿäº§ç¯å¢ƒï¼šNode 14 + npm 6 + Ubuntu 18.04  â† åˆä¸ä¸€æ ·ï¼<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>ä½¿ç”¨ Docker åï¼š</strong></p><pre class="line-numbers language-dockerfile"><code class="language-dockerfile"># Dockerfile å®šä¹‰äº†ç»Ÿä¸€çš„ç¯å¢ƒFROM node:18-alpine AS builder  # æ„å»ºç¯å¢ƒç»Ÿä¸€FROM nginx:1.20-alpine          # è¿è¡Œç¯å¢ƒç»Ÿä¸€<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>æ— è®ºé•œåƒåœ¨å“ªé‡Œè¿è¡Œï¼ˆå¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ï¼‰ï¼Œ<strong>ç¯å¢ƒå®Œå…¨ä¸€è‡´</strong>ï¼Œä¸ä¼šå‡ºç°â€åœ¨æˆ‘æœºå™¨ä¸Šèƒ½è·‘â€çš„é—®é¢˜ã€‚</p><h4 id="ä½œç”¨-2ï¼šä¾èµ–éš”ç¦»ï¼ˆé¿å…ç¯å¢ƒå†²çªï¼‰"><a href="#ä½œç”¨-2ï¼šä¾èµ–éš”ç¦»ï¼ˆé¿å…ç¯å¢ƒå†²çªï¼‰" class="headerlink" title="ä½œç”¨ 2ï¼šä¾èµ–éš”ç¦»ï¼ˆé¿å…ç¯å¢ƒå†²çªï¼‰"></a>ä½œç”¨ 2ï¼šä¾èµ–éš”ç¦»ï¼ˆé¿å…ç¯å¢ƒå†²çªï¼‰</h4><p><strong>ä¼ ç»Ÿéƒ¨ç½²ï¼š</strong></p><ul><li>æœåŠ¡å™¨ä¸Šå¯èƒ½åŒæ—¶è¿è¡Œå¤šä¸ªé¡¹ç›®</li><li>é¡¹ç›® A éœ€è¦ Node 16ï¼Œé¡¹ç›® B éœ€è¦ Node 18</li><li>å…¨å±€å®‰è£…çš„ä¾èµ–å¯èƒ½äº’ç›¸å†²çª</li></ul><p><strong>ä½¿ç”¨ Docker åï¼š</strong></p><ul><li>æ¯ä¸ªé¡¹ç›®è¿è¡Œåœ¨ç‹¬ç«‹çš„å®¹å™¨ä¸­</li><li>å®¹å™¨ä¹‹é—´å®Œå…¨éš”ç¦»ï¼Œäº’ä¸å½±å“</li><li>é¡¹ç›® A ç”¨ Node 16ï¼Œé¡¹ç›® B ç”¨ Node 18ï¼Œå®Œå…¨æ²¡é—®é¢˜</li></ul><h4 id="ä½œç”¨-3ï¼šå¿«é€Ÿéƒ¨ç½²ä¸å›æ»šï¼ˆç§’çº§åˆ‡æ¢ï¼‰"><a href="#ä½œç”¨-3ï¼šå¿«é€Ÿéƒ¨ç½²ä¸å›æ»šï¼ˆç§’çº§åˆ‡æ¢ï¼‰" class="headerlink" title="ä½œç”¨ 3ï¼šå¿«é€Ÿéƒ¨ç½²ä¸å›æ»šï¼ˆç§’çº§åˆ‡æ¢ï¼‰"></a>ä½œç”¨ 3ï¼šå¿«é€Ÿéƒ¨ç½²ä¸å›æ»šï¼ˆç§’çº§åˆ‡æ¢ï¼‰</h4><p><strong>ä¼ ç»Ÿéƒ¨ç½²ï¼š</strong></p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># éƒ¨ç½²æ–°ç‰ˆæœ¬éœ€è¦ï¼š</span>1. SSH è¿æ¥æœåŠ¡å™¨ï¼ˆ30ç§’ï¼‰2. å¤‡ä»½æ—§ä»£ç ï¼ˆ1åˆ†é’Ÿï¼‰3. ä¸Šä¼ æ–°ä»£ç ï¼ˆ2åˆ†é’Ÿï¼‰4. å®‰è£…ä¾èµ–ï¼ˆ3åˆ†é’Ÿï¼‰5. é‡å¯æœåŠ¡ï¼ˆ30ç§’ï¼‰æ€»è®¡ï¼šçº¦ 7 åˆ†é’Ÿ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ä½¿ç”¨ Docker åï¼š</strong></p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># éƒ¨ç½²æ–°ç‰ˆæœ¬åªéœ€è¦ï¼š</span>1. docker pull æ–°é•œåƒï¼ˆ30ç§’ï¼‰2. docker stop æ—§å®¹å™¨ï¼ˆ1ç§’ï¼‰3. docker run æ–°å®¹å™¨ï¼ˆ1ç§’ï¼‰æ€»è®¡ï¼šçº¦ 32 ç§’<span class="token comment" spellcheck="true"># å›æ»šæ›´ç®€å•ï¼š</span>docker run æ—§é•œåƒï¼ˆ1ç§’ï¼‰<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-4-Docker-é•œåƒ-vs-ä¼ ç»Ÿéƒ¨ç½²å¯¹æ¯”"><a href="#2-4-Docker-é•œåƒ-vs-ä¼ ç»Ÿéƒ¨ç½²å¯¹æ¯”" class="headerlink" title="2.4 Docker é•œåƒ vs ä¼ ç»Ÿéƒ¨ç½²å¯¹æ¯”"></a>2.4 Docker é•œåƒ vs ä¼ ç»Ÿéƒ¨ç½²å¯¹æ¯”</h3><table><thead><tr><th>ç»´åº¦</th><th>ä¼ ç»Ÿéƒ¨ç½²</th><th>Docker å®¹å™¨åŒ–</th></tr></thead><tbody><tr><td><strong>ç¯å¢ƒä¸€è‡´æ€§</strong></td><td>âŒ å„ç¯å¢ƒå¯èƒ½ä¸åŒ</td><td>âœ… å®Œå…¨ä¸€è‡´</td></tr><tr><td><strong>éƒ¨ç½²é€Ÿåº¦</strong></td><td>â±ï¸ 5-10 åˆ†é’Ÿ</td><td>âš¡ 30 ç§’-1 åˆ†é’Ÿ</td></tr><tr><td><strong>å›æ»šé€Ÿåº¦</strong></td><td>â±ï¸ éœ€è¦æ‰‹åŠ¨æ¢å¤</td><td>âš¡ ç§’çº§å›æ»š</td></tr><tr><td><strong>èµ„æºå ç”¨</strong></td><td>ğŸ’¾ æ¯ä¸ªé¡¹ç›®ç‹¬ç«‹ç¯å¢ƒ</td><td>ğŸ’¾ å…±äº«ç³»ç»Ÿèµ„æº</td></tr><tr><td><strong>éš”ç¦»æ€§</strong></td><td>âš ï¸ å¯èƒ½äº’ç›¸å½±å“</td><td>âœ… å®Œå…¨éš”ç¦»</td></tr><tr><td><strong>å¯ç§»æ¤æ€§</strong></td><td>âŒ ç»‘å®šç‰¹å®šæœåŠ¡å™¨</td><td>âœ… ä»»æ„ç¯å¢ƒè¿è¡Œ</td></tr></tbody></table><hr><h2 id="3-CI-CD-å®Œæ•´æµç¨‹è§£æ"><a href="#3-CI-CD-å®Œæ•´æµç¨‹è§£æ" class="headerlink" title="3. CI/CD å®Œæ•´æµç¨‹è§£æ"></a>3. CI/CD å®Œæ•´æµç¨‹è§£æ</h2><h3 id="3-1-æµç¨‹æ¦‚è§ˆ"><a href="#3-1-æµç¨‹æ¦‚è§ˆ" class="headerlink" title="3.1 æµç¨‹æ¦‚è§ˆ"></a>3.1 æµç¨‹æ¦‚è§ˆ</h3><p>è®©æˆ‘ä»¬çœ‹çœ‹ Docker åœ¨æ•´ä¸ª CI/CD æµç¨‹ä¸­æ‰®æ¼”çš„è§’è‰²ï¼š</p><pre class="line-numbers language-text"><code class="language-text">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚                    CI/CD å®Œæ•´æµç¨‹                        â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜1. å¼€å‘è€…æäº¤ä»£ç    â†“2. GitLab CI è§¦å‘æ„å»ºï¼ˆ.gitlab-ci.ymlï¼‰   â†“3. ã€Docker æ„å»ºé˜¶æ®µã€‘â†â”€â”€â”€ è¿™é‡Œï¼   â”œâ”€ æ‰§è¡Œ build.js è„šæœ¬   â”œâ”€ è°ƒç”¨ docker build å‘½ä»¤   â”œâ”€ è¯»å– Dockerfile   â”œâ”€ æ„å»º Docker é•œåƒï¼ˆåŒ…å«ä»£ç  + Nginx + é…ç½®ï¼‰   â””â”€ æ¨é€é•œåƒåˆ°é•œåƒä»“åº“   â†“4. ã€Docker è¿è¡Œé˜¶æ®µã€‘â†â”€â”€â”€ è¿˜æœ‰è¿™é‡Œï¼   â”œâ”€ æœåŠ¡å™¨æ‹‰å–é•œåƒ   â”œâ”€ docker run å¯åŠ¨å®¹å™¨   â””â”€ å®¹å™¨å†… Nginx æä¾›æœåŠ¡   â†“5. ç”¨æˆ·è®¿é—®åº”ç”¨<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-2-Docker-é•œåƒçš„ç”Ÿå‘½å‘¨æœŸ"><a href="#3-2-Docker-é•œåƒçš„ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="3.2 Docker é•œåƒçš„ç”Ÿå‘½å‘¨æœŸ"></a>3.2 Docker é•œåƒçš„ç”Ÿå‘½å‘¨æœŸ</h3><p>è®©æˆ‘ä»¬çœ‹çœ‹ä¸€ä¸ª Docker é•œåƒä»åˆ›å»ºåˆ°è¿è¡Œçš„å®Œæ•´è¿‡ç¨‹ï¼š</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># 1. æ„å»ºé˜¶æ®µï¼ˆåœ¨ CI ä¸­æ‰§è¡Œï¼‰</span>docker build -t my-app:dev-abc123 <span class="token keyword">.</span><span class="token comment" spellcheck="true"># è¿™ä¸ªè¿‡ç¨‹ä¼šï¼š</span><span class="token comment" spellcheck="true">#   - è¯»å– Dockerfile</span><span class="token comment" spellcheck="true">#   - æ‰§è¡Œç¬¬ä¸€é˜¶æ®µï¼šå®‰è£…ä¾èµ–ã€ç¼–è¯‘ä»£ç </span><span class="token comment" spellcheck="true">#   - æ‰§è¡Œç¬¬äºŒé˜¶æ®µï¼šå¤åˆ¶æ–‡ä»¶ã€é…ç½® Nginx</span><span class="token comment" spellcheck="true">#   - ç”Ÿæˆæœ€ç»ˆé•œåƒï¼ˆé€šå¸¸åªæœ‰ 20-50MBï¼‰</span><span class="token comment" spellcheck="true"># 2. æ¨é€é˜¶æ®µï¼ˆåœ¨ CI ä¸­æ‰§è¡Œï¼‰</span>docker push my-registry.com/my-app:dev-abc123<span class="token comment" spellcheck="true"># é•œåƒè¢«æ¨é€åˆ°é•œåƒä»“åº“ï¼ˆç±»ä¼¼ Git ä»“åº“ï¼Œä½†å­˜çš„æ˜¯é•œåƒï¼‰</span><span class="token comment" spellcheck="true"># 3. æ‹‰å–é˜¶æ®µï¼ˆåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼‰</span>docker pull my-registry.com/my-app:dev-abc123<span class="token comment" spellcheck="true"># æœåŠ¡å™¨ä»ä»“åº“æ‹‰å–é•œåƒåˆ°æœ¬åœ°</span><span class="token comment" spellcheck="true"># 4. è¿è¡Œé˜¶æ®µï¼ˆåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼‰</span>docker run -d -p 80:80 my-app:dev-abc123<span class="token comment" spellcheck="true"># å¯åŠ¨å®¹å™¨ï¼Œæ˜ å°„ç«¯å£ï¼Œåº”ç”¨å¼€å§‹æä¾›æœåŠ¡</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="4-å››å¤§æ ¸å¿ƒæ–‡ä»¶è¯¦è§£"><a href="#4-å››å¤§æ ¸å¿ƒæ–‡ä»¶è¯¦è§£" class="headerlink" title="4. å››å¤§æ ¸å¿ƒæ–‡ä»¶è¯¦è§£"></a>4. å››å¤§æ ¸å¿ƒæ–‡ä»¶è¯¦è§£</h2><p>è¦å®ç°è¿™å¥—æµç¨‹ï¼Œä½ çš„é¡¹ç›®æ ¹ç›®å½•ä¸‹é€šå¸¸éœ€è¦è¿™ 4 ä¸ªæ–‡ä»¶ã€‚ä½ å¯ä»¥ç›´æ¥å¤åˆ¶è¿™äº›æ¨¡æ¿åˆ°æ–°é¡¹ç›®ä¸­ä½¿ç”¨ã€‚</p><h3 id="ğŸ“‚-4-1-æ€»æŒ‡æŒ¥ï¼š-gitlab-ci-yml"><a href="#ğŸ“‚-4-1-æ€»æŒ‡æŒ¥ï¼š-gitlab-ci-yml" class="headerlink" title="ğŸ“‚ 4.1 æ€»æŒ‡æŒ¥ï¼š.gitlab-ci.yml"></a>ğŸ“‚ 4.1 æ€»æŒ‡æŒ¥ï¼š<code>.gitlab-ci.yml</code></h3><p><strong>ä½œç”¨</strong>ï¼šå‘Šè¯‰ GitLab CI ä»€ä¹ˆæ—¶å€™å¼€å§‹å¹²æ´»ï¼Œåˆ†ä¸ºå“ªå‡ æ­¥ã€‚</p><pre class="line-numbers language-yaml"><code class="language-yaml"><span class="token comment" spellcheck="true"># .gitlab-ci.yml</span><span class="token key atrule">stages</span><span class="token punctuation">:</span>  <span class="token punctuation">-</span> build <span class="token comment" spellcheck="true"># é˜¶æ®µä¸€ï¼šæ„å»º</span>  <span class="token punctuation">-</span> deploy <span class="token comment" spellcheck="true"># é˜¶æ®µäºŒï¼šéƒ¨ç½²</span><span class="token comment" spellcheck="true"># æ„å»ºä»»åŠ¡</span><span class="token key atrule">build_app</span><span class="token punctuation">:</span>  <span class="token key atrule">stage</span><span class="token punctuation">:</span> build  <span class="token key atrule">image</span><span class="token punctuation">:</span> node<span class="token punctuation">:</span>18<span class="token punctuation">-</span>alpine <span class="token comment" spellcheck="true"># æŒ‡å®šå¹²æ´»çš„ç¯å¢ƒï¼ˆæ¯”å¦‚è¦æœ‰ Node.jsï¼‰</span>  <span class="token key atrule">script</span><span class="token punctuation">:</span>    <span class="token punctuation">-</span> echo "å¼€å§‹å®‰è£…ä¾èµ–<span class="token punctuation">...</span>"    <span class="token punctuation">-</span> npm install    <span class="token punctuation">-</span> echo "å¼€å§‹æ„å»ºä»£ç <span class="token punctuation">...</span>"    <span class="token comment" spellcheck="true"># è¿™é‡Œæˆ‘ä»¬ä¸ç›´æ¥å†™å¤æ‚çš„ shell å‘½ä»¤ï¼Œè€Œæ˜¯è°ƒç”¨ä¸€ä¸ª JS è„šæœ¬æ¥å¤„ç†å¤æ‚é€»è¾‘</span>    <span class="token punctuation">-</span> node ./build.js <span class="token punctuation">-</span><span class="token punctuation">-</span>branch=$CI_COMMIT_REF_NAME <span class="token punctuation">-</span><span class="token punctuation">-</span>commit=$CI_COMMIT_SHORT_SHA  <span class="token comment" spellcheck="true"># äº§ç‰©ç•™å­˜ï¼ˆå¦‚æœä¸æ‰“ Docker é•œåƒï¼Œå¯ä»¥ç”¨ artifacts ä¿ç•™ dist ç›®å½•ï¼‰</span>  <span class="token comment" spellcheck="true"># artifacts:</span>  <span class="token comment" spellcheck="true">#   paths:</span>  <span class="token comment" spellcheck="true">#     - dist/</span>  <span class="token key atrule">only</span><span class="token punctuation">:</span>    <span class="token punctuation">-</span> main <span class="token comment" spellcheck="true"># åªæœ‰ main åˆ†æ”¯æäº¤æ‰è§¦å‘</span>    <span class="token punctuation">-</span> dev<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ğŸ› ï¸-4-2-é€»è¾‘å¤„ç†å¸ˆï¼šbuild-js"><a href="#ğŸ› ï¸-4-2-é€»è¾‘å¤„ç†å¸ˆï¼šbuild-js" class="headerlink" title="ğŸ› ï¸ 4.2 é€»è¾‘å¤„ç†å¸ˆï¼šbuild.js"></a>ğŸ› ï¸ 4.2 é€»è¾‘å¤„ç†å¸ˆï¼š<code>build.js</code></h3><p><strong>ä½œç”¨</strong>ï¼šä¸ºä»€ä¹ˆä¸ç›´æ¥åœ¨ yaml é‡Œå†™å‘½ä»¤ï¼Ÿå› ä¸ºçœŸå®é¡¹ç›®å¾€å¾€å¾ˆå¤æ‚ï¼ˆåŒºåˆ†å›½å†…/æµ·å¤–ã€æµ‹è¯•/ç”Ÿäº§ã€åŠ¨æ€ç‰ˆæœ¬å·ï¼‰ã€‚ç”¨ JS å†™è„šæœ¬æ¯”å†™ Shell æ›´çµæ´»ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// build.js é€šç”¨æ¨¡æ¿</span><span class="token keyword">const</span> <span class="token punctuation">{</span> spawn <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"child_process"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// è·å–å‘½ä»¤è¡Œå‚æ•°</span><span class="token keyword">const</span> args <span class="token operator">=</span> process<span class="token punctuation">.</span>argv<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>acc<span class="token punctuation">,</span> curr<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span> val<span class="token punctuation">]</span> <span class="token operator">=</span> curr<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"="</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  acc<span class="token punctuation">[</span>key<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/^--/</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> val<span class="token punctuation">;</span>  <span class="token keyword">return</span> acc<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"å½“å‰æ„å»ºå‚æ•°:"</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// æ ¸å¿ƒï¼šè°ƒç”¨ Docker å‘½ä»¤</span><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// 1. æ„é€  Docker é•œåƒåç§°ï¼ˆä¾‹å¦‚ï¼šmy-app:dev-a1b2c3dï¼‰</span>  <span class="token keyword">const</span> imageName <span class="token operator">=</span> <span class="token template-string"><span class="token string">`my-registry.com/my-app:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>args<span class="token punctuation">.</span>branch<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>args<span class="token punctuation">.</span>commit<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 2. æ„é€  docker build å‘½ä»¤</span>  <span class="token comment" spellcheck="true">// æ³¨æ„ï¼šè¿™é‡ŒæŠŠä¸€äº›æ„å»ºæ—¶çš„å‚æ•°ä¼ ç»™ Dockerfile</span>  <span class="token keyword">const</span> cmd <span class="token operator">=</span> <span class="token template-string"><span class="token string">`docker build -t </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>imageName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> --build-arg COMMIT_ID=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>args<span class="token punctuation">.</span>commit<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> .`</span></span><span class="token punctuation">;</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"æ‰§è¡Œå‘½ä»¤:"</span><span class="token punctuation">,</span> cmd<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 3. æ‰§è¡Œå‘½ä»¤ï¼ˆè¿™é‡Œç®€åŒ–äº† spawn çš„è°ƒç”¨ï¼Œå®é™…ä½¿ç”¨å»ºè®®å°è£…ä¸€ä¸ª runCommand å‡½æ•°ï¼‰</span>  <span class="token comment" spellcheck="true">// await runCommand(cmd);</span>  <span class="token comment" spellcheck="true">// await runCommand(`docker push ${imageName}`);</span><span class="token punctuation">}</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ğŸ“¦-4-3-åŒ…è£…è¯´æ˜ä¹¦ï¼šDockerfile"><a href="#ğŸ“¦-4-3-åŒ…è£…è¯´æ˜ä¹¦ï¼šDockerfile" class="headerlink" title="ğŸ“¦ 4.3 åŒ…è£…è¯´æ˜ä¹¦ï¼šDockerfile"></a>ğŸ“¦ 4.3 åŒ…è£…è¯´æ˜ä¹¦ï¼š<code>Dockerfile</code></h3><p><strong>ä½œç”¨</strong>ï¼šå®šä¹‰æ€ä¹ˆæŠŠä»£ç å˜æˆé•œåƒã€‚æ¨èä½¿ç”¨<strong>å¤šé˜¶æ®µæ„å»º</strong>ï¼ˆå…ˆç”¨ Node æ‰“åŒ…ï¼Œå†ç”¨ Nginx è¿è¡Œï¼‰ï¼Œè¿™æ ·é•œåƒä½“ç§¯æœ€å°ã€‚</p><pre class="line-numbers language-dockerfile"><code class="language-dockerfile"># --- ç¬¬ä¸€é˜¶æ®µï¼šæ„å»º (Builder) ---FROM node:18-alpine AS builderWORKDIR /app# 1. å…ˆæ‹· package.json å¥½çš„ä¾èµ–ï¼ˆåˆ©ç”¨ Docker ç¼“å­˜åŠ é€Ÿï¼‰COPY package.json pnpm-lock.yaml ./RUN npm install -g pnpm && pnpm install# 2. æ‹·æºç å¹¶æ‰“åŒ…COPY . .# æ¥æ”¶ build.js ä¼ è¿›æ¥çš„å‚æ•°ARG COMMIT_IDENV VITE_COMMIT_ID=${COMMIT_ID}RUN pnpm run build# --- ç¬¬äºŒé˜¶æ®µï¼šè¿è¡Œ (Runner) ---FROM nginx:1.20-alpine# 1. æŠŠç¬¬ä¸€é˜¶æ®µæ‰“åŒ…å¥½çš„ dist ç›®å½•ï¼Œæ‹·åˆ° Nginx çš„æœåŠ¡ç›®å½•COPY --from=builder /app/dist /usr/share/nginx/html# 2. ã€å…³é”®ã€‘æŠŠé¡¹ç›®é‡Œçš„ nginx.conf æ‹·è¿›å»æ›¿æ¢é»˜è®¤é…ç½®COPY nginx.conf /etc/nginx/conf.d/default.conf# 3. å¯åŠ¨ NginxCMD ["nginx", "-g", "daemon off;"]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ğŸ“œ-4-4-è·¯ç”±è§„åˆ™ä¹¦ï¼šnginx-conf"><a href="#ğŸ“œ-4-4-è·¯ç”±è§„åˆ™ä¹¦ï¼šnginx-conf" class="headerlink" title="ğŸ“œ 4.4 è·¯ç”±è§„åˆ™ä¹¦ï¼šnginx.conf"></a>ğŸ“œ 4.4 è·¯ç”±è§„åˆ™ä¹¦ï¼š<code>nginx.conf</code></h3><p><strong>ä½œç”¨</strong>ï¼šå‰ç«¯å•é¡µåº”ç”¨ï¼ˆSPAï¼‰å¿…é¡»é…ç½®ï¼Œå¦åˆ™åˆ·æ–°é¡µé¢ä¼š 404ã€‚è¿™ä¸ªæ–‡ä»¶æ˜¯éšä»£ç ä¸€èµ·æäº¤çš„ã€‚</p><pre class="line-numbers language-nginx"><code class="language-nginx"><span class="token keyword">server</span> <span class="token punctuation">{</span>    <span class="token keyword">listen</span> <span class="token number">80</span><span class="token punctuation">;</span>    <span class="token keyword">server_name</span> localhost<span class="token punctuation">;</span>    <span class="token keyword">root</span> <span class="token operator">/</span>usr<span class="token operator">/</span>share<span class="token operator">/</span>nginx<span class="token operator">/</span>html<span class="token punctuation">;</span> <span class="token comment" spellcheck="true"># å¯¹åº” Dockerfile é‡Œçš„ç›®å½•</span>    <span class="token comment" spellcheck="true"># é™æ€èµ„æºç¼“å­˜ï¼ˆåŠ é€ŸåŠ è½½ï¼‰</span>    <span class="token keyword">location</span> <span class="token operator">~</span> <span class="token punctuation">.</span><span class="token operator">*</span>\<span class="token punctuation">.</span><span class="token punctuation">(</span>gif<span class="token operator">|</span>jpg<span class="token operator">|</span>jpeg<span class="token operator">|</span>png<span class="token operator">|</span>css<span class="token operator">|</span>js<span class="token operator">|</span>ico<span class="token punctuation">)</span>$ <span class="token punctuation">{</span>        <span class="token keyword">expires</span> 30d<span class="token punctuation">;</span>        <span class="token keyword">add_header</span> Cache<span class="token operator">-</span>Control <span class="token string">"public"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true"># ã€æ ¸å¿ƒé…ç½®ã€‘SPA è·¯ç”±æ”¯æŒ</span>    <span class="token comment" spellcheck="true"># è§£é‡Šï¼šæ— è®ºç”¨æˆ·è®¿é—® /user è¿˜æ˜¯ /settingsï¼Œéƒ½å…ˆæ‰¾æœ‰æ²¡æœ‰è¿™ä¸ªæ–‡ä»¶</span>    <span class="token comment" spellcheck="true"># å¦‚æœæ²¡æœ‰ï¼Œå°±ç»Ÿç»Ÿè¿”å› index.htmlï¼Œè®©å‰ç«¯è·¯ç”±ï¼ˆVue Router/React Routerï¼‰å»å¤„ç†</span>    <span class="token keyword">location</span> <span class="token operator">/</span> <span class="token punctuation">{</span>        <span class="token keyword">try_files</span> <span class="token variable">$uri</span> <span class="token variable">$uri</span><span class="token operator">/</span> <span class="token operator">/</span><span class="token keyword">index</span><span class="token punctuation">.</span>html<span class="token punctuation">;</span>        <span class="token keyword">index</span> <span class="token keyword">index</span><span class="token punctuation">.</span>html<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="5-æ·±åº¦è§£æï¼šä¸ºä»€ä¹ˆ-Nginx-é…ç½®è¦å†™åœ¨å‰ç«¯é¡¹ç›®é‡Œï¼Ÿ"><a href="#5-æ·±åº¦è§£æï¼šä¸ºä»€ä¹ˆ-Nginx-é…ç½®è¦å†™åœ¨å‰ç«¯é¡¹ç›®é‡Œï¼Ÿ" class="headerlink" title="5. æ·±åº¦è§£æï¼šä¸ºä»€ä¹ˆ Nginx é…ç½®è¦å†™åœ¨å‰ç«¯é¡¹ç›®é‡Œï¼Ÿ"></a>5. æ·±åº¦è§£æï¼šä¸ºä»€ä¹ˆ Nginx é…ç½®è¦å†™åœ¨å‰ç«¯é¡¹ç›®é‡Œï¼Ÿ</h2><p>å¾ˆå¤šåˆå­¦è€…ä¼šæœ‰ç–‘é—®ï¼š<em>â€œNginx ä¸æ˜¯æœåŠ¡å™¨è½¯ä»¶å—ï¼Ÿé…ç½®æ–‡ä»¶ <code>nginx.conf</code> ä¸åº”è¯¥æ˜¯åœ¨æœåŠ¡å™¨çš„ <code>/etc/nginx/</code> ç›®å½•ä¸‹å—ï¼Ÿä¸ºä»€ä¹ˆä¼šå‡ºç°åœ¨å‰ç«¯ä»£ç ä»“åº“é‡Œï¼Ÿâ€</em></p><p>è¿™æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„é—®é¢˜ï¼Œå®ƒè§¦åŠäº†<strong>å®¹å™¨åŒ–éƒ¨ç½²</strong>çš„æ ¸å¿ƒä¼˜åŠ¿ã€‚</p><h3 id="5-1-æ ¸å¿ƒåŸç†ï¼šå®ƒä¸æ˜¯â€ä¼ â€ä¸Šå»çš„ï¼Œæ˜¯â€æ‰“åŒ…â€å¸¦èµ°çš„"><a href="#5-1-æ ¸å¿ƒåŸç†ï¼šå®ƒä¸æ˜¯â€ä¼ â€ä¸Šå»çš„ï¼Œæ˜¯â€æ‰“åŒ…â€å¸¦èµ°çš„" class="headerlink" title="5.1 æ ¸å¿ƒåŸç†ï¼šå®ƒä¸æ˜¯â€ä¼ â€ä¸Šå»çš„ï¼Œæ˜¯â€æ‰“åŒ…â€å¸¦èµ°çš„"></a>5.1 æ ¸å¿ƒåŸç†ï¼šå®ƒä¸æ˜¯â€ä¼ â€ä¸Šå»çš„ï¼Œæ˜¯â€æ‰“åŒ…â€å¸¦èµ°çš„</h3><p>åœ¨ä¼ ç»Ÿçš„éƒ¨ç½²æ¨¡å¼ä¸‹ï¼Œä½ ç¡®å®éœ€è¦æŠŠä»£ç ä¼ åˆ°æœåŠ¡å™¨ï¼Œç„¶åæ±‚è¿ç»´å¤§å“¥å¸®ä½ æ”¹æœåŠ¡å™¨ä¸Šçš„ Nginx é…ç½®ã€‚</p><p>ä½†åœ¨ Docker/K8s çš„å®¹å™¨åŒ–æ¨¡å¼ä¸‹ï¼Œé€»è¾‘å®Œå…¨å˜äº†ï¼š</p><ol><li><strong>å‰ç«¯é¡¹ç›®</strong> = <strong>ä»£ç </strong> (HTML/JS/CSS) + <strong>è¿è¡Œç¯å¢ƒ</strong> (Nginx) + <strong>ç¯å¢ƒé…ç½®</strong> (nginx.conf)ã€‚</li><li><strong>Dockerfile</strong> å°±åƒä¸€ä¸ªæ‰“åŒ…æ¸…å•ï¼Œå®ƒä¼šåšä¸‰ä»¶äº‹ï¼š<ul><li>æŠŠä»£ç ç¼–è¯‘æˆé™æ€æ–‡ä»¶ã€‚</li><li>ä¸‹è½½ä¸€ä¸ªçº¯å‡€çš„ Nginx ç¯å¢ƒã€‚</li><li><strong>å…³é”®æ­¥éª¤</strong>ï¼šæŠŠä½ é¡¹ç›®é‡Œçš„ <code>nginx.conf</code> å¤åˆ¶è¿›å»ï¼Œè¦†ç›–æ‰ Nginx é»˜è®¤çš„é…ç½®ã€‚</li></ul></li></ol><pre class="line-numbers language-dockerfile"><code class="language-dockerfile"># Dockerfile ç‰‡æ®µFROM nginx:1.20-alpine# ...# è¿™ä¸€è¡Œå°±æ˜¯"å·æ¢æ¢æŸ±"ï¼Œç”¨ä½ é¡¹ç›®é‡Œçš„é…ç½®ï¼Œæ›¿æ¢æ‰é•œåƒé‡Œé»˜è®¤çš„é…ç½®COPY nginx.conf /etc/nginx/conf.d/default.conf<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-2-è¿™æ ·åšçš„ä¸‰å¤§å¥½å¤„"><a href="#5-2-è¿™æ ·åšçš„ä¸‰å¤§å¥½å¤„" class="headerlink" title="5.2 è¿™æ ·åšçš„ä¸‰å¤§å¥½å¤„"></a>5.2 è¿™æ ·åšçš„ä¸‰å¤§å¥½å¤„</h3><ol><li><p><strong>é…ç½®å³ä»£ç  (Configuration as Code)</strong></p><ul><li>å‰ç«¯è·¯ç”±ï¼ˆæ¯”å¦‚ <code>/user/profile</code>ï¼‰é€šå¸¸éœ€è¦ Nginx é…åˆï¼ˆé…ç½® <code>try_files</code>ï¼‰ã€‚</li><li>å¦‚æœé…ç½®åœ¨æœåŠ¡å™¨ä¸Šï¼Œå‰ç«¯æ”¹äº†è·¯ç”±ï¼Œè¿ç»´æ²¡æ”¹é…ç½®ï¼Œçº¿ä¸Šå°±å´©äº†ã€‚</li><li><strong>ç°åœ¨</strong>ï¼šé…ç½®å°±åœ¨ä»£ç é‡Œï¼Œå‰ç«¯æ”¹ä»£ç çš„åŒæ—¶é¡ºæ‰‹æ”¹é…ç½®ï¼Œä¸€èµ·æäº¤ï¼Œä¸€èµ·ç”Ÿæ•ˆï¼Œ<strong>å®Œå…¨ä¸ä¾èµ–è¿ç»´</strong>ã€‚</li></ul></li><li><p><strong>ç¯å¢ƒä¸€è‡´æ€§</strong></p><ul><li>ä»¥å‰ç»å¸¸å‘ç”Ÿï¼šå¼€å‘ç¯å¢ƒï¼ˆæœ¬åœ° Nginxï¼‰æ˜¯å¥½çš„ï¼Œæµ‹è¯•ç¯å¢ƒï¼ˆè¿ç»´é…çš„ Nginxï¼‰æŒ‚äº†ã€‚</li><li><strong>ç°åœ¨</strong>ï¼šå› ä¸º Nginx é…ç½®æ˜¯æ‰“åŒ…åœ¨é•œåƒé‡Œçš„ï¼Œ<strong>æ— è®ºè¿™ä¸ªé•œåƒè·‘åˆ°å¼€å‘ã€æµ‹è¯•è¿˜æ˜¯ç”Ÿäº§ç¯å¢ƒï¼Œå®ƒå†…éƒ¨çš„ Nginx è¡Œä¸ºæ°¸è¿œæ˜¯ä¸€æ¨¡ä¸€æ ·çš„</strong>ã€‚</li></ul></li><li><p><strong>ç‰ˆæœ¬å›æ»š</strong></p><ul><li>å¦‚æœä½ æŠŠä»£ç å›æ»šåˆ°ä¸Šä¸ªç‰ˆæœ¬ï¼ŒDocker é•œåƒä¹Ÿä¼šå›æ»šã€‚</li><li>å› ä¸ºæ—§ç‰ˆæœ¬çš„é•œåƒé‡Œï¼ŒåŒ…ç€æ—§ç‰ˆæœ¬çš„ <code>nginx.conf</code>ï¼Œæ‰€ä»¥é…ç½®ä¹Ÿè‡ªåŠ¨å›æ»šäº†ã€‚ä¸ç”¨æ‹…å¿ƒä»£ç é€€å›å»äº†ï¼Œé…ç½®è¿˜æ˜¯æ–°çš„å¯¼è‡´æŠ¥é”™ã€‚</li></ul></li></ol><hr><h2 id="6-å¦‚ä½•åœ¨å…¶ä»–é¡¹ç›®å¤ç”¨ï¼Ÿ"><a href="#6-å¦‚ä½•åœ¨å…¶ä»–é¡¹ç›®å¤ç”¨ï¼Ÿ" class="headerlink" title="6. å¦‚ä½•åœ¨å…¶ä»–é¡¹ç›®å¤ç”¨ï¼Ÿ"></a>6. å¦‚ä½•åœ¨å…¶ä»–é¡¹ç›®å¤ç”¨ï¼Ÿ</h2><p>å¦‚æœä½ æ¥æ‰‹äº†ä¸€ä¸ªæ–°é¡¹ç›®ï¼Œæƒ³æ¥å…¥è¿™å¥—æµç¨‹ï¼Œåªéœ€åšä»¥ä¸‹ 4 æ­¥ï¼š</p><ol><li><strong>å¤åˆ¶æ–‡ä»¶</strong>ï¼šæŠŠ <code>build.js</code>, <code>Dockerfile</code>, <code>nginx.conf</code> å¤åˆ¶åˆ°é¡¹ç›®æ ¹ç›®å½•ã€‚</li><li><strong>ä¿®æ”¹ Nginx è·¯å¾„</strong>ï¼šæ£€æŸ¥ <code>Dockerfile</code> é‡Œ <code>COPY --from=builder</code> çš„æºè·¯å¾„ï¼ˆæ˜¯ <code>/app/dist</code> è¿˜æ˜¯ <code>/app/build</code>ï¼Ÿï¼‰ã€‚</li><li><strong>é…ç½® CI</strong>ï¼šåœ¨æ ¹ç›®å½•æ–°å»º <code>.gitlab-ci.yml</code>ï¼Œå¼•ç”¨ <code>build.js</code>ã€‚</li><li><strong>æ£€æŸ¥ç«¯å£</strong>ï¼šç¡®è®¤ <code>nginx.conf</code> ç›‘å¬çš„ç«¯å£ï¼ˆé€šå¸¸æ˜¯ 80ï¼‰ä¸ <code>Dockerfile</code> æš´éœ²çš„ç«¯å£ä¸€è‡´ã€‚</li></ol><hr><h2 id="7-å¸¸è§ç–‘é—®è§£ç­”"><a href="#7-å¸¸è§ç–‘é—®è§£ç­”" class="headerlink" title="7. å¸¸è§ç–‘é—®è§£ç­”"></a>7. å¸¸è§ç–‘é—®è§£ç­”</h2><p><strong>Q: ä¸ºä»€ä¹ˆè¦æ‰‹åŠ¨å†™ <code>nginx.conf</code> æ”¾åœ¨é¡¹ç›®é‡Œï¼Ÿ</strong></p><p>A: ä¸ºäº†<strong>ç¯å¢ƒä¸€è‡´æ€§</strong>ã€‚å¦‚æœä¾èµ–è¿ç»´åœ¨æœåŠ¡å™¨ä¸Šæ‰‹å·¥é…ç½® Nginxï¼Œå¾ˆå®¹æ˜“å‡ºç°â€å¼€å‘ç¯å¢ƒå¥½çš„ï¼Œçº¿ä¸Š 404â€çš„æƒ…å†µã€‚æŠŠé…ç½®æ”¾è¿›ä»£ç ä»“åº“ï¼Œéšé•œåƒä¸€èµ·åˆ†å‘ï¼Œèƒ½ä¿è¯ä»»ä½•åœ°æ–¹è¿è¡Œæ•ˆæœéƒ½ä¸€æ ·ã€‚</p><p><strong>Q: <code>build.js</code> æ˜¯å¿…é¡»çš„å—ï¼Ÿ</strong></p><p>A: ä¸æ˜¯ã€‚å¦‚æœé€»è¾‘ç®€å•ï¼Œç›´æ¥åœ¨ <code>.gitlab-ci.yml</code> çš„ <code>script</code> é‡Œå†™ <code>docker build</code> å‘½ä»¤ä¹Ÿå¯ä»¥ã€‚ä½†å½“æ¶‰åŠå¤šç¯å¢ƒï¼ˆæµ‹è¯•/é¢„å‘/ç”Ÿäº§ï¼‰ã€å¤šåŒºåŸŸï¼ˆå›½å†…/æµ·å¤–ï¼‰ã€è‡ªåŠ¨é€šçŸ¥ï¼ˆæ„å»ºå®Œå‘é£ä¹¦æ¶ˆæ¯ï¼‰ç­‰å¤æ‚é€»è¾‘æ—¶ï¼Œç”¨ JS è„šæœ¬ä¼šå¥½ç»´æŠ¤å¾—å¤šã€‚</p><p><strong>Q: ä¸ºä»€ä¹ˆå‰ç«¯é¡¹ç›®éœ€è¦ Dockerï¼Ÿç›´æ¥ä¸Šä¼  dist ç›®å½•ä¸è¡Œå—ï¼Ÿ</strong></p><p>A: å¯ä»¥ï¼Œä½†ä¸æ¨èã€‚ç›´æ¥ä¸Šä¼  dist ç›®å½•çš„é—®é¢˜ï¼š</p><ul><li>âŒ éœ€è¦æ‰‹åŠ¨é…ç½®æœåŠ¡å™¨ä¸Šçš„ Nginx</li><li>âŒ ä¸åŒç¯å¢ƒé…ç½®å¯èƒ½ä¸ä¸€è‡´</li><li>âŒ å›æ»šå›°éš¾ï¼Œéœ€è¦æ‰‹åŠ¨æ¢å¤</li><li>âŒ æ— æ³•ä¿è¯ç¯å¢ƒä¸€è‡´æ€§</li></ul><p>ä½¿ç”¨ Docker çš„ä¼˜åŠ¿ï¼š</p><ul><li>âœ… é…ç½®å³ä»£ç ï¼Œéšé•œåƒä¸€èµ·åˆ†å‘</li><li>âœ… ç¯å¢ƒå®Œå…¨ä¸€è‡´ï¼Œå¼€å‘/æµ‹è¯•/ç”Ÿäº§ä¸€æ¨¡ä¸€æ ·</li><li>âœ… ç§’çº§å›æ»šï¼Œ<code>docker run</code> æ—§é•œåƒå³å¯</li><li>âœ… è‡ªåŠ¨åŒ–éƒ¨ç½²ï¼Œæ— éœ€äººå·¥å¹²é¢„</li></ul><p><strong>Q: Docker é•œåƒä¼šä¸ä¼šå¾ˆå¤§ï¼Ÿ</strong></p><p>A: ä¸ä¼šã€‚ä½¿ç”¨å¤šé˜¶æ®µæ„å»ºåï¼Œæœ€ç»ˆé•œåƒé€šå¸¸åªæœ‰ 20-50MBï¼š</p><ul><li>æ„å»ºé˜¶æ®µï¼ˆbuilderï¼‰ï¼šåŒ…å« Node.jsï¼Œå¯èƒ½ 200MB+</li><li>è¿è¡Œé˜¶æ®µï¼ˆrunnerï¼‰ï¼šåªåŒ…å« Nginx + é™æ€æ–‡ä»¶ï¼Œåªæœ‰ 20-50MB</li></ul><p>æœ€ç»ˆé•œåƒåªåŒ…å«è¿è¡Œé˜¶æ®µçš„å†…å®¹ï¼Œæ‰€ä»¥ä½“ç§¯å¾ˆå°ã€‚</p><p><strong>Q: æœ¬åœ°å¼€å‘ä¹Ÿéœ€è¦ Docker å—ï¼Ÿ</strong></p><p>A: ä¸æ˜¯å¿…é¡»çš„ã€‚æœ¬åœ°å¼€å‘å¯ä»¥ç›´æ¥ç”¨ <code>npm run dev</code> æˆ– <code>vite</code>ã€‚Docker ä¸»è¦ç”¨äºï¼š</p><ul><li>CI/CD æ„å»ºå’Œéƒ¨ç½²</li><li>ç”Ÿäº§ç¯å¢ƒè¿è¡Œ</li><li>æµ‹è¯•ç¯å¢ƒéªŒè¯</li></ul><p>å¦‚æœä½ æƒ³åœ¨æœ¬åœ°ä¹Ÿä½¿ç”¨ Dockerï¼Œå¯ä»¥è¿è¡Œ <code>docker build</code> å’Œ <code>docker run</code>ï¼Œä½†é€šå¸¸æ²¡å¿…è¦ã€‚</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯å·¥ç¨‹åŒ– </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯å·¥ç¨‹åŒ– </tag>
            
            <tag> CI/CD </tag>
            
            <tag> Docker </tag>
            
            <tag> GitLab </tag>
            
            <tag> DevOps </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç±» FSD æ¶æ„å®è·µ(è‡ªæˆ‘æ„Ÿå—)</title>
      <link href="/2025/09/14/fsd-architecture/"/>
      <url>/2025/09/14/fsd-architecture/</url>
      
        <content type="html"><![CDATA[<h1 id="ç±»-FSD-æ¶æ„ï¼šæ˜¯ä»€ä¹ˆã€å¦‚ä½•è½åœ°ã€ä¸ºä½•æ›´ä¼˜"><a href="#ç±»-FSD-æ¶æ„ï¼šæ˜¯ä»€ä¹ˆã€å¦‚ä½•è½åœ°ã€ä¸ºä½•æ›´ä¼˜" class="headerlink" title="ç±» FSD æ¶æ„ï¼šæ˜¯ä»€ä¹ˆã€å¦‚ä½•è½åœ°ã€ä¸ºä½•æ›´ä¼˜"></a>ç±» FSD æ¶æ„ï¼šæ˜¯ä»€ä¹ˆã€å¦‚ä½•è½åœ°ã€ä¸ºä½•æ›´ä¼˜</h1><h2 id="èƒŒæ™¯ä¸å®šä¹‰"><a href="#èƒŒæ™¯ä¸å®šä¹‰" class="headerlink" title="èƒŒæ™¯ä¸å®šä¹‰"></a>èƒŒæ™¯ä¸å®šä¹‰</h2><p>éšç€å‰ç«¯é¡¹ç›®å¤æ‚åº¦ä¸æ–­æå‡ï¼Œä¼ ç»Ÿä»¥â€œæŠ€æœ¯æ ˆâ€æˆ–â€œé¡µé¢â€åˆ’åˆ†ç›®å½•çš„æ–¹å¼é€æ­¥æš´éœ²å‡ºç»´æŠ¤æˆæœ¬é«˜ã€æ¨¡å—è¾¹ç•Œæ¨¡ç³Šã€åä½œå›°éš¾ç­‰é—®é¢˜ã€‚ç±» FSDï¼ˆFeature-Sliced Designï¼‰æ¶æ„ä»¥â€œä¸šåŠ¡ç‰¹æ€§â€ä¸ºç¬¬ä¸€ç»´åº¦åˆ‡åˆ†ä»£ç ï¼Œé€šè¿‡æ˜ç¡®å±‚æ¬¡ä¸ä¾èµ–æ–¹å‘ï¼Œè®©å›¢é˜Ÿæ›´å®¹æ˜“ç»„ç»‡å¤§å‹å‰ç«¯é¡¹ç›®ã€‚</p><p>ç±» FSD å¹¶éåƒµåŒ–çš„æ¡†æ¶ï¼Œè€Œæ˜¯ä¸€å¥—å¯è½åœ°çš„æ¨¡å—åŒ–è®¾è®¡ç†å¿µï¼šå…ˆæ ¹æ®ä¸šåŠ¡èƒ½åŠ›åˆ’åˆ†â€œç‰¹æ€§â€ï¼Œå†åœ¨æ¯ä¸ªç‰¹æ€§å†…éƒ¨æŒ‰èŒè´£æ‹†åˆ†æ–‡ä»¶ä¸ç»„ä»¶ï¼Œä¿è¯ä¸šåŠ¡åœºæ™¯çš„å°è£…æ€§ä¸å¯æ‰©å±•æ€§ã€‚</p><h2 id="ä¼ ç»Ÿæ¶æ„ç—›ç‚¹ä¸-FSD-ä¼˜åŠ¿"><a href="#ä¼ ç»Ÿæ¶æ„ç—›ç‚¹ä¸-FSD-ä¼˜åŠ¿" class="headerlink" title="ä¼ ç»Ÿæ¶æ„ç—›ç‚¹ä¸ FSD ä¼˜åŠ¿"></a>ä¼ ç»Ÿæ¶æ„ç—›ç‚¹ä¸ FSD ä¼˜åŠ¿</h2><p>ä¼ ç»Ÿå‰ç«¯ç›®å½•é€šå¸¸æ˜¯ <code>components/</code>ã€<code>pages/</code>ã€<code>utils/</code>ã€<code>api/</code>ã€<code>store/</code> çš„ç»„åˆï¼Œåˆçœ‹ç®€å•ï¼Œå®é™…ä½¿ç”¨ä¼šæš´éœ²è¯¸å¤šé—®é¢˜ï¼š</p><pre><code>components/pages/utils/api/store/</code></pre><ul><li><strong>ç»„ä»¶ç›®å½•è¶Šå†™è¶Šä¹±</strong>ï¼š<code>components/</code> é‡Œä»åŸºç¡€ Button åˆ°ä¸šåŠ¡çº§ ProductCardã€è¯„è®ºåŒºç»„ä»¶éƒ½å¾€é‡Œä¸¢ï¼Œä¹…è€Œä¹…ä¹‹éš¾ä»¥ç•Œå®šè¾¹ç•Œï¼Œä»»ä½•æ”¹åŠ¨éƒ½éœ€è¦å°å¿ƒç¿¼ç¿¼åœ°æ£€ç´¢å¼•ç”¨ã€‚</li><li><strong>ä¸šåŠ¡é€»è¾‘å››å¤„æ•£è½</strong>ï¼šä»¥è´­ç‰©è½¦ä¸ºä¾‹ï¼Œé¡µé¢é€»è¾‘åœ¨ <code>pages/</code>ï¼Œè®¡ç®—å·¥å…·åœ¨ <code>utils/</code>ï¼ŒçŠ¶æ€åœ¨ <code>store/</code>ï¼Œç»„ä»¶åœ¨ <code>components/</code>ï¼Œå‡½æ•°è·¨ç›®å½•è°ƒç”¨ï¼Œç»´æŠ¤è€…éœ€è¦â€œè·¨å›¾ä½œæˆ˜â€ã€‚</li><li><strong>è€¦åˆåº¦é«˜å¯¼è‡´é‡æ„è‰°éš¾</strong>ï¼šä¿®æ”¹ <code>ProductCard</code> å¯èƒ½ç‰µåŠ¨äº”ä¸ªé¡µé¢ï¼›æƒ³æŠ½å–èƒ½åŠ›æ—¶å‘ç°ä¾èµ–å›ç¯ã€å…¨å±€å˜é‡æ»¡å¤©é£ï¼Œé‡æ„æˆæœ¬æŒ‡æ•°çº§ä¸Šå‡ã€‚</li><li><strong>åˆ°äº†åæœŸ</strong>ï¼š æ²¡äººçŸ¥é“è¯¥æŠŠä¸œè¥¿æ”¾å“ªï¼Œç»´æŠ¤æˆæœ¬é£æ¶¨ã€‚</li></ul><p>ç±» FSD æ¶æ„ä»æ ¹æºè§£å†³è¿™äº›ç—›ç‚¹ï¼š</p><ul><li><strong>ä¸šåŠ¡ç‹¬ç«‹çš„ç‰¹æ€§ç›®å½•</strong>ï¼šæ¯ä¸ª Feature è‡ªå¸¦ <code>ui</code>ã€<code>model</code>ã€<code>api</code>ï¼Œä¾‹å¦‚ <code>features/login/</code> ä¸‹é›†ä¸­æ‰€æœ‰ç™»å½•é€»è¾‘ï¼Œå®šä½é—®é¢˜ä¸€ç›®äº†ç„¶ã€‚</li><li><strong>æ¸…æ™°çš„ä¾èµ–å±‚çº§</strong>ï¼šçº¦å®š <code>shared â†’ entities â†’ features â†’ widgets â†’ pages â†’ app</code> çš„å•å‘ä¾èµ–ï¼Œç»“åˆ lint è§„åˆ™ï¼Œä¸€æ—¦è¶Šçº§å¼•ç”¨å³å¯åœ¨å¼€å‘æœŸå‘ç°ã€‚</li><li><strong>é«˜å¤ç”¨æ€§ä¸å¯è¿ç§»æ€§</strong>ï¼šç‰¹æ€§éµå¾ªç»Ÿä¸€ç»“æ„ï¼Œ<code>features/filter/</code> å¯ä»¥éšæ—¶è¢«å…¶ä»–é¡µé¢å¼•ç”¨ï¼›å®ä½“æ•°æ®å±‚ <code>entities/</code> åˆ™æä¾›ç¨³å®šæ¥å£ã€‚</li><li><strong>ä¾¿äºå¤šäººåä½œ</strong>ï¼šä¸åŒåŒäº‹è´Ÿè´£ä¸åŒ Featureï¼Œä¸å†æŒ¤åœ¨åŒä¸€ç›®å½•â€œæŠ¢åœ°ç›˜â€ï¼Œäº’åŠ¨å†²çªå’Œ Review æˆæœ¬æ˜¾è‘—ä¸‹é™ã€‚</li><li><strong>é‡æ„ä¸æ‰©å±•æ›´è½»æ¾</strong>ï¼šè¾¹ç•Œæ¸…æ™°ã€å°è£…è‰¯å¥½ï¼Œæ–°ä¸šåŠ¡åªéœ€æ–°å¢ Feature/Entityï¼Œæ—§é€»è¾‘é‡æ„æ—¶ä¹Ÿåªåœ¨å±€éƒ¨èŒƒå›´å†…è°ƒæ•´ã€‚</li></ul><p>æ˜¯å¦é‡‡ç”¨ FSDï¼Œå¯ç»“åˆé¡¹ç›®è§„æ¨¡è¯„ä¼°ï¼šå¤šäººåä½œã€é•¿æœŸè¿­ä»£ã€ä¸šåŠ¡å¤æ‚ã€å¤ç”¨é€»è¾‘å¤šã€é¡µé¢å¤šæˆ–æ‹¥æœ‰å¤šæ¡äº§å“çº¿æ—¶æ”¶ç›Šæœ€å¤§ï¼›è‹¥ä»…æœ‰ 2-3 ä¸ªé¡µé¢çš„å°é¡¹ç›®ï¼Œåˆ™æ²¡å¿…è¦å¼•å…¥å®Œæ•´ FSD ä½“ç³»ã€‚</p><h2 id="æ ¸å¿ƒåŸåˆ™"><a href="#æ ¸å¿ƒåŸåˆ™" class="headerlink" title="æ ¸å¿ƒåŸåˆ™"></a>æ ¸å¿ƒåŸåˆ™</h2><ul><li><strong>è‡ªé¡¶å‘ä¸‹çš„åˆ†å±‚çº¦æŸ</strong>ï¼šé«˜å±‚ï¼ˆå¦‚ <code>app</code>ã€<code>pages</code>ï¼‰åªç»„åˆä½å±‚æ¨¡å—ï¼Œä½å±‚ä¸åå‘ä¾èµ–ï¼Œå½¢æˆæ¸…æ™°ä¾èµ–å›¾ã€‚</li><li><strong>æŒ‰ç‰¹æ€§ç»„åˆèƒ½åŠ›</strong>ï¼šå›´ç»•â€œä¸šåŠ¡åŠ¨ä½œâ€æ„å»º <code>features</code>ï¼Œæ•°æ®ä¸ UI ç»„åˆåœ¨ä¸€èµ·ï¼Œå‡å°‘å››æ•£çš„é€»è¾‘ã€‚</li><li><strong>å®ä½“é©±åŠ¨å»ºæ¨¡</strong>ï¼š<code>entities</code> å±‚æ²‰æ·€æ ¸å¿ƒä¸šåŠ¡æ¨¡å‹åŠå…¶åŸºç¡€è§†å›¾ï¼Œä¾¿äºå¤ç”¨ä¸æ¼”è¿›ã€‚</li><li><strong>å…±äº«èµ„æºæœ€å°åŒ–</strong>ï¼š<code>shared</code> ä»…æ”¾ç½®çœŸæ­£é€šç”¨çš„å·¥å…·ã€UI åº“å’Œ API å®¢æˆ·ç«¯ï¼Œé¿å…æˆä¸ºâ€œåƒåœ¾åœºâ€ã€‚</li><li><strong>å¯æ¼”è¿›çš„è¾¹ç•Œ</strong>ï¼šç›®å½•å’Œå±‚çº§å…è®¸éšç€ä¸šåŠ¡æˆé•¿è°ƒæ•´ï¼Œä¿æŒè§„çº¦ä¸çµæ´»æ€§çš„å¹³è¡¡ã€‚</li></ul><h2 id="åˆ†å±‚ç»“æ„é€Ÿè§ˆ"><a href="#åˆ†å±‚ç»“æ„é€Ÿè§ˆ" class="headerlink" title="åˆ†å±‚ç»“æ„é€Ÿè§ˆ"></a>åˆ†å±‚ç»“æ„é€Ÿè§ˆ</h2><p>å…¸å‹çš„ç±» FSD é¡¹ç›®è‡ªå¤–å‘å†…å¯åˆ’åˆ†ä¸ºï¼š</p><ul><li><code>app</code>ï¼šåº”ç”¨å…¥å£ã€å…¨å±€é…ç½®ã€å›½é™…åŒ–ã€é”™è¯¯è¾¹ç•Œã€‚</li><li><code>processes</code>ï¼šè·¨é¡µé¢çš„é•¿æµç¨‹ï¼ˆå¦‚æ³¨å†Œç­¾çº¦ã€æ”¯ä»˜é“¾è·¯ï¼‰ã€‚</li><li><code>pages</code>ï¼šé¡µé¢å®¹å™¨ï¼Œè´Ÿè´£è·¯ç”±ä¸æ•°æ®è£…é…ï¼Œä¸æ‰¿æ‹…ä¸šåŠ¡å®ç°ã€‚</li><li><code>widgets</code>ï¼šè·¨å¤šä¸ªé¡µé¢å¤ç”¨çš„ç»„åˆå‹ UIï¼ˆå¯¼èˆªæ ã€ä»ªè¡¨ç›˜ï¼‰ã€‚</li><li><code>features</code>ï¼šå¯å¤ç”¨çš„ä¸šåŠ¡åŠŸèƒ½å•å…ƒï¼ˆè¯„è®ºæäº¤ã€æ–‡ä»¶ä¸Šä¼ ï¼‰ã€‚</li><li><code>entities</code>ï¼šä¸šåŠ¡å®ä½“æ¨¡å‹ä¸å…¶æœ€å°è§†å›¾ï¼ˆç”¨æˆ·å¡ç‰‡ã€è®¢å•çŠ¶æ€ï¼‰ã€‚</li><li><code>shared</code>ï¼šå·¥å…·å‡½æ•°ã€ä¸»é¢˜ç³»ç»Ÿã€API å®¢æˆ·ç«¯ã€åŸºç¡€ç»„ä»¶åº“ã€‚</li></ul><h2 id="å‰ç«¯è½åœ°æ­¥éª¤"><a href="#å‰ç«¯è½åœ°æ­¥éª¤" class="headerlink" title="å‰ç«¯è½åœ°æ­¥éª¤"></a>å‰ç«¯è½åœ°æ­¥éª¤</h2><ol><li><strong>æ¢³ç†ä¸šåŠ¡ç‰¹æ€§</strong>ï¼šåˆ—å‡ºæ ¸å¿ƒæµç¨‹ä¸å®ä½“ï¼Œæ˜ç¡®æ¯ä¸ªç‰¹æ€§åœ¨ä¸šåŠ¡ä¸­çš„ç›®æ ‡ä¸è¾¹ç•Œã€‚</li><li><strong>å®šä¹‰ä¾èµ–è§„åˆ™</strong>ï¼šçº¦å®šåªèƒ½â€œè‡ªä¸Šè€Œä¸‹â€å¼•ç”¨ï¼Œå¹¶é…åˆ ESLint/TSPath ç­‰å·¥å…·æ ¡éªŒã€‚</li><li><strong>æ­å»ºç›®å½•éª¨æ¶</strong>ï¼šåœ¨ä»“åº“ä¸­åˆ›å»ºåŸºç¡€å±‚çº§ï¼Œå‡†å¤‡ç¤ºä¾‹æ¨¡å—å’Œè„šæ‰‹æ¶å‘½ä»¤ã€‚</li><li><strong>å¢é‡è¿ç§»ä»£ç </strong>ï¼šä¼˜å…ˆè¿ç§»é«˜å˜ä¸šåŠ¡æˆ–æ–°ç‰¹æ€§ï¼Œæ‹†å‡º <code>features</code> ä¸ <code>entities</code>ï¼Œé¿å…ä¸€æ¬¡æ€§é‡æ„ã€‚</li><li><strong>æ²‰æ·€å¤ç”¨èµ„äº§</strong>ï¼šé€æ­¥å°†é€šç”¨é€»è¾‘ä¸‹æ²‰è‡³ <code>shared</code>ï¼Œä¿æŒç»“æ„æ´å‡€ã€‚</li><li><strong>é…åˆå·¥ç¨‹å·¥å…·</strong>ï¼šç»“åˆ Storybookã€Jestã€CI æ ¡éªŒç­‰æ‰‹æ®µï¼Œç¡®ä¿åˆ‡ç‰‡åçš„æ¨¡å—å¯ç‹¬ç«‹æµ‹è¯•ä¸äº¤ä»˜ã€‚</li></ol><h2 id="Vue-é¡¹ç›®ç›®å½•ç¤ºä¾‹"><a href="#Vue-é¡¹ç›®ç›®å½•ç¤ºä¾‹" class="headerlink" title="Vue é¡¹ç›®ç›®å½•ç¤ºä¾‹"></a>Vue é¡¹ç›®ç›®å½•ç¤ºä¾‹</h2><p>ä»¥ Vue 3 + Vite é¡¹ç›®ä¸ºä¾‹ï¼ŒæŒ‰ç±» FSD æ€è·¯å¯å°† <code>src/</code> ç›®å½•ç»„ç»‡å¦‚ä¸‹ï¼š</p><pre><code>src/  app/    providers/        # çŠ¶æ€æ³¨å…¥ã€å›½é™…åŒ–ã€å…¨å±€é”™è¯¯è¾¹ç•Œ    router/           # è·¯ç”±é…ç½®ä¸å®ˆå«    store/            # Pinia/Redux ç­‰å…¨å±€çŠ¶æ€å…¥å£    index.vue         # åº”ç”¨æ ¹ç»„ä»¶  pages/    home/      ui/             # é¡µé¢çº§å¸ƒå±€ä¸ç»„åˆç»„ä»¶      model/          # é¡µé¢æ•°æ®è£…é…ã€è·¯ç”±å‚æ•°è§£æ  widgets/    user-profile/      ui/             # å¤´åƒå¡ç‰‡ã€åŸºæœ¬ä¿¡æ¯å±•ç¤º      model/          # ç»„åˆç‰¹æ€§å¹¶è¿æ¥å®ä½“  features/    login/      ui/             # ç™»å½•è¡¨å•ã€äº¤äº’é€»è¾‘      model/          # çŠ¶æ€ã€è¡¨å•æ ¡éªŒ      api/            # ç™»å½•è¯·æ±‚å°è£…  entities/    user/      model/          # ç”¨æˆ·å®ä½“ç±»å‹ã€çŠ¶æ€ç®¡ç†      lib/            # ç”¨æˆ·é¢†åŸŸå·¥å…·å‡½æ•°  common/    features/         # è·¨åº”ç”¨ç‰¹æ€§èƒ½åŠ›ï¼Œå¦‚ messageã€modals    entities/         # API å®šä¹‰ï¼Œä¸åç«¯èµ„æºä¿æŒå‘½åä¸€è‡´    services/         # é€šç”¨ boot é€»è¾‘ï¼ŒåŸ‹ç‚¹ã€å¤šè¯­è¨€ã€Store åˆå§‹åŒ–ç­‰  shared/    ui/               # åŸºç¡€é€šç”¨ç»„ä»¶ï¼ˆButtonã€Modalï¼‰    lib/              # å·¥å…·å‡½æ•°ã€hooks    api/              # HTTP å®¢æˆ·ç«¯ã€æ‹¦æˆªå™¨    config/           # å¸¸é‡ã€ç¯å¢ƒé…ç½®</code></pre><p>å®è·µä¸­å¯ä»¥å€ŸåŠ© <code>pnpm dlx degit</code>ã€<code>plop</code> ç­‰è„šæ‰‹æ¶å·¥å…·ç”Ÿæˆç‰¹æ€§æ¨¡æ¿ï¼Œç¡®ä¿æ¯ä¸ªç›®å½•æ‹¥æœ‰ç»Ÿä¸€çš„ <code>ui</code>ã€<code>model</code>ã€<code>api</code> ç»“æ„ã€‚React é¡¹ç›®ä¹Ÿå¯é‡‡ç”¨ç±»ä¼¼å±‚çº§ï¼Œç»“åˆ <code>tsx</code> æ–‡ä»¶ä¸è‡ªå®šä¹‰ hooksï¼Œä¿è¯è·¨æ¡†æ¶çš„ä¸€è‡´æ€§ä¸å¯ç»´æŠ¤æ€§ã€‚</p><h3 id="Common-å­é¡¹ç›®çš„è§’è‰²"><a href="#Common-å­é¡¹ç›®çš„è§’è‰²" class="headerlink" title="Common å­é¡¹ç›®çš„è§’è‰²"></a>Common å­é¡¹ç›®çš„è§’è‰²</h3><ul><li><strong>Features</strong>ï¼šå°è£…è·¨ä¸šåŠ¡çš„é€šç”¨ç‰¹æ€§ï¼Œä¾‹å¦‚æ¶ˆæ¯æç¤º <code>message</code>ã€æ¨¡æ€å¼¹çª— <code>modals</code>ï¼ŒæŒ‰ FSD çº¦å®šç»§ç»­æ‹†åˆ† <code>ui</code>ã€<code>model</code>ã€<code>api</code>ã€‚</li><li><strong>Entitiesï¼ˆAPIï¼‰</strong>ï¼šç»Ÿä¸€ç»´æŠ¤å¯¹æ¥åç«¯çš„èµ„æºå°è£…ï¼Œä¿è¯æ–‡ä»¶ç»“æ„ä¸æ¥å£å‘½åä¸€ä¸€å¯¹åº”ï¼Œæ–¹ä¾¿å¤šå›¢é˜Ÿå…±äº«ã€‚</li><li><strong>Services</strong>ï¼šæ‰¿è½½é¡¹ç›®å¯åŠ¨é˜¶æ®µçš„åŸºç¡€æœåŠ¡é€»è¾‘ï¼Œå¦‚åŸ‹ç‚¹åˆå§‹åŒ–ã€å¤šè¯­è¨€åŠ è½½ã€API å®¢æˆ·ç«¯å®ä¾‹åŒ–ã€é¡¶å±‚çŠ¶æ€æ³¨å†Œï¼Œç¡®ä¿å„ä¸šåŠ¡çº¿éµå¾ªåŒä¸€å¥—å¯åŠ¨æµç¨‹ã€‚</li></ul><h2 id="ä¸ä¼ ç»Ÿæ¶æ„çš„å·®å¼‚"><a href="#ä¸ä¼ ç»Ÿæ¶æ„çš„å·®å¼‚" class="headerlink" title="ä¸ä¼ ç»Ÿæ¶æ„çš„å·®å¼‚"></a>ä¸ä¼ ç»Ÿæ¶æ„çš„å·®å¼‚</h2><table><thead><tr><th>ç»´åº¦</th><th>ç±» FSD æ¶æ„</th><th>ä¼ ç»ŸæŒ‰å±‚/æŒ‰é¡µé¢æ¶æ„</th></tr></thead><tbody><tr><td>åˆ’åˆ†æ–¹å¼</td><td>ä»¥ä¸šåŠ¡ç‰¹æ€§ä¸ºä¸»è½´ï¼Œå±‚çº§æ¸…æ™°</td><td>ä»¥æŠ€æœ¯æ ˆæˆ–é¡µé¢åˆ’åˆ†ï¼Œè¾¹ç•Œæ¨¡ç³Š</td></tr><tr><td>ä¾èµ–ç®¡ç†</td><td>å¼ºåˆ¶å•å‘ä¾èµ–ï¼Œæ˜“äºè¿½è¸ª</td><td>ç»„ä»¶äº’ç›¸å¼•ç”¨ï¼Œæ˜“å½¢æˆç½‘çŠ¶è€¦åˆ</td></tr><tr><td>å›¢é˜Ÿåä½œ</td><td>ç‰¹æ€§å¯åˆ†åŒ…äº¤ä»˜ï¼ŒèŒè´£æ˜ç¡®</td><td>éœ€è·¨ç›®å½•åä½œï¼Œæ²Ÿé€šæˆæœ¬é«˜</td></tr><tr><td>å¯ç»´æŠ¤æ€§</td><td>ç‰¹æ€§å†…èšï¼Œæ”¹åŠ¨èŒƒå›´å¯æ§</td><td>ä¿®æ”¹å¸¸ç‰µæ‰¯å¤šå¤„ï¼Œå›å½’æˆæœ¬å¤§</td></tr><tr><td>æ‰©å±•æ€§</td><td>æ–°ä¸šåŠ¡ç›´æ¥æ–°å¢ç‰¹æ€§/å®ä½“</td><td>æ‰©å±•å¸¸éœ€è°ƒæ•´å¤šå±‚ç›®å½•ç»“æ„</td></tr><tr><td>å·¥ç¨‹é…å¥—</td><td>æ˜“ç»“åˆè‡ªåŠ¨åŒ–æµ‹è¯•ã€CI è§„åˆ™</td><td>è§„èŒƒéš¾ç»Ÿä¸€ï¼Œæ˜“ç´¯ç§¯â€œç°è‰²åœ°å¸¦â€</td></tr></tbody></table><h2 id="å®è·µå»ºè®®ä¸æ¡ˆä¾‹"><a href="#å®è·µå»ºè®®ä¸æ¡ˆä¾‹" class="headerlink" title="å®è·µå»ºè®®ä¸æ¡ˆä¾‹"></a>å®è·µå»ºè®®ä¸æ¡ˆä¾‹</h2><ul><li><strong>é€‚åˆåœºæ™¯</strong>ï¼šä¸­å¤§å‹å•é¡µåº”ç”¨ã€ä¸šåŠ¡çº¿ä¼—å¤šçš„ B ç«¯ç³»ç»Ÿã€éœ€è¦é•¿æœŸè¿­ä»£çš„å¤æ‚äº§å“ã€‚</li><li><strong>æ¸è¿›å¼å¼•å…¥</strong>ï¼šä¸è¦å¼ºè¡Œä¸€æ¬¡è¿ç§»ï¼Œå¯å…ˆå°†æ–°ä¸šåŠ¡æŒ‰ FSD æ¶æ„å¼€å‘ï¼Œå†é€æ­¥æ‹†æ—§æ¨¡å—ã€‚</li><li><strong>è§„èŒƒåŒ–å·¥å…·</strong>ï¼šä½¿ç”¨ ESLint æ’ä»¶æˆ–è‡ªå®šä¹‰è„šæœ¬é™åˆ¶è·¨å±‚å¼•ç”¨ï¼›é…åˆ TypeScript è·¯å¾„åˆ«åæå‡å¯è¯»æ€§ã€‚</li><li><strong>æ–‡æ¡£ä¸ç¤ºä¾‹</strong>ï¼šä¸ºå›¢é˜Ÿæä¾›æ¨¡æ¿æ–‡ä»¶ã€ç›®å½•è„šæ‰‹æ¶ä¸æœ€ä½³å®è·µæ¸…å•ï¼Œé™ä½ä¸Šæ‰‹é—¨æ§›ã€‚</li><li><strong>æŒç»­å›é¡¾</strong>ï¼šå®šæœŸè¯„ä¼° <code>shared</code> æ˜¯å¦è¿‡è½½ã€ç‰¹æ€§æ˜¯å¦è¿‡å¤§ï¼ŒåŠæ—¶è°ƒæ•´è¾¹ç•Œã€‚</li></ul><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ç±» FSD æ¶æ„ä»¥ä¸šåŠ¡åˆ‡ç‰‡ä¸ºæ ¸å¿ƒï¼Œè®©å‰ç«¯å›¢é˜Ÿåœ¨åº”å¯¹å¤æ‚éœ€æ±‚æ—¶ä»èƒ½ä¿æŒæ¨¡å—æ¸…æ™°å’Œäº¤ä»˜é«˜æ•ˆã€‚é€šè¿‡åˆç†çš„åˆ†å±‚ã€æ˜ç¡®çš„ä¾èµ–è§„åˆ™ä»¥åŠå·¥ç¨‹åŒ–çº¦æŸï¼Œå®ƒç›¸æ¯”ä¼ ç»Ÿæ¶æ„æ‹¥æœ‰æ›´å¥½çš„å¯ç»´æŠ¤æ€§ä¸æ‰©å±•æ€§ã€‚ç»“åˆå›¢é˜Ÿç°çŠ¶å¾ªåºæ¸è¿›åœ°è½åœ°ï¼Œæ‰èƒ½çœŸæ­£é‡Šæ”¾å…¶ä»·å€¼ã€‚</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> æ¶æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯å·¥ç¨‹åŒ– </tag>
            
            <tag> æ¶æ„ </tag>
            
            <tag> FSD </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Three.js 3D æ¨¡å‹æ¸²æŸ“æŠ€æœ¯æ–‡æ¡£</title>
      <link href="/2025/08/15/three3d-render/"/>
      <url>/2025/08/15/three3d-render/</url>
      
        <content type="html"><![CDATA[<h1 id="Three-js-3D-æ¨¡å‹æ¸²æŸ“æŠ€æœ¯æ–‡æ¡£"><a href="#Three-js-3D-æ¨¡å‹æ¸²æŸ“æŠ€æœ¯æ–‡æ¡£" class="headerlink" title="Three.js 3D æ¨¡å‹æ¸²æŸ“æŠ€æœ¯æ–‡æ¡£"></a>Three.js 3D æ¨¡å‹æ¸²æŸ“æŠ€æœ¯æ–‡æ¡£</h1><h2 id="ä¸€ã€é¡¹ç›®æ¦‚è¿°"><a href="#ä¸€ã€é¡¹ç›®æ¦‚è¿°" class="headerlink" title="ä¸€ã€é¡¹ç›®æ¦‚è¿°"></a>ä¸€ã€é¡¹ç›®æ¦‚è¿°</h2><p>æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªåŸºäº <strong>Three.js</strong> æ„å»ºçš„ 3D æ¨¡å‹æ¸²æŸ“ç³»ç»Ÿï¼Œæ”¯æŒåŠ è½½å’Œå±•ç¤º GLTF/GLB æ ¼å¼çš„ 3D æ¨¡å‹ï¼Œæä¾›äº†ä¸°å¯Œçš„äº¤äº’åŠŸèƒ½å’ŒåŠ¨ç”»æ§åˆ¶ã€‚</p><h3 id="æ ¸å¿ƒåŠŸèƒ½"><a href="#æ ¸å¿ƒåŠŸèƒ½" class="headerlink" title="æ ¸å¿ƒåŠŸèƒ½"></a>æ ¸å¿ƒåŠŸèƒ½</h3><ul><li>âœ… GLTF/GLB æ ¼å¼ 3D æ¨¡å‹åŠ è½½</li><li>âœ… äº¤äº’å¼ç›¸æœºæ§åˆ¶ï¼ˆOrbitControlsï¼‰</li><li>âœ… è‡ªåŠ¨æ—‹è½¬åŠ¨ç”»</li><li>âœ… å®æ—¶æ€§èƒ½ç›‘æ§</li><li>âœ… å“åº”å¼å¸ƒå±€è®¾è®¡</li><li>âœ… å¯è°ƒèŠ‚çš„åŠ¨ç”»é€Ÿåº¦å’Œç›¸æœºè·ç¦»</li></ul><h3 id="åœ¨çº¿æ¼”ç¤º"><a href="#åœ¨çº¿æ¼”ç¤º" class="headerlink" title="åœ¨çº¿æ¼”ç¤º"></a>åœ¨çº¿æ¼”ç¤º</h3><p>ğŸ® <a href="/3dRenderDemo/index.html">ç‚¹å‡»æŸ¥çœ‹ 3D æ¸²æŸ“æ¼”ç¤ºé¡µé¢</a></p><h2 id="äºŒã€æŠ€æœ¯æ¶æ„"><a href="#äºŒã€æŠ€æœ¯æ¶æ„" class="headerlink" title="äºŒã€æŠ€æœ¯æ¶æ„"></a>äºŒã€æŠ€æœ¯æ¶æ„</h2><h3 id="2-1-æ ¸å¿ƒæŠ€æœ¯æ ˆ"><a href="#2-1-æ ¸å¿ƒæŠ€æœ¯æ ˆ" class="headerlink" title="2.1 æ ¸å¿ƒæŠ€æœ¯æ ˆ"></a>2.1 æ ¸å¿ƒæŠ€æœ¯æ ˆ</h3><ul><li><strong>Three.js</strong>: WebGL 3D å›¾å½¢åº“</li><li><strong>GLTFLoader</strong>: GLTF/GLB æ¨¡å‹åŠ è½½å™¨</li><li><strong>OrbitControls</strong>: è½¨é“æ§åˆ¶å™¨ï¼Œå®ç°ç›¸æœºäº¤äº’</li><li><strong>ES6 Modules</strong>: ä½¿ç”¨ç°ä»£ JavaScript æ¨¡å—åŒ–å¼€å‘</li></ul><h3 id="2-2-é¡¹ç›®ç»“æ„"><a href="#2-2-é¡¹ç›®ç»“æ„" class="headerlink" title="2.2 é¡¹ç›®ç»“æ„"></a>2.2 é¡¹ç›®ç»“æ„</h3><pre><code>3dRenderDemo/â”œâ”€â”€ index.html          # ä¸»é¡µé¢æ–‡ä»¶â”œâ”€â”€ libs/               # Three.js åº“æ–‡ä»¶â”‚   â”œâ”€â”€ three.module.jsâ”‚   â”œâ”€â”€ GLTFLoader.jsâ”‚   â””â”€â”€ OrbitControls.jsâ””â”€â”€ ZTZ99A.glb          # 3D æ¨¡å‹æ–‡ä»¶</code></pre><h2 id="ä¸‰ã€æ ¸å¿ƒå®ç°"><a href="#ä¸‰ã€æ ¸å¿ƒå®ç°" class="headerlink" title="ä¸‰ã€æ ¸å¿ƒå®ç°"></a>ä¸‰ã€æ ¸å¿ƒå®ç°</h2><h3 id="3-1-æ¨¡å—å¯¼å…¥ä¸é…ç½®"><a href="#3-1-æ¨¡å—å¯¼å…¥ä¸é…ç½®" class="headerlink" title="3.1 æ¨¡å—å¯¼å…¥ä¸é…ç½®"></a>3.1 æ¨¡å—å¯¼å…¥ä¸é…ç½®</h3><p>é¡¹ç›®ä½¿ç”¨ ES6 æ¨¡å—ç³»ç»Ÿå’Œ importmap æ¥ç®¡ç†ä¾èµ–ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// importmap é…ç½®</span><span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">"importmap"</span><span class="token operator">></span><span class="token punctuation">{</span>  <span class="token string">"imports"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>    <span class="token string">"three"</span><span class="token punctuation">:</span> <span class="token string">"./libs/three.module.js"</span><span class="token punctuation">,</span>    <span class="token string">"three/addons/"</span><span class="token punctuation">:</span> <span class="token string">"./libs/"</span><span class="token punctuation">,</span>    <span class="token string">"three/examples/jsm/"</span><span class="token punctuation">:</span> <span class="token string">"./libs/"</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span class="token comment" spellcheck="true">// æ¨¡å—å¯¼å…¥</span><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> THREE <span class="token keyword">from</span> <span class="token string">"./libs/three.module.js"</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span> GLTFLoader <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./libs/GLTFLoader.js"</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span> OrbitControls <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./libs/OrbitControls.js"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-2-åœºæ™¯åˆå§‹åŒ–"><a href="#3-2-åœºæ™¯åˆå§‹åŒ–" class="headerlink" title="3.2 åœºæ™¯åˆå§‹åŒ–"></a>3.2 åœºæ™¯åˆå§‹åŒ–</h3><h4 id="3-2-1-åœºæ™¯åˆ›å»º"><a href="#3-2-1-åœºæ™¯åˆ›å»º" class="headerlink" title="3.2.1 åœºæ™¯åˆ›å»º"></a>3.2.1 åœºæ™¯åˆ›å»º</h4><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> scene <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Scene</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>scene<span class="token punctuation">.</span>background <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Color</span><span class="token punctuation">(</span><span class="token number">0x87ceeb</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// å¤©è“è‰²èƒŒæ™¯</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h4 id="3-2-2-ç›¸æœºè®¾ç½®"><a href="#3-2-2-ç›¸æœºè®¾ç½®" class="headerlink" title="3.2.2 ç›¸æœºè®¾ç½®"></a>3.2.2 ç›¸æœºè®¾ç½®</h4><p>ä½¿ç”¨é€è§†ç›¸æœºï¼ˆPerspectiveCameraï¼‰ï¼Œæ¨¡æ‹Ÿäººçœ¼è§†è§’ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> camera <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>PerspectiveCamera</span><span class="token punctuation">(</span>  <span class="token number">60</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// è§†é‡è§’åº¦ï¼ˆFOVï¼‰</span>  window<span class="token punctuation">.</span>innerWidth <span class="token operator">/</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// å®½é«˜æ¯”</span>  <span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// è¿‘è£å‰ªé¢</span>  <span class="token number">1000</span> <span class="token comment" spellcheck="true">// è¿œè£å‰ªé¢</span><span class="token punctuation">)</span><span class="token punctuation">;</span>camera<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// è®¾ç½®ç›¸æœºåˆå§‹ä½ç½®</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p><ul><li><strong>FOV (60Â°)</strong>: è§†é‡è§’åº¦ï¼Œå€¼è¶Šå¤§è§†é‡è¶Šå¹¿</li><li><strong>å®½é«˜æ¯”</strong>: æ ¹æ®çª—å£å°ºå¯¸åŠ¨æ€è®¡ç®—</li><li><strong>è¿‘/è¿œè£å‰ªé¢</strong>: å®šä¹‰å¯è§èŒƒå›´ï¼Œè¶…å‡ºèŒƒå›´çš„ç‰©ä½“ä¸æ¸²æŸ“</li></ul><h4 id="3-2-3-æ¸²æŸ“å™¨é…ç½®"><a href="#3-2-3-æ¸²æŸ“å™¨é…ç½®" class="headerlink" title="3.2.3 æ¸²æŸ“å™¨é…ç½®"></a>3.2.3 æ¸²æŸ“å™¨é…ç½®</h4><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> renderer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>WebGLRenderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span> antialias<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>renderer<span class="token punctuation">.</span><span class="token function">setSize</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">,</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">)</span><span class="token punctuation">;</span>renderer<span class="token punctuation">.</span>shadowMap<span class="token punctuation">.</span>enabled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// å¯ç”¨é˜´å½±æ˜ å°„</span>document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>renderer<span class="token punctuation">.</span>domElement<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>å…³é”®ç‰¹æ€§ï¼š</strong></p><ul><li><code>antialias: true</code>: å¯ç”¨æŠ—é”¯é½¿ï¼Œæå‡æ¸²æŸ“è´¨é‡</li><li><code>shadowMap.enabled</code>: å¯ç”¨é˜´å½±æ•ˆæœ</li></ul><h3 id="3-3-å…‰ç…§ç³»ç»Ÿ"><a href="#3-3-å…‰ç…§ç³»ç»Ÿ" class="headerlink" title="3.3 å…‰ç…§ç³»ç»Ÿ"></a>3.3 å…‰ç…§ç³»ç»Ÿ</h3><p>é¡¹ç›®é‡‡ç”¨<strong>å¤šå…‰æºç…§æ˜æ–¹æ¡ˆ</strong>ï¼Œç¡®ä¿æ¨¡å‹å„ä¸ªè§’åº¦éƒ½æœ‰è‰¯å¥½çš„å…‰ç…§æ•ˆæœï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// å‰æ–¹ç¯å…‰ï¼ˆæ­£Zæ–¹å‘ï¼‰</span><span class="token keyword">const</span> lightFront <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>DirectionalLight</span><span class="token punctuation">(</span><span class="token number">0xffffff</span><span class="token punctuation">,</span> <span class="token number">0.8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>lightFront<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>lightFront<span class="token punctuation">.</span>castShadow <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// åæ–¹ç¯å…‰ï¼ˆè´ŸZæ–¹å‘ï¼‰</span><span class="token keyword">const</span> lightBack <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>DirectionalLight</span><span class="token punctuation">(</span><span class="token number">0xffffff</span><span class="token punctuation">,</span> <span class="token number">0.6</span><span class="token punctuation">)</span><span class="token punctuation">;</span>lightBack<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// å·¦ä¾§ç¯å…‰ï¼ˆè´ŸXæ–¹å‘ï¼‰</span><span class="token keyword">const</span> lightLeft <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>DirectionalLight</span><span class="token punctuation">(</span><span class="token number">0xffffff</span><span class="token punctuation">,</span> <span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>lightLeft<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// å³ä¾§ç¯å…‰ï¼ˆæ­£Xæ–¹å‘ï¼‰</span><span class="token keyword">const</span> lightRight <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>DirectionalLight</span><span class="token punctuation">(</span><span class="token number">0xffffff</span><span class="token punctuation">,</span> <span class="token number">0.7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>lightRight<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// ç¯å¢ƒå…‰ï¼ˆæä¾›åŸºç¡€ç…§æ˜ï¼‰</span><span class="token keyword">const</span> ambientLight <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>AmbientLight</span><span class="token punctuation">(</span><span class="token number">0xffffff</span><span class="token punctuation">,</span> <span class="token number">0.4</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>å…‰ç…§ç­–ç•¥ï¼š</strong></p><ul><li><strong>æ–¹å‘å…‰ï¼ˆDirectionalLightï¼‰</strong>: æ¨¡æ‹Ÿå¤ªé˜³å…‰ï¼Œä»å››ä¸ªæ–¹å‘ç…§å°„</li><li><strong>ç¯å¢ƒå…‰ï¼ˆAmbientLightï¼‰</strong>: æä¾›æ•´ä½“åŸºç¡€äº®åº¦ï¼Œé¿å…å®Œå…¨é»‘æš—çš„åŒºåŸŸ</li><li><strong>å¼ºåº¦åˆ†é…</strong>: å‰æ–¹ 0.8ï¼Œå·¦å³ 0.7ï¼Œåæ–¹ 0.6ï¼Œç¯å¢ƒå…‰ 0.4</li></ul><h3 id="3-4-äº¤äº’æ§åˆ¶"><a href="#3-4-äº¤äº’æ§åˆ¶" class="headerlink" title="3.4 äº¤äº’æ§åˆ¶"></a>3.4 äº¤äº’æ§åˆ¶</h3><p>ä½¿ç”¨ <strong>OrbitControls</strong> å®ç°ç›¸æœºäº¤äº’ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> controls <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OrbitControls</span><span class="token punctuation">(</span>camera<span class="token punctuation">,</span> renderer<span class="token punctuation">.</span>domElement<span class="token punctuation">)</span><span class="token punctuation">;</span>controls<span class="token punctuation">.</span>enableDamping <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// å¯ç”¨é˜»å°¼æ•ˆæœ</span>controls<span class="token punctuation">.</span>dampingFactor <span class="token operator">=</span> <span class="token number">0.05</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// é˜»å°¼ç³»æ•°</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>äº¤äº’åŠŸèƒ½ï¼š</strong></p><ul><li><strong>é¼ æ ‡å·¦é”®æ‹–æ‹½</strong>: æ—‹è½¬è§†è§’</li><li><strong>é¼ æ ‡æ»šè½®</strong>: ç¼©æ”¾</li><li><strong>é¼ æ ‡å³é”®æ‹–æ‹½</strong>: å¹³ç§»è§†è§’</li><li><strong>é˜»å°¼æ•ˆæœ</strong>: ä½¿äº¤äº’æ›´å¹³æ»‘è‡ªç„¶</li></ul><h3 id="3-5-æ¨¡å‹åŠ è½½"><a href="#3-5-æ¨¡å‹åŠ è½½" class="headerlink" title="3.5 æ¨¡å‹åŠ è½½"></a>3.5 æ¨¡å‹åŠ è½½</h3><h4 id="3-5-1-GLTFLoader-ä½¿ç”¨"><a href="#3-5-1-GLTFLoader-ä½¿ç”¨" class="headerlink" title="3.5.1 GLTFLoader ä½¿ç”¨"></a>3.5.1 GLTFLoader ä½¿ç”¨</h4><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> loader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GLTFLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>loader<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>  <span class="token string">"./ZTZ99A.glb"</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// æ¨¡å‹æ–‡ä»¶è·¯å¾„</span>  <span class="token punctuation">(</span>gltf<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// æˆåŠŸå›è°ƒ</span>    scene<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>gltf<span class="token punctuation">.</span>scene<span class="token punctuation">)</span><span class="token punctuation">;</span>    model <span class="token operator">=</span> gltf<span class="token punctuation">.</span>scene<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// å¤„ç†æ¨¡å‹...</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">(</span>progress<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// è¿›åº¦å›è°ƒ</span>    <span class="token keyword">const</span> percent <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>progress<span class="token punctuation">.</span>loaded <span class="token operator">/</span> progress<span class="token punctuation">.</span>total<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// æ›´æ–°åŠ è½½è¿›åº¦...</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// é”™è¯¯å›è°ƒ</span>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"åŠ è½½å¤±è´¥:"</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3-5-2-æ¨¡å‹å±…ä¸­ä¸è‡ªé€‚åº”"><a href="#3-5-2-æ¨¡å‹å±…ä¸­ä¸è‡ªé€‚åº”" class="headerlink" title="3.5.2 æ¨¡å‹å±…ä¸­ä¸è‡ªé€‚åº”"></a>3.5.2 æ¨¡å‹å±…ä¸­ä¸è‡ªé€‚åº”</h4><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// è®¡ç®—æ¨¡å‹è¾¹ç•Œ</span><span class="token keyword">const</span> box <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Box3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setFromObject</span><span class="token punctuation">(</span>gltf<span class="token punctuation">.</span>scene<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> center <span class="token operator">=</span> box<span class="token punctuation">.</span><span class="token function">getCenter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> size <span class="token operator">=</span> box<span class="token punctuation">.</span><span class="token function">getSize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">THREE<span class="token punctuation">.</span>Vector3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// å°†æ¨¡å‹ç§»åŠ¨åˆ°åœºæ™¯ä¸­å¿ƒ</span>gltf<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token operator">-</span>center<span class="token punctuation">.</span>x<span class="token punctuation">;</span>gltf<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token operator">-</span>center<span class="token punctuation">.</span>y<span class="token punctuation">;</span>gltf<span class="token punctuation">.</span>scene<span class="token punctuation">.</span>position<span class="token punctuation">.</span>z <span class="token operator">=</span> <span class="token operator">-</span>center<span class="token punctuation">.</span>z<span class="token punctuation">;</span><span class="token comment" spellcheck="true">// ä¿å­˜æ¨¡å‹å°ºå¯¸ä¿¡æ¯</span>modelSize <span class="token operator">=</span> <span class="token punctuation">{</span>  maxDim<span class="token punctuation">:</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>size<span class="token punctuation">.</span>x<span class="token punctuation">,</span> size<span class="token punctuation">.</span>y<span class="token punctuation">,</span> size<span class="token punctuation">.</span>z<span class="token punctuation">)</span><span class="token punctuation">,</span>  center<span class="token punctuation">:</span> center<span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>å…³é”®æ­¥éª¤ï¼š</strong></p><ol><li>ä½¿ç”¨ <code>Box3</code> è®¡ç®—æ¨¡å‹åŒ…å›´ç›’</li><li>è·å–æ¨¡å‹ä¸­å¿ƒç‚¹å’Œå°ºå¯¸</li><li>é€šè¿‡è´Ÿåç§»å°†æ¨¡å‹ç§»åŠ¨åˆ°åŸç‚¹</li><li>ä¿å­˜æœ€å¤§å°ºå¯¸ç”¨äºç›¸æœºå®šä½</li></ol><h3 id="3-6-åŠ¨ç”»ç³»ç»Ÿ"><a href="#3-6-åŠ¨ç”»ç³»ç»Ÿ" class="headerlink" title="3.6 åŠ¨ç”»ç³»ç»Ÿ"></a>3.6 åŠ¨ç”»ç³»ç»Ÿ</h3><h4 id="3-6-1-åŠ¨ç”»å¾ªç¯"><a href="#3-6-1-åŠ¨ç”»å¾ªç¯" class="headerlink" title="3.6.1 åŠ¨ç”»å¾ªç¯"></a>3.6.1 åŠ¨ç”»å¾ªç¯</h4><p>ä½¿ç”¨ <code>requestAnimationFrame</code> å®ç°æµç•…çš„åŠ¨ç”»ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">animate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>animate<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> currentTime <span class="token operator">=</span> performance<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> deltaTime <span class="token operator">=</span> <span class="token punctuation">(</span>currentTime <span class="token operator">-</span> lastTime<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// è½¬æ¢ä¸ºç§’</span>  lastTime <span class="token operator">=</span> currentTime<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// æ—‹è½¬åŠ¨ç”»</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>model <span class="token operator">&amp;&amp;</span> isAnimationEnabled <span class="token operator">&amp;&amp;</span> rotationSpeed <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    rotationAngle <span class="token operator">+</span><span class="token operator">=</span> rotationSpeed <span class="token operator">*</span> deltaTime<span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>rotationAngle <span class="token operator">>=</span> <span class="token number">360</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      rotationAngle <span class="token operator">-</span><span class="token operator">=</span> <span class="token number">360</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    model<span class="token punctuation">.</span>rotation<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token punctuation">(</span>rotationAngle <span class="token operator">*</span> Math<span class="token punctuation">.</span>PI<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  controls<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  renderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>scene<span class="token punctuation">,</span> camera<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>åŠ¨ç”»åŸç†ï¼š</strong></p><ul><li><strong>åŸºäºæ—¶é—´</strong>: ä½¿ç”¨ <code>deltaTime</code> ç¡®ä¿åŠ¨ç”»é€Ÿåº¦ä¸å—å¸§ç‡å½±å“</li><li><strong>360 åº¦å¾ªç¯</strong>: è§’åº¦è¶…è¿‡ 360Â° æ—¶é‡ç½®ï¼Œå®ç°æ— é™æ—‹è½¬</li><li><strong>å¼§åº¦è½¬æ¢</strong>: å°†è§’åº¦è½¬æ¢ä¸ºå¼§åº¦ï¼ˆ<code>è§’åº¦ Ã— Ï€ / 180</code>ï¼‰</li></ul><h4 id="3-6-2-ç›¸æœºä½ç½®è‡ªé€‚åº”"><a href="#3-6-2-ç›¸æœºä½ç½®è‡ªé€‚åº”" class="headerlink" title="3.6.2 ç›¸æœºä½ç½®è‡ªé€‚åº”"></a>3.6.2 ç›¸æœºä½ç½®è‡ªé€‚åº”</h4><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">updateCameraPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>modelSize<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> distance <span class="token operator">=</span> modelSize<span class="token punctuation">.</span>maxDim <span class="token operator">*</span> zoomFactor<span class="token punctuation">;</span>    camera<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>distance<span class="token punctuation">,</span> distance <span class="token operator">*</span> <span class="token number">0.6</span><span class="token punctuation">,</span> distance<span class="token punctuation">)</span><span class="token punctuation">;</span>    camera<span class="token punctuation">.</span><span class="token function">lookAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    controls<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    controls<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ç›¸æœºå®šä½ç­–ç•¥ï¼š</strong></p><ul><li>æ ¹æ®æ¨¡å‹æœ€å¤§å°ºå¯¸è®¡ç®—è·ç¦»</li><li>ä½¿ç”¨ <code>zoomFactor</code> æ§åˆ¶ç¼©æ”¾æ¯”ä¾‹</li><li>Y è½´ä½ç½®ä¸ºè·ç¦»çš„ 60%ï¼Œå½¢æˆä¿¯è§†è§’åº¦</li><li>ç›¸æœºå§‹ç»ˆæœå‘åœºæ™¯ä¸­å¿ƒ</li></ul><h3 id="3-7-å“åº”å¼è®¾è®¡"><a href="#3-7-å“åº”å¼è®¾è®¡" class="headerlink" title="3.7 å“åº”å¼è®¾è®¡"></a>3.7 å“åº”å¼è®¾è®¡</h3><p>ç›‘å¬çª—å£å¤§å°å˜åŒ–ï¼ŒåŠ¨æ€è°ƒæ•´æ¸²æŸ“å°ºå¯¸ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript">window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"resize"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  camera<span class="token punctuation">.</span>aspect <span class="token operator">=</span> window<span class="token punctuation">.</span>innerWidth <span class="token operator">/</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">;</span>  camera<span class="token punctuation">.</span><span class="token function">updateProjectionMatrix</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  renderer<span class="token punctuation">.</span><span class="token function">setSize</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">,</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å››ã€æ§åˆ¶é¢æ¿åŠŸèƒ½"><a href="#å››ã€æ§åˆ¶é¢æ¿åŠŸèƒ½" class="headerlink" title="å››ã€æ§åˆ¶é¢æ¿åŠŸèƒ½"></a>å››ã€æ§åˆ¶é¢æ¿åŠŸèƒ½</h2><h3 id="4-1-UI-ç»„ä»¶"><a href="#4-1-UI-ç»„ä»¶" class="headerlink" title="4.1 UI ç»„ä»¶"></a>4.1 UI ç»„ä»¶</h3><p>æ§åˆ¶é¢æ¿æä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š</p><ol><li><strong>åŠ¨ç”»å¼€å…³</strong>: å¯ç”¨/ç¦ç”¨è‡ªåŠ¨æ—‹è½¬</li><li><strong>æ—‹è½¬é€Ÿåº¦</strong>: 0-180 åº¦/ç§’å¯è°ƒ</li><li><strong>é•œå¤´è·ç¦»</strong>: 0.5-3.0 å€å¯è°ƒ</li><li><strong>åŠ è½½æ—¶é—´</strong>: æ˜¾ç¤ºæ¨¡å‹åŠ è½½è€—æ—¶</li><li><strong>é¡µé¢åŠ è½½æ—¶é—´</strong>: æ˜¾ç¤ºæ€»åŠ è½½æ—¶é—´</li></ol><h3 id="4-2-äº‹ä»¶ç›‘å¬"><a href="#4-2-äº‹ä»¶ç›‘å¬" class="headerlink" title="4.2 äº‹ä»¶ç›‘å¬"></a>4.2 äº‹ä»¶ç›‘å¬</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// åŠ¨ç”»å¼€å…³</span>animationToggle<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"change"</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>  isAnimationEnabled <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>checked<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// é€Ÿåº¦æ»‘å—</span>speedSlider<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"input"</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>  rotationSpeed <span class="token operator">=</span> <span class="token function">parseFloat</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>  speedValue<span class="token punctuation">.</span>textContent <span class="token operator">=</span> rotationSpeed<span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// ç¼©æ”¾æ»‘å—</span>zoomSlider<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"input"</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>  zoomFactor <span class="token operator">=</span> <span class="token function">parseFloat</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">updateCameraPosition</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="äº”ã€æ€§èƒ½ä¼˜åŒ–"><a href="#äº”ã€æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="äº”ã€æ€§èƒ½ä¼˜åŒ–"></a>äº”ã€æ€§èƒ½ä¼˜åŒ–</h2><h3 id="5-1-æ€§èƒ½ç›‘æ§"><a href="#5-1-æ€§èƒ½ç›‘æ§" class="headerlink" title="5.1 æ€§èƒ½ç›‘æ§"></a>5.1 æ€§èƒ½ç›‘æ§</h3><p>é¡¹ç›®é›†æˆäº†æ€§èƒ½ç›‘æ§åŠŸèƒ½ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// é¡µé¢åŠ è½½æ—¶é—´</span><span class="token keyword">const</span> pageLoadStartTime <span class="token operator">=</span> performance<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// ...</span><span class="token keyword">const</span> totalLoadDuration <span class="token operator">=</span> pageLoadEndTime <span class="token operator">-</span> pageLoadStartTime<span class="token punctuation">;</span><span class="token comment" spellcheck="true">// æ¨¡å‹åŠ è½½æ—¶é—´</span><span class="token keyword">const</span> loadStartTime <span class="token operator">=</span> performance<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// ...</span><span class="token keyword">const</span> loadDuration <span class="token operator">=</span> loadEndTime <span class="token operator">-</span> loadStartTime<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-2-ä¼˜åŒ–å»ºè®®"><a href="#5-2-ä¼˜åŒ–å»ºè®®" class="headerlink" title="5.2 ä¼˜åŒ–å»ºè®®"></a>5.2 ä¼˜åŒ–å»ºè®®</h3><ol><li><strong>æ¨¡å‹ä¼˜åŒ–</strong>: ä½¿ç”¨å‹ç¼©çš„ GLB æ ¼å¼ï¼Œå‡å°‘æ–‡ä»¶å¤§å°</li><li><strong>çº¹ç†ä¼˜åŒ–</strong>: åˆç†è®¾ç½®çº¹ç†åˆ†è¾¨ç‡</li><li><strong>LOD æŠ€æœ¯</strong>: æ ¹æ®è·ç¦»ä½¿ç”¨ä¸åŒç»†èŠ‚çº§åˆ«çš„æ¨¡å‹</li><li><strong>é˜´å½±ä¼˜åŒ–</strong>: åˆç†è®¾ç½®é˜´å½±è´´å›¾åˆ†è¾¨ç‡</li><li><strong>å¸§ç‡æ§åˆ¶</strong>: ä½¿ç”¨ <code>requestAnimationFrame</code> ç¡®ä¿æµç•…æ¸²æŸ“</li></ol><h2 id="å…­ã€å¸¸è§é—®é¢˜"><a href="#å…­ã€å¸¸è§é—®é¢˜" class="headerlink" title="å…­ã€å¸¸è§é—®é¢˜"></a>å…­ã€å¸¸è§é—®é¢˜</h2><h3 id="6-1-æ¨¡å‹åŠ è½½å¤±è´¥"><a href="#6-1-æ¨¡å‹åŠ è½½å¤±è´¥" class="headerlink" title="6.1 æ¨¡å‹åŠ è½½å¤±è´¥"></a>6.1 æ¨¡å‹åŠ è½½å¤±è´¥</h3><p><strong>å¯èƒ½åŸå› ï¼š</strong></p><ul><li>æ–‡ä»¶è·¯å¾„é”™è¯¯</li><li>æ–‡ä»¶æ ¼å¼ä¸æ”¯æŒ</li><li>CORS è·¨åŸŸé—®é¢˜</li></ul><p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p><ul><li>æ£€æŸ¥æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®</li><li>ç¡®ä¿ä½¿ç”¨ GLTF/GLB æ ¼å¼</li><li>é…ç½®æœåŠ¡å™¨ CORS å¤´</li></ul><h3 id="6-2-æ¨¡å‹æ˜¾ç¤ºå¼‚å¸¸"><a href="#6-2-æ¨¡å‹æ˜¾ç¤ºå¼‚å¸¸" class="headerlink" title="6.2 æ¨¡å‹æ˜¾ç¤ºå¼‚å¸¸"></a>6.2 æ¨¡å‹æ˜¾ç¤ºå¼‚å¸¸</h3><p><strong>å¯èƒ½åŸå› ï¼š</strong></p><ul><li>æ¨¡å‹å°ºå¯¸è¿‡å¤§æˆ–è¿‡å°</li><li>ç›¸æœºä½ç½®ä¸å½“</li><li>å…‰ç…§ä¸è¶³</li></ul><p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p><ul><li>è°ƒæ•´ <code>zoomFactor</code> å‚æ•°</li><li>æ£€æŸ¥æ¨¡å‹å•ä½è®¾ç½®</li><li>å¢åŠ ç¯å¢ƒå…‰å¼ºåº¦</li></ul><h3 id="6-3-æ€§èƒ½é—®é¢˜"><a href="#6-3-æ€§èƒ½é—®é¢˜" class="headerlink" title="6.3 æ€§èƒ½é—®é¢˜"></a>6.3 æ€§èƒ½é—®é¢˜</h3><p><strong>å¯èƒ½åŸå› ï¼š</strong></p><ul><li>æ¨¡å‹é¢æ•°è¿‡å¤š</li><li>çº¹ç†è¿‡å¤§</li><li>é˜´å½±è®¡ç®—å¼€é”€å¤§</li></ul><p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p><ul><li>ä½¿ç”¨æ¨¡å‹ç®€åŒ–å·¥å…·</li><li>å‹ç¼©çº¹ç†å›¾ç‰‡</li><li>é™ä½é˜´å½±è´¨é‡æˆ–ç¦ç”¨é˜´å½±</li></ul><h2 id="ä¸ƒã€æ‰©å±•åŠŸèƒ½"><a href="#ä¸ƒã€æ‰©å±•åŠŸèƒ½" class="headerlink" title="ä¸ƒã€æ‰©å±•åŠŸèƒ½"></a>ä¸ƒã€æ‰©å±•åŠŸèƒ½</h2><h3 id="7-1-å¯æ‰©å±•æ–¹å‘"><a href="#7-1-å¯æ‰©å±•æ–¹å‘" class="headerlink" title="7.1 å¯æ‰©å±•æ–¹å‘"></a>7.1 å¯æ‰©å±•æ–¹å‘</h3><ul><li><strong>å¤šæ¨¡å‹åˆ‡æ¢</strong>: æ”¯æŒåŠ è½½å¤šä¸ªæ¨¡å‹å¹¶åˆ‡æ¢</li><li><strong>æè´¨ç¼–è¾‘</strong>: å®æ—¶ä¿®æ”¹æ¨¡å‹æè´¨å±æ€§</li><li><strong>åŠ¨ç”»æ’­æ”¾</strong>: æ”¯æŒ GLTF åŠ¨ç”»æ’­æ”¾</li><li><strong>åå¤„ç†æ•ˆæœ</strong>: æ·»åŠ æŠ—é”¯é½¿ã€æ™¯æ·±ç­‰æ•ˆæœ</li><li><strong>VR/AR æ”¯æŒ</strong>: é›†æˆ WebXR API</li></ul><h3 id="7-2-ä»£ç ç¤ºä¾‹ï¼šæ·»åŠ åå¤„ç†"><a href="#7-2-ä»£ç ç¤ºä¾‹ï¼šæ·»åŠ åå¤„ç†" class="headerlink" title="7.2 ä»£ç ç¤ºä¾‹ï¼šæ·»åŠ åå¤„ç†"></a>7.2 ä»£ç ç¤ºä¾‹ï¼šæ·»åŠ åå¤„ç†</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> EffectComposer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"three/examples/jsm/postprocessing/EffectComposer.js"</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span> RenderPass <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"three/examples/jsm/postprocessing/RenderPass.js"</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span> BloomPass <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"three/examples/jsm/postprocessing/BloomPass.js"</span><span class="token punctuation">;</span><span class="token keyword">const</span> composer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EffectComposer</span><span class="token punctuation">(</span>renderer<span class="token punctuation">)</span><span class="token punctuation">;</span>composer<span class="token punctuation">.</span><span class="token function">addPass</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RenderPass</span><span class="token punctuation">(</span>scene<span class="token punctuation">,</span> camera<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>composer<span class="token punctuation">.</span><span class="token function">addPass</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">BloomPass</span><span class="token punctuation">(</span><span class="token number">1.25</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">4.0</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="å…«ã€æ€»ç»“"><a href="#å…«ã€æ€»ç»“" class="headerlink" title="å…«ã€æ€»ç»“"></a>å…«ã€æ€»ç»“</h2><p>æœ¬é¡¹ç›®å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ Three.js æ„å»ºä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„ 3D æ¨¡å‹æ¸²æŸ“ç³»ç»Ÿã€‚é€šè¿‡åˆç†çš„æ¶æ„è®¾è®¡ã€å…‰ç…§é…ç½®å’Œäº¤äº’æ§åˆ¶ï¼Œå®ç°äº†è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒã€‚</p><h3 id="æŠ€æœ¯è¦ç‚¹æ€»ç»“"><a href="#æŠ€æœ¯è¦ç‚¹æ€»ç»“" class="headerlink" title="æŠ€æœ¯è¦ç‚¹æ€»ç»“"></a>æŠ€æœ¯è¦ç‚¹æ€»ç»“</h3><ol><li>âœ… <strong>æ¨¡å—åŒ–å¼€å‘</strong>: ä½¿ç”¨ ES6 Modules ç»„ç»‡ä»£ç </li><li>âœ… <strong>äº¤äº’ä½“éªŒ</strong>: OrbitControls æä¾›æµç•…çš„ç›¸æœºæ§åˆ¶</li><li>âœ… <strong>æ€§èƒ½ç›‘æ§</strong>: å®æ—¶æ˜¾ç¤ºåŠ è½½å’Œæ¸²æŸ“æ€§èƒ½</li><li>âœ… <strong>å“åº”å¼è®¾è®¡</strong>: é€‚é…ä¸åŒå±å¹•å°ºå¯¸</li><li>âœ… <strong>åŠ¨ç”»ç³»ç»Ÿ</strong>: åŸºäºæ—¶é—´çš„å¹³æ»‘åŠ¨ç”»</li></ol><h3 id="å­¦ä¹ èµ„æº"><a href="#å­¦ä¹ èµ„æº" class="headerlink" title="å­¦ä¹ èµ„æº"></a>å­¦ä¹ èµ„æº</h3><ul><li><a href="https://threejs.org/docs/">Three.js å®˜æ–¹æ–‡æ¡£</a></li><li><a href="https://threejs.org/examples/">Three.js ç¤ºä¾‹</a></li><li><a href="https://www.khronos.org/gltf/">GLTF è§„èŒƒ</a></li></ul><hr><p><strong>é¡¹ç›®åœ°å€</strong>: <a href="/3dRenderDemo/index.html">3D æ¸²æŸ“æ¼”ç¤º</a></p><p><strong>æœ€åæ›´æ–°</strong>: 2025-11-15</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯çŸ¥è¯†æ±‡æ€» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> WebGL </tag>
            
            <tag> Three.js </tag>
            
            <tag> 3Dæ¸²æŸ“ </tag>
            
            <tag> å‰ç«¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>react18 å­¦ä¹ ç¬”è®°ï¼ˆä¸€ï¼‰React 17 ä¸ React 18 çš„åŒºåˆ«ä¸ä¼˜åŒ–å»ºè®®(å­¦ä¹ æ›´æ–°ä¸­...)</title>
      <link href="/2025/06/06/react18/"/>
      <url>/2025/06/06/react18/</url>
      
        <content type="html"><![CDATA[<h1 id="React-17-ä¸-React-18-çš„åŒºåˆ«ä¸ä¼˜åŒ–å»ºè®®"><a href="#React-17-ä¸-React-18-çš„åŒºåˆ«ä¸ä¼˜åŒ–å»ºè®®" class="headerlink" title="React 17 ä¸ React 18 çš„åŒºåˆ«ä¸ä¼˜åŒ–å»ºè®®"></a>React 17 ä¸ React 18 çš„åŒºåˆ«ä¸ä¼˜åŒ–å»ºè®®</h1><h2 id="ä¸€ã€æ¸²æŸ“å¼•æ“å˜åŒ–"><a href="#ä¸€ã€æ¸²æŸ“å¼•æ“å˜åŒ–" class="headerlink" title="ä¸€ã€æ¸²æŸ“å¼•æ“å˜åŒ–"></a>ä¸€ã€æ¸²æŸ“å¼•æ“å˜åŒ–</h2><p>React 17 ä½¿ç”¨ä¼ ç»Ÿçš„åŒæ­¥æ¸²æŸ“å¼•æ“ï¼ˆLegacy Rendererï¼‰ï¼Œè€Œ React 18 å¼•å…¥äº†å…¨æ–°çš„å¹¶å‘æ¸²æŸ“å¼•æ“ï¼ˆConcurrent Rendererï¼‰ï¼Œä½¿å¾— UI æ›´æ–°æ›´åŠ æµç•…å’Œå¯ä¸­æ–­ï¼Œä»è€Œæå‡æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒã€‚</p><h2 id="äºŒã€è‡ªåŠ¨æ‰¹å¤„ç†å¢å¼º"><a href="#äºŒã€è‡ªåŠ¨æ‰¹å¤„ç†å¢å¼º" class="headerlink" title="äºŒã€è‡ªåŠ¨æ‰¹å¤„ç†å¢å¼º"></a>äºŒã€è‡ªåŠ¨æ‰¹å¤„ç†å¢å¼º</h2><p>åœ¨ React 17 ä¸­ï¼Œåªæœ‰ React æ§åˆ¶ä¸‹çš„äº‹ä»¶ï¼ˆå¦‚ç‚¹å‡»äº‹ä»¶ã€ç”Ÿå‘½å‘¨æœŸé’©å­ï¼‰ä¸­çš„ <code>setState</code> æ‰ä¼šè¢«è‡ªåŠ¨æ‰¹å¤„ç†ã€‚è€Œåœ¨ React 18 ä¸­ï¼Œæ‰€æœ‰åœºæ™¯ä¸‹çš„ <code>setState</code> é»˜è®¤éƒ½ä¼šè¢«æ‰¹å¤„ç†ï¼Œæ¯”å¦‚ <code>setTimeout</code>ã€Promise å›è°ƒã€åŸç”Ÿäº‹ä»¶ä¸­ï¼Œèƒ½æ˜¾è‘—å‡å°‘å¤šæ¬¡æ¸²æŸ“æ¬¡æ•°ã€‚</p><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-js"><code class="language-js"><span class="token comment" spellcheck="true">// React 18 ä¸­å¤šä¸ª setState åˆå¹¶æˆä¸€æ¬¡æ¸²æŸ“</span><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token function">setA</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">setB</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ä¸‰ã€startTransition-æ§åˆ¶ä¼˜å…ˆçº§"><a href="#ä¸‰ã€startTransition-æ§åˆ¶ä¼˜å…ˆçº§" class="headerlink" title="ä¸‰ã€startTransition æ§åˆ¶ä¼˜å…ˆçº§"></a>ä¸‰ã€startTransition æ§åˆ¶ä¼˜å…ˆçº§</h2><p>React 18 æä¾›äº† <code>startTransition</code> æ–¹æ³•ï¼Œè®©å¼€å‘è€…å¯ä»¥å°†éç´§æ€¥çš„çŠ¶æ€æ›´æ–°æ ‡è®°ä¸ºâ€œå¯ä¸­æ–­â€çš„æ›´æ–°ï¼Œä»è€Œä¼˜å…ˆå¤„ç†ç”¨æˆ·è¾“å…¥ç­‰æ›´å…³é”®çš„ä»»åŠ¡ã€‚</p><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-js"><code class="language-js"><span class="token function">startTransition</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token function">setSearchResult</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// æ¸²æŸ“è¿‡ç¨‹ä¸­å¯ä»¥è¢«ä¸­æ–­</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="å››ã€Suspense-æ•°æ®åŠ è½½èƒ½åŠ›å¢å¼º"><a href="#å››ã€Suspense-æ•°æ®åŠ è½½èƒ½åŠ›å¢å¼º" class="headerlink" title="å››ã€Suspense æ•°æ®åŠ è½½èƒ½åŠ›å¢å¼º"></a>å››ã€Suspense æ•°æ®åŠ è½½èƒ½åŠ›å¢å¼º</h2><p>åœ¨ React 17 ä¸­ï¼Œ<code>Suspense</code> ä»…èƒ½æ­é… <code>React.lazy</code> ç”¨äºæ‡’åŠ è½½ç»„ä»¶ã€‚è€Œåœ¨ React 18 ä¸­ï¼Œ<code>Suspense</code> å¯ç”¨äºæ•°æ®è¯·æ±‚çš„â€œå»¶è¿ŸåŠ è½½â€åœºæ™¯ï¼Œæ¯”å¦‚ç»“åˆ <code>React Server Components</code> æˆ– <code>Streaming SSR</code>ã€‚</p><h2 id="äº”ã€æ–°å¢-Hookï¼šuseId"><a href="#äº”ã€æ–°å¢-Hookï¼šuseId" class="headerlink" title="äº”ã€æ–°å¢ Hookï¼šuseId"></a>äº”ã€æ–°å¢ Hookï¼šuseId</h2><p>React 18 æ–°å¢äº† <code>useId</code>ï¼Œç”¨äºåœ¨æœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰å’Œå®¢æˆ·ç«¯æ¸²æŸ“ï¼ˆCSRï¼‰ä¹‹é—´ç”Ÿæˆä¸€è‡´çš„å”¯ä¸€ IDï¼Œè§£å†³â€œhydration mismatchâ€çš„é—®é¢˜ã€‚</p><p>å®ä¾‹ï¼š</p><pre class="line-numbers language-js"><code class="language-js"><span class="token keyword">const</span> id <span class="token operator">=</span> <span class="token function">useId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="å…­ã€æ”¹è¿›çš„-SSRï¼ˆæœåŠ¡ç«¯æ¸²æŸ“ï¼‰"><a href="#å…­ã€æ”¹è¿›çš„-SSRï¼ˆæœåŠ¡ç«¯æ¸²æŸ“ï¼‰" class="headerlink" title="å…­ã€æ”¹è¿›çš„ SSRï¼ˆæœåŠ¡ç«¯æ¸²æŸ“ï¼‰"></a>å…­ã€æ”¹è¿›çš„ SSRï¼ˆæœåŠ¡ç«¯æ¸²æŸ“ï¼‰</h2><p>React 18 æ”¯æŒåŸºäºæµï¼ˆstreamingï¼‰çš„æœåŠ¡ç«¯æ¸²æŸ“ <code>renderToPipeableStream</code>ï¼Œå¯ä»¥åšåˆ° HTML æµå¼è¾“å‡ºï¼Œè¾¹ç”Ÿæˆè¾¹å‘é€ï¼Œæ˜¾è‘—æå‡ SSR é¦–å±åŠ è½½é€Ÿåº¦ã€‚</p><h2 id="ä¸ƒã€ReactDOM-createRoot-æ›¿ä»£-ReactDOM-render"><a href="#ä¸ƒã€ReactDOM-createRoot-æ›¿ä»£-ReactDOM-render" class="headerlink" title="ä¸ƒã€ReactDOM.createRoot æ›¿ä»£ ReactDOM.render"></a>ä¸ƒã€ReactDOM.createRoot æ›¿ä»£ ReactDOM.render</h2><p>React 18 ä¸­æ¨èä½¿ç”¨ <code>createRoot</code> ä»£æ›¿ <code>ReactDOM.render</code>ï¼Œä»¥å¯ç”¨å¹¶å‘ç‰¹æ€§ã€‚</p><p>ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> createRoot <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react-dom/client"</span><span class="token punctuation">;</span><span class="token keyword">const</span> root <span class="token operator">=</span> <span class="token function">createRoot</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>root<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="å…«ã€çŠ¶æ€åº“å…¼å®¹æ€§æ›´æ–°"><a href="#å…«ã€çŠ¶æ€åº“å…¼å®¹æ€§æ›´æ–°" class="headerlink" title="å…«ã€çŠ¶æ€åº“å…¼å®¹æ€§æ›´æ–°"></a>å…«ã€çŠ¶æ€åº“å…¼å®¹æ€§æ›´æ–°</h2><p>React 18 ä¸­æ–°å¢ <code>useSyncExternalStore</code> æ¥è§£å†³çŠ¶æ€åº“ï¼ˆå¦‚ Reduxã€MobXï¼‰è®¢é˜…å…¼å®¹é—®é¢˜ï¼Œä½¿å¾—å¤–éƒ¨çŠ¶æ€å˜åŒ–ä¹Ÿèƒ½è§¦å‘æ­£ç¡®çš„æ›´æ–°ã€‚</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> react18 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Github </tag>
            
            <tag> åšå®¢ </tag>
            
            <tag> react18 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>canvas</title>
      <link href="/2025/06/06/canvas/"/>
      <url>/2025/06/06/canvas/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€-æ¦‚è¿°"><a href="#ä¸€-æ¦‚è¿°" class="headerlink" title="ä¸€ æ¦‚è¿°"></a>ä¸€ æ¦‚è¿°</h1><p>canvas æ˜¯ html5 çš„ä¸€ä¸ªæ–°æ ‡ç­¾ï¼Œç›¸å½“äºä¸€ä¸ªç”»å¸ƒï¼Œå¯ä»¥ç”¨æ¥ç»˜åˆ¶ä¸°å¯Œçš„å›¾å½¢ï¼Œæœ€ç»ˆæ¸²æŸ“åœ¨æµè§ˆå™¨ä¸Šã€‚</p><p>ä½† canvas æ ‡ç­¾æœ¬èº«ä¸å…·å¤‡ç»˜åˆ¶å›¾å½¢çš„èƒ½åŠ›ï¼Œé…åˆ javascript æä¾›çš„ CanvasAPIï¼Œæ‰èƒ½ç»˜åˆ¶å›¾å½¢ï¼Œæ–‡æœ¬å’Œå›¾åƒï¼Œä»¥åŠå®ç°åŠ¨ç”»å’Œäº¤äº’</p><p>æ”¯æŒ 2d ç»˜å›¾ï¼Œä¹Ÿæ”¯æŒ 3d ç»˜å›¾ï¼ˆwebglï¼‰</p><p>canvas ç»˜åˆ¶çš„å›¾å½¢æ˜¯ä¸€ä¸ªä½å›¾</p><ul><li>æ”¾ç¼©ä¼šå¯¼è‡´å›¾åƒå¤±çœŸï¼Œæ‰€ä»¥éœ€è¦æ³¨æ„æ”¾ç¼©æ¯”ä¾‹çš„æ§åˆ¶</li><li>å¯ä»¥æ“ä½œæ¯ä¸€ä¸ªç‚¹ä½çš„åƒç´ ï¼Œè¿›è€Œå®ç°é«˜åº¦è‡ªå®šä¹‰çš„å›¾å½¢ç»˜åˆ¶å’ŒåŠ¨ç”»æ•ˆæœ</li><li>ç›¸å½“äº img å¼•å…¥çš„å›¾ç‰‡ï¼Œå¯ä»¥å³é”®å¦å­˜</li></ul><p>canvas ç»˜åˆ¶çš„å†…å®¹ä¸å±äº dom å…ƒç´ ï¼Œé€šå¸¸æ¯” dom å…ƒç´ ç»˜åˆ¶çš„æ–¹å¼æœ‰æ›´é«˜çš„æ¸²æŸ“èƒ½åŠ›</p><p>ä½†ä¹Ÿå­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚æ— æ³•åœ¨æµè§ˆå™¨æŸ¥çœ‹å™¨ä¸­æŸ¥æ‰¾ï¼Œä¹Ÿæ— æ³•æ”¯æŒé¼ æ ‡ç›‘å¬ï¼ˆä½†å¯ä»¥é€šè¿‡å…¶ä»–æ–¹å¼å®ç°ç±»ä¼¼çš„æ•ˆæœï¼‰</p><p>canvas åº”ç”¨é¢†åŸŸï¼š</p><ul><li>å¯è§†åŒ–å›¾è¡¨</li><li>h5 æ¸¸æˆåˆ¶ä½œ</li><li>banner å¹¿å‘Š</li></ul><h1 id="äºŒ-ç”»å¸ƒä¸ç”»ç¬”"><a href="#äºŒ-ç”»å¸ƒä¸ç”»ç¬”" class="headerlink" title="äºŒ ç”»å¸ƒä¸ç”»ç¬”"></a>äºŒ ç”»å¸ƒä¸ç”»ç¬”</h1><h2 id="1-åˆ›å»ºç”»å¸ƒå’Œç”»ç¬”"><a href="#1-åˆ›å»ºç”»å¸ƒå’Œç”»ç¬”" class="headerlink" title="1 åˆ›å»ºç”»å¸ƒå’Œç”»ç¬”"></a>1 åˆ›å»ºç”»å¸ƒå’Œç”»ç¬”</h2><p>æä¾›ä¸€ä¸ª<code>&lt;canvas&gt;</code>æ ‡ç­¾(html)</p><p>æœ‰ä¸€ä¸ª canvas å¯¹è±¡(js-ç”»å¸ƒ)</p><p>æœ‰ä¸€ä¸ª context å¯¹è±¡(js-ç”»ç¬”)</p><ul><li>CanvasRenderingContext2D</li></ul><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>c1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">  <span class="token keyword">const</span> convas1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"#c1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> context1 <span class="token operator">=</span> canvas1<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>æœ‰ 2 ç§æä¾› canvas æ ‡ç­¾çš„æ–¹å¼</p></blockquote><p>æ–¹å¼ä¸€ï¼šç›´æ¥å®šä¹‰ canvas æ ‡ç­¾</p><p>æ–¹å¼äºŒï¼šåˆ©ç”¨ js åˆ›å»º canvas æ ‡ç­¾ ï¼ˆæ¨èï¼Œvscode æœ‰æ›´å‹å¥½çš„æç¤ºï¼‰</p><ul><li>ä½¿ç”¨ js æ–¹å¼åˆ›å»º canvas æ—¶ï¼Œcanvas å¯¹è±¡ å’Œ context å¯¹è±¡éƒ½æ˜¯å…·ä½“çš„ç±»å‹(HTMLCavansElement , CanvasRenderingContext2D)ï¼Œvscode ç¼–ç å¼€å‘æ—¶ï¼Œ æç¤ºæ›´åŠ å‹å¥½ã€‚</li></ul><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/01.png" alt="1684995219436" style="zoom:50%;"><blockquote><p>canvas æ ‡ç­¾çš„ç‰ˆæœ¬æ£€æŸ¥</p></blockquote><p>ç»å¤§å¤šæ•°çš„æµè§ˆå™¨éƒ½æ”¯æŒ canvasã€‚ä½†å°‘æ•°è€ç‰ˆæœ¬çš„æµè§ˆå™¨æ”¯æŒä¸ä½³ï¼ˆIE9-ï¼‰</p><ul><li>ä½¿ç”¨æ–‡æœ¬/å›¾ç‰‡æ›¿æ¢ canvas : æµè§ˆå™¨ä¸æ”¯æŒ canvasï¼Œä¼šæ˜¾ç¤ºæ ‡ç­¾ä¸­çš„æ–‡æœ¬æˆ–å›¾ç‰‡å†…å®¹ã€‚</li><li>è„šæœ¬æ£€æµ‹ : æµè§ˆå™¨ä¸æ”¯æŒ canvasï¼Œåˆ™ canvas å¯¹è±¡æ²¡æœ‰ getContext å‡½æ•°</li></ul><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>c1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  æ‚¨çš„æµè§ˆå™¨ç‰ˆæœ¬è¿‡ä½ï¼Œä¸æ”¯æŒcanvasï¼Œè¯·å‡çº§æµè§ˆå™¨æˆ–æ›´æ¢æµè§ˆå™¨<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>canvas2<span class="token punctuation">.</span>getContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"æ‚¨çš„æµè§ˆå™¨ç‰ˆæœ¬è¿‡ä½ï¼Œä¸æ”¯æŒcanvasï¼Œè¯·å‡çº§æµè§ˆå™¨æˆ–æ›´æ¢æµè§ˆå™¨"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// codeing...</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="2-ç”»å¸ƒåŒºåŸŸç‰¹ç‚¹"><a href="#2-ç”»å¸ƒåŒºåŸŸç‰¹ç‚¹" class="headerlink" title="2 ç”»å¸ƒåŒºåŸŸç‰¹ç‚¹"></a>2 ç”»å¸ƒåŒºåŸŸç‰¹ç‚¹</h2><p>canvas æ˜¯ä¸€ä¸ªè¡Œå†…å…ƒç´  ã€‚</p><p>canvas å¯ä»¥ä½¿ç”¨ width å’Œ height è®¾ç½®åŒºåŸŸå®½é«˜ ï¼ˆé»˜è®¤å®½é«˜ï¼š300*150ï¼‰</p><p>canvas ä¹Ÿå¯ä»¥ä½¿ç”¨ style æ ·å¼è®¾ç½®å®½é«˜ã€‚ ä½†ä¸ width å’Œ height è®¾ç½®æ•ˆæœæœ‰æ‰€ä¸åŒã€‚</p><p><strong>åæ ‡ç³»</strong></p><p>æ¯ä¸€ä¸ªç”»å¸ƒä¸­éƒ½æœ‰ä¸€ä¸ªåæ ‡ç³»ç»Ÿï¼Œç”»å¸ƒçš„å·¦ä¸Šè§’ä¸ºé»˜è®¤çš„(0,0)åŸç‚¹</p><p><strong>ç”»å¸ƒåŒºåŸŸ</strong></p><p>ä½¿ç”¨ width å’Œ height å±æ€§æ§åˆ¶çš„åŒºåŸŸã€‚</p><p>è¿™ä¸ªåŒºåŸŸæœ‰å¤šå¤§ï¼Œ å…¶åŒ…å«çš„åæ ‡ç³»å°±æœ‰å¤šå¤§ã€‚</p><p><code>&lt;canvas id="c1" width="400" height="400"&gt;&lt;/canvas&gt;</code></p><p>è¡¨ç¤ºæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€ä¸ª 400*400 çš„åæ ‡ç³»</p><p><strong>æ”¾ç½®åŒºåŸŸ</strong></p><p>ä½¿ç”¨ style æ ·å¼æ§åˆ¶çš„åŒºåŸŸå¤§å°</p><p>ç”»å¸ƒåŒºåŸŸä¸­ç»˜åˆ¶çš„å›¾å½¢ï¼Œæœ€ç»ˆä¼šåœ¨æ”¾ç½®åŒºåŸŸä¸­å±•ç¤ºã€‚</p><p>é»˜è®¤ï¼Œæ”¾ç½®åŒºåŸŸä¸ç”»å¸ƒåŒºåŸŸç›¸åŒã€‚</p><p>æ”¾ç½®åŒºåŸŸå¦‚æœæ¯”ç”»å¸ƒåŒºåŸŸå¤§ or å°ã€‚ ç”»å¸ƒä¸­çš„å›¾å½¢å°±ä¼šæŒ‰æ¯”ä¾‹æ”¾å¤§æˆ–ç¼©å°ã€‚ ï¼ˆå›¾åƒå¯èƒ½å¤±çœŸï¼‰</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">  <span class="token selector">canvas </span><span class="token punctuation">{</span>    <span class="token property">border</span><span class="token punctuation">:</span> <span class="token number">1</span>px solid <span class="token hexcode">#ccc</span><span class="token punctuation">;</span>    <span class="token property">margin-left</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token selector"><span class="token id">#c2</span> </span><span class="token punctuation">{</span>    <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>    <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token selector"><span class="token id">#c3</span> </span><span class="token punctuation">{</span>    <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">600</span>px<span class="token punctuation">;</span>    <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">600</span>px<span class="token punctuation">;</span>  <span class="token punctuation">}</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>c1<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>c2<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>c3<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">  <span class="token punctuation">{</span>    <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"#c1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token punctuation">{</span>    <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"#c2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token punctuation">{</span>    <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"#c3"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/02.png" alt="1684997544061" style="zoom:50%;"><h1 id="ä¸‰-ç»˜åˆ¶å›¾å½¢"><a href="#ä¸‰-ç»˜åˆ¶å›¾å½¢" class="headerlink" title="ä¸‰ ç»˜åˆ¶å›¾å½¢"></a>ä¸‰ ç»˜åˆ¶å›¾å½¢</h1><h2 id="1-ç»˜åˆ¶çŸ©å½¢"><a href="#1-ç»˜åˆ¶çŸ©å½¢" class="headerlink" title="1 ç»˜åˆ¶çŸ©å½¢"></a>1 ç»˜åˆ¶çŸ©å½¢</h2><p>å¯ä»¥ç»˜åˆ¶ä¸¤ç§çŸ©å½¢ï¼Œ æœ‰ä¸‰ç§æ–¹å¼ã€‚</p><ul><li>å¡«å……çš„çŸ©å½¢(å®å¿ƒçŸ©å½¢)</li><li>æè¾¹çš„çŸ©å½¢(ç©ºå¿ƒçŸ©å½¢)</li></ul><blockquote><p>ctx.fillRect(x , y , width ,height)</p></blockquote><p>ç»˜åˆ¶å¡«å……çŸ©å½¢</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/03.png" alt="1684999450682" style="zoom:50%;"><blockquote><p>ctx.strokeRect(x , y , width , height)</p></blockquote><p>ç»˜åˆ¶æè¾¹çŸ©å½¢</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>ctx<span class="token punctuation">.</span><span class="token function">strokeRect</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/04.png" alt="1684999462723" style="zoom:50%;"><blockquote><p>ctx.rect(x , y , width , height)</p></blockquote><p>ç»˜åˆ¶çŸ©å½¢è·¯å¾„ï¼Œ é»˜è®¤æ²¡æœ‰æ•ˆæœã€‚</p><p>éœ€è¦é…åˆ ctx.stroke() , ctx.fill() æ¥æè¾¹æˆ–å¡«å……æ‰ä¼šæœ‰æ•ˆæœã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>ctx<span class="token punctuation">.</span><span class="token function">rect</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>ä½¿ç”¨ ctx.fillStyle å±æ€§è®¾ç½®å¡«å……çš„é¢œè‰² ï¼ˆred , #f00 , rgba(255,0,0,1ï¼‰</p><p>ä½¿ç”¨ ctx.strokeStyle å±æ€§è®¾ç½®æè¾¹é¢œè‰²</p><p>ä½¿ç”¨ ctx.lineWidth å±æ€§è®¾ç½®æè¾¹ç²—ç»†</p></blockquote><ul><li>æ³¨æ„ï¼šä¸€å®šè¦åœ¨ç»˜åˆ¶å›¾å½¢ä¹‹å‰è®¾ç½®ã€‚</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>ctx<span class="token punctuation">.</span><span class="token function">rect</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">"rgba(255,0,0,0.8)"</span><span class="token punctuation">;</span>ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">"#00f"</span><span class="token punctuation">;</span>ctx<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//ä»£ç è‡³æ­¤ï¼Œå·²ç»ç»˜ç”»å®Œæ¯•äº†</span><span class="token comment" spellcheck="true">//ctx.fillStyle = 'red' ; //æ— æ•ˆæœ</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/05.png" alt="1684999490858" style="zoom:50%;"><h2 id="2-beginPath-æ–¹æ³•"><a href="#2-beginPath-æ–¹æ³•" class="headerlink" title="2 beginPath æ–¹æ³•"></a>2 beginPath æ–¹æ³•</h2><p>stroke() æˆ– fill() é»˜è®¤ä¼šå¯¹ä¹‹å‰æ‰€æœ‰ç»˜åˆ¶çš„è·¯å¾„è¿›è¡Œä¸€ä¸ªå¤„ç†ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">rect</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">"#f00"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">"#0f0"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">rect</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/08.png" alt="1685002339809" style="zoom:50%;"><p>å½“æˆ‘ä»¬éœ€è¦åªå¯¹åˆšåˆšç»˜åˆ¶çš„å›¾å½¢é€”å¾„è¿›è¡Œå¤„ç†æ—¶</p><p>å°±å¯ä»¥ä½¿ç”¨ ctx.beginPath()æ–¹æ³•ï¼Œä¸ºä¸åŒéƒ¨åˆ†çš„é€”å¾„è®¾ç½®å¼€å…³(è®¾ç½®åˆ†ç»„)ã€‚</p><p>æ­¤æ—¶å°±åªå¯¹ç´§é‚»è¿™ç»„è·¯å¾„è¿›è¡Œç»˜åˆ¶ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">"#00f"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">rect</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">"#f00"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">"#0f0"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">rect</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/06.png" alt="1685001902271" style="zoom:50%;"><blockquote><p>ä¸€ç»„è·¯å¾„å¯ä»¥æœ‰å¤šä¸ªå›¾å½¢ï¼ˆçº¿ï¼Œå¼§ï¼Œæ›²çº¿ï¼ŒçŸ©å½¢ç­‰ï¼‰ã€‚</p></blockquote><blockquote><p>ä½¿ç”¨ fillRect() , strokeRect()ä¸ä¼šå—å½±å“ã€‚</p></blockquote><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">strokeRect</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">"#f00"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/07.png" alt="1685001937272" style="zoom:50%;"><h2 id="3-ç»˜åˆ¶åœ†è§’çŸ©å½¢"><a href="#3-ç»˜åˆ¶åœ†è§’çŸ©å½¢" class="headerlink" title="3 ç»˜åˆ¶åœ†è§’çŸ©å½¢"></a>3 ç»˜åˆ¶åœ†è§’çŸ©å½¢</h2><p>ä½¿ç”¨ ctx.roundRect(x , y , width , height , r)æ–¹æ³•ç»˜åˆ¶åœ†è§’çŸ©å½¢</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">roundRect</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/09.png" alt="1685004581662" style="zoom:50%;"><blockquote><p>r æœ‰å¤šç§å†™æ³•ï¼Œå¯ä»¥å®ç°å››ä¸ªåœ†è§’å•ç‹¬è®¾ç½®</p></blockquote><p>r : 10 | [10]</p><p>r : [10,20] <code>[top-left-and-bottom-right, top-right-and-bottom-left]</code></p><p>r : [10 ,20 ,30] <code>[top-left, top-right-and-bottom-left, bottom-right]</code></p><p>r : [10 , 20 ,30 ,40]</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">roundRect</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">roundRect</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">roundRect</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">roundRect</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/10.png" alt="1685004593217" style="zoom:50%;"><h2 id="4-ç»˜åˆ¶ç›´çº¿-amp-æŠ˜çº¿"><a href="#4-ç»˜åˆ¶ç›´çº¿-amp-æŠ˜çº¿" class="headerlink" title="4 ç»˜åˆ¶ç›´çº¿&amp;æŠ˜çº¿"></a>4 ç»˜åˆ¶ç›´çº¿&amp;æŠ˜çº¿</h2><p>ä¸¤å¤©ä¹‹é—´çš„è¿çº¿ï¼šç›´çº¿</p><p>å¤šä¸ªç›´çº¿è¿æ¥ : æŠ˜çº¿</p><p>ä½¿ç”¨ ctx.moveTo(x,y) å°†ç”»ç¬”æ”¾ç½®åˆ°æŒ‡å®šçš„åæ ‡ä½ç½® (èµ·å§‹ç‚¹)</p><p>ä½¿ç”¨ ctx.lineTo(x,y) ä»ä¸Šä¸€ä¸ªç‚¹ç»˜åˆ¶ç›´çº¿è·¯å¾„åˆ°æŒ‡å®šçš„ç‚¹ã€‚</p><ul><li>ä¸Šä¸€ä¸ªç‚¹å¯ä»¥æ˜¯ moveTo æŒ‡å®šçš„ç‚¹ã€‚</li><li>ä¸Šä¸€ä¸ªç‚¹ä¹Ÿå¯ä»¥æ˜¯ä¸Šä¸€æ¬¡ lineTo æŒ‡å®šçš„ç‚¹ã€‚ä¹Ÿå°±æ˜¯å¯ä»¥å¤šä¸ª lineTo è¿ç»­ä½¿ç”¨ï¼Œå½¢æˆæŠ˜çº¿ã€‚</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">"#00f"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/11.png" alt="1685066450244" style="zoom:50%;"><pre class="line-numbers language-java"><code class="language-java"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>    <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'canvas'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">400</span> <span class="token punctuation">;</span>    canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span> <span class="token punctuation">;</span>    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/12.png" alt="1685066461055" style="zoom:50%;"><h2 id="5-çº¿æ¡-API"><a href="#5-çº¿æ¡-API" class="headerlink" title="5 çº¿æ¡ API"></a>5 çº¿æ¡ API</h2><p><strong>ctx.lineWidth å±æ€§ï¼Œ è®¾ç½®çº¿æ¡ç²—ç»†ã€‚</strong></p><p><strong>ctx.lineCap å±æ€§ ï¼Œ è®¾ç½®çº¿æ¡ç«¯ç‚¹çš„æ ·å¼ ï¼ˆè¿æ¥ç‚¹ï¼Œ çº¿å¸½ï¼‰</strong></p><ul><li>butt å¹³çš„ ï¼ˆé»˜è®¤ï¼Œæ²¡æœ‰ä»»ä½•é¢å¤–çš„æ•ˆæœï¼‰</li><li>round åœ†çš„ ï¼ˆç«¯ç‚¹å¤„å¢åŠ äº†åŠåœ†ï¼Œè§†è§‰æ•ˆæœç›´çº¿å˜é•¿äº†ï¼‰</li><li>square å¹³çš„ ï¼ˆç«¯ç‚¹å¤„å¢åŠ äº†çŸ©å½¢ï¼Œè§†è§‰æ•ˆæœä¸Šç›´çº¿å˜é•¿äº†ï¼‰</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">"#00f"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>lineCap <span class="token operator">=</span> <span class="token string">"butt"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>lineCap <span class="token operator">=</span> <span class="token string">"round"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>lineCap <span class="token operator">=</span> <span class="token string">"square"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/13.png" alt="1685068655601" style="zoom:50%;"><p><strong>ctx.lineJoin å±æ€§ï¼Œ è®¾ç½®æŠ˜çº¿è¿æ¥å¤„çš„æ ·å¼</strong></p><ul><li>miter å°–çš„ ï¼ˆé»˜è®¤ï¼‰</li><li>round åœ†çš„</li><li>bevel å¹³çš„</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>lineJoin <span class="token operator">=</span> <span class="token string">"miter"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">"#00f"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>lineJoin <span class="token operator">=</span> <span class="token string">"round"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">"#00f"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>lineJoin <span class="token operator">=</span> <span class="token string">"bevel"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">"#00f"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/14.png" alt="1685068692898" style="zoom:50%;"><p><strong>ctx.miterLimit å±æ€§ï¼Œ é™åˆ¶æŠ˜çº¿å½¢æˆçš„å°–è§’é•¿çŸ­ã€‚</strong></p><ul><li>å½“çº¿æ¡æ¯”è¾ƒç²—ï¼Œ æŠ˜çº¿å¤¹è§’æ¯”è¾ƒå°çš„æ—¶å€™ï¼ŒlineJoin çš„ miter è®¾ç½®å½¢æˆçš„å°–ä¼šæ¯”è¾ƒé•¿</li><li>å¯ä»¥åˆ©ç”¨è¯¥å±æ€§æ¥æ§åˆ¶å°–è§’çš„é•¿çŸ­</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>lineJoin <span class="token operator">=</span> <span class="token string">"miter"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">"#00f"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>miterLimit <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>miterLimit <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">210</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/15.png" alt="1685070325781" style="zoom:50%;"><p><strong>ctx.setLineDash( array ) æ–¹æ³• ï¼Œè®¾ç½®è™šçº¿</strong></p><p>array ä¸­å¯ä»¥æ”¾ç½®å¤šä¸ªæ•°å€¼ã€‚ åˆ†åˆ«è¡¨ç¤ºçº¿æ®µçš„é•¿åº¦ å’Œ çº¿æ®µé—´ç•™ç™½çš„é•¿åº¦ã€‚</p><ul><li><p>array = [10] çº¿æ®µé•¿åº¦ å’Œ ç•™ç™½çš„é•¿åº¦éƒ½æ˜¯ 10</p></li><li><p>array = [20,10] çº¿æ®µçš„é•¿åº¦(20) å’Œ ç•™ç™½çš„é•¿åº¦(10)åˆ†åˆ«è®¾ç½®</p></li><li><p>array = [10,20,30] æŒ‰ç…§æ•°ç»„çš„æ•°åˆ—ï¼Œæ— é™çš„å»¶ç»­ä¸‹å»</p><p>çº¿æ®µ 10 ç•™ç™½ 20 çº¿æ®µ 30 ç•™ç™½ 10 çº¿æ®µ 20 ç•™ç™½ 30 çº¿æ®µ 10 ç•™ç™½ 20 â€¦.</p><p>[10,20,30,10,20,30,10,20,30,10,20,30,â€¦..]</p></li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">"#00f"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">setLineDash</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">setLineDash</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">setLineDash</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/16.png" alt="1685073265356" style="zoom:50%;"><p><strong>ctx.lineDashOffset å±æ€§ è®¾ç½®è™šçº¿èµ·å§‹ä½ç½®çš„åç§»</strong></p><ul><li>æ­£æ•°å€¼ï¼Œ å‘å·¦åç§»</li><li>è´Ÿæ•°å€¼ï¼Œå‘å³åç§»</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">190</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">"#00f"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">setLineDash</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">setLineDash</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>lineDashOffset <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">setLineDash</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">40</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>lineDashOffset <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/17.png" alt="1685073356644" style="zoom:50%;"><h2 id="6-æ¸…é™¤ç”»å¸ƒ"><a href="#6-æ¸…é™¤ç”»å¸ƒ" class="headerlink" title="6 æ¸…é™¤ç”»å¸ƒ"></a>6 æ¸…é™¤ç”»å¸ƒ</h2><p>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå½“ canvas é…åˆ js åŠ¨ç”»ï¼Œå®ç°åŠ¨ç”»æ•ˆæœæ—¶</p><p>é»˜è®¤æ¯ä¸€æ¬¡éƒ½æ˜¯åœ¨ä¹‹å‰çš„åŸºç¡€ä¸Šè¿›è¡Œç»˜åˆ¶</p><p>æ‰€ä»¥åº”è¯¥æ¸…é™¤ä¸Šä¸€æ¬¡çš„ç»˜ç”»æ•ˆæœï¼Œé‡æ–°ç»˜åˆ¶ã€‚</p><p>ä½¿ç”¨ ctx.clearRect( x , y , width ,height )æ–¹æ³•ï¼Œæ¸…é™¤ç”»å¸ƒä¸­çš„æŒ‡å®šçŸ©å½¢åŒºåŸŸ</p><ul><li>å¦‚æœ width å’Œ height ç­‰äºç”»å¸ƒå®½é«˜ï¼Œå°±ç›¸å½“äºæ¸…é™¤æ•´ä¸ªç”»å¸ƒï¼Œå¦åˆ™æ¸…é™¤ç”»å¸ƒçš„ä¸€éƒ¨åˆ†ã€‚</li></ul><blockquote><p>æ¸…é™¤ç”»å¸ƒçš„æœ¬è´¨å°±æ˜¯å°†æŒ‡å®šçš„çŸ©å½¢åŒºåŸŸï¼Œè®¾ç½®é€æ˜åº¦ä¸º 0ï¼Œä¹‹å‰çš„è·¯å¾„ä¾ç„¶å­˜åœ¨ã€‚</p><p>ç»˜åˆ¶æ–°è·¯å¾„æ—¶éœ€è¦é…åˆ beginPath()ï¼Œå¦åˆ™ stroke() æˆ– fill() æ—¶ä¹‹å‰çš„æ¸…é™¤æ•ˆæœé‡ç°ã€‚</p></blockquote><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>ç»˜åˆ¶æ¨ªçº¿</li><li>æ¸…é™¤ç”»å¸ƒ</li><li>ç»˜åˆ¶ç«–çº¿</li><li>å¦‚æœæ²¡æœ‰ beginPath()ï¼Œç»˜åˆ¶ç«–çº¿çš„æ—¶å€™ï¼Œä¹‹å‰çš„æ¨ªçº¿ä¹Ÿä¼šå‡ºç°ã€‚</li><li>å¦‚æœæœ‰ beginPath(),åªä¼šç»˜åˆ¶ç«–çº¿ï¼Œä¹‹å‰çš„æ¨ªçº¿ä¸ä¼šé‡æ–°ç»˜åˆ¶ã€‚å®ç°æ°¸ä¹…æ“¦é™¤æ•ˆæœã€‚</li></ul><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/18.png" alt="1685081951801" style="zoom:50%;"><h2 id="7-è™šçº¿å°åŠ¨ç”»"><a href="#7-è™šçº¿å°åŠ¨ç”»" class="headerlink" title="7 è™šçº¿å°åŠ¨ç”»"></a>7 è™šçº¿å°åŠ¨ç”»</h2><iframe src="images/01.html" height="250"> ## 8 closePathæ–¹æ³•<p>å¤šä¸ªè¿ç»­çº¿æ¡åˆå›´çš„åŒºåŸŸï¼Œæ˜¯å¯ä»¥ä½¿ç”¨ fill()è¿›è¡Œå¡«å……çš„ã€‚</p><p>å¦‚æœéœ€è¦é¦–å°¾èŠ‚ç‚¹è‡ªåŠ¨é—­åˆï¼Œå¯ä»¥ä½¿ç”¨ ctx.closePath()æ–¹æ³•</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">"#fac"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//ctx.lineTo(100,100); æ‰‹åŠ¨é—­åˆ</span>  ctx<span class="token punctuation">.</span><span class="token function">closePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/19.png" alt="1685083992942" style="zoom:50%;" /><h2 id="9-ç»˜åˆ¶åœ†å¼§"><a href="#9-ç»˜åˆ¶åœ†å¼§" class="headerlink" title="9 ç»˜åˆ¶åœ†å¼§"></a>9 ç»˜åˆ¶åœ†å¼§</h2><p><strong>arc( x , y , r , startAngle , endAngle , [dir])</strong></p><ul><li><p>x y åœ†ç‚¹åæ ‡</p></li><li><p>r åŠå¾„</p></li><li><p>startAngle èµ·å§‹ç»˜åˆ¶çš„è§’åº¦ã€‚ é»˜è®¤åœ†ç‚¹ x è½´å³ä¾§åŠå¾„ä½ç½®ä¸ºç»˜åˆ¶çš„èµ·å§‹ç‚¹(0 åº¦ç‚¹,3 ç‚¹é’Ÿæ–¹å‘)ã€‚</p><p>è§’åº¦æ–¹å‘æ˜¯é¡ºæ—¶é’ˆçš„ã€‚</p></li><li><p>endAngle ç»“æŸç‚¹çš„è§’åº¦</p></li><li><p>dir ç»˜åˆ¶æ–¹å‘ã€‚ false é¡ºæ—¶é’ˆ(é»˜è®¤) ï¼Œ true é€†æ—¶é’ˆæ–¹å‘ã€‚</p></li></ul><blockquote><p>è®¾è®¡åœ†å¼§æ—¶ï¼Œç”¨çš„æ˜¯è§’åº¦ã€‚ ä¼ é€’å‚æ•°æ—¶ï¼Œä¼ é€’çš„æ˜¯å¼§åº¦ã€‚</p><p>1(è§’åº¦) = Math.PI / 180 (å¼§åº¦)</p><p>360(è§’åº¦) = Math.PI * 2</p></blockquote><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span>PI <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span>PI<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span>PI <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span>PI<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/20.png" alt="1685085937052" style="zoom:50%;" /><p><strong>arcTo( x1 , y1 , x2 , y2 , r)</strong></p><p>æ˜¯ç”± 3 ä¸ªæ§åˆ¶ç‚¹å®ç°åœ†å¼§çš„ç»˜åˆ¶</p><ul><li><p>moveTo æˆ–ä¸Šä¸€æ¬¡å›¾å½¢ç»“æŸçš„ç‚¹ï¼Œ ä¸ºç¬¬ä¸€ä¸ªç‚¹ã€‚</p></li><li><p>x1 , y1 ç¬¬äºŒä¸ªç‚¹</p></li><li><p>x2 , y2 ç¬¬ä¸‰ä¸ªç‚¹</p></li><li><p>æŒ‰ç…§ 1 ï¼Œ 2 ï¼Œ 3 é¡ºåº è¿›è¡Œè¿çº¿ ã€‚ ä¸¤æ¡çº¿ä¼šå½¢æˆä¸€ä¸ªå¤¹è§’ã€‚</p></li><li><p>æ ¹æ® r ç»˜åˆ¶åœ†å¼§ï¼Œä¿è¯ä¸ä¸¤ä¸ªçº¿æ¡ç›¸åˆ‡ã€‚</p></li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span>PI <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">"#00f"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">arcTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/21.png" alt="1685087269681" style="zoom:50%;" /><h2 id="10-ç»˜åˆ¶æ¤­åœ†"><a href="#10-ç»˜åˆ¶æ¤­åœ†" class="headerlink" title="10 ç»˜åˆ¶æ¤­åœ†"></a>10 ç»˜åˆ¶æ¤­åœ†</h2><p>ä½¿ç”¨ ctx.ellipse( x , y , rx , ry , rotate , startAngle , endAngle , dir )æ–¹æ³•ç»˜åˆ¶æ¤­åœ†</p><ul><li>x y åœ†ç‚¹åæ ‡</li><li>rx , ry x è½´åŠå¾„ å’Œ y è½´åŠå¾„</li><li>rotate x è½´æ—‹è½¬è§’åº¦(é¡ºæ—¶é’ˆæ–¹å‘)</li><li>startAngle èµ·å§‹ç‚¹è§’åº¦ é»˜è®¤ 0 åº¦ ï¼Œ ä¸‰ç‚¹é’Ÿæ–¹å‘</li><li>endAngle ç»ˆç‚¹è§’åº¦</li><li>dir ç»˜åˆ¶æ–¹å‘ã€‚ false é¡ºæ—¶é’ˆï¼Œ true é€†æ—¶é’ˆ</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">"#00f"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">ellipse</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span>PI <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">ellipse</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span>PI <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">ellipse</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span>PI <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span>PI <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/22.png" alt="1685087968136" style="zoom:50%;" /><h2 id="11-ç»˜åˆ¶æ›²çº¿"><a href="#11-ç»˜åˆ¶æ›²çº¿" class="headerlink" title="11 ç»˜åˆ¶æ›²çº¿"></a>11 ç»˜åˆ¶æ›²çº¿</h2><p>canvas æä¾›äº†ä¸€ç§ç»˜åˆ¶æ›²çº¿çš„æ–¹å¼ï¼šè´å¡å°”æ›²çº¿ã€‚</p><p>äºŒæ¬¡è´å¡å°”æ›²çº¿ å’Œ ä¸‰æ¬¡è´å¡å°”æ›²çº¿ã€‚</p><ul><li><p>æœ‰ä¸€ä¸ªèµ·ç‚¹å’Œç»ˆç‚¹</p></li><li><p>åœ¨ä¸¤ç‚¹ä¸­é—´ï¼Œæœ‰å¤šä¸ªæ§åˆ¶ç‚¹ã€‚</p><ul><li>æœ‰ä¸€ä¸ªæ§åˆ¶ç‚¹ï¼Œç§°ä¸ºäºŒæ¬¡è´å¡å°”æ›²çº¿</li><li>æœ‰ä¸¤ä¸ªæ§åˆ¶ç‚¹ï¼Œç§°ä¸ºä¸‰æ¬¡è´å¡å°”æ›²çº¿</li></ul></li><li><p>ä»èµ·ç‚¹ï¼Œç»è¿‡æ§åˆ¶ç‚¹ï¼Œåˆ°ç»ˆç‚¹ ä¾æ¬¡è¿çº¿</p></li><li><p>æä¾›ä¸€ä¸ªå‚æ•° t åœ¨[0-1]èŒƒå›´å†…å˜åŒ–</p></li><li><p>æ¯ä¸€ä¸ª t éƒ½å­˜åœ¨ä¸€ä¸‹æƒ…å†µï¼š</p><ul><li>åœ¨ä»»æ„çº¿æ®µä¸­ï¼Œä»èµ·ç‚¹åˆ°ç»ˆç‚¹ï¼Œå­˜åœ¨ä¸€ä¸ªä¸­é—´ç‚¹ï¼Œä½¿å¾—å‰éƒ¨åˆ†çº¿æ®µ/æ•´æ¡çº¿æ®µ = t</li><li>å¯¹æ¯æ¡çº¿æ®µçš„è¿™äº›ç‚¹ï¼Œå†ä¸€æ¬¡è¿æ¥ï¼Œå½¢æˆäº†ä¸€æ‰¹æ–°çš„çº¿æ®µ(æ¯”ä¹‹å‰ä¸€æ‰¹å°‘ä¸€æ¡)ã€‚</li><li>åœ¨æ–°çš„ä¸€æ‰¹çº¿æ®µä¸­ï¼Œä¾ç„¶å­˜åœ¨ç¬¦åˆæ¯”ä¾‹ t çš„é‚£ä¸ªç‚¹</li><li>é‡å¤ä¹‹å‰è¿çº¿ï¼Œæ‰¾ç‚¹çš„æ“ä½œã€‚</li><li>ç›´åˆ°æ‰¾åˆ°æœ€åä¸€ä¸ªç‚¹ã€‚å°±æ˜¯æ­¤è´å¡å°”æ›²çº¿ï¼Œåœ¨å½“å‰æ¯”ä¾‹ t æ—¶ï¼Œæ›²çº¿çš„ç‚¹ã€‚</li></ul></li><li><p>å½“ t åœ¨ 0-1 èŒƒå›´å˜åŒ–æ—¶ï¼Œæ¯æ¬¡éƒ½ä¼šæœ‰ä¸€ä¸ªè¿™æ ·çš„ç‚¹ï¼Œè¿™äº›çº¿ç‚¹è¿æ¥åå°±å½¢æˆäº†è´å¡å°”æ›²çº¿ã€‚</p></li></ul><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/23.png" alt="1685089893213" style="zoom:50%;" /><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/24.gif" alt="2"> <img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/25.gif" alt="3"></p><p><strong>ä½¿ç”¨ ctx.quadraticCurveTo( cx1 , cy1 , ex , ey)æ–¹æ³•ç»˜åˆ¶äºŒæ¬¡è´å¡å°”æ›²çº¿</strong></p><ul><li>cx1 , cy1 æ§åˆ¶ç‚¹åæ ‡</li><li>ex , ey ç»ˆç‚¹åæ ‡</li><li>èµ·ç‚¹çš„åæ ‡æ˜¯ moveTo è®¾ç½®ï¼Œæˆ–è€…æ˜¯ä¸Šä¸€æ¬¡ç»˜å›¾çš„ç»“å°¾ã€‚</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">"#f00"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span>PI <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span>PI <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span>PI <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">quadraticCurveTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>ç§»åŠ¨æ§åˆ¶ç‚¹ï¼Œå¯ä»¥æ”¹å˜æ›²çº¿çš„å½¢çŠ¶</p></blockquote><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/26.png" alt="1685090942767" style="zoom:50%;" /><p><strong>ä½¿ç”¨ bezierCurveTo(cx1,cy1 , cx2 , cy2 , ex , ey)æ–¹æ³•ç»˜åˆ¶ä¸‰æ¬¡è´å¡å°”æ›²çº¿</strong></p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">"#f00"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span>PI <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span>PI <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span>PI <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span>PI <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">bezierCurveTo</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">,</span> <span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/27.png" alt="1685090974292" style="zoom:50%;" /><h2 id="12-ç»˜åˆ¶æ–‡æœ¬"><a href="#12-ç»˜åˆ¶æ–‡æœ¬" class="headerlink" title="12 ç»˜åˆ¶æ–‡æœ¬"></a>12 ç»˜åˆ¶æ–‡æœ¬</h2><p>ä½¿ç”¨ ctx.fillText( textStr , x , y [, maxWidth] ) æ–¹æ³•ï¼Œ ç»˜åˆ¶å¡«å……æ–‡æœ¬</p><p>ä½¿ç”¨ ctx.strokeText() æ–¹æ³•ï¼Œ ç»˜åˆ¶æè¾¹æ–‡æœ¬ï¼ˆé•‚ç©ºï¼‰</p><ul><li>textStr æ–‡æœ¬å†…å®¹</li><li>x , y æ–‡æœ¬ä½ç½®(åæ ‡)</li><li>maxWidth (å¯é€‰) è®¾ç½®æ–‡æœ¬æœ€å¤§å®½åº¦ã€‚ å¦‚æœæ–‡æœ¬å®½åº¦ &gt; æœ€å¤§å®½åº¦ å°±ä¼šæ”¾ç¼©ï¼Œ å‹ç¼©åœ¨ maxWidth èŒƒå›´å†…</li></ul><p>ä½¿ç”¨ ctx.font å±æ€§ ï¼Œè®¾ç½®æ–‡æœ¬æ ·å¼ ï¼ˆç²—ä½“ ï¼Œ æ–œä½“ï¼Œ å¤§å°ï¼Œ å­—ä½“ï¼‰</p><blockquote><p>å¿…é¡»è®¾ç½®å­—ä½“ ï¼Œ å¦åˆ™å…¶ä»–æ ·å¼æ— æ•ˆã€‚</p></blockquote><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token string">" bold italic 40px sans-serif"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">fillText</span><span class="token punctuation">(</span><span class="token string">"DMC"</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token string">" bold italic 80px sans-serif"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">strokeText</span><span class="token punctuation">(</span><span class="token string">"DMC"</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/28.png" alt="1685330893994" style="zoom:50%;" /><p>ä½¿ç”¨ ctx.textAlign å±æ€§ï¼Œ è®¾ç½®åŸºäºé”šç‚¹æ°´å¹³ä½ç½® ï¼ˆleftï¼Œ centerï¼Œ rightï¼‰</p><p>ä½¿ç”¨ ctx.textBaseline å±æ€§ ï¼Œ è®¾ç½®åŸºäºé”šç‚¹çš„å‚ç›´ä½ç½® ï¼ˆbottom ï¼Œmiddle ï¼Œ topï¼‰</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>textAlign <span class="token operator">=</span> <span class="token string">"center"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token string">"80px sans-serif"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>textBaseline <span class="token operator">=</span> <span class="token string">"middle"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">strokeText</span><span class="token punctuation">(</span><span class="token string">"DMC"</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> obj <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">measureText</span><span class="token punctuation">(</span><span class="token string">"DMC"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">"#f00"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span>PI <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/29.png" alt="1685330959934" style="zoom:50%;" /><h1 id="å››-ä½¿ç”¨å›¾åƒ"><a href="#å››-ä½¿ç”¨å›¾åƒ" class="headerlink" title="å›› ä½¿ç”¨å›¾åƒ"></a>å›› ä½¿ç”¨å›¾åƒ</h1><p>åœ¨ canvas ä¸­å¼•å…¥å…¶ä»–çš„å›¾ç‰‡ã€‚</p><h2 id="1-åŸºæœ¬ä½¿ç”¨"><a href="#1-åŸºæœ¬ä½¿ç”¨" class="headerlink" title="1 åŸºæœ¬ä½¿ç”¨"></a>1 åŸºæœ¬ä½¿ç”¨</h2><p>éœ€è¦æœ‰ä¸€ä¸ªå›¾ç‰‡æº</p><ul><li>Image å¯¹è±¡ å¯¹åº” img æ ‡ç­¾ã€‚<ul><li>å¯ä»¥æ˜¯å›¾ç‰‡çš„è·¯å¾„</li><li>å›¾ç‰‡çš„ base64 è¡¨ç¤º</li></ul></li><li>video å¯¹è±¡</li><li>canvas</li></ul><p>ä½¿ç”¨ ctx.drawImage() æ–¹æ³• ï¼Œå¼•å…¥å›¾ç‰‡ã€‚</p><ul><li><p><code>ctx.drawImage(imgSource , x , y)</code></p><p>x , y åœ¨ canvas ç”»å¸ƒä¸­æ”¾ç½®çš„èµ·å§‹åæ ‡ä½ç½®ã€‚</p><p>ä¼šæŒ‰ç…§å›¾åƒåŸå¤§å°å±•ç¤ºã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript">ctx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ul><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/30.png" alt="1685430824898" style="zoom:50%;" /><ul><li><p><code>ctx.drawImage(imgSource , x , y , width , height)</code></p><p>width å’Œ height å›¾åƒå±•ç¤ºçš„å¤§å° ï¼ˆç¼©æ”¾å¤„ç†ï¼‰</p><pre class="line-numbers language-javascript"><code class="language-javascript">ctx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ul><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/31.png" alt="1685430845953" style="zoom:50%;" /><ul><li><p><code>ctx.drawImage(imgSource,x1 , y1 , w1 , h1 , x2 , y2 , w2 , h2)</code></p><p>x1 y1 w1 h1 åŒºåŸŸæ˜¯å›¾åƒçš„æˆªå›¾åŒºåŸŸã€‚ æ­¤æ—¶åŸºäºå›¾åƒçš„åæ ‡ç³»</p><p>x2 y2 w2 h2 åŒºåŸŸæ˜¯ç”»å¸ƒå±•ç¤ºåŒºåŸŸ</p><pre class="line-numbers language-javascript"><code class="language-javascript">ctx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>  img<span class="token punctuation">,</span>  <span class="token number">44</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">200</span><span class="token punctuation">,</span>  img<span class="token punctuation">.</span>height<span class="token punctuation">,</span>  <span class="token number">100</span><span class="token punctuation">,</span>  <span class="token punctuation">(</span><span class="token number">400</span> <span class="token operator">-</span> img<span class="token punctuation">.</span>height<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span>  <span class="token number">200</span><span class="token punctuation">,</span>  img<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/32.png" alt="1685430915240" style="zoom:50%;" /></li></ul><blockquote><p>ä½¿ç”¨å›¾ç‰‡æºæ—¶ï¼Œè¦ç¡®ä¿å›¾ç‰‡åŠ è½½å®Œæˆï¼Œ å»ºè®®åœ¨ img.onload äº‹ä»¶ä¸­ä½¿ç”¨å›¾ç‰‡æº</p></blockquote><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>img<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">"../imgs/01.png"</span><span class="token punctuation">;</span>img<span class="token punctuation">.</span>onload <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="2-å›¾åƒä¸åŠ¨ç”»"><a href="#2-å›¾åƒä¸åŠ¨ç”»" class="headerlink" title="2 å›¾åƒä¸åŠ¨ç”»"></a>2 å›¾åƒä¸åŠ¨ç”»</h2><iframe src="images/02.html" height="250" />## 3 è§†é¢‘å›¾åƒ<p>åœ¨è§†é¢‘æ’­æ”¾ä¸­ï¼Œ æŠ“å–å½“å‰å¸§ä½œä¸ºå›¾åƒï¼Œå¼•å…¥ canvasã€‚</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>video</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>../imgs/01.mp4<span class="token punctuation">"</span></span> <span class="token attr-name">controls</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">muted</span> <span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>video</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span>    (() => <span class="token entity" title="&#123;">&amp;#123;</span>        const canvas = document.createElement("canvas");        canvas.width = 400;        canvas.height = 400;        document.body.append(canvas);        const ctx = canvas.getContext('2d');        const video = document.querySelector('video');        video.addEventListener('play',function()<span class="token entity" title="&#123;">&amp;#123;</span>            draw();        <span class="token entity" title="&#125;">&amp;#125;</span>)        ctx.arc(200,200,150,0,Math.PI*2);        //ctx.filter = "blur(5px)";        //ctx.filter = 'invert(0.8)';        //ctx.clip();        function draw()<span class="token entity" title="&#123;">&amp;#123;</span>            ctx.clearRect(0,0,400,400);            ctx.drawImage(video,0,0,400,400);            requestAnimationFrame(draw);        <span class="token entity" title="&#125;">&amp;#125;</span>    <span class="token entity" title="&#125;">&amp;#125;</span>)();<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/33.png" alt="1685437746459" style="zoom:50%;" /><h2 id="4-å¼•å…¥-Canvas-å›¾åƒ"><a href="#4-å¼•å…¥-Canvas-å›¾åƒ" class="headerlink" title="4 å¼•å…¥ Canvas å›¾åƒ"></a>4 å¼•å…¥ Canvas å›¾åƒ</h2><p>canvas æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªå›¾åƒï¼Œ ä¹Ÿå¯ä»¥ä½œä¸ºå›¾åƒæºï¼Œå¼•å…¥å¦ä¸€ä¸ª canvas ç”»å¸ƒã€‚</p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/34.png" alt="1685501783198" style="zoom:50%;" /><p>canvas ç”»å¸ƒå¯ä»¥ä¸‹è½½</p><ul><li>å³é”®å¦å­˜</li><li>ç¼–ç¨‹å¼ä¸‹è½½</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"button"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  btn<span class="token punctuation">.</span>onclick <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> url <span class="token operator">=</span> canvas1<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> a <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    a<span class="token punctuation">.</span>href <span class="token operator">=</span> url<span class="token punctuation">;</span>    a<span class="token punctuation">.</span>download <span class="token operator">=</span> <span class="token string">"canvasç”»å¸ƒ"</span><span class="token punctuation">;</span>    a<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>toDataURL()é»˜è®¤ç”Ÿæˆ png æ ¼å¼ï¼Œ å¯ä»¥é€šè¿‡ä¼ å‚æŒ‡å®šå›¾ç‰‡æ ¼å¼</p><p><code>toDataURL(&#39;image/jpeg&#39;)</code></p></blockquote><blockquote><p>å¦‚æœ canvas ä¸­çš„å›¾åƒæ¥è‡ªäºå…¶ä»–è·¯å¾„çš„å›¾åƒæºï¼ˆimg ï¼Œ videoï¼‰ï¼Œå¯èƒ½å­˜åœ¨åŒæºé—®é¢˜ ï¼Œ ç”»å¸ƒè¢«æ±¡æŸ“ã€‚</p><p>è®¾ç½®åŒæºç­–ç•¥ <code>img.crossOrigin = &#39;anonymous&#39;;</code></p><p>æœåŠ¡å™¨å¯åŠ¨</p></blockquote><h2 id="5-å›¾åƒåƒç´ å¤„ç†"><a href="#5-å›¾åƒåƒç´ å¤„ç†" class="headerlink" title="5 å›¾åƒåƒç´ å¤„ç†"></a>5 å›¾åƒåƒç´ å¤„ç†</h2><p>ImageData å¯¹è±¡ã€‚ åŒ…å«äº†æŸä¸€ä¸ªåŒºåŸŸå†…çš„åƒç´ å€¼</p><ul><li><p>imageData.width</p></li><li><p>imageData.height</p></li><li><p>imageData.data array åŒ…å«åŒºåŸŸå†…æ‰€æœ‰çš„åƒç´ å€¼ (rgba å€¼)</p><p>array æ˜¯ä¸€ä¸ªä¸€ç»´æ•°ç»„ï¼Œ æ¯ 4 ä¸ªä½ç½®è¡¨ç¤ºä¸€ä¸ªåƒç´ å€¼</p><p>(x,y)åƒç´ çš„å€¼ä¸º</p><pre class="line-numbers language-text"><code class="language-text">(imageData.width * 4) * y + x * 4 + 0/1/2/3<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/35.png" alt="1685513596358" style="zoom:50%;" /></li></ul><p>ä½¿ç”¨ ctx.getImageData(x , y , width , height) è·å¾—ç”»å¸ƒä¸­æŒ‡å®šåŒºåŸŸçš„ ImageData å¯¹è±¡ ï¼ˆåƒç´ å€¼ï¼‰</p><ul><li>è·å¾— ImageData å¯¹è±¡åï¼Œå°±å¯ä»¥é€šè¿‡å…¶è·å¾—æ¯ä¸€ä¸ªåƒç´ çš„å€¼ï¼Œä¹Ÿå¯ä»¥è®¾ç½®æ¯ä¸€ä¸ªåƒç´ çš„å€¼</li><li>è®¾ç½®ä¹‹åä¸ä¼šé»˜è®¤ç”Ÿæ•ˆï¼Œè¿˜éœ€è¦é‡æ–°è®¾ç½®ç”»å¸ƒçš„ ImageData</li></ul><p>ä½¿ç”¨ ctx.putImageData(imageData,x,y) é‡æ–°è®¾ç½®ç”»å¸ƒæŒ‡å®šåŒºåŸŸçš„åƒç´ å€¼ï¼ˆç°åº¦è®¾ç½®ï¼Œåè‰²è®¾ç½®ç­‰ï¼‰</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  img<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">"../imgs/01.png"</span><span class="token punctuation">;</span>  img<span class="token punctuation">.</span>onload <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    ctx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> imageData <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">getImageData</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> imageData<span class="token punctuation">.</span>data<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>      <span class="token keyword">const</span> r <span class="token operator">=</span> imageData<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>      <span class="token keyword">const</span> g <span class="token operator">=</span> imageData<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>      <span class="token keyword">const</span> b <span class="token operator">=</span> imageData<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>      <span class="token keyword">const</span> a <span class="token operator">=</span> imageData<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>      <span class="token keyword">const</span> avg <span class="token operator">=</span> <span class="token punctuation">(</span>r <span class="token operator">+</span> g <span class="token operator">+</span> b<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">;</span>      imageData<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> avg<span class="token punctuation">;</span>      imageData<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> avg<span class="token punctuation">;</span>      imageData<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> avg<span class="token punctuation">;</span>    <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>    ctx<span class="token punctuation">.</span><span class="token function">putImageData</span><span class="token punctuation">(</span>imageData<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/36.png" alt="1685513684366" style="zoom:100%;" /><blockquote><p>ä½¿ç”¨å¤–éƒ¨å›¾åƒæ²¡æœ‰é—®é¢˜ï¼Œä½†è¦é€šè¿‡ ImageData å¯¹å…¶è¿›ä¸€æ­¥å¤„ç†æ—¶ï¼Œä¼šå­˜åœ¨è·¨åŸŸé—®é¢˜</p><p>ä½¿ç”¨æœåŠ¡å™¨æ¨¡å¼å¯åŠ¨å³å¯ã€‚</p><p>å¦‚æœè¿˜æ˜¯æ— æ•ˆï¼Œå¯ä»¥è®¾ç½® img.cross-origin=â€anonymousâ€</p></blockquote><h2 id="6-å›¾åƒå¡«å……"><a href="#6-å›¾åƒå¡«å……" class="headerlink" title="6 å›¾åƒå¡«å……"></a>6 å›¾åƒå¡«å……</h2><p>å¯ä»¥å°†å¼•å…¥å›¾åƒä½œä¸ºå¡«å……èƒŒæ™¯ ï¼Œ ä¹Ÿå¯ä»¥æ˜¯æè¾¹èƒŒæ™¯ã€‚</p><p>å›¾åƒæºå¯ä»¥æœ‰å¤šç§ ï¼š img , canvas , video , . . .</p><p>ä½¿ç”¨ ctx.createPattern(imgSource , repetition) æ–¹æ³•ï¼Œåˆ›å»ºä¸€ä¸ªå›¾æ¡ˆå¯¹è±¡ã€‚ï¼ˆCanvasPatternï¼‰</p><ul><li>imgSource å›¾åƒæº</li><li>repetition é‡å¤æœºåˆ¶ repeat, repeat-x , repeat-y ,no-repeat</li></ul><p>è®¾ç½® ctx.fillStyle = pattern æˆ– ctx.strokeStyle = pattern</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">let</span> bgCanvas<span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  bgCanvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  bgCanvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>  bgCanvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>bgCanvas<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> ctx <span class="token operator">=</span> bgCanvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//ç»˜åˆ¶ä¸€ä¸ªè±å½¢</span>  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">closePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  img<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">"../imgs/03.png"</span><span class="token punctuation">;</span>  img<span class="token punctuation">.</span>onload <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> pattern <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">createPattern</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token string">"repeat"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> pattern2 <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">createPattern</span><span class="token punctuation">(</span>bgCanvas<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    ctx<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>    ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> pattern2<span class="token punctuation">;</span>    ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> pattern<span class="token punctuation">;</span>    ctx<span class="token punctuation">.</span><span class="token function">rect</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">330</span><span class="token punctuation">,</span> <span class="token number">330</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/37.png" alt="1685520321897" style="zoom:50%;" /><blockquote><p>å›¾æ¡ˆå¹³é“ºçš„æ ·å¼ï¼Œéƒ½æ˜¯åŸºäºç”»å¸ƒåæ ‡ç³»çš„åŸç‚¹å¼€å§‹è®¡ç®—çš„ã€‚</p><p>æ‰€ä»¥åœ¨æ¨ªå‘å¹³é“ºï¼Œçºµå‘å¹³é“ºå’Œä¸å¹³é“ºçš„æƒ…å†µä¸‹ï¼Œæœ‰å¯èƒ½ç”»å¸ƒä¸­å¤®çš„å›¾å½¢æ— æ³•æ˜¾ç¤ºæ•ˆæœã€‚</p></blockquote><h1 id="äº”-å›¾åƒè£å‰ª"><a href="#äº”-å›¾åƒè£å‰ª" class="headerlink" title="äº” å›¾åƒè£å‰ª"></a>äº” å›¾åƒè£å‰ª</h1><p>ä½¿ç”¨ ctx.clip() æ–¹æ³• è®¾ç½®è£å‰ªè·¯å¾„ï¼Œ æ¥ä¸‹æ¥ç»˜åˆ¶çš„å›¾å½¢åªä¼šåœ¨è£å‰ªè·¯å¾„ä¸­å±•ç¤ºã€‚ï¼ˆå¯¹ä¹‹å‰ç»˜åˆ¶çš„å›¾å½¢æ²¡æœ‰å½±å“ï¼‰</p><blockquote><p>clip æ–¹æ³•åªè¡¨ç¤ºè£å‰ªï¼ŒæŒ‰ç…§ä»€ä¹ˆè·¯å¾„è£å‰ªå‘¢ï¼Ÿ æŒ‰ç…§ clip()ä¸Šé¢ç»˜åˆ¶çš„è·¯å¾„</p></blockquote><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  img<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">"../imgs/04.png"</span><span class="token punctuation">;</span>  img<span class="token punctuation">.</span>onload <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//è®¾ç½®è£å‰ªè·¯å¾„</span>    ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span>PI <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    ctx<span class="token punctuation">.</span><span class="token function">clip</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//è£å‰ªçš„å›¾å½¢</span>    ctx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>img<span class="token punctuation">,</span> <span class="token number">200</span> <span class="token operator">-</span> img<span class="token punctuation">.</span>width <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">200</span> <span class="token operator">-</span> img<span class="token punctuation">.</span>height <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/38.png" alt="1685588341702" style="zoom:50%;" /><blockquote><p>clip æ–¹æ³•è¿˜å¯ä»¥ä¼ é€’ä¸€ä¸ªå‚æ•° (rule)</p><ul><li>nonzero : é»˜è®¤å€¼ éé›¶ç¯ç»•è·¯å¾„</li><li>evenoddï¼šå¥‡å¶ç¯ç»•è·¯å¾„</li></ul></blockquote><p>åœ¨ç»˜åˆ¶è£å‰ªè·¯å¾„çš„æ—¶å€™ï¼Œæœ‰äº›è·¯å¾„åŒºåŸŸå¯èƒ½ä¼šè¢«é‡å¤åŒ…å«ã€‚</p><p><strong>éé›¶ç¯ç»•ï¼š</strong> é¡ºæ—¶é’ˆç»˜åˆ¶ç»è¿‡è·¯å¾„åŒºåŸŸï¼Œæ•°é‡+1 ï¼Œ é€†æ—¶é’ˆç»˜åˆ¶ç»è¿‡è·¯å¾„ï¼Œæ•°é‡-1.</p><p>â€‹ è·¯å¾„åŒºåŸŸæœ€ç»ˆç»è¿‡çš„æ•°é‡ä¸º 0ï¼Œå°±ä¸è£å‰ª(ä¸å¯è§ï¼‰</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">strokeRect</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span>PI <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//é¡ºæ—¶é’ˆ</span>  ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span>PI <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//é€†æ—¶é’ˆ</span>  ctx<span class="token punctuation">.</span><span class="token function">clip</span><span class="token punctuation">(</span><span class="token string">"nonzero"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/39.png" alt="1685588644661" style="zoom:50%;" /><p><strong>å¥‡å¶ç¯ç»•ï¼š</strong>ä¸åˆ†é¡ºæ—¶é’ˆå’Œé€†æ—¶é’ˆï¼Œåªè¦ç»˜åˆ¶è·¯å¾„ç»è¿‡åŒºåŸŸï¼Œæ•°é‡+1ï¼Œ æœ€ç»ˆå¥‡æ•°è£å‰ª(å¯è§)ï¼Œå¶æ•°ä¸è£å‰ª(ä¸å¯è§)ã€‚</p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/40.png" alt="1685588781520" style="zoom:50%;" /><h1 id="å…­-å›¾åƒåˆæˆ"><a href="#å…­-å›¾åƒåˆæˆ" class="headerlink" title="å…­ å›¾åƒåˆæˆ"></a>å…­ å›¾åƒåˆæˆ</h1><p>å°†å‰åå›¾å½¢åˆæˆä¸€ä¸ªå›¾å½¢</p><p>ä½¿ç”¨ ctx.globalCompositeOperation å±æ€§ è®¾ç½®åˆæˆæœºåˆ¶ã€‚</p><p>éœ€è¦åœ¨å‰åä¸¤ä¸ªå›¾å½¢ä¸­é—´è®¾ç½®ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//å‰(åŸ)å›¾å½¢</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">"#f00"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>globalCompositeOperation <span class="token operator">=</span> <span class="token string">"???"</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//å(æ–°)å›¾å½¢</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">"#0f0"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="1-è·¯å¾„-å½¢çŠ¶-åˆæˆ"><a href="#1-è·¯å¾„-å½¢çŠ¶-åˆæˆ" class="headerlink" title="1 è·¯å¾„(å½¢çŠ¶)åˆæˆ"></a>1 è·¯å¾„(å½¢çŠ¶)åˆæˆ</h2><p>source-over : ï¼ˆé»˜è®¤ï¼‰å‰åå›¾å½¢éƒ½å±•ç¤ºï¼Œ é‡å éƒ¨åˆ†å±•ç¤ºåé¢çš„å›¾å½¢ã€‚</p><p>source-in : åªå±•ç¤ºåé¢çš„å›¾å½¢ï¼Œå±•ç¤ºä¸å‰é¢å›¾å½¢é‡å çš„éƒ¨åˆ†ã€‚</p><p>source-outï¼šåªå±•ç¤ºåé¢çš„å›¾å½¢ï¼Œ å±•ç¤ºä¸å‰é¢å›¾å½¢ä¸é‡å çš„éƒ¨åˆ†</p><p>source-atop: å±•ç¤ºå‰é¢çš„å›¾å½¢ å’Œ åé¢çš„å›¾å½¢åªå±•ç¤ºä¸å‰é¢å›¾å½¢é‡å çš„éƒ¨åˆ†ã€‚</p><p>destination-ç³»åˆ—(over,in,out,atop) ä¸Šè¿°åˆæˆç‰¹ç‚¹ï¼Œ å‰åå›¾å½¢äº¤æ¢ã€‚</p><ul><li>ä»¥ destination-over ä¸ºä¾‹ï¼Œ å‰é¢çš„å›¾å½¢ï¼Œè¦†ç›–åœ¨åé¢çš„å›¾å½¢ä¸Šã€‚</li></ul><p>copy åé¢å›¾å½¢çš„è¦†ç›–å‰é¢çš„å›¾å½¢ ï¼ˆå‰é¢çš„å›¾å½¢æ²¡äº†ï¼‰</p><p>xor å±•ç¤ºå‰åä¸¤ä¸ªå›¾å½¢éé‡å çš„éƒ¨åˆ†</p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/41.png" alt="1685592301532" style="zoom:50%;" /><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/42.png" alt="1685592421491" style="zoom:50%;" /><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/43.png" alt="1685592502213" style="zoom:50%;" /><h2 id="2-é¢œè‰²åˆæˆ"><a href="#2-é¢œè‰²åˆæˆ" class="headerlink" title="2 é¢œè‰²åˆæˆ"></a>2 é¢œè‰²åˆæˆ</h2><p>å…³æ³¨çš„æ˜¯é¢œè‰²çš„æ··åˆï¼Œ å›¾å½¢çš„å½¢çŠ¶æ²¡æœ‰å˜åŒ–ã€‚</p><p>lighter é‡å éƒ¨åˆ†çš„é¢œè‰²ç›¸åŠ </p><p>multiply æ•´ä½“åæš—</p><p>screen æ•´ä½“åäº®</p><p>darken åŒä¸€ä¸ªåƒç´ çš„é¢œè‰²ï¼Œ å–æš—è‰²ï¼Œæ•´ä½“åæš—</p><p>lighten åŒä¸€ä¸ªåƒç´ çš„é¢œè‰²ï¼Œ å»äº®è‰²ï¼Œæ•´ä½“åäº®</p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/44.png" alt="1685592591747" style="zoom:50%;" /><h2 id="3-åˆ®åˆ®ä¹æ•ˆæœ"><a href="#3-åˆ®åˆ®ä¹æ•ˆæœ" class="headerlink" title="3 åˆ®åˆ®ä¹æ•ˆæœ"></a>3 åˆ®åˆ®ä¹æ•ˆæœ</h2><h1 id="ä¸ƒ-é¢œè‰²æ¸å˜"><a href="#ä¸ƒ-é¢œè‰²æ¸å˜" class="headerlink" title="ä¸ƒ é¢œè‰²æ¸å˜"></a>ä¸ƒ é¢œè‰²æ¸å˜</h1><h2 id="1-çº¿æ€§æ¸å˜"><a href="#1-çº¿æ€§æ¸å˜" class="headerlink" title="1 çº¿æ€§æ¸å˜"></a>1 çº¿æ€§æ¸å˜</h2><p>ä½¿ç”¨ ctx.createLinearGradient( x0 , y0 , x1 , y1) æ–¹æ³•åˆ›å»ºä¸€ä¸ªçº¿æ€§æ¸å˜çš„å¯¹è±¡ CanvasGradient</p><ul><li><p>x0,y0 å’Œ x1,y1 æ˜¯ä¸¤ä¸ªç‚¹ï¼Œ ä¼šæŒ‰ç…§ä¸¤ç‚¹çš„è¿çº¿æ–¹å‘æ¸å˜ (æ¨ªå‘ï¼Œçºµå‘ï¼Œæ–œå‘)</p></li><li><p>æ³¨æ„ï¼šæ¸å˜ä¸­çš„ä¸¤ä¸ªç‚¹æ˜¯åŸºäºåæ ‡ç³»çš„ï¼Œéœ€è¦è€ƒè™‘æ¸å˜åŒºåŸŸä¸å›¾å½¢åŒºåŸŸå…³ç³»</p></li></ul><p>ä½¿ç”¨ gradient.addColorStop(% , color) æ–¹æ³•è®¾ç½®æ¸å˜è¿‡ç¨‹ä¸­æ¯ä¸€éƒ¨åˆ†çš„é¢œè‰²ã€‚</p><p>è®¾ç½® ctx.fillStyle = gradient , ctx.strokeStyle = gradient ;</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> gradient <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">createLinearGradient</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">;</span>gradient<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"#f00"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>gradient<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token string">"#0f0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>gradient<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"#00f"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> gradient<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>å¦‚æœæ¸å˜åŒºåŸŸä¸å›¾å½¢åŒºåŸŸç›¸åŒï¼Œåˆ™æ˜¾ç¤ºå®Œæ•´æ¸å˜æ•ˆæœ</p><p>å¦‚æœæ¸å˜åŒºåŸŸæ¯”å›¾å½¢åŒºåŸŸå¤§ï¼Œåˆ™å›¾å½¢æ˜¾ç¤ºå¯¹åº”åŒºåŸŸçš„æ¸å˜æ•ˆæœ</p><p>å¦‚æœæ¸å˜åŒºåŸŸæ¯”å›¾å½¢åŒºåŸŸå°ï¼Œ å›¾å½¢èŒƒå›´çš„ä¸¤ä¾§å°±æ˜¯æ¸å˜ä¸¤ä¾§çš„é¢œè‰²ã€‚</p></blockquote><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/45.png" alt="1685610796218" style="zoom:50%;" /><h2 id="2-å¾„å‘æ¸å˜"><a href="#2-å¾„å‘æ¸å˜" class="headerlink" title="2 å¾„å‘æ¸å˜"></a>2 å¾„å‘æ¸å˜</h2><p>ä½¿ç”¨ ctx.createRadialGradient(x1 , y1 , r1 , x2 ,y2 , r2) æ–¹æ³•ï¼Œåˆ›å»ºå¾„å‘æ¸å˜å¯¹è±¡</p><ul><li><p>x1,y1, r1 è¡¨ç¤ºæ¸å˜å¼€å§‹çš„åœ†</p></li><li><p>x2,y2,r2 è¡¨ç¤ºæ¸å˜ç»“æŸçš„åœ†</p></li><li><p>æ³¨æ„ï¼šä¸€èˆ¬éƒ½æ˜¯ä¸€ä¸ªå¤§åœ†ï¼Œä¸€ä¸ªå°åœ†æ‰ä¼šæœ‰æ•ˆæœ</p><p>â€‹ å°åœ†ä¸€å®šè¦åœ¨å¤§åœ†å†…ï¼Œå¦åˆ™ä¼šå‡ºç°æ„æƒ³ä¸åˆ°çš„æ•ˆæœã€‚</p></li><li><p>æ³¨æ„ï¼šå°åœ†ä»¥é‡Œï¼Œ å¤§åœ†ä»¥å¤–çš„èŒƒå›´å°±æ˜¯æ¸å˜çš„ä¸¤ç«¯çš„é¢œè‰²</p></li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> gradient <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">createRadialGradient</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  gradient<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"#f00"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  gradient<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"#ff0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> gradient<span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span>PI <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/46.png" alt="1685612171636" style="zoom:50%;" /><h2 id="3-é”¥å½¢æ¸å˜"><a href="#3-é”¥å½¢æ¸å˜" class="headerlink" title="3 é”¥å½¢æ¸å˜"></a>3 é”¥å½¢æ¸å˜</h2><p>ä½¿ç”¨ ctx.createConicGradient(angle,x , y ) æ–¹æ³• åˆ›å»ºä¸€ä¸ªé”¥å½¢æ¸å˜å¯¹è±¡</p><ul><li><p>x y åœ†å¿ƒç‚¹</p></li><li><p>angle èµ·å§‹è§’åº¦ï¼Œ é»˜è®¤ 0Â° è§’æ˜¯ä¸‰ç‚¹é’Ÿæ–¹å‘ã€‚ angle = 90Â° ä»å…­ç‚¹é’Ÿæ–¹å‘å¼€å§‹æ—‹è½¬ã€‚</p></li><li><p>æ³¨æ„ï¼šangle ä¼ å‚æ—¶ä½¿ç”¨çš„æ˜¯è§’åº¦å¯¹åº”çš„å¼§åº¦å€¼ã€‚</p></li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> gradient <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">createConicGradient</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span>PI <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  gradient<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"#f00"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  gradient<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token string">"#ff0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  gradient<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token string">"#0f0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  gradient<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token string">"#0ff"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  gradient<span class="token punctuation">.</span><span class="token function">addColorStop</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"#00f"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> gradient<span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span>PI <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">"#fff"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span>PI <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/47.png" alt="1685613069138" style="zoom:50%;" /><h1 id="å…«-å›¾å½¢é˜´å½±"><a href="#å…«-å›¾å½¢é˜´å½±" class="headerlink" title="å…« å›¾å½¢é˜´å½±"></a>å…« å›¾å½¢é˜´å½±</h1><p>ctx.shadowBlur è®¾ç½®æ¨¡ç³Šç¨‹åº¦ï¼Œ æ•°å­—è¶Šå¤§ï¼Œè¶Šæ¨¡ç³Š</p><p>ctx.shadowColor è®¾ç½®é˜´å½±é¢œè‰²</p><p>ctx.shadowOffsetX , ctx.shadowOffsetY è®¾ç½®é˜´å½±çš„åç§»é‡</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>shadowColor <span class="token operator">=</span> <span class="token string">"#ff0"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>shadowBlur <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">"#f00"</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span>PI <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/48.png" alt="1685690368804" style="zoom:50%;" /><h1 id="ä¹-æ»¤é•œ"><a href="#ä¹-æ»¤é•œ" class="headerlink" title="ä¹ æ»¤é•œ"></a>ä¹ æ»¤é•œ</h1><p>ä½¿ç”¨ ctx.filter å±æ€§ï¼Œè®¾ç½®ä¸€ä¸ªæˆ–å¤šä¸ªæ»¤é•œ</p><p>ctx.filter = â€˜blur(10px)â€™ è®¾ç½®æ¨¡ç³Šï¼Œå€¼è¶Šå¤§ï¼Œæ¨¡ç³Šæ•ˆæœè¶Šæ˜æ˜¾ã€‚</p><p>ctx.filter = â€˜brightness(%)â€™; è®¾ç½®äº®åº¦ï¼Œ 1 åŸæ ·ï¼Œ &lt; 1 å˜æš—ï¼Œ &gt;1 å˜äº®</p><p>ctx.filter = â€˜contrast(%)â€™; è®¾ç½®å¯¹æ¯”åº¦ï¼Œ1 åŸæ ·ï¼Œ &lt; 1 é¢œè‰²æ¥è¿‘ï¼Œ &gt;1 é¢œè‰²é²œæ˜</p><p>ctx.filter = â€˜saturate(%)â€™; è®¾ç½®é¥±å’Œåº¦ï¼Œ1 åŸæ ·ï¼Œ &lt; 1 å˜ç°ï¼Œ &gt; 1 é¢œè‰²é²œæ˜</p><p>ctx.filter = â€˜grayscale(%)â€™; è®¾ç½®ç°åº¦ï¼Œ0 åŸæ ·ï¼Œ 1 å˜ç°</p><p>ctx.filter = â€˜sepia(1)â€™; 1 æ€€æ—§é£æ ¼ï¼ˆæ·±è¤è‰²ï¼‰ 0 åŸæ ·</p><p>ctx.filter = â€˜invert(1)â€™; è®¾ç½®åè‰²ï¼Œ0 åŸæ · 1 é¢œè‰²å–å 0.5 ç°è‰²</p><p>ctx.filter = â€˜drop-shadow(x y blur color)â€™; è®¾ç½®é˜´å½± x , y , blur éƒ½éœ€è¦å¸¦ px å•ä½ã€‚</p><p>ctx.filter = â€˜hue-rotate(180deg)â€™; è®¾ç½®è‰²è°ƒ</p><p>ctx.filter = â€˜hue-rotate(180deg) contrast(0.5)â€™ ä½¿ç”¨å¤šä¸ªæ»¤é•œ</p><p>ctx.filter = â€˜url(svgFilterID)â€™ å¼•ç”¨ svg æ»¤é•œã€‚</p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/49.png" alt="1685698571416" style="zoom:50%;" /><h1 id="å-å›¾åƒå˜æ¢"><a href="#å-å›¾åƒå˜æ¢" class="headerlink" title="å å›¾åƒå˜æ¢"></a>å å›¾åƒå˜æ¢</h1><p>å°±æ˜¯å¯¹å›¾å½¢è¿›è¡Œä¸€ä¸ªç§»åŠ¨ï¼Œæ—‹è½¬ï¼Œæ”¾ç¼©ï¼ŒçŸ©é˜µæ–œåˆ‡ã€‚</p><h2 id="1-å›¾å½¢ç§»åŠ¨"><a href="#1-å›¾å½¢ç§»åŠ¨" class="headerlink" title="1 å›¾å½¢ç§»åŠ¨"></a>1 å›¾å½¢ç§»åŠ¨</h2><p>ç§»åŠ¨ä¸æ˜¯åŠ¨ç”»ï¼Œ åªæ˜¯è§†è§‰ä½ç½®ä¸Šçš„å˜åŒ–</p><p>ä½¿ç”¨ ctx.translate( x , y ) æ–¹æ³•å®ç°å›¾å½¢ä½ç½®çš„ç§»åŠ¨</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">translate</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">rect</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/50.png" alt="1685932448311" style="zoom:50%;" /><blockquote><p>è¿™é‡Œå®é™…ç§»åŠ¨çš„å¹¶ä¸æ˜¯æŒ‡å®šçš„å›¾å½¢ï¼Œè€Œæ˜¯åæ ‡ç³»ã€‚</p><p>å¯¹äºä¹‹å‰å·²ç»ç»˜åˆ¶è¿‡çš„å›¾å½¢æ²¡æœ‰å½±å“ã€‚</p></blockquote><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//åŸºäºåŸåæ ‡ç³»ç»˜åˆ¶çš„å›¾å½¢</span>  <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">translate</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//ç»˜åˆ¶åæ ‡ç³»</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span>PI <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">400</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">400</span><span class="token punctuation">;</span> i <span class="token operator">+</span><span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>    ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>    ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//æ–°åæ ‡ç³»ä¸­ç»˜åˆ¶å›¾å½¢</span>  ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/51.png" alt="1685932503158" style="zoom:50%;" /><h2 id="2-å›¾å½¢æ”¾ç¼©"><a href="#2-å›¾å½¢æ”¾ç¼©" class="headerlink" title="2 å›¾å½¢æ”¾ç¼©"></a>2 å›¾å½¢æ”¾ç¼©</h2><p>æœ¬è´¨æ˜¯å¯¹åæ ‡ç³»æ¨ªçºµåæ ‡çš„æ”¾ç¼©</p><p>ä½¿ç”¨ ctx.scale(xRatio , yRatio) æ–¹æ³•è®¾ç½®æ¨ªçºµåæ ‡çš„æ”¾ç¼©æ¯”ä¾‹</p><ul><li><code>0&lt; ratio &lt;1</code> ç¼©å°</li><li><code>1 &lt; ratio</code> æ”¾å¤§</li><li>è´Ÿæ•° åæ ‡ç³»æ–¹å‘å‘ç”Ÿåè½¬ã€‚</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">//åæ ‡ç³»å¾ˆåæ ‡æ”¾å¤§2å€</span>ctx<span class="token punctuation">.</span><span class="token function">translate</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>ctx<span class="token punctuation">.</span><span class="token function">scale</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//çºµåæ ‡ç³»åè½¬ï¼Œæ„å»ºæ•°å­¦åæ ‡ç³»</span>ctx<span class="token punctuation">.</span><span class="token function">translate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">;</span>ctx<span class="token punctuation">.</span><span class="token function">scale</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/52.png" alt="1685934691265" style="zoom:50%;" /><h2 id="3-å›¾åƒæ—‹è½¬"><a href="#3-å›¾åƒæ—‹è½¬" class="headerlink" title="3 å›¾åƒæ—‹è½¬"></a>3 å›¾åƒæ—‹è½¬</h2><p>ä½¿ç”¨ ctx.rotate(angle) æ–¹æ³•è®¾ç½®é¡ºæ—¶é’ˆæ—‹è½¬çš„è§’åº¦ã€‚</p><blockquote><p>é€»è¾‘ä¸Šä¼ é€’çš„æ˜¯è§’åº¦ï¼Œ è¯­æ³•ä¸Šè¦æ±‚ä¼ é€’æ˜¯å¼§åº¦ã€‚</p></blockquote><pre class="line-numbers language-java"><code class="language-java"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>    canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">'#f00'</span><span class="token punctuation">;</span>    ctx<span class="token punctuation">.</span><span class="token function">setLineDash</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    ctx<span class="token punctuation">.</span><span class="token function">strokeRect</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//å˜åŒ–åæ ‡ç³»</span>    ctx<span class="token punctuation">.</span><span class="token function">translate</span><span class="token punctuation">(</span><span class="token number">125</span><span class="token punctuation">,</span><span class="token number">125</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    ctx<span class="token punctuation">.</span><span class="token function">rotate</span><span class="token punctuation">(</span><span class="token number">45</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span>PI <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//åæ ‡ç³»ä¸­ç»˜åˆ¶å›¾å½¢</span>    ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">25</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/53.png" alt="1685936072509" style="zoom:50%;" /><blockquote><p>ç§»åŠ¨ä¸æ—‹è½¬çš„è®¾ç½®é¡ºåºä¸åŒï¼Œæœ€ç»ˆçš„æ•ˆæœä¹Ÿä¸ç›¸åŒã€‚</p></blockquote><h2 id="4-çŸ©é˜µå˜æ¢"><a href="#4-çŸ©é˜µå˜æ¢" class="headerlink" title="4 çŸ©é˜µå˜æ¢"></a>4 çŸ©é˜µå˜æ¢</h2><p>canvas æ²¡æœ‰æä¾›æ–œåˆ‡æ–¹æ³•ï¼Œå¯ä»¥åˆ©ç”¨çŸ©é˜µå˜æ¢æ¥å®ç°ã€‚</p><p>çŸ©é˜µå˜æ¢åˆå¯ä»¥å®ç°æ‰€æœ‰çš„å›¾å½¢å˜æ¢ï¼ˆå¹³ç§»ï¼Œæ”¾ç¼©ï¼Œæ—‹è½¬ï¼Œæ–œåˆ‡ï¼‰</p><p><strong>çŸ©é˜µå˜æ¢æœºåˆ¶</strong></p><p>æ‰€è°“çš„å˜æ¢å°±æ˜¯å°†åŸåæ ‡æŒ‰ç…§ä¸€å®šçš„å˜æ¢å…¬å¼(é€»è¾‘)ï¼Œå˜æ¢æˆä¸€ä¸ªæ–°åæ ‡ã€‚</p><p><code>( x , y )   ---  çŸ©é˜µ --- (x&#39; , y&#39;)</code></p><p>ä½¿ç”¨é½æ¬¡åæ ‡ç³»æ¥è¿›è¡ŒçŸ©é˜µå˜æ¢ï¼Œå¯ä»¥ç®€åŒ–å¹³ç§»è®¡ç®—ã€‚</p><pre class="line-numbers language-txt"><code class="language-txt">|x|      |a    c    e|        |x'||y|    * |b    d    f|    =    |y'||1|      |0    0    1|        |1 |x' = x*a + y*c + 1*ey' = x*b + y*d * 1*f1 =  x*0 + y*0 + 1*1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ä½¿ç”¨ ctx.transform(a , b , c , d , e , f) æ–¹æ³•ï¼Œä¼ é€’è½¬æ¢çŸ©é˜µï¼Œå®ç°å›¾å½¢å˜æ¢</strong></p><p><strong>çŸ©é˜µç§»åŠ¨</strong></p><p>å°±åœ¨åŸæœ‰ x , y çš„åŸºç¡€ä¸Šï¼Œ ç§»åŠ¨æŒ‡å®šçš„æ•°å€¼ã€‚</p><pre class="line-numbers language-text"><code class="language-text">1 0 e0 1 f<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ¨ªçºµå„ç§»åŠ¨ 100</p><p><code>ctx.transform(1,0, 0,1, 100,100);</code></p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/54.png" alt="1685957171823" style="zoom:50%;" /><p><strong>çŸ©é˜µæ”¾ç¼©</strong></p><p>å†åŸæœ‰ x , y çš„åŸºç¡€ä¸Šï¼Œä¹˜ä¸ŠæŒ‡å®šçš„å€ç‡ã€‚ 2 ï¼Œ 0.5</p><pre class="line-numbers language-text"><code class="language-text">a 0 00 d 0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ¨ªå‘æ”¾å¤§è‡³ 2ï¼Œçºµå‘ç¼©å°è‡³ 0.5</p><p><code>ctx.transform(2,0, 0,0.5, 0,0);</code></p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/55.png" alt="1685957204889" style="zoom:50%;" /><p><strong>çŸ©é˜µæ–œåˆ‡</strong></p><p>å»¶ x æˆ– y è½´åšä¸€ä¸ªæ‹‰æ‰¯ï¼Œæ˜¯çš„ä¸ x æˆ– y è½´å½¢æˆä¸€ä¸ªå¤¹è§’ã€‚</p><ul><li>å»¶ x è½´æ–œåˆ‡ï¼Œä¼šäº§ç”Ÿä¸ y è½´çš„å¤¹è§’ã€‚ æœ€ç»ˆ x ä½ç½®å‘ç”Ÿå˜åŒ–</li><li>å»¶ y è½´æ–œåˆ‡ï¼Œ ä¼šäº§ç”Ÿä¸ x è½´çš„å¤¹è§’ã€‚æœ€ç»ˆ y ä½ç½®å‘ç”Ÿå˜åŒ–</li></ul><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/56.png" alt="1685957257113" style="zoom:50%;" /><pre class="line-numbers language-text"><code class="language-text">    1        tan(angle)    0tan(angle)         1        0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å®ç° skewX(30Â°)</p><p><code>ctx.transform(1,0, Math.tan(30 * Math.PI/180),1 ,0,0);</code></p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/57.png" alt="1685957311914" style="zoom:50%;" /><p><strong>çŸ©é˜µæ—‹è½¬</strong></p><p>æ—‹è½¬ä¹Ÿä¼šå‘ç”Ÿä¸€ä¸ªè§’åº¦çš„å˜åŒ–</p><p>æ—‹è½¬éƒ½æ˜¯åŸºäº x è½´æ­£æ–¹å‘ï¼Œé¡ºæ—¶é’ˆæ—‹è½¬</p><p>è¿™é‡Œé¢çš„æ—‹è½¬è§’åº¦æ˜¯åŸºäºåŸä½ç½®çš„æ—‹è½¬è§’åº¦ï¼Œè€Œä¸æ˜¯åŸºäº x è½´çš„æ—‹è½¬è§’åº¦ï¼Œæ‰€ä»¥è¿˜è¦è€ƒè™‘åŸä½ç½®ä¸ x è½´å¤¹è§’ã€‚</p><pre class="line-numbers language-text"><code class="language-text">å’Œè§’å…¬å¼sin(a+b) = sin(a) * cos(b) + cos(a) * sin(b)cos(a+b) = cos(a) * cos(b) - sin(a) * sin(b)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/58.png" alt="1685958541579" style="zoom:50%;" /><pre class="line-numbers language-text"><code class="language-text">cos(angle) -sin(angle) 0sin(angle) cos(angle) 0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æ—‹è½¬ 45Â°</p><pre class="line-numbers language-javascript"><code class="language-javascript">ctx<span class="token punctuation">.</span><span class="token function">transform</span><span class="token punctuation">(</span>  Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">45</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span>PI<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">45</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span>PI<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">//a b</span>  <span class="token operator">-</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">45</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span>PI<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">45</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span>PI<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">//c d</span>  <span class="token number">0</span><span class="token punctuation">,</span>  <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//e f</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/59.png" alt="1685958568617" style="zoom:50%;" /><h1 id="åä¸€-çŠ¶æ€å­˜å‚¨ä¸é‡ç½®"><a href="#åä¸€-çŠ¶æ€å­˜å‚¨ä¸é‡ç½®" class="headerlink" title="åä¸€ çŠ¶æ€å­˜å‚¨ä¸é‡ç½®"></a>åä¸€ çŠ¶æ€å­˜å‚¨ä¸é‡ç½®</h1><p>ä½¿ç”¨ ctx.save() å’Œ ctx.restore() ä¸¤ä¸ªæ–¹æ³•å®ç°ç»˜åˆ¶çŠ¶æ€çš„å­˜å‚¨å’Œé‡ç½®ã€‚</p><p>ç»˜åˆ¶çŠ¶æ€ï¼š</p><ul><li>æè¾¹æ ·å¼ï¼Œå¡«å……æ ·å¼</li><li>çº¿æ¡æ ·å¼</li><li>æ–‡æœ¬æ ·å¼</li><li>è£å‰ª</li><li>åˆæˆ</li><li>å›¾åƒå˜æ¢</li></ul><p>æ¯æ¬¡è°ƒç”¨ ctx.save()æ–¹æ³•ï¼Œéƒ½ä¼šå°†ä¹‹å‰è®¾ç½®çš„çŠ¶æ€å­˜å‚¨èµ·æ¥(å­˜å…¥æ ˆä¸­)</p><p>å¯ä»¥è°ƒç”¨å¤šæ¬¡ save æ–¹æ³•ï¼Œå°†å¤šä¸ªçŠ¶æ€æŒ‰ç…§é¡ºåºå­˜å…¥æ ˆä¸­ã€‚</p><p>æ¯æ¬¡è°ƒç”¨ ctx.restore()æ–¹æ³•ï¼Œä¼šé‡ç½®çŠ¶æ€ã€‚æ‰€è°“çš„é‡ç½®çŠ¶æ€ï¼Œå°±æ˜¯å°†å½“å‰çŠ¶æ€ä»æ ˆä¸­ç§»é™¤ï¼ˆåˆ é™¤ï¼‰ï¼Œæ¢å¤åˆ°ä¸Šä¸€æ¬¡çš„çŠ¶æ€ã€‚</p><p>save å’Œ restore ä¸æ˜¯å¿…é¡»çš„ï¼Œå¯ä»¥æ‰‹åŠ¨æŒ‰ç…§é€»è¾‘ï¼Œæ¢å¤ä¸Šä¸€æ¬¡çš„çŠ¶æ€ã€‚</p><pre class="line-numbers language-java"><code class="language-java"> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>     <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     canvas<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>     canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>     document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">const</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">//å¡«å……ä¸€ä¸ªçº¢è‰²çš„çŸ©å½¢</span>     ctx<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span>         ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">'#0f0'</span><span class="token punctuation">;</span>     ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">//å¡«å……ä¸€ä¸ªè“è‰²çš„åœ†</span>     ctx<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">'#00f'</span><span class="token punctuation">;</span>     ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     ctx<span class="token punctuation">.</span><span class="token function">arc</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>Math<span class="token punctuation">.</span>PI<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">//å¡«å……ä¸€ä¸ªçº¢è‰²çš„çŸ©å½¢</span>     <span class="token comment" spellcheck="true">//ctx.fillStyle = '#f00'; //é€»è¾‘ä¸Šæ¢å¤çŠ¶æ€</span>     ctx<span class="token punctuation">.</span><span class="token function">restore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>               <span class="token comment" spellcheck="true">//é€šè¿‡restoreæ–¹æ³•æ¢å¤çŠ¶æ€</span>     ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">,</span><span class="token number">300</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/60.png" alt="1685960131460" style="zoom:50%;" /><h1 id="åäºŒ-å®æˆ˜æ¡ˆä¾‹"><a href="#åäºŒ-å®æˆ˜æ¡ˆä¾‹" class="headerlink" title="åäºŒ å®æˆ˜æ¡ˆä¾‹"></a>åäºŒ å®æˆ˜æ¡ˆä¾‹</h1><h2 id="1-åŠ¨æ€æ—¶é’Ÿ"><a href="#1-åŠ¨æ€æ—¶é’Ÿ" class="headerlink" title="1 åŠ¨æ€æ—¶é’Ÿ"></a>1 åŠ¨æ€æ—¶é’Ÿ</h2><p>è¡¨ç›˜ ï¼Œ åˆ»åº¦ï¼ˆå¤§åˆ»åº¦ï¼Œå°åˆ»åº¦ï¼‰ ï¼Œè¡¨é’ˆï¼ˆæ—¶é’ˆï¼Œåˆ†é’ˆï¼Œç§’é’ˆï¼‰</p><p>è¡¨é’ˆéœ€è¦ä¸åœçš„å˜åŠ¨</p><ul><li>åŠ¨ç”»ç»˜åˆ¶</li><li>è¡¨é’ˆè§’åº¦</li></ul><h2 id="2-ç²’å­çƒŸèŠ±"><a href="#2-ç²’å­çƒŸèŠ±" class="headerlink" title="2 ç²’å­çƒŸèŠ±"></a>2 ç²’å­çƒŸèŠ±</h2><p>è¿‡ç¨‹åˆ† 2 éƒ¨åˆ†</p><ul><li><p>çƒŸèŠ±å‡ç©º</p><ul><li><p>ç”±å¤šä¸ªå°çƒç»„æˆä¸€ä¸ªçƒŸèŠ±å‡ç©ºæ‹–å°¾çš„æ•ˆæœ</p></li><li><p>æ¯ä¸€ä¸ªå°çƒçš„åŠå¾„ä¾æ¬¡å‡å°</p></li><li><p>æ¯ä¸€ä¸ªå°çƒçš„é€æ˜åº¦ä¾æ¬¡å˜åŒ–ï¼Œä¸Šå‡è¿‡ç¨‹ä¸­ï¼Œé€æ˜åº¦æ•´ä½“è¿˜ä¼šå˜åŒ–</p><p>ç¬¬ä¸€ç¬é—´ 10 ä¸ªå°çƒçš„é€æ˜åº¦ åˆ†åˆ«æ˜¯ 1 0.99 0.98 â€¦.</p><p>ç¬¬äºŒç¬é—´ 10 ä¸ªå°çƒçš„é€æ˜åº¦ åˆ†åˆ«æ˜¯ 0.5 0.49 0.48 â€¦</p></li></ul></li><li><p>çƒŸèŠ±çˆ†ç‚¸</p><ul><li>çƒŸèŠ±ä¸»ä½“æ¶ˆå¤±</li><li>ç»˜åˆ¶ä¸€ç»„å°é¢—ç²’</li><li>æ²¿ç€åœ†å¼§æ‰©æ•£</li></ul></li></ul><p>æœ‰çš„çƒŸèŠ±å¤„äºå‡ç©ºçŠ¶æ€ï¼Œæœ‰çš„çƒŸèŠ±å¤„äºçˆ†ç‚¸çŠ¶æ€ï¼Œä¸¤ä¸ªæ•ˆæœå¯ä»¥åŒæ—¶è¿›è¡Œã€‚</p><p>æ‰€ä»¥éœ€è¦æ¯ä¸€æ¬¡éƒ½é‡æ–°ç»˜åˆ¶ã€‚</p><p>æ¶‰åŠå¯¹è±¡ï¼š</p><ul><li>çƒŸèŠ±å¯¹è±¡</li><li>å°çƒå¯¹è±¡ï¼Œç»„æˆçƒŸèŠ±ä¸»ä½“</li><li>ç²’å­å¯¹è±¡ï¼Œçˆ†ç‚¸ä¸­çš„ä¾‹å­</li></ul><p>ä»å‡ç©ºåˆ°çˆ†ç‚¸</p><ul><li><p>æ¯éš”ä¸€æ®µæ—¶é—´ï¼Œå‡ç©ºä¸€ä¸ªçƒŸèŠ±</p></li><li><p>å½“å±å¹•ä¸­è¾¾åˆ° 3 ä¸ªçƒŸèŠ±æ—¶ï¼Œæœ€å¼€å§‹çƒŸèŠ±å°±å¯ä»¥çˆ†ç‚¸äº†</p></li><li><p>çˆ†ç‚¸çš„æ—¶å€™ï¼ŒçƒŸèŠ±ä¸»ä½“æ¶ˆå¤±ï¼ˆä¸å†ç»˜åˆ¶ï¼‰</p></li><li><p>ç»˜åˆ¶çˆ†ç‚¸åäº§ç”Ÿçš„ç²’å­ï¼ˆ400,500ï¼‰ï¼Œæ¯æ¬¡é‡æ–°ç»˜åˆ¶çš„æ—¶å€™ï¼Œæ”¹å˜å…¶ä½ç½®ã€‚</p></li></ul><h2 id="3-è´ªåƒè›‡"><a href="#3-è´ªåƒè›‡" class="headerlink" title="3 è´ªåƒè›‡"></a>3 è´ªåƒè›‡</h2><p>ç»„æˆéƒ¨åˆ†ï¼š</p><ul><li>æ£‹ç›˜</li><li>è›‡ï¼ˆè›‡å¤´ + èº«ä½“ï¼‰</li><li>é£Ÿç‰©</li></ul><p>æä¾› 2 ä¸ªç”»å¸ƒï¼Œä¸€ä¸ªç»˜åˆ¶æ£‹ç‰Œï¼ˆé™æ€ï¼‰ï¼Œä¸€ä¸ªç»˜åˆ¶è›‡ + é£Ÿç‰©ï¼ˆåŠ¨æ€ï¼‰</p><p>ç»˜åˆ¶è›‡</p><ul><li>å°†è›‡è®¾è®¡æˆä¸€ä¸ªå¯¹è±¡</li><li>è®¾è®¡ä¸€ä¸ªçŸ©å½¢å¯¹è±¡ï¼Œè¡¨ç¤ºè›‡çš„ç»„æˆï¼Œè¡¨ç¤ºé£Ÿç‰©</li></ul><p>è›‡(å¤´)çš„ç§»åŠ¨</p><ul><li>æ³¨æ„æ–¹å‘</li><li>æ¯ç»˜åˆ¶ä¸€ä¸ªæ–°ä½ç½®ï¼Œè¦å°†åŸæ¥ä½ç½®çš„å›¾å½¢åˆ é™¤æ‰ã€‚</li></ul><p>ç”Ÿæˆé£Ÿç‰©</p><ul><li><p>éšæœºç»˜åˆ¶ä¸€ä¸ªçŸ©å½¢</p></li><li><p>ç¡®ä¿åœ¨ä¸€ä¸ªç©ºç™½çš„ä½ç½® ï¼ˆæ²¡æœ‰è›‡çš„ä½ç½®ï¼‰</p></li><li><p>è®¾è®¡ï¼š å®šä¹‰ä¸€ä¸ªå¯¹è±¡ï¼Œæ¯ä¸€ä¸ªæ ¼å­çš„åæ ‡ä½œä¸º keyï¼Œvalue è¡¨ç¤ºæ ¼å­çš„å ç”¨çŠ¶æ€ 0 ç©ºé—²ï¼Œ 1 å ç”¨</p><p>â€‹ æ¯æ¬¡ç»˜åˆ¶çŸ©å½¢çš„æ—¶å€™ï¼Œå°†å…¶æ ¼å­è®¾ç½®ä¸º 1 ï¼Œ æ¸…é™¤çŸ©å½¢çš„æ—¶å€™ï¼Œå°†å…¶æ ¼å­è®¾ç½®ä¸º 0</p><p>â€‹ ç”Ÿæˆé£Ÿç‰©æ—¶ï¼Œéšæœºä¸€ä¸ªæ ¼å­ä½ç½®ï¼Œåˆ¤æ–­å…¶çŠ¶æ€ï¼Œ 1 å°±é‡æ–°éšæœºï¼Œ0 ç»˜åˆ¶é£Ÿç‰©ã€‚</p></li></ul><p>åƒé£Ÿç‰©ï¼Œèº«ä½“å˜åŒ–ï¼Œèº«ä½“ç§»åŠ¨</p><ul><li>å½“è›‡å¤´åæ ‡ä¸é£Ÿç‰©åæ ‡ç›¸æ’æ—¶ï¼Œè¡¨ç¤ºåƒåˆ°é£Ÿç‰©</li><li>åƒåˆ°é£Ÿç‰©åï¼Œè›‡çš„èº«ä½“ä¼šè¾¹é•¿ï¼Œè§†è§‰æ•ˆæœä¸Šçœ‹å°±æ˜¯åé¢èº«ä½“çš„éƒ¨åˆ†éƒ½æ²¡æœ‰å˜åŒ–ï¼Œåªæœ‰åŸæ¥è›‡å¤´çš„ä½ç½®åŠ äº†ä¸€å—èº«ä½“ï¼Œæ‰€ä»¥åªéœ€è¦åœ¨ body çš„å¤´éƒ¨å¢åŠ ä¸€ä¸ªçŸ©å½¢ï¼Œå¹¶ç»˜åˆ¶å³å¯ã€‚</li><li>æ²¡æœ‰åƒåˆ°äº‹åŠ¡ï¼Œå½“è›‡ç§»åŠ¨æ—¶ï¼Œè§†è§‰æ•ˆæœä¸Šï¼Œæœ€åä¸€ä¸ªä½ç½®çš„èº«ä½“éƒ¨åˆ†æ¶ˆå¤±ï¼Œåœ¨åŸæ¥è›‡å¤´çš„ä½ç½®å¢åŠ äº†æ–°çš„èº«ä½“éƒ¨åˆ†ï¼Œå…¶ä½™éƒ¨åˆ†æ²¡æœ‰å˜åŒ–ã€‚æ‰€ä»¥åªéœ€è¦å°†æœ€åä¸€ä¸ªçŸ©å½¢ç§»åŠ¨åˆ° body çš„æœ€å‰é¢å¹¶ç»˜åˆ¶å³å¯ã€‚</li></ul><h2 id="4-ç”»å›¾æ¿"><a href="#4-ç”»å›¾æ¿" class="headerlink" title="4 ç”»å›¾æ¿"></a>4 ç”»å›¾æ¿</h2><p>çº¿æ¡ç»˜åˆ¶ï¼š</p><ul><li>å¤šä¸ªç‚¹çš„è¿çº¿</li><li>é¼ æ ‡æŒ‰ä¸‹æ˜¯èµ·å§‹ç‚¹</li><li>é¼ æ ‡ç§»åŠ¨ï¼Œäº§ç”Ÿè¿‡ç¨‹ç‚¹</li><li>é¼ æ ‡æŠ¬èµ·ï¼Œç»˜åˆ¶ç»“æŸã€‚</li></ul><p>çŸ©å½¢ç»˜åˆ¶</p><ul><li>èµ·å§‹ç‚¹ï¼Œ å®½é«˜</li><li>é¼ æ ‡æŒ‰ä¸‹ï¼Œè·å¾—èµ·å§‹ç‚¹</li><li>é¼ æ ‡ç§»åŠ¨ï¼Œäº§ç”Ÿè¿‡ç¨‹ç‚¹ã€‚</li><li>é€šè¿‡ä¸¤ç‚¹ï¼Œå¯ä»¥è®¡ç®—å®½é«˜</li><li>çŸ©å½¢åœ¨ç»˜åˆ¶è¿‡ç¨‹ä¸­ï¼Œæ²¡æœ‰æŠ¬èµ·é¼ æ ‡ï¼Œåˆ™è¿˜å¤„äºé€‰æ‹©é˜¶æ®µï¼ŒçŸ©å½¢æ²¡æœ‰ç¡®å®šã€‚æœ‰ä¸€ä¸ªæ‹–æ‹½çš„è§†è§‰æ•ˆæœ</li><li>å®é™…ä¸Šæ˜¯ä¸€ä¸ªä¸æ–­ç»˜åˆ¶çš„è¿‡ç¨‹ï¼Œæ­¤æ—¶å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼š<ul><li>ç”±äºçŸ©å½¢ä¼šä¸å…¶ä»–å›¾å½¢äº§ç”Ÿè¦†ç›–ï¼Œ å¦‚æœåˆ é™¤ä¹‹å‰ç»˜åˆ¶çš„çŸ©å½¢ï¼Œä¹Ÿä¼šå°†ä¹‹å‰å›¾å½¢è¦†ç›–çš„éƒ¨åˆ†ä¹Ÿåˆ é™¤</li><li>ä¸ºäº†æé«˜æ€§èƒ½ï¼Œè€ƒè™‘ä½¿ç”¨ 2 ä¸ªç”»å¸ƒã€‚</li><li>åœ¨ç¬¬ä¸€ä¸ªç”»å¸ƒä¸­ï¼Œç»˜åˆ¶å½“å‰çš„è¿™ä¸€ä¸ªå›¾å½¢ï¼Œ æèµ·é¼ æ ‡åï¼Œå›¾å½¢ç¡®å®šï¼Œå†å°†å…¶ç»˜åˆ¶åˆ°ç¬¬äºŒä¸ªç”»å¸ƒä¸Šã€‚</li></ul></li></ul><p>åœ†å½¢ç»˜åˆ¶</p><ul><li><p>åœ†å¿ƒç‚¹ï¼ŒåŠå¾„</p></li><li><p>é¼ æ ‡æŒ‰ä¸‹ï¼Œè·å¾—èµ·å§‹ç‚¹</p></li><li><p>é¼ æ ‡ç§»åŠ¨ï¼Œäº§ç”Ÿè¿‡ç¨‹ç‚¹</p></li><li><p>èµ·å§‹ç‚¹ å’Œ è¿‡ç¨‹ç‚¹ï¼Œè®¡ç®—åŠå¾„ å’Œ åœ†å¿ƒç‚¹</p></li><li><p>å¯èƒ½æ˜¯æ­£åœ†ï¼Œä¹Ÿå¯èƒ½æ˜¯æ¤­åœ†ã€‚</p></li><li><p>åŸçš„æ‹–æ‹½ç»˜åˆ¶ä¸çŸ©å½¢ç›¸åŒã€‚</p></li></ul><p>å¡«å……ï¼š</p><ul><li>ä¸æ˜¯å¯¹æŸä¸€ä¸ªå›¾å½¢è¿›è¡Œå¡«å……ï¼Œè€Œæ˜¯å¯¹ä¸€å—åˆå›´åŒºåŸŸå¡«å……ã€‚</li><li>åˆå›´åŒºåŸŸå¯èƒ½æ˜¯æœ‰å¤šä¸ªå›¾å½¢éƒ¨åˆ†åˆå›´è€Œæˆ</li><li>éš¾ç‚¹ï¼šå¦‚ä½•ç¡®å®šè¿™ä¸ªåˆå›´åŒºåŸŸ ã€‚ å¯ä»¥é€šè¿‡åƒç´ æ“ä½œæ¥å®ç°<ul><li>ä»¥è§¦å‘å¡«å……æ“ä½œçš„é‚£ä¸ªç‚¹ä¸ºåŸºå‡†</li><li>è·å¾—é‚£ä¸ªç‚¹çš„ rgba å€¼</li><li>ç„¶åå‘å››å‘¨åˆ†æ•£ï¼Œä¸€æ¬¡æ‰¾åˆ°å››å‘¨æ‰€æœ‰çš„ç‚¹ï¼Œ ä¸è¿™ä¸ª rgba æ¯”è¾ƒï¼Œ</li><li>å®Œå…¨ç›¸ç­‰ï¼Œå°±å®ç°é¢œè‰²çš„å˜åŒ–ï¼Œç»§ç»­å‘å››å‘¨æ‰©æ•£</li><li>ä¸ç›¸ç­‰ï¼Œè¯´æ˜å·²ç»åˆ°äº†ä¸€ä¸ªè¾¹ç•Œï¼Œå°±ä¸åœ¨ç»§ç»­å‘æ•£äº†</li></ul></li></ul><p>æ©¡çš®æ“¦ï¼š</p><ul><li>ä¸åˆ®åˆ®ä¹å®ç°è¿‡ç¨‹ç›¸ä¼¼</li><li>æœ¬è´¨è¿˜æ˜¯ç”»çº¿æ¡</li><li>åªä¸è¿‡ä¸åŸå›¾å½¢çš„åˆæˆå…³ç³»å‘ç”Ÿäº†å˜åŒ–ã€‚</li></ul><p>ç»¼ä¸Šåˆ†æï¼š</p><ul><li><p>ç›®å‰éœ€è¦ 2 ä¸ªç”»å¸ƒã€‚ ä¸€ä¸ªä½“ç°ç»˜åˆ¶è¿‡ç¨‹ï¼Œ ä¸€ä¸ªç”¨æ¥å±•ç¤ºç»˜åˆ¶ç»“æœ</p></li><li><p>éœ€è¦å›¾å½¢å¯¹è±¡ ï¼ŒåŒ…æ‹¬å¤šç§ç±»å‹ï¼ˆçº¿æ¡ï¼ŒçŸ©å½¢ï¼Œåœ†å½¢ï¼Œæ©¡çš®æ“¦ï¼‰</p></li></ul><p>å¡«å……ä»£ç  1ï¼šé€’å½’ï¼ˆèŒƒå›´æœ‰é™ï¼‰</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">//æ”¹å˜å½“å‰ç‚¹çš„é¢œè‰²</span><span class="token keyword">function</span> <span class="token function">change</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//è·å¾—è¦æ”¹å˜è¿™ä¸ªç‚¹çš„åŸå§‹é¢œè‰² (å¦‚ä½•æ ¹æ®åæ ‡ç‚¹ï¼Œè·å¾—å…¶imageDataä¸­çš„æ˜¾è‰²ä½ç½®)</span>  <span class="token keyword">const</span> i <span class="token operator">=</span> <span class="token function">point2Index</span><span class="token punctuation">(</span>imageData<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//åˆ¤æ–­è¿™ä¸ªåŸå§‹é¢œè‰²å’ŒåŸºå‡†é¢œè‰²æ˜¯å¦ç›¸åŒï¼Œ ç›¸åŒå°±æ”¹ï¼Œä¸ç›¸åŒå°±ç»“æŸäº†</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>    baseImageData<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> imageData<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span>    baseImageData<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> imageData<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span>    baseImageData<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> imageData<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span>    baseImageData<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> imageData<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span>  <span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//ç›¸ç­‰ï¼Œ è¿™ä¸ªä½ç½®é¢œè‰²å¯ä»¥æ”¹å˜</span>    imageData<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">255</span><span class="token punctuation">;</span>    imageData<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    imageData<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    imageData<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">255</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//ç»§ç»­å‘æ•£ï¼Œå†æ£€æŸ¥å…¶å››å‘¨</span>    <span class="token function">change</span><span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">change</span><span class="token punctuation">(</span>x <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">change</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">change</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span> <span class="token keyword">else</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//ä¸ç›¸ç­‰ï¼Œåˆ°è¾¾è¾¹ç•Œ</span>    <span class="token keyword">return</span><span class="token punctuation">;</span>  <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token function">change</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>x<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></iframe><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> canvas </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Github </tag>
            
            <tag> åšå®¢ </tag>
            
            <tag> canvas </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SVG</title>
      <link href="/2025/06/05/svg/"/>
      <url>/2025/06/05/svg/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸€-åŸºç¡€ç¯‡"><a href="#ä¸€-åŸºç¡€ç¯‡" class="headerlink" title="ä¸€ åŸºç¡€ç¯‡"></a>ä¸€ åŸºç¡€ç¯‡</h1><h2 id="1-æ¦‚è¿°"><a href="#1-æ¦‚è¿°" class="headerlink" title="1 æ¦‚è¿°"></a>1 æ¦‚è¿°</h2><p><strong>S</strong>calable <strong>V</strong>ector <strong>G</strong>raphics(å¯ç¼©æ”¾çš„çŸ¢é‡å›¾å½¢)</p><blockquote><p><strong>å›¾å½¢å’Œå›¾åƒ</strong></p></blockquote><ul><li>å›¾å½¢ ï¼š æ˜¯ç”± è¢«ç§°ä¸ºçŸ¢é‡çš„æ•°å­¦å¯¹è±¡ æ‰€å®šä¹‰ç‚¹ï¼Œçº¿ï¼Œé¢ç­‰æ‰€æç»˜è€Œæˆã€‚</li><li>å›¾åƒ ï¼š åˆç§°ä¸ºæ …æ ¼å›¾ï¼Œç‚¹é˜µå›¾ï¼Œä½å›¾æˆ–åƒç´ å›¾ï¼Œç”¨åƒç´ æè¿°å›¾åƒä¸­æ¯ä¸€ä¸ªç‚¹é¢œè‰²å’Œäº®åº¦ç­‰ä¿¡æ¯ã€‚</li></ul><blockquote><p><strong>svg ç‰¹ç‚¹</strong></p></blockquote><p>svg ä½¿ç”¨ xml ç»˜åˆ¶å›¾å½¢ ï¼ˆcanvas ç»˜åˆ¶å›¾å½¢ï¼‰</p><ul><li><p>å¯ä»¥ä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨åˆ›å»ºå’Œä¿®æ”¹å›¾å½¢ã€‚</p></li><li><p>å› ä¸ºæ˜¯æè¿°çš„å›¾å½¢ï¼Œ æµè§ˆå™¨ä¼šæ ¹æ®æè¿°æ¥ç»˜åˆ¶å›¾å½¢ï¼Œè€Œä¸æ˜¯ä½¿ç”¨åƒç´ å¡«å……ç©ºé—´ï¼Œæ‰€ä»¥ svg é€‚åˆä¸åŒå¤§å°çš„å±å¹•ã€‚</p></li><li><p>å› ä¸ºæ˜¯ xml è¯­è¨€æè¿°çš„å›¾å½¢ï¼Œ å›¾å½¢ä¸­çš„éƒ¨åˆ†éƒ½æ˜¯ç”±æ ‡ç­¾ç»„æˆï¼Œå…¶ä¸­æ¯ä¸€ä¸ªæ ‡ç­¾éƒ½å¯ä»¥ä½¿ç”¨ javascript å’Œ css æ§åˆ¶ä¸äº¤äº’ã€‚</p></li><li><p>åŒæ—¶ svg æä¾›äº†å¼ºå¤§çš„æ»¤é•œåŠŸèƒ½ï¼Œå¯ä»¥ç»˜åˆ¶æ›´é€¼çœŸï¼Œæ›´å¤æ‚çš„å›¾å½¢æ•ˆæœã€‚</p></li><li><p>2003 æˆä¸º w3c æ ‡å‡†ï¼Œ ç›®å‰ç»å¤§å¤šæ•°çš„æµè§ˆå™¨éƒ½æ”¯æŒ svg ç»˜å›¾ã€‚</p></li><li><p>ç›®å‰åœ¨å¯è§†åŒ–é¢†åŸŸä½¿ç”¨éå¸¸é¢‘ç¹ï¼Œsvg å¯ä»¥å•ç‹¬ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥å’Œ d3 , echarts ç­‰æŠ€æœ¯é…åˆåº”ç”¨ã€‚</p></li><li><p>ä¹Ÿæ˜¯è§£å†³ç½‘ç«™å›¾æ ‡é—®é¢˜çš„æœ€ä½³è§£å†³æ–¹æ¡ˆ</p></li></ul><blockquote><p><strong>svg ä¸ canvas ç»˜å›¾çš„å·®å¼‚</strong></p></blockquote><table><thead><tr><th>SVG</th><th>Canvas</th></tr></thead><tbody><tr><td>2003 æˆä¸º w3c æ ‡å‡†</td><td>html5 æ–°æ ‡ç­¾</td></tr><tr><td>ç»˜åˆ¶çŸ¢é‡å›¾</td><td>ç»˜åˆ¶ä½å›¾</td></tr><tr><td>æ”¾ç¼©ä¸ä¼šå¯¼è‡´å¤±çœŸ</td><td>æ”¾ç¼©ä¼šå¯¼è‡´å¤±çœŸ</td></tr><tr><td>å¯¹ï¼ˆå›¾å½¢ï¼‰æ ‡ç­¾è¿›è¡Œæ“ä½œï¼Œæ–¹ä¾¿ï¼Œçµæ´»</td><td>å¯¹åƒç´ ç‚¹è¿›è¡Œæ“ä½œï¼Œæ•ˆæœæ›´ç»†è…»ï¼Œä¸æ˜“æ“ä½œ</td></tr><tr><td>äº¤äº’æ€§å¼ºï¼Œå®¹æ˜“å®ç°åŠ¨ç”»</td><td>åŠ¨ç”»é€»è¾‘å®ç°å¤æ‚</td></tr><tr><td>å­˜åœ¨ä¸€å®šçš„æ€§èƒ½é—®é¢˜</td><td>æ€§èƒ½ç•¥é«˜ä¸€äº›</td></tr><tr><td>é€‚åˆç»˜åˆ¶åœ°å›¾ï¼Œå›¾æ ‡ç­‰</td><td>é€‚åˆç»˜åˆ¶å›¾è¡¨ï¼Œåˆ¶ä½œæ¸¸æˆã€‚</td></tr><tr><td>ä¸æ˜“ç»˜åˆ¶ 3d å›¾å½¢</td><td>æä¾›äº†ç»˜åˆ¶ 3d å›¾å½¢çš„ api</td></tr></tbody></table><h2 id="2-svg-ä½¿ç”¨"><a href="#2-svg-ä½¿ç”¨" class="headerlink" title="2 svg ä½¿ç”¨"></a>2 svg ä½¿ç”¨</h2><p><strong>æµè§ˆå™¨ç›´æ¥æ‰“å¼€</strong></p><blockquote><p>svg æœ¬èº«æ˜¯ xml è¯­æ³•æ–‡ä»¶ï¼Œéœ€è¦æŒ‡å®šæ¸²æŸ“è§„åˆ™æ‰å¯ä»¥æ˜¾ç¤ºå›¾å½¢æ•ˆæœ</p><p><code>&lt;svg xmlns="http://www.w3.org/2000/svg"&gt;</code></p></blockquote><p><strong>åµŒå…¥ html ç½‘é¡µ</strong></p><ol><li><p>ä½¿ç”¨<code>&lt;img&gt;</code>å¼•å…¥ ï¼Œæ— æ³•å¼•å…¥æºç ï¼Œ ä¸èƒ½é€šè¿‡ css å’Œ js æ“ä½œ</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1.svg<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>ç›´æ¥åµŒå…¥ svg æºç </p></li><li><p>ä½¿ç”¨<code>&lt;iframe&gt;</code>å¼•å…¥ï¼Œå¯ä»¥é€šè¿‡ js æ“ä½œå¼•å…¥æ–‡æ¡£å†…å®¹ï¼Œä»è€Œæ§åˆ¶ svg æ•ˆæœ</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1.svg<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>300<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>300<span class="token punctuation">"</span></span> <span class="token attr-name">frameborder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">  <span class="token keyword">const</span> frame <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"iframe"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  frame<span class="token punctuation">.</span>onload <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> childDoc <span class="token operator">=</span> frame<span class="token punctuation">.</span>contentDocument<span class="token punctuation">;</span>    <span class="token keyword">const</span> array <span class="token operator">=</span> childDoc<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">".st0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    array<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>      e<span class="token punctuation">.</span>style<span class="token punctuation">.</span>fill <span class="token operator">=</span> <span class="token string">"#afc"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>ä½¿ç”¨<code>&lt;object&gt;</code>å¼•å…¥</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>object</span> <span class="token attr-name">data</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1.svg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>object</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li></ol><blockquote><p>ä½¿ç”¨ iframe å’Œ object å¼•å…¥æ—¶ï¼Œéœ€è¦æ³¨æ„åŒæºé—®é¢˜ï¼Œå¦åˆ™æ— æ³•é€šè¿‡ js è·å¾—å†…éƒ¨ document å¯¹è±¡ã€‚</p><p>å®é™…å¼€å‘ä¸­ä¸æ¨èä¼˜å…ˆä½¿ç”¨ï¼Œ</p></blockquote><h2 id="3-svg-å‡†å¤‡"><a href="#3-svg-å‡†å¤‡" class="headerlink" title="3 svg å‡†å¤‡"></a>3 svg å‡†å¤‡</h2><h3 id="1ï¼‰-åæ ‡ç³»"><a href="#1ï¼‰-åæ ‡ç³»" class="headerlink" title="1ï¼‰ åæ ‡ç³»"></a>1ï¼‰ åæ ‡ç³»</h3><p>ç»˜åˆ¶äº† 100 * 100 åæ ‡ç³»ã€‚</p><p>å·¦ä¸Šè§’åŸç‚¹ï¼ˆ0,0ï¼‰ ï¼Œ å‘å³ä¸º x æ­£è½´ï¼Œå‘ä¸‹ä¸º y æ­£è½´</p><p>è¿™ä¸ªåæ ‡ç³»å¯¹æˆ‘ä»¬æ¥ä¸‹æ¥çš„å›¾å½¢ç»˜åˆ¶æ²¡æœ‰ä»»ä½•å½±å“ï¼Œåªæ˜¯æ–¹ä¾¿è§‚å¯Ÿã€‚</p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/001.png" alt="1680602173270" style="zoom:50%;"><h3 id="2ï¼‰äº†è§£-svg-æ ¹å…ƒç´ "><a href="#2ï¼‰äº†è§£-svg-æ ¹å…ƒç´ " class="headerlink" title="2ï¼‰äº†è§£ svg æ ¹å…ƒç´ "></a>2ï¼‰äº†è§£ svg æ ¹å…ƒç´ </h3><p><strong>svg æ ‡ç­¾ä½ç½®</strong></p><p>å†™åœ¨.svg æ–‡ä»¶ä¸­ï¼Œä½œä¸ºæ ¹æ ‡è®°ï¼Œè¦æ±‚æœ‰ä¸”åªæœ‰ä¸€ä¸ªã€‚</p><p>å†™åœ¨.html æ–‡ä»¶ä¸­ï¼Œå¯ä»¥å†™å¤šä¸ªæ ‡è®°ï¼Œè¡¨ç¤ºåµŒå…¥äº†å¤šä¸ª svg å›¾ç‰‡ ï¼Œ æ¯ä¸€ä¸ª svg éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„åŒºåŸŸã€‚</p><p><strong>åæ ‡ç³»</strong></p><p>svg ä¸­æ¯ä¸€ä¸ªå›¾å½¢çš„ç»˜åˆ¶éƒ½ä¼šåŸºäºä¸€ä¸ªåæ ‡ç³»ï¼ˆç³»ç»Ÿï¼‰ï¼Œéšå¼ã€‚</p><blockquote><p>è¿™æ˜¯çœŸæ­£çš„åæ ‡ç³»ï¼Œä¸Šé¢ç»˜åˆ¶çš„åæ ‡ç³»åªæ˜¯åŸºäºçœŸå®åæ ‡ç³»å½¢æˆçš„å›¾å½¢ï¼Œæ–¹ä¾¿ç†è§£ã€‚</p></blockquote><p><strong>viewBox å±æ€§</strong></p><p>è§†å›¾çª—å£ï¼Œè£…è½½ç»˜åˆ¶çš„å›¾å½¢ã€‚ å¯ä»¥è£…è½½æ•´ä¸ªå›¾å½¢ï¼Œä¹Ÿå¯ä»¥è£…è½½éƒ¨åˆ†å›¾å½¢ã€‚é€šè¿‡ x y width height å››ä¸ªå±æ€§å€¼æ¥æ§åˆ¶</p><ul><li><p>width å’Œ height ç”¨æ¥è®¾ç½®çª—å£çš„å®½é«˜</p></li><li><p>x å’Œ y è®¾ç½®çª—å£èµ·å§‹çš„ä½ç½®ã€‚å¦‚æœ x å’Œ y ä¸ºè´Ÿï¼Œ æœ€ç»ˆçš„è£…è½½çš„ç»“æœç›¸å½“äºå›¾å½¢å‘å³å‘ä¸‹ã€‚</p></li></ul><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0 0 100 100<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/002.png" alt="1680602415457" style="zoom:50%;"><p><strong>width å’Œ height å±æ€§</strong></p><p>è®¾ç½®è§†å£åŒºåŸŸçš„å¤§å°ï¼Œè®¾ç½®å¯è§†åŒºåŸŸçš„å¤§å°</p><p>viewbox çª—å£è£…è½½å®Œçš„å›¾å½¢ï¼Œéœ€è¦åœ¨è§†å£å±•ç¤º</p><p>åœ¨æ²¡æœ‰è®¾ç½® viewbox çš„æƒ…å†µä¸‹ï¼Œ viewbox è£…è½½çš„åŒºåŸŸå’Œè§†å£åŒºåŸŸç›¸åŒ</p><p>å¦‚æœè®¾ç½®äº† viewBoxï¼Œä¸”è£…è½½åŒºåŸŸçš„å¤§å°ä¸å¯è§†åŒºåŸŸçš„å¤§å°ä¸åŒï¼Œæ­¤æ—¶å°±ä¼šæŒ‰ç…§æ¯”ä¾‹ï¼Œå¯¹è£…è½½åŒºåŸŸå›¾å½¢æ”¾å¤§æˆ–ç¼©å°å±•ç¤º</p><blockquote><p>é€šè¿‡åæ ‡ç³»ï¼Œç»˜åˆ¶äº†ï¼ˆ100,100ï¼‰ r=100</p><p>è®¾ç½®çª—å£è£…è½½ 100,100 èŒƒå›´ï¼Œè£…è½½äº† 1/4 çš„åœ†ï¼Œä¹Ÿå°±æ˜¯å·¦ä¸Šè§’çš„åœ†</p><p>å°†çª—å£ä¸­è¿™ 1/4 ä¸ªåœ†ï¼Œæ”¾åˆ° 400*400 èŒƒå›´çš„è§†å£ä¸­å±•ç¤ºï¼Œæœ€ç»ˆè¿™ 1/4 åœ†ä¼šæ”¾å¤§ 4 å€å±•ç¤º</p></blockquote><ul><li>å¯ä»¥åˆç†çš„åˆ©ç”¨ viewBox å’Œ width ä¸ height å®ç°å›¾å½¢çš„æ”¾ç¼©</li></ul><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/003.png" alt="1680602581529" style="zoom:50%;"><h3 id="3ï¼‰-svg-æ’ä»¶"><a href="#3ï¼‰-svg-æ’ä»¶" class="headerlink" title="3ï¼‰ svg æ’ä»¶"></a>3ï¼‰ svg æ’ä»¶</h3><p>SVG æ”¯æŒæ ‡ç­¾è¡¥å…¨ï¼Œå±æ€§è¡¥å…¨ç­‰ã€‚ å¿…é¡»ä»¥<code>&lt;</code>å¼€å§‹</p><p>SVG Snippets æ”¯æŒæ ‡ç­¾åè¡¥å…¨æ ‡ç­¾ã€‚</p><p>SVG Preview é¢„è§ˆ svg æ•ˆæœ</p><h2 id="4-åŸºæœ¬å›¾å½¢"><a href="#4-åŸºæœ¬å›¾å½¢" class="headerlink" title="4 åŸºæœ¬å›¾å½¢"></a>4 åŸºæœ¬å›¾å½¢</h2><h3 id="1ï¼‰çŸ©å½¢"><a href="#1ï¼‰çŸ©å½¢" class="headerlink" title="1ï¼‰çŸ©å½¢"></a>1ï¼‰çŸ©å½¢</h3><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>x å’Œ y åæ ‡ç³»ä¸­çš„èµ·å§‹åæ ‡</p><p>width å’Œ height è®¾ç½®çŸ©å½¢çš„å®½é«˜</p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/004.png" alt="1680763280801" style="zoom:50%;"><blockquote><p>çŸ©å½¢é»˜è®¤æœ‰ä¸€ä¸ªé»‘è‰²çš„å¡«å……ï¼ˆèƒŒæ™¯è‰²ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ fill å’Œ stroke å±æ€§è®¾ç½®å¡«å……é¢œè‰²å’Œè¾¹æ¡†é¢œè‰²</p><p>fill=â€noneâ€ æ²¡æœ‰å¡«å……é¢œè‰²</p><p>æ‰€æœ‰å›¾å½¢éƒ½æœ‰ fill å’Œ stroke å±æ€§ã€‚</p></blockquote><p>ä½¿ç”¨ rx å’Œ ry è®¾ç½®åœ†è§’åŠå¾„</p><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>blue<span class="token punctuation">"</span></span> <span class="token attr-name">rx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">ry</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/005.png" alt="1680763300587" style="zoom:50%;"><h3 id="2ï¼‰åœ†å½¢"><a href="#2ï¼‰åœ†å½¢" class="headerlink" title="2ï¼‰åœ†å½¢"></a>2ï¼‰åœ†å½¢</h3><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fac<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fff<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>cx å’Œ cy åœ¨åæ ‡ç³»è®¾ç½®åŸç‚¹</p><p>r è®¾ç½®åœ†çš„åŠå¾„</p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/006.png" alt="1680763325284" style="zoom:50%;"><p><strong>æ¡ˆä¾‹ï¼šåœ†å½¢å’ŒçŸ©å½¢é…åˆï¼Œä½“ç°çŸ©å½¢åœ†è§’çš„è®¾ç½®</strong></p><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token attr-name">rx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">ry</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fac<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fff<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/007.png" alt="1680763338085" style="zoom:50%;"><h3 id="3ï¼‰æ¤­åœ†å½¢"><a href="#3ï¼‰æ¤­åœ†å½¢" class="headerlink" title="3ï¼‰æ¤­åœ†å½¢"></a>3ï¼‰æ¤­åœ†å½¢</h3><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ellipse</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">rx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">ry</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ellipse</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">rx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">ry</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#0f0<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>cx å’Œ cy åœ¨åæ ‡ç³»è®¾ç½®åŸç‚¹</p><p>rx å’Œ ry è®¾ç½® x è½´åŠå¾„å’Œ y è½´åŠå¾„</p><ul><li>åœ†å½¢ä»»æ„æ–¹å‘çš„åŠå¾„ç›¸åŒ</li><li>æ¤­åœ†å½¢ï¼Œ åˆ†ä¸ºé•¿è½´åŠå¾„å’ŒçŸ­è½´åŠå¾„</li></ul><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/008.png" alt="1680763379787" style="zoom:50%;"><h3 id="4ï¼‰çº¿æ¡"><a href="#4ï¼‰çº¿æ¡" class="headerlink" title="4ï¼‰çº¿æ¡"></a>4ï¼‰çº¿æ¡</h3><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>line</span> <span class="token attr-name">x1</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">y1</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>      <span class="token attr-name">x2</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>80<span class="token punctuation">"</span></span> <span class="token attr-name">y2</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>80<span class="token punctuation">"</span></span>      <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span>      <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>x1 y1 å’Œ x2 y2 è®¾ç½®çº¿æ®µçš„ä¸¤ä¸ªåæ ‡ç‚¹ï¼Œ ä¸¤ç‚¹ä¹‹é—´ç»˜åˆ¶çº¿æ®µã€‚</p><p>éœ€è¦è®¾ç½®çº¿æ¡çš„é¢œè‰²å’Œç²—ç»†</p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/009.png" alt="1680763409003" style="zoom:50%;"><blockquote><p>fill å±æ€§å¤±æ•ˆ</p></blockquote><h3 id="5ï¼‰æŠ˜çº¿"><a href="#5ï¼‰æŠ˜çº¿" class="headerlink" title="5ï¼‰æŠ˜çº¿"></a>5ï¼‰æŠ˜çº¿</h3><p>å¤šä¸ªç‚¹ï¼Œä¸€æ¬¡ç»˜åˆ¶ç›´çº¿ï¼Œæœ€ç»ˆå½¢æˆä¸€ä¸ªæŠ˜çº¿æ•ˆæœ</p><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>polyline</span> <span class="token attr-name">points</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10 10,30 30,40 80,50 30<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>points è®¾ç½®å¤šä¸ªç‚¹çš„åæ ‡å€¼é›†åˆã€‚ é›†åˆæ•°å€¼ä¸€å®šæ˜¯å¶æ•°ã€‚ æ¯ä¸€å¯¹è¡¨ç¤ºä¸€ä¸ªç‚¹åœ¨åæ ‡ï¼Œæ¯ä¸€ä¸ªå€¼å¯ä»¥ä½¿ç”¨ã€ç©ºæ ¼ã€‘æˆ–ã€é€—å·ã€‘éš”å¼€</p><p>éœ€è¦æè¾¹æ‰ä¼šæ˜¾ç¤ºæŠ˜çº¿æ•ˆæœ</p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/010.png" alt="1680763469045" style="zoom:50%;"><blockquote><p>é™¤ç›´çº¿æ•ˆæœä»¥å¤–ï¼Œ å…¶å®åæ ‡å’Œç»ˆæ­¢åæ ‡ä¹‹é—´ä¼šå½¢æˆä¸€ä¸ªåˆå›´åŒºåŸŸï¼Œ é»˜è®¤æœ‰å¡«å……é¢œè‰²ã€‚</p></blockquote><h3 id="6ï¼‰å¤šè¾¹å½¢"><a href="#6ï¼‰å¤šè¾¹å½¢" class="headerlink" title="6ï¼‰å¤šè¾¹å½¢"></a>6ï¼‰å¤šè¾¹å½¢</h3><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>polygon</span> <span class="token attr-name">points</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10 10,30 30,40 80,50 30<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¤šè¾¹å½¢ä¸æŠ˜çº¿çš„ç»˜åˆ¶ç±»ä¼¼ï¼Œä¸åŒåœ¨äºç»ˆç«¯èŠ‚ç‚¹å’Œèµ·å§‹èŠ‚ç‚¹è‡ªåŠ¨è”é€šï¼Œå®Œæˆé—­åˆï¼Œå¹¶æœ‰é»˜è®¤é¢œè‰²å¡«å……ã€‚</p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/011.png" alt="1680763503852" style="zoom:50%;"><h3 id="7ï¼‰ã€å°ä»»åŠ¡ã€‘"><a href="#7ï¼‰ã€å°ä»»åŠ¡ã€‘" class="headerlink" title="7ï¼‰ã€å°ä»»åŠ¡ã€‘"></a>7ï¼‰ã€å°ä»»åŠ¡ã€‘</h3><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/012.png" alt="1680751745483" style="zoom:67%;"><h2 id="5-path-è·¯å¾„ç»˜åˆ¶"><a href="#5-path-è·¯å¾„ç»˜åˆ¶" class="headerlink" title="5 path è·¯å¾„ç»˜åˆ¶"></a>5 path è·¯å¾„ç»˜åˆ¶</h2><p>æ ¹æ®ç‚¹è¿æ¥ï¼Œç»˜åˆ¶å„ç§å›¾å½¢</p><p>æ”¯æŒç›´çº¿ï¼ˆçº¿æ®µï¼ŒæŠ˜çº¿ï¼ŒçŸ©å½¢ï¼Œå¤šè¾¹å½¢ï¼‰ï¼Œæ›²çº¿ï¼ˆè´å¡å°”æ›²çº¿ï¼Œå¼§çº¿ï¼‰</p><h3 id="1ï¼‰ç»˜åˆ¶ç›´çº¿"><a href="#1ï¼‰ç»˜åˆ¶ç›´çº¿" class="headerlink" title="1ï¼‰ç»˜åˆ¶ç›´çº¿"></a>1ï¼‰ç»˜åˆ¶ç›´çº¿</h3><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M30 30 L60 30<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>line</span> <span class="token attr-name">x1</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">y1</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>      <span class="token attr-name">x2</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span> <span class="token attr-name">y2</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>      <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#0f0<span class="token punctuation">"</span></span>      <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>polyline</span> <span class="token attr-name">points</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30 50,60 50<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>d å±æ€§ ç±»ä¼¼äº æŠ˜çº¿ï¼ˆå¤šè¾¹å½¢ï¼‰ä¸­çš„ points å±æ€§ï¼Œ å¯ä»¥è®¾ç½®å¤šä¸ªåæ ‡ç‚¹ã€‚</p><p>ç”±äº path å¯ä»¥è®¾ç½®ä¸åŒçš„å›¾å½¢ï¼ˆæ›²çº¿ï¼‰ï¼Œä¸ä»…ä»…æ˜¯ç›´çº¿ã€‚ æ‰€ä»¥ä¸¤ä¸ªåæ ‡çš„è¿æ¥ä¼šæœ‰ä¸åŒçš„å…³é”®å­—è¡¨ç¤º</p><p>æ¥ä¸‹æ¥ç›´çº¿ç›¸å…³çš„å…³é”®å­—ï¼š</p><ul><li>M: â€œMove Toâ€ è®¾ç½®ç¬”è§¦æ‰€åœ¨çš„èµ·å§‹ä½ç½®ï¼ˆè¦ä»å“ªä¸ªåæ ‡ä½ç½®å¼€å§‹ç”»ï¼‰</li><li>Lï¼šâ€Line Toâ€ ç”»ä¸€æ¡ç›´çº¿åˆ°æŒ‡å®šçš„åæ ‡ä½ç½®</li></ul><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/013.png" alt="1680763552853" style="zoom:50%;"><blockquote><p>å¤šä¸ª Mã€‚ åœ¨ä¸€ä¸ª path è·¯å¾„ç»˜åˆ¶çš„å›¾å½¢ä¸­ï¼Œå¯ä»¥è®¾ç½®å¤šä¸ª Mï¼Œå®ç°ç§»åŠ¨ç¬”è§¦ï¼Œä»å¤šä¸ªç‚¹è¿›è¡Œç»˜åˆ¶</p></blockquote><pre class="line-numbers language-XML"><code class="language-XML"><path d="M40 30 L60 30 M30 50 L70 50 M50 30 L50 70"      fill="none" stroke="#00f" stroke-width="2" /><circle cx="40" cy="30" r="1" fill="#f00"/><circle cx="30" cy="50" r="1" fill="#f00"/><circle cx="50" cy="30" r="1" fill="#f00"/><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/014.png" alt="1680763629356" style="zoom:50%;"><blockquote><p>H å’Œ V å…³é”®å­—ã€‚H åªéœ€è¦æŒ‡å®šæ¨ªåæ ‡ï¼Œ è¡¨ç¤ºæ¨ªå‘ç”»çº¿ã€‚ V åªéœ€è¦æŒ‡å®šçºµåæ ‡ï¼Œ è¡¨ç¤ºçºµå‘ç”»çº¿</p></blockquote><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M30 30 H70 V70 H30<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/015.png" alt="1680763681482" style="zoom:50%;"><blockquote><p>Z æ”¾åœ¨æœ€åï¼Œä¸éœ€è¦è·Ÿåæ ‡ï¼Œè¡¨ç¤ºé¦–ä½åæ ‡é—­åˆ</p></blockquote><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M30 30 H70 V70 H30 Z<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/016.png" alt="1680763714190" style="zoom:50%;"><blockquote><p>ä¸Šè¿°çš„å…³é”®å­—å¤§å°å†™å«ä¹‰ä¸åŒ</p><p>M10 10 L20 20 ä»(10,10)ç‚¹ å‘(20,20)ç‚¹ç”»ç›´çº¿ â€” ç»å¯¹ä½ç½®</p><p>M10 10 l20 20 ä»(10,10)ç‚¹ï¼Œæ–°ä½ç½®è·åŸä½ç½® x è½´è·ç¦»ä¸º 20ï¼Œ y è½´è·ç¦» 20 â€” ç›¸å¯¹ä½ç½®</p></blockquote><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token comment" spellcheck="true">&lt;!-- enter your code  --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M10 10 L40 20<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M10 10 l40 20<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#0f0<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M10 10 L40 20 m20 20 L50 50<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/017.png" alt="1680763760836" style="zoom:50%;"><h3 id="2ï¼‰ç»˜åˆ¶å¼§çº¿"><a href="#2ï¼‰ç»˜åˆ¶å¼§çº¿" class="headerlink" title="2ï¼‰ç»˜åˆ¶å¼§çº¿"></a>2ï¼‰ç»˜åˆ¶å¼§çº¿</h3><p>åœ†ä¸Šä¸¤ç‚¹ä¹‹é—´çš„éƒ¨åˆ†ç§°ä¸º<strong>åœ†å¼§</strong></p><p><strong>ç»˜åˆ¶åŸç†ï¼š</strong>å®šä¹‰ä¸¤ä¸ªç‚¹å’Œä¸€ä¸ªåœ†ï¼Œè¿™ä¸ªåœ†åœ¨ç»˜åˆ¶è¿‡ç¨‹ä¸­ä¼šè‡ªåŠ¨çš„ç»è¿‡ä¸¤ä¸ªç‚¹ï¼Œä»è€Œå½¢æˆäº†å¼§ã€‚</p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/018.png" alt="1681097175500" style="zoom:50%;"><p><strong>ç»˜åˆ¶æ¡ä»¶ï¼š</strong></p><ol><li><p>ç¡®å®šä¸¤ä¸ªç‚¹(x1,y1)å’Œ(x2,y2)</p></li><li><p>ç¡®å®šåœ†çš„åŠå¾„ rx å’Œ ry ï¼ˆæ­£åœ†æˆ–æ¤­åœ†ï¼‰ï¼Œä¸éœ€è¦ç¡®å®šåœ†å¿ƒï¼Œå› ä¸ºä¸Šé¢å®šä¹‰çš„ä¸¤ä¸ªç‚¹å°±å¯ä»¥å¤§çº¦ç¡®å®šåœ†çš„ä½ç½®äº†</p><p><strong>æ³¨æ„ 1ï¼š</strong>ä¸¤ç‚¹çš„è·ç¦»åªè¦&lt;ç›´å¾„ï¼Œå°±ä¼šäº§ç”Ÿä¸¤ä¸ªä½ç½®çš„åœ†ï¼ˆåä¸Šï¼Œåä¸‹ï¼‰</p><p><strong>æ³¨æ„ 2ï¼š</strong>ä¸¤ä¸ªåœ†ä¼šäº§ç”Ÿ 4 ä¸ªå¼§</p><p><strong>æ³¨æ„ 3ï¼š</strong>æœ‰ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œå°±æ˜¯ä¸¤ä¸ªç‚¹æ°å¥½æ˜¯ç›´å¾„ä¸Šçš„ä¸¤ä¸ªç«¯ç‚¹ï¼Œå°±åªä¼šå½¢æˆä¸€ä¸ªåœ†ï¼Œ2 ä¸ªå¼§ã€‚</p></li><li><p>ç¡®å®šç”»å¼§çš„æ–¹å‘ï¼Œé¡ºæ—¶é’ˆæˆ–é€†æ—¶é’ˆæ–¹å‘ï¼Œæ¯ä¸ªæ–¹å‘éƒ½å¯èƒ½ç»˜åˆ¶å‡ºä¸¤ä¸ªå¼§ã€‚</p></li><li><p>ç¡®å®šç»˜åˆ¶å¼§çš„å¤§å°ï¼Œå¤§å¼§æˆ–å°å¼§</p></li><li><p>ç¡®å®šåœ†çš„æ—‹è½¬è§’åº¦ã€‚å¯¹(æ¤­)åœ†è¿›è¡Œæ—‹è½¬ï¼Œä½¿å¾—æ—‹è½¬åçš„åœ†ç»è¿‡å®šä¹‰çš„ä¸¤ç‚¹ï¼Œä»è€Œå½¢æˆæ›´ç‰¹åˆ«çš„å¼§</p></li></ol><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/019.png" alt="1681098187277" style="zoom:50%;"><p><strong>ä½¿ç”¨ A å…³é”®å­—å®ç°å¼§å½¢çš„ç»˜åˆ¶</strong></p><pre class="line-numbers language-txt"><code class="language-txt">"A rx ry rotateæ—‹è½¬è§’åº¦ arc-flagå¼§å¤§å°çŠ¶æ€(0/1) sweep-flagç»˜åˆ¶æ–¹å‘(0/1) x2 y2"<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>A å…³é”®å­—ç»˜åˆ¶å¼§çº¿çš„æ—¶å€™ï¼Œä¸èƒ½æŒ‡å®šèµ·å§‹ç‚¹åæ ‡ã€‚èµ·å§‹ç‚¹åæ ‡æ˜¯ç”±ä¹‹å‰çš„ç»˜åˆ¶å†³å®šçš„ã€‚ æ¯”å¦‚ M,L</p></blockquote><blockquote><p>arc-flag 0 è¡¨ç¤ºå°å¼§ï¼Œ 1 è¡¨ç¤ºå¤§å¼§</p><p>sweep-flag 0 è¡¨ç¤ºé€†æ—¶é’ˆï¼Œ 1 è¡¨ç¤ºé¡ºæ—¶é’ˆ</p></blockquote><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M30 50 A15 15 0 0 1 60 50<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M30 50 A15 15 0 0 0 60 50<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#0f0<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/20.png" alt="1681101565633" style="zoom:50%;"><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M30 50 A15 30 0 1 1 60 50<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fac<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M30 50 A15 30 0 0 0 60 50<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fac<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M30 50 A15 30 45 1 1 60 50<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M30 50 A15 30 45 0 0 60 50<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#0f0<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/21.png" alt="1681101609617" style="zoom:50%;"><pre class="line-numbers language-xml"><code class="language-xml"><span class="token comment" spellcheck="true">&lt;!-- é¡ºæ—¶é’ˆ(1)å¤§å¼§(1)+å°å¼§(0) --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M30 50 A20 20 0 1 1 60 50<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fac<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M30 50 A20 20 0 0 1 60 50<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#caf<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token comment" spellcheck="true">&lt;!-- é€†æ—¶é’ˆ(0)å¤§å¼§(1)+å°å¼§(0) --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M30 50 A20 20 0 1 0 60 50<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#cac<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M30 50 A20 20 0 0 0 60 50<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#faa<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/22.png" alt="1681101652834" style="zoom:50%;"><h3 id="3ï¼‰ç»˜åˆ¶æ›²çº¿"><a href="#3ï¼‰ç»˜åˆ¶æ›²çº¿" class="headerlink" title="3ï¼‰ç»˜åˆ¶æ›²çº¿"></a>3ï¼‰ç»˜åˆ¶æ›²çº¿</h3><p>svg æ”¯æŒçš„æ˜¯è´å¡å°”æ›²çº¿ç»˜åˆ¶ ï¼ˆäºŒæ¬¡è´å¡å°”æ›²çº¿ï¼Œä¸‰æ¬¡è´å¡å°”æ›²çº¿ï¼‰</p><p>è´å¡å°”æ›²çº¿ç®€å•æ¥è¯´ï¼Œæ˜¯ç”± 2 ä¸ªèµ·ç‚¹ç»ˆç‚¹ å’Œ n ä¸ªæ§åˆ¶ç‚¹é…åˆç»˜åˆ¶å‡ºçš„æ›²çº¿å›¾å½¢</p><p>äºŒæ¬¡è´å¡å°”å’Œä¸‰æ¬¡è´å¡å°”ï¼Œè¡¨ç¤ºæœ‰ 1 ä¸ªæ§åˆ¶ç‚¹ å’Œ 2 ä¸ªæ§åˆ¶ç‚¹ã€‚</p><p><strong>äºŒæ¬¡è´å¡å°”æ›²çº¿çš„ç»˜åˆ¶åŸç†ï¼š</strong></p><p>éœ€è¦ç¡®å®šä¸€ä¸ªèµ·ç‚¹åæ ‡ p0 å’Œä¸€ä¸ªç»ˆç‚¹åæ ‡ p2ï¼Œå†ç¡®å®šä¸€ä¸ªæ§åˆ¶ç‚¹åæ ‡ p1ã€‚</p><p>ä¾æ¬¡è¿çº¿ p0p1 , p1p2</p><p>ç¡®å®šä¸€ä¸ªå‚æ•° t [0.0,1.0]</p><p>åœ¨ p0p1 ä¸Šç¡®å®šä¸€ä¸ªç‚¹ p01 , ä½¿å¾— p0 ä¸ p01 ä¹‹é—´çš„è·ç¦»/p0 ä¸ p1 ä¹‹é—´çš„å…·ä½“ = t</p><p>åŒæ—¶åœ¨ p1p2 ä¸Šç¡®å®šä¸€ä¸ªç‚¹ p12ï¼Œä½¿å¾— p1 ä¸ p12 ä¹‹é—´çš„è·ç¦»/p1 ä¸ p2 ä¹‹é—´çš„å…·ä½“ = t</p><p>è¿æ¥ p01 å’Œ p12</p><p>åœ¨ p01p12 çº¿æ®µä¸Šå†ç¡®å®šä¸€ä¸ªç‚¹ p02,ä½¿å¾— p01 ä¸ p02 ä¹‹é—´çš„è·ç¦»/p01 ä¸ p12 ä¹‹é—´çš„å…·ä½“ = t</p><p>æŒ‰ç…§ä¸Šè¿°è§„å¾‹ï¼Œå½“ t åœ¨ 0-1 ä¹‹é—´å˜åŒ–æ—¶ï¼Œå°±å¯ä»¥è·å¾— n å¤šä¸ª p02 ç‚¹ï¼Œè¿™ n ä¸ªè¿ç»­çš„ p02 å°±ä¼šå½¢æˆä¸€ä¸ªå…‰æ»‘çš„æ›²çº¿</p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/23.png" alt="1681109205909" style="zoom:50%;"><p><strong>ä¸‰æ¬¡è´å¡å°”æ›²çº¿ç»˜åˆ¶åŸç†ï¼š</strong></p><p>ä¸äºŒæ¬¡è´å¡å°”çš„ç»˜åˆ¶æœºåˆ¶ç›¸åŒï¼Œåªä¸è¿‡ç»è¿‡çš„çº¿æ®µå’Œç‚¹ä¼šæ¯”äºŒæ¬¡è´å¡å°”æ›²çº¿å¤šä¸€äº›ã€‚</p><p>ä¸¤ä¸ªèµ·å§‹ç‚¹å’Œç»ˆç‚¹ p0,p3 ä¸¤ä¸ªæ§åˆ¶ç‚¹ p1,p2</p><p>æŒ‰ç…§æ¯”ä¾‹ tï¼Œåœ¨ p0p1 ä¸­æ‰¾åˆ° p01ï¼Œåœ¨ p1p2 ä¸­æ‰¾åˆ° p12 , åœ¨ p2p3 ä¸­æ‰¾åˆ° p23</p><p>æŒ‰ç…§æ¯”ä¾‹ tï¼Œåœ¨ p01p12 ä¸­æ‰¾åˆ° p02 , åœ¨ p12 å’Œ p23 ä¸­æ‰¾åˆ° p13</p><p>æŒ‰ç…§æ¯”ä¾‹ tï¼Œåœ¨ p02p13 ä¸­æ‰¾åˆ° p03. åœ¨ t å˜åŒ–æ—¶ï¼Œä¼šæœ‰ n ä¸ªè¿ç»­çš„ p03ï¼Œå½¢æˆæ›²çº¿ã€‚</p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/24.png" alt="1681117186446" style="zoom:50%;"><p><strong>ä½¿ç”¨ Q å…³é”®å­—ç»˜åˆ¶äºŒæ¬¡è´å¡å°”æ›²çº¿</strong></p><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M0 0 L20 50 Q50 20,80 50<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>line</span> <span class="token attr-name">x1</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">y1</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>      <span class="token attr-name">x2</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">y2</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span>      <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#c00<span class="token punctuation">"</span></span>      <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>line</span> <span class="token attr-name">x1</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">y1</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>      <span class="token attr-name">x2</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>80<span class="token punctuation">"</span></span> <span class="token attr-name">y2</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span>      <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#c00<span class="token punctuation">"</span></span>      <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>line</span> <span class="token attr-name">x1</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">y1</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>35<span class="token punctuation">"</span></span>      <span class="token attr-name">x2</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span> <span class="token attr-name">y2</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>35<span class="token punctuation">"</span></span>      <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#0f0<span class="token punctuation">"</span></span>      <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>80<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>ä¸å¼§çº¿ç»˜åˆ¶æ—¶ç›¸åŒï¼Œèµ·å§‹ç‚¹åæ ‡ä¸åœ¨ Q å…³é”®å­—ä¸­è®¾ç½®ï¼Œè€Œæ˜¯ç”±ä¸Šä¸€æ¬¡çš„ç»˜åˆ¶ç»“å°¾ï¼Œæˆ– M æ§åˆ¶ã€‚</p><p>æ‰€ä»¥ Q å…³é”®å­—ä¸­ï¼Œåªè®¾ç½®æ§åˆ¶ç‚¹ å’Œ ç»ˆç‚¹åæ ‡ã€‚</p></blockquote><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/25.png" alt="1681111990882" style="zoom:50%;"><blockquote><p>ä½¿ç”¨ T å…³é”®å­—ï¼Œåœ¨æ›²çº¿åè·Ÿç€ç»˜åˆ¶ä¸€ä¸ªæ–œç‡å¯¹ç§°çš„è¿ç»­çš„äºŒæ¬¡è´å¡å°”æ›²çº¿</p><p>ç´§è·Ÿç€çš„è¿™ä¸ªäºŒæ¬¡è´å¡å°”æ›²çº¿ä¸éœ€è¦è®¾ç½®æ§åˆ¶ç‚¹ï¼Œ æ˜¯ç”±å‰ä¸€ä¸ªæ›²çº¿çš„æ§åˆ¶ç‚¹å¯¹ç§°è€Œæ¥ï¼Œåªéœ€è¦è®¾ç½®ç»ˆç‚¹åæ ‡</p></blockquote><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M20 50Q30 30,40 50T60 50<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/26.png" alt="1681112001793" style="zoom:50%;"><p><strong>ä½¿ç”¨ C å…³é”®å­—ç»˜åˆ¶ä¸‰æ¬¡è´å¡å°”æ›²çº¿</strong></p><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M20 50 C30 30,50 70,60 50<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>70<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/27.png" alt="1681112937626" style="zoom:50%;"><blockquote><p>ä½¿ç”¨ S å…³é”®å­—ï¼Œç»˜åˆ¶è¿ç»­çš„ä¸‰æ¬¡è´å¡å°”æ›²çº¿ã€‚ ä¸ T å…³é”®å­—ç±»ä¼¼</p><p>ç¬¬ä¸€ä¸ªæ§åˆ¶ç‚¹ä¸éœ€è¦è®¾ç½®ï¼Œç”±ä¸Šä¸€æ¬¡æ›²çº¿çš„æ§åˆ¶ç‚¹å¯¹ç§°è·å¾—ã€‚åªéœ€è¦æä¾›ç¬¬äºŒä¸ªæ§åˆ¶ç‚¹å’Œç»ˆç‚¹å³å¯ã€‚</p></blockquote><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M20 50 C30 30,50 70,60 50S80 70 , 90 50<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>70<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/28.png" alt="1681112948496" style="zoom:50%;"><h3 id="4ã€å°ä»»åŠ¡ã€‘"><a href="#4ã€å°ä»»åŠ¡ã€‘" class="headerlink" title="4ã€å°ä»»åŠ¡ã€‘"></a>4ã€å°ä»»åŠ¡ã€‘</h3><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/29.png" alt="1681182053351"></p><h2 id="6-å¡«å……ä¸æè¾¹"><a href="#6-å¡«å……ä¸æè¾¹" class="headerlink" title="6 å¡«å……ä¸æè¾¹"></a>6 å¡«å……ä¸æè¾¹</h2><h3 id="1ï¼‰fill-å¡«å……å±æ€§"><a href="#1ï¼‰fill-å¡«å……å±æ€§" class="headerlink" title="1ï¼‰fill å¡«å……å±æ€§"></a>1ï¼‰fill å¡«å……å±æ€§</h3><p>fill ï¼šå›¾å½¢åŒºåŸŸçš„é¢œè‰²å¡«å……ï¼ˆèƒŒæ™¯é¢œè‰²ï¼‰</p><p>fill-opacity : è®¾ç½®å¡«å……é¢œè‰²çš„é€æ˜åº¦</p><p>fill-rule ï¼š è®¾ç½®å›¾å½¢ç»˜åˆ¶è¿‡ç¨‹ä¸­ï¼Œé‡å éƒ¨åˆ†çš„æ‰€å±è§„åˆ™</p><ul><li>é€šè¿‡ä¸€äº›è§„åˆ™ï¼Œç¡®å®šé‡å çš„åŒºåŸŸæ˜¯å¦å±äºå½“å‰å›¾å½¢ï¼Œä»è€Œä½¿å¾—å¡«å……æœ‰æ•ˆæˆ–å¤±æ•ˆ</li><li><code>fill-rule="nonzero"</code>æŒ‰ç…§é¡ºæ—¶é’ˆç»˜åˆ¶å›¾å½¢æ—¶ç»è¿‡è¿™ç‰‡åŒºåŸŸï¼Œè®¡æ•°å™¨+1ï¼Œé€†æ—¶é’ˆç»˜åˆ¶å›¾å½¢æ—¶ç»è¿‡è¿™ç‰‡åŒºåŸŸï¼Œè®¡æ•°å™¨-1ï¼Œæœ€ç»ˆçš„ç»“æœä¸º 0ï¼Œè¡¨ç¤ºé‡å åŒºåŸŸä¸å±äºå›¾å½¢ï¼ˆfill å¤±æ•ˆï¼‰ã€‚ç»“æœé 0ï¼Œè¡¨ç¤ºé‡å åŒºåŸŸå±äºå›¾å½¢ï¼ˆfill ç”Ÿæ•ˆï¼‰</li><li><code>fill-rule="evenodd"</code> ç»˜åˆ¶è¿‡ç¨‹ä¸­ï¼Œç»è¿‡ä¸€æ¬¡åŒºåŸŸï¼Œè®¡æ•°å™¨+1. æœ€ç»ˆçš„æ•°é‡ä¸ºå¥‡æ•°ï¼Œè¡¨ç¤ºåœ¨å›¾å½¢å†…ï¼Œå¶æ•°è¡¨ç¤ºåœ¨å›¾å½¢å¤–</li></ul><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fac<span class="token punctuation">"</span></span> <span class="token attr-name">fill-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/30.png" alt="1681194514248" style="zoom:50%;"><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M30 50A20 20 0 0 1 70 50A20 20 0 0 1 30 50         M40 50A10 10 0 0 0 60 50A10 10 0 0 0 40 50         M45 50A5 5 0 0 0 55 50A5 5 0 0 0 45 50<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fac<span class="token punctuation">"</span></span>  <span class="token attr-name">fill-rule</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>nonzero<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸€å…±ç»˜åˆ¶äº†ä¸‰ä¸ªåœ†ï¼Œåˆ†åˆ«ä¸ºåœ† 30ï¼Œåœ† 40ï¼Œåœ† 45</p><p>é¡ºæ—¶é’ˆç»˜åˆ¶åœ† 30 æ—¶ï¼Œåœ† 30 åŒºåŸŸ+1=1ï¼Œåœ† 40 åŒºåŸŸ+1=1 ï¼Œ åœ† 45 åŒºåŸŸ+1=1</p><p>é€†æ—¶é’ˆç»˜åˆ¶åœ† 40 æ—¶ï¼Œåœ† 30 åŒºåŸŸ=1 ï¼Œ åœ† 40 åŒºåŸŸ-1=0 ï¼Œ åœ† 45 åŒºåŸŸ-1=0</p><p>é¡ºæ—¶é’ˆç»˜åˆ¶åœ† 45 æ—¶ï¼Œåœ† 30 åŒºåŸŸ=1ï¼Œåœ† 40 åŒºåŸŸ=0ï¼Œåœ† 45 åŒºåŸŸ+1=1</p><p>é 0 è¡¨ç¤ºåœ¨å›¾å½¢å†…ï¼Œfill ç”Ÿæ•ˆï¼› 0 è¡¨ç¤ºåœ¨å›¾å½¢å¤–ï¼Œfill å¤±æ•ˆã€‚</p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/31.png" alt="1681194727176" style="zoom:50%;"><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M30 50A20 20 0 0 1 70 50A20 20 0 0 1 30 50         M40 50A10 10 0 0 1 60 50A10 10 0 0 1 40 50         M45 50A5 5 0 0 1 55 50A5 5 0 0 1 45 50<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fac<span class="token punctuation">"</span></span>  <span class="token attr-name">fill-rule</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>evenodd<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ç»˜åˆ¶åœ† 30 æ—¶ï¼Œ åœ† 30 åŒºåŸŸ+1=1 ï¼Œ åœ† 40 åŒºåŸŸ+1=1 ï¼Œ åœ† 45 åŒºåŸŸ+1=1</p><p>ç»˜åˆ¶åœ† 40 æ—¶ï¼Œåœ† 30 åŒºåŸŸ=1 ï¼Œ åœ† 40 åŒºåŸŸ+1=2 ï¼Œ åœ† 45 åŒºåŸŸ+1=2</p><p>ç»˜åˆ¶åœ† 45 æ—¶ï¼Œåœ† 30 åŒºåŸŸ=1ï¼Œåœ† 40 åŒºåŸŸ=2ï¼Œåœ† 45 åŒºåŸŸ+1=3</p><p>å¥‡æ•°è¡¨ç¤ºåœ¨å›¾å½¢å†…ï¼Œfill ç”Ÿæ•ˆï¼›å¶æ•°è¡¨ç¤ºåœ¨å›¾å½¢å¤–ï¼Œfill å¤±æ•ˆ</p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/32.png" alt="1681194944814" style="zoom:50%;"><h3 id="2ï¼‰stroke-æè¾¹å±æ€§"><a href="#2ï¼‰stroke-æè¾¹å±æ€§" class="headerlink" title="2ï¼‰stroke æè¾¹å±æ€§"></a>2ï¼‰stroke æè¾¹å±æ€§</h3><p>stroke : è®¾ç½®æè¾¹é¢œè‰²ï¼ˆè¾¹æ¡†ï¼‰</p><p>stroke-width : è®¾ç½®æè¾¹ç²—ç»†</p><p>stroke-opacity : è®¾ç½®æè¾¹é¢œè‰²çš„é€æ˜åº¦</p><p>stroke-linecap : è®¾ç½®çº¿æ®µä¸¤ç«¯çš„å½¢çŠ¶</p><ul><li>butt ç›´è¾¹ï¼ˆé»˜è®¤ï¼‰</li><li>round åœ†è§’è¾¹</li><li>square è§†è§‰æ•ˆæœä¸ butt ç±»ä¼¼ï¼Œ ä¸¤ç«¯ä½¿ç”¨äº†çŸ©å½¢å½¢çŠ¶ã€‚ ä¸ butt æ•ˆæœç›¸æ¯”ä¼šé•¿å‡ºä¸€å—ã€‚</li></ul><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>line</span> <span class="token attr-name">x1</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">y1</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">x2</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>80<span class="token punctuation">"</span></span> <span class="token attr-name">y2</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>3<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-linecap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>butt<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>line</span> <span class="token attr-name">x1</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">y1</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">x2</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>80<span class="token punctuation">"</span></span> <span class="token attr-name">y2</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>3<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-linecap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>round<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>line</span> <span class="token attr-name">x1</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">y1</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>80<span class="token punctuation">"</span></span> <span class="token attr-name">x2</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>80<span class="token punctuation">"</span></span> <span class="token attr-name">y2</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>80<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>3<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-linecap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>square<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/33.png" alt="1681198982977" style="zoom:50%;"><p>stroke-linejoin : è®¾ç½®æŠ˜çº¿è¿æ¥ç‚¹çš„å½¢çŠ¶</p><ul><li>miter å°–çš„ï¼ˆé»˜è®¤ï¼‰</li><li>round åœ†</li><li>bevel å¹³çš„</li></ul><pre class="line-numbers language-xml"><code class="language-xml"> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>polyline</span> <span class="token attr-name">points</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20 10,50 50,80 10<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>3<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-linejoin</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>miter<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>polyline</span> <span class="token attr-name">points</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20 30,50 70,80 30<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>3<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-linejoin</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>round<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>polyline</span> <span class="token attr-name">points</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20 50,50 90,80 50<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>3<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-linejoin</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bevel<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/34.png" alt="1681199034957" style="zoom:50%;"><p>stroke-dasharray : ä½¿ç”¨è™šçº¿è®¾ç½®æè¾¹ï¼Œå¹¶è®¾ç½®è™šçº¿åŠç©ºç™½çš„é•¿åº¦</p><ul><li><p><code>stroke-dasharray="10"</code>æ¯ä¸€æ®µçº¿é•¿åº¦ä¸º 10ï¼Œä¸¤æ®µçº¿ä¹‹é—´çš„ç©ºç™½ä¸º 10</p></li><li><p><code>stroke-dasharray="10 5"</code>æ¯ä¸€æ®µçº¿é•¿åº¦ä¸º 10ï¼Œä¸¤æ®µçº¿ä¹‹é—´çš„ç©ºç™½ä¸º 5</p></li><li><p><code>stroke-dasharray="10 5 10"</code> è®¾ç½®æ—¶åé¢çš„é•¿åº¦ä¼šå¤åˆ¶å‰é¢çš„æ•°å€¼ 10 5 10 10 5 10 10 5 10</p></li></ul><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M20 20H80<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M20 40H80<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-dasharray</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M20 60H80<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-dasharray</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10 5<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M20 80H80<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-dasharray</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10 5 10<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/35.png" alt="1681199145877" style="zoom:50%;"><p>stroke-dashoffset : é…åˆè™šçº¿æè¾¹å±æ€§ ï¼Œ è®¾ç½®è™šçº¿å¼€å§‹çš„ä½ç½®ï¼ˆåç§»ï¼‰</p><ul><li>æ­£æ•°å‘å·¦åç§»ï¼Œ è´Ÿæ•°å‘å³åç§»</li><li>å¯ä»¥ç”¨æ¥å®ç°åŠ¨æ€æ–‡å­—æ•ˆæœã€‚</li></ul><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M20 20H80<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-dasharray</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M20 30H80<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-dashoffset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>-5<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-dasharray</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M20 40H80<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-dashoffset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>5<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-dasharray</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M20 50H80<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-dashoffset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>45<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-dasharray</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/36.png" alt="1681199208926" style="zoom:50%;"><h2 id="7-CSS-æ§åˆ¶-SVG"><a href="#7-CSS-æ§åˆ¶-SVG" class="headerlink" title="7 CSS æ§åˆ¶ SVG"></a>7 CSS æ§åˆ¶ SVG</h2><p>ä½¿ç”¨ CSS è®¾ç½® SVG çš„æ•ˆæœå±æ€§ ï¼ˆfill ï¼Œstrokeï¼‰</p><ul><li>ä¸»è¦å°±æ˜¯å¯¹ fill å’Œ stroke ç³»åˆ—è®¾ç½®</li><li>è¿˜å…è®¸å¯¹ r ï¼Œ cx ï¼Œcy , x , y å±æ€§è¿›è¡Œè®¾ç½®</li><li>æœ‰äº›å±æ€§ css ä¸æ”¯æŒï¼Œd ï¼Œ points ï¼Œ x1 y1 , x2 y2</li></ul><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">  <span class="token selector"><span class="token id">#c1</span> </span><span class="token punctuation">{</span>    <span class="token property">cx</span><span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">;</span>    <span class="token property">cy</span><span class="token punctuation">:</span> <span class="token number">50</span><span class="token punctuation">;</span>    <span class="token property">r</span><span class="token punctuation">:</span> <span class="token number">30</span><span class="token punctuation">;</span>    <span class="token property">fill</span><span class="token punctuation">:</span> <span class="token hexcode">#fac</span><span class="token punctuation">;</span>    <span class="token property">stroke</span><span class="token punctuation">:</span> <span class="token hexcode">#00f</span><span class="token punctuation">;</span>    <span class="token property">fill-opacity</span><span class="token punctuation">:</span> <span class="token number">0.8</span><span class="token punctuation">;</span>    <span class="token property">stroke-width</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token property">stroke-dasharray</span><span class="token punctuation">:</span> <span class="token number">4</span> <span class="token number">2</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>c1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/37.png" alt="1681203889749" style="zoom:50%;"><p>å°† CSS å±æ€§æ•ˆæœåº”ç”¨åœ¨ SVG ä¸Š</p><ul><li>ç»å¤§å¤šæ•°çš„ css æ•ˆæœï¼Œéƒ½å¯ä»¥ä½œç”¨åœ¨ svg ä¸Šé¢ã€‚ ï¼ˆåŠ¨ç”»ï¼Œæ¸å˜ï¼Œæ•ˆæœï¼‰</li><li>å…³äºèƒŒæ™¯å’Œè¾¹æ¡†ï¼Œè¦ä½¿ç”¨ SVG æä¾›çš„å±æ€§ fill å’Œ stroke ã€‚ background å’Œ border æ— æ•ˆã€‚</li><li>after å’Œ before ä¼ªç±»æ ·å¼ä¹Ÿæ˜¯ä¸æ”¯æŒçš„ã€‚</li></ul><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">  <span class="token selector"><span class="token id">#c1</span> </span><span class="token punctuation">{</span>    <span class="token property">fill</span><span class="token punctuation">:</span> <span class="token hexcode">#fac</span><span class="token punctuation">;</span>    <span class="token property">stroke</span><span class="token punctuation">:</span> <span class="token hexcode">#00f</span><span class="token punctuation">;</span>    <span class="token property">stroke-width</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">;</span>    <span class="token property">r</span><span class="token punctuation">:</span> <span class="token number">30</span><span class="token punctuation">;</span>    <span class="token property">transition</span><span class="token punctuation">:</span> <span class="token number">1</span>s<span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token selector"><span class="token id">#c1</span><span class="token pseudo-class">:hover</span> </span><span class="token punctuation">{</span>    <span class="token property">stroke</span><span class="token punctuation">:</span> <span class="token hexcode">#0f0</span><span class="token punctuation">;</span>    <span class="token property">fill</span><span class="token punctuation">:</span> <span class="token hexcode">#afc</span><span class="token punctuation">;</span>    <span class="token property">r</span><span class="token punctuation">:</span> <span class="token number">40</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>c1<span class="token punctuation">"</span></span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><iframe src="images/01.svg" height="220">> cssæ ·å¼å¯ä»¥æ˜¯è¡Œå†…æ ·å¼ï¼Œä¹Ÿæ˜¯å†…åµŒæ ·å¼ã€‚<blockquote><p>svg æœ¬èº«æ˜¯ä¸€ä¸ª xml è¯­æ³•ï¼Œå¯ä»¥å†™åœ¨.svg æ–‡ä»¶ä¸­ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ ·å¼ã€‚</p></blockquote><pre class="line-numbers language-svg"><code class="language-svg"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.w3.org/2000/svg<span class="token punctuation">"</span></span> <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0 0 100 100<span class="token punctuation">"</span></span>    <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>500<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>500<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">border</span><span class="token punctuation">:</span><span class="token hexcode">#aaa</span> solid</span><span class="token punctuation">"</span></span> <span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        circle&amp;<span class="token hexcode">#123</span><span class="token punctuation">;</span>            <span class="token property">fill</span><span class="token punctuation">:</span><span class="token hexcode">#fac</span><span class="token punctuation">;</span>            <span class="token property">stroke</span><span class="token punctuation">:</span><span class="token hexcode">#00f</span><span class="token punctuation">;</span>        &amp;<span class="token hexcode">#125</span><span class="token punctuation">;</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="8-JS-æ“æ§-SVG"><a href="#8-JS-æ“æ§-SVG" class="headerlink" title="8 JS æ“æ§ SVG"></a>8 JS æ“æ§ SVG</h2><p>å¯ä»¥ä½¿ç”¨ js çš„ dom æ¥æ“ä½œ svg æ ‡ç­¾ã€‚ä¸ä¹‹å‰çš„ dom æ“ä½œåŸºæœ¬ç›¸åŒã€‚åˆ›å»ºæ ‡ç­¾ï¼Œåˆ é™¤æ ‡ç­¾ï¼Œæ“ä½œæ ‡ç­¾(å±æ€§ï¼Œæ ·å¼ï¼Œäº‹ä»¶)</p><p>åˆ›å»º svg æ ‡ç­¾</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> cricle <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElementNS</span><span class="token punctuation">(</span><span class="token string">"http://www.w3.org/2000/svg"</span><span class="token punctuation">,</span> <span class="token string">"circle"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>åˆ›å»º svg æ ‡ç­¾çš„æ—¶å€™ï¼Œéœ€è¦æŒ‡å®šå‘½åç©ºé—´ï¼Œå¦åˆ™æ ‡ç­¾å¯ä»¥åˆ›å»ºï¼Œå±æ€§å¯ä»¥è®¾ç½®ï¼Œä½†æ²¡æœ‰æ•ˆæœã€‚</p><p>æ‰€æœ‰çš„ svg æ ‡ç­¾éƒ½å¯ä»¥åˆ›å»º ï¼Œ svg ï¼Œ circleï¼Œ rect ç­‰</p></blockquote><p>è·å¾— svg æ ‡ç­¾</p><pre class="line-numbers language-javascript"><code class="language-javascript">document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>document<span class="token punctuation">.</span><span class="token function">getElementsByName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ”¾ç½® svg æ ‡ç­¾</p><pre class="line-numbers language-javascript"><code class="language-javascript">svg<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>circle<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ“ä½œ svg æ ‡ç­¾â€”å±æ€§</p><pre class="line-numbers language-javascript"><code class="language-javascript">circle<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"cx"</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>circle<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">"cx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>circle<span class="token punctuation">.</span>cx <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// æ— æ•ˆ Ã—</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>ä¸èƒ½ç›´æ¥[.å±æ€§å]çš„æ–¹å¼æ“ä½œå±æ€§ï¼Œåªèƒ½ä½¿ç”¨ set å’Œ get æ–¹æ³•æ“ä½œå±æ€§ã€‚</p></blockquote><p>æ“ä½œ svg æ ‡ç­¾â€”äº‹ä»¶</p><pre class="line-numbers language-javascript"><code class="language-javascript">circle<span class="token punctuation">.</span>onmouseover <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"r"</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>fill <span class="token operator">=</span> <span class="token string">"#afc"</span><span class="token punctuation">;</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>onmouseout <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"r"</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>onmouseout <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>fill <span class="token operator">=</span> <span class="token string">"#fac"</span><span class="token punctuation">;</span>  <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ“ä½œ svg æ ‡ç­¾â€”æ ·å¼</p><pre class="line-numbers language-javascript"><code class="language-javascript">circle<span class="token punctuation">.</span>style<span class="token punctuation">.</span>fill <span class="token operator">=</span> <span class="token string">"#fac"</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>circle<span class="token punctuation">.</span>style<span class="token punctuation">.</span>fill<span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getComputedStyle</span><span class="token punctuation">(</span>circle<span class="token punctuation">)</span><span class="token punctuation">.</span>fill<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ é™¤ svg æ ‡ç­¾</p><pre class="line-numbers language-javascript"><code class="language-javascript">circle<span class="token punctuation">.</span>ondblclick <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">"æ˜¯å¦ç¡®è®¤ç§»é™¤"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    svg<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>circle<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><iframe src="images/01.html" height="350"/>### ã€å°ä»»åŠ¡ã€‘<iframe src="images/02.html" height="300"  />## 9 Textæ–‡æœ¬å…ƒç´ <h3 id="1ï¼‰åŸºæœ¬åº”ç”¨"><a href="#1ï¼‰åŸºæœ¬åº”ç”¨" class="headerlink" title="1ï¼‰åŸºæœ¬åº”ç”¨"></a>1ï¼‰åŸºæœ¬åº”ç”¨</h3><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fac<span class="token punctuation">"</span></span> <span class="token attr-name">fill-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.8<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>33<span class="token punctuation">"</span></span> <span class="token attr-name">font-size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span>ä¸­å›½<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>x æ–‡æœ¬å·¦è¾¹å’Œ y è½´çš„è·ç¦»</p><p>y æ–‡æœ¬åº•è¾¹å’Œ x è½´çš„è·ç¦»</p><p>ä¸­æ–‡çš„ x å’Œ y åœ¨æ˜¾ç¤ºä¸Šä¼šæœ‰ä¸€äº›è§†è§‰è¯¯å·®ã€‚</p><blockquote><p>dx , dy ç›¸å¯¹äº x å’Œ y çš„ç§»åŠ¨</p></blockquote><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>33<span class="token punctuation">"</span></span> <span class="token attr-name">dx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">dy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">font-size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span>è‹±å›½<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/38.png" alt="1681290232573" style="zoom:50%;" /><h3 id="2ï¼‰æ–‡æœ¬å±æ€§"><a href="#2ï¼‰æ–‡æœ¬å±æ€§" class="headerlink" title="2ï¼‰æ–‡æœ¬å±æ€§"></a>2ï¼‰æ–‡æœ¬å±æ€§</h3><p>fill ï¼š è®¾ç½®å­—ä½“é¢œè‰²</p><p>font-size : è®¾ç½®æ–‡å­—å¤§å°</p><p>font-family ï¼š è®¾ç½®å­—ä½“</p><p>font-style ï¼š è®¾ç½®æ–œä½“</p><p>font-weight ï¼š è®¾ç½®ç²—ä½“</p><p>text-decoration ï¼š è®¾ç½®æ–‡æœ¬è£…é¥° ä¸‹åˆ’çº¿ï¼Œä¸Šåˆ’çº¿ï¼Œåˆ é™¤çº¿</p><p>letter-spacing : è®¾ç½®æ¯ä¸€ä¸ªå­—æ¯ä¹‹é—´çš„è·ç¦»</p><p>word-spacing ï¼š è®¾ç½®æ¯ä¸€ä¸ªå•è¯ä¹‹é—´çš„è·ç¦»</p><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span>dmc zzt<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span>      <span class="token attr-name">font-size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>      <span class="token attr-name">font-family</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>æ¥·ä½“<span class="token punctuation">"</span></span>      <span class="token attr-name">font-</span><span class="token style-attr language-css"><span class="token attr-name"><span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value">italic</span><span class="token punctuation">"</span></span>      <span class="token attr-name">font-weight</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bold<span class="token punctuation">"</span></span>      <span class="token attr-name">text-decoration</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>underline<span class="token punctuation">"</span></span>      <span class="token attr-name">letter-spacing</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>      <span class="token attr-name">word-spacing</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    dmc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>70<span class="token punctuation">"</span></span>      <span class="token attr-name">font-size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>      <span class="token attr-name">word-spacing</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    dmc zzt<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/39.png" alt="1681292240517" style="zoom:50%;" /><p>font-variant ï¼š è®¾ç½®æ–‡å­—å˜ä½“ ï¼Œ ç®€å•è€Œè¨€å°±æ˜¯è½¬å¤§å†™ï¼Œä½†ç¡®å®å°å‹çš„å¤§å†™å­—æ¯</p><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span>dmc DMC<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">font-variant</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>small-caps<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span>dmc DMC<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/40.png" alt="1681292287051" style="zoom:50%;" /><p>text-anchor ï¼š è®¾ç½®æ–‡æœ¬é”šç‚¹ï¼Œ åŸºäº x å’Œ y åæ ‡ä½ç½®</p><ul><li>start ä»¥ x å’Œ y åæ ‡ä¸ºå¼€å§‹ä½ç½®</li><li>middle ä»¥ x å’Œ y åæ ‡ä¸ºä¸­é—´ä½ç½®</li><li>end ä»¥ x å’Œ y åæ ‡ä¸ºç»“æŸä½ç½®</li></ul><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>70<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">text-anchor</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>start<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>dmc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">text-anchor</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>middle<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>dmc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>70<span class="token punctuation">"</span></span> <span class="token attr-name">text-anchor</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>end<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>dmc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/41.png" alt="1681292298778" style="zoom:50%;" /><p>textLength : è®¾ç½®æ–‡æœ¬ä¹¦å†™çš„ç©ºé—´çš„é•¿åº¦ã€‚ æ–‡æœ¬é•¿åº¦&gt;ç©ºé—´é•¿åº¦ï¼Œå‹ç¼©æ–‡å­—ã€‚åä¹‹å‘æ•£æ–‡å­—ã€‚</p><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>70<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>25<span class="token punctuation">"</span></span>  <span class="token punctuation">></span></span>dmc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>55<span class="token punctuation">"</span></span> <span class="token attr-name">textLength</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span>dmc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>85<span class="token punctuation">"</span></span> <span class="token attr-name">textLength</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span>dmc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/42.png" alt="1681292306905" style="zoom:50%;" /><h3 id="3ï¼‰tspan-å­æ ‡ç­¾"><a href="#3ï¼‰tspan-å­æ ‡ç­¾" class="headerlink" title="3ï¼‰tspan å­æ ‡ç­¾"></a>3ï¼‰tspan å­æ ‡ç­¾</h3><p>åŒ…è£¹éƒ¨åˆ†æ–‡å­—ï¼Œå¯¹è¿™éƒ¨åˆ†æ–‡å­—å•ç‹¬åšè®¾ç½®</p><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">font-size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span>red</span><span class="token punctuation">"</span></span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>green<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>blue<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    dmc is    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>tspan</span> <span class="token attr-name">dy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>-5<span class="token punctuation">"</span></span> <span class="token attr-name">font-size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>red<span class="token punctuation">"</span></span> <span class="token attr-name">text-decoration</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>line-through<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>good<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>tspan</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>x å’Œ y åŸºäºåæ ‡è½´åŸç‚¹ï¼Œé‡æ–°è®¾ç½®å­éƒ¨åˆ†æ–‡å­—çš„ä½ç½®</p><p>dx å’Œ dy ç›¸å¯¹äºè¿™éƒ¨åˆ†æ–‡å­—åŸæ¥çš„ä½ç½®ï¼Œé‡æ–°è®¾ç½®æ–°ä½ç½®</p></blockquote><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/43.png" alt="1681294074289" style="zoom:50%;" /><h3 id="4ï¼‰textPath-å­æ ‡ç­¾"><a href="#4ï¼‰textPath-å­æ ‡ç­¾" class="headerlink" title="4ï¼‰textPath å­æ ‡ç­¾"></a>4ï¼‰textPath å­æ ‡ç­¾</h3><ul><li>æ–‡å­—æŒ‰ç…§ path è·¯å¾„å®ç°ä¸€ä¸ªç¯ç»•(å±•ç°)</li></ul><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>p1<span class="token punctuation">"</span></span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M30 50 A20 20 0 0 1 70 50A20 20 0 0 1 50 70<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fac<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#caf<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>blue<span class="token punctuation">"</span></span> <span class="token attr-name">font-size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>5<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>textPath</span>  <span class="token attr-name"><span class="token namespace">xlink:</span>href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#p1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        dmc is good and zzt is good !!!    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>textPath</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>ä½¿ç”¨ xlink:href å±æ€§ï¼Œé“¾æ¥æŒ‡å®š id çš„ path å›¾å½¢ã€‚</p></blockquote><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/44.png" alt="1681294087786" style="zoom:50%;" /><h2 id="10-å…¶ä»–å…ƒç´ "><a href="#10-å…¶ä»–å…ƒç´ " class="headerlink" title="10 å…¶ä»–å…ƒç´ "></a>10 å…¶ä»–å…ƒç´ </h2><h3 id="1ï¼‰use-å…ƒç´ "><a href="#1ï¼‰use-å…ƒç´ " class="headerlink" title="1ï¼‰use å…ƒç´ "></a>1ï¼‰use å…ƒç´ </h3><p>å¯ä»¥å¼•ç”¨å…¶ä»–å…ƒç´ ï¼Œåœ¨æŒ‡å®šçš„ä½ç½®ç»˜åˆ¶ä¸€ä¸ªæ–°å›¾å½¢ï¼ˆå›¾å½¢å¤ç”¨ï¼‰</p><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>c1<span class="token punctuation">"</span></span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>red<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>use</span> <span class="token attr-name"><span class="token namespace">xlink:</span>href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#c1<span class="token punctuation">"</span></span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><blockquote><p>x å’Œ y æ˜¯åŸºäºå¼•ç”¨å›¾å½¢çš„åæ ‡ã€‚è€Œä¸æ˜¯åæ ‡ç³»</p></blockquote><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/45.png" alt="1681358171234" style="zoom:50%;" /><h3 id="2ï¼‰g-å…ƒç´ "><a href="#2ï¼‰g-å…ƒç´ " class="headerlink" title="2ï¼‰g å…ƒç´ "></a>2ï¼‰g å…ƒç´ </h3><p>ç”¨æ¥ç»„åˆå¤šä¸ªå›¾å½¢çš„å®¹å™¨ï¼Œg å…ƒç´ æœ¬èº«æ²¡æœ‰ä»»ä½•æ•ˆæœ</p><p>å¯¹ä¸€ç»„å›¾å½¢ç»Ÿä¸€è®¾ç½®ï¼ˆå±æ€§ï¼ŒåŠ¨ç”»ï¼Œå¼•ç”¨ï¼‰</p><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>g</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>g2<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>c2<span class="token punctuation">"</span></span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fac<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>r2<span class="token punctuation">"</span></span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>blue<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>5<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>red<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>g</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>use</span> <span class="token attr-name"><span class="token namespace">xlink:</span>href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#g2<span class="token punctuation">"</span></span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>use</span> <span class="token attr-name"><span class="token namespace">xlink:</span>href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#g2<span class="token punctuation">"</span></span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/46.png" alt="1681358215556" style="zoom:50%;" /><h3 id="3ï¼‰defs-å…ƒç´ "><a href="#3ï¼‰defs-å…ƒç´ " class="headerlink" title="3ï¼‰defs å…ƒç´ "></a>3ï¼‰defs å…ƒç´ </h3><p>å®šä¹‰å¯é‡ç”¨çš„å…ƒç´ ï¼Œå¯ä»¥åŒ…å«å¤šä¸ªå›¾å½¢ï¼Œæœ¬èº«å¹¶ä¸æ˜¾ç¤ºã€‚å¯ä»¥é…åˆ use åœ¨å¤šä¸ªåœ°æ–¹å¤ç”¨ã€‚</p><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>g</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>g3<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fac<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>blue<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>5<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>red<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>g</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>use</span> <span class="token attr-name"><span class="token namespace">xlink:</span>href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#g3<span class="token punctuation">"</span></span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>use</span> <span class="token attr-name"><span class="token namespace">xlink:</span>href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#g3<span class="token punctuation">"</span></span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/47.png" alt="1681358258822" style="zoom:50%;" /><blockquote><p>åœ¨åé¢çš„åº”ç”¨ä¸­ï¼Œdefs ä¸ä¸€å®šåªä¸ use é…åˆã€‚ ä¾‹å¦‚ æ»¤é•œï¼Œæ¸å˜ç­‰ã€‚</p></blockquote><pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>linearGradient</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>l1<span class="token punctuation">"</span></span>                    <span class="token attr-name">x1</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">y1</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>                    <span class="token attr-name">x2</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100%<span class="token punctuation">"</span></span> <span class="token attr-name">y2</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>                    <span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0%<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>red<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100%<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>green<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>linearGradient</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#l1)<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/48.png" alt="1681358269006" style="zoom:50%;" /><h2 id="11-å®æˆ˜ç»ƒä¹ "><a href="#11-å®æˆ˜ç»ƒä¹ " class="headerlink" title="11 å®æˆ˜ç»ƒä¹ "></a>11 å®æˆ˜ç»ƒä¹ </h2><h3 id="1ï¼‰åæ ‡ç³»"><a href="#1ï¼‰åæ ‡ç³»" class="headerlink" title="1ï¼‰åæ ‡ç³»"></a>1ï¼‰åæ ‡ç³»</h3><p><strong>è®¾è®¡ 100*100 åæ ‡èŒƒå›´</strong></p><p><strong>å¤ç”¨åæ ‡ç³»</strong></p><p>å°±æ˜¯åˆ©ç”¨ js + css åŠ¨æ€ç”Ÿæˆåæ ‡ç³»ã€‚ åœ¨ç½‘é¡µä¸­åªéœ€è¦å¼•å…¥ js å’Œ css æ–‡ä»¶ï¼Œæä¾›ä¸€äº›å‚æ•°å³å¯è‡ªåŠ¨ç”Ÿæˆã€‚</p><p>è®¾è®¡è¦æ±‚ï¼š</p><ul><li><p>åæ ‡ç³»å¤§å°å¯å¦åŠ¨æ€è®¾ç½®ï¼Ÿ ç†è®ºä¸Šå¯ä»¥ï¼Œä½†æˆ‘ä»¬ä¸è¿™ä¹ˆåšï¼Œåæ ‡ç³»ä¸­çš„æ–‡å­—ä¸æ–¹ä¾¿æ§åˆ¶ã€‚</p><p>äººä¸ºå›ºå®šå¤§å° 200*200</p></li><li><p>åæ ‡ç³»å››å‘¨æœ‰å¯èƒ½ä¼šæœ‰ç»˜åˆ¶éœ€æ±‚ã€‚ å°†æ•´ä¸ªåæ ‡ç³»åŒºåŸŸå¤§å°è®¾ç½®ä¸º <code>250*250</code></p><p>å…¶ä¸­å¯è§†çš„åæ ‡ç³»éƒ¨åˆ†ä¸º 200*200</p></li><li><p>æ­¤æ—¶åªéœ€è¦æŒ‰ç…§<code>250*250</code>çš„å¤§å°æ§åˆ¶æ–‡å­—å¤§å°å³å¯ã€‚</p></li></ul><blockquote><p>é€»è¾‘ä¸Šéœ€è¦æ‰¾åˆ° <code>100*100</code>çš„ç‚¹ï¼Œåœ¨åæ ‡ç³»çš„å›¾å½¢ä¸­ï¼Œ å®é™…æ‰¾çš„æ˜¯<code>125*125</code>çš„ä½ç½®ã€‚</p><p>ä¹Ÿå°±æ˜¯æ‰¾æ‰€æœ‰çš„åæ ‡ç‚¹ï¼Œ éƒ½è®°å¾—åŠ ä¸Š 25 å•ä½ç©ºç™½ã€‚</p></blockquote><blockquote><p>é€»è¾‘ä¸Šæƒ³è¦åœ¨<code>500*500</code>çš„èŒƒå›´å†…æ‰¾åˆ°<code>250*250</code>çš„åæ ‡ç‚¹æ€ä¹ˆåŠï¼Ÿ æŒ‰ç…§ä¸€ä¸ªæ¯”ä¾‹ï¼Œå¯¹åæ ‡ç‚¹æ”¾ç¼©</p><p>é€»è¾‘åŒºåŸŸæ˜¯<code>500*500</code>, å®é™…åŒºåŸŸæ˜¯<code>200*200</code> æœ‰ä¸€ä¸ªç¼©å°æ¯”ä¾‹ 250/500 = 0.4</p><p>æ‰€ä»¥<code>250*250</code>çš„å¯¹åº”åˆ°æˆ‘ä»¬çš„åæ ‡ç³»ç»Ÿä¸­ <code>100*100</code> ï¼Œå®é™…ç»˜åˆ¶æ˜¯åŠ ä¸Š 25 çš„ç©ºç™½å°±æ˜¯<code>125*125</code></p></blockquote><p><strong>ä¼˜åŒ–</strong></p><p>å°†åæ ‡ç³»ç»˜åˆ¶æ”¾åœ¨ä¸€ä¸ª<code>g</code>æ ‡ç­¾ä¸­ã€‚</p><p>æ”¯æŒ string å‚æ•°ï¼ˆidï¼‰ å’Œ å¯¹è±¡å‚æ•° ã€‚</p><blockquote><p>éœ€è¦è€ƒè™‘å‚æ•°é»˜è®¤å€¼é—®é¢˜</p></blockquote><h3 id="2ï¼‰æŠ˜çº¿å›¾"><a href="#2ï¼‰æŠ˜çº¿å›¾" class="headerlink" title="2ï¼‰æŠ˜çº¿å›¾"></a>2ï¼‰æŠ˜çº¿å›¾</h3><h3 id="3ï¼‰æŸ±çŠ¶å›¾"><a href="#3ï¼‰æŸ±çŠ¶å›¾" class="headerlink" title="3ï¼‰æŸ±çŠ¶å›¾"></a>3ï¼‰æŸ±çŠ¶å›¾</h3><p>åæ ‡ç³»å°è£…å·¥å…·çš„æ‰©å±•</p><ul><li>åŸæ¥åªèƒ½ç»˜åˆ¶ç©ºçš„åæ ‡ç³»å›¾å½¢</li><li>ç°åœ¨å¸Œæœ›å¯ä»¥å¢åŠ ç»˜åˆ¶å·¦ä¾§å’Œåº•éƒ¨æ ‡ç­¾</li></ul><blockquote><p>ç”±äºåæ ‡ç³» x å’Œ y å‘¨çš„æ ‡ç­¾æ–‡å­—æœ‰å¯¹åº”çš„æ ·å¼è®¾è®¡ï¼Œ æ‰€ä»¥è¿˜éœ€è¦å•ç‹¬è®¾è®¡ä¸€ä¸ª coord.css ï¼Œå¹¶å¼•å…¥è‡³ç½‘é¡µã€‚</p></blockquote><h3 id="4ï¼‰é¥¼çŠ¶å›¾"><a href="#4ï¼‰é¥¼çŠ¶å›¾" class="headerlink" title="4ï¼‰é¥¼çŠ¶å›¾"></a>4ï¼‰é¥¼çŠ¶å›¾</h3><p>å·²çŸ¥ åŸç‚¹åæ ‡ï¼ŒåŠå¾„ï¼Œè§’åº¦ï¼Œè±¡é™ä¸å¤¹è§’å‚è€ƒ(y è½´ï¼Œy-x+è±¡é™-å³ä¸Šè§’)ï¼Œè®¡ç®—åœ†ä¸ŠæŒ‡å®šç‚¹çš„åæ ‡ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/49.png" alt="1681979756530"></p><blockquote><p>Math.sin()è¦æ±‚ä¼ é€’å‚æ•°æ˜¯å¼§åº¦ï¼Œä¸æ˜¯è§’åº¦ã€‚ ä½†æˆ‘ä»¬è®¡ç®—å‡ºæ¥çš„æ˜¯è§’åº¦ã€‚ æ‰€ä»¥è¿˜éœ€è¦è½¬æ¢æˆå¼§åº¦ã€‚</p><p>åœ†å‘¨é•¿æ˜¯ 2PIR = 2PI å¼§åº¦ å¯¹åº” 360 è§’åº¦</p><p>1 å¼§åº¦ = 360 è§’åº¦/2PI = 180/PI(è§’åº¦)</p><p>1 è§’åº¦ = PI/180(å¼§åº¦)</p><p>Math.sin(30Â°) = Math.sin(30 * Math.PI / 180 )</p></blockquote><h1 id="äºŒ-è¿›é˜¶ç¯‡"><a href="#äºŒ-è¿›é˜¶ç¯‡" class="headerlink" title="äºŒ è¿›é˜¶ç¯‡"></a>äºŒ è¿›é˜¶ç¯‡</h1><h2 id="1-viewBox-å±æ€§è¯¦è§£"><a href="#1-viewBox-å±æ€§è¯¦è§£" class="headerlink" title="1 viewBox å±æ€§è¯¦è§£"></a>1 viewBox å±æ€§è¯¦è§£</h2><h3 id="1ï¼‰viewBox-ä½œç”¨ç‰¹ç‚¹"><a href="#1ï¼‰viewBox-ä½œç”¨ç‰¹ç‚¹" class="headerlink" title="1ï¼‰viewBox ä½œç”¨ç‰¹ç‚¹"></a>1ï¼‰viewBox ä½œç”¨ç‰¹ç‚¹</h3><p><strong>åæ ‡ç³»</strong></p><p>æ¯ä¸€ä¸ª svg æ ‡ç­¾ï¼Œéƒ½ä¼šæœ‰ä¸€ä¸ªè‡ªå·±çš„åæ ‡ç³»ã€‚</p><p>è¿™ä¸ªåæ ‡ç³»æ˜¯éšå¼</p><p>åæ ‡ç³»æ˜¯æ— ç©·å¤§çš„</p><blockquote><p>è¿™ä¸ªåæ ‡ç³»è¿˜æœ‰å…¶ä»–çš„è±¡é™éƒ¨åˆ†ï¼Œ åªä¸è¿‡é»˜è®¤çª—å£å·¦ä¸Šè§’ä¸º 0 0 ç‚¹ã€‚ å‘å³ä¸º x æ­£ï¼Œå‘ä¸‹ä¸º y æ­£</p></blockquote><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/53.png" alt="1682220014995" style="zoom:50%;" /><p><strong>viewBox å±æ€§</strong></p><p><code>viewBox=&quot;x y width height&quot;</code></p><p>æŒ‡å®šä¸€ä¸ªè§†å£çš„å¤§å°å’Œä½ç½®ï¼Œç”¨æ¥å±•ç¤ºåæ ‡ç³»ä¸­æŒ‡å®šçš„éƒ¨åˆ†ã€‚</p><ul><li><p>x y è®¾ç½®è§†å£çš„èµ·å§‹ä½ç½®</p></li><li><p>width height è®¾ç½®è§†å£çš„åŒºåŸŸ</p></li></ul><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>svg<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>500<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>500<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">border</span><span class="token punctuation">:</span>solid <span class="token hexcode">#000</span><span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>300<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>300<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>red<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/50.png" alt="1682220550569" style="zoom:50%;" /><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span>  <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>svg<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>200<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>200<span class="token punctuation">"</span></span>  <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>200 200 200 200<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name">  <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">border</span><span class="token punctuation">:</span>solid <span class="token hexcode">#000</span><span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>300<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>300<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>red<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/51.png" alt="1682220874762" style="zoom:50%;" /><p><strong>width å’Œ height</strong></p><p>ç¡®å®šæœ€ç»ˆå›¾å½¢å±•ç¤ºçš„å¤§å°</p><p>é¦–å…ˆï¼Œä½¿ç”¨ viewBox ç¡®å®šäº†è¦å±•ç¤ºå›¾å½¢çš„éƒ¨åˆ†ï¼ˆä½ç½®ï¼‰</p><p>æ¥ä¸‹æ¥å°±å¯ä»¥ä½¿ç”¨ width å’Œ height è®¾ç½®å±•ç¤ºå›¾å½¢çš„å¤§å°ã€‚</p><p>å¦‚æœ width å’Œ height çš„åŒºåŸŸæ¯” viewBox åŒºåŸŸå¤§ï¼Œ å°±ä¼šç­‰æ¯”ä¾‹<strong>æ”¾å¤§</strong>ã€‚ å¦åˆ™ä¼šç­‰æ¯”ä¾‹<strong>ç¼©å°</strong></p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span>  <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>svg<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>500<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>500<span class="token punctuation">"</span></span>  <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>200 200 200 200<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name">  <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">border</span><span class="token punctuation">:</span> solid <span class="token hexcode">#000</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>300<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>300<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>red<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/52.png" alt="1682221086273" style="zoom:50%;" /><blockquote><p>svg é»˜è®¤çš„å®½é«˜æ˜¯ 300*150</p><p>ä¸€æ—¦è®¾ç½®äº† viewboxï¼Œä¼šé»˜è®¤æ’‘æ»¡çª—å£</p><p>å¦‚æœåªè®¾ç½®äº† width å’Œ heightï¼Œæ²¡æœ‰è®¾ç½® viewbox ï¼Œ åˆ™ viewbox é»˜è®¤ä¸º 0 0 width height</p><p>ä¸€èˆ¬éƒ½ä¼š viewBox é…åˆ width å’Œ height</p></blockquote><h3 id="2ï¼‰preserveAspectRatio-å±æ€§"><a href="#2ï¼‰preserveAspectRatio-å±æ€§" class="headerlink" title="2ï¼‰preserveAspectRatio å±æ€§"></a>2ï¼‰preserveAspectRatio å±æ€§</h3><p>ä¿æŒ(å®½é«˜)æ–¹é¢æ¯”ä¾‹</p><p>å½“ viewBox.å®½é«˜ ä¸ svg.å®½é«˜ä¸ä¸€è‡´æ—¶ï¼Œé»˜è®¤ä¼šè¿›è¡Œä¸€ä¸ªç­‰æ¯”ä¾‹ç¼©æ”¾</p><p>æˆ‘ä»¬ä¹‹å‰éƒ½æ˜¯è®© viewBox ä¸ svg çš„å®½é«˜æ¯”ç›¸åŒï¼ˆäººä¸ºæ§åˆ¶ï¼‰</p><p>å½“ svg.å®½é«˜æ¯”ï¼Œä¸ viewBox.å®½é«˜æ¯”ä¸åŒæ—¶ï¼Œå›¾å½¢åˆéœ€è¦æŒ‰ç…§ viewbox å®½é«˜æ¯”ç¼©æ”¾ã€‚</p><pre class="line-numbers language-txt"><code class="language-txt">å‡è®¾ï¼šviewBox.width=100 viewBox.height=100  æ¯”ä¾‹1:1æƒ…å†µä¸€ï¼šsvg.width=200 svg.height=200  æ¯”ä¾‹1:1æ­¤æ—¶æ­£å¸¸æ”¾ç¼©æƒ…å†µäºŒï¼šsvg.width=200 svg.height=400  æ¯”ä¾‹1:2   viewBoxå›¾å½¢å¿…é¡»æŒ‰ç…§1:1æ”¾å¤§ã€‚æ­¤æ—¶viewboxæ”¾ç¼©åä¼šæœ‰ä¸¤ç§å®½é«˜    200*200    400*400<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>è¿™ä¸ªæ—¶å€™ï¼Œæ˜¯æŒ‰ç…§å°çš„ç¼©æ”¾ï¼Œè¿˜æ˜¯æŒ‰ç…§å¤§çš„ç¼©æ”¾ã€‚ç¼©æ”¾åä¼šæœ‰ä»€ä¹ˆæ•ˆæœï¼Œåˆå¦‚ä½•æ§åˆ¶ä½ç½®ã€‚å°±ç”± preserveAspectRatio å±æ€§æ§åˆ¶</strong></p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/54.png" alt="1682233421225" style="zoom:50%;" /><blockquote><p>viewBox å›¾å½¢åŒºåŸŸçš„å®½é«˜æ¯”ä¸ä¸€å®šæ˜¯ 1:1</p></blockquote><p><strong>preserveAspectRatio å±æ€§åœ¨è®¾ç½®çš„æ—¶å€™æœ‰ä¸¤éƒ¨åˆ†å€¼ã€‚</strong></p><p><code>preserveAspectRatio =&quot;align meetOrSlice&quot;</code></p><ul><li><p>ç¬¬ä¸€éƒ¨åˆ† å°±æ˜¯å›¾å½¢åœ¨çª—å£ä¸­çš„ä½ç½®<code>xMin xMid xMax yMin yMid yMax</code>ã€‚</p><p>â€‹ è¿™éƒ¨åˆ†å€¼ä¸€å…±æœ‰ä¸Šè¿° 9 ä¸ªç»„åˆ <code>xMinYMin xMidYMin xMaxYMin xMinYMid .....</code></p><p>â€‹ <strong>æ­¤æ—¶æ³¨æ„ï¼šåªä¼šå­˜åœ¨ä¸€ä¸ªæ–¹å‘çš„ä½ç½®å…³ç³» åªä¼šæœ‰ä¸€ä¸ªæ–¹å‘ç”Ÿæ•ˆã€‚è¦ä¹ˆå·¦ä¸­å³ï¼Œè¦ä¹ˆä¸Šä¸­ä¸‹</strong></p></li><li><p>ç¬¬äºŒéƒ¨åˆ† å°±æ˜¯å›¾å½¢æ”¾ç¼©æ—¶å‚è€ƒçš„ svg.å®½é«˜æ•°å€¼ å‚è€ƒå¤§çš„ï¼Œè¿˜æ˜¯å‚è€ƒå°çš„ï¼Ÿ</p><ul><li><p>meet ï¼ˆé»˜è®¤ï¼‰ï¼ŒviewBox å›¾å½¢ä¼šæŒ‰ç…§å°çš„æ•°å€¼æ”¾ç¼©ï¼Œæ­¤æ—¶çª—å£åŒºåŸŸå°±ä¼šå¤šå‡ºä¸€éƒ¨åˆ†ã€‚è¿™ä¸€éƒ¨åˆ†å¯ä»¥æ˜¾ç¤º viewBox æ²¡æœ‰åŒ…å«åˆ°é‚£éƒ¨åˆ†åæ ‡ç³»å†…å®¹ï¼ˆå¯è§çš„ï¼‰</p><p><code>preserveAspectRatio=&quot;xMaxYMin meet&quot;</code></p></li><li><p>slice ï¼ŒviewBox å›¾å½¢ä¼šæŒ‰ç…§å¤§çš„æ•°å€¼æ”¾ç¼©ã€‚æ­¤æ—¶çª—å£è¿‡å°ï¼Œè£…ä¸ä¸‹å›¾å½¢ã€‚æ‰€ä»¥éœ€è¦åœ¨ viewBox å›¾å½¢ä¸­åˆ‡ä¸€éƒ¨åˆ†åœ¨çª—å£ä¸­å±•ç¤ºã€‚</p><p><code>preserveAspectRatio=&quot;xMaxYMin slice&quot;</code></p></li></ul></li></ul><blockquote><p>è¿˜æœ‰ä¸€ç§æƒ…å†µï¼Œå°±æ˜¯ä¸æŒ‰ç…§ç­‰æ¯”ä¾‹ç¼©æ”¾ã€‚ è®¾ç½®<code>preserveAspectRatio=&quot;none&quot;</code></p><p>å°±å°† viewBox å›¾å½¢æŒ‰ç…§ç°æœ‰çš„ svg å®½é«˜æ¯”ä¾‹æ‹‰ä¼¸</p></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span>  <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>-100 -100 200 200<span class="token punctuation">"</span></span>  <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>svg<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>800<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name">  <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">1</span>px<span class="token punctuation">;</span> <span class="token property">border</span><span class="token punctuation">:</span> solid <span class="token hexcode">#00f</span></span><span class="token punctuation">"</span></span>  <span class="token attr-name">preserveAspectRatio</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>xMaxYMax<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/55.png" alt="1682235666961" style="zoom:50%;" /><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span>  <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>-50 -50 100 100<span class="token punctuation">"</span></span>  <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>svg<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>800<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name">  <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">1</span>px<span class="token punctuation">;</span> <span class="token property">border</span><span class="token punctuation">:</span> solid <span class="token hexcode">#00f</span></span><span class="token punctuation">"</span></span>  <span class="token attr-name">preserveAspectRatio</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>xMaxYMin meet<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/56.png" alt="1682235825041" style="zoom:50%;" /><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span>  <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>-50 -50 100 100<span class="token punctuation">"</span></span>  <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>svg<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>800<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name">  <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">1</span>px<span class="token punctuation">;</span> <span class="token property">border</span><span class="token punctuation">:</span> solid <span class="token hexcode">#00f</span></span><span class="token punctuation">"</span></span>  <span class="token attr-name">preserveAspectRatio</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>xMinYMin slice<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/57.png" alt="1682235995026" style="zoom:50%;" /><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span>  <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>-50 -50 100 100<span class="token punctuation">"</span></span>  <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>svg<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>800<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name">  <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">1</span>px<span class="token punctuation">;</span> <span class="token property">border</span><span class="token punctuation">:</span> solid <span class="token hexcode">#00f</span></span><span class="token punctuation">"</span></span>  <span class="token attr-name">preserveAspectRatio</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/58.png" alt="1682236118889" style="zoom:50%;" /><h2 id="2-é¢œè‰²æ¸å˜"><a href="#2-é¢œè‰²æ¸å˜" class="headerlink" title="2 é¢œè‰²æ¸å˜"></a>2 é¢œè‰²æ¸å˜</h2><p>å›¾å½¢çš„å¡«å……å’Œæè¾¹å¯ä»¥ä½¿ç”¨æ¸å˜è‰²</p><p>æ¸å˜è‰²çš„ä½¿ç”¨åˆ†ä¸ºï¼š å®šä¹‰æ¸å˜è‰²ï¼Œ å¼•ç”¨æ¸å˜è‰²ã€‚</p><h3 id="1ï¼‰çº¿æ€§æ¸å˜"><a href="#1ï¼‰çº¿æ€§æ¸å˜" class="headerlink" title="1ï¼‰çº¿æ€§æ¸å˜"></a>1ï¼‰çº¿æ€§æ¸å˜</h3><p>æ²¿ç€æ‰§è¡Œè¿›è¡Œé¢œè‰²æ¸å˜ï¼ˆæ¨ªå‘ï¼Œçºµå‘ï¼Œæ–œå‘ï¼‰</p><p>ä½¿ç”¨<code>&lt;linearGradient&gt;</code>æ ‡è®°å®šä¹‰çº¿æ€§æ¸å˜</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>linearGradient</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gradient1<span class="token punctuation">"</span></span> <span class="token attr-name">x1</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0%<span class="token punctuation">"</span></span> <span class="token attr-name">y1</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0%<span class="token punctuation">"</span></span> <span class="token attr-name">x2</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100%<span class="token punctuation">"</span></span> <span class="token attr-name">y2</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0%<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0%<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span> <span class="token attr-name">stop-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100%<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#ff0<span class="token punctuation">"</span></span> <span class="token attr-name">stop-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>linearGradient</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>80<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#gradient1)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>x1 y1 å’Œ x2 y2 è®¾ç½®çº¿æ¡çš„ä¸¤ä¸ªç«¯ç‚¹ã€‚ æŒ‰ç…§çº¿æ¡æ–¹å‘æ¸å˜ ï¼ˆæ¨ªå‘ï¼Œçºµå‘ï¼Œæ–œå‘ï¼‰</li><li>x y ä½ç½®ç”¨ç™¾åˆ†æ¯”è®¾ç½®ï¼Œx æ˜¯ width çš„ç™¾åˆ†æ¯” ï¼Œ y æ˜¯ height çš„ç™¾åˆ†æ¯”ã€‚</li><li><code>&lt;stop&gt;</code>è®¾ç½®æ¯ä¸€é˜¶æ®µæ¸å˜çš„é¢œè‰²å’Œé€æ˜åº¦ã€‚</li></ul><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/59.png" alt="1682307248533" style="zoom:50%;" /><blockquote><p><code>&lt;defs&gt;</code>ä¸å†™ï¼Œä¹Ÿå¯ä»¥å®ç°æ¸å˜å®šä¹‰ã€‚</p></blockquote><blockquote><p>è®¾ç½®çº¿æ€§åæ ‡ç‚¹æ—¶ï¼Œä¸ä¸€å®šéè¦ä»å¤´åˆ°å°¾ï¼ˆ0 or 100%) , å¦‚æœè®¾ç½®äº†ä¸­é—´æ•°å€¼ï¼Œå°±åœ¨ä¸­é—´ä½ç½®æ¸å˜ã€‚</p><p>ä¸¤è¾¹å°±æ˜¯èµ·å§‹å’Œç»ˆæ­¢çš„é¢œè‰²ã€‚</p></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>linearGradient</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gradient4<span class="token punctuation">"</span></span> <span class="token attr-name">x1</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30%<span class="token punctuation">"</span></span> <span class="token attr-name">y1</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100%<span class="token punctuation">"</span></span> <span class="token attr-name">x2</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>70%<span class="token punctuation">"</span></span> <span class="token attr-name">y2</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100%<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0%<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span> <span class="token attr-name">stop-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50%<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#0f0<span class="token punctuation">"</span></span> <span class="token attr-name">stop-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100%<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#ff0<span class="token punctuation">"</span></span> <span class="token attr-name">stop-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>linearGradient</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>80<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#gradient4)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/60.png" alt="1682307501824" style="zoom:50%;" /><h3 id="2ï¼‰å¾„å‘æ¸å˜"><a href="#2ï¼‰å¾„å‘æ¸å˜" class="headerlink" title="2ï¼‰å¾„å‘æ¸å˜"></a>2ï¼‰å¾„å‘æ¸å˜</h3><p>ä»ä¸€ä¸ªèµ·å§‹ç‚¹å¼€å§‹ï¼Œä»é‡Œå‘å¤–åœ†å½¢æ¸å˜</p><p>ä½¿ç”¨<code>&lt;radialGradient&gt;</code>æ ‡ç­¾å®šä¹‰å¾„å‘æ¸å˜</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>radialGradient</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gradient1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#ff0<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100%<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>radialGradient</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#gradient1)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é»˜è®¤åœ¨æ•´ä¸ªå›¾å½¢åŒºåŸŸè¿›è¡Œæ¸å˜ã€‚</p><blockquote><p>ä½¿ç”¨ cx cy r fr æ§åˆ¶æ¸å˜çš„åŒºåŸŸ</p><p>cx cy å®šä¹‰åŸç‚¹ä½ç½®</p><p>fr è®¾ç½®æ¸å˜å…¶å®ä½ç½®åœ†çš„åŠå¾„ ã€‚ fr æ²¡æœ‰è®¾ç½®ï¼Œå°±æ˜¯ä»¥åŸç‚¹å‘å¤–æ¸å˜ã€‚</p><p>r è®¾ç½®æ¸å˜ç»ˆæ­¢ä½ç½®åœ†çš„åŠå¾„</p></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>radialGradient</span>    <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gradient2<span class="token punctuation">"</span></span>    <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50%<span class="token punctuation">"</span></span>    <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50%<span class="token punctuation">"</span></span>    <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30%<span class="token punctuation">"</span></span>    <span class="token attr-name">spreadMethod</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>repeat<span class="token punctuation">"</span></span>  <span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#ff0<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100%<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>radialGradient</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#gradient2)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>radialGradient</span>    <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gradient3<span class="token punctuation">"</span></span>    <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50%<span class="token punctuation">"</span></span>    <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50%<span class="token punctuation">"</span></span>    <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30%<span class="token punctuation">"</span></span>    <span class="token attr-name">fr</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20%<span class="token punctuation">"</span></span>    <span class="token attr-name">spreadMethod</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>repeat<span class="token punctuation">"</span></span>  <span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#ff0<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100%<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>radialGradient</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#gradient3)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/61.png" alt="1682317237562" style="zoom:50%;" /><blockquote><p>è¿™é‡Œé¢çš„ cx cy r ç™¾åˆ†æ¯”ï¼Œéƒ½æ˜¯åŸºäºåœ†ç›´å¾„çš„ç™¾åˆ†æ¯”ã€‚</p><ul><li><code>cx=&quot;25%&quot; cy=&quot;50%&quot; r=&quot;25%&quot;</code> x è½´ç›´å¾„çš„ 25%ä½ç½®ï¼Œ y è½´ç›´å¾„çš„ 50%ä½ç½®ï¼ŒåŠå¾„é•¿åº¦ä¸ºç›´å¾„çš„ 25%</li></ul><p>å¦‚æœæ˜¯æ¤­åœ†ï¼Œ åˆ†åˆ«æ˜¯åŸºäºé•¿è½´ç›´å¾„å’ŒçŸ­è½´ç›´å¾„çš„ç™¾åˆ†æ¯”</p></blockquote><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/62.png" alt="1682319165680" style="zoom:50%;" /><blockquote><p>ä½¿ç”¨ fx fy è®¾ç½®æ¸å˜çš„<strong>ç„¦ç‚¹</strong>ä½ç½®ï¼Œä»ç„¦ç‚¹ä½ç½®å‘å¤–å¼€å§‹æ¸å˜</p><p>cx ï¼Œcy ï¼Œ r , fr ç”¨æ¥æ§åˆ¶æ¸å˜çš„åŒºåŸŸã€‚</p></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>radialGradient</span>    <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gradient5<span class="token punctuation">"</span></span>    <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50%<span class="token punctuation">"</span></span>    <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50%<span class="token punctuation">"</span></span>    <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30%<span class="token punctuation">"</span></span>    <span class="token attr-name">fx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>25%<span class="token punctuation">"</span></span>    <span class="token attr-name">fy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50%<span class="token punctuation">"</span></span>    <span class="token attr-name">spreadMethod</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>repeat<span class="token punctuation">"</span></span>  <span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#ff0<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100%<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>radialGradient</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#gradient5)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/63.png" alt="1682317397152" style="zoom:50%;" /><blockquote><p>ç„¦ç‚¹å¦‚æœç¦»å¼€æ¸å˜èŒƒå›´ï¼Œæ— æ³•æ˜¾ç¤ºæ­£å¸¸æ•ˆæœã€‚</p></blockquote><h3 id="3ï¼‰spreadMethod-å±æ€§è¯¦è§£"><a href="#3ï¼‰spreadMethod-å±æ€§è¯¦è§£" class="headerlink" title="3ï¼‰spreadMethod å±æ€§è¯¦è§£"></a>3ï¼‰spreadMethod å±æ€§è¯¦è§£</h3><p>åœ¨ç¼©å°æ¸å˜èŒƒå›´åï¼Œè®¾ç½®æ‰©å±•éƒ¨åˆ†çš„æ¸å˜æ•ˆæœã€‚</p><ul><li><p>pad ï¼ˆé»˜è®¤å€¼ï¼‰è¡¨ç¤ºä½¿ç”¨èµ·ç‚¹å’Œç»ˆç‚¹é¢œè‰²ï¼Œå¡«å……æ‰©å±•çš„éƒ¨åˆ†ã€‚</p></li><li><p>repeat é‡å¤å½“å‰çš„æ¸å˜é¢œè‰²ï¼Œåˆ†åˆ«ä½œç”¨åœ¨æ‰©å±•çš„ä¸¤ä¸ªéƒ¨åˆ†ä¸­ã€‚</p></li><li><p>reflect æŒ‰ç…§æ¸å˜çš„åå‘é¡ºåºï¼Œä½œç”¨åœ¨æ‰©å±•çš„ä¸¤ä¸ªéƒ¨åˆ†ä¸­ã€‚ å¦‚æœæ‰©å±•éƒ¨åˆ†ä¾ç„¶æœ‰å‰©ä½™ï¼Œç»§ç»­åå‘å¡«å……ã€‚</p><p>C-B-A-<strong>A-B-C</strong>-C-B-A-A-B-C</p></li></ul><p><code>&lt;radialGradient spreadMethod=&quot;repeat&quot;&gt;</code></p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/64.png" alt="1682321599875" style="zoom:50%;" /><h3 id="4ï¼‰gradientUnits-å±æ€§è¯¦è§£"><a href="#4ï¼‰gradientUnits-å±æ€§è¯¦è§£" class="headerlink" title="4ï¼‰gradientUnits å±æ€§è¯¦è§£"></a>4ï¼‰gradientUnits å±æ€§è¯¦è§£</h3><p>è®¾ç½®æ¸å˜å•å…ƒ</p><p>åœ¨è®¾ç½®æ¸å˜åŒºåŸŸæ—¶ï¼Œéœ€è¦è®¾ç½®ä¸€äº›æ•°å€¼ã€‚ è¿™äº›æ•°å€¼å¯ä»¥ä½¿ç”¨ç›¸å¯¹å•ä½ï¼ˆç™¾åˆ†æ¯”ï¼‰ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç»å¯¹å•ä½ï¼ˆpxï¼‰</p><ul><li><p>ObjectBoundingBox(é»˜è®¤) ä½¿ç”¨ç™¾åˆ†æ¯”ã€‚</p><p>æ‰€æœ‰å›¾å½¢æœ€ç»ˆéƒ½ä¼šå½¢æˆä¸€ä¸ªçŸ©å½¢åŒºåŸŸã€‚ è¿™é‡Œçš„ç™¾åˆ†æ¯”éƒ½æ˜¯åŸºäºçŸ©å½¢çš„å®½é«˜çš„ã€‚</p><p>çº¿æ€§æ¸å˜ä¸­ x1 x2 åŸºäºçŸ©å½¢ width ï¼Œ y1 y2 åŸºäºçŸ©å½¢çš„ height</p><p>å¾„å‘æ¸å˜ cx fx åŸºäºçŸ©å½¢ width ï¼Œcy fy åŸºäºçŸ©å½¢çš„ height ã€‚ r ,fr åŒæ—¶åŸºäº width å’Œ height 100 200 50 100</p><p><strong>å›¾å½¢ç§»åŠ¨ï¼Œæ•ˆæœä½ç½®ä¼šè·Ÿéšã€‚</strong></p></li><li><p>userSpaceOnUse ä½¿ç”¨ç»å¯¹å€¼ã€‚</p><p>å‚è€ƒåæ ‡ç³»</p><p><strong>å›¾å½¢ç§»åŠ¨ï¼Œæ•ˆæœä½ç½®ä¸åŠ¨ã€‚</strong></p></li></ul><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>radialGradient</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gradient2<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30%<span class="token punctuation">"</span></span> <span class="token attr-name">fr</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20%<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0%<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#ff0<span class="token punctuation">"</span></span> <span class="token attr-name">stop-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100%<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span> <span class="token attr-name">stop-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>radialGradient</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token comment" spellcheck="true">&lt;!-- 50ç§»åŠ¨åˆ°40ä½ç½® --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#gradient2)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>24<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#66f<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>16<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#66f<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>radialGradient</span>    <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gradient4<span class="token punctuation">"</span></span>    <span class="token attr-name">gradientUnits</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>userSpaceOnUse<span class="token punctuation">"</span></span>    <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span>    <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span>    <span class="token attr-name">fr</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>    <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span>  <span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0%<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#ff0<span class="token punctuation">"</span></span> <span class="token attr-name">stop-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100%<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span> <span class="token attr-name">stop-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>radialGradient</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token comment" spellcheck="true">&lt;!-- 50ç§»åŠ¨åˆ°40ä½ç½® --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#gradient4)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#66f<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#66f<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/65.png" alt="1682324811921" style="zoom:50%;" /><h3 id="5ï¼‰æ¸å˜å¼•ç”¨"><a href="#5ï¼‰æ¸å˜å¼•ç”¨" class="headerlink" title="5ï¼‰æ¸å˜å¼•ç”¨"></a>5ï¼‰æ¸å˜å¼•ç”¨</h3><p>ä½¿ç”¨ href å±æ€§ï¼Œå¼•ç”¨å¦å¤–ä¸€ä¸ªæ¸å˜çš„é¢œè‰²è®¾ç½®</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>radialGradient</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gradient1<span class="token punctuation">"</span></span> <span class="token attr-name">fr</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>15%<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30%<span class="token punctuation">"</span></span> <span class="token attr-name">spreadMethod</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>repeat<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0%<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#ff0<span class="token punctuation">"</span></span> <span class="token attr-name">stop-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100%<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span> <span class="token attr-name">stop-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0.5<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>radialGradient</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>radialGradient</span>    <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gradient2<span class="token punctuation">"</span></span>    <span class="token attr-name">fr</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>15%<span class="token punctuation">"</span></span>    <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30%<span class="token punctuation">"</span></span>    <span class="token attr-name">spreadMethod</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>reflect<span class="token punctuation">"</span></span>    <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#gradient1<span class="token punctuation">"</span></span>  <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>25<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>25<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>25<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#gradient1)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>75<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>75<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>25<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#gradient2)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/66.png" alt="1682325850803" style="zoom:50%;" /><blockquote><p>å¼•ç”¨çš„æ˜¯é¢œè‰²çš„æ¸å˜è¿‡ç¨‹ï¼Œä¸å“ªç§æ¸å˜æ–¹å¼æ— å…³ã€‚</p></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>radialGradient</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gradient3<span class="token punctuation">"</span></span> <span class="token attr-name">fr</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>15%<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30%<span class="token punctuation">"</span></span> <span class="token attr-name">spreadMethod</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>repeat<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0%<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#ff0<span class="token punctuation">"</span></span> <span class="token attr-name">stop-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100%<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span> <span class="token attr-name">stop-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0.5<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>radialGradient</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>linearGradient</span>    <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gradient4<span class="token punctuation">"</span></span>    <span class="token attr-name">x1</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40%<span class="token punctuation">"</span></span>    <span class="token attr-name">x2</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60%<span class="token punctuation">"</span></span>    <span class="token attr-name">spreadMethod</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>repeat<span class="token punctuation">"</span></span>    <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#gradient3<span class="token punctuation">"</span></span>  <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#gradient3)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>25<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#gradient4)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/67.png" alt="1682326075729" style="zoom:50%;" /><h2 id="3-å˜å½¢"><a href="#3-å˜å½¢" class="headerlink" title="3 å˜å½¢"></a>3 å˜å½¢</h2><p>å¹³ç§»ï¼Œæ—‹è½¬ï¼Œç¼©æ”¾ï¼Œæ–œåˆ‡</p><p>transform å±æ€§å¯ä»¥å®ç°å˜å½¢</p><p>ä½¿ç”¨ä¸åŒçš„å˜å½¢å‡½æ•°å®Œæˆå¯¹åº”å›¾å½¢å˜åŒ–ï¼š translate , rotate , scale , skew</p><h3 id="1ï¼‰å¹³ç§»"><a href="#1ï¼‰å¹³ç§»" class="headerlink" title="1ï¼‰å¹³ç§»"></a>1ï¼‰å¹³ç§»</h3><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fcc<span class="token punctuation">"</span></span> <span class="token attr-name">fill-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0.8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>  <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-dasharray</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.5<span class="token punctuation">"</span></span>  <span class="token attr-name">transform</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>translate(20)<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>  <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#0f0<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-dasharray</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.5<span class="token punctuation">"</span></span>  <span class="token attr-name">transform</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>translate(0,20)<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>  <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-dasharray</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.5<span class="token punctuation">"</span></span>  <span class="token attr-name">transform</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>translate(10,10)<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>æ²¡æœ‰æŒ‡å®š yï¼Œé»˜è®¤ä¸º 0.</p></blockquote><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/68.png" alt="1682412530600" style="zoom:50%;" /><h3 id="2ï¼‰æ—‹è½¬"><a href="#2ï¼‰æ—‹è½¬" class="headerlink" title="2ï¼‰æ—‹è½¬"></a>2ï¼‰æ—‹è½¬</h3><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fcc<span class="token punctuation">"</span></span> <span class="token attr-name">fill-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0.8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>  <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-dasharray</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.5<span class="token punctuation">"</span></span>  <span class="token attr-name">transform</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rotate(45)<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/69.png" alt="1682412588277" style="zoom:50%;" /><blockquote><p>é»˜è®¤æ˜¯ä»¥åæ ‡ç³»åŸç‚¹è¿›è¡Œæ—‹è½¬ã€‚</p><p>å¯ä»¥è®¾ç½®æ—‹è½¬çš„ä¸­å¿ƒç‚¹</p><ul><li>åˆ©ç”¨ rotate å‡½æ•°æŒ‡å®šæ—‹è½¬çš„ä¸­å¿ƒç‚¹ <code>rotate(45,30,20)</code></li><li>åˆ©ç”¨ transform-origin=â€30 20â€</li></ul></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fcc<span class="token punctuation">"</span></span> <span class="token attr-name">fill-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0.8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>  <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-dasharray</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.5<span class="token punctuation">"</span></span>  <span class="token attr-name">transform</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rotate(45)<span class="token punctuation">"</span></span>  <span class="token attr-name">transform-origin</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40 30<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>  <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-dasharray</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.5<span class="token punctuation">"</span></span>  <span class="token attr-name">transform</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rotate(45,70,50)<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">fill</span><span class="token punctuation">:</span>red<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>70<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">fill</span><span class="token punctuation">:</span>blue<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/70.png" alt="1682412623901" style="zoom:50%;" /><h3 id="3ï¼‰æ”¾ç¼©"><a href="#3ï¼‰æ”¾ç¼©" class="headerlink" title="3ï¼‰æ”¾ç¼©"></a>3ï¼‰æ”¾ç¼©</h3><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fcc<span class="token punctuation">"</span></span> <span class="token attr-name">fill-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0.8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>  <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-dasharray</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.5<span class="token punctuation">"</span></span>  <span class="token attr-name">transform</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scale(0.4)<span class="token punctuation">"</span></span>  <span class="token attr-name">transform-origin</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40 30<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>  <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#0f0<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-dasharray</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.5<span class="token punctuation">"</span></span>  <span class="token attr-name">transform</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scale(1,0.5)<span class="token punctuation">"</span></span>  <span class="token attr-name">transform-origin</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40 30<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>  <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-dasharray</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.5<span class="token punctuation">"</span></span>  <span class="token attr-name">transform</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scale(0.5,1)<span class="token punctuation">"</span></span>  <span class="token attr-name">transform-origin</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40 30<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>å¦‚æœ y æ²¡æœ‰æä¾›ï¼Œé»˜è®¤ä¸ x ç›¸åŒã€‚</p><p>æ”¾ç¼©åçš„ä½ç½®ï¼Œé»˜è®¤ä¼šå‚è€ƒ 0 0 åŸç‚¹ã€‚</p><p>å¯ä»¥ä½¿ç”¨ transform-origin è®¾ç½®æ–°çš„åŸç‚¹ä½ç½®ã€‚</p></blockquote><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/71.png" alt="1682412651069" style="zoom:50%;" /><h3 id="4ï¼‰æ–œåˆ‡"><a href="#4ï¼‰æ–œåˆ‡" class="headerlink" title="4ï¼‰æ–œåˆ‡"></a>4ï¼‰æ–œåˆ‡</h3><p>æœ‰ä¸¤ä¸ªå‡½æ•° skewX å’Œ skewY</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fcc<span class="token punctuation">"</span></span> <span class="token attr-name">fill-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0.8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>  <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-dasharray</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.5<span class="token punctuation">"</span></span>  <span class="token attr-name">transform</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>skewX(30)<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>skewX å»¶ x è½´æ–¹å‘æ‹‰æ‹½ï¼Œæœ€ç»ˆä¸ y è½´å½¢æˆæŒ‡å®šçš„å¤¹è§’ã€‚</p></blockquote><blockquote><p>é»˜è®¤æ˜¯åŸºäº 0 0 ç‚¹çš„ä¸€ä¸ªæ–œåˆ‡ã€‚ å¯ä»¥é‡æ–°è®¾ç½®ä¸­é—´ç‚¹ã€‚</p></blockquote><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/72.png" alt="1682412930702" style="zoom:50%;" /><blockquote><p>ä¸­å¿ƒç‚¹åœ¨æŸä¸€ä¸ªè¾¹ä¸Šï¼Œå€¾æ–œæ—¶è¯¥è¾¹ä¸åŠ¨ã€‚å…¶ä½™ 3 è¾¹æœ‰å˜åŒ–ã€‚</p><p>ä¸­å¿ƒç‚¹åœ¨å›¾å½¢ä¸­ï¼Œå€¾æ–œæ—¶ 4 ä¸ªè¾¹éƒ½æœ‰å˜åŒ–</p></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fcc<span class="token punctuation">"</span></span> <span class="token attr-name">fill-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0.8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>  <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-dasharray</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.5<span class="token punctuation">"</span></span>  <span class="token attr-name">transform</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>skewX(30)<span class="token punctuation">"</span></span>  <span class="token attr-name">transform-origin</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50 40<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>  <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#0f0<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-dasharray</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.5<span class="token punctuation">"</span></span>  <span class="token attr-name">transform</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>skewX(30)<span class="token punctuation">"</span></span>  <span class="token attr-name">transform-origin</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50 20<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>  <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-dasharray</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.5<span class="token punctuation">"</span></span>  <span class="token attr-name">transform</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>skewX(30)<span class="token punctuation">"</span></span>  <span class="token attr-name">transform-origin</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50 60<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#0f0<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/73.png" alt="1682413070222" style="zoom:50%;" /><h2 id="4-åµŒå…¥å›¾ç‰‡"><a href="#4-åµŒå…¥å›¾ç‰‡" class="headerlink" title="4 åµŒå…¥å›¾ç‰‡"></a>4 åµŒå…¥å›¾ç‰‡</h2><p>åœ¨ svg åµŒå…¥ä¸€ä¸ªå›¾ç‰‡ï¼ˆä½å›¾ï¼ŒçŸ¢é‡å›¾ï¼‰ï¼Œå°±å¯ä»¥ä½¿ç”¨ svg æ•ˆæœï¼ˆå˜å½¢ï¼Œè£å‰ªï¼Œé®ç½©ï¼Œæ»¤é•œï¼‰</p><p>ä½¿ç”¨<code>&lt;image&gt;</code>æ ‡ç­¾åµŒå…¥æŒ‡å®šçš„å›¾ç‰‡</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span>  <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>../imgs/1.png<span class="token punctuation">"</span></span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>80<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>80<span class="token punctuation">"</span></span>  <span class="token attr-name">transform</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rotate(45,50,50)<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>href å¼•å…¥æŒ‡å®šçš„å›¾ç‰‡ ï¼Œå¯ä»¥æ˜¯æœ¬åœ°å›¾ç‰‡ï¼Œä¹Ÿå¯ä»¥æ˜¯ç½‘ç»œå›¾ç‰‡ã€‚</p><p>x å’Œ y è®¾ç½®å¼•å…¥å›¾ç‰‡çš„æ”¾ç½®çš„å…¶å®ä½ç½®ã€‚é»˜è®¤æ˜¯ 0 0 åŸç‚¹ã€‚</p><p>width å’Œ height æ˜¯å¯¹å¼•å…¥å›¾ç‰‡çš„å®½é«˜æ”¾ç¼© ã€‚ é»˜è®¤å°±æ˜¯å›¾ç‰‡çš„åŸå§‹å®½é«˜ã€‚</p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/80.png" alt="1682490771009" style="zoom:50%;" /><blockquote><p>preserveAspectRatio å¯ä»¥åœ¨ä½¿ç”¨ width å’Œ height æ”¾ç¼©æ—¶æŒ‡å®šæ”¾ç¼©æ¯”ä¾‹ä¿æŒçŠ¶æ€ã€‚</p></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0 0 100 100<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span>    <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>../imgs/1.png<span class="token punctuation">"</span></span>    <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>    <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>    <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span>    <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span>    <span class="token attr-name">preserveAspectRatio</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>xMinYMin meet<span class="token punctuation">"</span></span>  <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0 0 100 100<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span>    <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>../imgs/1.png<span class="token punctuation">"</span></span>    <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>    <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>    <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span>    <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span>    <span class="token attr-name">preserveAspectRatio</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>xMaxYMid slice<span class="token punctuation">"</span></span>  <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0 0 100 100<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span>    <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>../imgs/1.png<span class="token punctuation">"</span></span>    <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>    <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>    <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span>    <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span>    <span class="token attr-name">preserveAspectRatio</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span>  <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/81.png" alt="1682491367582" style="zoom:50%;" /><blockquote><p>ä½å›¾æ”¾å¤§ä¹‹åä¼šæœ‰å¤±çœŸçš„æƒ…å†µ</p></blockquote><h2 id="5-è£å‰ªä¸é®ç½©"><a href="#5-è£å‰ªä¸é®ç½©" class="headerlink" title="5 è£å‰ªä¸é®ç½©"></a>5 è£å‰ªä¸é®ç½©</h2><p>æ“¦é™¤å·²åˆ›å»ºå›¾å½¢çš„éƒ¨åˆ†å†…å®¹ã€‚</p><h3 id="1ï¼‰è£å‰ªè·¯å¾„"><a href="#1ï¼‰è£å‰ªè·¯å¾„" class="headerlink" title="1ï¼‰è£å‰ªè·¯å¾„"></a>1ï¼‰è£å‰ªè·¯å¾„</h3><p>è£å‰ªè·¯å¾„æ˜¯ç”± path ï¼Œ text ï¼Œ åŸºæœ¬å›¾å½¢ç»„æˆçš„å›¾å½¢ã€‚å°†å…¶ä½œç”¨åœ¨ç›®æ ‡å›¾å½¢ä¸Šã€‚è£å‰ªè·¯å¾„å†…çš„å›¾å½¢æ˜¯å¯è§çš„ã€‚</p><p>è¿™ä¸ªè£å‰ªè·¯å¾„å›¾å½¢æœ¬èº«çš„é¢œè‰²å’Œé€æ˜åº¦æ˜¯æ— æ•ˆçš„ï¼Œ åªæ˜¯ç”¨å›¾å½¢çš„åŒºåŸŸã€‚ä½†å˜å½¢æ˜¯ç”Ÿæ•ˆçš„ã€‚</p><p>ä½¿ç”¨<code>&lt;clipPath&gt;</code>æ ‡ç­¾å®šä¹‰è£å‰ªè·¯å¾„ï¼Œ ç›®æ ‡å›¾å½¢ä½¿ç”¨<code>clip-path</code>å±æ€§å¼•ç”¨è£å‰ªè·¯å¾„</p><blockquote><p>å¯ä»¥æ˜¯åŸºæœ¬å›¾å½¢æˆ– path è·¯å¾„åˆå›´å›¾å½¢</p></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>clipPath</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>clip1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>45<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span> <span class="token attr-name">fill-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0.8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>clipPath</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span>  <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fac<span class="token punctuation">"</span></span>  <span class="token attr-name">clip-path</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#clip1)<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span>  <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-dasharray</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.5<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/74.png" alt="1682500586138" style="zoom:50%;" /><blockquote><p>è£å‰ªè·¯å¾„å¯ä»¥ä½œç”¨åœ¨ç»„åˆå›¾å½¢ä¸Š</p></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>clipPath</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>clip2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>clipPath</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>g</span> <span class="token attr-name">clip-path</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#clip2)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>15<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fac<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>70<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>15<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fca<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>g</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>g</span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-dasharray</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.5<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>15<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>70<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>15<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>g</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/75.png" alt="1682500676156" style="zoom:50%;" /><blockquote><p>è£å‰ªè·¯å¾„ä½œç”¨åœ¨å›¾ç‰‡ä¸Š</p></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>clipPath</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>clip3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>clipPath</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>../imgs/1.png<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span> <span class="token attr-name">clip-path</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#clip13)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/76.png" alt="1682500733422" style="zoom:50%;" /><blockquote><p>ä½¿ç”¨æ–‡å­—ä½œä¸ºè£å‰ªè·¯å¾„</p></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>clipPath</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>clip4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">font-size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">text-anchor</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>middle<span class="token punctuation">"</span></span> <span class="token attr-name">font-weight</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bold<span class="token punctuation">"</span></span>      <span class="token punctuation">></span></span>I am DMC<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span>    <span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>clipPath</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>linearGradient</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gradient1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span> <span class="token attr-name">stop-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.25<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#ff0<span class="token punctuation">"</span></span> <span class="token attr-name">stop-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#0f0<span class="token punctuation">"</span></span> <span class="token attr-name">stop-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.75<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#0ff<span class="token punctuation">"</span></span> <span class="token attr-name">stop-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token attr-name">stop-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>linearGradient</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>  <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#gradient1)<span class="token punctuation">"</span></span>  <span class="token attr-name">clip-path</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#clip4)<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/77.png" alt="1682501219200" style="zoom:50%;" /><blockquote><p>è£å‰ªè·¯å¾„é…åˆå˜å½¢</p></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0 0 100 100<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>clipPath</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>clip5<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>clipPath</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span>    <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>../imgs/1.png<span class="token punctuation">"</span></span>    <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span>    <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span>    <span class="token attr-name">clip-path</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#clip5)<span class="token punctuation">"</span></span>    <span class="token attr-name">transform</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rotate(45,50,40)<span class="token punctuation">"</span></span>  <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0 0 100 100<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>clipPath</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>clip6<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>clipPath</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>g</span> <span class="token attr-name">clip-path</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#clip6)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span>      <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>../imgs/1.png<span class="token punctuation">"</span></span>      <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span>      <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span>      <span class="token attr-name">transform</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rotate(45,50,40)<span class="token punctuation">"</span></span>    <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>g</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0 0 100 100<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>clipPath</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>clip7<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">transform</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rotate(45,50,40)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>clipPath</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span>    <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>../imgs/1.png<span class="token punctuation">"</span></span>    <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span>    <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span>    <span class="token attr-name">clip-path</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#clip7)<span class="token punctuation">"</span></span>  <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/78.png" alt="1682500872815" style="zoom:50%;" /><blockquote><p>è£å‰ªè·¯å¾„çš„<strong>clipPathUnits</strong>å±æ€§ï¼Œæœ‰ä¸¤ä¸ªå€¼</p><ul><li><p>userSpaceOnUse ï¼ˆé»˜è®¤å€¼ï¼‰ è®¾ç½®è£å‰ªè·¯å¾„æ—¶ï¼Œä½¿ç”¨å…·ä½“æ•°å€¼è®¾ç½®ï¼Œå‚è€ƒåæ ‡ç³» ï¼ˆç»å¯¹è·¯å¾„ï¼‰</p><p>è£å‰ªåŒºåŸŸä¸å˜ï¼Œéšç€ç›®æ ‡å›¾å½¢ä½ç½®å’Œå¤§å°æ”¹å˜ï¼Œ æœ€ç»ˆçš„è£å‰ªç»“æœä¼šå‘ç”Ÿå˜åŒ–ã€‚</p></li><li><p>objectBoundingBox åŸºäºè£å‰ªè·¯å¾„æ‰€åº”ç”¨çš„å›¾å½¢ï¼Œ ä½¿ç”¨ç™¾åˆ†æ¯”è®¾ç½®ï¼ˆç›¸å¯¹è·¯å¾„ï¼‰</p><p>è£å‰ªåŒºåŸŸç›¸å¯¹äºç›®æ ‡å›¾å½¢ï¼Œæ— è®ºç›®æ ‡å›¾å½¢çš„ä½ç½®å’Œå¤§å°å¦‚ä½•æ”¹å˜ï¼Œ è£å‰ªåŒºåŸŸçš„è®¡ç®—ä¸å˜ã€‚</p></li></ul></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>clipPath</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>clip8<span class="token punctuation">"</span></span> <span class="token attr-name">clipPathUnits</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>objectBoundingBox<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>clipPath</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>  <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fac<span class="token punctuation">"</span></span>  <span class="token attr-name">clip-path</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#clip8)<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>  <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-dasharray</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.5<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/79.png" alt="1682500881702" style="zoom:50%;" /><h3 id="2ï¼‰é®ç½©"><a href="#2ï¼‰é®ç½©" class="headerlink" title="2ï¼‰é®ç½©"></a>2ï¼‰é®ç½©</h3><p>è£å‰ªè·¯å¾„åªèƒ½æ§åˆ¶å›¾å½¢åŒºåŸŸå±•ç¤ºæˆ–ä¸å±•ç¤ºã€‚</p><p>é®ç½©ä¸ä»…ä»…å¯ä»¥æ§åˆ¶å›¾å½¢åŒºåŸŸçš„å±•ç¤ºä¸å¦ï¼Œè¿˜å¯ä»¥æ§åˆ¶é€æ˜åº¦ï¼Œè¿˜å¯ä»¥å±‚å ï¼ˆä¸€éƒ¨åˆ†å±•ç¤ºï¼Œè¿™éƒ¨åˆ†ä¸­çš„å°éƒ¨åˆ†ä¸å±•ç¤ºï¼‰</p><p>ä½¿ç”¨<code>&lt;mask&gt;</code>æ ‡ç­¾å®šä¹‰é®ç½©ã€‚ å›¾å½¢ä½¿ç”¨<code>mask</code>å±æ€§å¼•ç”¨é®ç½©ã€‚</p><blockquote><p>åŸºæœ¬åº”ç”¨</p></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mask</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mask1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fff<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mask</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fac<span class="token punctuation">"</span></span> <span class="token attr-name">mask</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#mask1)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>  <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-dasharray</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.5<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é®ç½©çš„åŒºåŸŸä¼šé€æ˜åŒ–ã€‚æ‰€ä»¥èƒŒåçš„å›¾å½¢æ˜¯å¯è§çš„ã€‚</p><p>åœ¨é®ç½©ä¸­è®¾è®¡è·¯å¾„(path , text , åŸºç¡€å›¾å½¢)ï¼ŒæŒ‡å®šé¢œè‰²</p><ul><li>white è¡¨ç¤ºæ˜¾ç¤ºï¼Œ</li><li>black è¡¨ç¤ºä¸æ˜¾ç¤º</li><li>gray è¡¨ç¤ºåŠé€æ˜æ˜¾ç¤º</li></ul><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/82.png" alt="1682577033696" style="zoom:50%;" /><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="C:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1682577042955.png" alt="1682577042955"></p><blockquote><p>å±‚å åº”ç”¨</p></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mask</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mask2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>white<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>black<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>5<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gray<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mask</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fac<span class="token punctuation">"</span></span> <span class="token attr-name">mask</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#mask2)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>  <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-dasharray</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.5<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/83.png" alt="1682577042955" style="zoom:50%;" /><blockquote><p>æ¸å˜åº”ç”¨</p></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>linearGradient</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gradient3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fff<span class="token punctuation">"</span></span> <span class="token attr-name">stop-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fff<span class="token punctuation">"</span></span> <span class="token attr-name">stop-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>linearGradient</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mask</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mask3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#gradient3)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mask</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fac<span class="token punctuation">"</span></span> <span class="token attr-name">mask</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#mask3)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>  <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-dasharray</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.5<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>é®ç½©ä¸­çš„é¢œè‰²æœ€ç»ˆä¼šè½å®åˆ°é€æ˜åº¦ä¸Šï¼Œ æ‰€ä»¥éƒ½è®¾ç½®#fffï¼Œç›´æ¥æ§åˆ¶é€æ˜åº¦ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</p></blockquote><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/84.png" alt="1682577057331" style="zoom:50%;" /><blockquote><p>maskContentUnits å±æ€§</p><ul><li><p>userSpaceOnUse (é»˜è®¤å€¼) ,ä½ç½®ï¼ŒåŒºåŸŸèŒƒå›´å‚è€ƒåæ ‡ç³» ï¼Œ ä½¿ç”¨å…·ä½“æ•°å€¼ã€‚</p><p>å›¾å½¢ä½ç½®å’Œå¤§å°æ”¹å˜ï¼Œé®ç½©ä½ç½®å’ŒåŒºåŸŸä¸å˜ã€‚</p></li><li><p>objectBoundingBox ï¼Œä½ç½®å’ŒåŒºåŸŸèŒƒå›´å‚è€ƒåæ ‡ç³»ï¼Œéœ€è¦ä½¿ç”¨ç™¾åˆ†æ¯”ã€‚</p><p>å¯ä»¥éšæ„æ›´æ”¹å›¾å½¢çš„å¤§å°å’Œä½ç½®</p></li></ul></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>linearGradient</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gradient4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#000<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fff<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>linearGradient</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mask</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mask4<span class="token punctuation">"</span></span> <span class="token attr-name">maskContentUnits</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>objectBoundingBox<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#gradient4)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mask</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fac<span class="token punctuation">"</span></span> <span class="token attr-name">mask</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#mask4)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>  <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-dasharray</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.5<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/85.png" alt="1682579195476" style="zoom:50%;" /><blockquote><p>mask æ ‡ç­¾æœ¬èº« æœ‰ x y width height è®¾ç½®å¯ä»¥ç”¨æ¥è°ƒæ•´é®ç½©æ•ˆæœçš„èŒƒå›´ã€‚åªå…è®¸åœ¨æŒ‡å®šåŒºåŸŸåº”ç”¨é®ç½©ã€‚</p><p>æ­¤æ—¶è¿˜è¦é…åˆ maskUnits å±æ€§</p><ul><li>objectBoundingBox ï¼ˆé»˜è®¤å€¼ï¼‰ ï¼Œ é»˜è®¤å‚è€ƒå›¾å½¢</li><li>userSpaceOnUse å‚è€ƒåæ ‡ç³»</li></ul></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>linearGradient</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gradient5<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#000<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fff<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>linearGradient</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mask</span>    <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mask5<span class="token punctuation">"</span></span>    <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>    <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>    <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span>    <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span>    <span class="token attr-name">maskContentUnits</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>objectBoundingBox<span class="token punctuation">"</span></span>    <span class="token attr-name">maskUnits</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>objectBoundingBox<span class="token punctuation">"</span></span>  <span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#gradient5)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mask</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fac<span class="token punctuation">"</span></span> <span class="token attr-name">mask</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#mask5)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>  <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-dasharray</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.5<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/86.png" alt="1682579213217" style="zoom:50%;" /><blockquote><p>å°æ¡ˆä¾‹</p></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>linearGradient</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gradient61<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#333<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stop</span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">stop-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fff<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>linearGradient</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>linearGradient</span>    <span class="token attr-name">x1</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span>    <span class="token attr-name">x2</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>    <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gradient62<span class="token punctuation">"</span></span>    <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#gradient61<span class="token punctuation">"</span></span>  <span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>linearGradient</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mask</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mask6<span class="token punctuation">"</span></span> <span class="token attr-name">maskContentUnits</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>objectBoundingBox<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#gradient61)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#gradient62)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>white<span class="token punctuation">"</span></span> <span class="token attr-name">fill-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mask</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span>  <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>../imgs/3.png<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span>  <span class="token attr-name">preserveAspectRatio</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>xMinYMid slice<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span>  <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>../imgs/4.png<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span>  <span class="token attr-name">preserveAspectRatio</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>xMidYMid slice<span class="token punctuation">"</span></span>  <span class="token attr-name">mask</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#mask6)<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/87.png" alt="1682579253983" style="zoom:50%;" /><h2 id="6-å›¾æ¡ˆå¡«å……"><a href="#6-å›¾æ¡ˆå¡«å……" class="headerlink" title="6 å›¾æ¡ˆå¡«å……"></a>6 å›¾æ¡ˆå¡«å……</h2><p>ä½¿ç”¨<code>&lt;pattern&gt;</code>æ ‡ç­¾å®šä¹‰ä¸€ä¸ªå›¾æ¡ˆï¼ˆå›¾å½¢ ï¼Œ image å›¾ç‰‡ï¼‰</p><p>å›¾åƒä¸­ä½¿ç”¨<code>fill</code>å±æ€§å¼•å…¥å›¾æ¡ˆã€‚ å›¾æ¡ˆåŒºåŸŸå°äºå›¾åƒåŒºåŸŸï¼Œä¼šè‡ªåŠ¨å¹³é“ºã€‚</p><h3 id="1ï¼‰å¿«é€Ÿåº”ç”¨"><a href="#1ï¼‰å¿«é€Ÿåº”ç”¨" class="headerlink" title="1ï¼‰å¿«é€Ÿåº”ç”¨"></a>1ï¼‰å¿«é€Ÿåº”ç”¨</h3><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pattern1<span class="token punctuation">"</span></span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.25<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.25<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#acf<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>80<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>80<span class="token punctuation">"</span></span>  <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#pattern1)<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-dasharray</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.5<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fac<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">font-size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>4<span class="token punctuation">"</span></span> <span class="token attr-name">text-anchor</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>middle<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>èµ·å§‹åŒºåŸŸ<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>x y width height è®¡ç®—å›¾æ¡ˆçš„åŒºåŸŸï¼ˆé»˜è®¤æ ¹æ®åŒºåŸŸå¤§å°è¿›è¡Œå¹³é“ºï¼‰</p><p>åœ¨å›¾æ¡ˆåŒºåŸŸå†…è®¾è®¡å…·ä½“çš„å›¾æ¡ˆå†…å®¹</p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/88.png" alt="1682583041115" style="zoom:50%;" /><h3 id="2ï¼‰å•å…ƒç³»ç»Ÿ"><a href="#2ï¼‰å•å…ƒç³»ç»Ÿ" class="headerlink" title="2ï¼‰å•å…ƒç³»ç»Ÿ"></a>2ï¼‰å•å…ƒç³»ç»Ÿ</h3><p>æœ‰ 2 ä¸ªå•å…ƒç³»ç»Ÿå±æ€§</p><blockquote><p>patternUnits å±æ€§ï¼Œç”¨æ¥è®¾ç½®å›¾æ¡ˆåŒºåŸŸçš„å•å…ƒç³»ç»Ÿ</p><ul><li>objectBoundingBox ï¼ˆé»˜è®¤å€¼ï¼‰ å€¼æ˜¯ç™¾åˆ†æ¯”ï¼Œ å‚è€ƒçš„æ˜¯ç›®æ ‡å›¾å½¢ã€‚</li><li>userSpaceOnUse å‚è€ƒåæ ‡ç³»</li></ul></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span>    <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pattern2<span class="token punctuation">"</span></span>    <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>    <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>    <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>    <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>    <span class="token attr-name">patternUnits</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>userSpaceOnUse<span class="token punctuation">"</span></span>  <span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#acf<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>80<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>80<span class="token punctuation">"</span></span>  <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#pattern2)<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-dasharray</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.5<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fac<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">font-size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>4<span class="token punctuation">"</span></span> <span class="token attr-name">text-anchor</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>middle<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>èµ·å§‹åŒºåŸŸ<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/89.png" alt="1682584423137" style="zoom:50%;" /><blockquote><p>patternContentUnits å±æ€§ï¼Œç”¨æ¥è®¾ç½®å›¾æ¡ˆåŒºåŸŸå†…éƒ¨å…·ä½“å›¾å½¢çš„å•å…ƒç³»ç»Ÿã€‚</p><ul><li>userSpaceOnUse (é»˜è®¤å€¼) ï¼Œä½¿ç”¨å…·ä½“çš„å€¼</li><li>objectBoundingBox ï¼Œä½¿ç”¨ç™¾åˆ†æ¯”ï¼Œå‚è€ƒç›®æ ‡å›¾å½¢</li><li>æ— è®ºæ˜¯å“ªä¸€ç§å•å…ƒç³»ç»Ÿï¼Œx å’Œ y å…¶å®ä½ç½®éƒ½æ˜¯å‚è€ƒçš„å›¢åŒºåŸŸã€‚</li></ul></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span>    <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pattern4<span class="token punctuation">"</span></span>    <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>    <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>    <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.25<span class="token punctuation">"</span></span>    <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.25<span class="token punctuation">"</span></span>    <span class="token attr-name">patternUnits</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>objectBoundingBox<span class="token punctuation">"</span></span>    <span class="token attr-name">patternContentUnits</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>objectBoundingBox<span class="token punctuation">"</span></span>  <span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.125<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.125<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.125<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#acf<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token comment" spellcheck="true">&lt;!-- æ”¹å˜x y width height çš„å€¼ï¼Œè§‚å¯Ÿæ•ˆæœ --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>  <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#pattern4)<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-dasharray</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.5<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/90.png" alt="1682584780518" style="zoom:50%;" /><blockquote><p>ä½¿ç”¨ç™¾åˆ†æ¯”å•å…ƒç³»ç»Ÿï¼Œåœ¨å›¾å½¢æ”¾å¤§ç¼©å°æ—¶ï¼Œ å¡«å……é€»è¾‘ä¸å˜ã€‚</p></blockquote><h3 id="3ï¼‰viewBox-æ”¾ç¼©"><a href="#3ï¼‰viewBox-æ”¾ç¼©" class="headerlink" title="3ï¼‰viewBox æ”¾ç¼©"></a>3ï¼‰viewBox æ”¾ç¼©</h3><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span>    <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>5 2 10 10<span class="token punctuation">"</span></span>    <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pattern7<span class="token punctuation">"</span></span>    <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>    <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>    <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>    <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>    <span class="token attr-name">patternUnits</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>userSpaceOnUse<span class="token punctuation">"</span></span>    <span class="token attr-name">patternContentUnits</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span>  <span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span>      <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>../imgs/1.png<span class="token punctuation">"</span></span>      <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>      <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>      <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>      <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>      <span class="token attr-name">preserveAspectRatio</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>xMidYMid slice<span class="token punctuation">"</span></span>    <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>  <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#pattern7)<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-dasharray</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.5<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨å›¾æ¡ˆåŒºåŸŸä¸­æœ‰ä¸€ä¸ªåæ ‡ç³»ï¼Œ åŸºäºè¿™ä¸ªåæ ‡ï¼Œ åˆ©ç”¨ viewbox çš„ x , y ,width , height æˆªå–æˆ‘ä»¬éœ€è¦çš„éƒ¨åˆ†</p><p>å°†å…¶è£…è½½åˆ°å›¾æ¡ˆåŒºåŸŸä¸­ï¼ŒåŸºäº pattern.width å’Œ height åšä¸€ä¸ªæ”¾ç¼©ã€‚</p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/91.png" alt="1682585899698" style="zoom:50%;" /><h3 id="4ï¼‰å›¾æ¡ˆåµŒå¥—"><a href="#4ï¼‰å›¾æ¡ˆåµŒå¥—" class="headerlink" title="4ï¼‰å›¾æ¡ˆåµŒå¥—"></a>4ï¼‰å›¾æ¡ˆåµŒå¥—</h3><p>åœ¨ä¸€ä¸ª pattern å›¾æ¡ˆä¸­ï¼Œå¯ä»¥åµŒå¥—å¼•ç”¨å¦ä¸€ä¸ª pattern å›¾æ¡ˆ</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span>    <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pattern82<span class="token punctuation">"</span></span>    <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>    <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>    <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.25<span class="token punctuation">"</span></span>    <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.25<span class="token punctuation">"</span></span>    <span class="token attr-name">patternUnits</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>objectBoundingBox<span class="token punctuation">"</span></span>    <span class="token attr-name">patternContentUnits</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>objectBoundingBox<span class="token punctuation">"</span></span>  <span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.125<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.125<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.125<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#caf<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span>    <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>pattern81<span class="token punctuation">"</span></span>    <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>    <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>    <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.25<span class="token punctuation">"</span></span>    <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.25<span class="token punctuation">"</span></span>    <span class="token attr-name">patternUnits</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>objectBoundingBox<span class="token punctuation">"</span></span>    <span class="token attr-name">patternContentUnits</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>objectBoundingBox<span class="token punctuation">"</span></span>  <span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.125<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.125<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.125<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#pattern82)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>80<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>80<span class="token punctuation">"</span></span>  <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#pattern81)<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke-dasharray</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2.5<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>åµŒå¥—å›¾æ¡ˆè®¾è®¡æ—¶çš„å•å…ƒç³»ç»Ÿï¼Œå‚è€ƒçš„æ˜¯å¤–å›´å›¾æ¡ˆçš„åŒºåŸŸã€‚</p></blockquote><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/92.png" alt="1682587098724" style="zoom:50%;" /><h2 id="7-åŠ¨ç”»"><a href="#7-åŠ¨ç”»" class="headerlink" title="7 åŠ¨ç”»"></a>7 åŠ¨ç”»</h2><p>SVG åŠ¨ç”»æ”¯æŒ SMIL è§„èŒƒï¼Œå¯ä»¥å®ç°å…³é”®å¸§ï¼Œç§»åŠ¨å›¾å½¢ï¼Œæ”¹å˜é¢œè‰²ç­‰æ•ˆæœã€‚</p><p>SVG åŠ¨ç”»å¯ä»¥å®ç°ä¸€äº› CSS ä¸å®¹æ˜“å®ç°çš„æ•ˆæœï¼šè·¯å¾„åŠ¨ç”»ï¼Œå›¾å½¢åŠ¨ç”»ç­‰</p><p>å¸¸ç”¨çš„åŠ¨ç”»æ ‡ç­¾ï¼š</p><ul><li><code>&lt;animate&gt;</code></li><li><code>&lt;anmiateTransform&gt;</code></li><li><code>&lt;nimateMotion&gt;</code></li><li><code>&lt;set&gt;</code></li></ul><h3 id="1ï¼‰animate-åŸºç¡€åŠ¨ç”»"><a href="#1ï¼‰animate-åŸºç¡€åŠ¨ç”»" class="headerlink" title="1ï¼‰animate åŸºç¡€åŠ¨ç”»"></a>1ï¼‰animate åŸºç¡€åŠ¨ç”»</h3><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>animate</span>    <span class="token attr-name">attributeType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>XML<span class="token punctuation">"</span></span>    <span class="token attr-name">attributeName</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>cx<span class="token punctuation">"</span></span>    <span class="token attr-name">from</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span>    <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>    <span class="token attr-name">dur</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1s<span class="token punctuation">"</span></span>    <span class="token attr-name">repeatCount</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span>    <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>freeze<span class="token punctuation">"</span></span>  <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>circle</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><iframe src="images/03.html" />  > åŠ¨ç”»æ ‡ç­¾é»˜è®¤å®šä¹‰åœ¨å›¾å½¢æ ‡ç­¾å†…éƒ¨ï¼Œè¡¨ç¤ºå¯¹å½“å‰å›¾å½¢è¿›è¡ŒåŠ¨ç”»è®¾ç½®ã€‚>> ä¹Ÿå¯ä»¥å•ç‹¬å®šä¹‰åŠ¨ç”»æ ‡ç­¾ï¼Œåˆ©ç”¨åŠ¨ç”»æ ‡ç­¾çš„hrefå±æ€§ + å›¾å½¢çš„id ï¼Œ ä¸ºæŒ‡å®šå›¾å½¢è®¾ç½®åŠ¨ç”»ã€‚<pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>circle</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>c2<span class="token punctuation">"</span></span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>circle</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>animate</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#c2<span class="token punctuation">"</span></span> <span class="token attr-name">...</span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>å¯ä»¥ä½¿ç”¨å¤šä¸ªåŠ¨ç”»æ ‡ç­¾ï¼Œæ§åˆ¶å¤šä¸ªå±æ€§çš„åŠ¨ç”»å˜åŒ–ã€‚</p></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>animate</span>    <span class="token attr-name">attributeType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>XML<span class="token punctuation">"</span></span>    <span class="token attr-name">attributeName</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>cx<span class="token punctuation">"</span></span>    <span class="token attr-name">from</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span>    <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>    <span class="token attr-name">dur</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1s<span class="token punctuation">"</span></span>    <span class="token attr-name">repeatCount</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span>    <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>freeze<span class="token punctuation">"</span></span>  <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>animate</span>    <span class="token attr-name">attributeType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>XML<span class="token punctuation">"</span></span>    <span class="token attr-name">attributeName</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>cy<span class="token punctuation">"</span></span>    <span class="token attr-name">from</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span>    <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>    <span class="token attr-name">dur</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1s<span class="token punctuation">"</span></span>    <span class="token attr-name">repeatCount</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span>    <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>freeze<span class="token punctuation">"</span></span>  <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>circle</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><iframe src="images/04.html" />  ### 2ï¼‰åŠ¨ç”»å±æ€§<h4 id="attribute-æ§åˆ¶åŠ¨ç”»å±æ€§"><a href="#attribute-æ§åˆ¶åŠ¨ç”»å±æ€§" class="headerlink" title="attribute æ§åˆ¶åŠ¨ç”»å±æ€§"></a>attribute æ§åˆ¶åŠ¨ç”»å±æ€§</h4><ul><li><p>attributeType è®¾ç½®åŠ¨ç”»å±æ€§çš„ç±»å‹ï¼Œ ä¸€èˆ¬ä¸å»ºè®®è®¾ç½®ã€‚ä½¿ç”¨é»˜è®¤å³å¯ã€‚</p><ul><li>auto é»˜è®¤</li><li>CSS</li><li>XML</li></ul></li><li><p>attributeName è®¾ç½®å…·ä½“çš„åŠ¨ç”»å±æ€§ã€‚ æ”¯æŒ SVG å±æ€§ï¼Œä¹Ÿåªæ˜¯ CSS å±æ€§ã€‚</p><p><code>&lt;animate attributeName=&quot;r&quot; ... &gt;</code></p></li></ul><h4 id="from-to-by-æ§åˆ¶åŠ¨ç”»æ•°å€¼"><a href="#from-to-by-æ§åˆ¶åŠ¨ç”»æ•°å€¼" class="headerlink" title="from/to/by æ§åˆ¶åŠ¨ç”»æ•°å€¼"></a>from/to/by æ§åˆ¶åŠ¨ç”»æ•°å€¼</h4><p>æ§åˆ¶ä»å“ªä¸ªå€¼åˆ°å“ªä¸ªå€¼ä¹‹é—´å‘ç”ŸåŠ¨ç”»å˜åŒ–ã€‚</p><ul><li><p>from ä»å“ªä¸ªå€¼å¼€å§‹ ã€‚ å¯ä»¥ç¼ºçœï¼Œä¸å›¾å½¢çš„åˆå§‹å€¼ç›¸åŒã€‚</p></li><li><p>to åˆ°å“ªä¸ªå€¼ç»“æŸ ã€‚ æ˜¯ä¸€ä¸ªå…·ä½“çš„å€¼</p></li><li><p>by ç»è¿‡å¤šå°‘å€¼ã€‚ ä¸ to äºŒé€‰ä¸€ã€‚ æ˜¯ä¸€ä¸ªç›¸å¯¹çš„å€¼ã€‚</p></li></ul><pre class="line-numbers language-text"><code class="language-text">from 30 to 60   ä»30 åˆ°60from 30 by 60   ä»30 ç»è¿‡60  [åˆ°90]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><iframe src="images/05.html"/> #### dur æ§åˆ¶åŠ¨ç”»æ—¶é•¿<p>æ§åˆ¶å¤šä¹…å®ŒæˆåŠ¨ç”»</p><ul><li>å¯ä»¥æ˜¯å•ä¸€çš„æ—¶é—´å•ä½ ï¼š 1s , 100ms , 1m</li><li>ä¹Ÿå¯ä»¥æ˜¯æ—¶é—´ç»„åˆ ï¼š 1.500 ï¼ˆ1s + 500 æ¯«ç§’ï¼‰ ï¼Œ 01:01.500 ï¼ˆ1min + 1s + 500msï¼‰</li></ul><h4 id="repeatCount-æ§åˆ¶åŠ¨ç”»æ¬¡æ•°"><a href="#repeatCount-æ§åˆ¶åŠ¨ç”»æ¬¡æ•°" class="headerlink" title="repeatCount æ§åˆ¶åŠ¨ç”»æ¬¡æ•°"></a>repeatCount æ§åˆ¶åŠ¨ç”»æ¬¡æ•°</h4><ul><li>å¯ä»¥æ˜¯ä¸€ä¸ªå…·ä½“çš„æ¬¡æ•°ï¼š 1 ï¼Œ 2 ï¼Œ 3</li><li>å¯ä»¥æ˜¯æ— é™æ¬¡ ï¼š indefinite</li></ul><h4 id="repeatDur-æ§åˆ¶åŠ¨ç”»æ€»æ—¶é•¿"><a href="#repeatDur-æ§åˆ¶åŠ¨ç”»æ€»æ—¶é•¿" class="headerlink" title="repeatDur æ§åˆ¶åŠ¨ç”»æ€»æ—¶é•¿"></a>repeatDur æ§åˆ¶åŠ¨ç”»æ€»æ—¶é•¿</h4><p>åœ¨é‡å¤åŠ¨ç”»æ—¶ï¼Œæœ€å¤§åŠ¨ç”»æ—¶é•¿ã€‚</p><p>ä¾‹å¦‚ï¼š1s å®Œæˆä¸€æ¬¡åŠ¨ç”»ï¼Œ æ— é™åŠ¨ç”»ã€‚ ä½†è§„å®šåªä¼šè¿›è¡Œ 5s ä¸­çš„åŠ¨ç”»ï¼Œ ç›¸å½“äºå®Œæˆ 5 æ¬¡æŠ€æœ¯ã€‚</p><h4 id="fill-æ§åˆ¶æœ€ç»ˆå½¢æ€"><a href="#fill-æ§åˆ¶æœ€ç»ˆå½¢æ€" class="headerlink" title="fill æ§åˆ¶æœ€ç»ˆå½¢æ€"></a>fill æ§åˆ¶æœ€ç»ˆå½¢æ€</h4><p>æ§åˆ¶åŠ¨ç”»æ‰§è¡Œå®Œæ¯•æ—¶ï¼Œé‚£ä¸€æ—¶åˆ»çš„çŠ¶æ€ã€‚</p><ul><li>remove é»˜è®¤ï¼Œ ç§»é™¤åŠ¨ç”»æœ€ç»ˆçš„æ•ˆæœï¼Œä»è€Œæ¢å¤å¼€å§‹çŠ¶æ€ã€‚</li><li>freeze ï¼Œ ä¿ç•™åŠ¨ç”»æœ€ç»ˆçš„æ•ˆæœã€‚</li></ul><h4 id="begin-end-æ§åˆ¶åŠ¨ç”»èµ·å§‹"><a href="#begin-end-æ§åˆ¶åŠ¨ç”»èµ·å§‹" class="headerlink" title="begin/end æ§åˆ¶åŠ¨ç”»èµ·å§‹"></a>begin/end æ§åˆ¶åŠ¨ç”»èµ·å§‹</h4><p>æ§åˆ¶åŠ¨ç”»ä½•æ—¶å¼€å§‹/ç»“æŸã€‚</p><ul><li>é»˜è®¤æƒ…å†µä¸‹æ˜¯åŠ è½½å³å¼€å§‹ã€‚ ï¼ˆåŠ¨ç”»æ•ˆæœæ‰§è¡Œå®Œæ¯•å³ç»“æŸï¼‰</li></ul><blockquote><p>æ§åˆ¶åŠ¨ç”»å»¶è¿Ÿå¼€å§‹</p></blockquote><p><code>begin=&quot;2s&quot;</code> 2s åå¼€å§‹åŠ¨ç”»ã€‚</p><blockquote><p>æ§åˆ¶åŠ¨ç”»åœ¨æŸä¸€ä¸ªå›¾å½¢äº‹ä»¶åå¼€å§‹</p></blockquote><ul><li><p>click , mouseover , mousedown , mouseout,moursemove</p></li><li><p>ä¹Ÿå¯ä»¥æ˜¯å½“å‰å›¾å½¢äº‹ä»¶ã€‚</p></li><li><p><code>begin=&quot;id.click&quot;</code></p><p>è¿™é‡Œæ˜¯æ˜¯å›¾å½¢æ ‡ç­¾çš„ id</p></li></ul><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/93.png" alt="1683189332953"></p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>animate</span>    <span class="token attr-name">attributeName</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>cx<span class="token punctuation">"</span></span>    <span class="token attr-name">from</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span>    <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>    <span class="token attr-name">dur</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1s<span class="token punctuation">"</span></span>    <span class="token attr-name">begin</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>btn2.mouseover<span class="token punctuation">"</span></span>    <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>freeze<span class="token punctuation">"</span></span>  <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>circle</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>g</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">cursor</span><span class="token punctuation">:</span>pointer</span><span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>btn2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span>    <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>    <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>    <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>    <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>    <span class="token attr-name">rx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>5<span class="token punctuation">"</span></span>    <span class="token attr-name">ry</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>5<span class="token punctuation">"</span></span>    <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#ccc<span class="token punctuation">"</span></span>    <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#000<span class="token punctuation">"</span></span>  <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>67<span class="token punctuation">"</span></span> <span class="token attr-name">font-size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>6<span class="token punctuation">"</span></span> <span class="token attr-name">text-anchor</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>middle<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>ç§»å…¥<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>g</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><iframe src="images/06.html" /> > æ§åˆ¶åŠ¨ç”»åœ¨æŸä¸€ä¸ªåŠ¨ç”»å¼€å§‹/ç»“æŸæ—¶å¼€å§‹<p><code>begin=&quot;id.end&quot;</code></p><p>è¿™é‡Œæ˜¯åŠ¨ç”»æ ‡ç­¾çš„ id</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>animate</span>    <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>a31<span class="token punctuation">"</span></span>    <span class="token attr-name">attributeType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>XML<span class="token punctuation">"</span></span>    <span class="token attr-name">attributeName</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width<span class="token punctuation">"</span></span>    <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>    <span class="token attr-name">dur</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2s<span class="token punctuation">"</span></span>    <span class="token attr-name">begin</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2s<span class="token punctuation">"</span></span>    <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>freeze<span class="token punctuation">"</span></span>  <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rect</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>animate</span>    <span class="token attr-name">attributeType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>XML<span class="token punctuation">"</span></span>    <span class="token attr-name">attributeName</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width<span class="token punctuation">"</span></span>    <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>    <span class="token attr-name">dur</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2s<span class="token punctuation">"</span></span>    <span class="token attr-name">begin</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>a31.end<span class="token punctuation">"</span></span>    <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>freeze<span class="token punctuation">"</span></span>  <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rect</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><iframe src="images/07.html"><blockquote><p>å¯ä»¥æ§åˆ¶å¤šæ¬¡åŠ¨ç”»çš„å¼€å§‹æ¡ä»¶ï¼Œ å¤šä¸ªæ¡ä»¶ä½¿ç”¨åˆ†å·åˆ†å‰²ã€‚</p></blockquote><p><code>id=&quot;a41&quot; begin=&quot;2s;a42.end&quot;</code></p><p><code>id=&quot;a42&quot; begin=&quot;a41.end&quot;</code></p><p>ï¼ˆæ­»å¾ªç¯ï¼‰</p><iframe src="images/08.html"><blockquote><p>æ§åˆ¶æŸä¸€ä¸ªåŠ¨ç”»æ‰§è¡ŒæŒ‡å®šæ¬¡æ•°åï¼Œå½“å‰åŠ¨ç”»å¼€å§‹</p></blockquote><p><code>begin=&quot;a51.repeat(2)&quot;</code></p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>animate</span>    <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>a51<span class="token punctuation">"</span></span>    <span class="token attr-name">attributeType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>XML<span class="token punctuation">"</span></span>    <span class="token attr-name">attributeName</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width<span class="token punctuation">"</span></span>    <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>    <span class="token attr-name">dur</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2s<span class="token punctuation">"</span></span>    <span class="token attr-name">begin</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2s<span class="token punctuation">"</span></span>    <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>freeze<span class="token punctuation">"</span></span>    <span class="token attr-name">repeatCount</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>3<span class="token punctuation">"</span></span>  <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rect</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>animate</span>    <span class="token attr-name">attributeType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>XML<span class="token punctuation">"</span></span>    <span class="token attr-name">attributeName</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width<span class="token punctuation">"</span></span>    <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>    <span class="token attr-name">dur</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2s<span class="token punctuation">"</span></span>    <span class="token attr-name">begin</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>a51.repeat(2)<span class="token punctuation">"</span></span>    <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>freeze<span class="token punctuation">"</span></span>  <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rect</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><iframe src="images/09.html" ><blockquote><p>end ä¸ begin æœ‰ç›¸åŒçš„æ§åˆ¶ç‰¹æ€§ã€‚</p></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>animate</span>    <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>a61<span class="token punctuation">"</span></span>    <span class="token attr-name">attributeType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>XML<span class="token punctuation">"</span></span>    <span class="token attr-name">attributeName</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width<span class="token punctuation">"</span></span>    <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>    <span class="token attr-name">dur</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>3s<span class="token punctuation">"</span></span>    <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>freeze<span class="token punctuation">"</span></span>    <span class="token attr-name">repeatCount</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span>  <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rect</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>animate</span>    <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>a61<span class="token punctuation">"</span></span>    <span class="token attr-name">attributeType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>XML<span class="token punctuation">"</span></span>    <span class="token attr-name">attributeName</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width<span class="token punctuation">"</span></span>    <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>    <span class="token attr-name">dur</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1s<span class="token punctuation">"</span></span>    <span class="token attr-name">end</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>a61.end<span class="token punctuation">"</span></span>    <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>freeze<span class="token punctuation">"</span></span>    <span class="token attr-name">repeatCount</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>indefinite<span class="token punctuation">"</span></span>  <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rect</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><iframe src="images/10.html" />#### restart æ§åˆ¶é‡å¤åŠ¨ç”»<ul><li>always é»˜è®¤å€¼ï¼Œ ä»»ä½•æ—¶åˆ»éƒ½å…è®¸é‡æ–°å¼€å§‹åŠ¨ç”»ã€‚</li><li>whenNotActive å®Œæˆä¸€æ¬¡åŠ¨ç”»ï¼Œæ‰èƒ½å¼€å§‹ä¸‹ä¸€æ¬¡åŠ¨ç”»</li><li>never ä¸èƒ½é‡å¤åŠ¨ç”»ï¼ˆåªèƒ½æ‰§è¡Œä¸€æ¬¡ï¼‰</li></ul><iframe src="images/11.html"><h4 id="values-keyTimes-æ§åˆ¶åŠ¨ç”»è¿‡ç¨‹"><a href="#values-keyTimes-æ§åˆ¶åŠ¨ç”»è¿‡ç¨‹" class="headerlink" title="values/keyTimes æ§åˆ¶åŠ¨ç”»è¿‡ç¨‹"></a>values/keyTimes æ§åˆ¶åŠ¨ç”»è¿‡ç¨‹</h4><p>å¯ä»¥å¯¹åŠ¨ç”»è¿‡ç¨‹æ‹†åˆ†æ§åˆ¶ã€‚</p><ul><li>values æä¾›è¿‡ç¨‹ä¸­å¤šä¸ªç‚¹çš„å€¼ï¼ŒåŒ…å«å¼€å§‹å’Œç»“æŸ ã€‚from , to å’Œ by å¤±æ•ˆã€‚</li></ul><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>animate</span> <span class="token attr-name">attributeName</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>cx<span class="token punctuation">"</span></span> <span class="token attr-name">values</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30;90;30<span class="token punctuation">"</span></span> <span class="token attr-name">dur</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2s<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>freeze<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>circle</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><iframe src="images/12.html" />* keyTimes é…åˆvaluesä½¿ç”¨ã€‚ é’ˆå¯¹äºvaluesçš„åˆ†æ®µï¼Œ è®¾ç½®æ¯ä¸€æ®µçš„æ—¶é•¿ï¼ˆç™¾åˆ†æ¯”ï¼‰ã€‚<p>ç±»ä¼¼äº CSS ä¸­çš„@keyframes</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>animate</span>    <span class="token attr-name">attributeName</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>cx<span class="token punctuation">"</span></span>    <span class="token attr-name">values</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30;90;30<span class="token punctuation">"</span></span>    <span class="token attr-name">keyTimes</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0;0.25;1<span class="token punctuation">"</span></span>    <span class="token attr-name">dur</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>4s<span class="token punctuation">"</span></span>    <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>freeze<span class="token punctuation">"</span></span>  <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>circle</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>0-0.25 çš„æ—¶é—´(1/4) å®Œæˆ 30-90 çš„è¿åŠ¨ ï¼ˆ1s å®Œæˆï¼‰</p><p>0.25-1 çš„æ—¶é—´(3/4)å®Œæˆ 90-30 çš„è¿åŠ¨ ï¼ˆ3s å®Œæˆï¼‰</p><iframe src="images/13.html" />> ä½¿ç”¨ä¸Šè¿°å±æ€§ï¼Œå¯¹åŠ¨ç”»è¿‡ç¨‹åšäº†åˆ†æ®µè¿åŠ¨ã€‚ ä½†æ¯ä¸€æ®µçš„è¿åŠ¨é»˜è®¤éƒ½æ˜¯åŒ€é€Ÿçš„ã€‚>> å¯ä»¥ä½¿ç”¨calcModeæ§åˆ¶è¿åŠ¨çš„æ–¹å¼ã€‚<h4 id="calcMode-æ§åˆ¶è¿åŠ¨é€Ÿåº¦"><a href="#calcMode-æ§åˆ¶è¿åŠ¨é€Ÿåº¦" class="headerlink" title="calcMode æ§åˆ¶è¿åŠ¨é€Ÿåº¦"></a>calcMode æ§åˆ¶è¿åŠ¨é€Ÿåº¦</h4><p>æ§åˆ¶åŠ¨ç”»åœ¨(æ¯ä¸€æ®µ)è¿åŠ¨è¿‡ç¨‹ä¸­é€Ÿåº¦å˜åŒ–ã€‚</p><ul><li><p>linear é»˜è®¤ ï¼Œ æ¯ä¸€æ®µéƒ½åŒ€é€Ÿã€‚</p><p>æ¯ä¸€æ®µçš„é•¿çŸ­ä¸åŒï¼Œ å½¼æ­¤é—´é€Ÿåº¦ä¸åŒã€‚</p></li><li><p>paced ä»å§‹è‡³ç»ˆåŒ€é€Ÿï¼Œ keyTimes æ— æ•ˆã€‚</p></li><li><p>discrete ç›´æ¥è·³è·ƒåˆ°ç›®æ ‡ä½ç½®ï¼Œæ²¡æœ‰ä¸­é—´çš„è¿åŠ¨è¿‡ç¨‹ã€‚</p></li><li><p>spline (ä¸‰æ¬¡è´å¡å°”)æ›²çº¿å‹å˜åŒ–</p><p>å¯ä»¥å®ç°å…ˆå¿«åæ…¢å†å¿«ç­‰ã€‚</p><p>éœ€è¦é…åˆ keySplines å±æ€§</p></li></ul><iframe src="images/14.html" /> #### keySplines æ§åˆ¶æ›²çº¿é€Ÿåº¦<p>é…åˆ caclMode=â€splineâ€ , å®ç°æ¯ä¸€æ®µé€Ÿåº¦çš„è´å¡å°”æ›²çº¿å˜åŒ–</p><blockquote><p>ä½¿ç”¨çš„æ˜¯ä¸‰æ¬¡è´å¡å°”æ›²çº¿ï¼Œ æ‰€ä»¥éœ€è¦è®¾ç½®ä¸¤ä¸ªæ§åˆ¶ç‚¹ã€‚</p></blockquote><blockquote><p>æ¯ä¸€æ®µéƒ½æœ‰è‡ªå·±çš„è´å¡å°”è®¾ç½®ï¼Œ å‡è®¾ values æä¾›äº† 5 ä¸ªç‚¹ï¼Œåˆ†æˆ 4 æ®µï¼Œéœ€è¦æä¾› 4 ç»„æ§åˆ¶ç‚¹ã€‚</p></blockquote><blockquote><p>æ¯ä¸€ç»„æ§åˆ¶å°éƒ½æ˜¯ 0-1 èŒƒå›´ã€‚ åœ¨ 0-1 åæ ‡ç³»ä¸­è®¾è®¡è´å¡å°”æ›²çº¿çš„æ§åˆ¶ç‚¹ã€‚</p></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0 0 100 100<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>animate</span>      <span class="token attr-name">attributeName</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>cx<span class="token punctuation">"</span></span>      <span class="token attr-name">values</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30;90<span class="token punctuation">"</span></span>      <span class="token attr-name">calcMode</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>spline<span class="token punctuation">"</span></span>      <span class="token attr-name">keySplines</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0 1 1 0<span class="token punctuation">"</span></span>      <span class="token attr-name">dur</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>4s<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>freeze<span class="token punctuation">"</span></span>    <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>circle</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0 0 100 100<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M0 0 L 100 100<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fac<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span>    <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M0 0 C0 50,100 50,100 100<span class="token punctuation">"</span></span>    <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span>    <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#F00<span class="token punctuation">"</span></span>    <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span>  <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span>    <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M0 0 C0 100,100 0,100 100<span class="token punctuation">"</span></span>    <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span>    <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#0f0<span class="token punctuation">"</span></span>    <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span>  <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span>    <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M0 0 C100 0,0 100,100 100<span class="token punctuation">"</span></span>    <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span>    <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span>    <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span>  <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><iframe src="images/15.html" height="250" ><h3 id="3ï¼‰transform-å˜å½¢åŠ¨ç”»"><a href="#3ï¼‰transform-å˜å½¢åŠ¨ç”»" class="headerlink" title="3ï¼‰transform å˜å½¢åŠ¨ç”»"></a>3ï¼‰transform å˜å½¢åŠ¨ç”»</h3><p>é’ˆå¯¹çš„æ˜¯ transform å˜åŒ–å±æ€§ï¼Œ åŒ…æ‹¬ æ—‹è½¬ï¼Œå¹³ç§»ï¼Œæ”¾ç¼©ï¼Œå€¾æ–œ</p><p>ä½¿ç”¨<code>&lt;animateTransform&gt;</code>æ ‡ç­¾å®ç°åŠ¨ç”»</p><ul><li><p>translate</p><ul><li>å¯ä»¥è®¾ç½®ä¸€ä¸ªå€¼(x,0) æˆ– ä¸¤ä¸ªå€¼(x,y)</li><li>to=â€10 10â€</li></ul></li><li><p>rotate</p><ul><li><p>å¯ä»¥è®¾ç½®ä¸€ä¸ªå€¼ï¼ˆè§’åº¦,0,0ï¼‰ æˆ– ä¸‰ä¸ªå€¼ (è§’åº¦,x,y)</p></li><li><p>to=â€45 35 30â€</p></li></ul></li><li><p>scale</p><ul><li>å¯ä»¥è®¾ç½®ä¸€ä¸ªå€¼ï¼ˆx,x) æˆ– ä¸¤ä¸ªå€¼ ï¼ˆx,yï¼‰</li></ul></li><li><p>skewX å’Œ skewY</p></li></ul><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0 0 100 100<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>animateTransform</span>      <span class="token attr-name">attributeName</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>transform<span class="token punctuation">"</span></span>      <span class="token attr-name">attributeType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>XML<span class="token punctuation">"</span></span>      <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>translate<span class="token punctuation">"</span></span>      <span class="token attr-name">from</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>      <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10 10<span class="token punctuation">"</span></span>      <span class="token attr-name">dur</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1s<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>freeze<span class="token punctuation">"</span></span>    <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rect</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0 0 100 100<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>animateTransform</span>      <span class="token attr-name">attributeName</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>transform<span class="token punctuation">"</span></span>      <span class="token attr-name">attributeType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>XML<span class="token punctuation">"</span></span>      <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rotate(45)<span class="token punctuation">"</span></span>      <span class="token attr-name">from</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0 35 30<span class="token punctuation">"</span></span>      <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>45 35 30<span class="token punctuation">"</span></span>      <span class="token attr-name">dur</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1s<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>freeze<span class="token punctuation">"</span></span>    <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rect</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>-50 -50 100 100<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>-15<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>-10<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>animateTransform</span>      <span class="token attr-name">attributeName</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>transform<span class="token punctuation">"</span></span>      <span class="token attr-name">attributeType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>XML<span class="token punctuation">"</span></span>      <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scale<span class="token punctuation">"</span></span>      <span class="token attr-name">from</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span>      <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span>      <span class="token attr-name">dur</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1s<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>freeze<span class="token punctuation">"</span></span>    <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rect</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>-50 -50 100 100<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>-15<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>-10<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>animateTransform</span>      <span class="token attr-name">attributeName</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>transform<span class="token punctuation">"</span></span>      <span class="token attr-name">attributeType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>XML<span class="token punctuation">"</span></span>      <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>skewX<span class="token punctuation">"</span></span>      <span class="token attr-name">from</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>      <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span>      <span class="token attr-name">dur</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1s<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>freeze<span class="token punctuation">"</span></span>    <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rect</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><iframe src="images/16.html" height="450"><blockquote><p>å½“å¯¹å›¾å½¢è¿›è¡Œå¤šä¸ªå˜å½¢åŠ¨ç”»æ—¶ï¼Œå¯èƒ½å°±ä¼šå‡ºç°é—®é¢˜</p><p>åé¢åŠ¨ç”»æ‰§è¡Œæ—¶ï¼Œä¼šè¦†ç›–å‰é¢åŠ¨ç”»çš„æœ€ç»ˆæ•ˆæœï¼ˆä¼šæ¢å¤æœ€åˆçš„çŠ¶æ€ï¼Œå†åŠ¨ç”»ï¼‰</p><p>å¯ä»¥ä½¿ç”¨<strong>additive å±æ€§</strong>ï¼Œæ§åˆ¶åé¢åŠ¨ç”»åŸºäºå‰é¢åŠ¨ç”»çš„æ•ˆæœä¸Šè¿›è¡Œ</p></blockquote><h4 id="æ‰©å±•å±æ€§ï¼šadditive-æ•ˆæœç´¯åŠ "><a href="#æ‰©å±•å±æ€§ï¼šadditive-æ•ˆæœç´¯åŠ " class="headerlink" title="æ‰©å±•å±æ€§ï¼šadditive æ•ˆæœç´¯åŠ "></a>æ‰©å±•å±æ€§ï¼šadditive æ•ˆæœç´¯åŠ </h4><p>å¯¹å›¾å½¢è¿›è¡Œå¤šä¸ªå˜å½¢åŠ¨ç”»æ—¶ï¼Œæ§åˆ¶åŠ¨ç”»æ•ˆæœä¹‹é—´çš„å…³ç³»</p><ul><li>replace é»˜è®¤ æ–°åŠ¨ç”»æ•ˆæœè¦†ç›–åŸåŠ¨ç”»æ•ˆæœï¼ˆæ¢å¤åˆå§‹çŠ¶æ€å†åŠ¨ç”»ï¼‰</li><li>sum æ–°åŠ¨ç”»æ•ˆæœä¼šåœ¨åŸåŠ¨ç”»æ•ˆæœåŸºç¡€ä¸Šç´¯åŠ ã€‚</li></ul><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>-10<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>-10<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>animateTransform</span>    <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>a1<span class="token punctuation">"</span></span>    <span class="token attr-name">attributeName</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>transform<span class="token punctuation">"</span></span>    <span class="token attr-name">attributeType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>XML<span class="token punctuation">"</span></span>    <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scale<span class="token punctuation">"</span></span>    <span class="token attr-name">from</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span>    <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span>    <span class="token attr-name">dur</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1s<span class="token punctuation">"</span></span>    <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>freeze<span class="token punctuation">"</span></span>  <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>animateTransform</span>    <span class="token attr-name">attributeName</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>transform<span class="token punctuation">"</span></span>    <span class="token attr-name">attributeType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>XML<span class="token punctuation">"</span></span>    <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rotate<span class="token punctuation">"</span></span>    <span class="token attr-name">from</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>    <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>45<span class="token punctuation">"</span></span>    <span class="token attr-name">begin</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>a1.end<span class="token punctuation">"</span></span>    <span class="token attr-name">additive</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sum<span class="token punctuation">"</span></span>    <span class="token attr-name">dur</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1s<span class="token punctuation">"</span></span>    <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>freeze<span class="token punctuation">"</span></span>  <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rect</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><iframe src="images/17.html" height="250"><h4 id="æ‰©å±•å±æ€§ï¼šaccumulate-æ•ˆæœç´¯åŠ "><a href="#æ‰©å±•å±æ€§ï¼šaccumulate-æ•ˆæœç´¯åŠ " class="headerlink" title="æ‰©å±•å±æ€§ï¼šaccumulate æ•ˆæœç´¯åŠ "></a>æ‰©å±•å±æ€§ï¼šaccumulate æ•ˆæœç´¯åŠ </h4><p>é’ˆå¯¹äºå›¾å½¢çš„ä¸€ä¸ªåŠ¨ç”»ï¼Œå¤šæ¬¡æ‰§è¡Œæ—¶ï¼Œæ§åˆ¶åä¸€æ¬¡çš„æ•ˆæœæ˜¯å¦æ˜¯åŸºäºå‰ä¸€æ¬¡çš„åŠ¨ç”»æ•ˆæœã€‚ç›¸å¯¹å€¼æ•ˆæœæ˜æ˜¾ã€‚</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>animate</span>    <span class="token attr-name">attributeType</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>XML<span class="token punctuation">"</span></span>    <span class="token attr-name">attributeName</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>x<span class="token punctuation">"</span></span>    <span class="token attr-name">by</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>    <span class="token attr-name">dur</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1s<span class="token punctuation">"</span></span>    <span class="token attr-name">accumulate</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>sum<span class="token punctuation">"</span></span>    <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>freeze<span class="token punctuation">"</span></span>    <span class="token attr-name">repeatCount</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>3<span class="token punctuation">"</span></span>  <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rect</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><iframe src="images/18.html" height="230"><h3 id="4ï¼‰motion-è·¯å¾„åŠ¨ç”»"><a href="#4ï¼‰motion-è·¯å¾„åŠ¨ç”»" class="headerlink" title="4ï¼‰motion è·¯å¾„åŠ¨ç”»"></a>4ï¼‰motion è·¯å¾„åŠ¨ç”»</h3><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span>  <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M20 50 A30 30 0 0 1 80 50A30 30 0 0 1 20 50<span class="token punctuation">"</span></span>  <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>3<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span> <span class="token attr-name">fill-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0.8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>animateMotion</span>    <span class="token attr-name">path</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M20 50 A30 30 0 0 1 80 50A30 30 0 0 1 20 50<span class="token punctuation">"</span></span>    <span class="token attr-name">dur</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2s<span class="token punctuation">"</span></span>    <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>freeze<span class="token punctuation">"</span></span>  <span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>animateMotion</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>circle</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>path å±æ€§ ä¸ path æ ‡ç­¾çš„ d å±æ€§ æœ‰ç›¸åŒç¼–å†™è§„èŒƒã€‚</p><iframe src="images/19.html" height="230" /> > ä½¿ç”¨keyPointså±æ€§ä¸ºè·¯å¾„åˆ†æ®µï¼Œå¯ä»¥åˆ†åˆ«æ§åˆ¶æ¯ä¸€æ®µçš„é€Ÿåº¦>> ä½¿ç”¨æ¯”ä¾‹è¿›è¡Œåˆ†æ®µã€‚<pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0 0 100 100<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M0 0 L100 100<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>3<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span> <span class="token attr-name">fill-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0.8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>animateMotion</span>      <span class="token attr-name">path</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M0 0 L100 100<span class="token punctuation">"</span></span>      <span class="token attr-name">begin</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1s<span class="token punctuation">"</span></span>      <span class="token attr-name">dur</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2s<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>freeze<span class="token punctuation">"</span></span>    <span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>animateMotion</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>circle</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0 0 100 100<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M0 0 C0 100 100 0 100 100<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>3<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span> <span class="token attr-name">fill-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0.8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>animateMotion</span>      <span class="token attr-name">path</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M0 0 C0 100 100 0 100 100<span class="token punctuation">"</span></span>      <span class="token attr-name">keyPoints</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0;1<span class="token punctuation">"</span></span>      <span class="token attr-name">keyTimes</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0;1<span class="token punctuation">"</span></span>      <span class="token attr-name">calcMode</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>spline<span class="token punctuation">"</span></span>      <span class="token attr-name">keySplines</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0 1 1 0<span class="token punctuation">"</span></span>      <span class="token attr-name">begin</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1s<span class="token punctuation">"</span></span>      <span class="token attr-name">dur</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2s<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>freeze<span class="token punctuation">"</span></span>    <span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>animateMotion</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>circle</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0 0 100 100<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M0 0 C100 0 0 100 100 100<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>3<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span> <span class="token attr-name">fill-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0.8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>animateMotion</span>      <span class="token attr-name">path</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M0 0 C100 0 0 100 100 100<span class="token punctuation">"</span></span>      <span class="token attr-name">keyPoints</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0;1<span class="token punctuation">"</span></span>      <span class="token attr-name">keyTimes</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0;1<span class="token punctuation">"</span></span>      <span class="token attr-name">calcMode</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>spline<span class="token punctuation">"</span></span>      <span class="token attr-name">keySplines</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1 0 0 1<span class="token punctuation">"</span></span>      <span class="token attr-name">begin</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1s<span class="token punctuation">"</span></span>      <span class="token attr-name">dur</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2s<span class="token punctuation">"</span></span>      <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>freeze<span class="token punctuation">"</span></span>    <span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>animateMotion</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>circle</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><iframe src="images/20.html" height="230" /> > rotateå±æ€§ æ§åˆ¶å›¾å½¢åœ¨æ²¿ç€è·¯å¾„è¿åŠ¨è¿‡ç¨‹ä¸­ï¼Œä¿æŒä¸è·¯å¾„ç›¸åŒçš„è§’åº¦ã€‚>> * auto æ­£å‘ä¿æŒè§’åº¦> * auto-reverse åå‘ä¿æŒè§’åº¦ã€‚<pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span>  <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M20 50 A30 30 0 0 1 80 50A30 30 0 0 1 20 50<span class="token punctuation">"</span></span>  <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>5<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>5<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span> <span class="token attr-name">fill-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0.8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>animateMotion</span>    <span class="token attr-name">path</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M20 50 A30 30 0 0 1 80 50A30 30 0 0 1 20 50<span class="token punctuation">"</span></span>    <span class="token attr-name">rotate</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>auto<span class="token punctuation">"</span></span>    <span class="token attr-name">dur</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>4s<span class="token punctuation">"</span></span>    <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>freeze<span class="token punctuation">"</span></span>  <span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>animateMotion</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rect</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><iframe src="images/21.html" height="230" />  #### æ‰©å±•ï¼šmpathå­æ ‡ç­¾<p>å¼•ç”¨ä¸€ä¸ª path å›¾å½¢ï¼Œä½œä¸ºå½“å‰å›¾åƒçš„è¿åŠ¨è·¯å¾„ã€‚</p><p>æ›´æ¨èä½¿ç”¨ mpathï¼Œä¸å»ºè®®ç›´æ¥ä½¿ç”¨ path å±æ€§ã€‚</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span>  <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d1<span class="token punctuation">"</span></span>  <span class="token attr-name">d</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M20 50 A30 30 0 0 1 80 50 L50 90 Z<span class="token punctuation">"</span></span>  <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span>  <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>5<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>5<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span> <span class="token attr-name">fill-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0.8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>animateMotion</span> <span class="token attr-name">rotate</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>auto-reverse<span class="token punctuation">"</span></span> <span class="token attr-name">dur</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>4s<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>freeze<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mpath</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#d1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>animateMotion</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rect</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5ï¼‰set-è®¾ç½®å˜åŒ–"><a href="#5ï¼‰set-è®¾ç½®å˜åŒ–" class="headerlink" title="5ï¼‰set è®¾ç½®å˜åŒ–"></a>5ï¼‰set è®¾ç½®å˜åŒ–</h3><p>è®¾ç½®å±æ€§ï¼Œä½¿å¾—å›¾å½¢å‘ç”Ÿä¸€äº›å˜åŒ–ã€‚ ä½†æ²¡æœ‰å˜åŒ–è¿‡ç¨‹ã€‚</p><p>æ”¯æŒæ‰€æœ‰çš„å±æ€§ç±»å‹ï¼ˆå­—ç¬¦ä¸²ï¼Œå¸ƒå°”ç­‰ï¼‰</p><p>ä½¿ç”¨åŠ¨ç”»çš„ä¸€äº›å±æ€§</p><ul><li>to è®¾ç½®å…·ä½“çš„å±æ€§å€¼</li><li>begin è®¾ç½®å¼€å§‹æ—¶é—´ç‚¹ã€‚</li><li>dur å±æ€§ä¿æŒæ—¶é—´ã€‚</li><li>attributeName å±æ€§å</li></ul><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>none<span class="token punctuation">"</span></span> <span class="token attr-name">stroke</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token attr-name">stroke-width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>set</span>    <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>s1<span class="token punctuation">"</span></span>    <span class="token attr-name">attributeName</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d<span class="token punctuation">"</span></span>    <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M30 30h40 v40 h-40 z<span class="token punctuation">"</span></span>    <span class="token attr-name">dur</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1s<span class="token punctuation">"</span></span>    <span class="token attr-name">begin</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0;s3.end<span class="token punctuation">"</span></span>  <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>set</span>    <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>s2<span class="token punctuation">"</span></span>    <span class="token attr-name">attributeName</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d<span class="token punctuation">"</span></span>    <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M30 50 A20 20 0 0 1 70 50A 20 20 0 0 1 30 50<span class="token punctuation">"</span></span>    <span class="token attr-name">dur</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1s<span class="token punctuation">"</span></span>    <span class="token attr-name">begin</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>s1.end<span class="token punctuation">"</span></span>  <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>set</span>    <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>s3<span class="token punctuation">"</span></span>    <span class="token attr-name">attributeName</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>d<span class="token punctuation">"</span></span>    <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>M50 30 L30 70 L 70 70 Z<span class="token punctuation">"</span></span>    <span class="token attr-name">dur</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1s<span class="token punctuation">"</span></span>    <span class="token attr-name">begin</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>s2.end<span class="token punctuation">"</span></span>  <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>path</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><iframe src="images/22.html" height="230" />  ## 8 æ»¤é•œ<h3 id="1ï¼‰åŸºæœ¬åº”ç”¨-1"><a href="#1ï¼‰åŸºæœ¬åº”ç”¨-1" class="headerlink" title="1ï¼‰åŸºæœ¬åº”ç”¨"></a>1ï¼‰åŸºæœ¬åº”ç”¨</h3><p>ä½¿ç”¨<code>&lt;filter&gt;</code>æ ‡ç­¾ï¼Œå®šä¹‰æ»¤é•œï¼ˆå®¹å™¨ï¼‰ï¼Œå¯ä»¥åŒ…å«å¤šä¸ªå…·ä½“çš„æ»¤é•œï¼ˆåŸè¯­ï¼‰</p><p>å›¾å½¢ä½¿ç”¨<code>filter</code>å±æ€§å¼•ç”¨æ»¤é•œ</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>f1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feGaussianBlur</span> <span class="token attr-name">in</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>SourceGraphic<span class="token punctuation">"</span></span> <span class="token attr-name">stdDeviation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token attr-name">result</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>r1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feOffset</span> <span class="token attr-name">dx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token attr-name">dy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token attr-name">result</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>r1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feMerge</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feMergeNode</span> <span class="token attr-name">in</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>r1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feMergeNode</span> <span class="token attr-name">in</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>SourceGraphic<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>feMerge</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span> <span class="token attr-name">filter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#f1)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/94.png" alt="1683610408649" style="zoom:50%;" /><blockquote><p>filter åŸºæœ¬å±æ€§</p></blockquote><p>id å”¯ä¸€æ ‡è¯†æ»¤é•œï¼Œ æ–¹ä¾¿å›¾å½¢å¼•ç”¨</p><p>x , y , width , height æ§åˆ¶æ»¤é•œçš„ä½œç”¨èŒƒå›´</p><ul><li>é»˜è®¤ x = y = -10% , width = height = 120%</li></ul><p>filterUnits è®¾ç½® filter åŒºåŸŸçš„æ•°æ®å•å…ƒ</p><ul><li>objectBoudingBox é»˜è®¤ï¼Œ ç™¾åˆ†æ¯”ï¼ŒåŸºäºå›¾å½¢</li><li>userSpaceOnUse å…·ä½“å€¼ï¼Œ åŸºäºåæ ‡ç³»</li></ul><p>primitiveUnits è®¾ç½® filter å®¹å™¨å†…éƒ¨å…·ä½“æ»¤é•œåŒºåŸŸçš„æ•°æ®å•å…ƒ</p><ul><li>userSpaceOnUse é»˜è®¤</li><li>objectBoudingBox</li></ul><blockquote><p>filter å®¹å™¨å†…éƒ¨ï¼Œå¤šä¸ªæ»¤é•œçš„ç”Ÿæ•ˆè¿‡ç¨‹</p></blockquote><p>å½“æŸä¸€ä¸ªæ»¤é•œä½œç”¨åœ¨å›¾å½¢ä¸Šï¼Œä¸ä¼šç«‹åˆ»ç”Ÿæ•ˆï¼Œè€Œæ˜¯ä¼šå°†å¤„ç†ç»“æœå­˜å…¥ç¼“å­˜ã€‚ å¯ä»¥ä½¿ç”¨ result å±æ€§å®šä¹‰ç¼“å­˜åç§°</p><p>ä¸‹ä¸€ä¸ªæ»¤é•œï¼Œå¯ä»¥ä½¿ç”¨ inï¼ˆin2ï¼‰å±æ€§ , æ¥å°†ç¼“å­˜ä¸­çš„ç»“æœåŠ å…¥åˆ°å½“å‰æ»¤é•œå¤„ç†ä¸­</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feGaussianBlur</span> <span class="token attr-name">in</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>SourceGraphic<span class="token punctuation">"</span></span> <span class="token attr-name">stdDeviation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token attr-name">result</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>r1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feOffset</span> <span class="token attr-name">in</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>r1<span class="token punctuation">"</span></span> <span class="token attr-name">dx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token attr-name">dy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token attr-name">result</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>r1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å¦‚æœæ²¡æœ‰å¯¹è£…å…¥ç¼“å­˜çš„ç»“æœå‘½åï¼Œ ä¸‹ä¸€ä¸ªæ»¤é•œä¼šé»˜è®¤è£…è½½ä¸Šä¸€ä¸ªç´§é‚»çš„å¤„ç†ç»“æœã€‚</p><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ in å±æ€§ï¼ŒæŒ‡å®šå¯¹åŸå›¾ç‰‡åšå¤„ç† <code>in=&quot;SourceGraphic&quot;</code></p><blockquote><p>å¯ä»¥ä½¿ç”¨ svg å’Œ css çš„æ–¹å¼ä½¿å¾—æ»¤é•œç”Ÿæ•ˆ</p></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">filter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#f1)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rect</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-css"><code class="language-css">rect &amp;<span class="token hexcode">#123</span><span class="token punctuation">;</span>  <span class="token property">filter</span><span class="token punctuation">:</span> <span class="token url">url(#f1)</span><span class="token punctuation">;</span>&amp;<span class="token hexcode">#125</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="2ï¼‰shadow-é˜´å½±æ»¤é•œ"><a href="#2ï¼‰shadow-é˜´å½±æ»¤é•œ" class="headerlink" title="2ï¼‰shadow é˜´å½±æ»¤é•œ"></a>2ï¼‰shadow é˜´å½±æ»¤é•œ</h3><p>ä½¿ç”¨<code>&lt;feDropShadow&gt;</code>æ ‡ç­¾å®ç°é˜´å½±</p><p>dx , dy æ¨ªå‘å’Œçºµå‘çš„åç§»</p><p>stdDeviation è®¾ç½®æ¨¡ç³Šç¨‹åº¦ï¼Œ å€¼è¶Šå¤§ï¼Œ è¶Šæ¨¡ç³Šã€‚</p><ul><li>é»˜è®¤æ˜¯é»‘è‰²é˜´å½±</li></ul><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>f1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feDropShadow</span> <span class="token attr-name">dx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">dy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">stdDeviation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>feDropShadow</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span> <span class="token attr-name">filter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#f1)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/95.png" alt="1683612548766" style="zoom:50%;" /><blockquote><p>flood-color å’Œ flood-opacity è®¾ç½®é˜´å½±çš„é¢œè‰²å’Œé€æ˜åº¦ã€‚</p></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>f2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feDropShadow</span>      <span class="token attr-name">dx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span>      <span class="token attr-name">dy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span>      <span class="token attr-name">stdDeviation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span>      <span class="token attr-name">flood-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span>      <span class="token attr-name">flood-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0.8<span class="token punctuation">"</span></span>    <span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>feDropShadow</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span> <span class="token attr-name">filter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#f2)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/96.png" alt="1683612575937" style="zoom:50%;" /><h3 id="3ï¼‰blur-æ¨¡ç³Šæ»¤é•œ"><a href="#3ï¼‰blur-æ¨¡ç³Šæ»¤é•œ" class="headerlink" title="3ï¼‰blur æ¨¡ç³Šæ»¤é•œ"></a>3ï¼‰blur æ¨¡ç³Šæ»¤é•œ</h3><p>ä½¿ç”¨<code>&lt;feGaussianBlur&gt;</code>æ ‡ç­¾è®¾ç½®æ¨¡ç³Šæ•ˆæœ</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>f1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feGaussianBlur</span> <span class="token attr-name">in</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>SourceGraphic<span class="token punctuation">"</span></span> <span class="token attr-name">stdDeviation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span>  <span class="token attr-name"><span class="token namespace">xlink:</span>href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>../imgs/5.png<span class="token punctuation">"</span></span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span>  <span class="token attr-name">filter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#f1)<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>stdDeviation : è®¾ç½®æ¨¡ç³Šç¨‹åº¦ã€‚</p><p>in è®¾ç½®è¾“å…¥æºï¼ˆå¯¹è°æ¨¡ç³Šï¼‰</p><ul><li>SourceGraphic å¯¹ä½œç”¨çš„å›¾åƒæ¨¡ç³Šã€‚</li><li>SourceAlpha åŸºäºä½œç”¨å›¾åƒçš„é€æ˜åº¦å®ç°æ¨¡ç³Šï¼ˆé»‘è‰²æ•ˆæœï¼‰</li></ul><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/97.png" alt="1683615354449" style="zoom:50%;" /><blockquote><p>æ²¡æœ‰æŒ‡å®š in ã€‚</p><ul><li>æ»¤é•œåœ¨æœ€å¼€å§‹ï¼Œæ­¤æ—¶é»˜è®¤é’ˆå¯¹çš„å°±æ˜¯ä½œç”¨çš„å›¾åƒæ¨¡ç³Šã€‚</li><li>æ»¤é•œåœ¨ä¸­é—´ï¼Œå¯¹ä¸Šä¸€ä¸ªæ»¤é•œæ•ˆæœåšæ¨¡ç³Šã€‚</li></ul></blockquote><blockquote><p>å¯ä»¥ä½¿ç”¨ x , y , width , height è®¾ç½®æ¨¡ç³ŠåŒºåŸŸã€‚åªå¯¹å›¾å½¢çš„ä¸€éƒ¨åˆ†åšæ¨¡ç³Šï¼ˆå…¶ä»–éƒ¨åˆ†ä¸å¯è§ï¼‰</p></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>f3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feGaussianBlur</span>      <span class="token attr-name">stdDeviation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>3<span class="token punctuation">"</span></span>      <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span>      <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>      <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span>      <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>      <span class="token attr-name">result</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>r3<span class="token punctuation">"</span></span>    <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feMerge</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feMergeNode</span> <span class="token attr-name">in</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>SourceGraphic<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>feMergeNode</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feMergeNode</span> <span class="token attr-name">in</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>r3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>feMergeNode</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>feMerge</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span>  <span class="token attr-name"><span class="token namespace">xlink:</span>href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>../imgs/5.png<span class="token punctuation">"</span></span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span>  <span class="token attr-name">filter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#f3)<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/98.png" alt="1683615425880" style="zoom:50%;" /><h3 id="4ï¼‰offset-ä½ç§»æ»¤é•œ"><a href="#4ï¼‰offset-ä½ç§»æ»¤é•œ" class="headerlink" title="4ï¼‰offset ä½ç§»æ»¤é•œ"></a>4ï¼‰offset ä½ç§»æ»¤é•œ</h3><p>ä½¿ç”¨<code>&lt;feOffset&gt;</code>æ ‡ç­¾å®ç°åç§»æ•ˆæœ</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>f1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feGaussianBlur</span> <span class="token attr-name">in</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>SourceGraphic<span class="token punctuation">"</span></span> <span class="token attr-name">stdDeviation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feOffset</span> <span class="token attr-name">dx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token attr-name">dy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token attr-name">result</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>r1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feGaussianBlur</span> <span class="token attr-name">in</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>SourceGraphic<span class="token punctuation">"</span></span> <span class="token attr-name">stdDeviation</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feOffset</span> <span class="token attr-name">dx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>-2<span class="token punctuation">"</span></span> <span class="token attr-name">dy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token attr-name">result</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>r2<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feMerge</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feMergeNode</span> <span class="token attr-name">in</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>r1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feMergeNode</span> <span class="token attr-name">in</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>r2<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feMergeNode</span> <span class="token attr-name">in</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>SourceGraphic<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>feMerge</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span> <span class="token attr-name">filter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#f1)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>dx å’Œ dy è®¾ç½®æ¨ªçºµçš„åç§»ã€‚</p><p>result ä¸ºæ»¤é•œæ•ˆæœç¼“å­˜å‘½åã€‚æ–¹ä¾¿åé¢å¼•ç”¨ã€‚</p><blockquote><p>å¯ä»¥å¯¹ä¸€ä¸ªå¯¹è±¡è¿›è¡Œå¤šæ¬¡æ»¤é•œæ•ˆæœï¼Œå¯ä»¥å¯¹å¤šä¸ªæ•ˆæœç»„åˆåº”ç”¨</p></blockquote><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/99.png" alt="1683616292394" style="zoom:50%;" /><h3 id="5ï¼‰merge-åˆå¹¶æ»¤é•œ"><a href="#5ï¼‰merge-åˆå¹¶æ»¤é•œ" class="headerlink" title="5ï¼‰merge åˆå¹¶æ»¤é•œ"></a>5ï¼‰merge åˆå¹¶æ»¤é•œ</h3><p>ä½¿ç”¨<code>&lt;feMerge&gt;</code>æ ‡ç­¾ å’Œ <code>&lt;feMergeNode&gt;</code>å­æ ‡ç­¾å®Œæˆå¤šä¸ªæ»¤é•œæ•ˆæœçš„åˆå¹¶ä½¿ç”¨</p><ul><li>é»˜è®¤å¤šä¸ªæ»¤é•œæ•ˆæœåªèƒ½æŒ‰é¡ºåºç”Ÿæ•ˆ</li><li>å¯ä»¥é€šè¿‡åˆå¹¶æ»¤é•œï¼Œè®©ä¸¤ä¸ªæ»¤é•œç‹¬ç«‹ç»„åˆã€‚æ ¹æ®æˆ‘ä»¬çš„éœ€æ±‚æ¥æ§åˆ¶é¡ºåºã€‚</li></ul><h3 id="6ï¼‰blend-æ··åˆæ»¤é•œ"><a href="#6ï¼‰blend-æ··åˆæ»¤é•œ" class="headerlink" title="6ï¼‰blend æ··åˆæ»¤é•œ"></a>6ï¼‰blend æ··åˆæ»¤é•œ</h3><p>å°†å¤šä¸ªæ»¤é•œæ•ˆæœåˆå¹¶åœ¨ä¸€èµ·ï¼Œå¹¶å½¼æ­¤äº§ç”Ÿä¸€ä¸ªé¢œè‰²å˜åŒ–ï¼ˆåŒ–å­¦ååº”ï¼‰</p><p>ä½¿ç”¨<code>&lt;feBlend&gt;</code>æ ‡ç­¾å®ç°æ··åˆæ•ˆæœ</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>f1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feImage</span>      <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>../imgs/4.png<span class="token punctuation">"</span></span>      <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>120<span class="token punctuation">"</span></span>      <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>120<span class="token punctuation">"</span></span>      <span class="token attr-name">preserveAspectRatio</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>xMidYMid slice<span class="token punctuation">"</span></span>      <span class="token attr-name">result</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>img<span class="token punctuation">"</span></span>    <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feBlend</span> <span class="token attr-name">in</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>SourceGraphic<span class="token punctuation">"</span></span> <span class="token attr-name">in2</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>img<span class="token punctuation">"</span></span> <span class="token attr-name">mode</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>normarl<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span>  <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>../imgs/3.png<span class="token punctuation">"</span></span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span>  <span class="token attr-name">preserveAspectRatio</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>xMidYMid slice<span class="token punctuation">"</span></span>  <span class="token attr-name">filter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#f1)<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>in è®¾ç½®ä¸Šé¢çš„è¾“å…¥æº</p><p>in2 è®¾ç½®ä¸‹é¢çš„è¾“å…¥æº</p><p>mode è®¾ç½®ä¸¤ä¸ªè¾“å…¥æºæ··åˆçŠ¶æ€ã€‚</p><ul><li><p>normal æŒ‰é¡ºåºï¼Œè°åœ¨ä¸Šæ˜¾ç¤ºè°ã€‚</p></li><li><p>multiply ä¸¤ä¸ªè¾“å…¥æºé¢œè‰²ç›¸ä¹˜ã€‚ é»‘è‰²å åŠ å°±åé»‘ï¼Œ ç™½è‰²å åŠ ååŸè‰²ã€‚ æ•´ä½“åé»‘è‰²å›¾ç‰‡</p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/107.png" alt="1683624776387" style="zoom:50%;" /></li><li><p>screen ä¸¤ä¸ªè¾“å…¥æºé¢œè‰²åè½¬ç›¸ä¹˜ã€‚ é»‘è‰²å åŠ ååŸè‰²ï¼Œ ç™½è‰²å åŠ åç™½è‰²ã€‚æ•´ä½“åç™½è‰²å›¾ç‰‡</p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/108.png" alt="1683624790619" style="zoom:50%;" /></li><li><p>darken ä¸¤ä¸ªè¾“å…¥æºï¼Œæ¯ä¸ªåƒç´ çš„é¢œè‰²ï¼Œè°æš—å°±ç”¨è°</p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/109.png" alt="1683624805969" style="zoom:50%;" /></li><li><p>lighten ä¸¤ä¸ªè¾“å…¥æºï¼Œæ¯ä¸ªåƒç´ çš„é¢œè‰²ï¼Œè°äº®å°±ç”¨è°</p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/110.png" alt="1683624821172" style="zoom:50%;" /><blockquote><p>ä¸ screen æœ‰äº›ç›¸ä¼¼ï¼Œ ä¸é€‰å›¾æœ‰å…³ã€‚ ä½¿åŠ²çœ‹è¿˜æ˜¯æœ‰å·®å¼‚çš„ã€‚</p></blockquote></li><li><p>æ›´å¤šæ··åˆæ•ˆæœå‚è€ƒ css æ‰‹å†Œã€‚</p></li></ul><h3 id="7ï¼‰composite-åˆæˆæ»¤é•œ"><a href="#7ï¼‰composite-åˆæˆæ»¤é•œ" class="headerlink" title="7ï¼‰composite åˆæˆæ»¤é•œ"></a>7ï¼‰composite åˆæˆæ»¤é•œ</h3><p>å°†ä¸¤ä¸ªå›¾å½¢åˆæˆä¸€ä¸ªå›¾å½¢ï¼Œ é’ˆå¯¹å›¾å½¢çš„å½¢çŠ¶ã€‚</p><p>ä½¿ç”¨<code>&lt;feComposite&gt;</code>æ ‡ç­¾å®ç°åˆæˆæ•ˆæœ</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>f1<span class="token punctuation">"</span></span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feImage</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>../imgs/5.png<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span> <span class="token attr-name">result</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>img<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feComposite</span> <span class="token attr-name">in</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>img<span class="token punctuation">"</span></span> <span class="token attr-name">in2</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>SourceGraphic<span class="token punctuation">"</span></span> <span class="token attr-name">operator</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>over<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>circle</span> <span class="token attr-name">cx</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">cy</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">r</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#fac<span class="token punctuation">"</span></span> <span class="token attr-name">filter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#f1)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>in(ä¸Š) å’Œ in2(ä¸‹) è¾“å…¥ä¸¤ä¸ªå¸¦åˆæˆçš„å›¾å½¢ã€‚</p><p>operator æ§åˆ¶åˆæˆæ•ˆæœ</p><ul><li><p>over é»˜è®¤ in åœ¨ in2 çš„ä¸Šé¢</p><p>(in æ˜¯å›¾ç‰‡)</p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/100.png" alt="1683621790744" style="zoom:50%;" /></li><li><p>in æ˜¾ç¤º in ä¸ in2 å›¾å½¢é‡å çš„éƒ¨åˆ†ï¼Œä½¿ç”¨ä¸Šå±‚(in)å›¾å½¢çš„è‰²å½©</p><p>(in æ˜¯åŸå›¾å½¢)</p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/101.png" alt="1683621809604" style="zoom:50%;" /></li><li><p>out æ˜¾ç¤º in ä¸ in2 å›¾å½¢ä¸é‡å çš„éƒ¨åˆ†ï¼Œä½¿ç”¨ä¸Šå±‚(in)å›¾å½¢çš„è‰²å½©</p><p>(in æ˜¯åŸå›¾å½¢)</p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/102.png" alt="1683621846428" style="zoom:50%;" /></li><li><p>atop æ˜¾ç¤º in ä¸ in2 é‡å çš„éƒ¨åˆ† å’Œ in2 ä¸ in æœªé‡å çš„éƒ¨åˆ†ã€‚ï¼ˆin åœ¨ in2 ä¸Šé¢çš„éƒ¨åˆ†ï¼‰</p><p>(in æ˜¯åŸå›¾å½¢)</p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/103.png" alt="1683621875749" style="zoom:50%;" /></li><li><p>xor æ˜¾ç¤ºä¸¤ä¸ªå›¾å½¢ä¸é‡å çš„éƒ¨åˆ†ã€‚</p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/104.png" alt="1683622163307" style="zoom:50%;" /></li><li><p>lighter ä¸¤ä¸ªå›¾å½¢éƒ½ä¼šæ˜¾ç¤ºï¼Œå°åœ¨ä¸€èµ·</p><p>(in æ˜¯åŸå›¾å½¢)</p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/105.png" alt="1683622181356" style="zoom:50%;" /></li><li><p>arithmetic ä¸¤ä¸ªå›¾å½¢çš„æ˜¾ç¤ºè®¡ç®—å¾—å‡º ï¼Œ éœ€è¦é…åˆ k1 k2 k3 k4 å››ä¸ªå±æ€§ã€‚æœ‰å¦‚ä¸‹åˆæˆè®¡ç®—å…¬å¼ï¼š</p><p><code>c = k1*i1*i2 + k2*i1 + k3+i2 + k4</code></p><p>k1 ä¸¤ä¸ªå›¾å½¢çš„åƒç´ å€¼ä¼šå½±å“è®¡ç®—ç»“æœ</p><p>k2 in å›¾å½¢çš„åƒç´ å€¼ä¼šå½±å“è®¡ç®—ç»“æœ</p><p>k3 in2 å›¾å½¢çš„åƒç´ å€¼ä¼šå½±å“è®¡ç®—ç»“æœ</p><p>k4 åç§»é‡ å½±å“æ•´ä½“(äº®æš—)</p><ul><li>1 æœ€äº® å…¨ç™½</li><li>-1 æœ€æš— çœ‹ä¸åˆ°</li></ul><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/106.png" alt="1683622806217" style="zoom:50%;" /></li></ul><h3 id="8ï¼‰matrix-è‰²å½©çŸ©é˜µæ»¤é•œ"><a href="#8ï¼‰matrix-è‰²å½©çŸ©é˜µæ»¤é•œ" class="headerlink" title="8ï¼‰matrix è‰²å½©çŸ©é˜µæ»¤é•œ"></a>8ï¼‰matrix è‰²å½©çŸ©é˜µæ»¤é•œ</h3><p>ä½¿ç”¨<code>&lt;feColorMatrix&gt;</code>æ ‡ç­¾å®ç°è‰²å½©è½¬æ¢æ•ˆæœ</p><p>æœºåˆ¶å°±æ˜¯åˆ©ç”¨ä¸€ä¸ªè½¬æ¢çŸ©é˜µè¿›è¡Œè®¡ç®—ï¼Œ å®ç°è‰²å½©å˜åŒ–ï¼Œæ§åˆ¶äº®åº¦ï¼Œé¥±å’Œåº¦ï¼Œå¯¹æ¯”åº¦ï¼Œç°åº¦ç­‰æ•ˆæœï¼Œä»è€Œå¢å¼ºè§†è§‰æ„Ÿå—ã€‚</p><p>æ¯ä¸€ä¸ªåƒç´ çš„è‰²å½©ç”± RGBA å››éƒ¨åˆ†ç»„æˆï¼Œéœ€è¦æˆ‘ä»¬æä¾› 4*5 åˆ—çŸ©é˜µï¼ŒæŒ‰ç…§å¦‚ä¸‹å…¬å¼è®¡ç®—ï¼Œè·å¾—æ–°çš„è‰²å½©ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="images/111.png" alt="1683688522084"></p><blockquote><p>è‰²å½©åœ¨è½¬æ¢è¿‡ç¨‹ä¸­ï¼Œéƒ½ä¼šå˜æˆ[0,1]åœ¨è®¡ç®—çš„ã€‚</p><p>æ‰€ä»¥ç¬¬äº”åˆ—åç§»é‡ï¼Œ 1 è¡¨ç¤º 255 ï¼Œ -1 è¡¨ç¤º-255 ã€‚</p></blockquote><blockquote><p>è§£æï¼ˆçº¢è‰²ä¸ºä¾‹ï¼‰</p><p>NEW*R = R * r1 + G _ r2 + B _ r3 + A _ r4 + r5</p><p>r1 ä¼šå½±å“æ‰€æœ‰çš„çº¢è‰²æ•°å€¼</p><p>r2 å«æœ‰çš„ç»¿è‰²ä¼šå½±å“çº¢è‰²æ•°å€¼ rgb(100,10 ,0 )</p><p>r3 å«æœ‰çš„è“è‰²ä¼šå½±å“çº¢è‰²æ•°å€¼</p><p>r4 å«æœ‰çš„é€æ˜åº¦ä¼šå½±å“çº¢è‰²æ•°å€¼ã€‚</p><p>r5 åç§»é‡ï¼Œ æŒ‰éœ€å½±å“çº¢è‰²ã€‚</p></blockquote><blockquote><p><strong>matrix è½¬æ¢</strong></p></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>f2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feColorMatrix</span>      <span class="token attr-name">in</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>SourceGraphic<span class="token punctuation">"</span></span>      <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>matrix<span class="token punctuation">"</span></span>      <span class="token attr-name">values</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>                                -1 3 -1 0 0                                 0 1 0 0 0                                0 0 1 0 0                                0 0 0 1 0<span class="token punctuation">"</span></span>    <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span>  <span class="token attr-name">filter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#f2)<span class="token punctuation">"</span></span>  <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>../imgs/6.png<span class="token punctuation">"</span></span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span>  <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>../imgs/6.png<span class="token punctuation">"</span></span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>  <span class="token attr-name">transform</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>translate(0,50)<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>RGB ç­‰æ¯”ä¾‹å¢å‡ï¼Œå¯ä»¥å½±å“å¯¹æ¯”åº¦ éƒ½ä» 1 - 1.5 å¯¹æ¯”åº¦æ˜æ˜¾</p><p>RGB å¢å‡åç§»é‡ï¼Œå½±å“äº®åº¦</p><p>RGB å€¼ä¿ç•™ä¸€ä¸ªé€šé“ï¼Œ å½±å“ç°åº¦</p></blockquote><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/112.png" alt="1683697292527" style="zoom:50%;" /><blockquote><p>saturate è°ƒæ•´é¥±å’Œåº¦</p><p>1-0 é¥±å’Œåº¦é™ä½ï¼Œå˜ç°</p><p>1-n é¥±å’Œåº¦å¢åŠ ï¼Œå˜é²œè‰³</p></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>f5<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feColorMatrix</span> <span class="token attr-name">in</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>SourceGraphic<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>saturate<span class="token punctuation">"</span></span> <span class="token attr-name">values</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1.5<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span>  <span class="token attr-name">filter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#f5)<span class="token punctuation">"</span></span>  <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>../imgs/6.png<span class="token punctuation">"</span></span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span>  <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>../imgs/6.png<span class="token punctuation">"</span></span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>  <span class="token attr-name">transform</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>translate(0,50)<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/113.png" alt="1683699944431" style="zoom:50%;" /><blockquote><p>hueRotate è°ƒæ•´è‰²ç›¸ç›˜ï¼Œæ”¹å˜è‰²è°ƒ ï¼Œ 0-360Â°</p></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>f6<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feColorMatrix</span> <span class="token attr-name">in</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>SourceGraphic<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>hueRotate<span class="token punctuation">"</span></span> <span class="token attr-name">values</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>180<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span>  <span class="token attr-name">filter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#f6)<span class="token punctuation">"</span></span>  <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>../imgs/6.png<span class="token punctuation">"</span></span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span>  <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>../imgs/6.png<span class="token punctuation">"</span></span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>  <span class="token attr-name">transform</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>translate(0,50)<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/114.png" alt="1683699960567" style="zoom:50%;" /><blockquote><p>luminanceToAlpha æ ¹æ®å›¾åƒè‡ªèº«äº®åº¦è½¬æ¢æˆé€æ˜åº¦ã€‚ è¶Šäº®è¶Šå¯è§ï¼Œ è¶Šæš—è¶Šé€æ˜</p><ul><li><p>value å±æ€§æ— æ•ˆã€‚</p></li><li><p>å¯ç”¨æ¥åˆ›å»ºæŠ•å½±ï¼Œå‰ªå½±ç­‰æ•ˆæœã€‚</p></li></ul></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>f7<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feColorMatrix</span> <span class="token attr-name">in</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>SourceGraphic<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>luminanceToAlpha<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span>  <span class="token attr-name">filter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#f7)<span class="token punctuation">"</span></span>  <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>../imgs/6.png<span class="token punctuation">"</span></span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span>  <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>../imgs/6.png<span class="token punctuation">"</span></span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span>  <span class="token attr-name">transform</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>translate(0,50)<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/115.png" alt="1683699978523" style="zoom:50%;" /><h3 id="9ï¼‰transfer-é¢œè‰²é€šé“æ»¤é•œ"><a href="#9ï¼‰transfer-é¢œè‰²é€šé“æ»¤é•œ" class="headerlink" title="9ï¼‰transfer é¢œè‰²é€šé“æ»¤é•œ"></a>9ï¼‰transfer é¢œè‰²é€šé“æ»¤é•œ</h3><p>å¯ä»¥é’ˆå¯¹äºæ¯ä¸€ä¸ªé¢œè‰²é€šé“å®ç°è‰²å½©å˜åŒ–å¤„ç†ã€‚</p><p>æ¯ä¸€ä¸ªé€šé“éƒ½é€šè¿‡ä¸åŒçš„å˜æ¢å‡½æ•°æ¥å®ç°è‰²å½©å¤„ç†ã€‚</p><p>è¿™äº›å‡½æ•°å¯ä»¥å®ç°éçº¿æ€§çš„é¢œè‰²å¤„ç†ã€‚</p><p>å¯ä»¥æ“ä½œäº®åº¦ï¼Œå¯¹æ¯”åº¦ï¼Œè‰²å½©å¹³è¡¡ï¼Œè‰²è°ƒç­‰æ•ˆæœã€‚</p><p>ä¸ matrix ç›¸æ¯”ï¼Œæ›´å¤æ‚ï¼Œæ›´é«˜çº§ï¼Œæ›´çµæ´»</p><p>ä½¿ç”¨<code>&lt;feComponentTransfer&gt;</code>æ ‡ç­¾å®ç°é€šé“è½¬æ¢æ•ˆæœ</p><p>ä½¿ç”¨<code>&lt;feFuncR&gt; &lt;feFuncG&gt; &lt;feFuncB&gt; &lt;feFuncA&gt;</code>å››ä¸ªå­æ ‡ç­¾åˆ†åˆ«é’ˆå¯¹äºæ¯ä¸€ä¸ªé€šé“è¿›è¡Œä¸€ä¸ªå‡½æ•°è½¬æ¢å¤„ç†</p><p>è®¾ç½®<code>&lt;feFuncR&gt;</code>æ ‡ç­¾çš„ type å±æ€§ï¼Œæ¥ä½¿ç”¨ä¸åŒçš„è½¬æ¢å‡½æ•°</p><ul><li>identity ä¸è½¬æ¢</li><li>linear çº¿æ€§è½¬æ¢</li><li>gamma ä¼½é©¬è½¬æ¢</li><li>table æ˜ å°„è½¬æ¢</li><li>discrete (ç¦»æ•£)æ˜ å°„è½¬æ¢</li></ul><blockquote><p>linear çº¿æ€§è½¬æ¢</p><ul><li><p>éœ€è¦é…åˆ slope å’Œ intercept å±æ€§</p></li><li><p><code>new_r = slope * r + intercept</code></p></li><li><p>slope å½±å“å¯¹æ¯”åº¦ã€‚</p></li><li><p>intercept å½±å“äº®åº¦</p></li></ul></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>f1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feComponentTransfer</span> <span class="token attr-name">in</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>SourceGraphic<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token comment" spellcheck="true">&lt;!-- new_r = slope * r + intercept --></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feFuncR</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>linear<span class="token punctuation">"</span></span> <span class="token attr-name">slope</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span> <span class="token attr-name">intercept</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>feFuncR</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feFuncG</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>linear<span class="token punctuation">"</span></span> <span class="token attr-name">slope</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">intercept</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>feFuncG</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>feComponentTransfer</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span>  <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rgba(178,0,0,1)<span class="token punctuation">"</span></span>  <span class="token attr-name">filter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#f1)<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rgba(178,0,0,1)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/116.png" alt="1683703796658" style="zoom:50%;" /><blockquote><p>gamma éçº¿æ€§è½¬æ¢</p><ul><li><p>éœ€è¦é…åˆ amplitude ï¼Œ exponentï¼Œoffset ä¸‰ä¸ªå±æ€§</p></li><li><p><code>new_r = amplitude * pow(r,exponent) + offset</code></p></li></ul></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>f4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feComponentTransfer</span> <span class="token attr-name">in</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>SourceGraphic<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token comment" spellcheck="true">&lt;!-- new_r = amplitude * pow(r,exponent) + offset --></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feFuncR</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>gamma<span class="token punctuation">"</span></span> <span class="token attr-name">amplitude</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">exponent</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span> <span class="token attr-name">offset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>feFuncR</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>feComponentTransfer</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>g</span> <span class="token attr-name">filter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#f4)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rgb(100,0,0)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rgb(200,0,0)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>g</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>g</span> <span class="token attr-name">transform</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>translate(0,30)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rgb(100,0,0)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rgb(200,0,0)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>g</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>é¢œè‰²åœ¨è®¡ç®—æ—¶ï¼Œä¼šä»[0,255]åŒºé—´ï¼Œè½¬æ¢è‡³[0,1]åŒºé—´å†è®¡ç®—ï¼Œæ‰€ä»¥é¢œè‰²ä¸€èˆ¬éƒ½å°æ•°</p><p>æŒ‡æ•°è¶Šå¤§ï¼Œç»“æœè¶Šå°ï¼Œé¢œè‰²è¶Šæš—ã€‚ æŒ‡æ•°è¶Šå°ï¼Œç»“æœè¶Šå¤§ï¼Œé¢œè‰²è¶Šäº®</p></blockquote><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/117.png" alt="1683708553542" style="zoom:50%;" /><blockquote><p>table åŒºé—´æ˜ å°„</p><ul><li>å°†åŸåŒºé—´ä¸Šçš„é¢œè‰²ï¼Œæ˜ å°„åˆ°æ–°çš„åŒºé—´ä¸­ã€‚</li><li>é…åˆ tableValues å±æ€§ã€‚</li></ul></blockquote><p>è§£æï¼š</p><ul><li><p>tablesValue å¯ä»¥æä¾›ä¸€ç»„[0,1]æ•°å€¼ , â€œ0 0.2 1â€</p></li><li><p>3 ä¸ªæ•°å€¼ï¼Œå¯ä»¥å°†é¢œè‰²åŒºé—´åˆ†æˆ 2 æ®µ</p></li><li><p>è¿™é‡Œå­˜åœ¨ä¸¤ç»„åŒºé—´</p><ul><li>é»˜è®¤é¢œè‰²åŒºé—´[0 , 0.5] , [0.5 , 1]</li><li>æ˜ å°„é¢œè‰²åŒºé—´[0 , 0.2] , [0.2 , 1]</li></ul></li><li><p>å½“å‰é¢œè‰² r = 0.4</p></li><li><p>å…¶åœ¨é»˜è®¤åŒºé—´ä¸­ å±äºç¬¬ä¸€æ®µ [0 , 0.5] , æ˜ å°„æ—¶ï¼Œå¯¹åº”çš„ä¹Ÿæ˜¯ç¬¬ä¸€æ®µçš„æ˜ å°„åŒºé—´[0 , 0.2]</p></li><li><p>åœ¨é»˜è®¤åŒºé—´ä¸­ï¼Œ æ‰¾åˆ° 0.4 å¯¹åº”çš„ä½ç½® , ä»è€Œåœ¨æ˜ å°„åŒºé—´ä¸­ä¹Ÿæ‰¾åˆ°ç›¸åŒçš„ä½ç½®ï¼Œå³ä¸ºæ˜ å°„åçš„é¢œè‰²ã€‚</p></li><li><p>tableValues = â€œ0 0.8 0.9 1â€</p></li><li><p>4 ä¸ªæ•°å€¼ï¼Œå¯ä»¥å°†é¢œè‰²åŒºé—´åˆ†æˆ 3 æ®µ</p><ul><li>é»˜è®¤é¢œè‰²åŒºé—´ [0 , 0.33) , [0.33 , 0.66] , [0.66 , 1]</li><li>æ˜ å°„åŒºé—´ [0 , 0.8] , [0.8 , 0.9] , [0.9 , 1]</li></ul></li><li><p>r = 0.166</p><ul><li>å±äºç¬¬ä¸€æ®µåŒºé—´ ï¼Œ ç®—å‡ºä½ç½®ï¼Œ æ‰¾åˆ°ç¬¬ä¸€æ®µæ˜ å°„åŒºé—´çš„ä½ç½® ï¼Œ 0.4</li></ul></li></ul><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>f5<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feComponentTransfer</span> <span class="token attr-name">in</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>SourceGraphic<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feFuncR</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>table<span class="token punctuation">"</span></span> <span class="token attr-name">tableValues</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0 0.8 1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>feFuncR</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>feComponentTransfer</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>g</span> <span class="token attr-name">filter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#f5)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rgb(50,0,0)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rgb(200,0,0)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>g</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>g</span> <span class="token attr-name">transform</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>translate(0,30)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rgb(50,0,0)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rgb(200,0,0)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>g</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/118.png" alt="1683710153467" style="zoom:50%;" /><blockquote><p>é¢œè‰²æ˜¯ 0,255 åŒºé—´æ®µã€‚ æœ€å¤šå¯ä»¥æä¾› 256 ä¸ªæ˜ å°„çš„å€¼ï¼Œ ç›¸å½“äºä¸ºæ¯ä¸€ä¸ªé¢œè‰²å€¼éƒ½æä¾›äº†å¯¹åº”çš„æ˜ å°„ã€‚</p><p>é»˜è®¤åŒºé—´ï¼šâ€œ0,1,2â€¦ 243,254,255â€</p><p>æ˜ å°„åŒºé—´ï¼šâ€2,3,4,â€¦.255,256,257â€</p></blockquote><blockquote><p>æ˜ å°„åŒºé—´çš„å¤šä¸ªæ•°å€¼ä¸æ˜¯å¿…é¡»é€’å¢çš„ã€‚</p><p>tableValues = â€œ1 1â€</p><p>åŸåŒºé—´ ï¼š [0,1]</p><p>æ˜ å°„åŒºé—´: [1,1]</p><p>æ— è®ºåŸæ¥çš„é¢œè‰²æ˜¯ä»€ä¹ˆï¼Œæ˜ å°„åéƒ½æ˜¯ 1</p></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>f6<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feComponentTransfer</span> <span class="token attr-name">in</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>SourceGraphic<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feFuncR</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>table<span class="token punctuation">"</span></span> <span class="token attr-name">tableValues</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0 1 1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>feFuncR</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feFuncG</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>table<span class="token punctuation">"</span></span> <span class="token attr-name">tableValues</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1 1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>feFuncG</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>feComponentTransfer</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>g</span> <span class="token attr-name">filter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#f6)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rgb(50,0,0)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rgb(200,0,0)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>g</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>g</span> <span class="token attr-name">transform</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>translate(0,30)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rgb(50,0,0)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rgb(200,0,0)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>g</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/119.png" alt="1683710379407" style="zoom:50%;" /><blockquote><p>discrete (ç¦»æ•£)æ˜ å°„è½¬æ¢</p><ul><li>é…åˆ tableValues å±æ€§</li></ul></blockquote><p>è§£æï¼š</p><p>tableValues=â€0 0.5 1â€</p><p>type=â€tableâ€ 3 ä¸ªæ•°å€¼å¯¹åº” 2 ä¸ªæ®µ</p><p>type=â€discreteâ€ 3 ä¸ªæ•°å€¼å¯¹åº” 3 ä¸ªç‚¹ï¼Œç†è§£æˆå¯¹åº” 3 ä¸ªæ®µ [0,0] , [0.5,0.5] ,[1,1]</p><p>é»˜è®¤åŒºé—´ï¼š[0 , 0.33] [0.33 , 0.66] , [0.66 , 1]</p><p>æ˜ å°„åŒºé—´(ç‚¹) 0 0.5 1</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>f7<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feComponentTransfer</span> <span class="token attr-name">in</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>SourceGraphic<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feFuncR</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>discrete<span class="token punctuation">"</span></span> <span class="token attr-name">tableValues</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0 1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>feFuncR</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>feComponentTransfer</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>g</span> <span class="token attr-name">filter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#f7)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rgb(50,0,0)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rgb(220,0,0)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>g</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>g</span> <span class="token attr-name">transform</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>translate(0,30)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rgb(50,0,0)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rgb(220,0,0)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>g</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/120.png" alt="1683711679073" style="zoom:50%;" /><h3 id="10ï¼‰morphology-å½¢æ€æ»¤é•œ"><a href="#10ï¼‰morphology-å½¢æ€æ»¤é•œ" class="headerlink" title="10ï¼‰morphology å½¢æ€æ»¤é•œ"></a>10ï¼‰morphology å½¢æ€æ»¤é•œ</h3><p>å®ç°å›¾åƒçš„è…èš€å’Œæ‰©å±•</p><p>å›¾åƒå¯ä»¥æ˜¯æ–‡å­—ä¹Ÿå¯ä»¥æ˜¯å›¾å½¢</p><ul><li>æ–‡å­—ä½“ç°çš„å°±æ˜¯ç²—ç»†</li><li>å›¾å½¢ä½“ç°çš„å¤§å°ã€‚ å¸¸è§çš„å°±æ˜¯ä¸è§„åˆ™å›¾å½¢è®¾ç½®æè¾¹ã€‚</li></ul><p>ä½¿ç”¨<code>&lt;feMorphology&gt;</code>æ ‡ç­¾å®ç°æ•ˆæœ</p><ul><li>operator : è®¾ç½®å½¢æ€ç±»å‹ erode è…èš€ ï¼Œ dilate æ‰©å¼ </li><li>radius ï¼š è®¾ç½®å˜å½¢ç¨‹åº¦</li></ul><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>f11<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feMorphology</span> <span class="token attr-name">operator</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>erode<span class="token punctuation">"</span></span> <span class="token attr-name">radius</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.2<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>f12<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feMorphology</span> <span class="token attr-name">operator</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>erode<span class="token punctuation">"</span></span> <span class="token attr-name">radius</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>.5<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>dmc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">filter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#f11)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>dmc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>80<span class="token punctuation">"</span></span> <span class="token attr-name">filter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#f12)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>dmc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/121.png" alt="1683777095824" style="zoom:50%;" /><blockquote><p>å†…éƒ¨æœ‰è…èš€å’Œæ‰©å¼ çš„ç®—æ³•ï¼Œæ‰€ä»¥æ•ˆæœå¹¶ä¸æ˜¯å•çº¯çš„å˜ç»†æˆ–å˜å°ã€‚</p><p><a href="https://www.w3.org/TR/SVG11/filters.html#feMorphologyElement">https://www.w3.org/TR/SVG11/filters.html#feMorphologyElement</a></p></blockquote><blockquote><p>ä½¿ç”¨å½¢æ€æ»¤é•œå®ç°ä¸è§„åˆ™å›¾å½¢çš„æè¾¹</p></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>f4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feMorphology</span>      <span class="token attr-name">in</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>SourceGraphic<span class="token punctuation">"</span></span>      <span class="token attr-name">operator</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>dilate<span class="token punctuation">"</span></span>      <span class="token attr-name">radius</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2<span class="token punctuation">"</span></span>      <span class="token attr-name">result</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>img1<span class="token punctuation">"</span></span>    <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feFlood</span> <span class="token attr-name">flood-color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#f00<span class="token punctuation">"</span></span> <span class="token attr-name">flood-opacity</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">result</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>img2<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feComposite</span> <span class="token attr-name">in</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>img2<span class="token punctuation">"</span></span> <span class="token attr-name">in2</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>img1<span class="token punctuation">"</span></span> <span class="token attr-name">operator</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>in<span class="token punctuation">"</span></span> <span class="token attr-name">result</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>img3<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feMerge</span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feMergeNode</span> <span class="token attr-name">in</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>img3<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feMergeNode</span> <span class="token attr-name">in</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>SourceGraphic<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>feMerge</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span>  <span class="token attr-name"><span class="token namespace">xlink:</span>href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>../imgs/7.png<span class="token punctuation">"</span></span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>80<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>80<span class="token punctuation">"</span></span>  <span class="token attr-name">filter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#f4)<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/122.png" alt="1683777284094" style="zoom:50%;" /><h4 id="æ‰©å±•ï¼šflood-æ»¤é•œ"><a href="#æ‰©å±•ï¼šflood-æ»¤é•œ" class="headerlink" title="æ‰©å±•ï¼šflood æ»¤é•œ"></a>æ‰©å±•ï¼šflood æ»¤é•œ</h4><p>ç”¨äºå°†æ•´ä¸ªå›¾åƒå¡«å……ä¸ºå•ä¸ªé¢œè‰²</p><ul><li>flood-color è®¾ç½®é¢œè‰²</li><li>flood-opacity è®¾ç½®é€æ˜åº¦</li></ul><p>ç»å¸¸ç”¨æ¥é…åˆå…¶ä»–æ»¤é•œã€‚</p><blockquote><p>ä¹Ÿæ”¯æŒ x , y , width , height æ§åˆ¶å¡«å……åŒºåŸŸå¤§å°ã€‚</p></blockquote><h3 id="11ï¼‰map-ä½ç§»æ˜ å°„æ»¤é•œ"><a href="#11ï¼‰map-ä½ç§»æ˜ å°„æ»¤é•œ" class="headerlink" title="11ï¼‰map ä½ç§»æ˜ å°„æ»¤é•œ"></a>11ï¼‰map ä½ç§»æ˜ å°„æ»¤é•œ</h3><p>å¯ä»¥åˆ›å»ºæ°´æ³¢ï¼Œæ¶Ÿæ¼ªï¼Œæ‰­æ›²ç­‰è§†è§‰æ•ˆæœã€‚</p><p>ä½¿ç”¨<code>&lt;feDisplacementMap&gt;</code>æ ‡ç­¾å®ç°æ•ˆæœ</p><p>å®ç°åŸç†ï¼š</p><ul><li><p>å°† A å›¾åƒçš„å†…å®¹æ”¾ç½®åˆ° B å›¾åƒçš„ç©ºé—´ä¸­ ï¼Œ å°† A å›¾åƒçš„æ¯ä¸€ä¸ªåƒç´ å€¼æ˜ å°„åˆ° B å›¾åƒç©ºé—´ (æœ€ç»ˆæ˜¾ç¤º A å›¾åƒçš„å†…å®¹)</p></li><li><p>åœ¨è¿™ä¸ªæ˜ å°„è¿‡ç¨‹ä¸­ï¼Œä¼šéµå¾ªæŒ‡å®šçš„ä½ç§»å…¬å¼ï¼ˆå…³ç³»ï¼‰</p><p><code>P(x + scale * (XC(x,y) - 0.5), y + scale * (YC(x,y) - 0.5)) -&gt; P&#39;(x,y)</code></p><ul><li><p>P(x,y) A å›¾åƒçš„åæ ‡ä½ç½®</p></li><li><p>Pâ€™(x,y)B å›¾åƒçš„åæ ‡ä½ç½®</p></li><li><p>scale ä½ç§»æ¯”ä¾‹ï¼Œ æ¯”ä¾‹å€¼è¶Šå¤§ï¼Œ ä½ç§»æ•ˆæœè¶Šæ˜æ˜¾</p></li><li><p>XC(x,y) å½“å‰ä½ç½®çš„åƒç´ åœ¨ x è½´ä½ç§»æ—¶ï¼Œä½¿ç”¨çš„ B å›¾åƒå¯¹åº”ä½ç½®çš„ RGBA(ä¹‹ä¸€)é€šé“å€¼æ¥è¿›è¡Œä½ç§»è®¡ç®—</p><ul><li>æ³¨æ„ï¼šé€šé“å€¼åœ¨è®¡ç®—æ—¶ä¼šè½¬æ¢æˆ[0,1]åŒºé—´å†è®¡ç®—</li></ul></li><li><p>YC(x,y) å½“å‰ä½ç½®çš„åƒç´ åœ¨ y è½´ä½ç§»æ—¶ï¼Œä½¿ç”¨çš„ B å›¾åƒå¯¹åº”ä½ç½®çš„ RGBA(ä¹‹ä¸€)é€šé“å€¼æ¥è¿›è¡Œä½ç§»è®¡ç®—</p></li><li><p>-0.5 è®¡ç®—å¸¸é‡ã€‚</p></li></ul></li><li><p>æ¡ˆä¾‹ï¼š</p><ul><li><p>è®¾ç½® x = 0 , y=0 . æ³¨æ„ï¼šæ­¤æ—¶ ä¸æ˜¯ P(0,0) å’Œ Pâ€™(0,0)</p></li><li><p>scale = 20</p></li><li><p>B å›¾åƒ(0,0)ä½ç½® RGBA é€šé“å€¼(255,0,0,0.5)</p></li><li><p>XC = R(255) , YC = A(0.5)</p><hr></li><li><p>P( 0 + 20 _ (1-0.5) , 0 + 20 _ (0.5 - 0.5) ) -&gt; Pâ€™(0 ,0)</p></li><li><p>P(10 , 0) -&gt; Pâ€™(0,0)</p></li><li><p>å°† A å›¾åƒ(10,0)ä½ç½®çš„åƒç´ å€¼ åœ¨ B å›¾åƒ(0,0)ä½ç½®æ˜¾ç¤º</p><p>10.svg</p></li></ul></li></ul><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span>  <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://www.w3.org/2000/svg<span class="token punctuation">"</span></span>  <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0 0 20 20<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#00f<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>10.html</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>svg</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>400<span class="token punctuation">"</span></span> <span class="token attr-name">viewBox</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0 0 20 20<span class="token punctuation">"</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">border</span><span class="token punctuation">:</span>solid <span class="token hexcode">#000</span><span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>f1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feImage</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10.svg<span class="token punctuation">"</span></span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">result</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>img1<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feDisplacementMap</span>        <span class="token attr-name">in</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>img1<span class="token punctuation">"</span></span>        <span class="token attr-name">in2</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>SourceGraphic<span class="token punctuation">"</span></span>        <span class="token attr-name">scale</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>        <span class="token attr-name">xChannelSelector</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>R<span class="token punctuation">"</span></span>        <span class="token attr-name">yChannelSelector</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>A<span class="token punctuation">"</span></span>      <span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>feDisplacementMap</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span>    <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>    <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>    <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>    <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>    <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rgba(255,0,0,0.5)<span class="token punctuation">"</span></span>    <span class="token attr-name">filter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#f1)<span class="token punctuation">"</span></span>  <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name"><span class="token namespace">xlink:</span>href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10.svg<span class="token punctuation">"</span></span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>svg</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>in è¾“å…¥å›¾åƒï¼Œ A å›¾åƒï¼Œ æœ€é‡è¦å±•ç¤ºçš„å›¾åƒ</li><li>in2 ç›®æ ‡å›¾åƒ ï¼Œ B å›¾åƒï¼Œ ç”¨æ¥æä¾›æ˜ å°„é€šé“çš„å›¾åƒ</li><li>xChannelSelector å¯é€‰å€¼ RGBA ä¹‹ä¸€ï¼Œ é€‰æ‹©æŒ‡å®šé€šé“å€¼[0,1]ä½œä¸º x è½´æ˜ å°„çš„è®¡ç®—å€¼</li><li>yChannelSelector å¯é€‰å€¼ RGBA ä¹‹ä¸€ï¼Œ é€‰æ‹©æŒ‡å®šé€šé“å€¼[0,1]ä½œä¸º y è½´æ˜ å°„çš„è®¡ç®—å€¼</li><li>scale æ˜ å°„æ¯”ä¾‹</li></ul><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/123.png" alt="1683876181867" style="zoom:50%;" /><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>f3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feImage</span>      <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>../imgs/6.png<span class="token punctuation">"</span></span>      <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>      <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span>      <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span>      <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span>      <span class="token attr-name">result</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>img1<span class="token punctuation">"</span></span>    <span class="token punctuation">/></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feDisplacementMap</span>      <span class="token attr-name">in</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>img1<span class="token punctuation">"</span></span>      <span class="token attr-name">in2</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>SourceGraphic<span class="token punctuation">"</span></span>      <span class="token attr-name">scale</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>      <span class="token attr-name">xChannelSelector</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>A<span class="token punctuation">"</span></span>      <span class="token attr-name">yChannelSelector</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>R<span class="token punctuation">"</span></span>    <span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>feDisplacementMap</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>g</span> <span class="token attr-name">filter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#f3)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>25<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rgba(255,0,0.5)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>25<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>25<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rgba(0,0,0,0.5)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>50<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>25<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rgba(255,0,0.5)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>75<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>25<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rgba(0,0,0,0.5)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>25<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>rgba(255,0,0.5)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>g</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/124.png" alt="1683876239486" style="zoom:50%;" /><h3 id="12ï¼‰turbulence-æ¹æµæ»¤é•œ"><a href="#12ï¼‰turbulence-æ¹æµæ»¤é•œ" class="headerlink" title="12ï¼‰turbulence æ¹æµæ»¤é•œ"></a>12ï¼‰turbulence æ¹æµæ»¤é•œ</h3><p>åˆ©ç”¨å™ªå£°å‡½æ•°ï¼Œåˆ›å»ºåŠé€æ˜æˆ–æ³¢çŠ¶å›¾å½¢ï¼Œä¾‹å¦‚äººé€ çº¹ç†ã€‚</p><p>ä½¿ç”¨<code>&lt;feTurbulence&gt;</code>æ ‡ç­¾å®ç°æ•ˆæœ</p><p>ä¸éœ€è¦åŸå›¾ï¼Œ ç›´æ¥åˆ›å»ºæ³¢çº¹å°†å…¶ä½œç”¨åœ¨åŸå›¾ä¸Šã€‚</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>f1<span class="token punctuation">"</span></span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feTurbulence</span> <span class="token attr-name">baseFrequency</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0.05<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>80<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#ff0<span class="token punctuation">"</span></span> <span class="token attr-name">filter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#f1)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><p>baseFrequency è®¾ç½®æ³¢çº¹å›¾å½¢åŒºåŸŸçš„å¤§å° ï¼Œ é¢‘ç‡è¶Šå°ï¼Œå›¾å½¢è¶Šå¤§ã€‚é¢‘ç‡è¶Šå¤§ï¼Œå›¾å½¢è¶Šå°è¶Šç²¾ç»†</p><p>é€šå¸¸å–å€¼ 0.02 ~ 0.2</p></li><li><p>numOctaves è®¾ç½®å™ªå£°çš„ç²¾ç»†åº¦ã€‚ å€¼è¶Šå¤§ï¼Œ å™ªå£°æ›´è¯¦ç»† é»˜è®¤å€¼ 1 ã€‚ å€¼è¶Šå¤§ï¼Œä¼šæœ‰æ›´é«˜çš„è¿ç®—ï¼Œå½±å“æ€§èƒ½ã€‚</p></li><li><p>seed å¯ä»¥ç”Ÿæˆä¸åŒå½¢çŠ¶çš„æ¡çº¹ã€‚</p></li><li><p>type</p><ul><li>turbulence å½¢çŠ¶æ··ä¹±ï¼Œè¡¨ç°ä¸ºéšæœºï¼Œä¸å¯é¢„æµ‹çš„ï¼Œç´Šä¹±çš„æ•ˆæœã€‚ å½¢çŠ¶å°–é”ï¼Œ å½¢ä¼¼æ¹æµ</li><li>fractalNoise åˆ†å½¢å™ªå£°æ›´åŠ å¹³ç¼“ï¼Œ å¸¦æœ‰æ¨¡ç³Šæ•ˆæœã€‚</li></ul></li><li><p>stitchTiles</p></li></ul><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/125.png" alt="1683880363239" style="zoom:50%;" /><blockquote><p>stitchTiles å±æ€§ å½“ä¸¤å—ä½¿ç”¨æ¹æµæ»¤é•œçš„å›¾å½¢æ‹¼æ¥åœ¨ä¸€èµ·æ—¶ï¼Œæ§åˆ¶æ‹¼æ¥ç¼å¤„çš„æ¹æµæ•ˆæœ</p><ul><li>noStitch é»˜è®¤ ä¸¤ä¸ªåŒºåŸŸåœ¨è§†è§‰æ•ˆæœä¸Šæ˜¯ç‹¬ç«‹çš„</li><li>stitch ä¸¤ä¸ªåŒºåŸŸåœ¨è§†è§‰æ•ˆæœä¸Šæ˜¯è”é€šçš„ï¼Œå¦‚åŒä¸€ä¸ªåŒºåŸŸä¸€æ ·ã€‚</li></ul></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>f2<span class="token punctuation">"</span></span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feTurbulence</span>      <span class="token attr-name">baseFrequency</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0.05<span class="token punctuation">"</span></span>      <span class="token attr-name">numOctaves</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span>      <span class="token attr-name">seed</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span>      <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>turbulence<span class="token punctuation">"</span></span>      <span class="token attr-name">stitchTiles</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stitch<span class="token punctuation">"</span></span>    <span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>feTurbulence</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#ff0<span class="token punctuation">"</span></span> <span class="token attr-name">filter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#f2)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span>  <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span>  <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span>  <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>40<span class="token punctuation">"</span></span>  <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>30<span class="token punctuation">"</span></span>  <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#ff0<span class="token punctuation">"</span></span>  <span class="token attr-name">filter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#f2)<span class="token punctuation">"</span></span>  <span class="token attr-name">transform</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>translate(40,0)<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/126.png" alt="1683880324706" style="zoom:50%;" /><blockquote><p>ä½¿ç”¨ baseFrequency è®¾ç½®æ³¢çº¹åŒºåŸŸæ—¶ï¼Œå¯ä»¥æœ‰ x å’Œ y ä¸¤ä¸ªå€¼çš„è®¾ç½®ã€‚</p><p>å½“è®¾ç½®ä¸€ä¸ªå€¼çš„æ—¶å€™ï¼Œx å’Œ y ç›¸ç­‰ã€‚</p><p>å¯ä»¥è®¾ç½® x å’Œ y ä¸åŒçš„æ¯”ä¾‹ï¼Œ æ‹‰ä¼¸å™ªå£°åŒºåŸŸ . åˆ›å»ºä¸Šæ°´æµæ³¢çº¹</p></blockquote><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>defs</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>f4<span class="token punctuation">"</span></span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>feTurbulence</span>      <span class="token attr-name">baseFrequency</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0.05 0.2<span class="token punctuation">"</span></span>      <span class="token attr-name">numOctaves</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span>      <span class="token attr-name">seed</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1<span class="token punctuation">"</span></span>      <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>turbulence<span class="token punctuation">"</span></span>    <span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>feTurbulence</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>defs</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rect</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>10<span class="token punctuation">"</span></span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>80<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>60<span class="token punctuation">"</span></span> <span class="token attr-name">fill</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#ff0<span class="token punctuation">"</span></span> <span class="token attr-name">filter</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>url(#f4)<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://oss.duyiedu.com/svg/127.png" alt="1683880377328" style="zoom:50%;" /><h3 id="13ï¼‰æ»¤é•œä¸åŠ¨ç”»"><a href="#13ï¼‰æ»¤é•œä¸åŠ¨ç”»" class="headerlink" title="13ï¼‰æ»¤é•œä¸åŠ¨ç”»"></a>13ï¼‰æ»¤é•œä¸åŠ¨ç”»</h3><h4 id="æ¨¡ç³ŠåŠ¨ç”»"><a href="#æ¨¡ç³ŠåŠ¨ç”»" class="headerlink" title="æ¨¡ç³ŠåŠ¨ç”»"></a>æ¨¡ç³ŠåŠ¨ç”»</h4><h4 id="è‰²å½©çŸ©é˜µè½¬æ¢åŠ¨ç”»"><a href="#è‰²å½©çŸ©é˜µè½¬æ¢åŠ¨ç”»" class="headerlink" title="è‰²å½©çŸ©é˜µè½¬æ¢åŠ¨ç”»"></a>è‰²å½©çŸ©é˜µè½¬æ¢åŠ¨ç”»</h4><h4 id="æ–‡å­—-æ¹æµåŠ¨ç”»"><a href="#æ–‡å­—-æ¹æµåŠ¨ç”»" class="headerlink" title="æ–‡å­—+æ¹æµåŠ¨ç”»"></a>æ–‡å­—+æ¹æµåŠ¨ç”»</h4><h4 id="å›¾å½¢-æ¹æµåŠ¨ç”»-å®ç°æ°´æ³¢æµåŠ¨"><a href="#å›¾å½¢-æ¹æµåŠ¨ç”»-å®ç°æ°´æ³¢æµåŠ¨" class="headerlink" title="å›¾å½¢+æ¹æµåŠ¨ç”» å®ç°æ°´æ³¢æµåŠ¨"></a>å›¾å½¢+æ¹æµåŠ¨ç”» å®ç°æ°´æ³¢æµåŠ¨</h4><h4 id="å›¾å½¢-ä½ç§»æ˜ å°„-å®ç°å›¾åƒæ¶Ÿæ¼ª"><a href="#å›¾å½¢-ä½ç§»æ˜ å°„-å®ç°å›¾åƒæ¶Ÿæ¼ª" class="headerlink" title="å›¾å½¢+ä½ç§»æ˜ å°„ å®ç°å›¾åƒæ¶Ÿæ¼ª"></a>å›¾å½¢+ä½ç§»æ˜ å°„ å®ç°å›¾åƒæ¶Ÿæ¼ª</h4><h2 id="9-Snap-åº“"><a href="#9-Snap-åº“" class="headerlink" title="9 Snap åº“"></a>9 Snap åº“</h2><p>æ˜¯ä¸€ä¸ª svg çš„ api åº“ï¼Œ æä¾›äº†æ›´ç®€å•çš„æ–¹æ³•æ¥åˆ›å»ºï¼Œæ“ä½œï¼ŒåŠ¨ç”» svg å›¾å½¢ã€‚</p><h3 id="1ï¼‰-ä¸‹è½½å¹¶å¼•å…¥"><a href="#1ï¼‰-ä¸‹è½½å¹¶å¼•å…¥" class="headerlink" title="1ï¼‰ ä¸‹è½½å¹¶å¼•å…¥"></a>1ï¼‰ ä¸‹è½½å¹¶å¼•å…¥</h3><p>å®˜ç½‘ä¸‹è½½ï¼šsnapsvg.io</p><p>npm å®‰è£… ï¼š<a href="https://github.com/adobe-webplatform/Snap.svg">https://github.com/adobe-webplatform/Snap.svg</a></p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>snap.svg.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="2ï¼‰åˆ›å»ºç”»å¸ƒ-Pager"><a href="#2ï¼‰åˆ›å»ºç”»å¸ƒ-Pager" class="headerlink" title="2ï¼‰åˆ›å»ºç”»å¸ƒ Pager"></a>2ï¼‰åˆ›å»ºç”»å¸ƒ Pager</h3><p>å°±ç›¸å½“äºåˆ›å»ºäº†ä¸€ä¸ª svg æ ‡ç­¾ï¼Œä¼šäº§ç”Ÿä¸€ä¸ª Pager å¯¹è±¡ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> pager <span class="token operator">=</span> <span class="token function">Snap</span><span class="token punctuation">(</span>width<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//åˆ›å»ºpagerå¯¹è±¡ï¼Œ å¹¶åœ¨bodyä¸­åˆ›å»ºä¸€ä¸ªsvgæ ‡ç­¾</span><span class="token keyword">const</span> pager <span class="token operator">=</span> <span class="token function">Snap</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//åˆ›å»ºpagerå¯¹è±¡ï¼Œ å…³è”bodyä¸­å·²æœ‰çš„ä¸€ä¸ªsvgæ ‡ç­¾ã€‚</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="3ï¼‰ç»˜åˆ¶å›¾å½¢"><a href="#3ï¼‰ç»˜åˆ¶å›¾å½¢" class="headerlink" title="3ï¼‰ç»˜åˆ¶å›¾å½¢"></a>3ï¼‰ç»˜åˆ¶å›¾å½¢</h3><p>åœ¨ç”»å¸ƒä¸­ç»˜åˆ¶å›¾å½¢(åœ†ï¼Œæ¤­åœ†ï¼Œçº¿ï¼ŒæŠ˜çº¿ï¼Œå¤šè¾¹å½¢ï¼ŒçŸ©å½¢ï¼Œpath ï¼Œ æ¸å˜ï¼Œfilter)</p><p>ä½¿ç”¨çš„æ˜¯ Pager å¯¹è±¡ç›¸å…³çš„ API</p><blockquote><p>åˆ›å»ºçš„æ¯ä¸€ä¸ªå›¾å½¢éƒ½æ˜¯ Element å¯¹è±¡ã€‚ å¯ä»¥ä½¿ç”¨ Element çš„ API è¿›ä¸€æ­¥æ“ä½œè®¾ç½®å›¾å½¢å…ƒç´ </p></blockquote><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> element <span class="token operator">=</span> pager<span class="token punctuation">.</span><span class="token function">rect</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="4ï¼‰è®¾ç½®å›¾å½¢å…ƒç´ "><a href="#4ï¼‰è®¾ç½®å›¾å½¢å…ƒç´ " class="headerlink" title="4ï¼‰è®¾ç½®å›¾å½¢å…ƒç´ "></a>4ï¼‰è®¾ç½®å›¾å½¢å…ƒç´ </h3><p>æ¯ä¸€ä¸ªå›¾å½¢éƒ½æ˜¯ Element å…ƒç´ å¯¹è±¡ã€‚</p><p>å¯ä»¥ä½¿ç”¨ Element å¯¹è±¡ç›¸å…³çš„ api å¯¹å›¾å½¢åšè¿›ä¸€æ­¥çš„æ“ä½œå’Œè®¾ç½®ã€‚</p><p>å¦‚ï¼š å±æ€§ï¼ŒåŠ¨ç”»ï¼Œæ¸å˜ï¼Œæ»¤é•œï¼Œäº‹ä»¶ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript">element<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  fill<span class="token punctuation">:</span> <span class="token string">"#fac"</span><span class="token punctuation">,</span>  stroke<span class="token punctuation">:</span> <span class="token string">"#ccc"</span><span class="token punctuation">,</span>  strokeWidth<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>  transform<span class="token punctuation">:</span> <span class="token string">"rotate(45,75,100)"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>pager ä¹Ÿå¯ä»¥ä½¿ç”¨ attr()å‡½æ•°ï¼Œè®¾ç½® svg çš„å±æ€§ã€‚</p></blockquote><h3 id="5ï¼‰è®¾ç½®å›¾å½¢åŠ¨ç”»"><a href="#5ï¼‰è®¾ç½®å›¾å½¢åŠ¨ç”»" class="headerlink" title="5ï¼‰è®¾ç½®å›¾å½¢åŠ¨ç”»"></a>5ï¼‰è®¾ç½®å›¾å½¢åŠ¨ç”»</h3><p>ä½¿ç”¨ element.animate()</p><pre class="line-numbers language-javascript"><code class="language-javascript">circle<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  circle<span class="token punctuation">.</span><span class="token function">animate</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span> r<span class="token punctuation">:</span> <span class="token number">30</span><span class="token punctuation">,</span> cx<span class="token punctuation">:</span> <span class="token number">60</span> <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">animate</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span> r<span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span> cx<span class="token punctuation">:</span> <span class="token number">50</span> <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>å¯¹ path çš„ d å±æ€§ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ animate åŠ¨ç”»å‡½æ•°ï¼Œ å¹¶ä¸”æœ‰åŠ¨ç”»å˜åŒ–çš„è¿‡ç¨‹ã€‚ è¿‡ç¨‹ä¸å¯æ§ã€‚</p></blockquote><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> svg2 <span class="token operator">=</span> <span class="token function">Snap</span><span class="token punctuation">(</span><span class="token string">"#svg2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>svg2<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  width<span class="token punctuation">:</span> <span class="token number">400</span><span class="token punctuation">,</span>  height<span class="token punctuation">:</span> <span class="token number">400</span><span class="token punctuation">,</span>  viewBox<span class="token punctuation">:</span> <span class="token string">"0 0 100 100"</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> path <span class="token operator">=</span> svg2<span class="token punctuation">.</span><span class="token function">path</span><span class="token punctuation">(</span><span class="token string">"M20 50 H 80"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>path<span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span>  fill<span class="token punctuation">:</span> <span class="token string">"none"</span><span class="token punctuation">,</span>  stroke<span class="token punctuation">:</span> <span class="token string">"#00f"</span><span class="token punctuation">,</span>  strokeWidth<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span><span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>path<span class="token punctuation">.</span><span class="token function">animate</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>#<span class="token number">123</span><span class="token punctuation">;</span> d<span class="token punctuation">:</span> <span class="token string">"M20 50 A20 20 0 0 1 80 50A20 20 0 0 1 20 50 "</span> <span class="token operator">&amp;</span>#<span class="token number">125</span><span class="token punctuation">;</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="6ï¼‰Snap-é™æ€æ–¹æ³•"><a href="#6ï¼‰Snap-é™æ€æ–¹æ³•" class="headerlink" title="6ï¼‰Snap é™æ€æ–¹æ³•"></a>6ï¼‰Snap é™æ€æ–¹æ³•</h3><p>Snap é™¤äº†ä½¿ç”¨å·¥å‚å‡½æ•°ä»¥å¤–ï¼Œ è¿˜æä¾›äº†è®¸å¤šçš„é™æ€æ–¹æ³•(å·¥å…·æ–¹æ³•)</p><p>ä¾‹å¦‚:</p><ul><li>Snap.sin(è§’åº¦) ã€‚ ç›´æ¥å¯¹è§’åº¦è¿›è¡Œè®¡ç®—ã€‚ ä¸ Math.sin()ä¸åŒï¼Œ æ”¯æŒçš„æ˜¯å¼§åº¦ã€‚</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">//snapåº“çš„ä¸‰è§’å‡½æ•°è®¡ç®—</span>Sanp<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//Mathçš„ä¸‰è§’å‡½æ•°è®¡ç®—,éœ€è¦å°†è§’åº¦è½¬æ¢æˆå¼§åº¦æ‰èƒ½è®¡ç®—ã€‚</span>Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">90</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span>PI<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">180</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><p>Snap.deg(rad) å¼§åº¦è½¬è§’åº¦</p></li><li><p>Snap.rad(deg) è§’åº¦è½¬å¼§åº¦</p></li></ul></iframe><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> SVG </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Github </tag>
            
            <tag> åšå®¢ </tag>
            
            <tag> SVG </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯çŸ¥è¯†æ±‡æ€»ï¼ˆæŒç»­æ›´æ–°ä¸­.....ï¼‰</title>
      <link href="/2025/05/10/88/"/>
      <url>/2025/05/10/88/</url>
      
        <content type="html"><![CDATA[<p>1ã€ä»€ä¹ˆæ˜¯é—­åŒ…ï¼Œé—­åŒ…çš„åº”ç”¨åœºæ™¯<br>A:ä»€ä¹ˆæ˜¯é—­åŒ…ï¼šæ‰€è°“çš„é—­åŒ…å°±å¾—ä»å˜é‡æå‡è¯´èµ·ï¼Œåœ¨ js ä¸­å…¨å±€ä½œç”¨åŸŸä¸èƒ½è®¿é—®å±€éƒ¨ä½œç”¨åŸŸå†…çš„å˜é‡ï¼Œè€Œå±€éƒ¨å˜é‡å¯ä»¥è®¿é—®å…¨å±€å˜é‡ï¼›</p><p>åœ¨å‡½æ•°æ‰§è¡Œå‰ä¼šäº§ç”Ÿæ‰§è¡ŒæœŸä¸Šä¸‹æ–‡ä¹Ÿå«ä½œç”¨åŸŸï¼Œæœ‰å…¨å±€ä½œç”¨åŸŸ(window)ï¼Œå’Œå±€éƒ¨ä½œç”¨åŸŸ(æ‰§è¡Œæ—¶äº§ç”Ÿçš„)ï¼Œä¸€èˆ¬å‡½æ•°æ‰§è¡Œå®Œæˆåï¼›</p><p>ä»–çš„ä½œç”¨åŸŸå°±ä¼šè¢«é”€æ¯ï¼›é—­åŒ…å°±æ˜¯ç›¸å½“äºä½ åœ¨æ‰§è¡Œè¯¥å‡½æ•°åï¼Œæ²¡æœ‰æ‰§è¡Œå®Œæˆï¼Œä¹Ÿå°±æ˜¯è¯¥å‡½æ•°çš„ä½œç”¨åŸŸæ²¡æœ‰è¢«é”€æ¯ï¼›ç´§æ¥ç€åˆäº§ç”Ÿäº†ä¸€ä¸ªæ–°çš„ä½œç”¨åŸŸ</p><p>ä¸€èˆ¬å‡½æ•°é»˜è®¤è¿”å›çš„æ˜¯ä¸€ä¸ª undefinedï¼Œæ‰€ä»¥æ‰§è¡Œåˆ°æœ€åï¼Œç›¸å½“äºå‡½æ•°æ‰§è¡Œå®Œäº†ä»–çš„æ‰§è¡ŒæœŸä¸Šä¸‹æ–‡å°±ä¼šè¢«é”€æ¯ï¼›ä½†æ˜¯é—­åŒ…è¿”å›çš„æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¯´æ˜</p><p>è¿”å›å›æ¥åˆæ˜¯ä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œæ–°çš„å‡½æ•°åˆä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„ä½œç”¨åŸŸï¼Œåªæœ‰å½“ä½ æ‰§è¡Œè¯¥ return è¿”å›çš„å‡½æ•°æ—¶è¯¥å‡½æ•°æ‰ä¼šè¢«é”€æ¯ï¼Œå¦‚æœæ²¡æœ‰æ‰§è¡Œåˆ™è¯¥ä½œç”¨åŸŸ</p><p>å°±ä¼šä¸€ç›´å­˜åœ¨è¯¥å†…å­˜ä¸­ç­‰åœ¨æ‰§è¡Œï¼Œæ‰€ä»¥è¿™å°±æ˜¯é—­åŒ…çš„ä¸ºä»€ä¹ˆä¼šå­˜åœ¨å†…å­˜æ³„éœ²ï¼Œæƒ³è¦è§£å†³è¿™ç§æƒ…å†µï¼Œå°±å¯ä»¥ä½¿ç”¨ç«‹å³æ‰§è¡Œå‡½æ•°<br>B:åº”ç”¨åœºæ™¯ï¼Œä¸€èˆ¬æƒ…å†µåœ¨èŠ‚æµä¸é˜²æŠ–ä¸­ä¼šä½¿ç”¨é—­åŒ…ï¼Œæˆ–è€…å¯ä»¥æ±¡æŸ“å…¨å±€å˜é‡ï¼Œè¿˜æœ‰å±æ€§ç§æœ‰åŒ–ï¼›<br>2ã€ä½¿ç”¨è¿‡å“ªäº› es6 çš„è¯­æ³•<br>1ã€const let<br>2ã€è§£æ„<br>3ã€æ¨¡æ¿å­—ç¬¦ä¸²<br>4ã€ç±»<br>5ã€promise<br>6ã€set map<br>3ã€åŸºæœ¬æ•°æ®ç±»å‹å’Œå¼•ç”¨æ•°æ®ç±»å‹ï¼Œå¦‚ä½•æ·±æ‹·è´<br>1ã€åŸºæœ¬æ ‘ç±»å‹ï¼šstring number boolean null undefined<br>2ã€å¼•ç”¨æ•°æ®ç±»å‹ï¼šObject Array Function Date RegExp<br>3ã€æ·±æ‹·è´çš„æ–¹æ³•ï¼š<br>aã€ä½¿ç”¨ JSON è½¬æ¢ï¼š<br>1ã€å…ˆä½¿ç”¨ JSON.stringify æŠŠå€¼è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ ¼å¼ï¼Œç„¶ååœ¨ JSON.parse è½¬æ¢æˆå¯¹è±¡æˆ–è€…æ•°ç»„ï¼›<br>2ã€ä¼˜ç¼ºç‚¹ï¼šå¦‚æœå¯¹è±¡é‡Œé¢æœ‰å‡½æ•°ï¼Œåˆ™è¯¥å‡½æ•°æ— æ³•æ‹·è´ï¼›å¦‚æœå¯¹è±¡åŸå‹é“¾ä¸Šæœ‰å±æ€§å’Œæ–¹æ³•ä¹Ÿæ— æ³•æ‹·è´<br>bã€è¿­ä»£é€’å½’æ–¹æ³•<br>cã€Object.assign æ–¹æ³•ï¼Œä¸è¿‡è¯¥æ–¹æ³•ä»…é™äºä¸€çº§æ‹·è´ï¼Œå¦‚æœäºŒçº§çš„è¯è¿˜æ˜¯æµ…æ‹·è´<br>dã€es6 çš„è§£æ„è¿™ä¸ªæ–¹æ³•å’Œ Object.assign ä¸€æ ·ä»…é™äºä¸€çº§æ·±å…¥æ‹·è´ï¼ŒäºŒçº§æ·±å…¥å°±æ˜¯æµ…æ‹·è´<br>4ã€å¦‚ä½•åŒºåˆ†æ˜¯å¦æ˜¯æ•°ç»„<br>1ã€A instanceof B çœ‹ A å¯¹è±¡çš„åŸå‹é“¾ä¸Š æœ‰æ²¡æœ‰ B çš„åŸå‹<br>2ã€Object.prototype.toString.call();<br>3ã€constructorï¼š arr.constructor===Array;<br>5ã€css å¦‚ä½•å¼•å…¥è‡ªå®šä¹‰å­—ä½“ é¦–å…ˆä¸‹è½½å¥½å­—ä½“æ–‡ä»¶<br>@font-face{font-family:â€™éšä¾¿çš„å­—ä½“åå­—â€˜;src:â€™æ–‡ä»¶è·¯å¾„â€™}<br>åœ¨å“ªé‡Œç”¨åˆ°è¿™ä¸ªå­—ä½“å°±å¯ä»¥åœ¨è¯¥æ ‡ç­¾ä¸‹åŠ ä¸Š font-family:â€™å­—ä½“åå­—â€™å°±å¯ä»¥äº†ï¼Œå¦‚æœå­—ä½“å¤ªå¤§çš„è¯å¯ä»¥ä½¿ç”¨å­—ä½“èœ˜è››è¿›è¡Œå‹ç¼©<br>6ã€è¯´è¯´å¯¹ mvvm çš„ç†è§£<br>è‡ªå·±çš„ç†è§£ï¼šæ‰€è°“çš„ mvvm å« model-view-viewModel;<br>model ç›¸å½“äºæ•°æ®æ¨¡å‹ï¼Œå¯è¿›è¡Œå®šä¹‰æ•°æ®ä¿®æ”¹å’Œæ“ä½œæ•°æ®çš„ä¸šåŠ¡é€»è¾‘ï¼›<br>view ç›¸å½“äº UI ç»„ä»¶æŠŠæ•°æ®æ¨¡å‹é€šè¿‡ UI å±•ç¤ºå‡ºæ¥ï¼›<br>viewModel æ˜¯ä¸€ä¸ªåŒæ­¥ view å’Œ model çš„å¯¹è±¡<br>åœ¨ Mvvm æ¶æ„ä¸‹ï¼Œview å’Œ model ä¹‹é—´æ˜¯æ²¡æœ‰ç›´æ¥è”ç³»çš„ï¼Œä»–ä»¬æ˜¯é€šè¿‡ ViewModel è¿›è¡Œäº¤äº’çš„ï¼Œmodel å’Œ viewModel ä¹‹é—´çš„äº¤äº’æ˜¯åŒå‘çš„ï¼Œ<br>å› æ­¤ View æ•°æ®çš„å˜åŒ–ä¼šåŒæ­¥åˆ° Model ä¸­ï¼Œè€Œ Model æ•°æ®å˜åŒ–ä¹Ÿä¼šç«‹å³è¿”å›åˆ° View ä¸Š<br>7ã€vue çš„ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°<br>8ã€computed ä¸ watch çš„åº”ç”¨åœºæ™¯<br>computed:å¤šç”¨äºæ•°æ®è®¡ç®—å’Œå­—ç¬¦å¤„ç†ï¼›<br>watch:å¤šç”¨äºå¤„ç†äº‹ä»¶äº¤äº’<br>9ã€watch å¦‚ä½•è¿›è¡Œæ·±åº¦ç›‘å¬ï¼Œç›‘å¬å¯¹è±¡å±æ€§<br>åœ¨ watch ä¸­åŠ å…¥ deep:true å°±å¯ä»¥æ·±åº¦ç›‘å¬å¯¹è±¡å±æ€§å˜åŒ–<br>å¦‚æœæƒ³è¦å•ç‹¬ç›‘å¬æŸä¸ªå±æ€§å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²å½¢å¼â€™obj.å±æ€§åâ€™çš„æ–¹æ³•ç›‘å¬<br>10ã€vue è·¯ç”±çš„ä¸¤ç§æ¨¡å¼<br>1ã€history æ¨¡å¼:ä½¿ç”¨çš„æ˜¯ h5 çš„ history.pushState æ–¹æ³•ï¼Œç„¶åé€šè¿‡ç›‘å¬ popstate æ¥è®¾ç½®å†…å®¹<br>2ã€hash æ¨¡å¼ï¼šå»ç›‘å¬æµè§ˆå™¨çš„ hashchange æ–¹æ³•ï¼Œç„¶ååœ¨ location.hash æ‹¿åˆ°å¯¹åº”çš„è·¯å¾„ï¼Œç„¶åå†æ¸²æŸ“<br>11ã€è·¯ç”±å®ˆå«<br>1ã€å…¨å±€å®ˆå«: to:å»å“ªä¸ªé¡µé¢,from:ä»å“ªä¸ªé¡µé¢æ¥çš„ï¼›next:æ˜¯å¦å¯ä»¥è¿›è¡Œè·³è½¬é€šè¿‡<br>A:beforeEach(to,from,next)ï¼šåœ¨åŠ è½½è·¯ç”±ç»„ä»¶ä¹‹å‰å°±ä¼šæ‰§è¡Œè¯¥å‡½æ•°<br>B:beforeResolve(to,from,next):åœ¨è·¯ç”±ç»„ä»¶åŠ è½½å®Œæˆä½†æœªè·³è½¬ä¹‹å‰ä¼šæ‰§è¡Œè¯¥å‡½æ•°<br>C:beforeAfter(to,from)ï¼šåœ¨è·¯ç”±è·³è½¬å®Œæˆåä¼šæ‰§è¡Œè¯¥å‡½æ•°<br>2ã€è·¯ç”±ç‹¬äº«å®ˆå«<br>A:beforeEnter(to,from,next)ï¼šå¯¹å•ç‹¬çš„é¡µé¢è¿›è¡Œè®¾ç½®<br>3ã€ç»„ä»¶å†…å®ˆå«<br>A:beforeRouterEnter:è·¯ç”±è¿›å…¥ä¹‹å‰è°ƒç”¨ã€‚<br>B:beforeRouterUpdate:è·¯ç”±å˜åŒ–æ—¶è°ƒç”¨ã€‚<br>C:beforeRouteLeave:è·¯ç”±ç¦»å¼€æ—¶è°ƒç”¨ã€‚<br>12ã€h5 æ–°å¢äº†å“ªäº›ä¸œè¥¿<br>1ã€æ–°å¢çš„å±æ€§ï¼šplaceholderï¼ŒCalendar,date,time,email,url,search,ContentEditable,Draggable,Hidden Context-menu Data-val<br>2ã€æ–°å¢çš„æ ‡ç­¾ï¼šè¯­ä¹‰åŒ–æ ‡ç­¾ï¼Œcanvasï¼Œsvgï¼ŒAudioï¼Œvideoï¼Œ<br>3ã€Api:å®šä½ï¼Œé‡åŠ›æ„Ÿåº”ï¼ŒåŠ¨ç”»ä¼˜åŒ–ï¼ŒHistory,LocalStorage,SessionStorage,websocket,fileReader,webWorker,Fetch<br>13ã€ä»€ä¹ˆæ˜¯è¯­ä¹‰åŒ–æ ‡ç­¾<br>å¦‚æœæ•´ä¸ªç½‘ç«™éƒ½ä½¿ç”¨ div æ¥å¸ƒå±€ï¼Œå…¶å®ä¹Ÿå¯ä»¥ï¼Œä½†æ˜¯å¦‚æœåç»­æƒ³è¦ç»´æŠ¤ä»£ç ï¼Œå°±ä¼šå‘ç°æ— æ³•è¯†åˆ«å“ªä¸ª div æ˜¯å¤´éƒ¨å“ªä¸ª div æ˜¯åˆ—è¡¨ï¼Œå¾ˆéš¾æŸ¥æ‰¾ï¼Œäºæ˜¯å°±å‡ºç°äº†ä¸€äº›æ ‡ç­¾å¯ä»¥ç”¨æ¥åŒºåˆ†æ˜¯æŸä¸ªæ¨¡å—ï¼Œæ–¹ä¾¿ç†è§£é¡µé¢ç»“æ„<br>å¦‚ï¼šheader æ ‡ç­¾è¡¨ç¤ºåŒ…è£¹çš„å†…å®¹æ˜¯å¤´éƒ¨åŒºåŸŸï¼Œspanï¼šè¡¨ç¤ºè¯¥åŒ…è£¹çš„æ˜¯æ–‡æœ¬,ul è¯¥åŒ…è£¹çš„æ˜¯åˆ—è¡¨ï¼Œaside è¡¨ç¤ºä¾§è¾¹æ ï¼›main è¡¨ç¤ºä¸»è¦å†…å®¹ï¼›nav è¡¨ç¤ºå¯¼èˆªï¼›section æ®µè½æ ‡ç­¾ï¼šå¯ç”¨ä¸€å—ä¸€å—çš„åŒºåŸŸ;article æ–‡ç« æ ‡ç­¾å¯ä»¥ç›´æ¥å¼•ç”¨æ‹¿èµ°;footer è¡¨ç¤ºåº•éƒ¨åŒºåŸŸ</p><p>14ã€ä»€ä¹ˆæ˜¯åŸå‹ï¼Œä»€ä¹ˆæ˜¯åŸå‹é“¾ï¼ŸçŸ¥é“å“ªäº›ç»§æ‰¿<br>1ã€åŸå‹ï¼šåªæœ‰å‡½æ•°æ‰æœ‰åŸå‹ï¼ŒåŸå‹æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒåŸå‹ä¸Šçš„æ„é€ å‡½æ•°æŒ‡å‘çš„æ˜¯å‡½æ•°æœ¬èº«ï¼›<br>2ã€åŸå‹é“¾ï¼šæ¯ä¸ªå¯¹è±¡éƒ½æœ‰éšå¼åŸå‹ï¼Œæ¯ä¸ªéšå¼åŸå‹çš„æŒ‡å‘å°±ä¼šå½¢æˆä¸€ä¸ªé“¾æ¡ï¼Œè€Œéšå¼åŸå‹ä¹Ÿæ˜¯ä¸ªå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´ä¹Ÿä»–ä¹Ÿæœ‰éšå¼åŸå‹ï¼Œé‚£è¿™æ ·ä¸‹å»ä¸å°±ç”¨æ°¸æ— æ­¢å¢ƒäº†ï¼Œéšå¼åŸå‹çš„æœ€é¡¶ç«¯æ˜¯ null,å› ä¸ºåˆ°æœ€åä½¿ç”¨ç”± Object çš„åŸå‹ä¸Šçš„éšå¼åŸå‹å°±ä¸º nullï¼›è¿™ä¸€ç³»åˆ—å½¢æˆçš„é“¾æ¡å°±å«åŸå‹é“¾ï¼›<br>3ã€ç»§æ‰¿ï¼š<br>1ã€æ„é€ å‡½æ•°ç»§æ‰¿ï¼šåœ¨å¦ä¸€ä¸ªå‡½æ•°å†…éƒ¨ä½¿ç”¨ app æˆ–è€… call æ–¹æ³•<br>2ã€åŸå‹å®ä¾‹ç»§æ‰¿ï¼šè®©æ–°æ„é€ å¯¹è±¡çš„åŸå‹æŒ‡å‘çˆ¶çº§çš„å®ä¾‹ Cat.prototype=new Animal();è¿™é‡Œå¾—æŠŠ Cat åŸå‹çš„ constructor æŒ‡å‘è‡ªå·±ï¼Œä¸ç„¶è®¿é—®çš„æ—¶å€™ä¼šæ˜¯çˆ¶çº§å‡½æ•°ä¸æ˜¯è‡ªå·±ï¼›ç¼ºç‚¹ï¼šå¢åŠ å†…å­˜æ¶ˆè€—ï¼Œå¤š new äº†ä¸€ä¸ªå®ä¾‹<br>3ã€åŸå‹åŸå‹ç»§æ‰¿ï¼šè¿™é‡Œä¸åŸå‹å®ä¾‹ç»§æ‰¿ä¸ä¸€æ ·ï¼Œä»–ç»§æ‰¿çš„ä¸æ˜¯å®ä¾‹äº†è€Œæ˜¯ç›´æ¥ç»§æ‰¿çˆ¶çº§çš„åŸå‹ prototype;å…¶ä»–çš„è¿˜æ˜¯ä¸€æ ·ï¼Œä¹Ÿè¦æ”¹åŸå‹ä¸Š constructor çš„å€¼ï¼›ä¼˜ç‚¹ï¼šå‡å°‘å†…å­˜æ¶ˆè€—ï¼Œå‡å°‘åˆ›å»ºå®ä¾‹å¯¹è±¡<br>4ã€åœ£æ¯ç»§æ‰¿ï¼šåˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡ï¼Œå…ˆè®©ç©ºå¯¹è±¡çš„åŸå‹æŒ‡å‘çˆ¶çº§çš„åŸå‹ï¼Œç„¶åè®©å­çº§çš„åŸå‹æŒ‡å‘è¿™ä¸ªå¯¹è±¡å®ä¾‹ï¼Œç„¶åæ”¹å˜å­çº§åŸå‹çš„ constructor å±æ€§ï¼Œæœ€ååœ¨å­çº§çš„åŸå‹ä¸ŠåŠ å…¥ä¸€ä¸ªå±æ€§æŒ‡å‘çˆ¶çº§å‡½æ•°(ä¹Ÿå¯ä»¥æ˜¯çˆ¶çº§çš„åŸå‹)<br>15ã€echarts å¦‚æœéœ€è¦å®æ—¶åˆ·æ–°æ•°æ®æ€ä¹ˆåŠ;<br>ä½¿ç”¨å®šæ—¶å™¨å®æ—¶å»è·å–æ•°æ®ï¼Œç„¶åé€šè¿‡ç›‘å¬å™¨å»ç›‘å¬æ•°æ®çš„å˜åŒ–<br>16ã€æµè§ˆå™¨ç¼“å­˜æœ‰å“ªäº›ï¼Ÿ<br>http ç¼“å­˜ï¼Œcookie,Localstorageï¼ŒSessionstorage;<br>1ã€http ç¼“å­˜ï¼šå½“å®¢æˆ·ç«¯ç»™å‘æœåŠ¡å™¨è¯·æ±‚èµ„æºï¼Œä¼šå…ˆå»çœ‹æµè§ˆå™¨çš„ç¼“å­˜ï¼Œå¦‚æœæµè§ˆå™¨çš„ç¼“å­˜ä¸­åˆè¯¥èµ„æºï¼Œå°±ç›´æ¥ä»æµè§ˆå™¨ç¼“å­˜ä¸­è·å–è€Œä¸ä¼šå‘æœåŠ¡å™¨å‘é€è¯·æ±‚è·å–æ•°æ®ï¼›<br>http ç¼“å­˜éƒ½æ˜¯ä»ç¬¬äºŒæ¬¡è¯·æ±‚å¼€å§‹ï¼Œç¬¬ä¸€æ¬¡è¯·æ±‚èµ„æºæ—¶ï¼Œä»æœåŠ¡å™¨è¿”å›èµ„æºï¼Œå¹¶åœ¨å“åº”å¤´ä¸­è¿”å›ç¼“å­˜å‚æ•°ï¼Œç¬¬äºŒæ¬¡è¯·æ±‚æ—¶ï¼Œæµè§ˆå™¨åˆ¤æ–­è¿™äº›è¯·æ±‚å‚æ•°ï¼Œå‘½ä¸­å¼ºç¼“å­˜<br>å°±ç›´æ¥ 200ï¼Œå¦åˆ™å°±æŠŠè¯·æ±‚å‚æ•°æ·»åŠ åˆ°è¯·æ±‚å¤´ä¸­ä¼ ç»™æœåŠ¡å™¨ï¼Œçœ‹æ˜¯å¦å‘½ä¸­åå•†ç¼“å­˜ï¼Œå‘½ä¸­åå•†ç¼“å­˜å°±è¿”å› 304ï¼Œå¦åˆ™æœåŠ¡å™¨ä¼šè¿”å›æ–°çš„èµ„æº<br>2ã€cookie ï¼šcookie å¤§å°åªèƒ½å­˜ 4kb è€Œä¸”å®ƒæ˜¯ä»¥å­—ç¬¦ä¸²æ–‡æœ¬è¿›è¡Œä¼ è¾“ï¼Œæ¯æ¬¡è¯·æ±‚éƒ½éœ€å¸¦ä¸Š cookie å¢åŠ è¯·æ±‚å¸¦å®½ï¼Œcookie æ˜¯å­˜åœ¨å®¢æˆ·ç«¯çš„ï¼Œcookie å¯ä»¥è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®å®ƒæ˜¯è·Ÿéšæµè§ˆå™¨å…³é—­è€Œæ¶ˆå¤±ï¼Œå¦‚æœè®¾ç½®äº†ï¼Œå…³é—­æµè§ˆå™¨ä¹Ÿä¸ä¼šæ¶ˆå¤±ï¼Œåªæœ‰åˆ°äº†è¿‡æœŸæ—¶é—´ä»–åœ¨ä¼šè‡ªåŠ¨æ¶ˆå¤±<br>3ã€Localstorage æ°¸ä¹…æ€§çš„ç¼“å­˜ï¼Œå¦‚æœè‡ªå·±ä¸æ‰‹åŠ¨ remove åˆ™ä¼šä¸€ç›´å­˜åœ¨ï¼Œä»–æœ‰è‡ªå·±çš„ API æ–¹ä¾¿ä½¿ç”¨ï¼Œcookie éœ€è¦æ‰‹åŠ¨å°è£…ï¼›<br>4ã€SessionStorage ä¸´æ—¶æ€§ç¼“å­˜ï¼Œæµè§ˆå™¨å…³é—­åå°±ä¼šæ¶ˆå¤±ï¼Œä»–ä¹Ÿæœ‰è‡ªå·±çš„ API æ–¹ä¾¿ä½¿ç”¨ï¼Œä¸ Localstorage ä¸€æ ·å­˜å‚¨çš„å¤§å°ä¸º 5M;ä¸ä¼šå‘æœåŠ¡å™¨è¿›è¡Œé€šè®¯<br>5ã€Session æ˜¯ç”±æœåŠ¡ç«¯äº§ç”Ÿçš„ï¼Œä¿å­˜åœ¨æœåŠ¡å™¨å†…å­˜ï¼Œç¼“å­˜ï¼Œç¡¬ç›˜æˆ–è€…æ•°æ®åº“ä¸­ï¼Œä»–æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç›¸å¯¹äº cookie æ›´å®‰å…¨ä¸€èˆ¬æƒ…å†µé€šè¿‡åœ¨ cokie ä¸­è®¾ç½®åŠ å¯†çš„ seeeionID è¿›è¡Œä¼ é€’çš„ï¼Œsession ä¹Ÿæœ‰ç¼ºç‚¹ï¼Œå¦‚æœè®¿é—®çš„ç”¨æˆ·å¾ˆå¤šï¼Œå°±ä¼šæ¶ˆè€—æœåŠ¡å™¨å¤§é‡å†…å­˜</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯çŸ¥è¯†æ±‡æ€» </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯çŸ¥è¯†æ±‡æ€» </tag>
            
            <tag> Github </tag>
            
            <tag> åšå®¢ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AIæ•°å­—äººé¡¹ç›®è½åœ°å®è·µæ–‡æ¡£</title>
      <link href="/2025/02/21/ai-shu-zi-ren-xiang-mu-luo-di-shi-jian-wen-dang/"/>
      <url>/2025/02/21/ai-shu-zi-ren-xiang-mu-luo-di-shi-jian-wen-dang/</url>
      
        <content type="html"><![CDATA[<h1 id="AI-æ•°å­—äººé¡¹ç›®è½åœ°å®è·µæ–‡æ¡£"><a href="#AI-æ•°å­—äººé¡¹ç›®è½åœ°å®è·µæ–‡æ¡£" class="headerlink" title="AI æ•°å­—äººé¡¹ç›®è½åœ°å®è·µæ–‡æ¡£"></a>AI æ•°å­—äººé¡¹ç›®è½åœ°å®è·µæ–‡æ¡£</h1><h2 id="ğŸ“–-é¡¹ç›®æ¦‚è¿°"><a href="#ğŸ“–-é¡¹ç›®æ¦‚è¿°" class="headerlink" title="ğŸ“– é¡¹ç›®æ¦‚è¿°"></a>ğŸ“– é¡¹ç›®æ¦‚è¿°</h2><p><strong>AI è™šæ‹Ÿäººæ™ºæ…§å¤§å±</strong>æ˜¯ä¸€ä¸ªå®Œæ•´çš„ AI æ•°å­—äººè½åœ°é¡¹ç›®ï¼Œé€šè¿‡æ•´åˆè¯­éŸ³è¯†åˆ«ã€äººè„¸è¯†åˆ«ã€è‡ªç„¶è¯­è¨€å¤„ç†ã€è¯­éŸ³åˆæˆã€æ•°å­—äººæ¸²æŸ“ç­‰å¤šé¡¹ AI æŠ€æœ¯ï¼Œå®ç°äº†ä¸€ä¸ªå¯åœ¨å±•å…ã€å•†åœºã€è¥ä¸šå…ç­‰çº¿ä¸‹åœºæ™¯éƒ¨ç½²çš„æ™ºèƒ½äº¤äº’ç³»ç»Ÿã€‚</p><h3 id="é¡¹ç›®ç›®æ ‡"><a href="#é¡¹ç›®ç›®æ ‡" class="headerlink" title="é¡¹ç›®ç›®æ ‡"></a>é¡¹ç›®ç›®æ ‡</h3><ul><li>ğŸ¯ <strong>æ™ºèƒ½åŒ–æœåŠ¡</strong>ï¼šæ›¿ä»£çœŸäººä¸ç”¨æˆ·è¿›è¡Œé¢å¯¹é¢äº’åŠ¨äº¤æµ</li><li>ğŸ¯ <strong>å®æ—¶äº¤äº’</strong>ï¼šä½å»¶è¿Ÿçš„å¤šæ¨¡æ€äº¤äº’ä½“éªŒ</li><li>ğŸ¯ <strong>åœºæ™¯é€‚é…</strong>ï¼šé€‚é…å¤šç§ç¡¬ä»¶è®¾å¤‡å’Œåº”ç”¨åœºæ™¯</li><li>ğŸ¯ <strong>å¯æ‰©å±•æ€§</strong>ï¼šæ”¯æŒå¤šç§ AI å¼•æ“åˆ‡æ¢å’ŒåŠŸèƒ½æ‰©å±•</li></ul><hr><h2 id="ğŸ—ï¸-é¡¹ç›®æ¶æ„"><a href="#ğŸ—ï¸-é¡¹ç›®æ¶æ„" class="headerlink" title="ğŸ—ï¸ é¡¹ç›®æ¶æ„"></a>ğŸ—ï¸ é¡¹ç›®æ¶æ„</h2><h3 id="æŠ€æœ¯æ¶æ„å›¾"><a href="#æŠ€æœ¯æ¶æ„å›¾" class="headerlink" title="æŠ€æœ¯æ¶æ„å›¾"></a>æŠ€æœ¯æ¶æ„å›¾</h3><pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚                    ç”¨æˆ·äº¤äº’å±‚                            â”‚â”‚  (è¯­éŸ³è¾“å…¥ã€äººè„¸è¯†åˆ«ã€è§¦æ‘¸äº¤äº’ã€æ‰‹åŠ¿è¯†åˆ«)                â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚                  å‰ç«¯å±•ç¤ºå±‚                              â”‚â”‚  Vue 3 + Electron + WindiCSS                            â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚                  ä¸šåŠ¡é€»è¾‘å±‚                              â”‚â”‚  â”œâ”€ ASRè¯­éŸ³è¯†åˆ«æ¨¡å—                                     â”‚â”‚  â”œâ”€ äººè„¸è¯†åˆ«æ¨¡å—                                        â”‚â”‚  â”œâ”€ å¯¹è¯ç®¡ç†æ¨¡å—                                        â”‚â”‚  â”œâ”€ æ•°å­—äººæ¸²æŸ“æ¨¡å—                                      â”‚â”‚  â””â”€ çŠ¶æ€ç®¡ç†æ¨¡å—                                        â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚                  æœåŠ¡æ¥å£å±‚                              â”‚â”‚  â”œâ”€ Walleå¼•æ“æ¥å£                                       â”‚â”‚  â”œâ”€ è…¾è®¯äº‘ASRæ¥å£                                       â”‚â”‚  â”œâ”€ æ•°å­—äººAPIæ¥å£                                       â”‚â”‚  â””â”€ æœ¬åœ°æœåŠ¡æ¥å£                                        â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚                  åŸºç¡€è®¾æ–½å±‚                              â”‚â”‚  â”œâ”€ Electronä¸»è¿›ç¨‹                                      â”‚â”‚  â”œâ”€ WebSocketé€šä¿¡                                       â”‚â”‚  â”œâ”€ æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ                                        â”‚â”‚  â””â”€ ç¡¬ä»¶è®¾å¤‡æ¥å£                                        â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre><h3 id="æ ¸å¿ƒæ¨¡å—"><a href="#æ ¸å¿ƒæ¨¡å—" class="headerlink" title="æ ¸å¿ƒæ¨¡å—"></a>æ ¸å¿ƒæ¨¡å—</h3><ol><li><strong>è¯­éŸ³è¯†åˆ«æ¨¡å—ï¼ˆASRï¼‰</strong></li><li><strong>äººè„¸è¯†åˆ«æ¨¡å—</strong></li><li><strong>å¯¹è¯ç®¡ç†æ¨¡å—</strong></li><li><strong>æ•°å­—äººæ¸²æŸ“æ¨¡å—</strong></li><li><strong>å¤šåª’ä½“å¤„ç†æ¨¡å—</strong></li></ol><hr><h2 id="ğŸ¯-æ ¸å¿ƒåŠŸèƒ½å®ç°"><a href="#ğŸ¯-æ ¸å¿ƒåŠŸèƒ½å®ç°" class="headerlink" title="ğŸ¯ æ ¸å¿ƒåŠŸèƒ½å®ç°"></a>ğŸ¯ æ ¸å¿ƒåŠŸèƒ½å®ç°</h2><h3 id="1-å¯æ’æ‹”-ASR-ç³»ç»Ÿè®¾è®¡"><a href="#1-å¯æ’æ‹”-ASR-ç³»ç»Ÿè®¾è®¡" class="headerlink" title="1. å¯æ’æ‹” ASR ç³»ç»Ÿè®¾è®¡"></a>1. å¯æ’æ‹” ASR ç³»ç»Ÿè®¾è®¡</h3><h4 id="1-1-è®¾è®¡ç†å¿µ"><a href="#1-1-è®¾è®¡ç†å¿µ" class="headerlink" title="1.1 è®¾è®¡ç†å¿µ"></a>1.1 è®¾è®¡ç†å¿µ</h4><p>é‡‡ç”¨<strong>é€‚é…å™¨æ¨¡å¼ + å·¥å‚æ¨¡å¼</strong>ï¼Œå®ç°ä¸åŒ ASR å¼•æ“çš„ç»Ÿä¸€æŠ½è±¡å’ŒåŠ¨æ€åˆ‡æ¢ã€‚</p><p><strong>æ ¸å¿ƒä¼˜åŠ¿ï¼š</strong></p><ul><li>âœ… ç»Ÿä¸€æ¥å£ï¼Œé™ä½è€¦åˆ</li><li>âœ… è¿è¡Œæ—¶åŠ¨æ€åˆ‡æ¢</li><li>âœ… æ˜“äºæ‰©å±•æ–°çš„ ASR å¼•æ“</li><li>âœ… ç±»å‹å®‰å…¨çš„ TypeScript å®ç°</li></ul><h4 id="1-2-æ¥å£å®šä¹‰"><a href="#1-2-æ¥å£å®šä¹‰" class="headerlink" title="1.2 æ¥å£å®šä¹‰"></a>1.2 æ¥å£å®šä¹‰</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// src/interfaces/IAsrProvider.ts</span><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">IAsrProvider</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// çŠ¶æ€å±æ€§</span>  readonly asrText<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">;</span>  readonly asrState<span class="token punctuation">:</span> AsrState<span class="token punctuation">;</span>  readonly faceDetected<span class="token punctuation">:</span> <span class="token keyword">boolean</span><span class="token punctuation">;</span>  readonly faceData<span class="token punctuation">:</span> FaceDetectionResult <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// ç”Ÿå‘½å‘¨æœŸ</span>  <span class="token function">init</span><span class="token punctuation">(</span>config<span class="token punctuation">:</span> ProviderConfig<span class="token punctuation">)</span><span class="token punctuation">:</span> Promise<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span><span class="token punctuation">;</span>  <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> Promise<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// ASRæ§åˆ¶</span>  <span class="token function">startAsr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> Promise<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span><span class="token punctuation">;</span>  <span class="token function">stopAsr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> Promise<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// äººè„¸è¯†åˆ«æ§åˆ¶</span>  <span class="token function">startFaceDetection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> Promise<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span><span class="token punctuation">;</span>  <span class="token function">stopFaceDetection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> Promise<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// å›è°ƒè®¾ç½®</span>  <span class="token function">setCallbacks</span><span class="token punctuation">(</span>callbacks<span class="token punctuation">:</span> ProviderCallbacks<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// åª’ä½“è¾“å‡º</span>  getVideoOutput<span class="token operator">?</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> HTMLCanvasElement <span class="token operator">|</span> MediaStream <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  getAudioOutput<span class="token operator">?</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> MediaStream <span class="token operator">|</span> Blob <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="1-3-æä¾›è€…å®ç°å¯¹æ¯”"><a href="#1-3-æä¾›è€…å®ç°å¯¹æ¯”" class="headerlink" title="1.3 æä¾›è€…å®ç°å¯¹æ¯”"></a>1.3 æä¾›è€…å®ç°å¯¹æ¯”</h4><table><thead><tr><th>ç‰¹æ€§</th><th>Walle å¼•æ“</th><th>è…¾è®¯äº‘ ASR</th><th>WebSocket ASR</th></tr></thead><tbody><tr><td>ASR è¯†åˆ«</td><td>âœ…</td><td>âœ…</td><td>âœ…</td></tr><tr><td>äººè„¸è¯†åˆ«</td><td>âœ…</td><td>âœ…</td><td>âŒ</td></tr><tr><td>è§†é¢‘è¾“å‡º</td><td>âœ…</td><td>âŒ</td><td>âŒ</td></tr><tr><td>éŸ³é¢‘è¾“å‡º</td><td>âœ…</td><td>âŒ</td><td>âŒ</td></tr><tr><td>å˜´å‹æ£€æµ‹</td><td>âœ…</td><td>âŒ</td><td>âŒ</td></tr><tr><td>å®æ—¶æ¸²æŸ“</td><td>âœ…</td><td>âŒ</td><td>âŒ</td></tr><tr><td>è¿æ¥æ–¹å¼</td><td>WebSocket</td><td>HTTP API</td><td>WebSocket</td></tr></tbody></table><h4 id="1-4-Walle-å¼•æ“å®ç°"><a href="#1-4-Walle-å¼•æ“å®ç°" class="headerlink" title="1.4 Walle å¼•æ“å®ç°"></a>1.4 Walle å¼•æ“å®ç°</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// src/providers/WalleProvider.ts</span><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">WalleProvider</span> <span class="token keyword">implements</span> <span class="token class-name">IAsrProvider</span> <span class="token punctuation">{</span>  <span class="token keyword">private</span> walleClient<span class="token punctuation">:</span> WalleClient <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  <span class="token keyword">private</span> videoCanvas<span class="token punctuation">:</span> HTMLCanvasElement <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  async <span class="token function">init</span><span class="token punctuation">(</span>config<span class="token punctuation">:</span> ProviderConfig<span class="token punctuation">)</span><span class="token punctuation">:</span> Promise<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// 1. åˆ›å»ºWalleå®¢æˆ·ç«¯</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>walleClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WalleClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 2. è®¢é˜…ASRç»“æœ</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>walleClient<span class="token punctuation">.</span><span class="token function">subject</span><span class="token punctuation">(</span><span class="token string">"asrResult"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span>result<span class="token punctuation">:</span> <span class="token keyword">any</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>      <span class="token keyword">const</span> filteredText <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">filterText</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>asrText <span class="token operator">=</span> filteredText<span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>final<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>callbacks<span class="token punctuation">.</span>onAsrResult<span class="token operator">?</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token punctuation">{</span>          text<span class="token punctuation">:</span> filteredText<span class="token punctuation">,</span>          confidence<span class="token punctuation">:</span> result<span class="token punctuation">.</span>confidence<span class="token punctuation">,</span>          isFinal<span class="token punctuation">:</span> <span class="token keyword">true</span><span class="token punctuation">,</span>          timestamp<span class="token punctuation">:</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>callbacks<span class="token punctuation">.</span>onAsrUpdate<span class="token operator">?</span><span class="token punctuation">.</span><span class="token punctuation">(</span>filteredText<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 3. è®¢é˜…è§†é¢‘å¸§ï¼ˆåŒ…å«äººè„¸ä¿¡æ¯ï¼‰</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>walleClient<span class="token punctuation">.</span><span class="token function">subject</span><span class="token punctuation">(</span><span class="token string">"videoframe"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span>frameInfo<span class="token punctuation">:</span> <span class="token keyword">any</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>      <span class="token keyword">const</span> <span class="token punctuation">{</span> has_face<span class="token punctuation">,</span> face_num<span class="token punctuation">,</span> face_x<span class="token punctuation">,</span> face_y<span class="token punctuation">,</span> frame <span class="token punctuation">}</span> <span class="token operator">=</span> frameInfo<span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">// æ›´æ–°äººè„¸æ£€æµ‹çŠ¶æ€</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>faceDetected <span class="token operator">=</span> has_face <span class="token operator">&amp;&amp;</span> face_num <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">// ç»˜åˆ¶è§†é¢‘å¸§</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>videoCanvas <span class="token operator">&amp;&amp;</span> frame<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">const</span> ctx <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>videoCanvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        ctx<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>frame<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// ç»˜åˆ¶äººè„¸æ¡†</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>has_face<span class="token punctuation">)</span> <span class="token punctuation">{</span>          ctx<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">strokeRect</span><span class="token punctuation">(</span>face_x<span class="token punctuation">,</span> face_y<span class="token punctuation">,</span> face_w<span class="token punctuation">,</span> face_h<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment" spellcheck="true">// é‡Šæ”¾VideoFrame</span>        frame<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 4. è¿æ¥åˆ°WebSocketæœåŠ¡å™¨</span>    <span class="token keyword">const</span> serverUrl <span class="token operator">=</span> config<span class="token punctuation">.</span>serverUrl <span class="token operator">||</span> <span class="token string">"ws://localhost:39999"</span><span class="token punctuation">;</span>    await <span class="token keyword">this</span><span class="token punctuation">.</span>walleClient<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>serverUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// 5. å¯ç”¨è§†é¢‘æ¸²æŸ“</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>videoCanvas <span class="token operator">&amp;&amp;</span> supportsWebCodecs<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>walleClient<span class="token punctuation">.</span><span class="token function">renderTo</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>videoCanvas<span class="token punctuation">,</span> config<span class="token punctuation">.</span>renderOptions<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>asrState <span class="token operator">=</span> AsrState<span class="token punctuation">.</span>INITED<span class="token punctuation">;</span>  <span class="token punctuation">}</span>  async <span class="token function">startAsr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> Promise<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// Walleå¼•æ“è¿æ¥åè‡ªåŠ¨å¼€å§‹è¯†åˆ«</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>asrState <span class="token operator">=</span> AsrState<span class="token punctuation">.</span>STARTED<span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="1-5-ç»Ÿä¸€-Hook-å±‚"><a href="#1-5-ç»Ÿä¸€-Hook-å±‚" class="headerlink" title="1.5 ç»Ÿä¸€ Hook å±‚"></a>1.5 ç»Ÿä¸€ Hook å±‚</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// src/hooks/usePluggableAsr.ts</span><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">usePluggableAsr</span><span class="token punctuation">(</span>  voiceStart<span class="token operator">?</span><span class="token punctuation">:</span> Ref<span class="token operator">&lt;</span><span class="token keyword">boolean</span><span class="token operator">></span><span class="token punctuation">,</span>  options<span class="token punctuation">:</span> UsePluggableAsrOptions <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// å•ä¾‹æ¨¡å¼ï¼Œç¡®ä¿å…¨å±€åªæœ‰ä¸€ä¸ªå®ä¾‹</span>  <span class="token keyword">const</span> singleton <span class="token operator">=</span> PluggableAsrSingleton<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> singleton<span class="token punctuation">.</span><span class="token function">initialize</span><span class="token punctuation">(</span>voiceStart<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// ä½¿ç”¨ç¤ºä¾‹</span><span class="token keyword">const</span> <span class="token punctuation">{</span>  currentProvider<span class="token punctuation">,</span>  asrText<span class="token punctuation">,</span>  asrState<span class="token punctuation">,</span>  switchProvider<span class="token punctuation">,</span>  init<span class="token punctuation">,</span>  startAsr<span class="token punctuation">,</span>  setCallbacks<span class="token punctuation">,</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">usePluggableAsr</span><span class="token punctuation">(</span>voiceStart<span class="token punctuation">,</span> <span class="token punctuation">{</span>  defaultProvider<span class="token punctuation">:</span> ProviderType<span class="token punctuation">.</span>WALLE<span class="token punctuation">,</span>  autoInit<span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// åˆ‡æ¢æä¾›è€…</span>await <span class="token function">switchProvider</span><span class="token punctuation">(</span>ProviderType<span class="token punctuation">.</span>WALLE<span class="token punctuation">,</span> <span class="token punctuation">{</span>  serverUrl<span class="token punctuation">:</span> <span class="token string">"ws://localhost:39999"</span><span class="token punctuation">,</span>  videoCanvas<span class="token punctuation">:</span> canvasElement<span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// è®¾ç½®å›è°ƒ</span><span class="token function">setCallbacks</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  onAsrResult<span class="token punctuation">:</span> <span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// å¤„ç†è¯†åˆ«ç»“æœ</span>    <span class="token function">handleAsrResult</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  onFaceDetected<span class="token punctuation">:</span> <span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// å¤„ç†äººè„¸æ£€æµ‹</span>    <span class="token function">handleFaceDetection</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h3 id="2-äººè„¸è¯†åˆ«ç³»ç»Ÿ"><a href="#2-äººè„¸è¯†åˆ«ç³»ç»Ÿ" class="headerlink" title="2. äººè„¸è¯†åˆ«ç³»ç»Ÿ"></a>2. äººè„¸è¯†åˆ«ç³»ç»Ÿ</h3><h4 id="2-1-äººè„¸æ£€æµ‹æµç¨‹"><a href="#2-1-äººè„¸æ£€æµ‹æµç¨‹" class="headerlink" title="2.1 äººè„¸æ£€æµ‹æµç¨‹"></a>2.1 äººè„¸æ£€æµ‹æµç¨‹</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// Walleå¼•æ“è‡ªåŠ¨æä¾›äººè„¸æ£€æµ‹ä¿¡æ¯</span><span class="token keyword">this</span><span class="token punctuation">.</span>walleClient<span class="token punctuation">.</span><span class="token function">subject</span><span class="token punctuation">(</span><span class="token string">"videoframe"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span>frameInfo<span class="token punctuation">:</span> <span class="token keyword">any</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> <span class="token punctuation">{</span>    has_face<span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// æ˜¯å¦æ£€æµ‹åˆ°äººè„¸</span>    face_num<span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// äººè„¸æ•°é‡</span>    face_x<span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// äººè„¸Xåæ ‡</span>    face_y<span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// äººè„¸Yåæ ‡</span>    face_w<span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// äººè„¸å®½åº¦</span>    face_h<span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// äººè„¸é«˜åº¦</span>    is_wakepup<span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// å”¤é†’çŠ¶æ€</span>  <span class="token punctuation">}</span> <span class="token operator">=</span> frameInfo<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// å¹³æ»‘å¤„ç†ï¼Œé¿å…æŠ–åŠ¨</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>has_face<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>consecutiveHasFace<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>consecutiveNoFace <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>consecutiveHasFace <span class="token operator">>=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>hasFaceTotal<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>faceDetected <span class="token operator">=</span> <span class="token keyword">true</span><span class="token punctuation">;</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>callbacks<span class="token punctuation">.</span>onFaceDetected<span class="token operator">?</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token punctuation">{</span>        faceCount<span class="token punctuation">:</span> face_num<span class="token punctuation">,</span>        faces<span class="token punctuation">:</span> <span class="token punctuation">[</span>          <span class="token punctuation">{</span>            x<span class="token punctuation">:</span> face_x<span class="token punctuation">,</span>            y<span class="token punctuation">:</span> face_y<span class="token punctuation">,</span>            width<span class="token punctuation">:</span> face_w<span class="token punctuation">,</span>            height<span class="token punctuation">:</span> face_h<span class="token punctuation">,</span>          <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>consecutiveNoFace<span class="token operator">++</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>consecutiveHasFace <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>consecutiveNoFace <span class="token operator">>=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>noFaceTotal<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>faceDetected <span class="token operator">=</span> <span class="token keyword">false</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-2-äººè„¸è¯†åˆ«ä¼˜åŒ–"><a href="#2-2-äººè„¸è¯†åˆ«ä¼˜åŒ–" class="headerlink" title="2.2 äººè„¸è¯†åˆ«ä¼˜åŒ–"></a>2.2 äººè„¸è¯†åˆ«ä¼˜åŒ–</h4><p><strong>å¹³æ»‘å¤„ç†ç­–ç•¥ï¼š</strong></p><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// é…ç½®å‚æ•°</span><span class="token keyword">private</span> hasFaceTotal<span class="token punctuation">:</span> <span class="token keyword">number</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token comment" spellcheck="true">// è¿ç»­æ£€æµ‹åˆ°1æ¬¡å³è®¤ä¸ºæœ‰äººè„¸</span><span class="token keyword">private</span> noFaceTotal<span class="token punctuation">:</span> <span class="token keyword">number</span> <span class="token operator">=</span> <span class="token number">15</span> <span class="token comment" spellcheck="true">// è¿ç»­15æ¬¡æœªæ£€æµ‹åˆ°æ‰è®¤ä¸ºæ— äººè„¸</span><span class="token keyword">private</span> faceDetectIntervalMs<span class="token punctuation">:</span> <span class="token keyword">number</span> <span class="token operator">=</span> <span class="token number">0</span> <span class="token comment" spellcheck="true">// æ£€æµ‹é—´éš”ï¼ˆ0è¡¨ç¤ºæ¯å¸§éƒ½æ£€æµ‹ï¼‰</span><span class="token comment" spellcheck="true">// é¿å…è¯¯åˆ¤</span><span class="token keyword">if</span> <span class="token punctuation">(</span>has_face <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>consecutiveHasFace <span class="token operator">>=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>hasFaceTotal<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// ç¡®è®¤æœ‰äººè„¸</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>faceDetected <span class="token operator">=</span> <span class="token keyword">true</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>æ€§èƒ½ä¼˜åŒ–ï¼š</strong></p><ul><li>æ§åˆ¶æ£€æµ‹é¢‘ç‡</li><li>ä½¿ç”¨ GPU åŠ é€Ÿï¼ˆå¦‚æœæ”¯æŒï¼‰</li><li>é™åˆ¶æœ€å¤§äººè„¸æ•°é‡</li></ul><hr><h3 id="3-å¯¹è¯ç®¡ç†ç³»ç»Ÿ"><a href="#3-å¯¹è¯ç®¡ç†ç³»ç»Ÿ" class="headerlink" title="3. å¯¹è¯ç®¡ç†ç³»ç»Ÿ"></a>3. å¯¹è¯ç®¡ç†ç³»ç»Ÿ</h3><h4 id="3-1-å¯¹è¯æµç¨‹è®¾è®¡"><a href="#3-1-å¯¹è¯æµç¨‹è®¾è®¡" class="headerlink" title="3.1 å¯¹è¯æµç¨‹è®¾è®¡"></a>3.1 å¯¹è¯æµç¨‹è®¾è®¡</h4><pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚  ç”¨æˆ·è¯­éŸ³è¾“å…¥ â”‚â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚  ASRè¯­éŸ³è¯†åˆ«   â”‚â”‚  è½¬æ–‡å­—        â”‚â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚  æ–‡æœ¬é¢„å¤„ç†    â”‚â”‚  (å…³é”®è¯è¿‡æ»¤ã€  â”‚â”‚   çº é”™ã€æ ‡å‡†åŒ–)â”‚â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚  å¯¹è¯å¼•æ“      â”‚â”‚  (NLPç†è§£ã€    â”‚â”‚   æ„å›¾è¯†åˆ«)    â”‚â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚  ç”Ÿæˆå›å¤      â”‚â”‚  (çŸ¥è¯†åº“æ£€ç´¢ã€ â”‚â”‚   ä¸Šä¸‹æ–‡ç†è§£)  â”‚â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚  TTSè¯­éŸ³åˆæˆ   â”‚â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚  æ•°å­—äººæ¸²æŸ“    â”‚â”‚  (å£å‹ã€è¡¨æƒ…ã€ â”‚â”‚   æ‰‹åŠ¿åŒæ­¥)    â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre><h4 id="3-2-å¯¹è¯çŠ¶æ€ç®¡ç†"><a href="#3-2-å¯¹è¯çŠ¶æ€ç®¡ç†" class="headerlink" title="3.2 å¯¹è¯çŠ¶æ€ç®¡ç†"></a>3.2 å¯¹è¯çŠ¶æ€ç®¡ç†</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// src/views/store.ts</span>@<span class="token function">Module</span><span class="token punctuation">(</span><span class="token punctuation">{</span> namespaced<span class="token punctuation">:</span> <span class="token keyword">true</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">"app"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">AppModule</span> <span class="token keyword">extends</span> <span class="token class-name">VuexModule</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// å¯¹è¯ID</span>  conversionId <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>  scanChatId <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// å½“å‰é—®é¢˜</span>  currentWeChatQuestion<span class="token punctuation">:</span> <span class="token punctuation">{</span>    question<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">;</span>    question_time<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span> <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// å¯¹è¯åˆ—è¡¨</span>  conversations<span class="token punctuation">:</span> ConversationInfo<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  @Mutation  <span class="token function">setConversionId</span><span class="token punctuation">(</span>id<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>conversionId <span class="token operator">=</span> id<span class="token punctuation">;</span>  <span class="token punctuation">}</span>  @Mutation  <span class="token function">setCurrentWeChatQuestion</span><span class="token punctuation">(</span>question<span class="token punctuation">:</span> <span class="token keyword">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>currentWeChatQuestion <span class="token operator">=</span> question<span class="token punctuation">;</span>  <span class="token punctuation">}</span>  @Mutation  <span class="token function">addConversation</span><span class="token punctuation">(</span>conversation<span class="token punctuation">:</span> ConversationInfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>conversations<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>conversation<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3-3-å¤šè½®å¯¹è¯å®ç°"><a href="#3-3-å¤šè½®å¯¹è¯å®ç°" class="headerlink" title="3.3 å¤šè½®å¯¹è¯å®ç°"></a>3.3 å¤šè½®å¯¹è¯å®ç°</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// src/hooks/useConversation.ts</span><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">useConversation</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> conversations <span class="token operator">=</span> ref<span class="token operator">&lt;</span>ConversationInfo<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// æ·»åŠ å¯¹è¯</span>  <span class="token keyword">const</span> addConversation <span class="token operator">=</span> <span class="token punctuation">(</span>    question<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">,</span>    answer<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">,</span>    type<span class="token punctuation">:</span> <span class="token string">"consult"</span> <span class="token operator">|</span> <span class="token string">"guide"</span> <span class="token operator">|</span> <span class="token string">"other"</span> <span class="token operator">=</span> <span class="token string">"consult"</span>  <span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    conversations<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>      id<span class="token punctuation">:</span> <span class="token function">createId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>      question<span class="token punctuation">,</span>      answer<span class="token punctuation">,</span>      question_time<span class="token punctuation">:</span> <span class="token function">getCurrentFormattedTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>      answer_time<span class="token punctuation">:</span> <span class="token function">getCurrentFormattedTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>      type<span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// è·å–å¯¹è¯å†å²ï¼ˆç”¨äºä¸Šä¸‹æ–‡ï¼‰</span>  <span class="token keyword">const</span> getRecentConversations <span class="token operator">=</span> <span class="token punctuation">(</span>count<span class="token punctuation">:</span> <span class="token keyword">number</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> conversations<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token operator">-</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// æ¸…ç©ºå¯¹è¯</span>  <span class="token keyword">const</span> clearConversations <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    conversations<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token punctuation">{</span>    conversations<span class="token punctuation">,</span>    addConversation<span class="token punctuation">,</span>    getRecentConversations<span class="token punctuation">,</span>    clearConversations<span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3-4-å¯¹è¯å¤„ç†ç¤ºä¾‹"><a href="#3-4-å¯¹è¯å¤„ç†ç¤ºä¾‹" class="headerlink" title="3.4 å¯¹è¯å¤„ç†ç¤ºä¾‹"></a>3.4 å¯¹è¯å¤„ç†ç¤ºä¾‹</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// å¤„ç†ASRè¯†åˆ«ç»“æœ</span><span class="token function">setCallbacks</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  onAsrResult<span class="token punctuation">:</span> async <span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> question <span class="token operator">=</span> result<span class="token punctuation">.</span>text<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// ä¿å­˜é—®é¢˜</span>    viewModule<span class="token punctuation">.</span><span class="token function">setCurrentWeChatQuestion</span><span class="token punctuation">(</span><span class="token punctuation">{</span>      question<span class="token punctuation">,</span>      question_time<span class="token punctuation">:</span> <span class="token function">getCurrentFormattedTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// å‘é€ç»™å¯¹è¯å¼•æ“</span>    <span class="token keyword">const</span> response <span class="token operator">=</span> await <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"/api/chat"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>      method<span class="token punctuation">:</span> <span class="token string">"POST"</span><span class="token punctuation">,</span>      body<span class="token punctuation">:</span> JSON<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>        question<span class="token punctuation">,</span>        context<span class="token punctuation">:</span> <span class="token function">getRecentConversations</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// å¸¦ä¸Šæœ€è¿‘3è½®å¯¹è¯</span>      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> answer <span class="token punctuation">}</span> <span class="token operator">=</span> await response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// ä¿å­˜å¯¹è¯</span>    <span class="token function">addConversation</span><span class="token punctuation">(</span>question<span class="token punctuation">,</span> answer<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// è§¦å‘æ•°å­—äººå›å¤</span>    <span class="token function">triggerDigitalHumanReply</span><span class="token punctuation">(</span>answer<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h3 id="4-æ•°å­—äººæ¸²æŸ“ç³»ç»Ÿ"><a href="#4-æ•°å­—äººæ¸²æŸ“ç³»ç»Ÿ" class="headerlink" title="4. æ•°å­—äººæ¸²æŸ“ç³»ç»Ÿ"></a>4. æ•°å­—äººæ¸²æŸ“ç³»ç»Ÿ</h3><h4 id="4-1-æ•°å­—äººé›†æˆ"><a href="#4-1-æ•°å­—äººé›†æˆ" class="headerlink" title="4.1 æ•°å­—äººé›†æˆ"></a>4.1 æ•°å­—äººé›†æˆ</h4><p>é¡¹ç›®ä½¿ç”¨ <code>@xmov/walle</code> å¼•æ“è¿›è¡Œæ•°å­—äººæ¸²æŸ“ï¼Œæ”¯æŒï¼š</p><ul><li>å®æ—¶è§†é¢‘æµæ¸²æŸ“</li><li>å£å‹åŒæ­¥</li><li>è¡¨æƒ…é©±åŠ¨</li><li>æ‰‹åŠ¿è¯†åˆ«</li></ul><h4 id="4-2-è§†é¢‘æ¸²æŸ“å®ç°"><a href="#4-2-è§†é¢‘æ¸²æŸ“å®ç°" class="headerlink" title="4.2 è§†é¢‘æ¸²æŸ“å®ç°"></a>4.2 è§†é¢‘æ¸²æŸ“å®ç°</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// src/views/home/components/render-walle-video.vue</span><span class="token operator">&lt;</span>template<span class="token operator">></span>  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"walle-video-container"</span><span class="token operator">></span>    <span class="token operator">&lt;</span>canvas      ref<span class="token operator">=</span><span class="token string">"videoCanvas"</span>      <span class="token punctuation">:</span>width<span class="token operator">=</span><span class="token string">"canvasWidth"</span>      <span class="token punctuation">:</span>height<span class="token operator">=</span><span class="token string">"canvasHeight"</span>      <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"walle-canvas"</span>    <span class="token operator">/</span><span class="token operator">></span>  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">></span><span class="token operator">&lt;</span>script setup lang<span class="token operator">=</span><span class="token string">"ts"</span><span class="token operator">></span><span class="token keyword">import</span> <span class="token punctuation">{</span> ref<span class="token punctuation">,</span> onMounted<span class="token punctuation">,</span> onBeforeUnmount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token keyword">import</span> <span class="token punctuation">{</span> usePluggableAsr <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/hooks/usePluggableAsr'</span><span class="token keyword">import</span> <span class="token punctuation">{</span> ProviderType <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/interfaces/IAsrProvider'</span><span class="token keyword">const</span> videoCanvas <span class="token operator">=</span> ref<span class="token operator">&lt;</span>HTMLCanvasElement<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">const</span> canvasWidth <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">640</span><span class="token punctuation">)</span><span class="token keyword">const</span> canvasHeight <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">480</span><span class="token punctuation">)</span><span class="token keyword">const</span> <span class="token punctuation">{</span> init<span class="token punctuation">,</span> startAsr<span class="token punctuation">,</span> destroy <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">usePluggableAsr</span><span class="token punctuation">(</span><span class="token function">ref</span><span class="token punctuation">(</span><span class="token keyword">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token function">onMounted</span><span class="token punctuation">(</span>async <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>videoCanvas<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token keyword">return</span>  <span class="token comment" spellcheck="true">// åˆå§‹åŒ–Walleå¼•æ“</span>  await <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">{</span>    serverUrl<span class="token punctuation">:</span> <span class="token string">'ws://localhost:39999'</span><span class="token punctuation">,</span>    videoCanvas<span class="token punctuation">:</span> videoCanvas<span class="token punctuation">.</span>value<span class="token punctuation">,</span>    renderOptions<span class="token punctuation">:</span> <span class="token punctuation">{</span>      fps<span class="token punctuation">:</span> <span class="token punctuation">{</span>        layout<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        size<span class="token punctuation">:</span> <span class="token number">16</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">// å¯åŠ¨ASR</span>  await <span class="token function">startAsr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token function">onBeforeUnmount</span><span class="token punctuation">(</span>async <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// æ¸…ç†èµ„æº</span>  await <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="4-3-æ•°å­—äººé©±åŠ¨"><a href="#4-3-æ•°å­—äººé©±åŠ¨" class="headerlink" title="4.3 æ•°å­—äººé©±åŠ¨"></a>4.3 æ•°å­—äººé©±åŠ¨</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// è§¦å‘æ•°å­—äººå›å¤</span>async <span class="token keyword">function</span> <span class="token function">triggerDigitalHumanReply</span><span class="token punctuation">(</span>text<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// 1. TTSè¯­éŸ³åˆæˆ</span>  <span class="token keyword">const</span> audioUrl <span class="token operator">=</span> await <span class="token function">synthesizeSpeech</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 2. é©±åŠ¨æ•°å­—äººåŠ¨ç”»</span>  await <span class="token function">driveDigitalHumanAnimation</span><span class="token punctuation">(</span><span class="token punctuation">{</span>    text<span class="token punctuation">,</span>    audio<span class="token punctuation">:</span> audioUrl<span class="token punctuation">,</span>    emotions<span class="token punctuation">:</span> <span class="token function">extractEmotions</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// æå–æƒ…æ„Ÿ</span>    gestures<span class="token punctuation">:</span> <span class="token function">generateGestures</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// ç”Ÿæˆæ‰‹åŠ¿</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 3. æ’­æ”¾éŸ³é¢‘</span>  <span class="token function">playAudio</span><span class="token punctuation">(</span>audioUrl<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h3 id="5-è¯­éŸ³å”¤é†’ç³»ç»Ÿ"><a href="#5-è¯­éŸ³å”¤é†’ç³»ç»Ÿ" class="headerlink" title="5. è¯­éŸ³å”¤é†’ç³»ç»Ÿ"></a>5. è¯­éŸ³å”¤é†’ç³»ç»Ÿ</h3><h4 id="5-1-ç¦»çº¿å”¤é†’å®ç°"><a href="#5-1-ç¦»çº¿å”¤é†’å®ç°" class="headerlink" title="5.1 ç¦»çº¿å”¤é†’å®ç°"></a>5.1 ç¦»çº¿å”¤é†’å®ç°</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// src/modules/loop-worker.ts</span><span class="token keyword">import</span> <span class="token punctuation">{</span> wakeUpWorker <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./wakeUpWorker"</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// å¯åŠ¨å”¤é†’ç›‘å¬</span><span class="token keyword">const</span> startWakeUp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  wakeUpWorker<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">{</span>    onWakeUp<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"æ£€æµ‹åˆ°å”¤é†’è¯"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">// åœæ­¢å”¤é†’ç›‘å¬</span>      wakeUpWorker<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">// å¯åŠ¨ASRè¯†åˆ«</span>      <span class="token function">startAsr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    onError<span class="token punctuation">:</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"å”¤é†’å¤±è´¥:"</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// åœæ­¢å”¤é†’</span><span class="token keyword">const</span> stopWakeUp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  wakeUpWorker<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="5-2-å”¤é†’è¯é…ç½®"><a href="#5-2-å”¤é†’è¯é…ç½®" class="headerlink" title="5.2 å”¤é†’è¯é…ç½®"></a>5.2 å”¤é†’è¯é…ç½®</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// ä½¿ç”¨è®¯é£ç¦»çº¿è¯­éŸ³å”¤é†’SDK</span><span class="token keyword">const</span> wakeUpConfig <span class="token operator">=</span> <span class="token punctuation">{</span>  appId<span class="token punctuation">:</span> <span class="token string">"your_app_id"</span><span class="token punctuation">,</span>  wakeUpWords<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"å°åŠ©æ‰‹"</span><span class="token punctuation">,</span> <span class="token string">"ä½ å¥½æ•°å­—äºº"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  threshold<span class="token punctuation">:</span> <span class="token number">0.6</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// å”¤é†’é˜ˆå€¼</span>  resourcePath<span class="token punctuation">:</span> <span class="token string">"./resources/wakeup"</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// èµ„æºæ–‡ä»¶è·¯å¾„</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h3 id="6-å¤šåª’ä½“å¤„ç†"><a href="#6-å¤šåª’ä½“å¤„ç†" class="headerlink" title="6. å¤šåª’ä½“å¤„ç†"></a>6. å¤šåª’ä½“å¤„ç†</h3><h4 id="6-1-è§†é¢‘æµå¤„ç†"><a href="#6-1-è§†é¢‘æµå¤„ç†" class="headerlink" title="6.1 è§†é¢‘æµå¤„ç†"></a>6.1 è§†é¢‘æµå¤„ç†</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// è®¢é˜…è§†é¢‘å¸§</span><span class="token keyword">this</span><span class="token punctuation">.</span>walleClient<span class="token punctuation">.</span><span class="token function">subject</span><span class="token punctuation">(</span><span class="token string">"videoframe"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span>frameInfo<span class="token punctuation">:</span> <span class="token keyword">any</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> <span class="token punctuation">{</span> frame<span class="token punctuation">,</span> img_w<span class="token punctuation">,</span> img_h<span class="token punctuation">,</span> has_face <span class="token punctuation">}</span> <span class="token operator">=</span> frameInfo<span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>videoCanvas<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> ctx <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>videoCanvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"2d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ctx<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// è®¾ç½®Canvaså°ºå¯¸</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>videoCanvas<span class="token punctuation">.</span>width <span class="token operator">!==</span> img_w<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>videoCanvas<span class="token punctuation">.</span>width <span class="token operator">=</span> img_w<span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>videoCanvas<span class="token punctuation">.</span>height <span class="token operator">=</span> img_h<span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token comment" spellcheck="true">// ç»˜åˆ¶è§†é¢‘å¸§</span>  ctx<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> img_w<span class="token punctuation">,</span> img_h<span class="token punctuation">)</span><span class="token punctuation">;</span>  ctx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>frame<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> img_w<span class="token punctuation">,</span> img_h<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// ç»˜åˆ¶äººè„¸æ¡†ï¼ˆå¯é€‰ï¼‰</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>has_face<span class="token punctuation">)</span> <span class="token punctuation">{</span>    ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">"rgba(0, 255, 0, 0.9)"</span><span class="token punctuation">;</span>    ctx<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>    ctx<span class="token punctuation">.</span><span class="token function">strokeRect</span><span class="token punctuation">(</span>face_x<span class="token punctuation">,</span> face_y<span class="token punctuation">,</span> face_w<span class="token punctuation">,</span> face_h<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token comment" spellcheck="true">// é‡è¦ï¼šé‡Šæ”¾VideoFrame</span>  frame<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="6-2-éŸ³é¢‘æµå¤„ç†"><a href="#6-2-éŸ³é¢‘æµå¤„ç†" class="headerlink" title="6.2 éŸ³é¢‘æµå¤„ç†"></a>6.2 éŸ³é¢‘æµå¤„ç†</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// è®¢é˜…éŸ³é¢‘å¸§</span><span class="token keyword">this</span><span class="token punctuation">.</span>walleClient<span class="token punctuation">.</span><span class="token function">subject</span><span class="token punctuation">(</span><span class="token string">"audioframe"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span>audioData<span class="token punctuation">:</span> <span class="token keyword">any</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// å¯ç”¨äºå®æ—¶éŸ³é¢‘åˆ†æ</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>callbacks<span class="token punctuation">.</span>onAudioFrame<span class="token operator">?</span><span class="token punctuation">.</span><span class="token punctuation">(</span>audioData<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// ä¿å­˜éŸ³é¢‘ï¼ˆå¯é€‰ï¼‰</span>  <span class="token comment" spellcheck="true">// saveAudioChunk(audioData)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="ğŸ”§-é¡¹ç›®é…ç½®"><a href="#ğŸ”§-é¡¹ç›®é…ç½®" class="headerlink" title="ğŸ”§ é¡¹ç›®é…ç½®"></a>ğŸ”§ é¡¹ç›®é…ç½®</h2><h3 id="1-ç¯å¢ƒé…ç½®"><a href="#1-ç¯å¢ƒé…ç½®" class="headerlink" title="1. ç¯å¢ƒé…ç½®"></a>1. ç¯å¢ƒé…ç½®</h3><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// src/config/index.ts</span><span class="token keyword">export</span> <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>  development<span class="token punctuation">:</span> <span class="token punctuation">{</span>    apiBase<span class="token punctuation">:</span> <span class="token string">"http://localhost:8080"</span><span class="token punctuation">,</span>    walleServer<span class="token punctuation">:</span> <span class="token string">"ws://localhost:39999"</span><span class="token punctuation">,</span>    debug<span class="token punctuation">:</span> <span class="token keyword">true</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  test<span class="token punctuation">:</span> <span class="token punctuation">{</span>    apiBase<span class="token punctuation">:</span> <span class="token string">"https://test-api.example.com"</span><span class="token punctuation">,</span>    walleServer<span class="token punctuation">:</span> <span class="token string">"ws://test-server:39999"</span><span class="token punctuation">,</span>    debug<span class="token punctuation">:</span> <span class="token keyword">true</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  production<span class="token punctuation">:</span> <span class="token punctuation">{</span>    apiBase<span class="token punctuation">:</span> <span class="token string">"https://api.example.com"</span><span class="token punctuation">,</span>    walleServer<span class="token punctuation">:</span> <span class="token string">"ws://prod-server:39999"</span><span class="token punctuation">,</span>    debug<span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-ASR-é…ç½®"><a href="#2-ASR-é…ç½®" class="headerlink" title="2. ASR é…ç½®"></a>2. ASR é…ç½®</h3><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// src/config/pluggable-asr.config.ts</span><span class="token keyword">export</span> <span class="token keyword">const</span> pluggableAsrConfig <span class="token operator">=</span> <span class="token punctuation">{</span>  defaultProvider<span class="token punctuation">:</span> ProviderType<span class="token punctuation">.</span>WALLE<span class="token punctuation">,</span>  walle<span class="token punctuation">:</span> <span class="token punctuation">{</span>    serverUrl<span class="token punctuation">:</span> <span class="token string">"ws://localhost:39999"</span><span class="token punctuation">,</span>    connectTimeout<span class="token punctuation">:</span> <span class="token number">8000</span><span class="token punctuation">,</span>    renderOptions<span class="token punctuation">:</span> <span class="token punctuation">{</span>      fps<span class="token punctuation">:</span> <span class="token punctuation">{</span>        layout<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        size<span class="token punctuation">:</span> <span class="token number">16</span><span class="token punctuation">,</span>      <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  tencent<span class="token punctuation">:</span> <span class="token punctuation">{</span>    secretId<span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>TENCENT_SECRET_ID<span class="token punctuation">,</span>    secretKey<span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>TENCENT_SECRET_KEY<span class="token punctuation">,</span>    appId<span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>TENCENT_APP_ID<span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-äººè„¸è¯†åˆ«é…ç½®"><a href="#3-äººè„¸è¯†åˆ«é…ç½®" class="headerlink" title="3. äººè„¸è¯†åˆ«é…ç½®"></a>3. äººè„¸è¯†åˆ«é…ç½®</h3><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// äººè„¸è¯†åˆ«å‚æ•°</span><span class="token keyword">const</span> faceConfig <span class="token operator">=</span> <span class="token punctuation">{</span>  detectInterval<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// æ£€æµ‹é—´éš”ï¼ˆ0è¡¨ç¤ºæ¯å¸§æ£€æµ‹ï¼‰</span>  hasFaceTotal<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// è¿ç»­æ£€æµ‹åˆ°å‡ æ¬¡è®¤ä¸ºæœ‰äººè„¸</span>  noFaceTotal<span class="token punctuation">:</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// è¿ç»­æœªæ£€æµ‹åˆ°å‡ æ¬¡è®¤ä¸ºæ— äººè„¸</span>  confidence<span class="token punctuation">:</span> <span class="token number">0.8</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// ç½®ä¿¡åº¦é˜ˆå€¼</span>  minFaceSize<span class="token punctuation">:</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// æœ€å°äººè„¸å°ºå¯¸</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="ğŸš€-éƒ¨ç½²å®è·µ"><a href="#ğŸš€-éƒ¨ç½²å®è·µ" class="headerlink" title="ğŸš€ éƒ¨ç½²å®è·µ"></a>ğŸš€ éƒ¨ç½²å®è·µ</h2><h3 id="1-å¼€å‘ç¯å¢ƒæ­å»º"><a href="#1-å¼€å‘ç¯å¢ƒæ­å»º" class="headerlink" title="1. å¼€å‘ç¯å¢ƒæ­å»º"></a>1. å¼€å‘ç¯å¢ƒæ­å»º</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># å®‰è£…ä¾èµ–</span>yarn <span class="token function">install</span><span class="token comment" spellcheck="true"># å¯åŠ¨å¼€å‘æœåŠ¡å™¨</span>yarn dev<span class="token comment" spellcheck="true"># æ„å»ºæµ‹è¯•ç‰ˆæœ¬</span>yarn electron-build-test<span class="token comment" spellcheck="true"># æ„å»ºç”Ÿäº§ç‰ˆæœ¬</span>yarn electron-build-production<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²"><a href="#2-ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²" class="headerlink" title="2. ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²"></a>2. ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²</h3><p><strong>Windows éƒ¨ç½²ï¼š</strong></p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># æ„å»ºWindowså®‰è£…åŒ…</span>yarn electron-build-production<span class="token comment" spellcheck="true"># ç”Ÿæˆæ–‡ä»¶</span>dist_electron/â”œâ”€â”€ AIè™šæ‹Ÿäººæ™ºæ…§å¤§å±-ç”Ÿäº§-installer.exe  <span class="token comment" spellcheck="true"># å®‰è£…åŒ…</span>â””â”€â”€ AIè™šæ‹Ÿäººæ™ºæ…§å¤§å±-ç”Ÿäº§-2.0.0-win.zip  <span class="token comment" spellcheck="true"># å‹ç¼©åŒ…</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>éƒ¨ç½²æ­¥éª¤ï¼š</strong></p><ol><li>å°†å®‰è£…åŒ…éƒ¨ç½²åˆ°ç›®æ ‡æœºå™¨</li><li>å®‰è£…å¹¶é…ç½®æœ¬åœ°æœåŠ¡</li><li>é…ç½® Walle æœåŠ¡å™¨åœ°å€</li><li>æµ‹è¯•å„åŠŸèƒ½æ¨¡å—</li></ol><h3 id="3-ç¡¬ä»¶è¦æ±‚"><a href="#3-ç¡¬ä»¶è¦æ±‚" class="headerlink" title="3. ç¡¬ä»¶è¦æ±‚"></a>3. ç¡¬ä»¶è¦æ±‚</h3><ul><li><strong>CPU</strong>: Intel i5 åŠä»¥ä¸Š</li><li><strong>å†…å­˜</strong>: 8GB åŠä»¥ä¸Š</li><li><strong>æ˜¾å¡</strong>: æ”¯æŒç¡¬ä»¶åŠ é€Ÿï¼ˆå¯é€‰ï¼‰</li><li><strong>ç½‘ç»œ</strong>: ç¨³å®šçš„ç½‘ç»œè¿æ¥</li><li><strong>æ‘„åƒå¤´</strong>: 720p åŠä»¥ä¸Š</li><li><strong>éº¦å…‹é£</strong>: æ”¯æŒé˜µåˆ—éº¦å…‹é£ï¼ˆæ¨èï¼‰</li></ul><hr><h2 id="ğŸ“Š-æ€§èƒ½ä¼˜åŒ–"><a href="#ğŸ“Š-æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="ğŸ“Š æ€§èƒ½ä¼˜åŒ–"></a>ğŸ“Š æ€§èƒ½ä¼˜åŒ–</h2><h3 id="1-å†…å­˜ä¼˜åŒ–"><a href="#1-å†…å­˜ä¼˜åŒ–" class="headerlink" title="1. å†…å­˜ä¼˜åŒ–"></a>1. å†…å­˜ä¼˜åŒ–</h3><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// åŠæ—¶é‡Šæ”¾VideoFrame</span>frame<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// æ¸…ç†å®šæ—¶å™¨</span><span class="token function">onBeforeUnmount</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">clearInterval</span><span class="token punctuation">(</span>interval<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// é™åˆ¶å¯¹è¯å†å²æ•°é‡</span><span class="token keyword">const</span> maxConversations <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>conversations<span class="token punctuation">.</span>value<span class="token punctuation">.</span>length <span class="token operator">></span> maxConversations<span class="token punctuation">)</span> <span class="token punctuation">{</span>  conversations<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-ç½‘ç»œä¼˜åŒ–"><a href="#2-ç½‘ç»œä¼˜åŒ–" class="headerlink" title="2. ç½‘ç»œä¼˜åŒ–"></a>2. ç½‘ç»œä¼˜åŒ–</h3><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// WebSocketé‡è¿æœºåˆ¶</span><span class="token keyword">let</span> reconnectAttempts <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">const</span> maxReconnectAttempts <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">reconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>reconnectAttempts <span class="token operator">&lt;</span> maxReconnectAttempts<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>      reconnectAttempts<span class="token operator">++</span><span class="token punctuation">;</span>      <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span> <span class="token operator">*</span> reconnectAttempts<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-æ¸²æŸ“ä¼˜åŒ–"><a href="#3-æ¸²æŸ“ä¼˜åŒ–" class="headerlink" title="3. æ¸²æŸ“ä¼˜åŒ–"></a>3. æ¸²æŸ“ä¼˜åŒ–</h3><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// é™åˆ¶å¸§ç‡</span><span class="token keyword">let</span> lastFrameTime <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">const</span> targetFPS <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span><span class="token keyword">const</span> frameInterval <span class="token operator">=</span> <span class="token number">1000</span> <span class="token operator">/</span> targetFPS<span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">renderFrame</span><span class="token punctuation">(</span>frameInfo<span class="token punctuation">:</span> <span class="token keyword">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> now <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>now <span class="token operator">-</span> lastFrameTime <span class="token operator">&lt;</span> frameInterval<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// è·³è¿‡æ­¤å¸§</span>  <span class="token punctuation">}</span>  lastFrameTime <span class="token operator">=</span> now<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// æ¸²æŸ“é€»è¾‘</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="ğŸ§ª-æµ‹è¯•ç­–ç•¥"><a href="#ğŸ§ª-æµ‹è¯•ç­–ç•¥" class="headerlink" title="ğŸ§ª æµ‹è¯•ç­–ç•¥"></a>ğŸ§ª æµ‹è¯•ç­–ç•¥</h2><h3 id="1-å•å…ƒæµ‹è¯•"><a href="#1-å•å…ƒæµ‹è¯•" class="headerlink" title="1. å•å…ƒæµ‹è¯•"></a>1. å•å…ƒæµ‹è¯•</h3><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// tests/providers/WalleProvider.test.ts</span><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">"WalleProvider"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">"åº”è¯¥æ­£ç¡®åˆå§‹åŒ–"</span><span class="token punctuation">,</span> async <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> provider <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WalleProvider</span><span class="token punctuation">(</span><span class="token function">ref</span><span class="token punctuation">(</span><span class="token keyword">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    await provider<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">{</span>      serverUrl<span class="token punctuation">:</span> <span class="token string">"ws://localhost:39999"</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">expect</span><span class="token punctuation">(</span>provider<span class="token punctuation">.</span>asrState<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>AsrState<span class="token punctuation">.</span>INITED<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">"åº”è¯¥æ­£ç¡®è¯†åˆ«è¯­éŸ³"</span><span class="token punctuation">,</span> async <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> provider <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WalleProvider</span><span class="token punctuation">(</span><span class="token function">ref</span><span class="token punctuation">(</span><span class="token keyword">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    await provider<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>    await provider<span class="token punctuation">.</span><span class="token function">startAsr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// æ¨¡æ‹ŸASRç»“æœ</span>    provider<span class="token punctuation">.</span>walleClient<span class="token punctuation">.</span><span class="token function">subject</span><span class="token punctuation">(</span><span class="token string">"asrResult"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">{</span>      text<span class="token punctuation">:</span> <span class="token string">"ä½ å¥½"</span><span class="token punctuation">,</span>      final<span class="token punctuation">:</span> <span class="token keyword">true</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">expect</span><span class="token punctuation">(</span>provider<span class="token punctuation">.</span>asrText<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token string">"ä½ å¥½"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-é›†æˆæµ‹è¯•"><a href="#2-é›†æˆæµ‹è¯•" class="headerlink" title="2. é›†æˆæµ‹è¯•"></a>2. é›†æˆæµ‹è¯•</h3><ul><li>æµ‹è¯•å®Œæ•´å¯¹è¯æµç¨‹</li><li>æµ‹è¯•äººè„¸è¯†åˆ«å‡†ç¡®æ€§</li><li>æµ‹è¯•å¤šè½®å¯¹è¯ä¸Šä¸‹æ–‡</li><li>æµ‹è¯•å¼‚å¸¸æƒ…å†µå¤„ç†</li></ul><h3 id="3-æ€§èƒ½æµ‹è¯•"><a href="#3-æ€§èƒ½æµ‹è¯•" class="headerlink" title="3. æ€§èƒ½æµ‹è¯•"></a>3. æ€§èƒ½æµ‹è¯•</h3><ul><li>ASR è¯†åˆ«å»¶è¿Ÿæµ‹è¯•</li><li>å†…å­˜æ³„æ¼æ£€æµ‹</li><li>CPU ä½¿ç”¨ç‡ç›‘æ§</li><li>ç½‘ç»œå»¶è¿Ÿæµ‹è¯•</li></ul><hr><h2 id="ğŸ”-é—®é¢˜æ’æŸ¥"><a href="#ğŸ”-é—®é¢˜æ’æŸ¥" class="headerlink" title="ğŸ” é—®é¢˜æ’æŸ¥"></a>ğŸ” é—®é¢˜æ’æŸ¥</h2><h3 id="1-ASR-è¯†åˆ«å¤±è´¥"><a href="#1-ASR-è¯†åˆ«å¤±è´¥" class="headerlink" title="1. ASR è¯†åˆ«å¤±è´¥"></a>1. ASR è¯†åˆ«å¤±è´¥</h3><p><strong>é—®é¢˜</strong>ï¼šæ— æ³•è¯†åˆ«è¯­éŸ³</p><p><strong>æ’æŸ¥æ­¥éª¤ï¼š</strong></p><ol><li>æ£€æŸ¥éº¦å…‹é£æƒé™</li><li>æ£€æŸ¥ç½‘ç»œè¿æ¥</li><li>æŸ¥çœ‹æ§åˆ¶å°é”™è¯¯æ—¥å¿—</li><li>éªŒè¯ Walle æœåŠ¡å™¨çŠ¶æ€</li></ol><h3 id="2-äººè„¸è¯†åˆ«ä¸å‡†ç¡®"><a href="#2-äººè„¸è¯†åˆ«ä¸å‡†ç¡®" class="headerlink" title="2. äººè„¸è¯†åˆ«ä¸å‡†ç¡®"></a>2. äººè„¸è¯†åˆ«ä¸å‡†ç¡®</h3><p><strong>é—®é¢˜</strong>ï¼šäººè„¸æ£€æµ‹è¯¯åˆ¤</p><p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p><ul><li>è°ƒæ•´æ£€æµ‹é˜ˆå€¼</li><li>ä¼˜åŒ–å…‰çº¿æ¡ä»¶</li><li>è°ƒæ•´æ‘„åƒå¤´ä½ç½®</li><li>æ›´æ–°æ£€æµ‹æ¨¡å‹</li></ul><h3 id="3-è§†é¢‘æ¸²æŸ“å¡é¡¿"><a href="#3-è§†é¢‘æ¸²æŸ“å¡é¡¿" class="headerlink" title="3. è§†é¢‘æ¸²æŸ“å¡é¡¿"></a>3. è§†é¢‘æ¸²æŸ“å¡é¡¿</h3><p><strong>é—®é¢˜</strong>ï¼šè§†é¢‘å¸§ç‡ä½</p><p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p><ul><li>å¯ç”¨ç¡¬ä»¶åŠ é€Ÿ</li><li>é™ä½è§†é¢‘åˆ†è¾¨ç‡</li><li>ä¼˜åŒ–æ¸²æŸ“é€»è¾‘</li><li>æ£€æŸ¥ CPU ä½¿ç”¨ç‡</li></ul><hr><h2 id="ğŸ“š-æœ€ä½³å®è·µ"><a href="#ğŸ“š-æœ€ä½³å®è·µ" class="headerlink" title="ğŸ“š æœ€ä½³å®è·µ"></a>ğŸ“š æœ€ä½³å®è·µ</h2><h3 id="1-ä»£ç ç»„ç»‡"><a href="#1-ä»£ç ç»„ç»‡" class="headerlink" title="1. ä»£ç ç»„ç»‡"></a>1. ä»£ç ç»„ç»‡</h3><ul><li>ä½¿ç”¨ Composition API ç»„ç»‡é€»è¾‘</li><li>æŠ½ç¦»å¯å¤ç”¨çš„ Hooks</li><li>ç»Ÿä¸€é”™è¯¯å¤„ç†</li><li>å®Œå–„çš„ç±»å‹å®šä¹‰</li></ul><h3 id="2-æ€§èƒ½ä¼˜åŒ–"><a href="#2-æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="2. æ€§èƒ½ä¼˜åŒ–"></a>2. æ€§èƒ½ä¼˜åŒ–</h3><ul><li>åŠæ—¶é‡Šæ”¾èµ„æº</li><li>åˆç†ä½¿ç”¨é˜²æŠ–å’ŒèŠ‚æµ</li><li>é¿å…ä¸å¿…è¦çš„å“åº”å¼æ•°æ®</li><li>ä¼˜åŒ–æ¸²æŸ“æ€§èƒ½</li></ul><h3 id="3-ç”¨æˆ·ä½“éªŒ"><a href="#3-ç”¨æˆ·ä½“éªŒ" class="headerlink" title="3. ç”¨æˆ·ä½“éªŒ"></a>3. ç”¨æˆ·ä½“éªŒ</h3><ul><li>æµç•…çš„äº¤äº’åé¦ˆ</li><li>æ¸…æ™°çš„é”™è¯¯æç¤º</li><li>ä¼˜é›…çš„åŠ è½½çŠ¶æ€</li><li>å®Œå–„çš„åŠŸèƒ½å¼•å¯¼</li></ul><hr><h2 id="ğŸ”—-ç›¸å…³èµ„æº"><a href="#ğŸ”—-ç›¸å…³èµ„æº" class="headerlink" title="ğŸ”— ç›¸å…³èµ„æº"></a>ğŸ”— ç›¸å…³èµ„æº</h2><ul><li><a href="./AIå®æˆ˜é¡¹ç›®æ–‡æ¡£.md">AI å®æˆ˜é¡¹ç›®æ–‡æ¡£</a></li><li><a href="./electronæŠ€æœ¯å®è·µæ–‡æ¡£.md">Electron æŠ€æœ¯å®è·µæ–‡æ¡£</a></li></ul><hr><h2 id="ğŸ“-æ€»ç»“"><a href="#ğŸ“-æ€»ç»“" class="headerlink" title="ğŸ“ æ€»ç»“"></a>ğŸ“ æ€»ç»“</h2><p>æœ¬é¡¹ç›®æˆåŠŸå®ç°äº†ï¼š</p><ul><li>âœ… <strong>å®Œæ•´çš„æ•°å­—äººç³»ç»Ÿ</strong>ï¼šä»è¯­éŸ³è¾“å…¥åˆ°æ•°å­—äººå›å¤çš„å®Œæ•´é—­ç¯</li><li>âœ… <strong>å¯æ’æ‹”æ¶æ„</strong>ï¼šæ”¯æŒå¤šç§ AI å¼•æ“åŠ¨æ€åˆ‡æ¢</li><li>âœ… <strong>é«˜æ€§èƒ½æ¸²æŸ“</strong>ï¼šä¼˜åŒ–çš„è§†é¢‘å’ŒéŸ³é¢‘å¤„ç†</li><li>âœ… <strong>å®Œå–„çš„é”™è¯¯å¤„ç†</strong>ï¼šå¥å£®çš„é”™è¯¯æ¢å¤æœºåˆ¶</li><li>âœ… <strong>è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒ</strong>ï¼šæµç•…çš„äº¤äº’å’Œæ¸…æ™°çš„åé¦ˆ</li></ul><p>é€šè¿‡æœ¬é¡¹ç›®çš„å®è·µï¼Œå±•ç¤ºäº†å¦‚ä½•å°†å¤šç§ AI æŠ€æœ¯æœ‰æœºèåˆï¼Œæ„å»ºä¸€ä¸ªå®Œæ•´çš„ã€å¯è½åœ°çš„ AI æ•°å­—äººäº¤äº’ç³»ç»Ÿã€‚</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> AIé¡¹ç›®è½åœ°å®è·µ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue3 </tag>
            
            <tag> Electron </tag>
            
            <tag> è¯­éŸ³è¯†åˆ« </tag>
            
            <tag> äººè„¸è¯†åˆ« </tag>
            
            <tag> AIæ•°å­—äºº </tag>
            
            <tag> é¡¹ç›®è½åœ° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue2 + Vue3 æ··åˆé¡¹ç›® Monorepo å·¥å…·é€‰æ‹©æŒ‡å—</title>
      <link href="/2025/01/15/monorepo-tools-guide/"/>
      <url>/2025/01/15/monorepo-tools-guide/</url>
      
        <content type="html"><![CDATA[<h1 id="Vue2-Vue3-æ··åˆé¡¹ç›®-Monorepo-å·¥å…·é€‰æ‹©æŒ‡å—"><a href="#Vue2-Vue3-æ··åˆé¡¹ç›®-Monorepo-å·¥å…·é€‰æ‹©æŒ‡å—" class="headerlink" title="Vue2 + Vue3 æ··åˆé¡¹ç›® Monorepo å·¥å…·é€‰æ‹©æŒ‡å—"></a>Vue2 + Vue3 æ··åˆé¡¹ç›® Monorepo å·¥å…·é€‰æ‹©æŒ‡å—</h1><h2 id="åœºæ™¯åˆ†æ"><a href="#åœºæ™¯åˆ†æ" class="headerlink" title="åœºæ™¯åˆ†æ"></a>åœºæ™¯åˆ†æ</h2><p>å½“ä½ çš„é¡¹ç›®åŒ…å«ä»¥ä¸‹éœ€æ±‚æ—¶ï¼Œéœ€è¦é€‰æ‹©åˆé€‚çš„ Monorepo å·¥å…·ï¼š</p><ul><li>âœ… <strong>Vue2 é¡¹ç›®</strong>ï¼ˆæ—§ç³»ç»Ÿï¼Œéœ€è¦ç»´æŠ¤ï¼‰</li><li>âœ… <strong>Vue3 é¡¹ç›®</strong>ï¼ˆæ–°ç³»ç»Ÿï¼Œæ­£åœ¨å¼€å‘ï¼‰</li><li>âœ… <strong>å¤šä¸ªå­é¡¹ç›®</strong>ï¼ˆç®¡ç†åå°ã€ç”¨æˆ·ç«¯ã€ç§»åŠ¨ç«¯ç­‰ï¼‰</li><li>âœ… <strong>å…±äº«ç»„ä»¶åº“</strong>ï¼ˆéœ€è¦åœ¨å¤šä¸ªé¡¹ç›®é—´å¤ç”¨ï¼‰</li></ul><p>è¿™ç§æ··åˆåœºæ™¯çš„æ ¸å¿ƒæŒ‘æˆ˜æ˜¯ï¼š<strong>ä¸åŒç‰ˆæœ¬çš„ Vue éœ€è¦å…±å­˜ï¼Œä¸”ä¾èµ–ç®¡ç†è¦æ¸…æ™°é«˜æ•ˆ</strong>ã€‚</p><h2 id="å·¥å…·å¯¹æ¯”ï¼šè°æœ€é€‚åˆä½ çš„åœºæ™¯ï¼Ÿ"><a href="#å·¥å…·å¯¹æ¯”ï¼šè°æœ€é€‚åˆä½ çš„åœºæ™¯ï¼Ÿ" class="headerlink" title="å·¥å…·å¯¹æ¯”ï¼šè°æœ€é€‚åˆä½ çš„åœºæ™¯ï¼Ÿ"></a>å·¥å…·å¯¹æ¯”ï¼šè°æœ€é€‚åˆä½ çš„åœºæ™¯ï¼Ÿ</h2><h3 id="å¿«é€Ÿç»“è®º"><a href="#å¿«é€Ÿç»“è®º" class="headerlink" title="å¿«é€Ÿç»“è®º"></a>å¿«é€Ÿç»“è®º</h3><p><strong>æ¨èæ–¹æ¡ˆï¼špnpm workspace + Turborepo</strong></p><table><thead><tr><th>å·¥å…·</th><th>é€‚ç”¨åœºæ™¯</th><th>Vue2+Vue3 æ”¯æŒ</th><th>æ€§èƒ½</th><th>é…ç½®å¤æ‚åº¦</th><th>æ¨èåº¦</th></tr></thead><tbody><tr><td><strong>pnpm workspace</strong></td><td>ä¸­å°å‹é¡¹ç›®ï¼Œä¾èµ–ç®¡ç†</td><td>â­â­â­â­â­</td><td>â­â­â­â­â­</td><td>â­â­â­â­</td><td>â­â­â­â­â­</td></tr><tr><td><strong>yarn workspace</strong></td><td>å¤§å‹é¡¹ç›®ï¼Œéœ€è¦å¤æ‚ä¾èµ–è§£æ</td><td>â­â­â­â­</td><td>â­â­â­</td><td>â­â­â­</td><td>â­â­â­â­</td></tr><tr><td><strong>npm workspace</strong></td><td>ç®€å•é¡¹ç›®ï¼ŒåŸç”Ÿæ”¯æŒ</td><td>â­â­â­</td><td>â­â­</td><td>â­â­â­â­â­</td><td>â­â­â­</td></tr><tr><td><strong>Turborepo</strong></td><td>æ„å»ºåŠ é€Ÿï¼Œä»»åŠ¡ç¼–æ’</td><td>â­â­â­â­â­</td><td>â­â­â­â­â­</td><td>â­â­â­</td><td>â­â­â­â­â­</td></tr><tr><td><strong>Nx</strong></td><td>ä¼ä¸šçº§ï¼Œéœ€è¦å®Œæ•´å·¥å…·é“¾</td><td>â­â­â­â­</td><td>â­â­â­â­</td><td>â­â­</td><td>â­â­â­</td></tr><tr><td><strong>Lerna</strong></td><td>ä¼ ç»Ÿ Monorepoï¼Œå‘å¸ƒåŒ…</td><td>â­â­â­</td><td>â­â­â­</td><td>â­â­â­</td><td>â­â­</td></tr></tbody></table><h3 id="è¯¦ç»†å¯¹æ¯”"><a href="#è¯¦ç»†å¯¹æ¯”" class="headerlink" title="è¯¦ç»†å¯¹æ¯”"></a>è¯¦ç»†å¯¹æ¯”</h3><h4 id="1-pnpm-workspaceï¼ˆâ­-æœ€æ¨èï¼‰"><a href="#1-pnpm-workspaceï¼ˆâ­-æœ€æ¨èï¼‰" class="headerlink" title="1. pnpm workspaceï¼ˆâ­ æœ€æ¨èï¼‰"></a>1. pnpm workspaceï¼ˆâ­ æœ€æ¨èï¼‰</h4><p><strong>ä¼˜åŠ¿ï¼š</strong></p><ul><li>âœ… <strong>å®Œç¾æ”¯æŒä¸åŒç‰ˆæœ¬ä¾èµ–å…±å­˜</strong>ï¼šVue2 å’Œ Vue3 å¯ä»¥åŒæ—¶å®‰è£…åœ¨ä¸åŒå­é¡¹ç›®ä¸­</li><li>âœ… <strong>ç£ç›˜ç©ºé—´èŠ‚çœ 70%+</strong>ï¼šé€šè¿‡ç¡¬é“¾æ¥å’Œç¬¦å·é“¾æ¥å…±äº«ä¾èµ–</li><li>âœ… <strong>å®‰è£…é€Ÿåº¦å¿«</strong>ï¼šæ¯” npm/yarn å¿« 2-3 å€</li><li>âœ… <strong>ä¸¥æ ¼çš„ä¾èµ–éš”ç¦»</strong>ï¼šé¿å…å¹½çµä¾èµ–é—®é¢˜</li><li>âœ… <strong>é…ç½®ç®€å•</strong>ï¼šåªéœ€ä¸€ä¸ª <code>pnpm-workspace.yaml</code> æ–‡ä»¶</li><li>âœ… <strong>å¯¹ Vue ç”Ÿæ€æ”¯æŒå¥½</strong>ï¼šViteã€Vue CLI éƒ½èƒ½å®Œç¾é…åˆ</li></ul><p><strong>åŠ£åŠ¿ï¼š</strong></p><ul><li>âš ï¸ éœ€è¦å•ç‹¬å®‰è£… pnpmï¼ˆä½†å®‰è£…å¾ˆç®€å•ï¼‰</li><li>âš ï¸ æŸäº›è€æ—§å·¥å…·å¯èƒ½ä¸å…¼å®¹ï¼ˆä½† Vue ç”Ÿæ€æ²¡é—®é¢˜ï¼‰</li></ul><p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong> Vue2 + Vue3 æ··åˆé¡¹ç›®çš„æœ€ä½³é€‰æ‹©</p><hr><h4 id="2-yarn-workspace"><a href="#2-yarn-workspace" class="headerlink" title="2. yarn workspace"></a>2. yarn workspace</h4><p><strong>ä¼˜åŠ¿ï¼š</strong></p><ul><li>âœ… åŠŸèƒ½ä¸°å¯Œï¼Œæ”¯æŒå¤æ‚çš„ä¾èµ–è§£æ</li><li>âœ… æœ‰ <code>yarn workspaces</code> å’Œ <code>yarn berry</code> ä¸¤ä¸ªç‰ˆæœ¬å¯é€‰</li><li>âœ… å¯¹å¤§å‹é¡¹ç›®æ”¯æŒå¥½</li></ul><p><strong>åŠ£åŠ¿ï¼š</strong></p><ul><li>âš ï¸ ä¸åŒç‰ˆæœ¬ Vue å…±å­˜éœ€è¦é¢å¤–é…ç½®</li><li>âš ï¸ å®‰è£…é€Ÿåº¦ä¸å¦‚ pnpm</li><li>âš ï¸ ç£ç›˜å ç”¨è¾ƒå¤§</li><li>âš ï¸ yarn berry é…ç½®ç›¸å¯¹å¤æ‚</li></ul><p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong> å·²ç»åœ¨ä½¿ç”¨ yarn çš„å¤§å‹å›¢é˜Ÿ</p><hr><h4 id="3-npm-workspace"><a href="#3-npm-workspace" class="headerlink" title="3. npm workspace"></a>3. npm workspace</h4><p><strong>ä¼˜åŠ¿ï¼š</strong></p><ul><li>âœ… åŸç”Ÿæ”¯æŒï¼Œæ— éœ€é¢å¤–å®‰è£…</li><li>âœ… é…ç½®æœ€ç®€å•</li></ul><p><strong>åŠ£åŠ¿ï¼š</strong></p><ul><li>âš ï¸ åŠŸèƒ½ç›¸å¯¹ç®€å•</li><li>âš ï¸ æ€§èƒ½ä¸€èˆ¬</li><li>âš ï¸ ä¸åŒç‰ˆæœ¬ä¾èµ–ç®¡ç†ä¸å¤Ÿçµæ´»</li><li>âš ï¸ ç£ç›˜å ç”¨å¤§</li></ul><p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong> ç®€å•é¡¹ç›®ï¼Œä¸æƒ³å¼•å…¥æ–°å·¥å…·</p><hr><h4 id="4-Turborepoï¼ˆæ„å»ºåŠ é€Ÿå·¥å…·ï¼‰"><a href="#4-Turborepoï¼ˆæ„å»ºåŠ é€Ÿå·¥å…·ï¼‰" class="headerlink" title="4. Turborepoï¼ˆæ„å»ºåŠ é€Ÿå·¥å…·ï¼‰"></a>4. Turborepoï¼ˆæ„å»ºåŠ é€Ÿå·¥å…·ï¼‰</h4><p><strong>ä¼˜åŠ¿ï¼š</strong></p><ul><li>âœ… <strong>æ„å»ºç¼“å­˜</strong>ï¼šæ™ºèƒ½ç¼“å­˜ï¼Œé‡å¤æ„å»ºç§’çº§å®Œæˆ</li><li>âœ… <strong>ä»»åŠ¡ç¼–æ’</strong>ï¼šå¹¶è¡Œæ‰§è¡Œï¼Œä¾èµ–å…³ç³»è‡ªåŠ¨å¤„ç†</li><li>âœ… <strong>è¿œç¨‹ç¼“å­˜</strong>ï¼šå›¢é˜Ÿå…±äº«æ„å»ºç¼“å­˜</li><li>âœ… <strong>ä¸ pnpm/yarn å®Œç¾é…åˆ</strong>ï¼šä¸å†²çªï¼Œäº’è¡¥å…³ç³»</li></ul><p><strong>åŠ£åŠ¿ï¼š</strong></p><ul><li>âš ï¸ éœ€è¦é¢å¤–å­¦ä¹ æˆæœ¬</li><li>âš ï¸ é…ç½®ç›¸å¯¹å¤æ‚</li></ul><p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong> éœ€è¦é¢‘ç¹æ„å»ºã€å¤šé¡¹ç›®åä½œçš„å›¢é˜Ÿ</p><hr><h4 id="5-Nx"><a href="#5-Nx" class="headerlink" title="5. Nx"></a>5. Nx</h4><p><strong>ä¼˜åŠ¿ï¼š</strong></p><ul><li>âœ… åŠŸèƒ½æœ€å…¨é¢ï¼ˆä»£ç ç”Ÿæˆã€ä¾èµ–å›¾ã€æµ‹è¯•ç­‰ï¼‰</li><li>âœ… é€‚åˆä¼ä¸šçº§é¡¹ç›®</li><li>âœ… æœ‰å¯è§†åŒ–å·¥å…·</li></ul><p><strong>åŠ£åŠ¿ï¼š</strong></p><ul><li>âš ï¸ å­¦ä¹ æ›²çº¿é™¡å³­</li><li>âš ï¸ é…ç½®å¤æ‚</li><li>âš ï¸ å¯¹å°å‹é¡¹ç›®æ¥è¯´å¤ªé‡</li></ul><p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong> å¤§å‹ä¼ä¸šé¡¹ç›®ï¼Œéœ€è¦å®Œæ•´å·¥å…·é“¾</p><hr><h4 id="6-Lerna"><a href="#6-Lerna" class="headerlink" title="6. Lerna"></a>6. Lerna</h4><p><strong>ä¼˜åŠ¿ï¼š</strong></p><ul><li>âœ… ä¼ ç»Ÿ Monorepo å·¥å…·ï¼Œç”Ÿæ€æˆç†Ÿ</li><li>âœ… å‘å¸ƒ npm åŒ…æ–¹ä¾¿</li></ul><p><strong>åŠ£åŠ¿ï¼š</strong></p><ul><li>âš ï¸ ç°åœ¨å¤šé…åˆ pnpm/yarn ä½¿ç”¨</li><li>âš ï¸ å•ç‹¬ä½¿ç”¨åŠŸèƒ½æœ‰é™</li><li>âš ï¸ æ€§èƒ½ä¸€èˆ¬</li></ul><p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong> éœ€è¦å‘å¸ƒå¤šä¸ª npm åŒ…çš„é¡¹ç›®</p><hr><h2 id="æ¨èæ–¹æ¡ˆï¼špnpm-workspace-Turborepo"><a href="#æ¨èæ–¹æ¡ˆï¼špnpm-workspace-Turborepo" class="headerlink" title="æ¨èæ–¹æ¡ˆï¼špnpm workspace + Turborepo"></a>æ¨èæ–¹æ¡ˆï¼špnpm workspace + Turborepo</h2><h3 id="ä¸ºä»€ä¹ˆé€‰æ‹©è¿™ä¸ªç»„åˆï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆé€‰æ‹©è¿™ä¸ªç»„åˆï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆé€‰æ‹©è¿™ä¸ªç»„åˆï¼Ÿ"></a>ä¸ºä»€ä¹ˆé€‰æ‹©è¿™ä¸ªç»„åˆï¼Ÿ</h3><ol><li><p><strong>pnpm workspace</strong> è§£å†³ä¾èµ–ç®¡ç†é—®é¢˜</p><ul><li>Vue2 å’Œ Vue3 å¯ä»¥å®Œç¾å…±å­˜</li><li>èŠ‚çœç£ç›˜ç©ºé—´å’Œå®‰è£…æ—¶é—´</li><li>é…ç½®ç®€å•ï¼Œä¸Šæ‰‹å¿«</li></ul></li><li><p><strong>Turborepo</strong> è§£å†³æ„å»ºæ•ˆç‡é—®é¢˜</p><ul><li>æ™ºèƒ½ç¼“å­˜ï¼Œæ„å»ºé€Ÿåº¦æå‡ 10 å€+</li><li>ä»»åŠ¡ç¼–æ’ï¼Œå¤šé¡¹ç›®å¹¶è¡Œæ„å»º</li><li>è¿œç¨‹ç¼“å­˜ï¼Œå›¢é˜Ÿåä½œæ›´é«˜æ•ˆ</li></ul></li><li><p><strong>ä¸¤è€…äº’è¡¥ï¼Œä¸å†²çª</strong></p><ul><li>pnpm è´Ÿè´£ä¾èµ–ç®¡ç†</li><li>Turborepo è´Ÿè´£æ„å»ºåŠ é€Ÿ</li><li>å¯ä»¥å•ç‹¬ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ç»„åˆä½¿ç”¨</li></ul></li></ol><p><strong>å‚è€ƒèµ„æºï¼š</strong></p><ul><li>ğŸ“– <a href="https://turborepo-zh.vercel.app/getting-started/create-new.html">Turborepo ä¸­æ–‡æ–‡æ¡£</a> - å®Œæ•´çš„ Turborepo ä½¿ç”¨æŒ‡å—</li><li>ğŸš€ <a href="https://github.com/vercel/turborepo/tree/main/examples/basic">pnpm workspace + Turborepo å¯åŠ¨èµ„æºåº“</a> - å¯ç›´æ¥ä½¿ç”¨çš„é¡¹ç›®æ¨¡æ¿</li></ul><hr><h2 id="å®Œæ•´é¡¹ç›®ç»“æ„æ¨¡æ¿"><a href="#å®Œæ•´é¡¹ç›®ç»“æ„æ¨¡æ¿" class="headerlink" title="å®Œæ•´é¡¹ç›®ç»“æ„æ¨¡æ¿"></a>å®Œæ•´é¡¹ç›®ç»“æ„æ¨¡æ¿</h2><h3 id="ç›®å½•ç»“æ„"><a href="#ç›®å½•ç»“æ„" class="headerlink" title="ç›®å½•ç»“æ„"></a>ç›®å½•ç»“æ„</h3><pre><code>my-monorepo/â”œâ”€â”€ pnpm-workspace.yaml          # pnpm workspace é…ç½®â”œâ”€â”€ package.json                  # æ ¹ package.jsonâ”œâ”€â”€ turbo.json                    # Turborepo é…ç½®ï¼ˆå¯é€‰ï¼‰â”œâ”€â”€ .npmrc                        # pnpm é…ç½®â”œâ”€â”€ .gitignoreâ”œâ”€â”€ README.mdâ”‚â”œâ”€â”€ packages/                     # å…±äº«åŒ…ç›®å½•â”‚   â”œâ”€â”€ ui-components/           # å…±äº«ç»„ä»¶åº“ï¼ˆVue3ï¼‰â”‚   â”‚   â”œâ”€â”€ package.jsonâ”‚   â”‚   â”œâ”€â”€ vite.config.tsâ”‚   â”‚   â”œâ”€â”€ src/â”‚   â”‚   â”‚   â”œâ”€â”€ index.tsâ”‚   â”‚   â”‚   â””â”€â”€ components/â”‚   â”‚   â””â”€â”€ dist/â”‚   â”‚â”‚   â”œâ”€â”€ ui-components-vue2/      # Vue2 ç»„ä»¶åº“ï¼ˆå¦‚æœéœ€è¦ï¼‰â”‚   â”‚   â”œâ”€â”€ package.jsonâ”‚   â”‚   â”œâ”€â”€ vue.config.jsâ”‚   â”‚   â””â”€â”€ src/â”‚   â”‚â”‚   â”œâ”€â”€ shared-utils/            # å…±äº«å·¥å…·å‡½æ•°â”‚   â”‚   â”œâ”€â”€ package.jsonâ”‚   â”‚   â””â”€â”€ src/â”‚   â”‚â”‚   â””â”€â”€ api-client/              # å…±äº« API å®¢æˆ·ç«¯â”‚       â”œâ”€â”€ package.jsonâ”‚       â””â”€â”€ src/â”‚â””â”€â”€ apps/                        # åº”ç”¨ç›®å½•    â”œâ”€â”€ admin-vue3/             # Vue3 ç®¡ç†åå°    â”‚   â”œâ”€â”€ package.json    â”‚   â”œâ”€â”€ vite.config.ts    â”‚   â”œâ”€â”€ src/    â”‚   â””â”€â”€ dist/    â”‚    â”œâ”€â”€ user-vue2/              # Vue2 ç”¨æˆ·ç«¯ï¼ˆæ—§ç³»ç»Ÿï¼‰    â”‚   â”œâ”€â”€ package.json    â”‚   â”œâ”€â”€ vue.config.js    â”‚   â”œâ”€â”€ src/    â”‚   â””â”€â”€ dist/    â”‚    â”œâ”€â”€ mobile-vue3/            # Vue3 ç§»åŠ¨ç«¯    â”‚   â”œâ”€â”€ package.json    â”‚   â”œâ”€â”€ vite.config.ts    â”‚   â””â”€â”€ src/    â”‚    â””â”€â”€ docs/                   # æ–‡æ¡£ç«™ç‚¹ï¼ˆå¯é€‰ï¼‰        â”œâ”€â”€ package.json        â””â”€â”€ src/</code></pre><h3 id="æ ¸å¿ƒé…ç½®æ–‡ä»¶"><a href="#æ ¸å¿ƒé…ç½®æ–‡ä»¶" class="headerlink" title="æ ¸å¿ƒé…ç½®æ–‡ä»¶"></a>æ ¸å¿ƒé…ç½®æ–‡ä»¶</h3><h4 id="1-pnpm-workspace-yaml"><a href="#1-pnpm-workspace-yaml" class="headerlink" title="1. pnpm-workspace.yaml"></a>1. <code>pnpm-workspace.yaml</code></h4><pre class="line-numbers language-yaml"><code class="language-yaml"><span class="token key atrule">packages</span><span class="token punctuation">:</span>  <span class="token punctuation">-</span> <span class="token string">"apps/*"</span>  <span class="token punctuation">-</span> <span class="token string">"packages/*"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h4 id="2-æ ¹ç›®å½•-package-json"><a href="#2-æ ¹ç›®å½•-package-json" class="headerlink" title="2. æ ¹ç›®å½• package.json"></a>2. æ ¹ç›®å½• <code>package.json</code></h4><pre class="line-numbers language-json"><code class="language-json"><span class="token punctuation">{</span>  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"my-monorepo"</span><span class="token punctuation">,</span>  <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>  <span class="token property">"private"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token property">"dev"</span><span class="token operator">:</span> <span class="token string">"turbo run dev"</span><span class="token punctuation">,</span>    <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"turbo run build"</span><span class="token punctuation">,</span>    <span class="token property">"test"</span><span class="token operator">:</span> <span class="token string">"turbo run test"</span><span class="token punctuation">,</span>    <span class="token property">"lint"</span><span class="token operator">:</span> <span class="token string">"turbo run lint"</span><span class="token punctuation">,</span>    <span class="token property">"clean"</span><span class="token operator">:</span> <span class="token string">"turbo run clean"</span><span class="token punctuation">,</span>    <span class="token property">"dev:admin"</span><span class="token operator">:</span> <span class="token string">"pnpm --filter admin-vue3 dev"</span><span class="token punctuation">,</span>    <span class="token property">"dev:user"</span><span class="token operator">:</span> <span class="token string">"pnpm --filter user-vue2 dev"</span><span class="token punctuation">,</span>    <span class="token property">"dev:mobile"</span><span class="token operator">:</span> <span class="token string">"pnpm --filter mobile-vue3 dev"</span><span class="token punctuation">,</span>    <span class="token property">"build:admin"</span><span class="token operator">:</span> <span class="token string">"pnpm --filter admin-vue3 build"</span><span class="token punctuation">,</span>    <span class="token property">"build:user"</span><span class="token operator">:</span> <span class="token string">"pnpm --filter user-vue2 build"</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token property">"devDependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token property">"turbo"</span><span class="token operator">:</span> <span class="token string">"^1.10.0"</span><span class="token punctuation">,</span>    <span class="token property">"typescript"</span><span class="token operator">:</span> <span class="token string">"^5.0.0"</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token property">"engines"</span><span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token property">"node"</span><span class="token operator">:</span> <span class="token string">">=16.0.0"</span><span class="token punctuation">,</span>    <span class="token property">"pnpm"</span><span class="token operator">:</span> <span class="token string">">=8.0.0"</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3-turbo-jsonï¼ˆå¯é€‰ï¼Œç”¨äºæ„å»ºåŠ é€Ÿï¼‰"><a href="#3-turbo-jsonï¼ˆå¯é€‰ï¼Œç”¨äºæ„å»ºåŠ é€Ÿï¼‰" class="headerlink" title="3. turbo.jsonï¼ˆå¯é€‰ï¼Œç”¨äºæ„å»ºåŠ é€Ÿï¼‰"></a>3. <code>turbo.json</code>ï¼ˆå¯é€‰ï¼Œç”¨äºæ„å»ºåŠ é€Ÿï¼‰</h4><pre class="line-numbers language-json"><code class="language-json"><span class="token punctuation">{</span>  <span class="token property">"$schema"</span><span class="token operator">:</span> <span class="token string">"https://turbo.build/schema.json"</span><span class="token punctuation">,</span>  <span class="token property">"pipeline"</span><span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token property">"build"</span><span class="token operator">:</span> <span class="token punctuation">{</span>      <span class="token property">"dependsOn"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"^build"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>      <span class="token property">"outputs"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"dist/**"</span><span class="token punctuation">,</span> <span class="token string">".next/**"</span><span class="token punctuation">,</span> <span class="token string">"build/**"</span><span class="token punctuation">]</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token property">"dev"</span><span class="token operator">:</span> <span class="token punctuation">{</span>      <span class="token property">"cache"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>      <span class="token property">"persistent"</span><span class="token operator">:</span> <span class="token boolean">true</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token property">"lint"</span><span class="token operator">:</span> <span class="token punctuation">{</span>      <span class="token property">"dependsOn"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"^build"</span><span class="token punctuation">]</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token property">"test"</span><span class="token operator">:</span> <span class="token punctuation">{</span>      <span class="token property">"dependsOn"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"^build"</span><span class="token punctuation">]</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token property">"clean"</span><span class="token operator">:</span> <span class="token punctuation">{</span>      <span class="token property">"cache"</span><span class="token operator">:</span> <span class="token boolean">false</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="4-npmrcï¼ˆpnpm-é…ç½®ï¼‰"><a href="#4-npmrcï¼ˆpnpm-é…ç½®ï¼‰" class="headerlink" title="4. .npmrcï¼ˆpnpm é…ç½®ï¼‰"></a>4. <code>.npmrc</code>ï¼ˆpnpm é…ç½®ï¼‰</h4><pre><code>shamefully-hoist=falsestrict-peer-dependencies=falseauto-install-peers=true</code></pre><h4 id="5-apps-admin-vue3-package-jsonï¼ˆVue3-é¡¹ç›®ç¤ºä¾‹ï¼‰"><a href="#5-apps-admin-vue3-package-jsonï¼ˆVue3-é¡¹ç›®ç¤ºä¾‹ï¼‰" class="headerlink" title="5. apps/admin-vue3/package.jsonï¼ˆVue3 é¡¹ç›®ç¤ºä¾‹ï¼‰"></a>5. <code>apps/admin-vue3/package.json</code>ï¼ˆVue3 é¡¹ç›®ç¤ºä¾‹ï¼‰</h4><pre class="line-numbers language-json"><code class="language-json"><span class="token punctuation">{</span>  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"admin-vue3"</span><span class="token punctuation">,</span>  <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>  <span class="token property">"private"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"module"</span><span class="token punctuation">,</span>  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token property">"dev"</span><span class="token operator">:</span> <span class="token string">"vite"</span><span class="token punctuation">,</span>    <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"vite build"</span><span class="token punctuation">,</span>    <span class="token property">"preview"</span><span class="token operator">:</span> <span class="token string">"vite preview"</span><span class="token punctuation">,</span>    <span class="token property">"lint"</span><span class="token operator">:</span> <span class="token string">"eslint . --ext .vue,.js,.ts"</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token property">"vue"</span><span class="token operator">:</span> <span class="token string">"^3.3.0"</span><span class="token punctuation">,</span>    <span class="token property">"vue-router"</span><span class="token operator">:</span> <span class="token string">"^4.2.0"</span><span class="token punctuation">,</span>    <span class="token property">"pinia"</span><span class="token operator">:</span> <span class="token string">"^2.1.0"</span><span class="token punctuation">,</span>    <span class="token property">"ui-components"</span><span class="token operator">:</span> <span class="token string">"workspace:*"</span><span class="token punctuation">,</span>    <span class="token property">"shared-utils"</span><span class="token operator">:</span> <span class="token string">"workspace:*"</span><span class="token punctuation">,</span>    <span class="token property">"api-client"</span><span class="token operator">:</span> <span class="token string">"workspace:*"</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token property">"devDependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token property">"@vitejs/plugin-vue"</span><span class="token operator">:</span> <span class="token string">"^4.4.0"</span><span class="token punctuation">,</span>    <span class="token property">"vite"</span><span class="token operator">:</span> <span class="token string">"^5.0.0"</span><span class="token punctuation">,</span>    <span class="token property">"typescript"</span><span class="token operator">:</span> <span class="token string">"^5.0.0"</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="6-apps-user-vue2-package-jsonï¼ˆVue2-é¡¹ç›®ç¤ºä¾‹ï¼‰"><a href="#6-apps-user-vue2-package-jsonï¼ˆVue2-é¡¹ç›®ç¤ºä¾‹ï¼‰" class="headerlink" title="6. apps/user-vue2/package.jsonï¼ˆVue2 é¡¹ç›®ç¤ºä¾‹ï¼‰"></a>6. <code>apps/user-vue2/package.json</code>ï¼ˆVue2 é¡¹ç›®ç¤ºä¾‹ï¼‰</h4><pre class="line-numbers language-json"><code class="language-json"><span class="token punctuation">{</span>  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"user-vue2"</span><span class="token punctuation">,</span>  <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>  <span class="token property">"private"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token property">"dev"</span><span class="token operator">:</span> <span class="token string">"vue-cli-service serve"</span><span class="token punctuation">,</span>    <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"vue-cli-service build"</span><span class="token punctuation">,</span>    <span class="token property">"lint"</span><span class="token operator">:</span> <span class="token string">"vue-cli-service lint"</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token property">"vue"</span><span class="token operator">:</span> <span class="token string">"^2.7.14"</span><span class="token punctuation">,</span>    <span class="token property">"vue-router"</span><span class="token operator">:</span> <span class="token string">"^3.6.5"</span><span class="token punctuation">,</span>    <span class="token property">"vuex"</span><span class="token operator">:</span> <span class="token string">"^3.6.2"</span><span class="token punctuation">,</span>    <span class="token property">"shared-utils"</span><span class="token operator">:</span> <span class="token string">"workspace:*"</span><span class="token punctuation">,</span>    <span class="token property">"api-client"</span><span class="token operator">:</span> <span class="token string">"workspace:*"</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token property">"devDependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token property">"@vue/cli-service"</span><span class="token operator">:</span> <span class="token string">"^5.0.8"</span><span class="token punctuation">,</span>    <span class="token property">"vue-template-compiler"</span><span class="token operator">:</span> <span class="token string">"^2.7.14"</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="7-packages-ui-components-package-jsonï¼ˆç»„ä»¶åº“ç¤ºä¾‹ï¼‰"><a href="#7-packages-ui-components-package-jsonï¼ˆç»„ä»¶åº“ç¤ºä¾‹ï¼‰" class="headerlink" title="7. packages/ui-components/package.jsonï¼ˆç»„ä»¶åº“ç¤ºä¾‹ï¼‰"></a>7. <code>packages/ui-components/package.json</code>ï¼ˆç»„ä»¶åº“ç¤ºä¾‹ï¼‰</h4><pre class="line-numbers language-json"><code class="language-json"><span class="token punctuation">{</span>  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"ui-components"</span><span class="token punctuation">,</span>  <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>  <span class="token property">"main"</span><span class="token operator">:</span> <span class="token string">"./dist/index.js"</span><span class="token punctuation">,</span>  <span class="token property">"module"</span><span class="token operator">:</span> <span class="token string">"./dist/index.es.js"</span><span class="token punctuation">,</span>  <span class="token property">"types"</span><span class="token operator">:</span> <span class="token string">"./dist/index.d.ts"</span><span class="token punctuation">,</span>  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token property">"."</span><span class="token operator">:</span> <span class="token punctuation">{</span>      <span class="token property">"import"</span><span class="token operator">:</span> <span class="token string">"./dist/index.es.js"</span><span class="token punctuation">,</span>      <span class="token property">"require"</span><span class="token operator">:</span> <span class="token string">"./dist/index.js"</span><span class="token punctuation">,</span>      <span class="token property">"types"</span><span class="token operator">:</span> <span class="token string">"./dist/index.d.ts"</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token property">"files"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"dist"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"vite build"</span><span class="token punctuation">,</span>    <span class="token property">"dev"</span><span class="token operator">:</span> <span class="token string">"vite build --watch"</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token property">"vue"</span><span class="token operator">:</span> <span class="token string">"^3.3.0"</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token property">"devDependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token property">"@vitejs/plugin-vue"</span><span class="token operator">:</span> <span class="token string">"^4.4.0"</span><span class="token punctuation">,</span>    <span class="token property">"vite"</span><span class="token operator">:</span> <span class="token string">"^5.0.0"</span><span class="token punctuation">,</span>    <span class="token property">"typescript"</span><span class="token operator">:</span> <span class="token string">"^5.0.0"</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token property">"peerDependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token property">"vue"</span><span class="token operator">:</span> <span class="token string">"^3.3.0"</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="å¿«é€Ÿå¼€å§‹"><a href="#å¿«é€Ÿå¼€å§‹" class="headerlink" title="å¿«é€Ÿå¼€å§‹"></a>å¿«é€Ÿå¼€å§‹</h2><blockquote><p>ğŸ’¡ <strong>æç¤º</strong>ï¼šå¦‚æœä½ æƒ³å¿«é€Ÿå¼€å§‹ï¼Œå¯ä»¥ä½¿ç”¨å®˜æ–¹æä¾›çš„æ¨¡æ¿ï¼š</p><ul><li>ä½¿ç”¨ <code>npx create-turbo@latest</code> åˆ›å»ºæ–°çš„ Monorepo é¡¹ç›®</li><li>å‚è€ƒ <a href="https://turborepo-zh.vercel.app/getting-started/create-new.html">Turborepo ä¸­æ–‡æ–‡æ¡£</a> äº†è§£è¯¦ç»†æ­¥éª¤</li><li>æŸ¥çœ‹ <a href="https://github.com/vercel/turborepo/tree/main/examples/basic">pnpm workspace + Turborepo å¯åŠ¨èµ„æºåº“</a> è·å–å®Œæ•´ç¤ºä¾‹</li></ul></blockquote><h3 id="1-å®‰è£…-pnpm"><a href="#1-å®‰è£…-pnpm" class="headerlink" title="1. å®‰è£… pnpm"></a>1. å®‰è£… pnpm</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># ä½¿ç”¨ npm å®‰è£…</span><span class="token function">npm</span> <span class="token function">install</span> -g pnpm<span class="token comment" spellcheck="true"># æˆ–ä½¿ç”¨ corepackï¼ˆNode.js 16.13+ï¼‰</span>corepack <span class="token function">enable</span>corepack prepare pnpm@latest --activate<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-åˆ›å»ºé¡¹ç›®ç»“æ„"><a href="#2-åˆ›å»ºé¡¹ç›®ç»“æ„" class="headerlink" title="2. åˆ›å»ºé¡¹ç›®ç»“æ„"></a>2. åˆ›å»ºé¡¹ç›®ç»“æ„</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># åˆ›å»ºæ ¹ç›®å½•</span><span class="token function">mkdir</span> my-monorepo <span class="token operator">&amp;&amp;</span> <span class="token function">cd</span> my-monorepo<span class="token comment" spellcheck="true"># åˆå§‹åŒ– pnpm workspace</span><span class="token keyword">echo</span> <span class="token string">"packages:\n  - 'apps/*'\n  - 'packages/*'"</span> <span class="token operator">></span> pnpm-workspace.yaml<span class="token comment" spellcheck="true"># åˆ›å»ºç›®å½•ç»“æ„</span><span class="token function">mkdir</span> -p apps/admin-vue3 apps/user-vue2 apps/mobile-vue3<span class="token function">mkdir</span> -p packages/ui-components packages/shared-utils packages/api-client<span class="token comment" spellcheck="true"># åˆå§‹åŒ–æ ¹ package.json</span>pnpm init<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-å®‰è£…ä¾èµ–"><a href="#3-å®‰è£…ä¾èµ–" class="headerlink" title="3. å®‰è£…ä¾èµ–"></a>3. å®‰è£…ä¾èµ–</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># åœ¨æ ¹ç›®å½•å®‰è£…æ‰€æœ‰ä¾èµ–</span>pnpm <span class="token function">install</span><span class="token comment" spellcheck="true"># ä¸ºç‰¹å®šé¡¹ç›®å®‰è£…ä¾èµ–</span>pnpm --filter admin-vue3 add vue@^3.3.0pnpm --filter user-vue2 add vue@^2.7.14<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-è¿è¡Œé¡¹ç›®"><a href="#4-è¿è¡Œé¡¹ç›®" class="headerlink" title="4. è¿è¡Œé¡¹ç›®"></a>4. è¿è¡Œé¡¹ç›®</h3><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># è¿è¡Œæ‰€æœ‰é¡¹ç›®çš„ dev å‘½ä»¤</span>pnpm dev<span class="token comment" spellcheck="true"># è¿è¡Œç‰¹å®šé¡¹ç›®</span>pnpm dev:adminpnpm dev:user<span class="token comment" spellcheck="true"># æ„å»ºæ‰€æœ‰é¡¹ç›®</span>pnpm build<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="å…³é”®åŒºåˆ«è¯¦è§£ï¼ˆé¿å…è¸©å‘ï¼‰"><a href="#å…³é”®åŒºåˆ«è¯¦è§£ï¼ˆé¿å…è¸©å‘ï¼‰" class="headerlink" title="å…³é”®åŒºåˆ«è¯¦è§£ï¼ˆé¿å…è¸©å‘ï¼‰"></a>å…³é”®åŒºåˆ«è¯¦è§£ï¼ˆé¿å…è¸©å‘ï¼‰</h2><h3 id="1-ä¾èµ–ç®¡ç†æ–¹å¼"><a href="#1-ä¾èµ–ç®¡ç†æ–¹å¼" class="headerlink" title="1. ä¾èµ–ç®¡ç†æ–¹å¼"></a>1. ä¾èµ–ç®¡ç†æ–¹å¼</h3><p><strong>pnpm workspaceï¼š</strong></p><ul><li>ä½¿ç”¨ <code>workspace:*</code> åè®®å¼•ç”¨æœ¬åœ°åŒ…</li><li>ä¾èµ–é€šè¿‡ç¡¬é“¾æ¥å…±äº«ï¼ŒèŠ‚çœç©ºé—´</li><li>ä¸åŒé¡¹ç›®å¯ä»¥å®‰è£…ä¸åŒç‰ˆæœ¬çš„åŒä¸€ä¾èµ–ï¼ˆå¦‚ Vue2 å’Œ Vue3ï¼‰</li></ul><p><strong>yarn workspaceï¼š</strong></p><ul><li>ä½¿ç”¨ <code>workspace:*</code> åè®®</li><li>ä¾èµ–æå‡åˆ°æ ¹ç›®å½•ï¼Œå¯èƒ½é€ æˆç‰ˆæœ¬å†²çª</li><li>éœ€è¦é¢å¤–é…ç½®æ‰èƒ½è®©ä¸åŒç‰ˆæœ¬å…±å­˜</li></ul><p><strong>npm workspaceï¼š</strong></p><ul><li>ä½¿ç”¨ <code>workspace:*</code> åè®®</li><li>ä¾èµ–æå‡ï¼Œç‰ˆæœ¬å†²çªé£é™©é«˜</li><li>åŠŸèƒ½æœ€ç®€å•ï¼Œä½†çµæ´»æ€§å·®</li></ul><h3 id="2-å®‰è£…é€Ÿåº¦å¯¹æ¯”"><a href="#2-å®‰è£…é€Ÿåº¦å¯¹æ¯”" class="headerlink" title="2. å®‰è£…é€Ÿåº¦å¯¹æ¯”"></a>2. å®‰è£…é€Ÿåº¦å¯¹æ¯”</h3><p>å®é™…æµ‹è¯•ï¼ˆ100+ ä¾èµ–åŒ…ï¼‰ï¼š</p><table><thead><tr><th>å·¥å…·</th><th>é¦–æ¬¡å®‰è£…</th><th>å¢é‡å®‰è£…</th><th>ç£ç›˜å ç”¨</th></tr></thead><tbody><tr><td>pnpm</td><td>30s</td><td>5s</td><td>200MB</td></tr><tr><td>yarn</td><td>60s</td><td>15s</td><td>500MB</td></tr><tr><td>npm</td><td>90s</td><td>25s</td><td>800MB</td></tr></tbody></table><h3 id="3-æ„å»ºåŠ é€Ÿï¼ˆTurborepoï¼‰"><a href="#3-æ„å»ºåŠ é€Ÿï¼ˆTurborepoï¼‰" class="headerlink" title="3. æ„å»ºåŠ é€Ÿï¼ˆTurborepoï¼‰"></a>3. æ„å»ºåŠ é€Ÿï¼ˆTurborepoï¼‰</h3><p><strong>ä¸ä½¿ç”¨ Turborepoï¼š</strong></p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># æ¯æ¬¡æ„å»ºéƒ½è¦é‡æ–°ç¼–è¯‘æ‰€æœ‰é¡¹ç›®</span>pnpm build  <span class="token comment" spellcheck="true"># è€—æ—¶ 5 åˆ†é’Ÿ</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>ä½¿ç”¨ Turborepoï¼š</strong></p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># é¦–æ¬¡æ„å»ºï¼š5 åˆ†é’Ÿ</span><span class="token comment" spellcheck="true"># ç¬¬äºŒæ¬¡æ„å»ºï¼ˆæ— å˜æ›´ï¼‰ï¼š5 ç§’ï¼ˆä½¿ç”¨ç¼“å­˜ï¼‰</span><span class="token comment" spellcheck="true"># éƒ¨åˆ†å˜æ›´ï¼šåªæ„å»ºå˜æ›´çš„é¡¹ç›®ï¼Œ1 åˆ†é’Ÿ</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="4-ç‰ˆæœ¬å…±å­˜ç­–ç•¥"><a href="#4-ç‰ˆæœ¬å…±å­˜ç­–ç•¥" class="headerlink" title="4. ç‰ˆæœ¬å…±å­˜ç­–ç•¥"></a>4. ç‰ˆæœ¬å…±å­˜ç­–ç•¥</h3><p><strong>pnpmï¼ˆæ¨èï¼‰ï¼š</strong></p><pre class="line-numbers language-json"><code class="language-json">// apps/admin-vue3/package.json<span class="token punctuation">{</span>  <span class="token property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token property">"vue"</span><span class="token operator">:</span> <span class="token string">"^3.3.0"</span>  // âœ… å¯ä»¥  <span class="token punctuation">}</span><span class="token punctuation">}</span>// apps/user-vue2/package.json<span class="token punctuation">{</span>  <span class="token property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token property">"vue"</span><span class="token operator">:</span> <span class="token string">"^2.7.14"</span>  // âœ… å¯ä»¥ï¼Œä¸ä¼šå†²çª  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>yarn workspaceï¼š</strong></p><pre class="line-numbers language-json"><code class="language-json">// éœ€è¦é¢å¤–é…ç½® .yarnrc.ymlnodeLinker<span class="token operator">:</span> node-modules// æˆ–ä½¿ç”¨ resolutions å¼ºåˆ¶ç‰ˆæœ¬<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><strong>npm workspaceï¼š</strong></p><pre class="line-numbers language-json"><code class="language-json">// å¯èƒ½å†²çªï¼Œéœ€è¦æ‰‹åŠ¨å¤„ç†// å»ºè®®ä½¿ç”¨ä¸åŒåŒ…åæˆ–è·¯å¾„åˆ«å<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="5-æœ¬åœ°åŒ…å¼•ç”¨"><a href="#5-æœ¬åœ°åŒ…å¼•ç”¨" class="headerlink" title="5. æœ¬åœ°åŒ…å¼•ç”¨"></a>5. æœ¬åœ°åŒ…å¼•ç”¨</h3><p>æ‰€æœ‰å·¥å…·éƒ½ä½¿ç”¨ <code>workspace:*</code> åè®®ï¼š</p><pre class="line-numbers language-json"><code class="language-json"><span class="token punctuation">{</span>  <span class="token property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token property">"ui-components"</span><span class="token operator">:</span> <span class="token string">"workspace:*"</span><span class="token punctuation">,</span>    <span class="token property">"shared-utils"</span><span class="token operator">:</span> <span class="token string">"workspace:^1.0.0"</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åŒºåˆ«åœ¨äºï¼š</p><ul><li><strong>pnpm</strong>ï¼šè‡ªåŠ¨è§£æï¼Œæ— éœ€é¢å¤–é…ç½®</li><li><strong>yarn</strong>ï¼šéœ€è¦ç¡®ä¿åŒ…åæ­£ç¡®</li><li><strong>npm</strong>ï¼šéœ€è¦ç¡®ä¿åŒ…åœ¨ workspace ä¸­</li></ul><hr><h2 id="å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ"><a href="#å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ" class="headerlink" title="å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ"></a>å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ</h2><h3 id="Q1-Vue2-å’Œ-Vue3-èƒ½å…±å­˜å—ï¼Ÿ"><a href="#Q1-Vue2-å’Œ-Vue3-èƒ½å…±å­˜å—ï¼Ÿ" class="headerlink" title="Q1: Vue2 å’Œ Vue3 èƒ½å…±å­˜å—ï¼Ÿ"></a>Q1: Vue2 å’Œ Vue3 èƒ½å…±å­˜å—ï¼Ÿ</h3><p><strong>A:</strong> å¯ä»¥ï¼pnpm é€šè¿‡ä¸åŒçš„ node_modules ç»“æ„ï¼Œè®©æ¯ä¸ªé¡¹ç›®ç‹¬ç«‹ç®¡ç†ä¾èµ–ã€‚</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># Vue2 é¡¹ç›®</span>apps/user-vue2/node_modules/vue/  <span class="token comment" spellcheck="true"># Vue 2.7.14</span><span class="token comment" spellcheck="true"># Vue3 é¡¹ç›®</span>apps/admin-vue3/node_modules/vue/  <span class="token comment" spellcheck="true"># Vue 3.3.0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Q2-ç»„ä»¶åº“å¦‚ä½•åŒæ—¶æ”¯æŒ-Vue2-å’Œ-Vue3ï¼Ÿ"><a href="#Q2-ç»„ä»¶åº“å¦‚ä½•åŒæ—¶æ”¯æŒ-Vue2-å’Œ-Vue3ï¼Ÿ" class="headerlink" title="Q2: ç»„ä»¶åº“å¦‚ä½•åŒæ—¶æ”¯æŒ Vue2 å’Œ Vue3ï¼Ÿ"></a>Q2: ç»„ä»¶åº“å¦‚ä½•åŒæ—¶æ”¯æŒ Vue2 å’Œ Vue3ï¼Ÿ</h3><p><strong>A:</strong> ä¸¤ç§æ–¹æ¡ˆï¼š</p><p><strong>æ–¹æ¡ˆ 1ï¼šåˆ†åˆ«ç»´æŠ¤ä¸¤ä¸ªç»„ä»¶åº“</strong></p><pre><code>packages/ui-components-vue2/packages/ui-components-vue3/</code></pre><p><strong>æ–¹æ¡ˆ 2ï¼šä½¿ç”¨é€‚é…å±‚ï¼ˆæ¨èï¼‰</strong></p><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// packages/ui-components/src/index.ts</span><span class="token keyword">import</span> <span class="token punctuation">{</span> isVue3 <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./utils"</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>isVue3<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">"./vue3"</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>  <span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">"./vue2"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Q3-å¦‚ä½•é¿å…å¾ªç¯ä¾èµ–ï¼Ÿ"><a href="#Q3-å¦‚ä½•é¿å…å¾ªç¯ä¾èµ–ï¼Ÿ" class="headerlink" title="Q3: å¦‚ä½•é¿å…å¾ªç¯ä¾èµ–ï¼Ÿ"></a>Q3: å¦‚ä½•é¿å…å¾ªç¯ä¾èµ–ï¼Ÿ</h3><p><strong>A:</strong> ä½¿ç”¨ä¾èµ–å±‚çº§ï¼š</p><pre><code>shared-utils (æœ€åº•å±‚)  â†“api-client  â†“ui-components  â†“apps/* (åº”ç”¨å±‚)</code></pre><p>é…åˆ ESLint è§„åˆ™æ£€æŸ¥ï¼š</p><pre class="line-numbers language-json"><code class="language-json">// .eslintrc.js<span class="token punctuation">{</span>  <span class="token property">"rules"</span><span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token property">"import/no-restricted-paths"</span><span class="token operator">:</span> <span class="token punctuation">[</span>      <span class="token string">"error"</span><span class="token punctuation">,</span>      <span class="token punctuation">{</span>        <span class="token property">"zones"</span><span class="token operator">:</span> <span class="token punctuation">[</span>          <span class="token punctuation">{</span>            <span class="token property">"target"</span><span class="token operator">:</span> <span class="token string">"./packages/shared-utils"</span><span class="token punctuation">,</span>            <span class="token property">"from"</span><span class="token operator">:</span> <span class="token string">"./apps"</span>          <span class="token punctuation">}</span>        <span class="token punctuation">]</span>      <span class="token punctuation">}</span>    <span class="token punctuation">]</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Q4-æ„å»ºé¡ºåºå¦‚ä½•æ§åˆ¶ï¼Ÿ"><a href="#Q4-æ„å»ºé¡ºåºå¦‚ä½•æ§åˆ¶ï¼Ÿ" class="headerlink" title="Q4: æ„å»ºé¡ºåºå¦‚ä½•æ§åˆ¶ï¼Ÿ"></a>Q4: æ„å»ºé¡ºåºå¦‚ä½•æ§åˆ¶ï¼Ÿ</h3><p><strong>A:</strong> ä½¿ç”¨ Turborepo çš„ <code>dependsOn</code>ï¼š</p><pre class="line-numbers language-json"><code class="language-json">// turbo.json<span class="token punctuation">{</span>  <span class="token property">"pipeline"</span><span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token property">"build"</span><span class="token operator">:</span> <span class="token punctuation">{</span>      <span class="token property">"dependsOn"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"^build"</span><span class="token punctuation">]</span> // å…ˆæ„å»ºä¾èµ–çš„åŒ…    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Q5-å¦‚ä½•å‘å¸ƒç»„ä»¶åº“åˆ°-npmï¼Ÿ"><a href="#Q5-å¦‚ä½•å‘å¸ƒç»„ä»¶åº“åˆ°-npmï¼Ÿ" class="headerlink" title="Q5: å¦‚ä½•å‘å¸ƒç»„ä»¶åº“åˆ° npmï¼Ÿ"></a>Q5: å¦‚ä½•å‘å¸ƒç»„ä»¶åº“åˆ° npmï¼Ÿ</h3><p><strong>A:</strong> ä½¿ç”¨ <code>changesets</code> æˆ– <code>lerna</code>ï¼š</p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># å®‰è£… changesets</span>pnpm add -Dw @changesets/cli<span class="token comment" spellcheck="true"># åˆ›å»ºå˜æ›´</span>pnpm changeset<span class="token comment" spellcheck="true"># å‘å¸ƒ</span>pnpm changeset publish<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="è¿ç§»æŒ‡å—"><a href="#è¿ç§»æŒ‡å—" class="headerlink" title="è¿ç§»æŒ‡å—"></a>è¿ç§»æŒ‡å—</h2><h3 id="ä»å•ä»“åº“è¿ç§»åˆ°-Monorepo"><a href="#ä»å•ä»“åº“è¿ç§»åˆ°-Monorepo" class="headerlink" title="ä»å•ä»“åº“è¿ç§»åˆ° Monorepo"></a>ä»å•ä»“åº“è¿ç§»åˆ° Monorepo</h3><ol><li><strong>åˆ›å»ºæ–°çš„ Monorepo ç»“æ„</strong></li><li><strong>ç§»åŠ¨ç°æœ‰é¡¹ç›®åˆ° <code>apps/</code> ç›®å½•</strong></li><li><strong>æå–å…±äº«ä»£ç åˆ° <code>packages/</code></strong></li><li><strong>æ›´æ–°æ‰€æœ‰ <code>package.json</code> ä¸­çš„ä¾èµ–å¼•ç”¨</strong></li><li><strong>é…ç½® <code>pnpm-workspace.yaml</code></strong></li><li><strong>è¿è¡Œ <code>pnpm install</code> å®‰è£…ä¾èµ–</strong></li><li><strong>æµ‹è¯•æ‰€æœ‰é¡¹ç›®æ˜¯å¦æ­£å¸¸è¿è¡Œ</strong></li></ol><h3 id="ä»å…¶ä»–å·¥å…·è¿ç§»"><a href="#ä»å…¶ä»–å·¥å…·è¿ç§»" class="headerlink" title="ä»å…¶ä»–å·¥å…·è¿ç§»"></a>ä»å…¶ä»–å·¥å…·è¿ç§»</h3><p><strong>ä» yarn workspace è¿ç§»ï¼š</strong></p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># 1. åˆ é™¤ yarn.lock å’Œ node_modules</span><span class="token function">rm</span> -rf yarn.lock node_modules **/node_modules<span class="token comment" spellcheck="true"># 2. å®‰è£… pnpm</span><span class="token function">npm</span> <span class="token function">install</span> -g pnpm<span class="token comment" spellcheck="true"># 3. åˆ›å»º pnpm-workspace.yaml</span><span class="token comment" spellcheck="true"># 4. è¿è¡Œ pnpm install</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ä» Lerna è¿ç§»ï¼š</strong></p><pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># Lerna å¯ä»¥ä¿ç•™ï¼Œåªæ›¿æ¢åŒ…ç®¡ç†å™¨</span><span class="token comment" spellcheck="true"># å°† npm/yarn æ›¿æ¢ä¸º pnpm</span><span class="token comment" spellcheck="true"># æ›´æ–° package.json ä¸­çš„ scripts</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><hr><h2 id="æœ€ä½³å®è·µ"><a href="#æœ€ä½³å®è·µ" class="headerlink" title="æœ€ä½³å®è·µ"></a>æœ€ä½³å®è·µ</h2><h3 id="1-ä¾èµ–ç®¡ç†"><a href="#1-ä¾èµ–ç®¡ç†" class="headerlink" title="1. ä¾èµ–ç®¡ç†"></a>1. ä¾èµ–ç®¡ç†</h3><p>âœ… <strong>æ¨èï¼š</strong></p><ul><li>å…±äº«ä¾èµ–æ”¾åœ¨æ ¹ç›®å½• <code>package.json</code></li><li>é¡¹ç›®ç‰¹å®šä¾èµ–æ”¾åœ¨å„è‡ª <code>package.json</code></li><li>ä½¿ç”¨ <code>workspace:*</code> å¼•ç”¨æœ¬åœ°åŒ…</li></ul><p>âŒ <strong>é¿å…ï¼š</strong></p><ul><li>åœ¨æ ¹ç›®å½•å®‰è£…æ‰€æœ‰ä¾èµ–</li><li>ä½¿ç”¨æ–‡ä»¶è·¯å¾„å¼•ç”¨ï¼ˆ<code>file:../packages/xxx</code>ï¼‰</li><li>ç‰ˆæœ¬å·ä¸ä¸€è‡´</li></ul><h3 id="2-æ„å»ºä¼˜åŒ–"><a href="#2-æ„å»ºä¼˜åŒ–" class="headerlink" title="2. æ„å»ºä¼˜åŒ–"></a>2. æ„å»ºä¼˜åŒ–</h3><p>âœ… <strong>æ¨èï¼š</strong></p><ul><li>ä½¿ç”¨ Turborepo ç¼“å­˜æ„å»ºç»“æœ</li><li>é…ç½®æ­£ç¡®çš„ <code>outputs</code> è·¯å¾„</li><li>ä½¿ç”¨å¹¶è¡Œæ„å»º</li></ul><p>âŒ <strong>é¿å…ï¼š</strong></p><ul><li>æ¯æ¬¡å…¨é‡æ„å»º</li><li>ç¼“å­˜é…ç½®é”™è¯¯</li><li>ä¸²è¡Œæ„å»º</li></ul><h3 id="3-ä»£ç ç»„ç»‡"><a href="#3-ä»£ç ç»„ç»‡" class="headerlink" title="3. ä»£ç ç»„ç»‡"></a>3. ä»£ç ç»„ç»‡</h3><p>âœ… <strong>æ¨èï¼š</strong></p><ul><li>æ¸…æ™°çš„ç›®å½•ç»“æ„</li><li>æ˜ç¡®çš„ä¾èµ–å±‚çº§</li><li>ç»Ÿä¸€çš„ä»£ç è§„èŒƒ</li></ul><p>âŒ <strong>é¿å…ï¼š</strong></p><ul><li>å¾ªç¯ä¾èµ–</li><li>è·¨å±‚å¼•ç”¨</li><li>ä»£ç é‡å¤</li></ul><hr><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å¯¹äº <strong>Vue2 + Vue3 + å­é¡¹ç›® + ç»„ä»¶åº“</strong> çš„åœºæ™¯ï¼š</p><ol><li><p><strong>é¦–é€‰ï¼špnpm workspace + Turborepo</strong></p><ul><li>pnpm è§£å†³ä¾èµ–ç®¡ç†é—®é¢˜</li><li>Turborepo è§£å†³æ„å»ºæ•ˆç‡é—®é¢˜</li><li>ä¸¤è€…äº’è¡¥ï¼Œé…ç½®ç®€å•</li></ul></li><li><p><strong>å¤‡é€‰ï¼šyarn workspace</strong></p><ul><li>å¦‚æœå›¢é˜Ÿå·²ç»åœ¨ä½¿ç”¨ yarn</li><li>éœ€è¦é¢å¤–é…ç½®æ‰èƒ½è®© Vue2/Vue3 å…±å­˜</li></ul></li><li><p><strong>ä¸æ¨èï¼šnpm workspace</strong></p><ul><li>åŠŸèƒ½ç®€å•ï¼Œæ€§èƒ½ä¸€èˆ¬</li><li>Vue2/Vue3 å…±å­˜å›°éš¾</li></ul></li><li><p><strong>æŒ‰éœ€é€‰æ‹©ï¼šNx / Lerna</strong></p><ul><li>å¤§å‹ä¼ä¸šé¡¹ç›®è€ƒè™‘ Nx</li><li>éœ€è¦å‘å¸ƒå¤šä¸ª npm åŒ…è€ƒè™‘ Lerna</li></ul></li></ol><p><strong>è®°ä½ï¼šå·¥å…·æ˜¯æ‰‹æ®µï¼Œä¸æ˜¯ç›®çš„ã€‚é€‰æ‹©æœ€é€‚åˆå›¢é˜Ÿç°çŠ¶çš„å·¥å…·ï¼Œæ¯”é€‰æ‹©æœ€å…ˆè¿›çš„å·¥å…·æ›´é‡è¦ã€‚</strong></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> æ¶æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯å·¥ç¨‹åŒ– </tag>
            
            <tag> Vue </tag>
            
            <tag> æ¶æ„ </tag>
            
            <tag> Monorepo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœ‰çµç¦»çº¿æ•°å­—äºº JS-SDK ç³»ç»Ÿæ¶æ„æ–‡æ¡£</title>
      <link href="/2025/01/15/qian-duan-xuan-ran-shu-zi-ren-sdk-xi-tong-jia-gou/"/>
      <url>/2025/01/15/qian-duan-xuan-ran-shu-zi-ren-sdk-xi-tong-jia-gou/</url>
      
        <content type="html"><![CDATA[<h1 id="æœ‰çµç¦»çº¿æ•°å­—äºº-JS-SDK-ç³»ç»Ÿæ¶æ„æ–‡æ¡£"><a href="#æœ‰çµç¦»çº¿æ•°å­—äºº-JS-SDK-ç³»ç»Ÿæ¶æ„æ–‡æ¡£" class="headerlink" title="æœ‰çµç¦»çº¿æ•°å­—äºº JS-SDK ç³»ç»Ÿæ¶æ„æ–‡æ¡£"></a>æœ‰çµç¦»çº¿æ•°å­—äºº JS-SDK ç³»ç»Ÿæ¶æ„æ–‡æ¡£</h1><h2 id="ğŸ“–-SDK-æ¦‚è¿°"><a href="#ğŸ“–-SDK-æ¦‚è¿°" class="headerlink" title="ğŸ“– SDK æ¦‚è¿°"></a>ğŸ“– SDK æ¦‚è¿°</h2><p>æœ‰çµç¦»çº¿æ•°å­—äºº JS-SDK æ˜¯ä¸€ä¸ªç”¨äºåœ¨ Web ç¯å¢ƒä¸­é›†æˆ 3D æ•°å­—äººçš„ JavaScript SDKã€‚è¯¥ SDK æä¾›äº†å®Œæ•´çš„æ•°å­—äººæ¸²æŸ“ã€åŠ¨ç”»æ§åˆ¶ã€è¯­éŸ³äº¤äº’ç­‰åŠŸèƒ½ï¼Œæ”¯æŒç¦»çº¿æ¨¡å¼å’Œç½‘ç»œé‡è¿æœºåˆ¶ã€‚</p><h3 id="ä¸»è¦ç‰¹æ€§"><a href="#ä¸»è¦ç‰¹æ€§" class="headerlink" title="ä¸»è¦ç‰¹æ€§"></a>ä¸»è¦ç‰¹æ€§</h3><ul><li>ğŸ­ <strong>3D æ•°å­—äººæ¸²æŸ“</strong>: æ”¯æŒèº«ä½“åŠ¨ç”»ã€è¡¨æƒ…åŠ¨ç”»ã€å”‡å½¢åŒæ­¥</li><li>ğŸ“± <strong>è·¨å¹³å°æ”¯æŒ</strong>: æ”¯æŒä¸»æµæµè§ˆå™¨ç¯å¢ƒ</li><li>ğŸŒ <strong>ç½‘ç»œè‡ªé€‚åº”</strong>: è‡ªåŠ¨æ£€æµ‹ç½‘ç»œçŠ¶æ€ï¼Œæ”¯æŒç¦»çº¿/åœ¨çº¿æ¨¡å¼åˆ‡æ¢</li><li>ğŸ“Š <strong>è°ƒè¯•æ”¯æŒ</strong>: å†…ç½®è°ƒè¯•é¢æ¿å’Œæ€§èƒ½ç›‘æ§</li><li>ğŸ’¾ <strong>æ™ºèƒ½ç¼“å­˜</strong>: LRU ç¼“å­˜ç­–ç•¥ï¼Œä¼˜åŒ–èµ„æºåŠ è½½</li></ul><hr><h2 id="ğŸ—ï¸-SDK-æ¶æ„å›¾"><a href="#ğŸ—ï¸-SDK-æ¶æ„å›¾" class="headerlink" title="ğŸ—ï¸ SDK æ¶æ„å›¾"></a>ğŸ—ï¸ SDK æ¶æ„å›¾</h2><h3 id="æ•´ä½“æ¶æ„"><a href="#æ•´ä½“æ¶æ„" class="headerlink" title="æ•´ä½“æ¶æ„"></a>æ•´ä½“æ¶æ„</h3><p>SDK é‡‡ç”¨åˆ†å±‚æ¶æ„è®¾è®¡ï¼Œå…±åˆ†ä¸º 5 ä¸ªå±‚æ¬¡ï¼š</p><pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚                      åº”ç”¨å±‚                              â”‚â”‚  æä¾›ç”¨æˆ·å‹å¥½çš„ API æ¥å£ï¼Œå¤„ç†ä¸šåŠ¡é€»è¾‘                    â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚                      æ§åˆ¶å±‚                              â”‚â”‚  åè°ƒå„ä¸ªæ¨¡å—çš„å·¥ä½œï¼Œç®¡ç† SDK çš„æ•´ä½“çŠ¶æ€                 â”‚â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚â”‚  â”‚            XmovAvatar (ä¸»ç±»)                      â”‚  â”‚â”‚  â”‚  - åˆå§‹åŒ– SDK é…ç½®                                â”‚  â”‚â”‚  â”‚  - ç®¡ç† SDK ç”Ÿå‘½å‘¨æœŸ                               â”‚  â”‚â”‚  â”‚  - æä¾›ç”¨æˆ· API æ¥å£                              â”‚  â”‚â”‚  â”‚  - å¤„ç†å…¨å±€çŠ¶æ€ç®¡ç†                                â”‚  â”‚â”‚  â”‚  - åè°ƒå„æ¨¡å—é—´çš„é€šä¿¡                              â”‚  â”‚â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚                      æ¨¡å—å±‚                              â”‚â”‚  å®ç°å…·ä½“çš„åŠŸèƒ½æ¨¡å—ï¼Œå¦‚æ¸²æŸ“ã€è§£ç ã€ç¼“å­˜ç­‰                 â”‚â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚â”‚  â”‚ResourceManagerâ”‚  â”‚RenderSchedulerâ”‚  â”‚    TTSA      â”‚ â”‚â”‚  â”‚ èµ„æºç®¡ç†å™¨    â”‚  â”‚ æ¸²æŸ“è°ƒåº¦å™¨    â”‚  â”‚  é€šä¿¡æ¨¡å—    â”‚ â”‚â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚â”‚  â”‚NetworkMonitorâ”‚  â”‚  æ¸²æŸ“å™¨æ¨¡å—   â”‚                    â”‚â”‚  â”‚ ç½‘ç»œç›‘æ§      â”‚  â”‚ (Avatar/Audio)â”‚                    â”‚â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚                      å·¥å…·å±‚                              â”‚â”‚  æä¾›é€šç”¨çš„å·¥å…·å‡½æ•°å’Œè¾…åŠ©åŠŸèƒ½                            â”‚â”‚  - æ•°æ®è§£ç å·¥å…·                                          â”‚â”‚  - ç¼“å­˜ç®¡ç†å·¥å…·                                          â”‚â”‚  - æ€§èƒ½ç›‘æ§å·¥å…·                                          â”‚â”‚  - é”™è¯¯å¤„ç†å·¥å…·                                          â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚                    å¤–éƒ¨ä¾èµ–                              â”‚â”‚  ç¬¬ä¸‰æ–¹åº“å’Œæµè§ˆå™¨ API æ”¯æŒ                               â”‚â”‚  - WebGL / WebGPU                                        â”‚â”‚  - Socket.IO                                             â”‚â”‚  - MsgPack                                               â”‚â”‚  - Canvas API                                            â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre><h3 id="æ¶æ„è¯´æ˜"><a href="#æ¶æ„è¯´æ˜" class="headerlink" title="æ¶æ„è¯´æ˜"></a>æ¶æ„è¯´æ˜</h3><p><strong>åº”ç”¨å±‚</strong>: æä¾›ç”¨æˆ·å‹å¥½çš„ API æ¥å£ï¼Œå¤„ç†ä¸šåŠ¡é€»è¾‘</p><p><strong>æ§åˆ¶å±‚</strong>: åè°ƒå„ä¸ªæ¨¡å—çš„å·¥ä½œï¼Œç®¡ç† SDK çš„æ•´ä½“çŠ¶æ€</p><p><strong>æ¨¡å—å±‚</strong>: å®ç°å…·ä½“çš„åŠŸèƒ½æ¨¡å—ï¼Œå¦‚æ¸²æŸ“ã€è§£ç ã€ç¼“å­˜ç­‰</p><p><strong>å·¥å…·å±‚</strong>: æä¾›é€šç”¨çš„å·¥å…·å‡½æ•°å’Œè¾…åŠ©åŠŸèƒ½</p><p><strong>å¤–éƒ¨ä¾èµ–</strong>: ç¬¬ä¸‰æ–¹åº“å’Œæµè§ˆå™¨ API æ”¯æŒ</p><hr><h2 id="ğŸ”„-SDK-æµç¨‹å›¾"><a href="#ğŸ”„-SDK-æµç¨‹å›¾" class="headerlink" title="ğŸ”„ SDK æµç¨‹å›¾"></a>ğŸ”„ SDK æµç¨‹å›¾</h2><h3 id="1-åˆå§‹åŒ–æµç¨‹"><a href="#1-åˆå§‹åŒ–æµç¨‹" class="headerlink" title="1. åˆå§‹åŒ–æµç¨‹"></a>1. åˆå§‹åŒ–æµç¨‹</h3><pre class="line-numbers language-mermaid"><code class="language-mermaid">graph TD    A[å¼€å§‹] --> B[åˆ›å»º XmovAvatar å®ä¾‹]    B --> C{æ£€æŸ¥å®¹å™¨å…ƒç´ }    C -->|ä¸å­˜åœ¨| D[æŠ›å‡ºé”™è¯¯: CONTAINER_NOT_FOUND]    C -->|å­˜åœ¨| E[åˆå§‹åŒ– WebGL ä¸Šä¸‹æ–‡]    E --> F{WebGL åˆå§‹åŒ–æˆåŠŸ?}    F -->|å¤±è´¥| G[æŠ›å‡ºé”™è¯¯: WebGL åˆå§‹åŒ–å¤±è´¥]    F -->|æˆåŠŸ| H[åˆå§‹åŒ– ResourceManager]    H --> I[åˆå§‹åŒ– RenderScheduler]    I --> J[åˆå§‹åŒ– TTSA é€šä¿¡æ¨¡å—]    J --> K[è¿æ¥ WebSocket]    K --> L{è¿æ¥æˆåŠŸ?}    L -->|å¤±è´¥| M[æŠ›å‡ºé”™è¯¯: CONNECT_SOCKET_ERROR]    L -->|æˆåŠŸ| N[åˆå§‹åŒ– NetworkMonitor]    N --> O[åŠ è½½èµ„æº]    O --> P{èµ„æºåŠ è½½æˆåŠŸ?}    P -->|å¤±è´¥| Q[æŠ›å‡ºèµ„æºåŠ è½½é”™è¯¯]    P -->|æˆåŠŸ| R[SDK åˆå§‹åŒ–å®Œæˆ]    R --> S[è¿›å…¥ ready çŠ¶æ€]    S --> T[ç»“æŸ]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-è¿è¡Œæ—¶æµç¨‹"><a href="#2-è¿è¡Œæ—¶æµç¨‹" class="headerlink" title="2. è¿è¡Œæ—¶æµç¨‹"></a>2. è¿è¡Œæ—¶æµç¨‹</h3><pre class="line-numbers language-mermaid"><code class="language-mermaid">graph TD    A[SDK è¿è¡Œä¸­] --> B[æ¥æ”¶ TTSA æ•°æ®]    B --> C{æ•°æ®ç±»å‹åˆ¤æ–­}    C -->|éŸ³é¢‘æ•°æ®| D[éŸ³é¢‘è§£ç ]    C -->|è¡¨æƒ…æ•°æ®| E[è¡¨æƒ…è§£ç ]    C -->|èº«ä½“åŠ¨ç”»| F[è§†é¢‘è§£ç ]    C -->|äº‹ä»¶æ•°æ®| G[äº‹ä»¶å¤„ç†]    D --> H[éŸ³é¢‘æ’­æ”¾]    E --> I[è¡¨æƒ…æ¸²æŸ“]    F --> J[èº«ä½“åŠ¨ç”»æ¸²æŸ“]    G --> K[è§¦å‘äº‹ä»¶å›è°ƒ]    H --> L[RenderScheduler è°ƒåº¦]    I --> L    J --> L    K --> L    L --> M[æ¸²æŸ“åˆ° Canvas]    M --> N[æ›´æ–°è°ƒè¯•é¢æ¿]    N --> O{ç»§ç»­è¿è¡Œ?}    O -->|æ˜¯| B    O -->|å¦| P[ç»“æŸ]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-æ•°æ®å¤„ç†æµç¨‹"><a href="#3-æ•°æ®å¤„ç†æµç¨‹" class="headerlink" title="3. æ•°æ®å¤„ç†æµç¨‹"></a>3. æ•°æ®å¤„ç†æµç¨‹</h3><pre class="line-numbers language-mermaid"><code class="language-mermaid">graph TD    A[TTSA æ¥æ”¶æ•°æ®] --> B[MsgPack ååºåˆ—åŒ–]    B --> C{æ•°æ®éªŒè¯}    C -->|æ— æ•ˆ| D[æŠ›å‡ºé”™è¯¯: INVALID_DATA_STRUCTURE]    C -->|æœ‰æ•ˆ| E{æ•°æ®ç±»å‹}    E -->|éŸ³é¢‘| F[éŸ³é¢‘è§£ç å™¨]    E -->|è¡¨æƒ…| G[è¡¨æƒ…è§£ç å™¨]    E -->|è§†é¢‘| H[è§†é¢‘è§£ç å™¨]    E -->|äº‹ä»¶| I[äº‹ä»¶å¤„ç†å™¨]    F --> J{è§£ç æˆåŠŸ?}    G --> K{è§£ç æˆåŠŸ?}    H --> L{è§£ç æˆåŠŸ?}    J -->|å¤±è´¥| M[æŠ›å‡ºé”™è¯¯: AUDIO_DECODE_ERROR]    J -->|æˆåŠŸ| N[éŸ³é¢‘æ•°æ®ç¼“å­˜]    K -->|å¤±è´¥| O[æŠ›å‡ºé”™è¯¯: FACE_DECODE_ERROR]    K -->|æˆåŠŸ| P[è¡¨æƒ…æ•°æ®ç¼“å­˜]    L -->|å¤±è´¥| Q[æŠ›å‡ºé”™è¯¯: VIDEO_DECODE_ERROR]    L -->|æˆåŠŸ| R[è§†é¢‘å¸§ç¼“å­˜]    N --> S[RenderScheduler]    P --> S    R --> S    I --> S    S --> T[æ¸²æŸ“å¤„ç†]    T --> U[å®Œæˆ]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-ç½‘ç»œçŠ¶æ€å¤„ç†æµç¨‹"><a href="#4-ç½‘ç»œçŠ¶æ€å¤„ç†æµç¨‹" class="headerlink" title="4. ç½‘ç»œçŠ¶æ€å¤„ç†æµç¨‹"></a>4. ç½‘ç»œçŠ¶æ€å¤„ç†æµç¨‹</h3><pre class="line-numbers language-mermaid"><code class="language-mermaid">graph TD    A[NetworkMonitor ç›‘æ§] --> B{æ£€æµ‹ç½‘ç»œçŠ¶æ€}    B -->|åœ¨çº¿| C[æ­£å¸¸é€šä¿¡]    B -->|ç¦»çº¿| D[è§¦å‘ NETWORK_DOWN äº‹ä»¶]    D --> E[å¯ç”¨ç¦»çº¿æ¨¡å¼]    E --> F[ä½¿ç”¨ç¼“å­˜èµ„æº]    F --> G[æŒ‡æ•°é€€é¿é‡è¯•]    G --> H{é‡è¯•æˆåŠŸ?}    H -->|æ˜¯| I[è§¦å‘ NETWORK_UP äº‹ä»¶]    H -->|å¦| J{è¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°?}    J -->|æ˜¯| K[è§¦å‘ NETWORK_BREAK äº‹ä»¶]    J -->|å¦| L[ç­‰å¾…åé‡è¯•]    L --> G    I --> M[åˆ‡æ¢åˆ°åœ¨çº¿æ¨¡å¼]    M --> N[æ¢å¤å®æ—¶é€šä¿¡]    N --> C    C --> O[ç»§ç»­ç›‘æ§]    O --> B<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="ğŸ”§-æ ¸å¿ƒæ¨¡å—è¯´æ˜"><a href="#ğŸ”§-æ ¸å¿ƒæ¨¡å—è¯´æ˜" class="headerlink" title="ğŸ”§ æ ¸å¿ƒæ¨¡å—è¯´æ˜"></a>ğŸ”§ æ ¸å¿ƒæ¨¡å—è¯´æ˜</h2><h3 id="1-XmovAvatar-ä¸»ç±»"><a href="#1-XmovAvatar-ä¸»ç±»" class="headerlink" title="1. XmovAvatar (ä¸»ç±»)"></a>1. XmovAvatar (ä¸»ç±»)</h3><p>SDK çš„æ ¸å¿ƒå…¥å£ç±»ï¼Œè´Ÿè´£åè°ƒæ‰€æœ‰æ¨¡å—çš„å·¥ä½œã€‚</p><h4 id="ä¸»è¦èŒè´£"><a href="#ä¸»è¦èŒè´£" class="headerlink" title="ä¸»è¦èŒè´£:"></a>ä¸»è¦èŒè´£:</h4><ul><li><strong>åˆå§‹åŒ– SDK é…ç½®</strong>: éªŒè¯é…ç½®å‚æ•°ï¼Œåˆå§‹åŒ–å„ä¸ªæ¨¡å—</li><li><strong>ç®¡ç† SDK ç”Ÿå‘½å‘¨æœŸ</strong>: æ§åˆ¶ SDK çš„å¯åŠ¨ã€è¿è¡Œã€åœæ­¢</li><li><strong>æä¾›ç”¨æˆ· API æ¥å£</strong>: æš´éœ²ç®€æ´æ˜“ç”¨çš„ API ç»™å¼€å‘è€…</li><li><strong>å¤„ç†å…¨å±€çŠ¶æ€ç®¡ç†</strong>: ç»´æŠ¤ SDK çš„æ•´ä½“çŠ¶æ€</li><li><strong>åè°ƒå„æ¨¡å—é—´çš„é€šä¿¡</strong>: ä½œä¸ºæ¨¡å—é—´çš„é€šä¿¡æ¡¥æ¢</li></ul><h4 id="ä½¿ç”¨ç¤ºä¾‹"><a href="#ä½¿ç”¨ç¤ºä¾‹" class="headerlink" title="ä½¿ç”¨ç¤ºä¾‹"></a>ä½¿ç”¨ç¤ºä¾‹</h4><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> XmovAvatar <span class="token keyword">from</span> <span class="token string">"@xmov/avatar"</span><span class="token punctuation">;</span><span class="token keyword">const</span> avatar <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XmovAvatar</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  container<span class="token punctuation">:</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"avatar-container"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  serverUrl<span class="token punctuation">:</span> <span class="token string">"ws://localhost:8080"</span><span class="token punctuation">,</span>  config<span class="token punctuation">:</span> <span class="token punctuation">{</span>    enableDebug<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    cacheSize<span class="token punctuation">:</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// 5MB</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// åˆå§‹åŒ–</span><span class="token keyword">await</span> avatar<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// å¼€å§‹ä¼šè¯</span><span class="token keyword">await</span> avatar<span class="token punctuation">.</span><span class="token function">startSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// åœæ­¢ä¼šè¯</span><span class="token keyword">await</span> avatar<span class="token punctuation">.</span><span class="token function">stopSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h3 id="2-ResourceManager-èµ„æºç®¡ç†å™¨"><a href="#2-ResourceManager-èµ„æºç®¡ç†å™¨" class="headerlink" title="2. ResourceManager (èµ„æºç®¡ç†å™¨)"></a>2. ResourceManager (èµ„æºç®¡ç†å™¨)</h3><p>è´Ÿè´£ç®¡ç† SDK æ‰€éœ€çš„å„ç§èµ„æºæ–‡ä»¶ã€‚</p><h4 id="ä¸»è¦åŠŸèƒ½"><a href="#ä¸»è¦åŠŸèƒ½" class="headerlink" title="ä¸»è¦åŠŸèƒ½:"></a>ä¸»è¦åŠŸèƒ½:</h4><ul><li><strong>åŠ è½½è¡¨æƒ…æ•°æ® (IBR åŠ¨ç”»æ•°æ®)</strong>: ä»æœåŠ¡å™¨æˆ–æœ¬åœ°åŠ è½½è¡¨æƒ…åŠ¨ç”»æ•°æ®</li><li><strong>ç®¡ç†è§†é¢‘èµ„æºç¼“å­˜</strong>: ç¼“å­˜è§†é¢‘èµ„æºï¼Œå‡å°‘é‡å¤ä¸‹è½½</li><li><strong>åŠ è½½èƒŒæ™¯å›¾ç‰‡</strong>: æ”¯æŒè‡ªå®šä¹‰èƒŒæ™¯å›¾ç‰‡</li><li><strong>ç½‘ç»œè´¨é‡ç›‘æ§</strong>: ç›‘æ§ç½‘ç»œçŠ¶æ€ï¼Œä¼˜åŒ–èµ„æºåŠ è½½ç­–ç•¥</li><li><strong>ç¦»çº¿èµ„æºé¢„åŠ è½½</strong>: åœ¨ç¦»çº¿æ¨¡å¼ä¸‹ä½¿ç”¨é¢„åŠ è½½çš„èµ„æº</li></ul><h4 id="ç¼“å­˜ç­–ç•¥"><a href="#ç¼“å­˜ç­–ç•¥" class="headerlink" title="ç¼“å­˜ç­–ç•¥:"></a>ç¼“å­˜ç­–ç•¥:</h4><ul><li><strong>LRU (Least Recently Used) ç¼“å­˜ç®—æ³•</strong>: è‡ªåŠ¨æ·˜æ±°æœ€ä¹…æœªä½¿ç”¨çš„èµ„æº</li><li><strong>è‡ªåŠ¨æ¸…ç†è¿‡æœŸç¼“å­˜</strong>: å®šæœŸæ¸…ç†è¿‡æœŸæˆ–æ— æ•ˆçš„ç¼“å­˜</li><li><strong>å†…å­˜ä½¿ç”¨é™åˆ¶ (é»˜è®¤ 5MB)</strong>: é˜²æ­¢å†…å­˜æº¢å‡º</li><li><strong>å¹¶å‘ä¸‹è½½æ§åˆ¶</strong>: é™åˆ¶åŒæ—¶ä¸‹è½½çš„èµ„æºæ•°é‡ï¼Œé¿å…ç½‘ç»œæ‹¥å¡</li></ul><h4 id="å®ç°ç¤ºä¾‹"><a href="#å®ç°ç¤ºä¾‹" class="headerlink" title="å®ç°ç¤ºä¾‹"></a>å®ç°ç¤ºä¾‹</h4><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">ResourceManager</span> <span class="token punctuation">{</span>  <span class="token keyword">private</span> cache<span class="token punctuation">:</span> Map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> CacheItem<span class="token operator">></span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token keyword">private</span> maxCacheSize<span class="token punctuation">:</span> number <span class="token operator">=</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token comment" spellcheck="true">// 5MB</span>  <span class="token keyword">private</span> currentCacheSize<span class="token punctuation">:</span> number <span class="token operator">=</span> <span class="token number">0</span>  <span class="token keyword">async</span> <span class="token function">loadResource</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> string<span class="token punctuation">,</span> type<span class="token punctuation">:</span> ResourceType<span class="token punctuation">)</span><span class="token punctuation">:</span> Promise<span class="token operator">&lt;</span>any<span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// æ£€æŸ¥ç¼“å­˜</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>cache<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">const</span> item <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cache<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token operator">!</span>      item<span class="token punctuation">.</span>lastUsed <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>      <span class="token keyword">return</span> item<span class="token punctuation">.</span>data    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// ä¸‹è½½èµ„æº</span>    <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">downloadResource</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> type<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">// æ·»åŠ åˆ°ç¼“å­˜</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addToCache</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token punctuation">,</span> type<span class="token punctuation">)</span>    <span class="token keyword">return</span> data  <span class="token punctuation">}</span>  <span class="token keyword">private</span> <span class="token function">addToCache</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> string<span class="token punctuation">,</span> data<span class="token punctuation">:</span> any<span class="token punctuation">,</span> type<span class="token punctuation">:</span> ResourceType<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// æ£€æŸ¥ç¼“å­˜å¤§å°</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>currentCacheSize <span class="token operator">>=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>maxCacheSize<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">evictLRU</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span>    <span class="token keyword">const</span> size <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">calculateSize</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>cache<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">{</span>      data<span class="token punctuation">,</span>      type<span class="token punctuation">,</span>      size<span class="token punctuation">,</span>      lastUsed<span class="token punctuation">:</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>currentCacheSize <span class="token operator">+</span><span class="token operator">=</span> size  <span class="token punctuation">}</span>  <span class="token keyword">private</span> <span class="token function">evictLRU</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>    <span class="token keyword">let</span> oldestKey<span class="token punctuation">:</span> string <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">=</span> <span class="token keyword">null</span>    <span class="token keyword">let</span> oldestTime <span class="token operator">=</span> <span class="token number">Infinity</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span> item<span class="token punctuation">]</span> <span class="token keyword">of</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cache<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>lastUsed <span class="token operator">&lt;</span> oldestTime<span class="token punctuation">)</span> <span class="token punctuation">{</span>        oldestTime <span class="token operator">=</span> item<span class="token punctuation">.</span>lastUsed        oldestKey <span class="token operator">=</span> key      <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>oldestKey<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">const</span> item <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cache<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span>oldestKey<span class="token punctuation">)</span><span class="token operator">!</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>currentCacheSize <span class="token operator">-</span><span class="token operator">=</span> item<span class="token punctuation">.</span>size      <span class="token keyword">this</span><span class="token punctuation">.</span>cache<span class="token punctuation">.</span><span class="token keyword">delete</span><span class="token punctuation">(</span>oldestKey<span class="token punctuation">)</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h3 id="3-RenderScheduler-æ¸²æŸ“è°ƒåº¦å™¨"><a href="#3-RenderScheduler-æ¸²æŸ“è°ƒåº¦å™¨" class="headerlink" title="3. RenderScheduler (æ¸²æŸ“è°ƒåº¦å™¨)"></a>3. RenderScheduler (æ¸²æŸ“è°ƒåº¦å™¨)</h3><p>åè°ƒæ‰€æœ‰æ¸²æŸ“å™¨çš„å·¥ä½œï¼Œç®¡ç†æ¸²æŸ“æµç¨‹ã€‚</p><h4 id="ä¸»è¦èŒè´£-1"><a href="#ä¸»è¦èŒè´£-1" class="headerlink" title="ä¸»è¦èŒè´£:"></a>ä¸»è¦èŒè´£:</h4><ul><li><strong>è°ƒåº¦ Avatarã€Audioã€UI æ¸²æŸ“å™¨</strong>: ç»Ÿä¸€ç®¡ç†å„ä¸ªæ¸²æŸ“å™¨çš„æ¸²æŸ“æ—¶æœº</li><li><strong>å¤„ç† TTSA ä¸‹å‘çš„æ•°æ®</strong>: å°†æ¥æ”¶åˆ°çš„æ•°æ®åˆ†å‘ç»™å¯¹åº”çš„æ¸²æŸ“å™¨</li><li><strong>ç®¡ç†åŠ¨ç”»å¸§å¾ªç¯</strong>: æ§åˆ¶æ¸²æŸ“å¸§ç‡ï¼Œä¼˜åŒ–æ€§èƒ½</li><li><strong>æ§åˆ¶æ¸²æŸ“æ—¶æœºå’Œé¡ºåº</strong>: ç¡®ä¿æ¸²æŸ“çš„æ­£ç¡®é¡ºåºå’ŒåŒæ­¥</li></ul><h4 id="æ¸²æŸ“æµç¨‹"><a href="#æ¸²æŸ“æµç¨‹" class="headerlink" title="æ¸²æŸ“æµç¨‹"></a>æ¸²æŸ“æµç¨‹</h4><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">RenderScheduler</span> <span class="token punctuation">{</span>  <span class="token keyword">private</span> renderers<span class="token punctuation">:</span> Map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> Renderer<span class="token operator">></span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token keyword">private</span> animationFrameId<span class="token punctuation">:</span> number <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">=</span> <span class="token keyword">null</span>  <span class="token keyword">private</span> targetFPS<span class="token punctuation">:</span> number <span class="token operator">=</span> <span class="token number">30</span>  <span class="token function">registerRenderer</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> string<span class="token punctuation">,</span> renderer<span class="token punctuation">:</span> Renderer<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>renderers<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> renderer<span class="token punctuation">)</span>  <span class="token punctuation">}</span>  <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> frameInterval <span class="token operator">=</span> <span class="token number">1000</span> <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">.</span>targetFPS    <span class="token keyword">let</span> lastFrameTime <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">const</span> renderLoop <span class="token operator">=</span> <span class="token punctuation">(</span>currentTime<span class="token punctuation">:</span> number<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>currentTime <span class="token operator">-</span> lastFrameTime <span class="token operator">>=</span> frameInterval<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// æŒ‰é¡ºåºæ¸²æŸ“</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>renderers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>renderer <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>          renderer<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span>        lastFrameTime <span class="token operator">=</span> currentTime      <span class="token punctuation">}</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>animationFrameId <span class="token operator">=</span> <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>renderLoop<span class="token punctuation">)</span>    <span class="token punctuation">}</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>animationFrameId <span class="token operator">=</span> <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>renderLoop<span class="token punctuation">)</span>  <span class="token punctuation">}</span>  <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>animationFrameId <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token function">cancelAnimationFrame</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>animationFrameId<span class="token punctuation">)</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>animationFrameId <span class="token operator">=</span> <span class="token keyword">null</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  <span class="token function">scheduleData</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> RenderData<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// æ ¹æ®æ•°æ®ç±»å‹åˆ†å‘ç»™å¯¹åº”çš„æ¸²æŸ“å™¨</span>    <span class="token keyword">const</span> renderer <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>renderers<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>type<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>renderer<span class="token punctuation">)</span> <span class="token punctuation">{</span>      renderer<span class="token punctuation">.</span><span class="token function">processData</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h3 id="4-TTSA-é€šä¿¡æ¨¡å—"><a href="#4-TTSA-é€šä¿¡æ¨¡å—" class="headerlink" title="4. TTSA (é€šä¿¡æ¨¡å—)"></a>4. TTSA (é€šä¿¡æ¨¡å—)</h3><p>å¤„ç†ä¸åç«¯æœåŠ¡å™¨çš„ WebSocket é€šä¿¡ã€‚</p><h4 id="é€šä¿¡åè®®"><a href="#é€šä¿¡åè®®" class="headerlink" title="é€šä¿¡åè®®:"></a>é€šä¿¡åè®®:</h4><ul><li><strong>Socket.IO åè®®</strong>: ä½¿ç”¨ Socket.IO è¿›è¡Œå®æ—¶åŒå‘é€šä¿¡</li><li><strong>MsgPack æ•°æ®åºåˆ—åŒ–</strong>: ä½¿ç”¨ MsgPack è¿›è¡Œé«˜æ•ˆçš„æ•°æ®åºåˆ—åŒ–</li><li><strong>æ”¯æŒçš„æ•°æ®ç±»å‹</strong>:<ul><li>éŸ³é¢‘æ•°æ®</li><li>è¡¨æƒ…æ•°æ®</li><li>èº«ä½“åŠ¨ç”»æ•°æ®</li><li>äº‹ä»¶æ•°æ®</li></ul></li></ul><h4 id="çŠ¶æ€ç®¡ç†"><a href="#çŠ¶æ€ç®¡ç†" class="headerlink" title="çŠ¶æ€ç®¡ç†:"></a>çŠ¶æ€ç®¡ç†:</h4><ul><li><strong>interactive_idle</strong>: äº¤äº’ç©ºé—²çŠ¶æ€ï¼Œç­‰å¾…ç”¨æˆ·è¾“å…¥</li><li><strong>listen</strong>: ç›‘å¬çŠ¶æ€ï¼Œæ­£åœ¨æ¥æ”¶ç”¨æˆ·è¾“å…¥</li><li><strong>think</strong>: æ€è€ƒçŠ¶æ€ï¼Œå¤„ç†ç”¨æˆ·è¾“å…¥å¹¶ç”Ÿæˆå›å¤</li><li><strong>speak</strong>: è¯´è¯çŠ¶æ€ï¼Œæ•°å­—äººæ­£åœ¨è¯´è¯</li></ul><h4 id="å®ç°ç¤ºä¾‹-1"><a href="#å®ç°ç¤ºä¾‹-1" class="headerlink" title="å®ç°ç¤ºä¾‹"></a>å®ç°ç¤ºä¾‹</h4><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> io <span class="token keyword">from</span> <span class="token string">'socket.io-client'</span><span class="token keyword">import</span> <span class="token punctuation">{</span> decode <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'msgpack-lite'</span><span class="token keyword">class</span> <span class="token class-name">TTSA</span> <span class="token punctuation">{</span>  <span class="token keyword">private</span> socket<span class="token punctuation">:</span> Socket <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">=</span> <span class="token keyword">null</span>  <span class="token keyword">private</span> state<span class="token punctuation">:</span> TTSAState <span class="token operator">=</span> <span class="token string">'interactive_idle'</span>  <span class="token keyword">private</span> eventHandlers<span class="token punctuation">:</span> Map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> Function<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token keyword">async</span> <span class="token function">connect</span><span class="token punctuation">(</span>serverUrl<span class="token punctuation">:</span> string<span class="token punctuation">)</span><span class="token punctuation">:</span> Promise<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>socket <span class="token operator">=</span> <span class="token function">io</span><span class="token punctuation">(</span>serverUrl<span class="token punctuation">,</span> <span class="token punctuation">{</span>        transports<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'websocket'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        reconnection<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>        reconnectionAttempts<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>        reconnectionDelay<span class="token punctuation">:</span> <span class="token number">1000</span>      <span class="token punctuation">}</span><span class="token punctuation">)</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'connect'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'TTSA è¿æ¥æˆåŠŸ'</span><span class="token punctuation">)</span>        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>      <span class="token punctuation">}</span><span class="token punctuation">)</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>error<span class="token punctuation">:</span> Error<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'TTSA è¿æ¥é”™è¯¯:'</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span>        <span class="token function">reject</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>      <span class="token punctuation">}</span><span class="token punctuation">)</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>encodedData<span class="token punctuation">:</span> ArrayBuffer<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>        <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token function">decode</span><span class="token punctuation">(</span>Buffer<span class="token punctuation">.</span><span class="token keyword">from</span><span class="token punctuation">(</span>encodedData<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleData</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>      <span class="token punctuation">}</span><span class="token punctuation">)</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'state'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>newState<span class="token punctuation">:</span> TTSAState<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> newState        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'stateChange'</span><span class="token punctuation">,</span> newState<span class="token punctuation">)</span>      <span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span>  <span class="token keyword">private</span> <span class="token function">handleData</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> any<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> type<span class="token punctuation">,</span> payload <span class="token punctuation">}</span> <span class="token operator">=</span> data    <span class="token keyword">switch</span> <span class="token punctuation">(</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">case</span> <span class="token string">'audio'</span><span class="token punctuation">:</span>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'audio'</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>        <span class="token keyword">break</span>      <span class="token keyword">case</span> <span class="token string">'face'</span><span class="token punctuation">:</span>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'face'</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>        <span class="token keyword">break</span>      <span class="token keyword">case</span> <span class="token string">'body'</span><span class="token punctuation">:</span>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>        <span class="token keyword">break</span>      <span class="token keyword">case</span> <span class="token string">'event'</span><span class="token punctuation">:</span>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'event'</span><span class="token punctuation">,</span> payload<span class="token punctuation">)</span>        <span class="token keyword">break</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  <span class="token function">on</span><span class="token punctuation">(</span>event<span class="token punctuation">:</span> string<span class="token punctuation">,</span> handler<span class="token punctuation">:</span> Function<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>eventHandlers<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>eventHandlers<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>event<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>eventHandlers<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token operator">!</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>handler<span class="token punctuation">)</span>  <span class="token punctuation">}</span>  <span class="token keyword">private</span> <span class="token function">emit</span><span class="token punctuation">(</span>event<span class="token punctuation">:</span> string<span class="token punctuation">,</span> data<span class="token punctuation">:</span> any<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> handlers <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>eventHandlers<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>handlers<span class="token punctuation">)</span> <span class="token punctuation">{</span>      handlers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>handler <span class="token operator">=</span><span class="token operator">></span> <span class="token function">handler</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  <span class="token function">send</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> any<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>socket <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>socket<span class="token punctuation">.</span>connected<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">const</span> encoded <span class="token operator">=</span> <span class="token function">encode</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>socket<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span> encoded<span class="token punctuation">)</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h3 id="5-NetworkMonitor-ç½‘ç»œç›‘æ§"><a href="#5-NetworkMonitor-ç½‘ç»œç›‘æ§" class="headerlink" title="5. NetworkMonitor (ç½‘ç»œç›‘æ§)"></a>5. NetworkMonitor (ç½‘ç»œç›‘æ§)</h3><p>ç›‘æ§ç½‘ç»œçŠ¶æ€å˜åŒ–ï¼Œå¤„ç†ç¦»çº¿/åœ¨çº¿æ¨¡å¼åˆ‡æ¢ã€‚</p><h4 id="åŠŸèƒ½ç‰¹æ€§"><a href="#åŠŸèƒ½ç‰¹æ€§" class="headerlink" title="åŠŸèƒ½ç‰¹æ€§:"></a>åŠŸèƒ½ç‰¹æ€§:</h4><ul><li><strong>è‡ªåŠ¨æ£€æµ‹ç½‘ç»œçŠ¶æ€</strong>: ç›‘å¬æµè§ˆå™¨çš„ç½‘ç»œçŠ¶æ€å˜åŒ–äº‹ä»¶</li><li><strong>æŒ‡æ•°é€€é¿é‡è¯•æœºåˆ¶</strong>: ç½‘ç»œæ–­å¼€æ—¶é‡‡ç”¨æŒ‡æ•°é€€é¿ç­–ç•¥é‡è¯•è¿æ¥</li><li><strong>ç½‘ç»œè´¨é‡ç›‘æ§ (RTTã€å¸¦å®½)</strong>: å®æ—¶ç›‘æ§ç½‘ç»œå»¶è¿Ÿå’Œå¸¦å®½</li><li><strong>ç¦»çº¿æ¨¡å¼æ”¯æŒ</strong>: åœ¨ç½‘ç»œæ–­å¼€æ—¶åˆ‡æ¢åˆ°ç¦»çº¿æ¨¡å¼ï¼Œä½¿ç”¨ç¼“å­˜èµ„æº</li></ul><h4 id="å®ç°ç¤ºä¾‹-2"><a href="#å®ç°ç¤ºä¾‹-2" class="headerlink" title="å®ç°ç¤ºä¾‹"></a>å®ç°ç¤ºä¾‹</h4><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">NetworkMonitor</span> <span class="token punctuation">{</span>  <span class="token keyword">private</span> isOnline<span class="token punctuation">:</span> boolean <span class="token operator">=</span> navigator<span class="token punctuation">.</span>onLine  <span class="token keyword">private</span> reconnectAttempts<span class="token punctuation">:</span> number <span class="token operator">=</span> <span class="token number">0</span>  <span class="token keyword">private</span> maxReconnectAttempts<span class="token punctuation">:</span> number <span class="token operator">=</span> <span class="token number">5</span>  <span class="token keyword">private</span> baseDelay<span class="token punctuation">:</span> number <span class="token operator">=</span> <span class="token number">1000</span>  <span class="token keyword">private</span> eventHandlers<span class="token punctuation">:</span> Map<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> Function<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setupListeners</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span>  <span class="token keyword">private</span> <span class="token function">setupListeners</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'online'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleOnline</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span>    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'offline'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleOffline</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span>  <span class="token keyword">private</span> <span class="token function">handleOnline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>isOnline<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>isOnline <span class="token operator">=</span> <span class="token boolean">true</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>reconnectAttempts <span class="token operator">=</span> <span class="token number">0</span>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'networkUp'</span><span class="token punctuation">)</span>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ç½‘ç»œå·²æ¢å¤'</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  <span class="token keyword">private</span> <span class="token function">handleOffline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>isOnline<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>isOnline <span class="token operator">=</span> <span class="token boolean">false</span>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'networkDown'</span><span class="token punctuation">)</span>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ç½‘ç»œå·²æ–­å¼€'</span><span class="token punctuation">)</span>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">startReconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  <span class="token keyword">private</span> <span class="token function">startReconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>reconnectAttempts <span class="token operator">>=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>maxReconnectAttempts<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'networkBreak'</span><span class="token punctuation">)</span>      <span class="token keyword">return</span>    <span class="token punctuation">}</span>    <span class="token keyword">const</span> delay <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>baseDelay <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>reconnectAttempts<span class="token punctuation">)</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>reconnectAttempts<span class="token operator">++</span>    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'networkRetry'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>reconnectAttempts<span class="token punctuation">)</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>navigator<span class="token punctuation">.</span>onLine<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleOnline</span><span class="token punctuation">(</span><span class="token punctuation">)</span>      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">startReconnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span>  <span class="token punctuation">}</span>  <span class="token function">on</span><span class="token punctuation">(</span>event<span class="token punctuation">:</span> string<span class="token punctuation">,</span> handler<span class="token punctuation">:</span> Function<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>eventHandlers<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>eventHandlers<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span>event<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>eventHandlers<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token operator">!</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>handler<span class="token punctuation">)</span>  <span class="token punctuation">}</span>  <span class="token keyword">private</span> <span class="token function">emit</span><span class="token punctuation">(</span>event<span class="token punctuation">:</span> string<span class="token punctuation">,</span> data<span class="token operator">?</span><span class="token punctuation">:</span> any<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> handlers <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>eventHandlers<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>handlers<span class="token punctuation">)</span> <span class="token punctuation">{</span>      handlers<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>handler <span class="token operator">=</span><span class="token operator">></span> <span class="token function">handler</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  <span class="token function">getNetworkQuality</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> NetworkQuality <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// å®ç°ç½‘ç»œè´¨é‡æ£€æµ‹é€»è¾‘</span>    <span class="token keyword">return</span> <span class="token punctuation">{</span>      rtt<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">measureRTT</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>      bandwidth<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">measureBandwidth</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="âš ï¸-é”™è¯¯å¤„ç†"><a href="#âš ï¸-é”™è¯¯å¤„ç†" class="headerlink" title="âš ï¸ é”™è¯¯å¤„ç†"></a>âš ï¸ é”™è¯¯å¤„ç†</h2><p>SDK å®šä¹‰äº†è¯¦ç»†çš„é”™è¯¯ç ä½“ç³»ï¼Œæ–¹ä¾¿é—®é¢˜å®šä½å’Œå¤„ç†ã€‚</p><h3 id="é”™è¯¯ç åˆ†ç±»"><a href="#é”™è¯¯ç åˆ†ç±»" class="headerlink" title="é”™è¯¯ç åˆ†ç±»"></a>é”™è¯¯ç åˆ†ç±»</h3><h4 id="åˆå§‹åŒ–é”™è¯¯-10001-10004"><a href="#åˆå§‹åŒ–é”™è¯¯-10001-10004" class="headerlink" title="åˆå§‹åŒ–é”™è¯¯ (10001-10004)"></a>åˆå§‹åŒ–é”™è¯¯ (10001-10004)</h4><table><thead><tr><th>é”™è¯¯ç </th><th>é”™è¯¯åç§°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>10001</td><td>CONTAINER_NOT_FOUND</td><td>å®¹å™¨å…ƒç´ ä¸å­˜åœ¨</td></tr><tr><td>10002</td><td>CONNECT_SOCKET_ERROR</td><td>Socket è¿æ¥å¤±è´¥</td></tr><tr><td>10003</td><td>START_SESSION_ERROR</td><td>å¼€å§‹ä¼šè¯å¤±è´¥</td></tr><tr><td>10004</td><td>STOP_SESSION_ERROR</td><td>åœæ­¢ä¼šè¯å¤±è´¥</td></tr></tbody></table><h4 id="å‰ç«¯å¤„ç†é”™è¯¯-20001-20006"><a href="#å‰ç«¯å¤„ç†é”™è¯¯-20001-20006" class="headerlink" title="å‰ç«¯å¤„ç†é”™è¯¯ (20001-20006)"></a>å‰ç«¯å¤„ç†é”™è¯¯ (20001-20006)</h4><table><thead><tr><th>é”™è¯¯ç </th><th>é”™è¯¯åç§°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>20001</td><td>VIDEO_FRAME_EXTRACT_ERROR</td><td>è§†é¢‘æŠ½å¸§é”™è¯¯</td></tr><tr><td>20002</td><td>INIT_WORKER_ERROR</td><td>åˆå§‹åŒ– Worker é”™è¯¯</td></tr><tr><td>20003</td><td>PROCESS_VIDEO_STREAM_ERROR</td><td>å¤„ç†è§†é¢‘æµé”™è¯¯</td></tr><tr><td>20004</td><td>FACE_PROCESSING_ERROR</td><td>è¡¨æƒ…å¤„ç†é”™è¯¯</td></tr><tr><td>20005</td><td>RENDER_BODY_ERROR</td><td>èº«ä½“æ¸²æŸ“é”™è¯¯</td></tr><tr><td>20006</td><td>RENDER_FACE_ERROR</td><td>è¡¨æƒ…æ¸²æŸ“é”™è¯¯</td></tr></tbody></table><h4 id="èµ„æºç®¡ç†é”™è¯¯-30001-30004"><a href="#èµ„æºç®¡ç†é”™è¯¯-30001-30004" class="headerlink" title="èµ„æºç®¡ç†é”™è¯¯ (30001-30004)"></a>èµ„æºç®¡ç†é”™è¯¯ (30001-30004)</h4><table><thead><tr><th>é”™è¯¯ç </th><th>é”™è¯¯åç§°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>30001</td><td>BACKGROUND_IMAGE_LOAD_ERROR</td><td>èƒŒæ™¯å›¾ç‰‡åŠ è½½é”™è¯¯</td></tr><tr><td>30002</td><td>FACE_BIN_LOAD_ERROR</td><td>è¡¨æƒ…æ•°æ®åŠ è½½é”™è¯¯</td></tr><tr><td>30003</td><td>INVALID_BODY_NAME</td><td>æ— æ•ˆçš„èº«ä½“æ•°æ®åç§°</td></tr><tr><td>30004</td><td>VIDEO_DOWNLOAD_ERROR</td><td>è§†é¢‘ä¸‹è½½é”™è¯¯</td></tr></tbody></table><h4 id="æ•°æ®è§£ç é”™è¯¯-40001-40007"><a href="#æ•°æ®è§£ç é”™è¯¯-40001-40007" class="headerlink" title="æ•°æ®è§£ç é”™è¯¯ (40001-40007)"></a>æ•°æ®è§£ç é”™è¯¯ (40001-40007)</h4><table><thead><tr><th>é”™è¯¯ç </th><th>é”™è¯¯åç§°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>40001</td><td>AUDIO_DECODE_ERROR</td><td>éŸ³é¢‘è§£ç é”™è¯¯</td></tr><tr><td>40002</td><td>FACE_DECODE_ERROR</td><td>è¡¨æƒ…è§£ç é”™è¯¯</td></tr><tr><td>40003</td><td>VIDEO_DECODE_ERROR</td><td>è§†é¢‘è§£ç é”™è¯¯</td></tr><tr><td>40004</td><td>EVENT_DECODE_ERROR</td><td>äº‹ä»¶è§£ç é”™è¯¯</td></tr><tr><td>40005</td><td>INVALID_DATA_STRUCTURE</td><td>æ•°æ®ç»“æ„é”™è¯¯</td></tr><tr><td>40006</td><td>TTSA_ERROR</td><td>TTSA æœåŠ¡é”™è¯¯</td></tr><tr><td>40007</td><td>AUDIO_DATA_EXPIRED</td><td>éŸ³é¢‘æ•°æ®è¿‡æœŸ</td></tr></tbody></table><h4 id="ç½‘ç»œé”™è¯¯-50001-50004"><a href="#ç½‘ç»œé”™è¯¯-50001-50004" class="headerlink" title="ç½‘ç»œé”™è¯¯ (50001-50004)"></a>ç½‘ç»œé”™è¯¯ (50001-50004)</h4><table><thead><tr><th>é”™è¯¯ç </th><th>é”™è¯¯åç§°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>50001</td><td>NETWORK_DOWN</td><td>ç½‘ç»œæ–­å¼€</td></tr><tr><td>50002</td><td>NETWORK_UP</td><td>ç½‘ç»œæ¢å¤</td></tr><tr><td>50003</td><td>NETWORK_RETRY</td><td>ç½‘ç»œé‡è¯•</td></tr><tr><td>50004</td><td>NETWORK_BREAK</td><td>ç½‘ç»œè¿æ¥ä¸­æ–­</td></tr></tbody></table><h3 id="é”™è¯¯å¤„ç†ç¤ºä¾‹"><a href="#é”™è¯¯å¤„ç†ç¤ºä¾‹" class="headerlink" title="é”™è¯¯å¤„ç†ç¤ºä¾‹"></a>é”™è¯¯å¤„ç†ç¤ºä¾‹</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> ErrorCode<span class="token punctuation">,</span> SDKError <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@xmov/avatar"</span><span class="token punctuation">;</span><span class="token keyword">try</span> <span class="token punctuation">{</span>  <span class="token keyword">await</span> avatar<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>error <span class="token keyword">instanceof</span> <span class="token class-name">SDKError</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">switch</span> <span class="token punctuation">(</span>error<span class="token punctuation">.</span>code<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">case</span> ErrorCode<span class="token punctuation">.</span>CONTAINER_NOT_FOUND<span class="token punctuation">:</span>        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"å®¹å™¨å…ƒç´ ä¸å­˜åœ¨ï¼Œè¯·æ£€æŸ¥ DOM å…ƒç´ "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>      <span class="token keyword">case</span> ErrorCode<span class="token punctuation">.</span>CONNECT_SOCKET_ERROR<span class="token punctuation">:</span>        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"Socket è¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥æœåŠ¡å™¨åœ°å€"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">break</span><span class="token punctuation">;</span>      <span class="token keyword">default</span><span class="token punctuation">:</span>        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"åˆå§‹åŒ–å¤±è´¥:"</span><span class="token punctuation">,</span> error<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"æœªçŸ¥é”™è¯¯:"</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="ğŸ”-é—®é¢˜æ’æŸ¥æŒ‡å—"><a href="#ğŸ”-é—®é¢˜æ’æŸ¥æŒ‡å—" class="headerlink" title="ğŸ” é—®é¢˜æ’æŸ¥æŒ‡å—"></a>ğŸ” é—®é¢˜æ’æŸ¥æŒ‡å—</h2><h3 id="å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ"><a href="#å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ" class="headerlink" title="å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ"></a>å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ</h3><h4 id="1-åˆå§‹åŒ–å¤±è´¥"><a href="#1-åˆå§‹åŒ–å¤±è´¥" class="headerlink" title="1. åˆå§‹åŒ–å¤±è´¥"></a>1. åˆå§‹åŒ–å¤±è´¥</h4><p><strong>ç°è±¡:</strong></p><ul><li>SDK æ— æ³•æ­£å¸¸åˆå§‹åŒ–</li><li>å®¹å™¨å…ƒç´ ä¸å­˜åœ¨é”™è¯¯</li><li>WebGL åˆå§‹åŒ–å¤±è´¥</li></ul><p><strong>æ’æŸ¥æ­¥éª¤:</strong></p><ol><li><p><strong>æ£€æŸ¥å®¹å™¨å…ƒç´ æ˜¯å¦å­˜åœ¨</strong></p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> container <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"avatar-container"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>container<span class="token punctuation">)</span> <span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"å®¹å™¨å…ƒç´ ä¸å­˜åœ¨"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li><li><p><strong>ç¡®è®¤æµè§ˆå™¨æ”¯æŒ WebGL</strong></p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"canvas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> gl <span class="token operator">=</span>  canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"webgl"</span><span class="token punctuation">)</span> <span class="token operator">||</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"experimental-webgl"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>gl<span class="token punctuation">)</span> <span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"æµè§ˆå™¨ä¸æ”¯æŒ WebGL"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p><strong>æ£€æŸ¥ç½‘ç»œè¿æ¥</strong></p><ul><li>ç¡®è®¤æœåŠ¡å™¨åœ°å€æ­£ç¡®</li><li>æ£€æŸ¥é˜²ç«å¢™è®¾ç½®</li><li>éªŒè¯ WebSocket è¿æ¥æ˜¯å¦å¯ç”¨</li></ul></li><li><p><strong>æŸ¥çœ‹æ§åˆ¶å°é”™è¯¯ä¿¡æ¯</strong></p><ul><li>æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·</li><li>æŸ¥çœ‹ Console é¢æ¿çš„é”™è¯¯ä¿¡æ¯</li><li>æŸ¥çœ‹ Network é¢æ¿çš„ç½‘ç»œè¯·æ±‚</li></ul></li></ol><hr><h4 id="2-èµ„æºåŠ è½½å¤±è´¥"><a href="#2-èµ„æºåŠ è½½å¤±è´¥" class="headerlink" title="2. èµ„æºåŠ è½½å¤±è´¥"></a>2. èµ„æºåŠ è½½å¤±è´¥</h4><p><strong>ç°è±¡:</strong></p><ul><li>è¡¨æƒ…æ•°æ®åŠ è½½å¤±è´¥</li><li>è§†é¢‘ä¸‹è½½å¤±è´¥</li><li>èƒŒæ™¯å›¾ç‰‡åŠ è½½å¤±è´¥</li></ul><p><strong>æ’æŸ¥æ­¥éª¤:</strong></p><ol><li><p><strong>æ£€æŸ¥ç½‘ç»œè¿æ¥</strong></p><ul><li>ç¡®è®¤ç½‘ç»œè¿æ¥æ­£å¸¸</li><li>æ£€æŸ¥æ˜¯å¦æœ‰ä»£ç†è®¾ç½®</li></ul></li><li><p><strong>ç¡®è®¤èµ„æº URL æ­£ç¡®æ€§ï¼ŒæŸ¥çœ‹æ˜¯å¦å­˜åœ¨ 404</strong></p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// æ£€æŸ¥èµ„æº URL</span><span class="token function">fetch</span><span class="token punctuation">(</span>resourceUrl<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>response<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"èµ„æºåŠ è½½å¤±è´¥:"</span><span class="token punctuation">,</span> response<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p><strong>æŸ¥çœ‹æœåŠ¡å™¨å“åº”</strong></p><ul><li>æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦æ­£å¸¸å“åº”</li><li>æŸ¥çœ‹å“åº”å¤´ä¿¡æ¯</li><li>ç¡®è®¤ CORS è®¾ç½®æ­£ç¡®</li></ul></li><li><p><strong>æ£€æŸ¥èµ„æºæ–‡ä»¶æ˜¯å¦å­˜åœ¨</strong></p><ul><li>éªŒè¯æ–‡ä»¶è·¯å¾„</li><li>ç¡®è®¤æ–‡ä»¶æƒé™</li></ul></li><li><p><strong>æ£€æŸ¥æ§åˆ¶å°è¡¨æƒ…æ•°æ®æ˜¯å¦åŠ è½½å¤±è´¥</strong></p><ul><li>æŸ¥çœ‹è°ƒè¯•é¢æ¿çš„èµ„æºåŠ è½½çŠ¶æ€</li><li>æ£€æŸ¥æ˜¯å¦æœ‰é”™è¯¯æ—¥å¿—</li></ul></li></ol><hr><h4 id="3-éŸ³é¢‘æ’­æ”¾é—®é¢˜"><a href="#3-éŸ³é¢‘æ’­æ”¾é—®é¢˜" class="headerlink" title="3. éŸ³é¢‘æ’­æ”¾é—®é¢˜"></a>3. éŸ³é¢‘æ’­æ”¾é—®é¢˜</h4><p><strong>ç°è±¡:</strong></p><ul><li>æ²¡æœ‰å£°éŸ³è¾“å‡º</li><li>éŸ³é¢‘æ’­æ”¾å»¶è¿Ÿ</li><li>éŸ³é¢‘æ•°æ®è¿‡æœŸé”™è¯¯</li></ul><p><strong>æ’æŸ¥æ­¥éª¤:</strong></p><ol><li><p><strong>æ£€æŸ¥æµè§ˆå™¨éŸ³é¢‘æƒé™</strong></p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// æ£€æŸ¥éŸ³é¢‘ä¸Šä¸‹æ–‡çŠ¶æ€</span><span class="token keyword">const</span> audioContext <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AudioContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>audioContext<span class="token punctuation">.</span>state <span class="token operator">===</span> <span class="token string">"suspended"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// éœ€è¦ç”¨æˆ·äº¤äº’æ‰èƒ½æ’­æ”¾éŸ³é¢‘</span>  audioContext<span class="token punctuation">.</span><span class="token function">resume</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p><strong>æ£€æŸ¥éŸ³é¢‘æ•°æ®æ˜¯å¦ä¸‹å‘ï¼Œæ ¹æ®è°ƒè¯•é¢æ¿éŸ³é¢‘ä¸‹å‘ä¿¡æ¯æŸ¥çœ‹</strong></p><ul><li>æ‰“å¼€è°ƒè¯•é¢æ¿</li><li>æŸ¥çœ‹éŸ³é¢‘æ•°æ®æ¥æ”¶çŠ¶æ€</li><li>ç¡®è®¤éŸ³é¢‘æ•°æ®æ ¼å¼æ­£ç¡®</li></ul></li><li><p><strong>æ£€æŸ¥è°ƒè¯•é¢æ¿æ˜¯å¦å­˜åœ¨ï¼ŒéŸ³é¢‘ä¸‹å‘è¿‡æœŸï¼Œè¯¥é”™è¯¯ä¿¡æ¯ä¼šåœ¨éŸ³é¢‘æ•°æ®ä¸‹å‘æ™šäºéŸ³é¢‘æ’­æ”¾æ—¶é—´æ—¶æ‰“å°</strong></p><ul><li>æŸ¥çœ‹è°ƒè¯•é¢æ¿çš„é”™è¯¯ä¿¡æ¯</li><li>æ£€æŸ¥éŸ³é¢‘æ•°æ®çš„æ—¶é—´æˆ³</li><li>ç¡®è®¤éŸ³é¢‘æ•°æ®åŒæ­¥æ­£ç¡®</li></ul></li></ol><hr><h4 id="4-æ¸²æŸ“å¼‚å¸¸"><a href="#4-æ¸²æŸ“å¼‚å¸¸" class="headerlink" title="4. æ¸²æŸ“å¼‚å¸¸"></a>4. æ¸²æŸ“å¼‚å¸¸</h4><p><strong>ç°è±¡:</strong></p><ul><li>æ•°å­—äººä¸æ˜¾ç¤º</li><li>è¡¨æƒ…åŒæ­¥é—®é¢˜</li><li>æ•°å­—äººå¡é¡¿</li></ul><p><strong>æ’æŸ¥æ­¥éª¤:</strong></p><ol><li><p><strong>æ£€æŸ¥ socket æ˜¯å¦è¿æ¥æ­£å¸¸ï¼Œå¯ä»¥åœ¨æ§åˆ¶å°æŸ¥çœ‹æ˜¯å¦æœ‰ä¸Šä¸‹è¡Œæ¶ˆæ¯</strong></p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// ç›‘å¬ Socket æ¶ˆæ¯</span>avatar<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"socketMessage"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"æ”¶åˆ°æ¶ˆæ¯:"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li><li><p><strong>æ£€æŸ¥æœåŠ¡ç«¯æ˜¯å¦ä¸‹å‘ client_quitï¼Œå®¢æˆ·ç«¯æœåŠ¡é€€å‡º</strong></p><ul><li>æŸ¥çœ‹æœåŠ¡ç«¯æ—¥å¿—</li><li>æ£€æŸ¥æ˜¯å¦æœ‰å¼‚å¸¸é€€å‡º</li></ul></li><li><p><strong>æ£€æŸ¥è°ƒè¯•é¢æ¿æ˜¯å¦æœ‰ bodyframe æˆ– faceframe ç¼ºå¤±</strong></p><ul><li>æ‰“å¼€è°ƒè¯•é¢æ¿</li><li>æŸ¥çœ‹æ¸²æŸ“çŠ¶æ€</li><li>ç¡®è®¤æ•°æ®å¸§æ˜¯å¦å®Œæ•´</li></ul></li><li><p><strong>æ£€æŸ¥è§†é¢‘è¯·æ±‚æ˜¯å¦æ­£å¸¸</strong></p><ul><li>æŸ¥çœ‹ Network é¢æ¿</li><li>ç¡®è®¤è§†é¢‘èµ„æºè¯·æ±‚æˆåŠŸ</li><li>æ£€æŸ¥è§†é¢‘æ ¼å¼æ˜¯å¦æ”¯æŒ</li></ul></li><li><p><strong>æŸ¥çœ‹å¡é¡¿è§†é¢‘åŠ¨ä½œæ˜¯å¦æ˜æ˜¾ï¼Œéƒ¨åˆ†è§†é¢‘å¯èƒ½å­˜åœ¨æ— è¾ƒå¤§å¹…åº¦çš„åŠ¨ä½œå¯¼è‡´çœ‹èµ·æ¥å¡é¡¿</strong></p><ul><li>æ£€æŸ¥è§†é¢‘å†…å®¹</li><li>ç¡®è®¤æ˜¯å¦ä¸ºè§†é¢‘æœ¬èº«çš„é—®é¢˜</li><li>å°è¯•æ›´æ¢å…¶ä»–è§†é¢‘æµ‹è¯•</li></ul></li></ol><hr><h4 id="5-ç½‘ç»œè¿æ¥é—®é¢˜"><a href="#5-ç½‘ç»œè¿æ¥é—®é¢˜" class="headerlink" title="5. ç½‘ç»œè¿æ¥é—®é¢˜"></a>5. ç½‘ç»œè¿æ¥é—®é¢˜</h4><p><strong>ç°è±¡:</strong></p><ul><li>WebSocket è¿æ¥å¤±è´¥</li><li>ç½‘ç»œé‡è¯•é¢‘ç¹</li><li>ç¦»çº¿æ¨¡å¼å¼‚å¸¸</li></ul><p><strong>æ’æŸ¥æ­¥éª¤:</strong></p><ol><li><p><strong>æ£€æŸ¥ç½‘ç»œè¿æ¥çŠ¶æ€</strong></p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// æ£€æŸ¥ç½‘ç»œçŠ¶æ€</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>navigator<span class="token punctuation">.</span>onLine<span class="token punctuation">)</span> <span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">"å½“å‰å¤„äºç¦»çº¿çŠ¶æ€"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre></li><li><p><strong>æ£€æŸ¥ä»£ç†é…ç½®</strong></p><ul><li>ç¡®è®¤ä»£ç†è®¾ç½®æ­£ç¡®</li><li>æ£€æŸ¥é˜²ç«å¢™è§„åˆ™</li><li>éªŒè¯ SSL è¯ä¹¦</li></ul></li><li><p><strong>æŸ¥çœ‹ç½‘ç»œé‡è¯•æ—¥å¿—</strong></p><ul><li>æ‰“å¼€è°ƒè¯•é¢æ¿</li><li>æŸ¥çœ‹ç½‘ç»œçŠ¶æ€ä¿¡æ¯</li><li>ç¡®è®¤é‡è¯•ç­–ç•¥æ˜¯å¦æ­£å¸¸</li></ul></li></ol><hr><h2 id="ğŸ› ï¸-è°ƒè¯•å·¥å…·ä½¿ç”¨"><a href="#ğŸ› ï¸-è°ƒè¯•å·¥å…·ä½¿ç”¨" class="headerlink" title="ğŸ› ï¸ è°ƒè¯•å·¥å…·ä½¿ç”¨"></a>ğŸ› ï¸ è°ƒè¯•å·¥å…·ä½¿ç”¨</h2><h3 id="è°ƒè¯•é¢æ¿"><a href="#è°ƒè¯•é¢æ¿" class="headerlink" title="è°ƒè¯•é¢æ¿"></a>è°ƒè¯•é¢æ¿</h3><p>SDK æä¾›äº†å†…ç½®çš„è°ƒè¯•é¢æ¿ï¼Œå¯ä»¥å®æ—¶æŸ¥çœ‹ï¼š</p><h4 id="æ€§èƒ½æŒ‡æ ‡"><a href="#æ€§èƒ½æŒ‡æ ‡" class="headerlink" title="æ€§èƒ½æŒ‡æ ‡"></a>æ€§èƒ½æŒ‡æ ‡</h4><ul><li><strong>FPS (å¸§ç‡)</strong>: å®æ—¶æ˜¾ç¤ºæ¸²æŸ“å¸§ç‡</li><li><strong>å†…å­˜ä½¿ç”¨</strong>: æ˜¾ç¤ºå½“å‰å†…å­˜å ç”¨æƒ…å†µ</li><li><strong>ç½‘ç»œå»¶è¿Ÿ</strong>: æ˜¾ç¤ºç½‘ç»œå¾€è¿”æ—¶é—´ (RTT)</li></ul><h4 id="æ¸²æŸ“çŠ¶æ€"><a href="#æ¸²æŸ“çŠ¶æ€" class="headerlink" title="æ¸²æŸ“çŠ¶æ€"></a>æ¸²æŸ“çŠ¶æ€</h4><ul><li><strong>å½“å‰æ’­æ”¾çš„è§†é¢‘ä¿¡æ¯åŠè§†é¢‘å¯¹åº”çš„ bodyId</strong>: æ˜¾ç¤ºå½“å‰æ¸²æŸ“çš„è§†é¢‘èµ„æº</li><li><strong>ä¸‹å‘çš„éŸ³é¢‘ä¿¡æ¯</strong>: æ˜¾ç¤ºéŸ³é¢‘æ•°æ®çš„æ¥æ”¶å’Œæ’­æ”¾çŠ¶æ€</li><li><strong>ä¸‹å‘çš„äº‹ä»¶æ•°æ®</strong>: æ˜¾ç¤ºäº‹ä»¶æ•°æ®çš„æ¥æ”¶å’Œå¤„ç†æƒ…å†µ</li></ul><h4 id="ç½‘ç»œä¿¡æ¯"><a href="#ç½‘ç»œä¿¡æ¯" class="headerlink" title="ç½‘ç»œä¿¡æ¯"></a>ç½‘ç»œä¿¡æ¯</h4><ul><li><strong>è¿æ¥çŠ¶æ€</strong>: æ˜¾ç¤º WebSocket è¿æ¥çŠ¶æ€</li><li><strong>æ•°æ®ä¼ è¾“é‡</strong>: æ˜¾ç¤ºä¸Šè¡Œå’Œä¸‹è¡Œæ•°æ®é‡</li><li><strong>ç½‘ç»œè´¨é‡</strong>: æ˜¾ç¤ºç½‘ç»œè´¨é‡æŒ‡æ ‡</li></ul><h3 id="å¯ç”¨è°ƒè¯•é¢æ¿"><a href="#å¯ç”¨è°ƒè¯•é¢æ¿" class="headerlink" title="å¯ç”¨è°ƒè¯•é¢æ¿"></a>å¯ç”¨è°ƒè¯•é¢æ¿</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> avatar <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XmovAvatar</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  container<span class="token punctuation">:</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"avatar-container"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  config<span class="token punctuation">:</span> <span class="token punctuation">{</span>    enableDebug<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// å¯ç”¨è°ƒè¯•é¢æ¿</span>    debugPanelPosition<span class="token punctuation">:</span> <span class="token string">"top-right"</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// è°ƒè¯•é¢æ¿ä½ç½®</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è°ƒè¯•-API"><a href="#è°ƒè¯•-API" class="headerlink" title="è°ƒè¯• API"></a>è°ƒè¯• API</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// è·å–æ€§èƒ½æŒ‡æ ‡</span><span class="token keyword">const</span> metrics <span class="token operator">=</span> avatar<span class="token punctuation">.</span><span class="token function">getPerformanceMetrics</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"FPS:"</span><span class="token punctuation">,</span> metrics<span class="token punctuation">.</span>fps<span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Memory:"</span><span class="token punctuation">,</span> metrics<span class="token punctuation">.</span>memory<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// è·å–æ¸²æŸ“çŠ¶æ€</span><span class="token keyword">const</span> renderState <span class="token operator">=</span> avatar<span class="token punctuation">.</span><span class="token function">getRenderState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"å½“å‰è§†é¢‘:"</span><span class="token punctuation">,</span> renderState<span class="token punctuation">.</span>currentVideo<span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"éŸ³é¢‘çŠ¶æ€:"</span><span class="token punctuation">,</span> renderState<span class="token punctuation">.</span>audio<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// è·å–ç½‘ç»œä¿¡æ¯</span><span class="token keyword">const</span> networkInfo <span class="token operator">=</span> avatar<span class="token punctuation">.</span><span class="token function">getNetworkInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"è¿æ¥çŠ¶æ€:"</span><span class="token punctuation">,</span> networkInfo<span class="token punctuation">.</span>connected<span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"ç½‘ç»œè´¨é‡:"</span><span class="token punctuation">,</span> networkInfo<span class="token punctuation">.</span>quality<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="ğŸ“-æ€»ç»“"><a href="#ğŸ“-æ€»ç»“" class="headerlink" title="ğŸ“ æ€»ç»“"></a>ğŸ“ æ€»ç»“</h2><p>æœ‰çµç¦»çº¿æ•°å­—äºº JS-SDK é€šè¿‡åˆ†å±‚æ¶æ„è®¾è®¡ï¼Œå®ç°äº†ï¼š</p><ul><li>âœ… <strong>æ¨¡å—åŒ–è®¾è®¡</strong>: å„æ¨¡å—èŒè´£æ¸…æ™°ï¼Œæ˜“äºç»´æŠ¤å’Œæ‰©å±•</li><li>âœ… <strong>å®Œå–„çš„é”™è¯¯å¤„ç†</strong>: è¯¦ç»†çš„é”™è¯¯ç ä½“ç³»ï¼Œä¾¿äºé—®é¢˜å®šä½</li><li>âœ… <strong>æ™ºèƒ½èµ„æºç®¡ç†</strong>: LRU ç¼“å­˜ç­–ç•¥ï¼Œä¼˜åŒ–èµ„æºåŠ è½½</li><li>âœ… <strong>ç½‘ç»œè‡ªé€‚åº”</strong>: è‡ªåŠ¨æ£€æµ‹ç½‘ç»œçŠ¶æ€ï¼Œæ”¯æŒç¦»çº¿/åœ¨çº¿åˆ‡æ¢</li><li>âœ… <strong>ä¸°å¯Œçš„è°ƒè¯•å·¥å…·</strong>: å†…ç½®è°ƒè¯•é¢æ¿ï¼Œæ–¹ä¾¿å¼€å‘è°ƒè¯•</li></ul><p>é€šè¿‡æœ¬æ–‡æ¡£ï¼Œå¼€å‘è€…å¯ä»¥å¿«é€Ÿäº†è§£ SDK çš„æ¶æ„è®¾è®¡ã€æ ¸å¿ƒæ¨¡å—ã€é”™è¯¯å¤„ç†å’Œé—®é¢˜æ’æŸ¥æ–¹æ³•ï¼Œä»è€Œæ›´å¥½åœ°ä½¿ç”¨å’Œé›†æˆ SDKã€‚</p><hr><h2 id="ğŸ”—-ç›¸å…³èµ„æº"><a href="#ğŸ”—-ç›¸å…³èµ„æº" class="headerlink" title="ğŸ”— ç›¸å…³èµ„æº"></a>ğŸ”— ç›¸å…³èµ„æº</h2><ul><li><a href="./api-docs.md">SDK API æ–‡æ¡£</a></li><li><a href="./quick-start.md">å¿«é€Ÿå¼€å§‹æŒ‡å—</a></li><li><a href="./faq.md">å¸¸è§é—®é¢˜ FAQ</a></li><li><a href="./changelog.md">æ›´æ–°æ—¥å¿—</a></li></ul><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> æ¶æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
            <tag> æ•°å­—äºº </tag>
            
            <tag> å‰ç«¯æ¸²æŸ“ </tag>
            
            <tag> SDKæ¶æ„ </tag>
            
            <tag> WebGL </tag>
            
            <tag> ç³»ç»Ÿæ¶æ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>reactå¸¸è§é—®é¢˜æ±‡æ€»2 ï¼ˆæŒç»­è·Ÿæ–°æ•´ç†....ï¼‰</title>
      <link href="/2025/01/10/reactinterview2/"/>
      <url>/2025/01/10/reactinterview2/</url>
      
        <content type="html"><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/reactreactInterview2/1.png" alt="React.png"></p><h2 id="å…­ã€Redux"><a href="#å…­ã€Redux" class="headerlink" title="å…­ã€Redux"></a>å…­ã€Redux</h2><h3 id="1-å¯¹-Redux-çš„ç†è§£ï¼Œä¸»è¦è§£å†³ä»€ä¹ˆé—®é¢˜"><a href="#1-å¯¹-Redux-çš„ç†è§£ï¼Œä¸»è¦è§£å†³ä»€ä¹ˆé—®é¢˜" class="headerlink" title="1. å¯¹ Redux çš„ç†è§£ï¼Œä¸»è¦è§£å†³ä»€ä¹ˆé—®é¢˜"></a>1. å¯¹ Redux çš„ç†è§£ï¼Œä¸»è¦è§£å†³ä»€ä¹ˆé—®é¢˜</h3><p>React æ˜¯è§†å›¾å±‚æ¡†æ¶ã€‚Redux æ˜¯ä¸€ä¸ªç”¨æ¥ç®¡ç†æ•°æ®çŠ¶æ€å’Œ UI çŠ¶æ€çš„ JavaScript åº”ç”¨å·¥å…·ã€‚éšç€ JavaScript å•é¡µåº”ç”¨ï¼ˆSPAï¼‰å¼€å‘æ—¥è¶‹å¤æ‚ï¼Œ JavaScript éœ€è¦ç®¡ç†æ¯”ä»»ä½•æ—¶å€™éƒ½è¦å¤šçš„ stateï¼ˆçŠ¶æ€ï¼‰ï¼Œ Redux å°±æ˜¯é™ä½ç®¡ç†éš¾åº¦çš„ã€‚ï¼ˆRedux æ”¯æŒ Reactã€Angularã€jQuery ç”šè‡³çº¯ JavaScriptï¼‰ã€‚</p><p>åœ¨ React ä¸­ï¼ŒUI ä»¥ç»„ä»¶çš„å½¢å¼æ¥æ­å»ºï¼Œç»„ä»¶ä¹‹é—´å¯ä»¥åµŒå¥—ç»„åˆã€‚ä½† React ä¸­ç»„ä»¶é—´é€šä¿¡çš„æ•°æ®æµæ˜¯å•å‘çš„ï¼Œé¡¶å±‚ç»„ä»¶å¯ä»¥é€šè¿‡ props å±æ€§å‘ä¸‹å±‚ç»„ä»¶ä¼ é€’æ•°æ®ï¼Œè€Œä¸‹å±‚ç»„ä»¶ä¸èƒ½å‘ä¸Šå±‚ç»„ä»¶ä¼ é€’æ•°æ®ï¼Œå…„å¼Ÿç»„ä»¶ä¹‹é—´åŒæ ·ä¸èƒ½ã€‚è¿™æ ·ç®€å•çš„å•å‘æ•°æ®æµæ”¯æ’‘èµ·äº† React ä¸­çš„æ•°æ®å¯æ§æ€§ã€‚</p><p>å½“é¡¹ç›®è¶Šæ¥è¶Šå¤§çš„æ—¶å€™ï¼Œç®¡ç†æ•°æ®çš„äº‹ä»¶æˆ–å›è°ƒå‡½æ•°å°†è¶Šæ¥è¶Šå¤šï¼Œä¹Ÿå°†è¶Šæ¥è¶Šä¸å¥½ç®¡ç†ã€‚ç®¡ç†ä¸æ–­å˜åŒ–çš„ state éå¸¸å›°éš¾ã€‚å¦‚æœä¸€ä¸ª model çš„å˜åŒ–ä¼šå¼•èµ·å¦ä¸€ä¸ª model å˜åŒ–ï¼Œé‚£ä¹ˆå½“ view å˜åŒ–æ—¶ï¼Œå°±å¯èƒ½å¼•èµ·å¯¹åº” model ä»¥åŠå¦ä¸€ä¸ª model çš„å˜åŒ–ï¼Œä¾æ¬¡åœ°ï¼Œå¯èƒ½ä¼šå¼•èµ·å¦ä¸€ä¸ª view çš„å˜åŒ–ã€‚ç›´è‡³ä½ æä¸æ¸…æ¥šåˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆã€‚state åœ¨ä»€ä¹ˆæ—¶å€™ï¼Œç”±äºä»€ä¹ˆåŸå› ï¼Œå¦‚ä½•å˜åŒ–å·²ç„¶ä¸å—æ§åˆ¶ã€‚ å½“ç³»ç»Ÿå˜å¾—é”™ç»¼å¤æ‚çš„æ—¶å€™ï¼Œæƒ³é‡ç°é—®é¢˜æˆ–è€…æ·»åŠ æ–°åŠŸèƒ½å°±ä¼šå˜å¾—ä¸¾æ­¥ç»´è‰°ã€‚å¦‚æœè¿™è¿˜ä¸å¤Ÿç³Ÿç³•ï¼Œè€ƒè™‘ä¸€äº›æ¥è‡ªå‰ç«¯å¼€å‘é¢†åŸŸçš„æ–°éœ€æ±‚ï¼Œå¦‚æ›´æ–°è°ƒä¼˜ã€æœåŠ¡ç«¯æ¸²æŸ“ã€è·¯ç”±è·³è½¬å‰è¯·æ±‚æ•°æ®ç­‰ã€‚state çš„ç®¡ç†åœ¨å¤§é¡¹ç›®ä¸­ç›¸å½“å¤æ‚ã€‚</p><p>Redux æä¾›äº†ä¸€ä¸ªå« store çš„ç»Ÿä¸€ä»“å‚¨åº“ï¼Œç»„ä»¶é€šè¿‡ dispatch å°† state ç›´æ¥ä¼ å…¥ storeï¼Œä¸ç”¨é€šè¿‡å…¶ä»–çš„ç»„ä»¶ã€‚å¹¶ä¸”ç»„ä»¶é€šè¿‡ subscribe ä» store è·å–åˆ° state çš„æ”¹å˜ã€‚ä½¿ç”¨äº† Reduxï¼Œæ‰€æœ‰çš„ç»„ä»¶éƒ½å¯ä»¥ä» store ä¸­è·å–åˆ°æ‰€éœ€çš„ stateï¼Œä»–ä»¬ä¹Ÿèƒ½ä» store è·å–åˆ° state çš„æ”¹å˜ã€‚è¿™æ¯”ç»„ä»¶ä¹‹é—´äº’ç›¸ä¼ é€’æ•°æ®æ¸…æ™°æ˜æœ—çš„å¤šã€‚</p><p><strong>ä¸»è¦è§£å†³çš„é—®é¢˜ï¼š</strong><br>å•çº¯çš„ Redux åªæ˜¯ä¸€ä¸ªçŠ¶æ€æœºï¼Œæ˜¯æ²¡æœ‰ UI å‘ˆç°çš„ï¼Œreact- redux ä½œç”¨æ˜¯å°† Redux çš„çŠ¶æ€æœºå’Œ React çš„ UI å‘ˆç°ç»‘å®šåœ¨ä¸€èµ·ï¼Œå½“ä½  dispatch action æ”¹å˜ state çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨æ›´æ–°é¡µé¢ã€‚</p><h3 id="2-Redux-åŸç†åŠå·¥ä½œæµç¨‹"><a href="#2-Redux-åŸç†åŠå·¥ä½œæµç¨‹" class="headerlink" title="2. Redux åŸç†åŠå·¥ä½œæµç¨‹"></a>2. Redux åŸç†åŠå·¥ä½œæµç¨‹</h3><p><strong>ï¼ˆ1ï¼‰åŸç†</strong><br>Redux æºç ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ¨¡å—æ–‡ä»¶</p><ul><li>compose.js æä¾›ä»å³åˆ°å·¦è¿›è¡Œå‡½æ•°å¼ç¼–ç¨‹</li><li>createStore.js æä¾›ä½œä¸ºç”Ÿæˆå”¯ä¸€ store çš„å‡½æ•°</li><li>combineReducers.js æä¾›åˆå¹¶å¤šä¸ª reducer çš„å‡½æ•°ï¼Œä¿è¯ store çš„å”¯ä¸€æ€§</li><li>bindActionCreators.js å¯ä»¥è®©å¼€å‘è€…åœ¨ä¸ç›´æ¥æ¥è§¦ dispacth çš„å‰æä¸‹è¿›è¡Œæ›´æ”¹ state çš„æ“ä½œ</li><li>applyMiddleware.js è¿™ä¸ªæ–¹æ³•é€šè¿‡ä¸­é—´ä»¶æ¥å¢å¼º dispatch çš„åŠŸèƒ½</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> actionTypes <span class="token operator">=</span> <span class="token punctuation">{</span>    ADD<span class="token punctuation">:</span> <span class="token string">'ADD'</span><span class="token punctuation">,</span>    CHANGEINFO<span class="token punctuation">:</span> <span class="token string">'CHANGEINFO'</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token keyword">const</span> initState <span class="token operator">=</span> <span class="token punctuation">{</span>    info<span class="token punctuation">:</span> <span class="token string">'åˆå§‹åŒ–'</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">initReducer</span><span class="token punctuation">(</span>state<span class="token operator">=</span>initState<span class="token punctuation">,</span> action<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">switch</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">case</span> actionTypes<span class="token punctuation">.</span>CHANGEINFO<span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token punctuation">{</span>                <span class="token operator">...</span>state<span class="token punctuation">,</span>                info<span class="token punctuation">:</span> action<span class="token punctuation">.</span>preload<span class="token punctuation">.</span>info <span class="token operator">||</span> <span class="token string">''</span><span class="token punctuation">,</span>            <span class="token punctuation">}</span>        <span class="token keyword">default</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token operator">...</span>state <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">createStore</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> initialState<span class="token punctuation">,</span> middleFunc<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>initialState <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> initialState <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        middleFunc <span class="token operator">=</span> initialState<span class="token punctuation">;</span>        initialState <span class="token operator">=</span> undefined<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">let</span> currentState <span class="token operator">=</span> initialState<span class="token punctuation">;</span>    <span class="token keyword">const</span> listeners <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>middleFunc <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> middleFunc <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// å°è£…dispatch</span>        <span class="token keyword">return</span> <span class="token function">middleFunc</span><span class="token punctuation">(</span>createStore<span class="token punctuation">)</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> initialState<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">const</span> getState <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> currentState<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">const</span> dispatch <span class="token operator">=</span> <span class="token punctuation">(</span>action<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>        currentState <span class="token operator">=</span> <span class="token function">reducer</span><span class="token punctuation">(</span>currentState<span class="token punctuation">,</span> action<span class="token punctuation">)</span><span class="token punctuation">;</span>        listeners<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>listener <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>            <span class="token function">listener</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span>    <span class="token keyword">const</span> subscribe <span class="token operator">=</span> <span class="token punctuation">(</span>listener<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>        listeners<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>listener<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token punctuation">{</span>        getState<span class="token punctuation">,</span>        dispatch<span class="token punctuation">,</span>        subscribe    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ï¼ˆ2ï¼‰å·¥ä½œæµç¨‹</strong></p><ul><li>const store= createStoreï¼ˆfnï¼‰ç”Ÿæˆæ•°æ®;</li><li>action: {type: Symble(â€˜action01), payload:â€™payloadâ€™ }å®šä¹‰è¡Œä¸º;</li><li>dispatch å‘èµ· actionï¼šstore.dispatch(doSomething(â€˜action001â€™));</li><li>reducerï¼šå¤„ç† actionï¼Œè¿”å›æ–°çš„ state;</li></ul><p>é€šä¿—ç‚¹è§£é‡Šï¼š</p><ul><li>é¦–å…ˆï¼Œç”¨æˆ·ï¼ˆé€šè¿‡ Viewï¼‰å‘å‡º Actionï¼Œå‘å‡ºæ–¹å¼å°±ç”¨åˆ°äº† dispatch æ–¹æ³•</li><li>ç„¶åï¼ŒStore è‡ªåŠ¨è°ƒç”¨ Reducerï¼Œå¹¶ä¸”ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼šå½“å‰ State å’Œæ”¶åˆ°çš„ Actionï¼ŒReducer ä¼šè¿”å›æ–°çš„ State</li><li>Stateâ€”æ—¦æœ‰å˜åŒ–ï¼ŒStore å°±ä¼šè°ƒç”¨ç›‘å¬å‡½æ•°ï¼Œæ¥æ›´æ–° View</li></ul><p>ä»¥ store ä¸ºæ ¸å¿ƒï¼Œå¯ä»¥æŠŠå®ƒçœ‹æˆæ•°æ®å­˜å‚¨ä¸­å¿ƒï¼Œä½†æ˜¯ä»–è¦æ›´æ”¹æ•°æ®çš„æ—¶å€™ä¸èƒ½ç›´æ¥ä¿®æ”¹ï¼Œæ•°æ®ä¿®æ”¹æ›´æ–°çš„è§’è‰²ç”± Reducers æ¥æ‹…ä»»ï¼Œstore åªåšå­˜å‚¨ï¼Œä¸­é—´äººï¼Œå½“ Reducers çš„æ›´æ–°å®Œæˆä»¥åä¼šé€šè¿‡ store çš„è®¢é˜…æ¥é€šçŸ¥ react componentï¼Œç»„ä»¶æŠŠæ–°çš„çŠ¶æ€é‡æ–°è·å–æ¸²æŸ“ï¼Œç»„ä»¶ä¸­ä¹Ÿèƒ½ä¸»åŠ¨å‘é€ actionï¼Œåˆ›å»º action åè¿™ä¸ªåŠ¨ä½œæ˜¯ä¸ä¼šæ‰§è¡Œçš„ï¼Œæ‰€ä»¥è¦ dispatch è¿™ä¸ª actionï¼Œè®© store é€šè¿‡ reducers å»åšæ›´æ–° React Component å°±æ˜¯ react çš„æ¯ä¸ªç»„ä»¶ã€‚</p><h3 id="3-Redux-ä¸­å¼‚æ­¥çš„è¯·æ±‚æ€ä¹ˆå¤„ç†"><a href="#3-Redux-ä¸­å¼‚æ­¥çš„è¯·æ±‚æ€ä¹ˆå¤„ç†" class="headerlink" title="3. Redux ä¸­å¼‚æ­¥çš„è¯·æ±‚æ€ä¹ˆå¤„ç†"></a>3. Redux ä¸­å¼‚æ­¥çš„è¯·æ±‚æ€ä¹ˆå¤„ç†</h3><p>å¯ä»¥åœ¨ componentDidmount ä¸­ç›´æ¥è¿›â¾è¯·æ±‚â½†é¡»å€ŸåŠ© reduxã€‚ä½†æ˜¯åœ¨â¼€å®šè§„æ¨¡çš„é¡¹â½¬ä¸­,ä¸Šè¿°â½…æ³•å¾ˆéš¾è¿›â¾å¼‚æ­¥æµçš„ç®¡ç†,é€šå¸¸æƒ…å†µä¸‹æˆ‘ä»¬ä¼šå€ŸåŠ© redux çš„å¼‚æ­¥ä¸­é—´ä»¶è¿›â¾å¼‚æ­¥å¤„ç†ã€‚redux å¼‚æ­¥æµä¸­é—´ä»¶å…¶å®æœ‰å¾ˆå¤šï¼Œå½“ä¸‹ä¸»æµçš„å¼‚æ­¥ä¸­é—´ä»¶æœ‰ä¸¤ç§ redux-thunkã€redux-sagaã€‚</p><p><strong>ï¼ˆ1ï¼‰ä½¿ç”¨ react-thunk ä¸­é—´ä»¶</strong></p><p><strong>redux-thunk</strong>ä¼˜ç‚¹:</p><ul><li>ä½“ç§¯â¼©: redux-thunk çš„å®ç°â½…å¼å¾ˆç®€å•,åªæœ‰ä¸åˆ° 20 â¾ä»£ç </li><li>ä½¿â½¤ç®€å•: redux-thunk æ²¡æœ‰å¼•â¼Šåƒ redux-saga æˆ–è€… redux-observable é¢å¤–çš„èŒƒå¼,ä¸Šâ¼¿ç®€å•</li></ul><p><strong>redux-thunk</strong>ç¼ºé™·:</p><ul><li>æ ·æ¿ä»£ç è¿‡å¤š: ä¸ redux æœ¬èº«â¼€æ ·,é€šå¸¸â¼€ä¸ªè¯·æ±‚éœ€è¦â¼¤é‡çš„ä»£ç ,â½½ä¸”å¾ˆå¤šéƒ½æ˜¯é‡å¤æ€§è´¨çš„</li><li>è€¦åˆä¸¥é‡: å¼‚æ­¥æ“ä½œä¸ redux çš„ action å¶åˆåœ¨â¼€èµ·,ä¸â½…ä¾¿ç®¡ç†</li><li>åŠŸèƒ½å­±å¼±: æœ‰â¼€äº›å®é™…å¼€å‘ä¸­å¸¸â½¤çš„åŠŸèƒ½éœ€è¦â¾ƒâ¼°è¿›â¾å°è£…</li></ul><p>ä½¿ç”¨æ­¥éª¤ï¼š</p><ul><li>é…ç½®ä¸­é—´ä»¶ï¼Œåœ¨ store çš„åˆ›å»ºä¸­é…ç½®</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> createStore<span class="token punctuation">,</span> applyMiddleware<span class="token punctuation">,</span> compose <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"redux"</span><span class="token punctuation">;</span><span class="token keyword">import</span> reducer <span class="token keyword">from</span> <span class="token string">"./reducer"</span><span class="token punctuation">;</span><span class="token keyword">import</span> thunk <span class="token keyword">from</span> <span class="token string">"redux-thunk"</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// è®¾ç½®è°ƒè¯•å·¥å…·</span><span class="token keyword">const</span> composeEnhancers <span class="token operator">=</span> window<span class="token punctuation">.</span>__REDUX_DEVTOOLS_EXTENSION_COMPOSE__  <span class="token operator">?</span> window<span class="token punctuation">.</span><span class="token function">__REDUX_DEVTOOLS_EXTENSION_COMPOSE__</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token punctuation">:</span> compose<span class="token punctuation">;</span><span class="token comment" spellcheck="true">// è®¾ç½®ä¸­é—´ä»¶</span><span class="token keyword">const</span> enhancer <span class="token operator">=</span> <span class="token function">composeEnhancers</span><span class="token punctuation">(</span><span class="token function">applyMiddleware</span><span class="token punctuation">(</span>thunk<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> enhancer<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">export</span> <span class="token keyword">default</span> store<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>æ·»åŠ ä¸€ä¸ªè¿”å›å‡½æ•°çš„ actionCreatorï¼Œå°†å¼‚æ­¥è¯·æ±‚é€»è¾‘æ”¾åœ¨é‡Œé¢</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">/**  å‘é€getè¯·æ±‚ï¼Œå¹¶ç”Ÿæˆç›¸åº”actionï¼Œæ›´æ–°storeçš„å‡½æ•°  @param url {string} è¯·æ±‚åœ°å€  @param func {function} çœŸæ­£éœ€è¦ç”Ÿæˆçš„actionå¯¹åº”çš„actionCreator  @return {function} */</span><span class="token comment" spellcheck="true">// dispatchä¸ºè‡ªåŠ¨æ¥æ”¶çš„store.dispatchå‡½æ•°</span><span class="token keyword">export</span> <span class="token keyword">const</span> getHttpAction <span class="token operator">=</span> <span class="token punctuation">(</span>url<span class="token punctuation">,</span> func<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">(</span>dispatch<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> action <span class="token operator">=</span> <span class="token function">func</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">dispatch</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>ç”Ÿæˆ actionï¼Œå¹¶å‘é€ action</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">var</span> action <span class="token operator">=</span> <span class="token function">getHttpAction</span><span class="token punctuation">(</span><span class="token string">'/getData'</span><span class="token punctuation">,</span> getInitTodoItemAction<span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">// å‘é€å‡½æ•°ç±»å‹çš„actionæ—¶ï¼Œè¯¥actionçš„å‡½æ•°ä½“ä¼šè‡ªåŠ¨æ‰§è¡Œ</span>    store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ï¼ˆ2ï¼‰ä½¿ç”¨ redux-saga ä¸­é—´ä»¶</strong></p><p><strong>redux-saga</strong>ä¼˜ç‚¹:</p><ul><li>å¼‚æ­¥è§£è€¦: å¼‚æ­¥æ“ä½œè¢«è¢«è½¬ç§»åˆ°å•ç‹¬ saga.js ä¸­ï¼Œä¸å†æ˜¯æºæ‚åœ¨ action.js æˆ– component.js ä¸­</li><li>action æ‘†è„± thunk function: dispatch çš„å‚æ•°ä¾ç„¶æ˜¯â¼€ä¸ªçº¯ç²¹çš„ action (FSA)ï¼Œâ½½ä¸æ˜¯å……æ»¡ â€œâ¿Šé­”æ³•â€ thunk function</li><li>å¼‚å¸¸å¤„ç†: å—ç›Šäº generator function çš„ saga å®ç°ï¼Œä»£ç å¼‚å¸¸/è¯·æ±‚å¤±è´¥ éƒ½å¯ä»¥ç›´æ¥é€šè¿‡ try/catch è¯­æ³•ç›´æ¥æ•è·å¤„ç†</li><li>åŠŸèƒ½å¼ºâ¼¤: redux-saga æä¾›äº†â¼¤é‡çš„ Saga è¾…åŠ©å‡½æ•°å’Œ Effect åˆ›å»ºå™¨ä¾›å¼€å‘è€…ä½¿â½¤,å¼€å‘è€…â½†é¡»å°è£…æˆ–è€…ç®€å•å°è£…å³å¯ä½¿â½¤</li><li>çµæ´»: redux-saga å¯ä»¥å°†å¤šä¸ª Saga å¯ä»¥ä¸²â¾/å¹¶â¾ç»„åˆèµ·æ¥,å½¢æˆâ¼€ä¸ªâ¾®å¸¸å®â½¤çš„å¼‚æ­¥ flow</li><li>æ˜“æµ‹è¯•ï¼Œæä¾›äº†å„ç§ case çš„æµ‹è¯•â½…æ¡ˆï¼ŒåŒ…æ‹¬ mock taskï¼Œåˆ†â½€è¦†ç›–ç­‰ç­‰</li></ul><p><strong>redux-saga</strong>ç¼ºé™·:</p><ul><li>é¢å¤–çš„å­¦ä¹ æˆæœ¬: redux-saga ä¸ä»…åœ¨ä½¿â½¤éš¾ä»¥ç†è§£çš„ generator function,â½½ä¸”æœ‰æ•°â¼—ä¸ª API,å­¦ä¹ æˆæœ¬è¿œè¶… redux-thunk,æœ€é‡è¦çš„æ˜¯ä½ çš„é¢å¤–å­¦ä¹ æˆæœ¬æ˜¯åªæœåŠ¡äºè¿™ä¸ªåº“çš„,ä¸ redux-observable ä¸åŒ,redux-observable è™½ç„¶ä¹Ÿæœ‰é¢å¤–å­¦ä¹ æˆæœ¬ä½†æ˜¯èƒŒåæ˜¯ rxjs å’Œâ¼€æ•´å¥—æ€æƒ³</li><li>ä½“ç§¯åºâ¼¤: ä½“ç§¯ç•¥â¼¤,ä»£ç è¿‘ 2000 â¾ï¼Œmin ç‰ˆ 25KB å·¦å³</li><li>åŠŸèƒ½è¿‡å‰©: å®é™…ä¸Šå¹¶å‘æ§åˆ¶ç­‰åŠŸèƒ½å¾ˆéš¾â½¤åˆ°,ä½†æ˜¯æˆ‘ä»¬ä¾ç„¶éœ€è¦å¼•â¼Šè¿™äº›ä»£ç </li><li>ts â½€æŒä¸å‹å¥½: yield â½†æ³•è¿”å› TS ç±»å‹</li></ul><p>redux-saga å¯ä»¥æ•è· actionï¼Œç„¶åæ‰§è¡Œä¸€ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆå¯ä»¥æŠŠå¼‚æ­¥ä»£ç æ”¾åœ¨è¿™ä¸ªå‡½æ•°ä¸­ï¼Œä½¿ç”¨æ­¥éª¤å¦‚ä¸‹ï¼š</p><ul><li>é…ç½®ä¸­é—´ä»¶</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> createStore<span class="token punctuation">,</span> applyMiddleware<span class="token punctuation">,</span> compose <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"redux"</span><span class="token punctuation">;</span><span class="token keyword">import</span> reducer <span class="token keyword">from</span> <span class="token string">"./reducer"</span><span class="token punctuation">;</span><span class="token keyword">import</span> createSagaMiddleware <span class="token keyword">from</span> <span class="token string">"redux-saga"</span><span class="token punctuation">;</span><span class="token keyword">import</span> TodoListSaga <span class="token keyword">from</span> <span class="token string">"./sagas"</span><span class="token punctuation">;</span><span class="token keyword">const</span> composeEnhancers <span class="token operator">=</span> window<span class="token punctuation">.</span>__REDUX_DEVTOOLS_EXTENSION_COMPOSE__  <span class="token operator">?</span> window<span class="token punctuation">.</span><span class="token function">__REDUX_DEVTOOLS_EXTENSION_COMPOSE__</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token punctuation">:</span> compose<span class="token punctuation">;</span><span class="token keyword">const</span> sagaMiddleware <span class="token operator">=</span> <span class="token function">createSagaMiddleware</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> enhancer <span class="token operator">=</span> <span class="token function">composeEnhancers</span><span class="token punctuation">(</span><span class="token function">applyMiddleware</span><span class="token punctuation">(</span>sagaMiddleware<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> enhancer<span class="token punctuation">)</span><span class="token punctuation">;</span>sagaMiddleware<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>TodoListSaga<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">export</span> <span class="token keyword">default</span> store<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>å°†å¼‚æ­¥è¯·æ±‚æ”¾åœ¨ sagas.js ä¸­</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> takeEvery<span class="token punctuation">,</span> put <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"redux-saga/effects"</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span> initTodoList <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./actionCreator"</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span> GET_INIT_ITEM <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./actionTypes"</span><span class="token punctuation">;</span><span class="token keyword">import</span> axios <span class="token keyword">from</span> <span class="token string">"axios"</span><span class="token punctuation">;</span><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">try</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// å¯ä»¥è·å–å¼‚æ­¥è¿”å›æ•°æ®</span>    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">yield</span> axios<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">"/getData"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> action <span class="token operator">=</span> <span class="token function">initTodoList</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// å°†actionå‘é€åˆ°reducer</span>    <span class="token keyword">yield</span> <span class="token function">put</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"ç½‘ç»œè¯·æ±‚å¤±è´¥"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">mySaga</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// è‡ªåŠ¨æ•è·GET_INIT_ITEMç±»å‹çš„actionï¼Œå¹¶æ‰§è¡Œfunc</span>  <span class="token keyword">yield</span> <span class="token function">takeEvery</span><span class="token punctuation">(</span>GET_INIT_ITEM<span class="token punctuation">,</span> func<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> mySaga<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>å‘é€ action</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">const</span> action <span class="token operator">=</span> <span class="token function">getInitTodoItemAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-Redux-æ€ä¹ˆå®ç°å±æ€§ä¼ é€’ï¼Œä»‹ç»ä¸‹åŸç†"><a href="#4-Redux-æ€ä¹ˆå®ç°å±æ€§ä¼ é€’ï¼Œä»‹ç»ä¸‹åŸç†" class="headerlink" title="4. Redux æ€ä¹ˆå®ç°å±æ€§ä¼ é€’ï¼Œä»‹ç»ä¸‹åŸç†"></a>4. Redux æ€ä¹ˆå®ç°å±æ€§ä¼ é€’ï¼Œä»‹ç»ä¸‹åŸç†</h3><p>react-redux æ•°æ®ä¼ è¾“ âˆ¶ viewâ€“&gt;actionâ€“&gt;reducerâ€“&gt;storeâ€“&gt;viewã€‚çœ‹ä¸‹ç‚¹å‡»äº‹ä»¶çš„æ•°æ®æ˜¯å¦‚ä½•é€šè¿‡ redux ä¼ åˆ° view ä¸Šï¼š</p><ul><li>view ä¸Šçš„ AddClick äº‹ä»¶é€šè¿‡ mapDispatchToProps æŠŠæ•°æ®ä¼ åˆ° action â€”&gt; click:()=&gt;dispatch(ADD)</li><li>action çš„ ADD ä¼ åˆ° reducer ä¸Š</li><li>reducer ä¼ åˆ° store ä¸Š const store = createStore(reducer);</li><li>store å†é€šè¿‡ mapStateToProps æ˜ å°„ç©¿åˆ° view ä¸Š text:State.text</li></ul><p>ä»£ç ç¤ºä¾‹ âˆ¶</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span><span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">"react-dom"</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span> createStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"redux"</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span> Provider<span class="token punctuation">,</span> connect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react-redux"</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">let</span> <span class="token punctuation">{</span> text<span class="token punctuation">,</span> click<span class="token punctuation">,</span> clickR <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>div<span class="token operator">></span>        <span class="token operator">&lt;</span>div<span class="token operator">></span>æ•°æ®<span class="token punctuation">:</span>å·²æœ‰äºº<span class="token punctuation">{</span>text<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>        <span class="token operator">&lt;</span>div onClick<span class="token operator">=</span><span class="token punctuation">{</span>click<span class="token punctuation">}</span><span class="token operator">></span>åŠ äºº<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>        <span class="token operator">&lt;</span>div onClick<span class="token operator">=</span><span class="token punctuation">{</span>clickR<span class="token punctuation">}</span><span class="token operator">></span>å‡äºº<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">const</span> initialState <span class="token operator">=</span> <span class="token punctuation">{</span>  text<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">const</span> reducer <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>state<span class="token punctuation">,</span> action<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">case</span> <span class="token string">"ADD"</span><span class="token punctuation">:</span>      <span class="token keyword">return</span> <span class="token punctuation">{</span> text<span class="token punctuation">:</span> state<span class="token punctuation">.</span>text <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">case</span> <span class="token string">"REMOVE"</span><span class="token punctuation">:</span>      <span class="token keyword">return</span> <span class="token punctuation">{</span> text<span class="token punctuation">:</span> state<span class="token punctuation">.</span>text <span class="token operator">-</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">default</span><span class="token punctuation">:</span>      <span class="token keyword">return</span> initialState<span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">let</span> ADD <span class="token operator">=</span> <span class="token punctuation">{</span>  type<span class="token punctuation">:</span> <span class="token string">"ADD"</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">let</span> Remove <span class="token operator">=</span> <span class="token punctuation">{</span>  type<span class="token punctuation">:</span> <span class="token string">"REMOVE"</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>reducer<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">let</span> mapStateToProps <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token punctuation">{</span>    text<span class="token punctuation">:</span> state<span class="token punctuation">.</span>text<span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">let</span> mapDispatchToProps <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>dispatch<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token punctuation">{</span>    click<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token function">dispatch</span><span class="token punctuation">(</span>ADD<span class="token punctuation">)</span><span class="token punctuation">,</span>    clickR<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token function">dispatch</span><span class="token punctuation">(</span>Remove<span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">const</span> App1 <span class="token operator">=</span> <span class="token function">connect</span><span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">,</span> mapDispatchToProps<span class="token punctuation">)</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">;</span>ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>  <span class="token operator">&lt;</span>Provider store<span class="token operator">=</span><span class="token punctuation">{</span>store<span class="token punctuation">}</span><span class="token operator">></span>    <span class="token operator">&lt;</span>App1<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>App1<span class="token operator">></span>  <span class="token operator">&lt;</span><span class="token operator">/</span>Provider<span class="token operator">></span><span class="token punctuation">,</span>  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-Redux-ä¸­é—´ä»¶æ˜¯ä»€ä¹ˆï¼Ÿæ¥å—å‡ ä¸ªå‚æ•°ï¼ŸæŸ¯é‡ŒåŒ–å‡½æ•°ä¸¤ç«¯çš„å‚æ•°å…·ä½“æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#5-Redux-ä¸­é—´ä»¶æ˜¯ä»€ä¹ˆï¼Ÿæ¥å—å‡ ä¸ªå‚æ•°ï¼ŸæŸ¯é‡ŒåŒ–å‡½æ•°ä¸¤ç«¯çš„å‚æ•°å…·ä½“æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="5. Redux ä¸­é—´ä»¶æ˜¯ä»€ä¹ˆï¼Ÿæ¥å—å‡ ä¸ªå‚æ•°ï¼ŸæŸ¯é‡ŒåŒ–å‡½æ•°ä¸¤ç«¯çš„å‚æ•°å…·ä½“æ˜¯ä»€ä¹ˆï¼Ÿ"></a>5. Redux ä¸­é—´ä»¶æ˜¯ä»€ä¹ˆï¼Ÿæ¥å—å‡ ä¸ªå‚æ•°ï¼ŸæŸ¯é‡ŒåŒ–å‡½æ•°ä¸¤ç«¯çš„å‚æ•°å…·ä½“æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>Redux çš„ä¸­é—´ä»¶æä¾›çš„æ˜¯ä½äº action è¢«å‘èµ·ä¹‹åï¼Œåˆ°è¾¾ reducer ä¹‹å‰çš„æ‰©å±•ç‚¹ï¼Œæ¢è€Œè¨€ä¹‹ï¼ŒåŸæœ¬ view -â†’&gt; action -&gt; reducer -&gt; store çš„æ•°æ®æµåŠ ä¸Šä¸­é—´ä»¶åå˜æˆäº† view -&gt; action -&gt; middleware -&gt; reducer -&gt; store ï¼Œåœ¨è¿™ä¸€ç¯èŠ‚å¯ä»¥åšä¸€äº›â€å‰¯ä½œç”¨â€çš„æ“ä½œï¼Œå¦‚å¼‚æ­¥è¯·æ±‚ã€æ‰“å°æ—¥å¿—ç­‰ã€‚</p><p>applyMiddleware æºç ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">applyMiddleware</span><span class="token punctuation">(</span><span class="token operator">...</span>middlewares<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>createStore<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span>    <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>      <span class="token comment" spellcheck="true">// åˆ©ç”¨ä¼ å…¥çš„createStoreå’Œreducerå’Œåˆ›å»ºä¸€ä¸ªstore</span>      <span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">let</span> dispatch <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span><span class="token punctuation">;</span>      <span class="token keyword">const</span> middlewareAPI <span class="token operator">=</span> <span class="token punctuation">{</span>        getState<span class="token punctuation">:</span> store<span class="token punctuation">.</span>getState<span class="token punctuation">,</span>        dispatch<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">,</span>      <span class="token punctuation">}</span><span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">// è®©æ¯ä¸ª middleware å¸¦ç€ middlewareAPI è¿™ä¸ªå‚æ•°åˆ†åˆ«æ‰§è¡Œä¸€é</span>      <span class="token keyword">const</span> chain <span class="token operator">=</span> middlewares<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>middleware<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token function">middleware</span><span class="token punctuation">(</span>middlewareAPI<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">// æ¥ç€ compose å°† chain ä¸­çš„æ‰€æœ‰åŒ¿åå‡½æ•°ï¼Œç»„è£…æˆä¸€ä¸ªæ–°çš„å‡½æ•°ï¼Œå³æ–°çš„ dispatch</span>      dispatch <span class="token operator">=</span> <span class="token function">compose</span><span class="token punctuation">(</span><span class="token operator">...</span>chain<span class="token punctuation">)</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>dispatch<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">return</span> <span class="token punctuation">{</span>        <span class="token operator">...</span>store<span class="token punctuation">,</span>        dispatch<span class="token punctuation">,</span>      <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä» applyMiddleware ä¸­å¯ä»¥çœ‹å‡º âˆ¶</p><ul><li>redux ä¸­é—´ä»¶æ¥å—ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œå¯¹è±¡çš„å‚æ•°ä¸Šæœ‰ä¸¤ä¸ªå­—æ®µ dispatch å’Œ getStateï¼Œåˆ†åˆ«ä»£è¡¨ç€ Redux Store ä¸Šçš„ä¸¤ä¸ªåŒåå‡½æ•°ã€‚</li><li>æŸ¯é‡ŒåŒ–å‡½æ•°ä¸¤ç«¯ä¸€ä¸ªæ˜¯ middewaresï¼Œä¸€ä¸ªæ˜¯ store.dispatch</li></ul><h3 id="6-Redux-è¯·æ±‚ä¸­é—´ä»¶å¦‚ä½•å¤„ç†å¹¶å‘"><a href="#6-Redux-è¯·æ±‚ä¸­é—´ä»¶å¦‚ä½•å¤„ç†å¹¶å‘" class="headerlink" title="6. Redux è¯·æ±‚ä¸­é—´ä»¶å¦‚ä½•å¤„ç†å¹¶å‘"></a>6. Redux è¯·æ±‚ä¸­é—´ä»¶å¦‚ä½•å¤„ç†å¹¶å‘</h3><p><strong>ä½¿ç”¨ redux-Saga</strong><br>redux-saga æ˜¯ä¸€ä¸ªç®¡ç† redux åº”ç”¨å¼‚æ­¥æ“ä½œçš„ä¸­é—´ä»¶ï¼Œç”¨äºä»£æ›¿ redux-thunk çš„ã€‚å®ƒé€šè¿‡åˆ›å»º Sagas å°†æ‰€æœ‰å¼‚æ­¥æ“ä½œé€»è¾‘å­˜æ”¾åœ¨ä¸€ä¸ªåœ°æ–¹è¿›è¡Œé›†ä¸­å¤„ç†ï¼Œä»¥æ­¤å°† react ä¸­çš„åŒæ­¥æ“ä½œä¸å¼‚æ­¥æ“ä½œåŒºåˆ†å¼€æ¥ï¼Œä»¥ä¾¿äºåæœŸçš„ç®¡ç†ä¸ç»´æŠ¤ã€‚ redux-saga å¦‚ä½•å¤„ç†å¹¶å‘ï¼š</p><ul><li><strong>takeEvery</strong></li></ul><p>å¯ä»¥è®©å¤šä¸ª saga ä»»åŠ¡å¹¶è¡Œè¢« fork æ‰§è¡Œã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> fork<span class="token punctuation">,</span> take <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"redux-saga/effects"</span><span class="token punctuation">;</span><span class="token keyword">const</span> takeEvery <span class="token operator">=</span> <span class="token punctuation">(</span>pattern<span class="token punctuation">,</span> saga<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span>  <span class="token function">fork</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">const</span> action <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">take</span><span class="token punctuation">(</span>pattern<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">yield</span> <span class="token function">fork</span><span class="token punctuation">(</span>saga<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>takeLatest</strong></li></ul><p>takeLatest ä¸å…è®¸å¤šä¸ª saga ä»»åŠ¡å¹¶è¡Œåœ°æ‰§è¡Œã€‚ä¸€æ—¦æ¥æ”¶åˆ°æ–°çš„å‘èµ·çš„ actionï¼Œå®ƒå°±ä¼šå–æ¶ˆå‰é¢æ‰€æœ‰ fork è¿‡çš„ä»»åŠ¡ï¼ˆå¦‚æœè¿™äº›ä»»åŠ¡è¿˜åœ¨æ‰§è¡Œçš„è¯ï¼‰ã€‚<br>åœ¨å¤„ç† AJAX è¯·æ±‚çš„æ—¶å€™ï¼Œå¦‚æœåªå¸Œæœ›è·å–æœ€åé‚£ä¸ªè¯·æ±‚çš„å“åº”ï¼Œ takeLatest å°±ä¼šéå¸¸æœ‰ç”¨ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> cancel<span class="token punctuation">,</span> fork<span class="token punctuation">,</span> take <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"redux-saga/effects"</span><span class="token punctuation">;</span><span class="token keyword">const</span> takeLatest <span class="token operator">=</span> <span class="token punctuation">(</span>pattern<span class="token punctuation">,</span> saga<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span>  <span class="token function">fork</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">let</span> lastTask<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">const</span> action <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">take</span><span class="token punctuation">(</span>pattern<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>lastTask<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">yield</span> <span class="token function">cancel</span><span class="token punctuation">(</span>lastTask<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// å¦‚æœä»»åŠ¡å·²ç»ç»“æŸï¼Œåˆ™ cancel ä¸ºç©ºæ“ä½œ</span>      <span class="token punctuation">}</span>      lastTask <span class="token operator">=</span> <span class="token keyword">yield</span> <span class="token function">fork</span><span class="token punctuation">(</span>saga<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>action<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="7-Redux-çŠ¶æ€ç®¡ç†å™¨å’Œå˜é‡æŒ‚è½½åˆ°-window-ä¸­æœ‰ä»€ä¹ˆåŒºåˆ«"><a href="#7-Redux-çŠ¶æ€ç®¡ç†å™¨å’Œå˜é‡æŒ‚è½½åˆ°-window-ä¸­æœ‰ä»€ä¹ˆåŒºåˆ«" class="headerlink" title="7. Redux çŠ¶æ€ç®¡ç†å™¨å’Œå˜é‡æŒ‚è½½åˆ° window ä¸­æœ‰ä»€ä¹ˆåŒºåˆ«"></a>7. Redux çŠ¶æ€ç®¡ç†å™¨å’Œå˜é‡æŒ‚è½½åˆ° window ä¸­æœ‰ä»€ä¹ˆåŒºåˆ«</h3><p>ä¸¤è€…éƒ½æ˜¯å­˜å‚¨æ•°æ®ä»¥ä¾›åæœŸä½¿ç”¨ã€‚ä½†æ˜¯ Redux çŠ¶æ€æ›´æ”¹å¯å›æº¯â€”â€”Time travelï¼Œæ•°æ®å¤šäº†çš„æ—¶å€™å¯ä»¥å¾ˆæ¸…æ™°çš„çŸ¥é“æ”¹åŠ¨åœ¨å“ªé‡Œå‘ç”Ÿï¼Œå®Œæ•´çš„æä¾›äº†ä¸€å¥—çŠ¶æ€ç®¡ç†æ¨¡å¼ã€‚</p><p>éšç€ JavaScript å•é¡µåº”ç”¨å¼€å‘æ—¥è¶‹å¤æ‚ï¼ŒJavaScript éœ€è¦ç®¡ç†æ¯”ä»»ä½•æ—¶å€™éƒ½è¦å¤šçš„ state ï¼ˆçŠ¶æ€ï¼‰ã€‚ è¿™äº› state å¯èƒ½åŒ…æ‹¬æœåŠ¡å™¨å“åº”ã€ç¼“å­˜æ•°æ®ã€æœ¬åœ°ç”Ÿæˆå°šæœªæŒä¹…åŒ–åˆ°æœåŠ¡å™¨çš„æ•°æ®ï¼Œä¹ŸåŒ…æ‹¬ UI çŠ¶æ€ï¼Œå¦‚æ¿€æ´»çš„è·¯ç”±ï¼Œè¢«é€‰ä¸­çš„æ ‡ç­¾ï¼Œæ˜¯å¦æ˜¾ç¤ºåŠ è½½åŠ¨æ•ˆæˆ–è€…åˆ†é¡µå™¨ç­‰ç­‰ã€‚</p><p>ç®¡ç†ä¸æ–­å˜åŒ–çš„ state éå¸¸å›°éš¾ã€‚å¦‚æœä¸€ä¸ª model çš„å˜åŒ–ä¼šå¼•èµ·å¦ä¸€ä¸ª model å˜åŒ–ï¼Œé‚£ä¹ˆå½“ view å˜åŒ–æ—¶ï¼Œå°±å¯èƒ½å¼•èµ·å¯¹åº” model ä»¥åŠå¦ä¸€ä¸ª model çš„å˜åŒ–ï¼Œä¾æ¬¡åœ°ï¼Œå¯èƒ½ä¼šå¼•èµ·å¦ä¸€ä¸ª view çš„å˜åŒ–ã€‚ç›´è‡³ä½ æä¸æ¸…æ¥šåˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆã€‚state åœ¨ä»€ä¹ˆæ—¶å€™ï¼Œç”±äºä»€ä¹ˆåŸå› ï¼Œå¦‚ä½•å˜åŒ–å·²ç„¶ä¸å—æ§åˆ¶ã€‚ å½“ç³»ç»Ÿå˜å¾—é”™ç»¼å¤æ‚çš„æ—¶å€™ï¼Œæƒ³é‡ç°é—®é¢˜æˆ–è€…æ·»åŠ æ–°åŠŸèƒ½å°±ä¼šå˜å¾—ä¸¾æ­¥ç»´è‰°ã€‚<br>å¦‚æœè¿™è¿˜ä¸å¤Ÿç³Ÿç³•ï¼Œè€ƒè™‘ä¸€äº›æ¥è‡ªå‰ç«¯å¼€å‘é¢†åŸŸçš„æ–°éœ€æ±‚ï¼Œå¦‚æ›´æ–°è°ƒä¼˜ã€æœåŠ¡ç«¯æ¸²æŸ“ã€è·¯ç”±è·³è½¬å‰è¯·æ±‚æ•°æ®ç­‰ç­‰ã€‚å‰ç«¯å¼€å‘è€…æ­£åœ¨ç»å—å‰æ‰€æœªæœ‰çš„å¤æ‚æ€§ï¼Œéš¾é“å°±è¿™ä¹ˆæ”¾å¼ƒäº†å—?å½“ç„¶ä¸æ˜¯ã€‚</p><p>è¿™é‡Œçš„å¤æ‚æ€§å¾ˆå¤§ç¨‹åº¦ä¸Šæ¥è‡ªäºï¼šæˆ‘ä»¬æ€»æ˜¯å°†ä¸¤ä¸ªéš¾ä»¥ç†æ¸…çš„æ¦‚å¿µæ··æ·†åœ¨ä¸€èµ·ï¼šå˜åŒ–å’Œå¼‚æ­¥ã€‚ å¯ä»¥ç§°å®ƒä»¬ä¸ºæ›¼å¦¥æ€å’Œå¯ä¹ã€‚å¦‚æœæŠŠäºŒè€…åˆ†å¼€ï¼Œèƒ½åšçš„å¾ˆå¥½ï¼Œä½†æ··åˆ°ä¸€èµ·ï¼Œå°±å˜å¾—ä¸€å›¢ç³Ÿã€‚ä¸€äº›åº“å¦‚ React è§†å›¾åœ¨è§†å›¾å±‚ç¦æ­¢å¼‚æ­¥å’Œç›´æ¥æ“ä½œ DOM æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ç¾ä¸­ä¸è¶³çš„æ˜¯ï¼ŒReact ä¾æ—§æŠŠå¤„ç† state ä¸­æ•°æ®çš„é—®é¢˜ç•™ç»™äº†ä½ ã€‚Redux å°±æ˜¯ä¸ºäº†å¸®ä½ è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><h3 id="8-mobox-å’Œ-redux-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#8-mobox-å’Œ-redux-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="8. mobox å’Œ redux æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>8. mobox å’Œ redux æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p><strong>ï¼ˆ1ï¼‰å…±åŒç‚¹</strong></p><ul><li>ä¸ºäº†è§£å†³çŠ¶æ€ç®¡ç†æ··ä¹±ï¼Œæ— æ³•æœ‰æ•ˆåŒæ­¥çš„é—®é¢˜ç»Ÿä¸€ç»´æŠ¤ç®¡ç†åº”ç”¨çŠ¶æ€;</li><li>æŸä¸€çŠ¶æ€åªæœ‰ä¸€ä¸ªå¯ä¿¡æ•°æ®æ¥æºï¼ˆé€šå¸¸å‘½åä¸º storeï¼ŒæŒ‡çŠ¶æ€å®¹å™¨ï¼‰;</li><li>æ“ä½œæ›´æ–°çŠ¶æ€æ–¹å¼ç»Ÿä¸€ï¼Œå¹¶ä¸”å¯æ§ï¼ˆé€šå¸¸ä»¥ action æ–¹å¼æä¾›æ›´æ–°çŠ¶æ€çš„é€”å¾„ï¼‰;</li><li>æ”¯æŒå°† store ä¸ React ç»„ä»¶è¿æ¥ï¼Œå¦‚ react-reduxï¼Œmobx- react;</li></ul><p><strong>ï¼ˆ2ï¼‰åŒºåˆ«</strong><br>Redux æ›´å¤šçš„æ˜¯éµå¾ª Flux æ¨¡å¼çš„ä¸€ç§å®ç°ï¼Œæ˜¯ä¸€ä¸ª JavaScript åº“ï¼Œå®ƒå…³æ³¨ç‚¹ä¸»è¦æ˜¯ä»¥ä¸‹å‡ æ–¹é¢ âˆ¶</p><ul><li><p>Actionâˆ¶ ä¸€ä¸ª JavaScript å¯¹è±¡ï¼Œæè¿°åŠ¨ä½œç›¸å…³ä¿¡æ¯ï¼Œä¸»è¦åŒ…å« type å±æ€§å’Œ payload å±æ€§ âˆ¶</p><pre><code>o typeâˆ¶ action ç±»å‹; o payloadâˆ¶ è´Ÿè½½æ•°æ®;</code></pre></li><li><p>Reducerâˆ¶ å®šä¹‰åº”ç”¨çŠ¶æ€å¦‚ä½•å“åº”ä¸åŒåŠ¨ä½œï¼ˆactionï¼‰ï¼Œå¦‚ä½•æ›´æ–°çŠ¶æ€;</p></li><li><p>Storeâˆ¶ ç®¡ç† action å’Œ reducer åŠå…¶å…³ç³»çš„å¯¹è±¡ï¼Œä¸»è¦æä¾›ä»¥ä¸‹åŠŸèƒ½ âˆ¶</p><pre><code>o ç»´æŠ¤åº”ç”¨çŠ¶æ€å¹¶æ”¯æŒè®¿é—®çŠ¶æ€(getState());o æ”¯æŒç›‘å¬actionçš„åˆ†å‘ï¼Œæ›´æ–°çŠ¶æ€(dispatch(action));o æ”¯æŒè®¢é˜…storeçš„å˜æ›´(subscribe(listener));</code></pre></li><li><p>å¼‚æ­¥æµ âˆ¶ ç”±äº Redux æ‰€æœ‰å¯¹ store çŠ¶æ€çš„å˜æ›´ï¼Œéƒ½åº”è¯¥é€šè¿‡ action è§¦å‘ï¼Œå¼‚æ­¥ä»»åŠ¡ï¼ˆé€šå¸¸éƒ½æ˜¯ä¸šåŠ¡æˆ–è·å–æ•°æ®ä»»åŠ¡ï¼‰ä¹Ÿä¸ä¾‹å¤–ï¼Œè€Œä¸ºäº†ä¸å°†ä¸šåŠ¡æˆ–æ•°æ®ç›¸å…³çš„ä»»åŠ¡æ··å…¥ React ç»„ä»¶ä¸­ï¼Œå°±éœ€è¦ä½¿ç”¨å…¶ä»–æ¡†æ¶é…åˆç®¡ç†å¼‚æ­¥ä»»åŠ¡æµç¨‹ï¼Œå¦‚ redux-thunkï¼Œredux-saga ç­‰;</p></li></ul><p>Mobx æ˜¯ä¸€ä¸ªé€æ˜å‡½æ•°å“åº”å¼ç¼–ç¨‹çš„çŠ¶æ€ç®¡ç†åº“ï¼Œå®ƒä½¿å¾—çŠ¶æ€ç®¡ç†ç®€å•å¯ä¼¸ç¼© âˆ¶</p><ul><li>Actionâˆ¶ å®šä¹‰æ”¹å˜çŠ¶æ€çš„åŠ¨ä½œå‡½æ•°ï¼ŒåŒ…æ‹¬å¦‚ä½•å˜æ›´çŠ¶æ€;</li><li>Storeâˆ¶ é›†ä¸­ç®¡ç†æ¨¡å—çŠ¶æ€ï¼ˆStateï¼‰å’ŒåŠ¨ä½œ(action)</li><li>Derivationï¼ˆè¡ç”Ÿï¼‰âˆ¶ ä»åº”ç”¨çŠ¶æ€ä¸­æ´¾ç”Ÿè€Œå‡ºï¼Œä¸”æ²¡æœ‰ä»»ä½•å…¶ä»–å½±å“çš„æ•°æ®</li></ul><p><strong>å¯¹æ¯”æ€»ç»“ï¼š</strong></p><ul><li>redux å°†æ•°æ®ä¿å­˜åœ¨å•ä¸€çš„ store ä¸­ï¼Œmobx å°†æ•°æ®ä¿å­˜åœ¨åˆ†æ•£çš„å¤šä¸ª store ä¸­</li><li>redux ä½¿ç”¨ plain object ä¿å­˜æ•°æ®ï¼Œéœ€è¦æ‰‹åŠ¨å¤„ç†å˜åŒ–åçš„æ“ä½œ;mobx é€‚ç”¨ observable ä¿å­˜æ•°æ®ï¼Œæ•°æ®å˜åŒ–åè‡ªåŠ¨å¤„ç†å“åº”çš„æ“ä½œ</li><li>redux ä½¿ç”¨ä¸å¯å˜çŠ¶æ€ï¼Œè¿™æ„å‘³ç€çŠ¶æ€æ˜¯åªè¯»çš„ï¼Œä¸èƒ½ç›´æ¥å»ä¿®æ”¹å®ƒï¼Œè€Œæ˜¯åº”è¯¥è¿”å›ä¸€ä¸ªæ–°çš„çŠ¶æ€ï¼ŒåŒæ—¶ä½¿ç”¨çº¯å‡½æ•°;mobx ä¸­çš„çŠ¶æ€æ˜¯å¯å˜çš„ï¼Œå¯ä»¥ç›´æ¥å¯¹å…¶è¿›è¡Œä¿®æ”¹</li><li>mobx ç›¸å¯¹æ¥è¯´æ¯”è¾ƒç®€å•ï¼Œåœ¨å…¶ä¸­æœ‰å¾ˆå¤šçš„æŠ½è±¡ï¼Œmobx æ›´å¤šçš„ä½¿ç”¨é¢å‘å¯¹è±¡çš„ç¼–ç¨‹æ€ç»´;redux ä¼šæ¯”è¾ƒå¤æ‚ï¼Œå› ä¸ºå…¶ä¸­çš„å‡½æ•°å¼ç¼–ç¨‹æ€æƒ³æŒæ¡èµ·æ¥ä¸æ˜¯é‚£ä¹ˆå®¹æ˜“ï¼ŒåŒæ—¶éœ€è¦å€ŸåŠ©ä¸€ç³»åˆ—çš„ä¸­é—´ä»¶æ¥å¤„ç†å¼‚æ­¥å’Œå‰¯ä½œç”¨</li><li>mobx ä¸­æœ‰æ›´å¤šçš„æŠ½è±¡å’Œå°è£…ï¼Œè°ƒè¯•ä¼šæ¯”è¾ƒå›°éš¾ï¼ŒåŒæ—¶ç»“æœä¹Ÿéš¾ä»¥é¢„æµ‹;è€Œ redux æä¾›èƒ½å¤Ÿè¿›è¡Œæ—¶é—´å›æº¯çš„å¼€å‘å·¥å…·ï¼ŒåŒæ—¶å…¶çº¯å‡½æ•°ä»¥åŠæ›´å°‘çš„æŠ½è±¡ï¼Œè®©è°ƒè¯•å˜å¾—æ›´åŠ çš„å®¹æ˜“</li></ul><h3 id="9-Redux-å’Œ-Vuex-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œå®ƒä»¬çš„å…±åŒæ€æƒ³"><a href="#9-Redux-å’Œ-Vuex-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œå®ƒä»¬çš„å…±åŒæ€æƒ³" class="headerlink" title="9. Redux å’Œ Vuex æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œå®ƒä»¬çš„å…±åŒæ€æƒ³"></a>9. Redux å’Œ Vuex æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œå®ƒä»¬çš„å…±åŒæ€æƒ³</h3><p><strong>ï¼ˆ1ï¼‰Redux å’Œ Vuex åŒºåˆ«</strong></p><ul><li>Vuex æ”¹è¿›äº† Redux ä¸­çš„ Action å’Œ Reducer å‡½æ•°ï¼Œä»¥ mutations å˜åŒ–å‡½æ•°å–ä»£ Reducerï¼Œæ— éœ€ switchï¼Œåªéœ€åœ¨å¯¹åº”çš„ mutation å‡½æ•°é‡Œæ”¹å˜ state å€¼å³å¯</li><li>Vuex ç”±äº Vue è‡ªåŠ¨é‡æ–°æ¸²æŸ“çš„ç‰¹æ€§ï¼Œæ— éœ€è®¢é˜…é‡æ–°æ¸²æŸ“å‡½æ•°ï¼Œåªè¦ç”Ÿæˆæ–°çš„ State å³å¯</li><li>Vuex æ•°æ®æµçš„é¡ºåºæ˜¯ âˆ¶View è°ƒç”¨ store.commit æäº¤å¯¹åº”çš„è¯·æ±‚åˆ° Store ä¸­å¯¹åº”çš„ mutation å‡½æ•°-&gt;store æ”¹å˜ï¼ˆvue æ£€æµ‹åˆ°æ•°æ®å˜åŒ–è‡ªåŠ¨æ¸²æŸ“ï¼‰</li></ul><p>é€šä¿—ç‚¹ç†è§£å°±æ˜¯ï¼Œvuex å¼±åŒ– dispatchï¼Œé€šè¿‡ commit è¿›è¡Œ store çŠ¶æ€çš„ä¸€æ¬¡æ›´å˜ï¼›å–æ¶ˆäº† action æ¦‚å¿µï¼Œä¸å¿…ä¼ å…¥ç‰¹å®šçš„ action å½¢å¼è¿›è¡ŒæŒ‡å®šå˜æ›´ï¼›å¼±åŒ– reducerï¼ŒåŸºäº commit å‚æ•°ç›´æ¥å¯¹æ•°æ®è¿›è¡Œè½¬å˜ï¼Œä½¿å¾—æ¡†æ¶æ›´åŠ ç®€æ˜“;</p><p><strong>ï¼ˆ2ï¼‰å…±åŒæ€æƒ³</strong></p><ul><li>å•â€”çš„æ•°æ®æº</li><li>å˜åŒ–å¯ä»¥é¢„æµ‹</li></ul><p>æœ¬è´¨ä¸Š âˆ¶ redux ä¸ vuex éƒ½æ˜¯å¯¹ mvvm æ€æƒ³çš„æœåŠ¡ï¼Œå°†æ•°æ®ä»è§†å›¾ä¸­æŠ½ç¦»çš„ä¸€ç§æ–¹æ¡ˆã€‚</p><h3 id="10-Redux-ä¸­é—´ä»¶æ˜¯æ€ä¹ˆæ‹¿åˆ°-store-å’Œ-action-ç„¶åæ€ä¹ˆå¤„ç†"><a href="#10-Redux-ä¸­é—´ä»¶æ˜¯æ€ä¹ˆæ‹¿åˆ°-store-å’Œ-action-ç„¶åæ€ä¹ˆå¤„ç†" class="headerlink" title="10. Redux ä¸­é—´ä»¶æ˜¯æ€ä¹ˆæ‹¿åˆ° store å’Œ action? ç„¶åæ€ä¹ˆå¤„ç†?"></a>10. Redux ä¸­é—´ä»¶æ˜¯æ€ä¹ˆæ‹¿åˆ° store å’Œ action? ç„¶åæ€ä¹ˆå¤„ç†?</h3><p>redux ä¸­é—´ä»¶æœ¬è´¨å°±æ˜¯ä¸€ä¸ªå‡½æ•°æŸ¯é‡ŒåŒ–ã€‚redux applyMiddleware Api æºç ä¸­æ¯ä¸ª middleware æ¥å— 2 ä¸ªå‚æ•°ï¼Œ Store çš„ getState å‡½æ•°å’Œ dispatch å‡½æ•°ï¼Œåˆ†åˆ«è·å¾— store å’Œ actionï¼Œæœ€ç»ˆè¿”å›ä¸€ä¸ªå‡½æ•°ã€‚è¯¥å‡½æ•°ä¼šè¢«ä¼ å…¥ next çš„ä¸‹ä¸€ä¸ª middleware çš„ dispatch æ–¹æ³•ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ¥æ”¶ action çš„æ–°å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å¯ä»¥ç›´æ¥è°ƒç”¨ nextï¼ˆactionï¼‰ï¼Œæˆ–è€…åœ¨å…¶ä»–éœ€è¦çš„æ—¶åˆ»è°ƒç”¨ï¼Œç”šè‡³æ ¹æœ¬ä¸å»è°ƒç”¨å®ƒã€‚è°ƒç”¨é“¾ä¸­æœ€åä¸€ä¸ª middleware ä¼šæ¥å—çœŸå®çš„ store çš„ dispatch æ–¹æ³•ä½œä¸º next å‚æ•°ï¼Œå¹¶å€Ÿæ­¤ç»“æŸè°ƒç”¨é“¾ã€‚æ‰€ä»¥ï¼Œmiddleware çš„å‡½æ•°ç­¾åæ˜¯ï¼ˆ{ getStateï¼Œdispatch })=&gt; next =&gt; actionã€‚</p><h3 id="11-Redux-ä¸­çš„-connect-æœ‰ä»€ä¹ˆä½œç”¨"><a href="#11-Redux-ä¸­çš„-connect-æœ‰ä»€ä¹ˆä½œç”¨" class="headerlink" title="11. Redux ä¸­çš„ connect æœ‰ä»€ä¹ˆä½œç”¨"></a>11. Redux ä¸­çš„ connect æœ‰ä»€ä¹ˆä½œç”¨</h3><p>connect è´Ÿè´£è¿æ¥ React å’Œ Redux</p><p><strong>ï¼ˆ1ï¼‰è·å– state</strong></p><p>connect é€šè¿‡ context è·å– Provider ä¸­çš„ storeï¼Œé€šè¿‡<code>store.getState()</code> è·å–æ•´ä¸ª store tree ä¸Šæ‰€æœ‰ state</p><p><strong>ï¼ˆ2ï¼‰åŒ…è£…åŸç»„ä»¶</strong></p><p>å°† state å’Œ action é€šè¿‡ props çš„æ–¹å¼ä¼ å…¥åˆ°åŸç»„ä»¶å†…éƒ¨ wrapWithConnect è¿”å›â€”ä¸ª ReactComponent å¯¹ è±¡ Connectï¼ŒConnect é‡ æ–° render å¤–éƒ¨ä¼ å…¥çš„åŸç»„ä»¶ WrappedComponent ï¼Œå¹¶æŠŠ connect ä¸­ä¼ å…¥çš„ mapStateToPropsï¼ŒmapDispatchToProps ä¸ç»„ä»¶ä¸ŠåŸæœ‰çš„ props åˆå¹¶åï¼Œé€šè¿‡å±æ€§çš„æ–¹å¼ä¼ ç»™ WrappedComponent</p><p><strong>ï¼ˆ3ï¼‰ç›‘å¬ store tree å˜åŒ–</strong></p><p>connect ç¼“å­˜äº† store tree ä¸­ state çš„çŠ¶æ€ï¼Œé€šè¿‡å½“å‰ state çŠ¶æ€ å’Œå˜æ›´å‰ state çŠ¶æ€è¿›è¡Œæ¯”è¾ƒï¼Œä»è€Œç¡®å®šæ˜¯å¦è°ƒç”¨ <code>this.setState()</code>æ–¹æ³•è§¦å‘ Connect åŠå…¶å­ç»„ä»¶çš„é‡æ–°æ¸²æŸ“</p><h2 id="ä¸ƒã€Hooks"><a href="#ä¸ƒã€Hooks" class="headerlink" title="ä¸ƒã€Hooks"></a>ä¸ƒã€Hooks</h2><h3 id="1-å¯¹-React-Hook-çš„ç†è§£ï¼Œå®ƒçš„å®ç°åŸç†æ˜¯ä»€ä¹ˆ"><a href="#1-å¯¹-React-Hook-çš„ç†è§£ï¼Œå®ƒçš„å®ç°åŸç†æ˜¯ä»€ä¹ˆ" class="headerlink" title="1. å¯¹ React Hook çš„ç†è§£ï¼Œå®ƒçš„å®ç°åŸç†æ˜¯ä»€ä¹ˆ"></a>1. å¯¹ React Hook çš„ç†è§£ï¼Œå®ƒçš„å®ç°åŸç†æ˜¯ä»€ä¹ˆ</h3><p>React-Hooks æ˜¯ React å›¢é˜Ÿåœ¨ React ç»„ä»¶å¼€å‘å®è·µä¸­ï¼Œé€æ¸è®¤çŸ¥åˆ°çš„ä¸€ä¸ªæ”¹è¿›ç‚¹ï¼Œè¿™èƒŒåå…¶å®æ¶‰åŠå¯¹<strong>ç±»ç»„ä»¶</strong>å’Œ<strong>å‡½æ•°ç»„ä»¶</strong>ä¸¤ç§ç»„ä»¶å½¢å¼çš„æ€è€ƒå’Œä¾§é‡ã€‚</p><p><strong>ï¼ˆ1ï¼‰ç±»ç»„ä»¶ï¼š</strong> æ‰€è°“ç±»ç»„ä»¶ï¼Œå°±æ˜¯åŸºäº ES6 Class è¿™ç§å†™æ³•ï¼Œé€šè¿‡ç»§æ‰¿ React.Component å¾—æ¥çš„ React ç»„ä»¶ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç±»ç»„ä»¶ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">DemoClass</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  state <span class="token operator">=</span> <span class="token punctuation">{</span>    text<span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//...</span>  <span class="token punctuation">}</span>  changeText <span class="token operator">=</span> <span class="token punctuation">(</span>newText<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>      text<span class="token punctuation">:</span> newText<span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"demoClass"</span><span class="token operator">></span>        <span class="token operator">&lt;</span>p<span class="token operator">></span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>text<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>changeText<span class="token punctuation">}</span><span class="token operator">></span>ä¿®æ”¹<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span>      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥çœ‹å‡ºï¼ŒReact ç±»ç»„ä»¶å†…éƒ¨é¢„ç½®äº†ç›¸å½“å¤šçš„â€œç°æˆçš„ä¸œè¥¿â€ç­‰ç€æˆ‘ä»¬å»è°ƒåº¦/å®šåˆ¶ï¼Œstate å’Œç”Ÿå‘½å‘¨æœŸå°±æ˜¯è¿™äº›â€œç°æˆä¸œè¥¿â€ä¸­çš„å…¸å‹ã€‚è¦æƒ³å¾—åˆ°è¿™äº›ä¸œè¥¿ï¼Œéš¾åº¦ä¹Ÿä¸å¤§ï¼Œåªéœ€è¦ç»§æ‰¿ä¸€ä¸ª React.Component å³å¯ã€‚</p><p>å½“ç„¶ï¼Œè¿™ä¹Ÿæ˜¯ç±»ç»„ä»¶çš„ä¸€ä¸ªä¸ä¾¿ï¼Œå®ƒå¤ªç¹æ‚äº†ï¼Œå¯¹äºè§£å†³è®¸å¤šé—®é¢˜æ¥è¯´ï¼Œç¼–å†™ä¸€ä¸ªç±»ç»„ä»¶å®åœ¨æ˜¯ä¸€ä¸ªè¿‡äºå¤æ‚çš„å§¿åŠ¿ã€‚å¤æ‚çš„å§¿åŠ¿å¿…ç„¶å¸¦æ¥é«˜æ˜‚çš„ç†è§£æˆæœ¬ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬æ‰€ä¸æƒ³çœ‹åˆ°çš„ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œç”±äºå¼€å‘è€…ç¼–å†™çš„é€»è¾‘åœ¨å°è£…åæ˜¯å’Œç»„ä»¶ç²˜åœ¨ä¸€èµ·çš„ï¼Œè¿™å°±ä½¿å¾—<strong>ç±»ç»„ä»¶å†…éƒ¨çš„é€»è¾‘éš¾ä»¥å®ç°æ‹†åˆ†å’Œå¤ç”¨ã€‚</strong></p><p><strong>ï¼ˆ2ï¼‰å‡½æ•°ç»„ä»¶</strong>ï¼šå‡½æ•°ç»„ä»¶å°±æ˜¯ä»¥å‡½æ•°çš„å½¢æ€å­˜åœ¨çš„ React ç»„ä»¶ã€‚æ—©æœŸå¹¶æ²¡æœ‰ React-Hooksï¼Œå‡½æ•°ç»„ä»¶å†…éƒ¨æ— æ³•å®šä¹‰å’Œç»´æŠ¤ stateï¼Œå› æ­¤å®ƒè¿˜æœ‰ä¸€ä¸ªåˆ«åå«â€œæ— çŠ¶æ€ç»„ä»¶â€ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªå‡½æ•°ç»„ä»¶ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">DemoFunction</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> <span class="token punctuation">{</span> text <span class="token punctuation">}</span> <span class="token operator">=</span> props<span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"demoFunction"</span><span class="token operator">></span>      <span class="token operator">&lt;</span>p<span class="token operator">></span><span class="token punctuation">{</span><span class="token template-string"><span class="token string">`å‡½æ•°ç»„ä»¶æ¥æ”¶çš„å†…å®¹ï¼š[</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>text<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">]`</span></span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>  <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç›¸æ¯”äºç±»ç»„ä»¶ï¼Œå‡½æ•°ç»„ä»¶è‚‰çœ¼å¯è§çš„ç‰¹è´¨è‡ªç„¶åŒ…æ‹¬è½»é‡ã€çµæ´»ã€æ˜“äºç»„ç»‡å’Œç»´æŠ¤ã€è¾ƒä½çš„å­¦ä¹ æˆæœ¬ç­‰ã€‚</p><p>é€šè¿‡å¯¹æ¯”ï¼Œä»å½¢æ€ä¸Šå¯ä»¥å¯¹ä¸¤ç§ç»„ä»¶åšåŒºåˆ†ï¼Œå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«å¦‚ä¸‹ï¼š</p><ul><li>ç±»ç»„ä»¶éœ€è¦ç»§æ‰¿ classï¼Œå‡½æ•°ç»„ä»¶ä¸éœ€è¦ï¼›</li><li>ç±»ç»„ä»¶å¯ä»¥è®¿é—®ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œå‡½æ•°ç»„ä»¶ä¸èƒ½ï¼›</li><li>ç±»ç»„ä»¶ä¸­å¯ä»¥è·å–åˆ°å®ä¾‹åŒ–åçš„ thisï¼Œå¹¶åŸºäºè¿™ä¸ª this åšå„ç§å„æ ·çš„äº‹æƒ…ï¼Œè€Œå‡½æ•°ç»„ä»¶ä¸å¯ä»¥ï¼›</li><li>ç±»ç»„ä»¶ä¸­å¯ä»¥å®šä¹‰å¹¶ç»´æŠ¤ stateï¼ˆçŠ¶æ€ï¼‰ï¼Œè€Œå‡½æ•°ç»„ä»¶ä¸å¯ä»¥ï¼›</li></ul><p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€äº›å…¶ä»–çš„ä¸åŒã€‚é€šè¿‡ä¸Šé¢çš„åŒºåˆ«ï¼Œæˆ‘ä»¬ä¸èƒ½è¯´è°å¥½è°åï¼Œå®ƒä»¬å„æœ‰è‡ªå·±çš„ä¼˜åŠ¿ã€‚åœ¨ React-Hooks å‡ºç°ä¹‹å‰ï¼Œ<strong>ç±»ç»„ä»¶çš„èƒ½åŠ›è¾¹ç•Œæ˜æ˜¾å¼ºäºå‡½æ•°ç»„ä»¶ã€‚</strong></p><p>å®é™…ä¸Šï¼Œç±»ç»„ä»¶å’Œå‡½æ•°ç»„ä»¶ä¹‹é—´ï¼Œæ˜¯é¢å‘å¯¹è±¡å’Œå‡½æ•°å¼ç¼–ç¨‹è¿™ä¸¤å¥—ä¸åŒçš„è®¾è®¡æ€æƒ³ä¹‹é—´çš„å·®å¼‚ã€‚è€Œå‡½æ•°ç»„ä»¶æ›´åŠ å¥‘åˆ React æ¡†æ¶çš„è®¾è®¡ç†å¿µï¼š<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/reactreactInterview2/2.png" alt="image.png"><br>React ç»„ä»¶æœ¬èº«çš„å®šä½å°±æ˜¯å‡½æ•°ï¼Œä¸€ä¸ªè¾“å…¥æ•°æ®ã€è¾“å‡º UI çš„å‡½æ•°ã€‚ä½œä¸ºå¼€å‘è€…ï¼Œæˆ‘ä»¬ç¼–å†™çš„æ˜¯å£°æ˜å¼çš„ä»£ç ï¼Œè€Œ React æ¡†æ¶çš„ä¸»è¦å·¥ä½œï¼Œå°±æ˜¯åŠæ—¶åœ°æŠŠå£°æ˜å¼çš„ä»£ç è½¬æ¢ä¸ºå‘½ä»¤å¼çš„ DOM æ“ä½œï¼ŒæŠŠæ•°æ®å±‚é¢çš„æè¿°æ˜ å°„åˆ°ç”¨æˆ·å¯è§çš„ UI å˜åŒ–ä¸­å»ã€‚è¿™å°±æ„å‘³ç€ä»åŸåˆ™ä¸Šæ¥è®²ï¼ŒReact çš„æ•°æ®åº”è¯¥æ€»æ˜¯ç´§ç´§åœ°å’Œæ¸²æŸ“ç»‘å®šåœ¨ä¸€èµ·çš„ï¼Œè€Œç±»ç»„ä»¶åšä¸åˆ°è¿™ä¸€ç‚¹ã€‚<strong>å‡½æ•°ç»„ä»¶å°±çœŸæ­£åœ°å°†æ•°æ®å’Œæ¸²æŸ“ç»‘å®šåˆ°äº†ä¸€èµ·ã€‚å‡½æ•°ç»„ä»¶æ˜¯ä¸€ä¸ªæ›´åŠ åŒ¹é…å…¶è®¾è®¡ç†å¿µã€ä¹Ÿæ›´æœ‰åˆ©äºé€»è¾‘æ‹†åˆ†ä¸é‡ç”¨çš„ç»„ä»¶è¡¨è¾¾å½¢å¼ã€‚</strong></p><p>ä¸ºäº†èƒ½è®©å¼€å‘è€…æ›´å¥½çš„çš„å»ç¼–å†™å‡½æ•°å¼ç»„ä»¶ã€‚äºæ˜¯ï¼ŒReact-Hooks ä¾¿åº”è¿è€Œç”Ÿã€‚</p><p>React-Hooks æ˜¯ä¸€å¥—èƒ½å¤Ÿä½¿å‡½æ•°ç»„ä»¶æ›´å¼ºå¤§ã€æ›´çµæ´»çš„â€œé’©å­â€ã€‚</p><p>å‡½æ•°ç»„ä»¶æ¯”èµ·ç±»ç»„ä»¶å°‘äº†å¾ˆå¤šä¸œè¥¿ï¼Œæ¯”å¦‚ç”Ÿå‘½å‘¨æœŸã€å¯¹ state çš„ç®¡ç†ç­‰ã€‚è¿™å°±ç»™å‡½æ•°ç»„ä»¶çš„ä½¿ç”¨å¸¦æ¥äº†éå¸¸å¤šçš„å±€é™æ€§ï¼Œå¯¼è‡´æˆ‘ä»¬å¹¶ä¸èƒ½ä½¿ç”¨å‡½æ•°è¿™ç§å½¢å¼ï¼Œå†™å‡ºä¸€ä¸ªçœŸæ­£çš„å…¨åŠŸèƒ½çš„ç»„ä»¶ã€‚è€Œ React-Hooks çš„å‡ºç°ï¼Œå°±æ˜¯ä¸ºäº†å¸®åŠ©å‡½æ•°ç»„ä»¶è¡¥é½è¿™äº›ï¼ˆç›¸å¯¹äºç±»ç»„ä»¶æ¥è¯´ï¼‰ç¼ºå¤±çš„èƒ½åŠ›ã€‚</p><p>å¦‚æœè¯´å‡½æ•°ç»„ä»¶æ˜¯ä¸€å°è½»å·§çš„å¿«è‰‡ï¼Œé‚£ä¹ˆ React-Hooks å°±æ˜¯ä¸€ä¸ªå†…å®¹ä¸°å¯Œçš„é›¶éƒ¨ä»¶ç®±ã€‚â€œé‡è£…æˆ˜èˆ°â€æ‰€é¢„ç½®çš„é‚£äº›è®¾å¤‡ï¼Œè¿™ä¸ªç®±å­é‡ŒåŸºæœ¬å…¨éƒ½æœ‰ï¼ŒåŒæ—¶å®ƒè¿˜ä¸å¼ºåˆ¶ä½ å…¨éƒ½è¦ï¼Œè€Œæ˜¯å…è®¸ä½ è‡ªç”±åœ°é€‰æ‹©å’Œä½¿ç”¨ä½ éœ€è¦çš„é‚£äº›èƒ½åŠ›ï¼Œç„¶åå°†è¿™äº›èƒ½åŠ›ä»¥ Hookï¼ˆé’©å­ï¼‰çš„å½¢å¼â€œé’©â€è¿›ä½ çš„ç»„ä»¶é‡Œï¼Œä»è€Œå®šåˆ¶å‡ºä¸€ä¸ªæœ€é€‚åˆä½ çš„â€œä¸“å±æˆ˜èˆ°â€ã€‚</p><h3 id="2-ä¸ºä»€ä¹ˆ-useState-è¦ä½¿ç”¨æ•°ç»„è€Œä¸æ˜¯å¯¹è±¡"><a href="#2-ä¸ºä»€ä¹ˆ-useState-è¦ä½¿ç”¨æ•°ç»„è€Œä¸æ˜¯å¯¹è±¡" class="headerlink" title="2. ä¸ºä»€ä¹ˆ useState è¦ä½¿ç”¨æ•°ç»„è€Œä¸æ˜¯å¯¹è±¡"></a>2. ä¸ºä»€ä¹ˆ useState è¦ä½¿ç”¨æ•°ç»„è€Œä¸æ˜¯å¯¹è±¡</h3><p>useState çš„ç”¨æ³•ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span> setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯ä»¥çœ‹åˆ° useState è¿”å›çš„æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆæ˜¯è¿”å›æ•°ç»„è€Œä¸æ˜¯è¿”å›å¯¹è±¡å‘¢ï¼Ÿ</p><p>è¿™é‡Œç”¨åˆ°äº†è§£æ„èµ‹å€¼ï¼Œæ‰€ä»¥å…ˆæ¥çœ‹ä¸€ä¸‹ ES6 çš„è§£æ„èµ‹å€¼ï¼š</p><h5 id="æ•°ç»„çš„è§£æ„èµ‹å€¼"><a href="#æ•°ç»„çš„è§£æ„èµ‹å€¼" class="headerlink" title="æ•°ç»„çš„è§£æ„èµ‹å€¼"></a>æ•°ç»„çš„è§£æ„èµ‹å€¼</h5><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> foo <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token punctuation">[</span>one<span class="token punctuation">,</span> two<span class="token punctuation">,</span> three<span class="token punctuation">]</span> <span class="token operator">=</span> foo<span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>one<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 1</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>two<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 2</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>three<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 3</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="å¯¹è±¡çš„è§£æ„èµ‹å€¼"><a href="#å¯¹è±¡çš„è§£æ„èµ‹å€¼" class="headerlink" title="å¯¹è±¡çš„è§£æ„èµ‹å€¼"></a>å¯¹è±¡çš„è§£æ„èµ‹å€¼</h5><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token punctuation">{</span>  id<span class="token punctuation">:</span> <span class="token number">888</span><span class="token punctuation">,</span>  name<span class="token punctuation">:</span> <span class="token string">"xiaoxin"</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">const</span> <span class="token punctuation">{</span> id<span class="token punctuation">,</span> name <span class="token punctuation">}</span> <span class="token operator">=</span> user<span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 888</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// "xiaoxin"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>çœ‹å®Œè¿™ä¸¤ä¸ªä¾‹å­ï¼Œç­”æ¡ˆåº”è¯¥å°±å‡ºæ¥äº†ï¼š</p><ul><li>å¦‚æœ useState è¿”å›çš„æ˜¯æ•°ç»„ï¼Œé‚£ä¹ˆä½¿ç”¨è€…å¯ä»¥å¯¹æ•°ç»„ä¸­çš„å…ƒç´ å‘½åï¼Œä»£ç çœ‹èµ·æ¥ä¹Ÿæ¯”è¾ƒå¹²å‡€</li><li>å¦‚æœ useState è¿”å›çš„æ˜¯å¯¹è±¡ï¼Œåœ¨è§£æ„å¯¹è±¡çš„æ—¶å€™å¿…é¡»è¦å’Œ useState å†…éƒ¨å®ç°è¿”å›çš„å¯¹è±¡åŒåï¼Œæƒ³è¦ä½¿ç”¨å¤šæ¬¡çš„è¯ï¼Œå¿…é¡»å¾—è®¾ç½®åˆ«åæ‰èƒ½ä½¿ç”¨è¿”å›å€¼</li></ul><p>ä¸‹é¢æ¥çœ‹çœ‹å¦‚æœ useState è¿”å›å¯¹è±¡çš„æƒ…å†µï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// ç¬¬ä¸€æ¬¡ä½¿ç”¨</span><span class="token keyword">const</span> <span class="token punctuation">{</span> state<span class="token punctuation">,</span> setState <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// ç¬¬äºŒæ¬¡ä½¿ç”¨</span><span class="token keyword">const</span> <span class="token punctuation">{</span> state<span class="token punctuation">:</span> counter<span class="token punctuation">,</span> setState<span class="token punctuation">:</span> setCounter <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œè¿”å›å¯¹è±¡çš„ä½¿ç”¨æ–¹å¼è¿˜æ˜¯æŒºéº»çƒ¦çš„ï¼Œæ›´ä½•å†µå®é™…é¡¹ç›®ä¸­ä¼šä½¿ç”¨çš„æ›´é¢‘ç¹ã€‚<br><strong>æ€»ç»“ï¼š</strong>useState è¿”å›çš„æ˜¯ array è€Œä¸æ˜¯ object çš„åŸå› å°±æ˜¯ä¸ºäº†<strong>é™ä½ä½¿ç”¨çš„å¤æ‚åº¦</strong>ï¼Œè¿”å›æ•°ç»„çš„è¯å¯ä»¥ç›´æ¥æ ¹æ®é¡ºåºè§£æ„ï¼Œè€Œè¿”å›å¯¹è±¡çš„è¯è¦æƒ³ä½¿ç”¨å¤šæ¬¡å°±éœ€è¦å®šä¹‰åˆ«åäº†ã€‚</p><h3 id="3-React-Hooks-è§£å†³äº†å“ªäº›é—®é¢˜ï¼Ÿ"><a href="#3-React-Hooks-è§£å†³äº†å“ªäº›é—®é¢˜ï¼Ÿ" class="headerlink" title="3. React Hooks è§£å†³äº†å“ªäº›é—®é¢˜ï¼Ÿ"></a>3. React Hooks è§£å†³äº†å“ªäº›é—®é¢˜ï¼Ÿ</h3><p>React Hooks ä¸»è¦è§£å†³äº†ä»¥ä¸‹é—®é¢˜ï¼š</p><p><strong>ï¼ˆ1ï¼‰åœ¨ç»„ä»¶ä¹‹é—´å¤ç”¨çŠ¶æ€é€»è¾‘å¾ˆéš¾</strong></p><p>React æ²¡æœ‰æä¾›å°†å¯å¤ç”¨æ€§è¡Œä¸ºâ€œé™„åŠ â€åˆ°ç»„ä»¶çš„é€”å¾„ï¼ˆä¾‹å¦‚ï¼ŒæŠŠç»„ä»¶è¿æ¥åˆ° storeï¼‰è§£å†³æ­¤ç±»é—®é¢˜å¯ä»¥ä½¿ç”¨ render props å’Œ é«˜é˜¶ç»„ä»¶ã€‚ä½†æ˜¯è¿™ç±»æ–¹æ¡ˆéœ€è¦é‡æ–°ç»„ç»‡ç»„ä»¶ç»“æ„ï¼Œè¿™å¯èƒ½ä¼šå¾ˆéº»çƒ¦ï¼Œå¹¶ä¸”ä¼šä½¿ä»£ç éš¾ä»¥ç†è§£ã€‚ç”± providersï¼Œconsumersï¼Œé«˜é˜¶ç»„ä»¶ï¼Œrender props ç­‰å…¶ä»–æŠ½è±¡å±‚ç»„æˆçš„ç»„ä»¶ä¼šå½¢æˆâ€œåµŒå¥—åœ°ç‹±â€ã€‚å°½ç®¡å¯ä»¥åœ¨ DevTools è¿‡æ»¤æ‰å®ƒä»¬ï¼Œä½†è¿™è¯´æ˜äº†ä¸€ä¸ªæ›´æ·±å±‚æ¬¡çš„é—®é¢˜ï¼šReact éœ€è¦ä¸ºå…±äº«çŠ¶æ€é€»è¾‘æä¾›æ›´å¥½çš„åŸç”Ÿé€”å¾„ã€‚</p><p>å¯ä»¥ä½¿ç”¨ Hook ä»ç»„ä»¶ä¸­æå–çŠ¶æ€é€»è¾‘ï¼Œä½¿å¾—è¿™äº›é€»è¾‘å¯ä»¥å•ç‹¬æµ‹è¯•å¹¶å¤ç”¨ã€‚Hook ä½¿æˆ‘ä»¬åœ¨æ— éœ€ä¿®æ”¹ç»„ä»¶ç»“æ„çš„æƒ…å†µä¸‹å¤ç”¨çŠ¶æ€é€»è¾‘ã€‚ è¿™ä½¿å¾—åœ¨ç»„ä»¶é—´æˆ–ç¤¾åŒºå†…å…±äº« Hook å˜å¾—æ›´ä¾¿æ·ã€‚</p><p><strong>ï¼ˆ2ï¼‰å¤æ‚ç»„ä»¶å˜å¾—éš¾ä»¥ç†è§£</strong></p><p>åœ¨ç»„ä»¶ä¸­ï¼Œæ¯ä¸ªç”Ÿå‘½å‘¨æœŸå¸¸å¸¸åŒ…å«ä¸€äº›ä¸ç›¸å…³çš„é€»è¾‘ã€‚ä¾‹å¦‚ï¼Œç»„ä»¶å¸¸å¸¸åœ¨ componentDidMount å’Œ componentDidUpdate ä¸­è·å–æ•°æ®ã€‚ä½†æ˜¯ï¼ŒåŒä¸€ä¸ª componentDidMount ä¸­å¯èƒ½ä¹ŸåŒ…å«å¾ˆå¤šå…¶å®ƒçš„é€»è¾‘ï¼Œå¦‚è®¾ç½®äº‹ä»¶ç›‘å¬ï¼Œè€Œä¹‹åéœ€åœ¨ componentWillUnmount ä¸­æ¸…é™¤ã€‚ç›¸äº’å…³è”ä¸”éœ€è¦å¯¹ç…§ä¿®æ”¹çš„ä»£ç è¢«è¿›è¡Œäº†æ‹†åˆ†ï¼Œè€Œå®Œå…¨ä¸ç›¸å…³çš„ä»£ç å´åœ¨åŒä¸€ä¸ªæ–¹æ³•ä¸­ç»„åˆåœ¨ä¸€èµ·ã€‚å¦‚æ­¤å¾ˆå®¹æ˜“äº§ç”Ÿ bugï¼Œå¹¶ä¸”å¯¼è‡´é€»è¾‘ä¸ä¸€è‡´ã€‚</p><p>åœ¨å¤šæ•°æƒ…å†µä¸‹ï¼Œä¸å¯èƒ½å°†ç»„ä»¶æ‹†åˆ†ä¸ºæ›´å°çš„ç²’åº¦ï¼Œå› ä¸ºçŠ¶æ€é€»è¾‘æ— å¤„ä¸åœ¨ã€‚è¿™ä¹Ÿç»™æµ‹è¯•å¸¦æ¥äº†ä¸€å®šæŒ‘æˆ˜ã€‚åŒæ—¶ï¼Œè¿™ä¹Ÿæ˜¯å¾ˆå¤šäººå°† React ä¸çŠ¶æ€ç®¡ç†åº“ç»“åˆä½¿ç”¨çš„åŸå› ä¹‹ä¸€ã€‚ä½†æ˜¯ï¼Œè¿™å¾€å¾€ä¼šå¼•å…¥äº†å¾ˆå¤šæŠ½è±¡æ¦‚å¿µï¼Œéœ€è¦ä½ åœ¨ä¸åŒçš„æ–‡ä»¶ä¹‹é—´æ¥å›åˆ‡æ¢ï¼Œä½¿å¾—å¤ç”¨å˜å¾—æ›´åŠ å›°éš¾ã€‚</p><p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒHook å°†ç»„ä»¶ä¸­ç›¸äº’å…³è”çš„éƒ¨åˆ†æ‹†åˆ†æˆæ›´å°çš„å‡½æ•°ï¼ˆæ¯”å¦‚è®¾ç½®è®¢é˜…æˆ–è¯·æ±‚æ•°æ®ï¼‰ï¼Œè€Œå¹¶éå¼ºåˆ¶æŒ‰ç…§ç”Ÿå‘½å‘¨æœŸåˆ’åˆ†ã€‚ä½ è¿˜å¯ä»¥ä½¿ç”¨ reducer æ¥ç®¡ç†ç»„ä»¶çš„å†…éƒ¨çŠ¶æ€ï¼Œä½¿å…¶æ›´åŠ å¯é¢„æµ‹ã€‚</p><p><strong>ï¼ˆ3ï¼‰éš¾ä»¥ç†è§£çš„ class</strong></p><p>é™¤äº†ä»£ç å¤ç”¨å’Œä»£ç ç®¡ç†ä¼šé‡åˆ°å›°éš¾å¤–ï¼Œclass æ˜¯å­¦ä¹  React çš„ä¸€å¤§å±éšœã€‚æˆ‘ä»¬å¿…é¡»å»ç†è§£ JavaScript ä¸­ this çš„å·¥ä½œæ–¹å¼ï¼Œè¿™ä¸å…¶ä»–è¯­è¨€å­˜åœ¨å·¨å¤§å·®å¼‚ã€‚è¿˜ä¸èƒ½å¿˜è®°ç»‘å®šäº‹ä»¶å¤„ç†å™¨ã€‚æ²¡æœ‰ç¨³å®šçš„è¯­æ³•ææ¡ˆï¼Œè¿™äº›ä»£ç éå¸¸å†—ä½™ã€‚å¤§å®¶å¯ä»¥å¾ˆå¥½åœ°ç†è§£ propsï¼Œstate å’Œè‡ªé¡¶å‘ä¸‹çš„æ•°æ®æµï¼Œä½†å¯¹ class å´ä¸€ç­¹è«å±•ã€‚å³ä¾¿åœ¨æœ‰ç»éªŒçš„ React å¼€å‘è€…ä¹‹é—´ï¼Œå¯¹äºå‡½æ•°ç»„ä»¶ä¸ class ç»„ä»¶çš„å·®å¼‚ä¹Ÿå­˜åœ¨åˆ†æ­§ï¼Œç”šè‡³è¿˜è¦åŒºåˆ†ä¸¤ç§ç»„ä»¶çš„ä½¿ç”¨åœºæ™¯ã€‚</p><p>ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼ŒHook ä½¿ä½ åœ¨é class çš„æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨æ›´å¤šçš„ React ç‰¹æ€§ã€‚ ä»æ¦‚å¿µä¸Šè®²ï¼ŒReact ç»„ä»¶ä¸€ç›´æ›´åƒæ˜¯å‡½æ•°ã€‚è€Œ Hook åˆ™æ‹¥æŠ±äº†å‡½æ•°ï¼ŒåŒæ—¶ä¹Ÿæ²¡æœ‰ç‰ºç‰² React çš„ç²¾ç¥åŸåˆ™ã€‚Hook æä¾›äº†é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Œæ— éœ€å­¦ä¹ å¤æ‚çš„å‡½æ•°å¼æˆ–å“åº”å¼ç¼–ç¨‹æŠ€æœ¯</p><h3 id="4-React-Hook-çš„ä½¿ç”¨é™åˆ¶æœ‰å“ªäº›ï¼Ÿ"><a href="#4-React-Hook-çš„ä½¿ç”¨é™åˆ¶æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="4. React Hook çš„ä½¿ç”¨é™åˆ¶æœ‰å“ªäº›ï¼Ÿ"></a>4. React Hook çš„ä½¿ç”¨é™åˆ¶æœ‰å“ªäº›ï¼Ÿ</h3><p>React Hooks çš„é™åˆ¶ä¸»è¦æœ‰ä¸¤æ¡ï¼š</p><ul><li>ä¸è¦åœ¨å¾ªç¯ã€æ¡ä»¶æˆ–åµŒå¥—å‡½æ•°ä¸­è°ƒç”¨ Hookï¼›</li><li>åœ¨ React çš„å‡½æ•°ç»„ä»¶ä¸­è°ƒç”¨ Hookã€‚</li></ul><p>é‚£ä¸ºä»€ä¹ˆä¼šæœ‰è¿™æ ·çš„é™åˆ¶å‘¢ï¼ŸHooks çš„è®¾è®¡åˆè¡·æ˜¯ä¸ºäº†æ”¹è¿› React ç»„ä»¶çš„å¼€å‘æ¨¡å¼ã€‚åœ¨æ—§æœ‰çš„å¼€å‘æ¨¡å¼ä¸‹é‡åˆ°äº†ä¸‰ä¸ªé—®é¢˜ã€‚</p><ul><li>ç»„ä»¶ä¹‹é—´éš¾ä»¥å¤ç”¨çŠ¶æ€é€»è¾‘ã€‚è¿‡å»å¸¸è§çš„è§£å†³æ–¹æ¡ˆæ˜¯é«˜é˜¶ç»„ä»¶ã€render props åŠçŠ¶æ€ç®¡ç†æ¡†æ¶ã€‚</li><li>å¤æ‚çš„ç»„ä»¶å˜å¾—éš¾ä»¥ç†è§£ã€‚ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸ä¸šåŠ¡é€»è¾‘è€¦åˆå¤ªæ·±ï¼Œå¯¼è‡´å…³è”éƒ¨åˆ†éš¾ä»¥æ‹†åˆ†ã€‚</li><li>äººå’Œæœºå™¨éƒ½å¾ˆå®¹æ˜“æ··æ·†ç±»ã€‚å¸¸è§çš„æœ‰ this çš„é—®é¢˜ï¼Œä½†åœ¨ React å›¢é˜Ÿä¸­è¿˜æœ‰ç±»éš¾ä»¥ä¼˜åŒ–çš„é—®é¢˜ï¼Œå¸Œæœ›åœ¨ç¼–è¯‘ä¼˜åŒ–å±‚é¢åšå‡ºä¸€äº›æ”¹è¿›ã€‚</li></ul><p>è¿™ä¸‰ä¸ªé—®é¢˜åœ¨ä¸€å®šç¨‹åº¦ä¸Šé˜»ç¢äº† React çš„åç»­å‘å±•ï¼Œæ‰€ä»¥ä¸ºäº†è§£å†³è¿™ä¸‰ä¸ªé—®é¢˜ï¼ŒHooks <strong>åŸºäºå‡½æ•°ç»„ä»¶</strong>å¼€å§‹è®¾è®¡ã€‚ç„¶è€Œç¬¬ä¸‰ä¸ªé—®é¢˜å†³å®šäº† Hooks åªæ”¯æŒå‡½æ•°ç»„ä»¶ã€‚</p><p>é‚£ä¸ºä»€ä¹ˆä¸è¦åœ¨å¾ªç¯ã€æ¡ä»¶æˆ–åµŒå¥—å‡½æ•°ä¸­è°ƒç”¨ Hook å‘¢ï¼Ÿå› ä¸º Hooks çš„è®¾è®¡æ˜¯åŸºäºæ•°ç»„å®ç°ã€‚åœ¨è°ƒç”¨æ—¶æŒ‰é¡ºåºåŠ å…¥æ•°ç»„ä¸­ï¼Œå¦‚æœä½¿ç”¨å¾ªç¯ã€æ¡ä»¶æˆ–åµŒå¥—å‡½æ•°å¾ˆæœ‰å¯èƒ½å¯¼è‡´æ•°ç»„å–å€¼é”™ä½ï¼Œæ‰§è¡Œé”™è¯¯çš„ Hookã€‚å½“ç„¶ï¼Œå®è´¨ä¸Š React çš„æºç é‡Œä¸æ˜¯æ•°ç»„ï¼Œæ˜¯é“¾è¡¨ã€‚</p><p>è¿™äº›é™åˆ¶ä¼šåœ¨ç¼–ç ä¸Šé€ æˆä¸€å®šç¨‹åº¦çš„å¿ƒæ™ºè´Ÿæ‹…ï¼Œæ–°æ‰‹å¯èƒ½ä¼šå†™é”™ï¼Œä¸ºäº†é¿å…è¿™æ ·çš„æƒ…å†µï¼Œå¯ä»¥å¼•å…¥ ESLint çš„ Hooks æ£€æŸ¥æ’ä»¶è¿›è¡Œé¢„é˜²ã€‚</p><h3 id="5-useEffect-ä¸-useLayoutEffect-çš„åŒºåˆ«"><a href="#5-useEffect-ä¸-useLayoutEffect-çš„åŒºåˆ«" class="headerlink" title="5. useEffect ä¸ useLayoutEffect çš„åŒºåˆ«"></a>5. useEffect ä¸ useLayoutEffect çš„åŒºåˆ«</h3><p><strong>ï¼ˆ1ï¼‰å…±åŒç‚¹</strong></p><ul><li><strong>è¿ç”¨æ•ˆæœï¼š</strong> useEffect ä¸ useLayoutEffect ä¸¤è€…éƒ½æ˜¯ç”¨äºå¤„ç†å‰¯ä½œç”¨ï¼Œè¿™äº›å‰¯ä½œç”¨åŒ…æ‹¬æ”¹å˜ DOMã€è®¾ç½®è®¢é˜…ã€æ“ä½œå®šæ—¶å™¨ç­‰ã€‚åœ¨å‡½æ•°ç»„ä»¶å†…éƒ¨æ“ä½œå‰¯ä½œç”¨æ˜¯ä¸è¢«å…è®¸çš„ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨è¿™ä¸¤ä¸ªå‡½æ•°å»å¤„ç†ã€‚</li><li><strong>ä½¿ç”¨æ–¹å¼ï¼š</strong> useEffect ä¸ useLayoutEffect ä¸¤è€…åº•å±‚çš„å‡½æ•°ç­¾åæ˜¯å®Œå…¨ä¸€è‡´çš„ï¼Œéƒ½æ˜¯è°ƒç”¨çš„ mountEffectImpl æ–¹æ³•ï¼Œåœ¨ä½¿ç”¨ä¸Šä¹Ÿæ²¡ä»€ä¹ˆå·®å¼‚ï¼ŒåŸºæœ¬å¯ä»¥ç›´æ¥æ›¿æ¢ã€‚</li></ul><p><strong>ï¼ˆ2ï¼‰ä¸åŒç‚¹</strong></p><ul><li><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong> useEffect åœ¨ React çš„æ¸²æŸ“è¿‡ç¨‹ä¸­æ˜¯è¢«å¼‚æ­¥è°ƒç”¨çš„ï¼Œç”¨äºç»å¤§å¤šæ•°åœºæ™¯ï¼›è€Œ useLayoutEffect ä¼šåœ¨æ‰€æœ‰çš„ DOM å˜æ›´ä¹‹ååŒæ­¥è°ƒç”¨ï¼Œä¸»è¦ç”¨äºå¤„ç† DOM æ“ä½œã€è°ƒæ•´æ ·å¼ã€é¿å…é¡µé¢é—ªçƒç­‰é—®é¢˜ã€‚ä¹Ÿæ­£å› ä¸ºæ˜¯åŒæ­¥å¤„ç†ï¼Œæ‰€ä»¥éœ€è¦é¿å…åœ¨ useLayoutEffect åšè®¡ç®—é‡è¾ƒå¤§çš„è€—æ—¶ä»»åŠ¡ä»è€Œé€ æˆé˜»å¡ã€‚</li><li><strong>ä½¿ç”¨æ•ˆæœï¼š</strong> useEffect æ˜¯æŒ‰ç…§é¡ºåºæ‰§è¡Œä»£ç çš„ï¼Œæ”¹å˜å±å¹•åƒç´ ä¹‹åæ‰§è¡Œï¼ˆå…ˆæ¸²æŸ“ï¼Œåæ”¹å˜ DOMï¼‰ï¼Œå½“æ”¹å˜å±å¹•å†…å®¹æ—¶å¯èƒ½ä¼šäº§ç”Ÿé—ªçƒï¼›useLayoutEffect æ˜¯æ”¹å˜å±å¹•åƒç´ ä¹‹å‰å°±æ‰§è¡Œäº†ï¼ˆä¼šæ¨è¿Ÿé¡µé¢æ˜¾ç¤ºçš„äº‹ä»¶ï¼Œå…ˆæ”¹å˜ DOM åæ¸²æŸ“ï¼‰ï¼Œä¸ä¼šäº§ç”Ÿé—ªçƒã€‚<strong>useLayoutEffect æ€»æ˜¯æ¯” useEffect å…ˆæ‰§è¡Œã€‚</strong></li></ul><p>åœ¨æœªæ¥çš„è¶‹åŠ¿ä¸Šï¼Œä¸¤ä¸ª API æ˜¯ä¼šé•¿æœŸå…±å­˜çš„ï¼Œæš‚æ—¶æ²¡æœ‰åˆ å‡åˆå¹¶çš„è®¡åˆ’ï¼Œéœ€è¦å¼€å‘è€…æ ¹æ®åœºæ™¯å»è‡ªè¡Œé€‰æ‹©ã€‚React å›¢é˜Ÿçš„å»ºè®®éå¸¸å®ç”¨ï¼Œå¦‚æœå®åœ¨åˆ†ä¸æ¸…ï¼Œå…ˆç”¨ useEffectï¼Œä¸€èˆ¬é—®é¢˜ä¸å¤§ï¼›å¦‚æœé¡µé¢æœ‰å¼‚å¸¸ï¼Œå†ç›´æ¥æ›¿æ¢ä¸º useLayoutEffect å³å¯ã€‚</p><h3 id="6-React-Hooks-åœ¨å¹³æ—¶å¼€å‘ä¸­éœ€è¦æ³¨æ„çš„é—®é¢˜å’ŒåŸå› "><a href="#6-React-Hooks-åœ¨å¹³æ—¶å¼€å‘ä¸­éœ€è¦æ³¨æ„çš„é—®é¢˜å’ŒåŸå› " class="headerlink" title="6. React Hooks åœ¨å¹³æ—¶å¼€å‘ä¸­éœ€è¦æ³¨æ„çš„é—®é¢˜å’ŒåŸå› "></a>6. React Hooks åœ¨å¹³æ—¶å¼€å‘ä¸­éœ€è¦æ³¨æ„çš„é—®é¢˜å’ŒåŸå› </h3><p>ï¼ˆ1ï¼‰<strong>ä¸è¦åœ¨å¾ªç¯ï¼Œæ¡ä»¶æˆ–åµŒå¥—å‡½æ•°ä¸­è°ƒç”¨ Hookï¼Œå¿…é¡»å§‹ç»ˆåœ¨ React å‡½æ•°çš„é¡¶å±‚ä½¿ç”¨ Hook</strong></p><p>è¿™æ˜¯å› ä¸º React éœ€è¦åˆ©ç”¨è°ƒç”¨é¡ºåºæ¥æ­£ç¡®æ›´æ–°ç›¸åº”çš„çŠ¶æ€ï¼Œä»¥åŠè°ƒç”¨ç›¸åº”çš„é’©å­å‡½æ•°ã€‚ä¸€æ—¦åœ¨å¾ªç¯æˆ–æ¡ä»¶åˆ†æ”¯è¯­å¥ä¸­è°ƒç”¨ Hookï¼Œå°±å®¹æ˜“å¯¼è‡´è°ƒç”¨é¡ºåºçš„ä¸ä¸€è‡´æ€§ï¼Œä»è€Œäº§ç”Ÿéš¾ä»¥é¢„æ–™åˆ°çš„åæœã€‚</p><p><strong>ï¼ˆ2ï¼‰ä½¿ç”¨ useState æ—¶å€™ï¼Œä½¿ç”¨ pushï¼Œpopï¼Œsplice ç­‰ç›´æ¥æ›´æ”¹æ•°ç»„å¯¹è±¡çš„å‘</strong></p><p>ä½¿ç”¨ push ç›´æ¥æ›´æ”¹æ•°ç»„æ— æ³•è·å–åˆ°æ–°å€¼ï¼Œåº”è¯¥é‡‡ç”¨ææ„æ–¹å¼ï¼Œä½†æ˜¯åœ¨ class é‡Œé¢ä¸ä¼šæœ‰è¿™ä¸ªé—®é¢˜ã€‚ä»£ç ç¤ºä¾‹ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">Indicatorfilter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">let</span> <span class="token punctuation">[</span>num<span class="token punctuation">,</span> setNums<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> test <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// è¿™é‡Œå‘æ˜¯ç›´æ¥é‡‡ç”¨pushå»æ›´æ–°num</span>    <span class="token comment" spellcheck="true">// setNums(num)æ˜¯æ— æ³•æ›´æ–°numçš„</span>    <span class="token comment" spellcheck="true">// å¿…é¡»ä½¿ç”¨num = [...num ,1]</span>    num<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// num = [...num ,1]</span>    <span class="token function">setNums</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"filter"</span><span class="token operator">></span>      <span class="token operator">&lt;</span>div onClick<span class="token operator">=</span><span class="token punctuation">{</span>test<span class="token punctuation">}</span><span class="token operator">></span>æµ‹è¯•<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>      <span class="token operator">&lt;</span>div<span class="token operator">></span>        <span class="token punctuation">{</span>num<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">(</span>          <span class="token operator">&lt;</span>div key<span class="token operator">=</span><span class="token punctuation">{</span>index<span class="token punctuation">}</span><span class="token operator">></span><span class="token punctuation">{</span>item<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>        <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>  <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">Indicatorfilter</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token operator">&lt;</span>any<span class="token punctuation">,</span> any<span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">:</span> any<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>      nums<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>test <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>test<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// classé‡‡ç”¨åŒæ ·çš„æ–¹å¼æ˜¯æ²¡æœ‰é—®é¢˜çš„</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>nums<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>      nums<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>nums<span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">let</span> <span class="token punctuation">{</span> nums <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>div<span class="token operator">></span>        <span class="token operator">&lt;</span>div onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>test<span class="token punctuation">}</span><span class="token operator">></span>æµ‹è¯•<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>        <span class="token operator">&lt;</span>div<span class="token operator">></span>          <span class="token punctuation">{</span>nums<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">:</span> any<span class="token punctuation">,</span> index<span class="token punctuation">:</span> number<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">(</span>            <span class="token operator">&lt;</span>div key<span class="token operator">=</span><span class="token punctuation">{</span>index<span class="token punctuation">}</span><span class="token operator">></span><span class="token punctuation">{</span>item<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>          <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ï¼ˆ3ï¼‰<strong>useState è®¾ç½®çŠ¶æ€çš„æ—¶å€™ï¼Œåªæœ‰ç¬¬ä¸€æ¬¡ç”Ÿæ•ˆï¼ŒåæœŸéœ€è¦æ›´æ–°çŠ¶æ€ï¼Œå¿…é¡»é€šè¿‡ useEffect</strong></p><p>TableDeail æ˜¯ä¸€ä¸ªå…¬å…±ç»„ä»¶ï¼Œåœ¨è°ƒç”¨å®ƒçš„çˆ¶ç»„ä»¶é‡Œé¢ï¼Œæˆ‘ä»¬é€šè¿‡ set æ”¹å˜ columns çš„å€¼ï¼Œä»¥ä¸ºä¼ é€’ç»™ TableDeail çš„ columns æ˜¯æœ€æ–°çš„å€¼ï¼Œæ‰€ä»¥ tabColumn æ¯æ¬¡ä¹Ÿæ˜¯æœ€æ–°çš„å€¼ï¼Œä½†æ˜¯å®é™… tabColumn æ˜¯æœ€å¼€å§‹çš„å€¼ï¼Œä¸ä¼šéšç€ columns çš„æ›´æ–°è€Œæ›´æ–°ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> TableDeail <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> columns <span class="token punctuation">}</span><span class="token punctuation">:</span> TableData<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> <span class="token punctuation">[</span>tabColumn<span class="token punctuation">,</span> setTabColumn<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>columns<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// æ­£ç¡®çš„åšæ³•æ˜¯é€šè¿‡useEffectæ”¹å˜è¿™ä¸ªå€¼</span><span class="token keyword">const</span> TableDeail <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> columns <span class="token punctuation">}</span><span class="token punctuation">:</span> TableData<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> <span class="token punctuation">[</span>tabColumn<span class="token punctuation">,</span> setTabColumn<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>columns<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token function">setTabColumn</span><span class="token punctuation">(</span>columns<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>columns<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ï¼ˆ4ï¼‰å–„ç”¨ useCallback</strong></p><p>çˆ¶ç»„ä»¶ä¼ é€’ç»™å­ç»„ä»¶äº‹ä»¶å¥æŸ„æ—¶ï¼Œå¦‚æœæˆ‘ä»¬æ²¡æœ‰ä»»ä½•å‚æ•°å˜åŠ¨å¯èƒ½ä¼šé€‰ç”¨ useMemoã€‚ä½†æ˜¯æ¯ä¸€æ¬¡çˆ¶ç»„ä»¶æ¸²æŸ“å­ç»„ä»¶å³ä½¿æ²¡å˜åŒ–ä¹Ÿä¼šè·Ÿç€æ¸²æŸ“ä¸€æ¬¡ã€‚</p><p><strong>ï¼ˆ5ï¼‰ä¸è¦æ»¥ç”¨ useContext</strong></p><p>å¯ä»¥ä½¿ç”¨åŸºäº useContext å°è£…çš„çŠ¶æ€ç®¡ç†å·¥å…·ã€‚</p><h3 id="7-React-Hooks-å’Œç”Ÿå‘½å‘¨æœŸçš„å…³ç³»ï¼Ÿ"><a href="#7-React-Hooks-å’Œç”Ÿå‘½å‘¨æœŸçš„å…³ç³»ï¼Ÿ" class="headerlink" title="7. React Hooks å’Œç”Ÿå‘½å‘¨æœŸçš„å…³ç³»ï¼Ÿ"></a>7. React Hooks å’Œç”Ÿå‘½å‘¨æœŸçš„å…³ç³»ï¼Ÿ</h3><p><strong>å‡½æ•°ç»„ä»¶</strong> çš„æœ¬è´¨æ˜¯å‡½æ•°ï¼Œæ²¡æœ‰ state çš„æ¦‚å¿µçš„ï¼Œå› æ­¤<strong>ä¸å­˜åœ¨ç”Ÿå‘½å‘¨æœŸ</strong>ä¸€è¯´ï¼Œä»…ä»…æ˜¯ä¸€ä¸ª <strong>render å‡½æ•°</strong>è€Œå·²ã€‚<br>ä½†æ˜¯å¼•å…¥ <strong>Hooks</strong> ä¹‹åå°±å˜å¾—ä¸åŒäº†ï¼Œå®ƒèƒ½è®©ç»„ä»¶åœ¨ä¸ä½¿ç”¨ class çš„æƒ…å†µä¸‹æ‹¥æœ‰ stateï¼Œæ‰€ä»¥å°±æœ‰äº†ç”Ÿå‘½å‘¨æœŸçš„æ¦‚å¿µï¼Œæ‰€è°“çš„ç”Ÿå‘½å‘¨æœŸå…¶å®å°±æ˜¯ <code>useState</code>ã€ <code>useEffect()</code> å’Œ <code>useLayoutEffect()</code> ã€‚</p><p>å³ï¼š<strong>Hooks ç»„ä»¶ï¼ˆä½¿ç”¨äº† Hooks çš„å‡½æ•°ç»„ä»¶ï¼‰æœ‰ç”Ÿå‘½å‘¨æœŸï¼Œè€Œå‡½æ•°ç»„ä»¶ï¼ˆæœªä½¿ç”¨ Hooks çš„å‡½æ•°ç»„ä»¶ï¼‰æ˜¯æ²¡æœ‰ç”Ÿå‘½å‘¨æœŸçš„</strong>ã€‚</p><p>ä¸‹é¢æ˜¯å…·ä½“çš„ class ä¸ Hooks çš„<strong>ç”Ÿå‘½å‘¨æœŸå¯¹åº”å…³ç³»</strong>ï¼š</p><ul><li><code>constructor</code>ï¼šå‡½æ•°ç»„ä»¶ä¸éœ€è¦æ„é€ å‡½æ•°ï¼Œå¯ä»¥é€šè¿‡è°ƒç”¨ <code>**useState æ¥åˆå§‹åŒ– state**</code>ã€‚å¦‚æœè®¡ç®—çš„ä»£ä»·æ¯”è¾ƒæ˜‚è´µï¼Œä¹Ÿå¯ä»¥ä¼ ä¸€ä¸ªå‡½æ•°ç»™ <code>useState</code>ã€‚</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token punctuation">[</span>num<span class="token punctuation">,</span> UpdateNum<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><code>getDerivedStateFromProps</code>ï¼šä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸éœ€è¦ä½¿ç”¨å®ƒï¼Œå¯ä»¥åœ¨<strong>æ¸²æŸ“è¿‡ç¨‹ä¸­æ›´æ–° state</strong>ï¼Œä»¥è¾¾åˆ°å®ç° <code>getDerivedStateFromProps</code> çš„ç›®çš„ã€‚</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">ScrollView</span><span class="token punctuation">(</span><span class="token punctuation">{</span> row <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">let</span> <span class="token punctuation">[</span>isScrollingDown<span class="token punctuation">,</span> setIsScrollingDown<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">let</span> <span class="token punctuation">[</span>prevRow<span class="token punctuation">,</span> setPrevRow<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>row <span class="token operator">!==</span> prevRow<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// Row è‡ªä¸Šæ¬¡æ¸²æŸ“ä»¥æ¥å‘ç”Ÿè¿‡æ”¹å˜ã€‚æ›´æ–° isScrollingDownã€‚</span>    <span class="token function">setIsScrollingDown</span><span class="token punctuation">(</span>prevRow <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> row <span class="token operator">></span> prevRow<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">setPrevRow</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token template-string"><span class="token string">`Scrolling down: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>isScrollingDown<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>React ä¼šç«‹å³é€€å‡ºç¬¬ä¸€æ¬¡æ¸²æŸ“å¹¶ç”¨æ›´æ–°åçš„ state é‡æ–°è¿è¡Œç»„ä»¶ä»¥é¿å…è€—è´¹å¤ªå¤šæ€§èƒ½ã€‚</p><ul><li><code>shouldComponentUpdate</code>ï¼šå¯ä»¥ç”¨ <code>**React.memo**</code> åŒ…è£¹ä¸€ä¸ªç»„ä»¶æ¥å¯¹å®ƒçš„ <code>props</code> è¿›è¡Œæµ…æ¯”è¾ƒ</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> Button <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">memo</span><span class="token punctuation">(</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// å…·ä½“çš„ç»„ä»¶});</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ³¨æ„ï¼š<code>**React.memo ç­‰æ•ˆäº **``**PureComponent**</code>ï¼Œå®ƒåªæµ…æ¯”è¾ƒ propsã€‚è¿™é‡Œä¹Ÿå¯ä»¥ä½¿ç”¨ <code>useMemo</code> ä¼˜åŒ–æ¯ä¸€ä¸ªèŠ‚ç‚¹ã€‚</p><ul><li><code>render</code>ï¼šè¿™æ˜¯å‡½æ•°ç»„ä»¶ä½“æœ¬èº«ã€‚</li><li><code>componentDidMount</code>, <code>componentDidUpdate</code>ï¼š <code>useLayoutEffect</code> ä¸å®ƒä»¬ä¸¤çš„è°ƒç”¨é˜¶æ®µæ˜¯ä¸€æ ·çš„ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬æ¨èä½ <strong>ä¸€å¼€å§‹å…ˆç”¨  useEffect</strong>ï¼Œåªæœ‰å½“å®ƒå‡ºé—®é¢˜çš„æ—¶å€™å†å°è¯•ä½¿ç”¨ <code>useLayoutEffect</code>ã€‚<code>useEffect</code> å¯ä»¥è¡¨è¾¾æ‰€æœ‰è¿™äº›çš„ç»„åˆã€‚</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// componentDidMount</span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// éœ€è¦åœ¨ componentDidMount æ‰§è¡Œçš„å†…å®¹</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// åœ¨ componentDidMountï¼Œä»¥åŠ count æ›´æ”¹æ—¶ componentDidUpdate æ‰§è¡Œçš„å†…å®¹</span>  document<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token template-string"><span class="token string">`You clicked </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>count<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> times`</span></span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// éœ€è¦åœ¨ count æ›´æ”¹æ—¶ componentDidUpdateï¼ˆå…ˆäº document.title = ... æ‰§è¡Œï¼Œéµå®ˆå…ˆæ¸…ç†åæ›´æ–°ï¼‰</span>    <span class="token comment" spellcheck="true">// ä»¥åŠ componentWillUnmount æ‰§è¡Œçš„å†…å®¹</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// å½“å‡½æ•°ä¸­ Cleanup å‡½æ•°ä¼šæŒ‰ç…§åœ¨ä»£ç ä¸­å®šä¹‰çš„é¡ºåºå…ˆåæ‰§è¡Œï¼Œä¸å‡½æ•°æœ¬èº«çš„ç‰¹æ€§æ— å…³</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>count<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// ä»…åœ¨ count æ›´æ”¹æ—¶æ›´æ–°</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>è¯·è®°å¾— React ä¼šç­‰å¾…æµè§ˆå™¨å®Œæˆç”»é¢æ¸²æŸ“ä¹‹åæ‰ä¼šå»¶è¿Ÿè°ƒç”¨ ï¼Œå› æ­¤ä¼šä½¿å¾—é¢å¤–æ“ä½œå¾ˆæ–¹ä¾¿</strong></p><ul><li><code>componentWillUnmount</code>ï¼šç›¸å½“äº <code>useEffect</code>é‡Œé¢è¿”å›çš„ <code>cleanup</code> å‡½æ•°</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// componentDidMount/componentWillUnmount</span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// éœ€è¦åœ¨ componentDidMount æ‰§è¡Œçš„å†…å®¹</span>  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">cleanup</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// éœ€è¦åœ¨ componentWillUnmount æ‰§è¡Œçš„å†…å®¹</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><code>componentDidCatch</code> and <code>getDerivedStateFromError</code>ï¼šç›®å‰<strong>è¿˜æ²¡æœ‰</strong>è¿™äº›æ–¹æ³•çš„ Hook ç­‰ä»·å†™æ³•ï¼Œä½†å¾ˆå¿«ä¼šåŠ ä¸Šã€‚</li></ul><table><thead><tr><th><strong>class ç»„ä»¶</strong></th><th><strong>Hooks ç»„ä»¶</strong></th></tr></thead><tbody><tr><td>constructor</td><td>useState</td></tr><tr><td>getDerivedStateFromProps</td><td>useState é‡Œé¢ update å‡½æ•°</td></tr><tr><td>shouldComponentUpdate</td><td>useMemo</td></tr><tr><td>render</td><td>å‡½æ•°æœ¬èº«</td></tr><tr><td>componentDidMount</td><td>useEffect</td></tr><tr><td>componentDidUpdate</td><td>useEffect</td></tr><tr><td>componentWillUnmount</td><td>useEffect é‡Œé¢è¿”å›çš„å‡½æ•°</td></tr><tr><td>componentDidCatch</td><td>æ— </td></tr><tr><td>getDerivedStateFromError</td><td>æ— </td></tr></tbody></table><h2 id="å…«ã€è™šæ‹Ÿ-DOM"><a href="#å…«ã€è™šæ‹Ÿ-DOM" class="headerlink" title="å…«ã€è™šæ‹Ÿ DOM"></a>å…«ã€è™šæ‹Ÿ DOM</h2><h3 id="1-å¯¹è™šæ‹Ÿ-DOM-çš„ç†è§£ï¼Ÿè™šæ‹Ÿ-DOM-ä¸»è¦åšäº†ä»€ä¹ˆï¼Ÿè™šæ‹Ÿ-DOM-æœ¬èº«æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-å¯¹è™šæ‹Ÿ-DOM-çš„ç†è§£ï¼Ÿè™šæ‹Ÿ-DOM-ä¸»è¦åšäº†ä»€ä¹ˆï¼Ÿè™šæ‹Ÿ-DOM-æœ¬èº«æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1. å¯¹è™šæ‹Ÿ DOM çš„ç†è§£ï¼Ÿè™šæ‹Ÿ DOM ä¸»è¦åšäº†ä»€ä¹ˆï¼Ÿè™šæ‹Ÿ DOM æœ¬èº«æ˜¯ä»€ä¹ˆï¼Ÿ"></a>1. å¯¹è™šæ‹Ÿ DOM çš„ç†è§£ï¼Ÿè™šæ‹Ÿ DOM ä¸»è¦åšäº†ä»€ä¹ˆï¼Ÿè™šæ‹Ÿ DOM æœ¬èº«æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>ä»æœ¬è´¨ä¸Šæ¥è¯´ï¼ŒVirtual Dom æ˜¯ä¸€ä¸ª JavaScript å¯¹è±¡ï¼Œé€šè¿‡å¯¹è±¡çš„æ–¹å¼æ¥è¡¨ç¤º DOM ç»“æ„ã€‚å°†é¡µé¢çš„çŠ¶æ€æŠ½è±¡ä¸º JS å¯¹è±¡çš„å½¢å¼ï¼Œé…åˆä¸åŒçš„æ¸²æŸ“å·¥å…·ï¼Œä½¿è·¨å¹³å°æ¸²æŸ“æˆä¸ºå¯èƒ½ã€‚é€šè¿‡äº‹åŠ¡å¤„ç†æœºåˆ¶ï¼Œå°†å¤šæ¬¡ DOM ä¿®æ”¹çš„ç»“æœä¸€æ¬¡æ€§çš„æ›´æ–°åˆ°é¡µé¢ä¸Šï¼Œä»è€Œæœ‰æ•ˆçš„å‡å°‘é¡µé¢æ¸²æŸ“çš„æ¬¡æ•°ï¼Œå‡å°‘ä¿®æ”¹ DOM çš„é‡ç»˜é‡æ’æ¬¡æ•°ï¼Œæé«˜æ¸²æŸ“æ€§èƒ½ã€‚</p><p>è™šæ‹Ÿ DOM æ˜¯å¯¹ DOM çš„æŠ½è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ˜¯æ›´åŠ è½»é‡çº§çš„å¯¹ DOM çš„æè¿°ã€‚å®ƒè®¾è®¡çš„æœ€åˆç›®çš„ï¼Œå°±æ˜¯æ›´å¥½çš„è·¨å¹³å°ï¼Œæ¯”å¦‚ node.js å°±æ²¡æœ‰ DOMï¼Œå¦‚æœæƒ³å®ç° SSRï¼Œé‚£ä¹ˆä¸€ä¸ªæ–¹å¼å°±æ˜¯å€ŸåŠ©è™šæ‹Ÿ domï¼Œå› ä¸ºè™šæ‹Ÿ dom æœ¬èº«æ˜¯ js å¯¹è±¡ã€‚ åœ¨ä»£ç æ¸²æŸ“åˆ°é¡µé¢ä¹‹å‰ï¼Œvue æˆ–è€… react ä¼šæŠŠä»£ç è½¬æ¢æˆä¸€ä¸ªå¯¹è±¡ï¼ˆè™šæ‹Ÿ DOMï¼‰ã€‚ä»¥å¯¹è±¡çš„å½¢å¼æ¥æè¿°çœŸå® dom ç»“æ„ï¼Œæœ€ç»ˆæ¸²æŸ“åˆ°é¡µé¢ã€‚åœ¨æ¯æ¬¡æ•°æ®å‘ç”Ÿå˜åŒ–å‰ï¼Œè™šæ‹Ÿ dom éƒ½ä¼šç¼“å­˜ä¸€ä»½ï¼Œå˜åŒ–ä¹‹æ—¶ï¼Œç°åœ¨çš„è™šæ‹Ÿ dom ä¼šä¸ç¼“å­˜çš„è™šæ‹Ÿ dom è¿›è¡Œæ¯”è¾ƒã€‚åœ¨ vue æˆ–è€… react å†…éƒ¨å°è£…äº† diff ç®—æ³•ï¼Œé€šè¿‡è¿™ä¸ªç®—æ³•æ¥è¿›è¡Œæ¯”è¾ƒï¼Œæ¸²æŸ“æ—¶ä¿®æ”¹æ”¹å˜çš„å˜åŒ–ï¼ŒåŸå…ˆæ²¡æœ‰å‘ç”Ÿæ”¹å˜çš„é€šè¿‡åŸå…ˆçš„æ•°æ®è¿›è¡Œæ¸²æŸ“ã€‚</p><p>å¦å¤–ç°ä»£å‰ç«¯æ¡†æ¶çš„ä¸€ä¸ªåŸºæœ¬è¦æ±‚å°±æ˜¯æ— é¡»æ‰‹åŠ¨æ“ä½œ DOMï¼Œä¸€æ–¹é¢æ˜¯å› ä¸ºæ‰‹åŠ¨æ“ä½œ DOM æ— æ³•ä¿è¯ç¨‹åºæ€§èƒ½ï¼Œå¤šäººåä½œçš„é¡¹ç›®ä¸­å¦‚æœ review ä¸ä¸¥æ ¼ï¼Œå¯èƒ½ä¼šæœ‰å¼€å‘è€…å†™å‡ºæ€§èƒ½è¾ƒä½çš„ä»£ç ï¼Œå¦ä¸€æ–¹é¢æ›´é‡è¦çš„æ˜¯çœç•¥æ‰‹åŠ¨ DOM æ“ä½œå¯ä»¥å¤§å¤§æé«˜å¼€å‘æ•ˆç‡ã€‚</p><p><strong>ä¸ºä»€ä¹ˆè¦ç”¨ Virtual DOMï¼š</strong></p><p><strong>ï¼ˆ1ï¼‰ä¿è¯æ€§èƒ½ä¸‹é™ï¼Œåœ¨ä¸è¿›è¡Œæ‰‹åŠ¨ä¼˜åŒ–çš„æƒ…å†µä¸‹ï¼Œæä¾›è¿‡å¾—å»çš„æ€§èƒ½</strong></p><p>ä¸‹é¢å¯¹æ¯”ä¸€ä¸‹ä¿®æ”¹ DOM æ—¶çœŸå® DOM æ“ä½œå’Œ Virtual DOM çš„è¿‡ç¨‹ï¼Œæ¥çœ‹ä¸€ä¸‹å®ƒä»¬é‡æ’é‡ç»˜çš„æ€§èƒ½æ¶ˆè€— âˆ¶</p><ul><li>çœŸå® DOMâˆ¶ ç”Ÿæˆ HTML å­—ç¬¦ä¸²ï¼‹ é‡å»ºæ‰€æœ‰çš„ DOM å…ƒç´ </li><li>Virtual DOMâˆ¶ ç”Ÿæˆ vNode ï¼‹ DOMDiff ï¼‹å¿…è¦çš„ DOM æ›´æ–°</li></ul><p>Virtual DOM çš„æ›´æ–° DOM çš„å‡†å¤‡å·¥ä½œè€—è´¹æ›´å¤šçš„æ—¶é—´ï¼Œä¹Ÿå°±æ˜¯ JS å±‚é¢ï¼Œç›¸æ¯”äºæ›´å¤šçš„ DOM æ“ä½œå®ƒçš„æ¶ˆè´¹æ˜¯æå…¶ä¾¿å®œçš„ã€‚å°¤é›¨æºªåœ¨ç¤¾åŒºè®ºå›ä¸­è¯´é“ âˆ¶ æ¡†æ¶ç»™ä½ çš„ä¿è¯æ˜¯ï¼Œä½ ä¸éœ€è¦æ‰‹åŠ¨ä¼˜åŒ–çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä¾ç„¶å¯ä»¥ç»™ä½ æä¾›è¿‡å¾—å»çš„æ€§èƒ½ã€‚<br><strong>ï¼ˆ2ï¼‰è·¨å¹³å°</strong><br>Virtual DOM æœ¬è´¨ä¸Šæ˜¯ JavaScript çš„å¯¹è±¡ï¼Œå®ƒå¯ä»¥å¾ˆæ–¹ä¾¿çš„è·¨å¹³å°æ“ä½œï¼Œæ¯”å¦‚æœåŠ¡ç«¯æ¸²æŸ“ã€uniapp ç­‰ã€‚</p><h3 id="2-React-diff-ç®—æ³•çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#2-React-diff-ç®—æ³•çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="2. React diff ç®—æ³•çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"></a>2. React diff ç®—æ³•çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>å®é™…ä¸Šï¼Œdiff ç®—æ³•æ¢è®¨çš„å°±æ˜¯è™šæ‹Ÿ DOM æ ‘å‘ç”Ÿå˜åŒ–åï¼Œç”Ÿæˆ DOM æ ‘æ›´æ–°è¡¥ä¸çš„æ–¹å¼ã€‚å®ƒé€šè¿‡å¯¹æ¯”æ–°æ—§ä¸¤æ ªè™šæ‹Ÿ DOM æ ‘çš„å˜æ›´å·®å¼‚ï¼Œå°†æ›´æ–°è¡¥ä¸ä½œç”¨äºçœŸå® DOMï¼Œä»¥æœ€å°æˆæœ¬å®Œæˆè§†å›¾æ›´æ–°ã€‚<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="3.jpg" alt="CgqCHl_qyouAAkb9AAB_cmWuZhc920_mh1609406106571.jpg"><br>å…·ä½“çš„æµç¨‹å¦‚ä¸‹ï¼š</p><ul><li>çœŸå®çš„ DOM é¦–å…ˆä¼šæ˜ å°„ä¸ºè™šæ‹Ÿ DOMï¼›</li><li>å½“è™šæ‹Ÿ DOM å‘ç”Ÿå˜åŒ–åï¼Œå°±ä¼šæ ¹æ®å·®è·è®¡ç®—ç”Ÿæˆ patchï¼Œè¿™ä¸ª patch æ˜¯ä¸€ä¸ªç»“æ„åŒ–çš„æ•°æ®ï¼Œå†…å®¹åŒ…å«äº†å¢åŠ ã€æ›´æ–°ã€ç§»é™¤ç­‰ï¼›</li><li>æ ¹æ® patch å»æ›´æ–°çœŸå®çš„ DOMï¼Œåé¦ˆåˆ°ç”¨æˆ·çš„ç•Œé¢ä¸Šã€‚</li></ul><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="4.jpg" alt="CgqCHl_qypGAZPuGAADYrK9nkJY878_mh1609406162857.jpg"><br>ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">ExampleComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>isVisible<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">return</span> <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"visible"</span><span class="token operator">></span>visbile<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"hidden"</span><span class="token operator">></span>hidden<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œï¼Œé¦–å…ˆå‡å®š ExampleComponent å¯è§ï¼Œç„¶åå†æ”¹å˜å®ƒçš„çŠ¶æ€ï¼Œè®©å®ƒä¸å¯è§ ã€‚æ˜ å°„ä¸ºçœŸå®çš„ DOM æ“ä½œæ˜¯è¿™æ ·çš„ï¼ŒReact ä¼šåˆ›å»ºä¸€ä¸ª div èŠ‚ç‚¹ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"visible"</span><span class="token operator">></span>visbile<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å½“æŠŠ visbile çš„å€¼å˜ä¸º false æ—¶ï¼Œå°±ä¼šæ›¿æ¢ class å±æ€§ä¸º hiddenï¼Œå¹¶é‡å†™å†…éƒ¨çš„ innerText ä¸º hiddenã€‚<strong>è¿™æ ·ä¸€ä¸ªç”Ÿæˆè¡¥ä¸ã€æ›´æ–°å·®å¼‚çš„è¿‡ç¨‹ç»Ÿç§°ä¸º diff ç®—æ³•ã€‚</strong></p><p>diff ç®—æ³•å¯ä»¥æ€»ç»“ä¸ºä¸‰ä¸ªç­–ç•¥ï¼Œåˆ†åˆ«ä»æ ‘ã€ç»„ä»¶åŠå…ƒç´ ä¸‰ä¸ªå±‚é¢è¿›è¡Œå¤æ‚åº¦çš„ä¼˜åŒ–ï¼š</p><p><strong>ç­–ç•¥ä¸€ï¼šå¿½ç•¥èŠ‚ç‚¹è·¨å±‚çº§æ“ä½œåœºæ™¯ï¼Œæå‡æ¯”å¯¹æ•ˆç‡ã€‚ï¼ˆåŸºäºæ ‘è¿›è¡Œå¯¹æ¯”ï¼‰</strong></p><p>è¿™ä¸€ç­–ç•¥éœ€è¦è¿›è¡Œæ ‘æ¯”å¯¹ï¼Œå³å¯¹æ ‘è¿›è¡Œåˆ†å±‚æ¯”è¾ƒã€‚æ ‘æ¯”å¯¹çš„å¤„ç†æ‰‹æ³•æ˜¯éå¸¸â€œæš´åŠ›â€çš„ï¼Œå³ä¸¤æ£µæ ‘åªå¯¹åŒä¸€å±‚æ¬¡çš„èŠ‚ç‚¹è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœå‘ç°èŠ‚ç‚¹å·²ç»ä¸å­˜åœ¨äº†ï¼Œåˆ™è¯¥èŠ‚ç‚¹åŠå…¶å­èŠ‚ç‚¹ä¼šè¢«å®Œå…¨åˆ é™¤æ‰ï¼Œä¸ä¼šç”¨äºè¿›ä¸€æ­¥çš„æ¯”è¾ƒï¼Œè¿™å°±æå‡äº†æ¯”å¯¹æ•ˆç‡ã€‚</p><p><strong>ç­–ç•¥äºŒï¼šå¦‚æœç»„ä»¶çš„ class ä¸€è‡´ï¼Œåˆ™é»˜è®¤ä¸ºç›¸ä¼¼çš„æ ‘ç»“æ„ï¼Œå¦åˆ™é»˜è®¤ä¸ºä¸åŒçš„æ ‘ç»“æ„ã€‚ï¼ˆåŸºäºç»„ä»¶è¿›è¡Œå¯¹æ¯”ï¼‰</strong></p><p>åœ¨ç»„ä»¶æ¯”å¯¹çš„è¿‡ç¨‹ä¸­ï¼š</p><ul><li>å¦‚æœç»„ä»¶æ˜¯åŒä¸€ç±»å‹åˆ™è¿›è¡Œæ ‘æ¯”å¯¹ï¼›</li><li>å¦‚æœä¸æ˜¯åˆ™ç›´æ¥æ”¾å…¥è¡¥ä¸ä¸­ã€‚</li></ul><p>åªè¦çˆ¶ç»„ä»¶ç±»å‹ä¸åŒï¼Œå°±ä¼šè¢«é‡æ–°æ¸²æŸ“ã€‚è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆ shouldComponentUpdateã€PureComponent åŠ React.memo å¯ä»¥æé«˜æ€§èƒ½çš„åŸå› ã€‚</p><p><strong>ç­–ç•¥ä¸‰ï¼šåŒä¸€å±‚çº§çš„å­èŠ‚ç‚¹ï¼Œå¯ä»¥é€šè¿‡æ ‡è®° key çš„æ–¹å¼è¿›è¡Œåˆ—è¡¨å¯¹æ¯”ã€‚ï¼ˆåŸºäºèŠ‚ç‚¹è¿›è¡Œå¯¹æ¯”ï¼‰</strong></p><p>å…ƒç´ æ¯”å¯¹ä¸»è¦å‘ç”Ÿåœ¨åŒå±‚çº§ä¸­ï¼Œé€šè¿‡æ ‡è®°èŠ‚ç‚¹æ“ä½œç”Ÿæˆè¡¥ä¸ã€‚èŠ‚ç‚¹æ“ä½œåŒ…å«äº†æ’å…¥ã€ç§»åŠ¨ã€åˆ é™¤ç­‰ã€‚å…¶ä¸­èŠ‚ç‚¹é‡æ–°æ’åºåŒæ—¶æ¶‰åŠæ’å…¥ã€ç§»åŠ¨ã€åˆ é™¤ä¸‰ä¸ªæ“ä½œï¼Œæ‰€ä»¥æ•ˆç‡æ¶ˆè€—æœ€å¤§ï¼Œæ­¤æ—¶ç­–ç•¥ä¸‰èµ·åˆ°äº†è‡³å…³é‡è¦çš„ä½œç”¨ã€‚é€šè¿‡æ ‡è®° key çš„æ–¹å¼ï¼ŒReact å¯ä»¥ç›´æ¥ç§»åŠ¨ DOM èŠ‚ç‚¹ï¼Œé™ä½å†…è€—ã€‚</p><h3 id="3-React-key-æ˜¯å¹²å˜›ç”¨çš„-ä¸ºä»€ä¹ˆè¦åŠ ï¼Ÿkey-ä¸»è¦æ˜¯è§£å†³å“ªä¸€ç±»é—®é¢˜çš„"><a href="#3-React-key-æ˜¯å¹²å˜›ç”¨çš„-ä¸ºä»€ä¹ˆè¦åŠ ï¼Ÿkey-ä¸»è¦æ˜¯è§£å†³å“ªä¸€ç±»é—®é¢˜çš„" class="headerlink" title="3. React key æ˜¯å¹²å˜›ç”¨çš„ ä¸ºä»€ä¹ˆè¦åŠ ï¼Ÿkey ä¸»è¦æ˜¯è§£å†³å“ªä¸€ç±»é—®é¢˜çš„"></a>3. React key æ˜¯å¹²å˜›ç”¨çš„ ä¸ºä»€ä¹ˆè¦åŠ ï¼Ÿkey ä¸»è¦æ˜¯è§£å†³å“ªä¸€ç±»é—®é¢˜çš„</h3><p>Keys æ˜¯ React ç”¨äºè¿½è¸ªå“ªäº›åˆ—è¡¨ä¸­å…ƒç´ è¢«ä¿®æ”¹ã€è¢«æ·»åŠ æˆ–è€…è¢«ç§»é™¤çš„è¾…åŠ©æ ‡è¯†ã€‚åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ä¿è¯æŸä¸ªå…ƒç´ çš„ key åœ¨å…¶åŒçº§å…ƒç´ ä¸­å…·æœ‰å”¯ä¸€æ€§ã€‚</p><p>åœ¨ React Diff ç®—æ³•ä¸­ React ä¼šå€ŸåŠ©å…ƒç´ çš„ Key å€¼æ¥åˆ¤æ–­è¯¥å…ƒç´ æ˜¯æ–°è¿‘åˆ›å»ºçš„è¿˜æ˜¯è¢«ç§»åŠ¨è€Œæ¥çš„å…ƒç´ ï¼Œä»è€Œå‡å°‘ä¸å¿…è¦çš„å…ƒç´ é‡æ¸²æŸ“æ­¤å¤–ï¼ŒReact è¿˜éœ€è¦å€ŸåŠ© Key å€¼æ¥åˆ¤æ–­å…ƒç´ ä¸æœ¬åœ°çŠ¶æ€çš„å…³è”å…³ç³»ã€‚</p><p>æ³¨æ„äº‹é¡¹ï¼š</p><ul><li>key å€¼ä¸€å®šè¦å’Œå…·ä½“çš„å…ƒç´ â€”ä¸€å¯¹åº”ï¼›</li><li>å°½é‡ä¸è¦ç”¨æ•°ç»„çš„ index å»ä½œä¸º keyï¼›</li><li>ä¸è¦åœ¨ render çš„æ—¶å€™ç”¨éšæœºæ•°æˆ–è€…å…¶ä»–æ“ä½œç»™å…ƒç´ åŠ ä¸Šä¸ç¨³å®šçš„ keyï¼Œè¿™æ ·é€ æˆçš„æ€§èƒ½å¼€é”€æ¯”ä¸åŠ  key çš„æƒ…å†µä¸‹æ›´ç³Ÿç³•ã€‚</li></ul><h3 id="4-è™šæ‹Ÿ-DOM-çš„å¼•å…¥ä¸ç›´æ¥æ“ä½œåŸç”Ÿ-DOM-ç›¸æ¯”ï¼Œå“ªä¸€ä¸ªæ•ˆç‡æ›´é«˜ï¼Œä¸ºä»€ä¹ˆ"><a href="#4-è™šæ‹Ÿ-DOM-çš„å¼•å…¥ä¸ç›´æ¥æ“ä½œåŸç”Ÿ-DOM-ç›¸æ¯”ï¼Œå“ªä¸€ä¸ªæ•ˆç‡æ›´é«˜ï¼Œä¸ºä»€ä¹ˆ" class="headerlink" title="4. è™šæ‹Ÿ DOM çš„å¼•å…¥ä¸ç›´æ¥æ“ä½œåŸç”Ÿ DOM ç›¸æ¯”ï¼Œå“ªä¸€ä¸ªæ•ˆç‡æ›´é«˜ï¼Œä¸ºä»€ä¹ˆ"></a>4. è™šæ‹Ÿ DOM çš„å¼•å…¥ä¸ç›´æ¥æ“ä½œåŸç”Ÿ DOM ç›¸æ¯”ï¼Œå“ªä¸€ä¸ªæ•ˆç‡æ›´é«˜ï¼Œä¸ºä»€ä¹ˆ</h3><p>è™šæ‹Ÿ DOM ç›¸å¯¹åŸç”Ÿçš„ DOM ä¸ä¸€å®šæ˜¯æ•ˆç‡æ›´é«˜ï¼Œå¦‚æœåªä¿®æ”¹ä¸€ä¸ªæŒ‰é’®çš„æ–‡æ¡ˆï¼Œé‚£ä¹ˆè™šæ‹Ÿ DOM çš„æ“ä½œæ— è®ºå¦‚ä½•éƒ½ä¸å¯èƒ½æ¯”çœŸå®çš„ DOM æ“ä½œæ›´å¿«ã€‚åœ¨é¦–æ¬¡æ¸²æŸ“å¤§é‡ DOM æ—¶ï¼Œç”±äºå¤šäº†ä¸€å±‚è™šæ‹Ÿ DOM çš„è®¡ç®—ï¼Œè™šæ‹Ÿ DOM ä¹Ÿä¼šæ¯” innerHTML æ’å…¥æ…¢ã€‚å®ƒèƒ½ä¿è¯æ€§èƒ½ä¸‹é™ï¼Œåœ¨çœŸå® DOM æ“ä½œçš„æ—¶å€™è¿›è¡Œé’ˆå¯¹æ€§çš„ä¼˜åŒ–æ—¶ï¼Œè¿˜æ˜¯æ›´å¿«çš„ã€‚æ‰€ä»¥è¦æ ¹æ®å…·ä½“çš„åœºæ™¯è¿›è¡Œæ¢è®¨ã€‚</p><p>åœ¨æ•´ä¸ª DOM æ“ä½œçš„æ¼”åŒ–è¿‡ç¨‹ä¸­ï¼Œå…¶å®ä¸»è¦çŸ›ç›¾å¹¶ä¸åœ¨äºæ€§èƒ½ï¼Œè€Œåœ¨äºå¼€å‘è€…å†™å¾—çˆ½ä¸çˆ½ï¼Œåœ¨äºç ”å‘ä½“éªŒ/ç ”å‘æ•ˆç‡ã€‚è™šæ‹Ÿ DOM ä¸æ˜¯åˆ«çš„ï¼Œæ­£æ˜¯å‰ç«¯å¼€å‘ä»¬ä¸ºäº†è¿½æ±‚æ›´å¥½çš„ç ”å‘ä½“éªŒå’Œç ”å‘æ•ˆç‡è€Œåˆ›é€ å‡ºæ¥çš„é«˜é˜¶äº§ç‰©ã€‚è™šæ‹Ÿ DOM å¹¶ä¸ä¸€å®šä¼šå¸¦æ¥æ›´å¥½çš„æ€§èƒ½ï¼ŒReact å®˜æ–¹ä¹Ÿä»æ¥æ²¡æœ‰æŠŠè™šæ‹Ÿ DOM ä½œä¸ºæ€§èƒ½å±‚é¢çš„å–ç‚¹å¯¹å¤–è¾“å‡ºè¿‡ã€‚<strong>è™šæ‹Ÿ DOM çš„ä¼˜è¶Šä¹‹å¤„åœ¨äºï¼Œå®ƒèƒ½å¤Ÿåœ¨æä¾›æ›´çˆ½ã€æ›´é«˜æ•ˆçš„ç ”å‘æ¨¡å¼ï¼ˆä¹Ÿå°±æ˜¯å‡½æ•°å¼çš„ UI ç¼–ç¨‹æ–¹å¼ï¼‰çš„åŒæ—¶ï¼Œä»ç„¶ä¿æŒä¸€ä¸ªè¿˜ä¸é”™çš„æ€§èƒ½ã€‚</strong></p><h3 id="5-React-ä¸-Vue-çš„-diff-ç®—æ³•æœ‰ä½•ä¸åŒï¼Ÿ"><a href="#5-React-ä¸-Vue-çš„-diff-ç®—æ³•æœ‰ä½•ä¸åŒï¼Ÿ" class="headerlink" title="5. React ä¸ Vue çš„ diff ç®—æ³•æœ‰ä½•ä¸åŒï¼Ÿ"></a>5. React ä¸ Vue çš„ diff ç®—æ³•æœ‰ä½•ä¸åŒï¼Ÿ</h3><p>diff ç®—æ³•æ˜¯æŒ‡ç”Ÿæˆæ›´æ–°è¡¥ä¸çš„æ–¹å¼ï¼Œä¸»è¦åº”ç”¨äºè™šæ‹Ÿ DOM æ ‘å˜åŒ–åï¼Œæ›´æ–°çœŸå® DOMã€‚æ‰€ä»¥ diff ç®—æ³•ä¸€å®šå­˜åœ¨è¿™æ ·ä¸€ä¸ªè¿‡ç¨‹ï¼šè§¦å‘æ›´æ–° â†’ ç”Ÿæˆè¡¥ä¸ â†’ åº”ç”¨è¡¥ä¸ã€‚</p><p>React çš„ diff ç®—æ³•ï¼Œè§¦å‘æ›´æ–°çš„æ—¶æœºä¸»è¦åœ¨ state å˜åŒ–ä¸ hooks è°ƒç”¨ä¹‹åã€‚æ­¤æ—¶è§¦å‘è™šæ‹Ÿ DOM æ ‘å˜æ›´éå†ï¼Œé‡‡ç”¨äº†æ·±åº¦ä¼˜å…ˆéå†ç®—æ³•ã€‚ä½†ä¼ ç»Ÿçš„éå†æ–¹å¼ï¼Œæ•ˆç‡è¾ƒä½ã€‚ä¸ºäº†ä¼˜åŒ–æ•ˆç‡ï¼Œä½¿ç”¨äº†åˆ†æ²»çš„æ–¹å¼ã€‚å°†å•ä¸€èŠ‚ç‚¹æ¯”å¯¹è½¬åŒ–ä¸ºäº† 3 ç§ç±»å‹èŠ‚ç‚¹çš„æ¯”å¯¹ï¼Œåˆ†åˆ«æ˜¯æ ‘ã€ç»„ä»¶åŠå…ƒç´ ï¼Œä»¥æ­¤æå‡æ•ˆç‡ã€‚</p><ul><li>æ ‘æ¯”å¯¹ï¼šç”±äºç½‘é¡µè§†å›¾ä¸­è¾ƒå°‘æœ‰è·¨å±‚çº§èŠ‚ç‚¹ç§»åŠ¨ï¼Œä¸¤æ ªè™šæ‹Ÿ DOM æ ‘åªå¯¹åŒä¸€å±‚æ¬¡çš„èŠ‚ç‚¹è¿›è¡Œæ¯”è¾ƒã€‚</li><li>ç»„ä»¶æ¯”å¯¹ï¼šå¦‚æœç»„ä»¶æ˜¯åŒä¸€ç±»å‹ï¼Œåˆ™è¿›è¡Œæ ‘æ¯”å¯¹ï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™ç›´æ¥æ”¾å…¥åˆ°è¡¥ä¸ä¸­ã€‚</li><li>å…ƒç´ æ¯”å¯¹ï¼šä¸»è¦å‘ç”Ÿåœ¨åŒå±‚çº§ä¸­ï¼Œé€šè¿‡æ ‡è®°èŠ‚ç‚¹æ“ä½œç”Ÿæˆè¡¥ä¸ï¼ŒèŠ‚ç‚¹æ“ä½œå¯¹åº”çœŸå®çš„ DOM å‰ªè£æ“ä½œã€‚</li></ul><p>ä»¥ä¸Šæ˜¯ç»å…¸çš„ React diff ç®—æ³•å†…å®¹ã€‚è‡ª React 16 èµ·ï¼Œå¼•å…¥äº† Fiber æ¶æ„ã€‚ä¸ºäº†ä½¿æ•´ä¸ªæ›´æ–°è¿‡ç¨‹å¯éšæ—¶æš‚åœæ¢å¤ï¼ŒèŠ‚ç‚¹ä¸æ ‘åˆ†åˆ«é‡‡ç”¨äº† FiberNode ä¸ FiberTree è¿›è¡Œé‡æ„ã€‚fiberNode ä½¿ç”¨äº†åŒé“¾è¡¨çš„ç»“æ„ï¼Œå¯ä»¥ç›´æ¥æ‰¾åˆ°å…„å¼ŸèŠ‚ç‚¹ä¸å­èŠ‚ç‚¹ã€‚æ•´ä¸ªæ›´æ–°è¿‡ç¨‹ç”± current ä¸ workInProgress ä¸¤æ ªæ ‘åŒç¼“å†²å®Œæˆã€‚workInProgress æ›´æ–°å®Œæˆåï¼Œå†é€šè¿‡ä¿®æ”¹ current ç›¸å…³æŒ‡é’ˆæŒ‡å‘æ–°èŠ‚ç‚¹ã€‚</p><p>Vue çš„æ•´ä½“ diff ç­–ç•¥ä¸ React å¯¹é½ï¼Œè™½ç„¶ç¼ºä¹æ—¶é—´åˆ‡ç‰‡èƒ½åŠ›ï¼Œä½†è¿™å¹¶ä¸æ„å‘³ç€ Vue çš„æ€§èƒ½æ›´å·®ï¼Œå› ä¸ºåœ¨ Vue 3 åˆæœŸå¼•å…¥è¿‡ï¼ŒåæœŸå› ä¸ºæ”¶ç›Šä¸é«˜ç§»é™¤æ‰äº†ã€‚é™¤äº†é«˜å¸§ç‡åŠ¨ç”»ï¼Œåœ¨ Vue ä¸­å…¶ä»–çš„åœºæ™¯å‡ ä¹éƒ½å¯ä»¥ä½¿ç”¨é˜²æŠ–å’ŒèŠ‚æµå»æé«˜å“åº”æ€§èƒ½ã€‚</p><h2 id="ä¹ã€å…¶ä»–"><a href="#ä¹ã€å…¶ä»–" class="headerlink" title="ä¹ã€å…¶ä»–"></a>ä¹ã€å…¶ä»–</h2><h3 id="1-React-ç»„ä»¶å‘½åæ¨èçš„æ–¹å¼æ˜¯å“ªä¸ªï¼Ÿ"><a href="#1-React-ç»„ä»¶å‘½åæ¨èçš„æ–¹å¼æ˜¯å“ªä¸ªï¼Ÿ" class="headerlink" title="1. React ç»„ä»¶å‘½åæ¨èçš„æ–¹å¼æ˜¯å“ªä¸ªï¼Ÿ"></a>1. React ç»„ä»¶å‘½åæ¨èçš„æ–¹å¼æ˜¯å“ªä¸ªï¼Ÿ</h3><p>é€šè¿‡å¼•ç”¨è€Œä¸æ˜¯ä½¿ç”¨æ¥å‘½åç»„ä»¶ displayNameã€‚</p><p>ä½¿ç”¨ displayName å‘½åç»„ä»¶ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">export</span> <span class="token keyword">default</span> React<span class="token punctuation">.</span><span class="token function">createClass</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  displayName<span class="token punctuation">:</span> <span class="token string">'TodoApp'</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true">// ...})</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>React æ¨èçš„æ–¹æ³•ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">TodoApp</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// ...}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="2-react-æœ€æ–°ç‰ˆæœ¬è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Œå¢åŠ äº†å“ªäº›ä¸œè¥¿"><a href="#2-react-æœ€æ–°ç‰ˆæœ¬è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Œå¢åŠ äº†å“ªäº›ä¸œè¥¿" class="headerlink" title="2. react æœ€æ–°ç‰ˆæœ¬è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Œå¢åŠ äº†å“ªäº›ä¸œè¥¿"></a>2. react æœ€æ–°ç‰ˆæœ¬è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Œå¢åŠ äº†å“ªäº›ä¸œè¥¿</h3><p>React 16.x çš„ä¸‰å¤§æ–°ç‰¹æ€§ Time Slicingã€Suspenseã€ hooks</p><ul><li><strong>Time Slicingï¼ˆè§£å†³ CPU é€Ÿåº¦é—®é¢˜</strong>ï¼‰ä½¿å¾—åœ¨æ‰§è¡Œä»»åŠ¡çš„æœŸé—´å¯ä»¥éšæ—¶æš‚åœï¼Œè·‘å»å¹²åˆ«çš„äº‹æƒ…ï¼Œè¿™ä¸ªç‰¹æ€§ä½¿å¾— react èƒ½åœ¨æ€§èƒ½æå…¶å·®çš„æœºå™¨è·‘æ—¶ï¼Œä»ç„¶ä¿æŒæœ‰è‰¯å¥½çš„æ€§èƒ½</li><li><strong>Suspense ï¼ˆè§£å†³ç½‘ç»œ IO é—®é¢˜ï¼‰</strong> å’Œ lazy é…åˆï¼Œå®ç°å¼‚æ­¥åŠ è½½ç»„ä»¶ã€‚ èƒ½æš‚åœå½“å‰ç»„ä»¶çš„æ¸²æŸ“ï¼Œ å½“å®ŒæˆæŸä»¶äº‹ä»¥åå†ç»§ç»­æ¸²æŸ“ï¼Œè§£å†³ä» react å‡ºç”Ÿåˆ°ç°åœ¨éƒ½å­˜åœ¨çš„ã€Œå¼‚æ­¥å‰¯ä½œç”¨ã€çš„é—®é¢˜ï¼Œè€Œä¸”è§£å†³å¾—éçš„ä¼˜é›…ï¼Œä½¿ç”¨çš„æ˜¯ T å¼‚æ­¥ä½†æ˜¯åŒæ­¥çš„å†™æ³•ï¼Œè¿™æ˜¯æœ€å¥½çš„è§£å†³å¼‚æ­¥é—®é¢˜çš„æ–¹å¼</li><li>æä¾›äº†ä¸€ä¸ª<strong>å†…ç½®å‡½æ•° componentDidCatch</strong>ï¼Œå½“æœ‰é”™è¯¯å‘ç”Ÿæ—¶ï¼Œå¯ä»¥å‹å¥½åœ°å±•ç¤º fallback ç»„ä»¶; å¯ä»¥æ•æ‰åˆ°å®ƒçš„å­å…ƒç´ ï¼ˆåŒ…æ‹¬åµŒå¥—å­å…ƒç´ ï¼‰æŠ›å‡ºçš„å¼‚å¸¸; å¯ä»¥å¤ç”¨é”™è¯¯ç»„ä»¶ã€‚</li></ul><p><strong>ï¼ˆ1ï¼‰React16.8</strong><br>åŠ å…¥ hooksï¼Œè®© React å‡½æ•°å¼ç»„ä»¶æ›´åŠ çµæ´»ï¼Œhooks ä¹‹å‰ï¼ŒReact å­˜åœ¨å¾ˆå¤šé—®é¢˜ï¼š</p><ul><li>åœ¨ç»„ä»¶é—´å¤ç”¨çŠ¶æ€é€»è¾‘å¾ˆéš¾</li><li>å¤æ‚ç»„ä»¶å˜å¾—éš¾ä»¥ç†è§£ï¼Œé«˜é˜¶ç»„ä»¶å’Œå‡½æ•°ç»„ä»¶çš„åµŒå¥—è¿‡æ·±ã€‚</li><li>class ç»„ä»¶çš„ this æŒ‡å‘é—®é¢˜</li><li>éš¾ä»¥è®°å¿†çš„ç”Ÿå‘½å‘¨æœŸ</li></ul><p>hooks å¾ˆå¥½çš„è§£å†³äº†ä¸Šè¿°é—®é¢˜ï¼Œhooks æä¾›äº†å¾ˆå¤šæ–¹æ³•</p><ul><li>useState è¿”å›æœ‰çŠ¶æ€å€¼ï¼Œä»¥åŠæ›´æ–°è¿™ä¸ªçŠ¶æ€å€¼çš„å‡½æ•°</li><li>useEffect æ¥å—åŒ…å«å‘½ä»¤å¼ï¼Œå¯èƒ½æœ‰å‰¯ä½œç”¨ä»£ç çš„å‡½æ•°ã€‚</li><li>useContext æ¥å—ä¸Šä¸‹æ–‡å¯¹è±¡ï¼ˆä» React.createContext è¿”å›çš„å€¼ï¼‰å¹¶è¿”å›å½“å‰ä¸Šä¸‹æ–‡å€¼ï¼Œ</li><li>useReducer useState çš„æ›¿ä»£æ–¹æ¡ˆã€‚æ¥å—ç±»å‹ä¸º ï¼ˆstateï¼Œactionï¼‰=&gt; newState çš„ reducerï¼Œå¹¶è¿”å›ä¸ dispatch æ–¹æ³•é…å¯¹çš„å½“å‰çŠ¶æ€ã€‚</li><li>useCalLback è¿”å›ä¸€ä¸ªå›å¿†çš„ memoized ç‰ˆæœ¬ï¼Œè¯¥ç‰ˆæœ¬ä»…åœ¨å…¶ä¸­ä¸€ä¸ªè¾“å…¥å‘ç”Ÿæ›´æ”¹æ—¶æ‰ä¼šæ›´æ”¹ã€‚çº¯å‡½æ•°çš„è¾“å…¥è¾“å‡ºç¡®å®šæ€§ o useMemo çº¯çš„ä¸€ä¸ªè®°å¿†å‡½æ•° o useRef è¿”å›ä¸€ä¸ªå¯å˜çš„ ref å¯¹è±¡ï¼Œå…¶ Current å±æ€§è¢«åˆå§‹åŒ–ä¸ºä¼ é€’çš„å‚æ•°ï¼Œè¿”å›çš„ ref å¯¹è±¡åœ¨ç»„ä»¶çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…ä¿æŒä¸å˜ã€‚</li><li>useImperativeMethods è‡ªå®šä¹‰ä½¿ç”¨ ref æ—¶å…¬å¼€ç»™çˆ¶ç»„ä»¶çš„å®ä¾‹å€¼</li><li>useMutationEffect æ›´æ–°å…„å¼Ÿç»„ä»¶ä¹‹å‰ï¼Œå®ƒåœ¨ React æ‰§è¡Œå…¶ DOM æ”¹å˜çš„åŒä¸€é˜¶æ®µåŒæ­¥è§¦å‘</li><li>useLayoutEffect DOM æ”¹å˜ååŒæ­¥è§¦å‘ã€‚ä½¿ç”¨å®ƒæ¥ä» DOM è¯»å–å¸ƒå±€å¹¶åŒæ­¥é‡æ–°æ¸²æŸ“</li></ul><p><strong>ï¼ˆ2ï¼‰React16.9</strong></p><ul><li>é‡å‘½å Unsafe çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚æ–°çš„ UNSAFE_å‰ç¼€å°†æœ‰åŠ©äºåœ¨ä»£ç  review å’Œ debug æœŸé—´ï¼Œä½¿è¿™äº›æœ‰é—®é¢˜çš„å­—æ ·æ›´çªå‡º</li><li>åºŸå¼ƒ javascrip:å½¢å¼çš„ URLã€‚ä»¥ javascript:å¼€å¤´çš„ URL éå¸¸å®¹æ˜“é­å—æ”»å‡»ï¼Œé€ æˆå®‰å…¨æ¼æ´ã€‚</li><li>åºŸå¼ƒâ€Factoryâ€ç»„ä»¶ã€‚ å·¥å‚ç»„ä»¶ä¼šå¯¼è‡´ React å˜å¤§ä¸”å˜æ…¢ã€‚</li><li>actï¼ˆï¼‰ä¹Ÿæ”¯æŒå¼‚æ­¥å‡½æ•°ï¼Œå¹¶ä¸”ä½ å¯ä»¥åœ¨è°ƒç”¨å®ƒæ—¶ä½¿ç”¨ awaitã€‚</li><li>ä½¿ç”¨ &lt;React.ProfiLer&gt; è¿›è¡Œæ€§èƒ½è¯„ä¼°ã€‚åœ¨è¾ƒå¤§çš„åº”ç”¨ä¸­è¿½è¸ªæ€§èƒ½å›å½’å¯èƒ½ä¼šå¾ˆæ–¹ä¾¿</li></ul><p><strong>ï¼ˆ3ï¼‰React16.13.0</strong></p><ul><li>æ”¯æŒåœ¨æ¸²æŸ“æœŸé—´è°ƒç”¨ setStateï¼Œä½†ä»…é€‚ç”¨äºåŒä¸€ç»„ä»¶</li><li>å¯æ£€æµ‹å†²çªçš„æ ·å¼è§„åˆ™å¹¶è®°å½•è­¦å‘Š</li><li>åºŸå¼ƒ unstable_createPortalï¼Œä½¿ç”¨ CreatePortal</li><li>å°†ç»„ä»¶å †æ ˆæ·»åŠ åˆ°å…¶å¼€å‘è­¦å‘Šä¸­ï¼Œä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿéš”ç¦» bug å¹¶è°ƒè¯•å…¶ç¨‹åºï¼Œè¿™å¯ä»¥æ¸…æ¥šåœ°è¯´æ˜é—®é¢˜æ‰€åœ¨ï¼Œå¹¶æ›´å¿«åœ°å®šä½å’Œä¿®å¤é”™è¯¯ã€‚</li></ul><h3 id="3-react-å®ç°ä¸€ä¸ªå…¨å±€çš„-dialog"><a href="#3-react-å®ç°ä¸€ä¸ªå…¨å±€çš„-dialog" class="headerlink" title="3. react å®ç°ä¸€ä¸ªå…¨å±€çš„ dialog"></a>3. react å®ç°ä¸€ä¸ªå…¨å±€çš„ dialog</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span> is<span class="token punctuation">,</span> fromJS <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"immutable"</span><span class="token punctuation">;</span><span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">"react-dom"</span><span class="token punctuation">;</span><span class="token keyword">import</span> ReactCSSTransitionGroup <span class="token keyword">from</span> <span class="token string">"react-addons-css-transition-group"</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token string">"./dialog.css"</span><span class="token punctuation">;</span><span class="token keyword">let</span> defaultState <span class="token operator">=</span> <span class="token punctuation">{</span>  alertStatus<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>  alertTip<span class="token punctuation">:</span> <span class="token string">"æç¤º"</span><span class="token punctuation">,</span>  closeDialog<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  childs<span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Dialog</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>  state <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token operator">...</span>defaultState<span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// cssåŠ¨ç”»ç»„ä»¶è®¾ç½®ä¸ºç›®æ ‡ç»„ä»¶</span>  FirstChild <span class="token operator">=</span> <span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> childrenArray <span class="token operator">=</span> React<span class="token punctuation">.</span>Children<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> childrenArray<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//æ‰“å¼€å¼¹çª—</span>  open <span class="token operator">=</span> <span class="token punctuation">(</span>options<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    options <span class="token operator">=</span> options <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>    options<span class="token punctuation">.</span>alertStatus <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> props <span class="token operator">=</span> options<span class="token punctuation">.</span>props <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> childs <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">renderChildren</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> options<span class="token punctuation">.</span>childrens<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">""</span><span class="token punctuation">;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>childs<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>      <span class="token operator">...</span>defaultState<span class="token punctuation">,</span>      <span class="token operator">...</span>options<span class="token punctuation">,</span>      childs<span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//å…³é—­å¼¹çª—</span>  <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span><span class="token function">closeDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>      <span class="token operator">...</span>defaultState<span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">renderChildren</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> childrens<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//éå†æ‰€æœ‰å­ç»„ä»¶</span>    <span class="token keyword">var</span> childs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    childrens <span class="token operator">=</span> childrens <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> ps <span class="token operator">=</span> <span class="token punctuation">{</span>      <span class="token operator">...</span>props<span class="token punctuation">,</span> <span class="token comment" spellcheck="true">//ç»™å­ç»„ä»¶ç»‘å®šprops</span>      _close<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>close<span class="token punctuation">,</span> <span class="token comment" spellcheck="true">//ç»™å­ç»„ä»¶ä¹Ÿç»‘å®šä¸€ä¸ªå…³é—­å¼¹çª—çš„äº‹ä»¶</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    childrens<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>currentItem<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>      childs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>        React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>currentItem<span class="token punctuation">,</span> <span class="token punctuation">{</span>          <span class="token operator">...</span>ps<span class="token punctuation">,</span>          key<span class="token punctuation">:</span> index<span class="token punctuation">,</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span>      <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> childs<span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">shouldComponentUpdate</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">,</span> nextState<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">!</span><span class="token function">is</span><span class="token punctuation">(</span><span class="token function">fromJS</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">fromJS</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span>      <span class="token operator">!</span><span class="token function">is</span><span class="token punctuation">(</span><span class="token function">fromJS</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">fromJS</span><span class="token punctuation">(</span>nextState<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>ReactCSSTransitionGroup        component<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>FirstChild<span class="token punctuation">}</span>        transitionName<span class="token operator">=</span><span class="token string">"hide"</span>        transitionEnterTimeout<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">300</span><span class="token punctuation">}</span>        transitionLeaveTimeout<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">300</span><span class="token punctuation">}</span>      <span class="token operator">></span>        <span class="token operator">&lt;</span>div          className<span class="token operator">=</span><span class="token string">"dialog-con"</span>          style<span class="token operator">=</span><span class="token punctuation">{</span>            <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>alertStatus <span class="token operator">?</span> <span class="token punctuation">{</span> display<span class="token punctuation">:</span> <span class="token string">"block"</span> <span class="token punctuation">}</span> <span class="token punctuation">:</span> <span class="token punctuation">{</span> display<span class="token punctuation">:</span> <span class="token string">"none"</span> <span class="token punctuation">}</span>          <span class="token punctuation">}</span>        <span class="token operator">></span>                      <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>childs<span class="token punctuation">}</span>        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>      <span class="token operator">&lt;</span><span class="token operator">/</span>ReactCSSTransitionGroup<span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">let</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">let</span> props <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>div<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">let</span> Box <span class="token operator">=</span> ReactD<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å­ç±»ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">//å­ç±»jsx</span><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Child</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span> date<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  showValue <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>showValue <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">showValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"Child"</span><span class="token operator">></span>        <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"content"</span><span class="token operator">></span>                     Child                      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>showValue<span class="token punctuation">}</span><span class="token operator">></span>è°ƒç”¨çˆ¶çš„æ–¹æ³•<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> Child<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>cssï¼š</p><pre class="line-numbers language-css"><code class="language-css"><span class="token selector"><span class="token class">.dialog-con</span> </span><span class="token punctuation">{</span>      <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>      <span class="token property">top</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token property">left</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100%</span><span class="token punctuation">;</span>      <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100%</span><span class="token punctuation">;</span>      <span class="token property">background</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span><span class="token number">0</span>, <span class="token number">0</span>, <span class="token number">0</span>, <span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-React-æ•°æ®æŒä¹…åŒ–æœ‰ä»€ä¹ˆå®è·µå—ï¼Ÿ"><a href="#4-React-æ•°æ®æŒä¹…åŒ–æœ‰ä»€ä¹ˆå®è·µå—ï¼Ÿ" class="headerlink" title="4. React æ•°æ®æŒä¹…åŒ–æœ‰ä»€ä¹ˆå®è·µå—ï¼Ÿ"></a>4. React æ•°æ®æŒä¹…åŒ–æœ‰ä»€ä¹ˆå®è·µå—ï¼Ÿ</h3><p>å°è£…æ•°æ®æŒä¹…åŒ–ç»„ä»¶ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript">ã€‘<span class="token keyword">let</span> storage<span class="token operator">=</span><span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// å¢åŠ </span>    <span class="token keyword">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">{</span>        localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> JSON<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token comment" spellcheck="true">// è·å–</span>    <span class="token keyword">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> JSON<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token comment" spellcheck="true">// åˆ é™¤</span>    <span class="token function">remove</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">{</span>        localStorage<span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">export</span> <span class="token keyword">default</span> Storage<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨ React é¡¹ç›®ä¸­ï¼Œé€šè¿‡ redux å­˜å‚¨å…¨å±€æ•°æ®æ—¶ï¼Œä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœç”¨æˆ·åˆ·æ–°äº†ç½‘é¡µï¼Œé‚£ä¹ˆé€šè¿‡ redux å­˜å‚¨çš„å…¨å±€æ•°æ®å°±ä¼šè¢«å…¨éƒ¨æ¸…ç©ºï¼Œæ¯”å¦‚ç™»å½•ä¿¡æ¯ç­‰ã€‚è¿™æ—¶å°±ä¼šæœ‰å…¨å±€æ•°æ®æŒä¹…åŒ–å­˜å‚¨çš„éœ€æ±‚ã€‚é¦–å…ˆæƒ³åˆ°çš„å°±æ˜¯ localStorageï¼ŒlocalStorage æ˜¯æ²¡æœ‰æ—¶é—´é™åˆ¶çš„æ•°æ®å­˜å‚¨ï¼Œå¯ä»¥é€šè¿‡å®ƒæ¥å®ç°æ•°æ®çš„æŒä¹…åŒ–å­˜å‚¨ã€‚</p><p>ä½†æ˜¯åœ¨å·²ç»ä½¿ç”¨ redux æ¥ç®¡ç†å’Œå­˜å‚¨å…¨å±€æ•°æ®çš„åŸºç¡€ä¸Šï¼Œå†å»ä½¿ç”¨ localStorage æ¥è¯»å†™æ•°æ®ï¼Œè¿™æ ·ä¸ä»…æ˜¯å·¥ä½œé‡å·¨å¤§ï¼Œè¿˜å®¹æ˜“å‡ºé”™ã€‚é‚£ä¹ˆæœ‰æ²¡æœ‰ç»“åˆ redux æ¥è¾¾åˆ°æŒä¹…æ•°æ®å­˜å‚¨åŠŸèƒ½çš„æ¡†æ¶å‘¢ï¼Ÿå½“ç„¶ï¼Œå®ƒå°±æ˜¯<strong>redux-persist</strong>ã€‚redux-persist ä¼šå°† redux çš„ store ä¸­çš„æ•°æ®ç¼“å­˜åˆ°æµè§ˆå™¨çš„ localStorage ä¸­ã€‚å…¶ä½¿ç”¨æ­¥éª¤å¦‚ä¸‹ï¼š</p><p><strong>ï¼ˆ1ï¼‰é¦–å…ˆè¦å®‰è£… redux-persistï¼š</strong></p><pre class="line-numbers language-javascript"><code class="language-javascript">npm i redux<span class="token operator">-</span>persist<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>ï¼ˆ2ï¼‰å¯¹äº reducer å’Œ action çš„å¤„ç†ä¸å˜ï¼Œåªéœ€ä¿®æ”¹ store çš„ç”Ÿæˆä»£ç ï¼Œä¿®æ”¹å¦‚ä¸‹ï¼š</strong></p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> createStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"redux"</span><span class="token punctuation">;</span><span class="token keyword">import</span> reducers <span class="token keyword">from</span> <span class="token string">"../reducers/index"</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span> persistStore<span class="token punctuation">,</span> persistReducer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"redux-persist"</span><span class="token punctuation">;</span><span class="token keyword">import</span> storage <span class="token keyword">from</span> <span class="token string">"redux-persist/lib/storage"</span><span class="token punctuation">;</span><span class="token keyword">import</span> autoMergeLevel2 <span class="token keyword">from</span> <span class="token string">"redux-persist/lib/stateReconciler/autoMergeLevel2"</span><span class="token punctuation">;</span><span class="token keyword">const</span> persistConfig <span class="token operator">=</span> <span class="token punctuation">{</span>  key<span class="token punctuation">:</span> <span class="token string">"root"</span><span class="token punctuation">,</span>  storage<span class="token punctuation">:</span> storage<span class="token punctuation">,</span>  stateReconciler<span class="token punctuation">:</span> autoMergeLevel2<span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// æŸ¥çœ‹ 'Merge Process' éƒ¨åˆ†çš„å…·ä½“æƒ…å†µ</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">const</span> myPersistReducer <span class="token operator">=</span> <span class="token function">persistReducer</span><span class="token punctuation">(</span>persistConfig<span class="token punctuation">,</span> reducers<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token function">createStore</span><span class="token punctuation">(</span>myPersistReducer<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">export</span> <span class="token keyword">const</span> persistor <span class="token operator">=</span> <span class="token function">persistStore</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">export</span> <span class="token keyword">default</span> store<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ï¼ˆ3ï¼‰åœ¨ index.js ä¸­ï¼Œå°† PersistGate æ ‡ç­¾ä½œä¸ºç½‘é¡µå†…å®¹çš„çˆ¶æ ‡ç­¾ï¼š</strong></p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span><span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">"react-dom"</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span> Provider <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react-redux"</span><span class="token punctuation">;</span><span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">"./redux/store/store"</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span> persistor <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./redux/store/store"</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span> PersistGate <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"redux-persist/lib/integration/react"</span><span class="token punctuation">;</span>ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>  <span class="token operator">&lt;</span>Provider store<span class="token operator">=</span><span class="token punctuation">{</span>store<span class="token punctuation">}</span><span class="token operator">></span>    <span class="token operator">&lt;</span>PersistGate loading<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">null</span><span class="token punctuation">}</span> persistor<span class="token operator">=</span><span class="token punctuation">{</span>persistor<span class="token punctuation">}</span><span class="token operator">></span>      <span class="token punctuation">{</span><span class="token comment" spellcheck="true">/*ç½‘é¡µå†…å®¹*/</span><span class="token punctuation">}</span>    <span class="token operator">&lt;</span><span class="token operator">/</span>PersistGate<span class="token operator">></span>  <span class="token operator">&lt;</span><span class="token operator">/</span>Provider<span class="token operator">></span><span class="token punctuation">,</span>  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™å°±å®Œæˆäº†é€šè¿‡ redux-persist å®ç° React æŒä¹…åŒ–æœ¬åœ°æ•°æ®å­˜å‚¨çš„ç®€å•åº”ç”¨ã€‚</p><h3 id="5-å¯¹-React-å’Œ-Vue-çš„ç†è§£ï¼Œå®ƒä»¬çš„å¼‚åŒ"><a href="#5-å¯¹-React-å’Œ-Vue-çš„ç†è§£ï¼Œå®ƒä»¬çš„å¼‚åŒ" class="headerlink" title="5. å¯¹ React å’Œ Vue çš„ç†è§£ï¼Œå®ƒä»¬çš„å¼‚åŒ"></a>5. å¯¹ React å’Œ Vue çš„ç†è§£ï¼Œå®ƒä»¬çš„å¼‚åŒ</h3><p><strong>ç›¸ä¼¼ä¹‹å¤„ï¼š</strong></p><ul><li>éƒ½å°†æ³¨æ„åŠ›é›†ä¸­ä¿æŒåœ¨æ ¸å¿ƒåº“ï¼Œè€Œå°†å…¶ä»–åŠŸèƒ½å¦‚è·¯ç”±å’Œå…¨å±€çŠ¶æ€ç®¡ç†äº¤ç»™ç›¸å…³çš„åº“</li><li>éƒ½æœ‰è‡ªå·±çš„æ„å»ºå·¥å…·ï¼Œèƒ½è®©ä½ å¾—åˆ°ä¸€ä¸ªæ ¹æ®æœ€ä½³å®è·µè®¾ç½®çš„é¡¹ç›®æ¨¡æ¿ã€‚</li><li>éƒ½ä½¿ç”¨äº† Virtual DOMï¼ˆè™šæ‹Ÿ DOMï¼‰æé«˜é‡ç»˜æ€§èƒ½</li><li>éƒ½æœ‰ props çš„æ¦‚å¿µï¼Œå…è®¸ç»„ä»¶é—´çš„æ•°æ®ä¼ é€’</li><li>éƒ½é¼“åŠ±ç»„ä»¶åŒ–åº”ç”¨ï¼Œå°†åº”ç”¨åˆ†æ‹†æˆä¸€ä¸ªä¸ªåŠŸèƒ½æ˜ç¡®çš„æ¨¡å—ï¼Œæé«˜å¤ç”¨æ€§</li></ul><p><strong>ä¸åŒä¹‹å¤„ï¼š</strong></p><p><strong>1ï¼‰æ•°æ®æµ</strong></p><p>Vue é»˜è®¤æ”¯æŒæ•°æ®åŒå‘ç»‘å®šï¼Œè€Œ React ä¸€ç›´æå€¡å•å‘æ•°æ®æµ</p><p><strong>2ï¼‰è™šæ‹Ÿ DOM</strong></p><p>Vue2.x å¼€å§‹å¼•å…¥â€Virtual DOMâ€ï¼Œæ¶ˆé™¤äº†å’Œ React åœ¨è¿™æ–¹é¢çš„å·®å¼‚ï¼Œä½†æ˜¯åœ¨å…·ä½“çš„ç»†èŠ‚è¿˜æ˜¯æœ‰å„è‡ªçš„ç‰¹ç‚¹ã€‚</p><ul><li>Vue å®£ç§°å¯ä»¥æ›´å¿«åœ°è®¡ç®—å‡º Virtual DOM çš„å·®å¼‚ï¼Œè¿™æ˜¯ç”±äºå®ƒåœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­ï¼Œä¼šè·Ÿè¸ªæ¯ä¸€ä¸ªç»„ä»¶çš„ä¾èµ–å…³ç³»ï¼Œä¸éœ€è¦é‡æ–°æ¸²æŸ“æ•´ä¸ªç»„ä»¶æ ‘ã€‚</li><li>å¯¹äº React è€Œè¨€ï¼Œæ¯å½“åº”ç”¨çš„çŠ¶æ€è¢«æ”¹å˜æ—¶ï¼Œå…¨éƒ¨å­ç»„ä»¶éƒ½ä¼šé‡æ–°æ¸²æŸ“ã€‚å½“ç„¶ï¼Œè¿™å¯ä»¥é€šè¿‡ PureComponent/shouldComponentUpdate è¿™ä¸ªç”Ÿå‘½å‘¨æœŸæ–¹æ³•æ¥è¿›è¡Œæ§åˆ¶ï¼Œä½† Vue å°†æ­¤è§†ä¸ºé»˜è®¤çš„ä¼˜åŒ–ã€‚</li></ul><p><strong>3ï¼‰ç»„ä»¶åŒ–</strong></p><p>React ä¸ Vue æœ€å¤§çš„ä¸åŒæ˜¯æ¨¡æ¿çš„ç¼–å†™ã€‚</p><ul><li>Vue é¼“åŠ±å†™è¿‘ä¼¼å¸¸è§„ HTML çš„æ¨¡æ¿ã€‚å†™èµ·æ¥å¾ˆæ¥è¿‘æ ‡å‡† HTML å…ƒç´ ï¼Œåªæ˜¯å¤šäº†ä¸€äº›å±æ€§ã€‚</li><li>React æ¨èä½ æ‰€æœ‰çš„æ¨¡æ¿é€šç”¨ JavaScript çš„è¯­æ³•æ‰©å±•â€”â€”JSX ä¹¦å†™ã€‚</li></ul><p>å…·ä½“æ¥è®²ï¼šReact ä¸­ render å‡½æ•°æ˜¯æ”¯æŒé—­åŒ…ç‰¹æ€§çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ import çš„ç»„ä»¶åœ¨ render ä¸­å¯ä»¥ç›´æ¥è°ƒç”¨ã€‚ä½†æ˜¯åœ¨ Vue ä¸­ï¼Œç”±äºæ¨¡æ¿ä¸­ä½¿ç”¨çš„æ•°æ®éƒ½å¿…é¡»æŒ‚åœ¨ this ä¸Šè¿›è¡Œä¸€æ¬¡ä¸­è½¬ï¼Œæ‰€ä»¥ import å®Œç»„ä»¶ä¹‹åï¼Œè¿˜éœ€è¦åœ¨ components ä¸­å†å£°æ˜ä¸‹ã€‚</p><p><strong>4ï¼‰ç›‘å¬æ•°æ®å˜åŒ–çš„å®ç°åŸç†ä¸åŒ</strong></p><ul><li>Vue é€šè¿‡ getter/setter ä»¥åŠä¸€äº›å‡½æ•°çš„åŠ«æŒï¼Œèƒ½ç²¾ç¡®çŸ¥é“æ•°æ®å˜åŒ–ï¼Œä¸éœ€è¦ç‰¹åˆ«çš„ä¼˜åŒ–å°±èƒ½è¾¾åˆ°å¾ˆå¥½çš„æ€§èƒ½</li><li>React é»˜è®¤æ˜¯é€šè¿‡æ¯”è¾ƒå¼•ç”¨çš„æ–¹å¼è¿›è¡Œçš„ï¼Œå¦‚æœä¸ä¼˜åŒ–ï¼ˆPureComponent/shouldComponentUpdateï¼‰å¯èƒ½å¯¼è‡´å¤§é‡ä¸å¿…è¦çš„ vDOM çš„é‡æ–°æ¸²æŸ“ã€‚è¿™æ˜¯å› ä¸º Vue ä½¿ç”¨çš„æ˜¯å¯å˜æ•°æ®ï¼Œè€Œ React æ›´å¼ºè°ƒæ•°æ®çš„ä¸å¯å˜ã€‚</li></ul><p><strong>5ï¼‰é«˜é˜¶ç»„ä»¶</strong></p><p>react å¯ä»¥é€šè¿‡é«˜é˜¶ç»„ä»¶ï¼ˆHigher Order Componentsâ€“ HOCï¼‰æ¥æ‰©å±•ï¼Œè€Œ vue éœ€è¦é€šè¿‡ mixins æ¥æ‰©å±•ã€‚</p><p>åŸå› é«˜é˜¶ç»„ä»¶å°±æ˜¯é«˜é˜¶å‡½æ•°ï¼Œè€Œ React çš„ç»„ä»¶æœ¬èº«å°±æ˜¯çº¯ç²¹çš„å‡½æ•°ï¼Œæ‰€ä»¥é«˜é˜¶å‡½æ•°å¯¹ React æ¥è¯´æ˜“å¦‚åæŒã€‚ç›¸å Vue.js ä½¿ç”¨ HTML æ¨¡æ¿åˆ›å»ºè§†å›¾ç»„ä»¶ï¼Œè¿™æ—¶æ¨¡æ¿æ— æ³•æœ‰æ•ˆçš„ç¼–è¯‘ï¼Œå› æ­¤ Vue ä¸é‡‡ç”¨ HOC æ¥å®ç°ã€‚</p><p><strong>6ï¼‰æ„å»ºå·¥å…·</strong></p><p>ä¸¤è€…éƒ½æœ‰è‡ªå·±çš„æ„å»ºå·¥å…·</p><ul><li>React ==&gt; Create React APP</li><li>Vue ==&gt; vue-cli</li></ul><p><strong>7ï¼‰è·¨å¹³å°</strong></p><ul><li>React ==&gt; React Native</li><li>Vue ==&gt; Weex</li></ul><h3 id="6-å¯ä»¥ä½¿ç”¨-TypeScript-å†™-React-åº”ç”¨å—ï¼Ÿæ€ä¹ˆæ“ä½œï¼Ÿ"><a href="#6-å¯ä»¥ä½¿ç”¨-TypeScript-å†™-React-åº”ç”¨å—ï¼Ÿæ€ä¹ˆæ“ä½œï¼Ÿ" class="headerlink" title="6. å¯ä»¥ä½¿ç”¨ TypeScript å†™ React åº”ç”¨å—ï¼Ÿæ€ä¹ˆæ“ä½œï¼Ÿ"></a>6. å¯ä»¥ä½¿ç”¨ TypeScript å†™ React åº”ç”¨å—ï¼Ÿæ€ä¹ˆæ“ä½œï¼Ÿ</h3><p><strong>ï¼ˆ1ï¼‰å¦‚æœè¿˜æœªåˆ›å»º Create React App é¡¹ç›®</strong></p><ul><li>ç›´æ¥åˆ›å»ºä¸€ä¸ªå…·æœ‰ typescript çš„ Create React App é¡¹ç›®ï¼š</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"> npx create<span class="token operator">-</span>react<span class="token operator">-</span>app demo <span class="token operator">--</span>typescript<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>ï¼ˆ2ï¼‰å¦‚æœå·²ç»åˆ›å»ºäº†  Create React App é¡¹ç›®ï¼Œéœ€è¦å°†  typescript å¼•å…¥åˆ°å·²æœ‰é¡¹ç›®ä¸­</strong></p><ul><li>é€šè¿‡å‘½ä»¤å°† typescript å¼•å…¥é¡¹ç›®ï¼š</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript">npm install <span class="token operator">--</span>save typescript @types<span class="token operator">/</span>node @types<span class="token operator">/</span>react @types<span class="token operator">/</span>react<span class="token operator">-</span>dom @types<span class="token operator">/</span>jest<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>å°†é¡¹ç›®ä¸­ä»»ä½• åç¼€åä¸º â€˜.jsâ€™ çš„ JavaScript æ–‡ä»¶é‡å‘½åä¸º TypeScript æ–‡ä»¶å³åç¼€åä¸º â€˜.tsxâ€™ï¼ˆä¾‹å¦‚  src/index.js  é‡å‘½åä¸º  src/index.tsx ï¼‰</li></ul><h3 id="7-React-è®¾è®¡æ€è·¯ï¼Œå®ƒçš„ç†å¿µæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#7-React-è®¾è®¡æ€è·¯ï¼Œå®ƒçš„ç†å¿µæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="7. React è®¾è®¡æ€è·¯ï¼Œå®ƒçš„ç†å¿µæ˜¯ä»€ä¹ˆï¼Ÿ"></a>7. React è®¾è®¡æ€è·¯ï¼Œå®ƒçš„ç†å¿µæ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><strong>ï¼ˆ1ï¼‰ç¼–å†™ç®€å•ç›´è§‚çš„ä»£ç </strong></p><p>React æœ€å¤§çš„ä»·å€¼ä¸æ˜¯é«˜æ€§èƒ½çš„è™šæ‹Ÿ DOMã€å°è£…çš„äº‹ä»¶æœºåˆ¶ã€æœåŠ¡å™¨ç«¯æ¸²æŸ“ï¼Œè€Œæ˜¯å£°æ˜å¼çš„ç›´è§‚çš„ç¼–ç æ–¹å¼ã€‚react æ–‡æ¡£ç¬¬ä¸€æ¡å°±æ˜¯å£°æ˜å¼ï¼ŒReact ä½¿åˆ›å»ºäº¤äº’å¼ UI å˜å¾—è½»è€Œæ˜“ä¸¾ã€‚ä¸ºåº”ç”¨çš„æ¯ä¸€ä¸ªçŠ¶æ€è®¾è®¡ç®€æ´çš„è§†å›¾ï¼Œå½“æ•°æ®æ”¹å˜æ—¶ React èƒ½æœ‰æ•ˆåœ°æ›´æ–°å¹¶æ­£ç¡®åœ°æ¸²æŸ“ç»„ä»¶ã€‚ ä»¥å£°æ˜å¼ç¼–å†™ UIï¼Œå¯ä»¥è®©ä»£ç æ›´åŠ å¯é ï¼Œä¸”æ–¹ä¾¿è°ƒè¯•ã€‚</p><p><strong>ï¼ˆ2ï¼‰ç®€åŒ–å¯å¤ç”¨çš„ç»„ä»¶</strong></p><p>React æ¡†æ¶é‡Œé¢ä½¿ç”¨äº†ç®€åŒ–çš„ç»„ä»¶æ¨¡å‹ï¼Œä½†æ›´å½»åº•åœ°ä½¿ç”¨äº†ç»„ä»¶åŒ–çš„æ¦‚å¿µã€‚React å°†æ•´ä¸ª UI ä¸Šçš„æ¯ä¸€ä¸ªåŠŸèƒ½æ¨¡å—å®šä¹‰æˆç»„ä»¶ï¼Œç„¶åå°†å°çš„ç»„ä»¶é€šè¿‡ç»„åˆæˆ–è€…åµŒå¥—çš„æ–¹å¼æ„æˆæ›´å¤§çš„ç»„ä»¶ã€‚React çš„ç»„ä»¶å…·æœ‰å¦‚ä¸‹çš„ç‰¹æ€§ âˆ¶</p><ul><li>å¯ç»„åˆï¼šç®€å•ç»„ä»¶å¯ä»¥ç»„åˆä¸ºå¤æ‚çš„ç»„ä»¶</li><li>å¯é‡ç”¨ï¼šæ¯ä¸ªç»„ä»¶éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œå¯ä»¥è¢«å¤šä¸ªç»„ä»¶ä½¿ç”¨</li><li>å¯ç»´æŠ¤ï¼šå’Œç»„ä»¶ç›¸å…³çš„é€»è¾‘å’Œ UI éƒ½å°è£…åœ¨äº†ç»„ä»¶çš„å†…éƒ¨ï¼Œæ–¹ä¾¿ç»´æŠ¤</li><li>å¯æµ‹è¯•ï¼šå› ä¸ºç»„ä»¶çš„ç‹¬ç«‹æ€§ï¼Œæµ‹è¯•ç»„ä»¶å°±å˜å¾—æ–¹ä¾¿å¾ˆå¤šã€‚</li></ul><p><strong>ï¼ˆ3) Virtual DOM</strong></p><p>çœŸå®é¡µé¢å¯¹åº”ä¸€ä¸ª DOM æ ‘ã€‚åœ¨ä¼ ç»Ÿé¡µé¢çš„å¼€å‘æ¨¡å¼ä¸­ï¼Œæ¯æ¬¡éœ€è¦æ›´æ–°é¡µé¢æ—¶ï¼Œéƒ½è¦æ‰‹åŠ¨æ“ä½œ DOM æ¥è¿›è¡Œæ›´æ–°ã€‚ DOM æ“ä½œéå¸¸æ˜‚è´µã€‚åœ¨å‰ç«¯å¼€å‘ä¸­ï¼Œæ€§èƒ½æ¶ˆè€—æœ€å¤§çš„å°±æ˜¯ DOM æ“ä½œï¼Œè€Œä¸”è¿™éƒ¨åˆ†ä»£ç ä¼šè®©æ•´ä½“é¡¹ç›®çš„ä»£ç å˜å¾—éš¾ ä»¥ç»´æŠ¤ã€‚React æŠŠçœŸå® DOM æ ‘è½¬æ¢æˆ JavaScript å¯¹è±¡æ ‘ï¼Œä¹Ÿå°±æ˜¯ Virtual DOMï¼Œæ¯æ¬¡æ•°æ®æ›´æ–°åï¼Œé‡æ–°è®¡ç®— Virtual DOMï¼Œå¹¶å’Œä¸Šä¸€æ¬¡ç”Ÿæˆçš„ Virtual DOM åšå¯¹æ¯”ï¼Œå¯¹å‘ç”Ÿå˜åŒ–çš„éƒ¨åˆ†åšæ‰¹é‡æ›´æ–°ã€‚React ä¹Ÿæä¾›äº†ç›´è§‚çš„ shouldComponentUpdate ç”Ÿå‘½å‘¨æœŸå›è°ƒï¼Œæ¥å‡å°‘æ•°æ®å˜åŒ–åä¸å¿…è¦çš„ Virtual DOM å¯¹æ¯”è¿‡ç¨‹ï¼Œä»¥ä¿è¯æ€§èƒ½ã€‚</p><p><strong>ï¼ˆ4ï¼‰å‡½æ•°å¼ç¼–ç¨‹</strong></p><p>React æŠŠè¿‡å»ä¸æ–­é‡å¤æ„å»º UI çš„è¿‡ç¨‹æŠ½è±¡æˆäº†ç»„ä»¶ï¼Œä¸”åœ¨ç»™å®šå‚æ•°çš„æƒ…å†µä¸‹çº¦å®šæ¸²æŸ“å¯¹åº”çš„ UI ç•Œé¢ã€‚React èƒ½å……åˆ†åˆ©ç”¨å¾ˆå¤šå‡½æ•°å¼æ–¹æ³•å»å‡å°‘å†—ä½™ä»£ç ã€‚æ­¤å¤–ï¼Œç”±äºå®ƒæœ¬èº«å°±æ˜¯ç®€å•å‡½æ•°ï¼Œæ‰€ä»¥æ˜“äºæµ‹è¯•ã€‚</p><p><strong>ï¼ˆ5ï¼‰ä¸€æ¬¡å­¦ä¹ ï¼Œéšå¤„ç¼–å†™</strong></p><p>æ— è®ºç°åœ¨æ­£åœ¨ä½¿ç”¨ä»€ä¹ˆæŠ€æœ¯æ ˆï¼Œéƒ½å¯ä»¥éšæ—¶å¼•å…¥ React æ¥å¼€å‘æ–°ç‰¹æ€§ï¼Œè€Œä¸éœ€è¦é‡å†™ç°æœ‰ä»£ç ã€‚</p><p>React è¿˜å¯ä»¥ä½¿ç”¨ Node è¿›è¡ŒæœåŠ¡å™¨æ¸²æŸ“ï¼Œæˆ–ä½¿ç”¨ React Native å¼€å‘åŸç”Ÿç§»åŠ¨åº”ç”¨ã€‚å› ä¸º React ç»„ä»¶å¯ä»¥æ˜ å°„ä¸ºå¯¹åº”çš„åŸç”Ÿæ§ä»¶ã€‚åœ¨è¾“å‡ºçš„æ—¶å€™ï¼Œæ˜¯è¾“å‡º Web DOMï¼Œè¿˜æ˜¯ Android æ§ä»¶ï¼Œè¿˜æ˜¯ iOS æ§ä»¶ï¼Œå°±ç”±å¹³å°æœ¬èº«å†³å®šäº†ã€‚æ‰€ä»¥ï¼Œreact å¾ˆæ–¹ä¾¿å’Œå…¶ä»–å¹³å°é›†æˆ</p><h3 id="8-React-ä¸­-props-children-å’Œ-React-Children-çš„åŒºåˆ«"><a href="#8-React-ä¸­-props-children-å’Œ-React-Children-çš„åŒºåˆ«" class="headerlink" title="8. React ä¸­ props.children å’Œ React.Children çš„åŒºåˆ«"></a>8. React ä¸­ props.children å’Œ React.Children çš„åŒºåˆ«</h3><p>åœ¨ React ä¸­ï¼Œå½“æ¶‰åŠç»„ä»¶åµŒå¥—ï¼Œåœ¨çˆ¶ç»„ä»¶ä¸­ä½¿ç”¨<code>props.children</code>æŠŠæ‰€æœ‰å­ç»„ä»¶æ˜¾ç¤ºå‡ºæ¥ã€‚å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">ParentComponent</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">></span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>children<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¦‚æœæƒ³æŠŠçˆ¶ç»„ä»¶ä¸­çš„å±æ€§ä¼ ç»™æ‰€æœ‰çš„å­ç»„ä»¶ï¼Œéœ€è¦ä½¿ç”¨<code>React.Children</code>æ–¹æ³•ã€‚</p><p>æ¯”å¦‚ï¼ŒæŠŠå‡ ä¸ª Radio ç»„åˆèµ·æ¥ï¼Œåˆæˆä¸€ä¸ª RadioGroupï¼Œè¿™å°±è¦æ±‚æ‰€æœ‰çš„ Radio å…·æœ‰åŒæ ·çš„ name å±æ€§å€¼ã€‚å¯ä»¥è¿™æ ·ï¼šæŠŠ Radio çœ‹åšå­ç»„ä»¶ï¼ŒRadioGroup çœ‹åšçˆ¶ç»„ä»¶ï¼Œname çš„å±æ€§å€¼åœ¨ RadioGroup è¿™ä¸ªçˆ¶ç»„ä»¶ä¸­è®¾ç½®ã€‚</p><p>é¦–å…ˆæ˜¯å­ç»„ä»¶ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">//å­ç»„ä»¶</span><span class="token keyword">function</span> <span class="token function">RadioOption</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token operator">&lt;</span>label<span class="token operator">></span>      <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"radio"</span> value<span class="token operator">=</span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>value<span class="token punctuation">}</span> name<span class="token operator">=</span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>name<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>      <span class="token punctuation">{</span>props<span class="token punctuation">.</span>label<span class="token punctuation">}</span>    <span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">></span>  <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åæ˜¯çˆ¶ç»„ä»¶ï¼Œä¸ä»…éœ€è¦æŠŠå®ƒæ‰€æœ‰çš„å­ç»„ä»¶æ˜¾ç¤ºå‡ºæ¥ï¼Œè¿˜éœ€è¦ä¸ºæ¯ä¸ªå­ç»„ä»¶èµ‹ä¸Š name å±æ€§å’Œå€¼ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">//çˆ¶ç»„ä»¶ç”¨,propsæ˜¯æŒ‡çˆ¶ç»„ä»¶çš„props</span><span class="token keyword">function</span> <span class="token function">renderChildren</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">//éå†æ‰€æœ‰å­ç»„ä»¶</span>  <span class="token keyword">return</span> React<span class="token punctuation">.</span>Children<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>children<span class="token punctuation">,</span> <span class="token punctuation">(</span>child<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>child<span class="token punctuation">.</span>type <span class="token operator">===</span> RadioOption<span class="token punctuation">)</span>      <span class="token keyword">return</span> React<span class="token punctuation">.</span><span class="token function">cloneElement</span><span class="token punctuation">(</span>child<span class="token punctuation">,</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">//æŠŠçˆ¶ç»„ä»¶çš„props.nameèµ‹å€¼ç»™æ¯ä¸ªå­ç»„ä»¶</span>        name<span class="token punctuation">:</span> props<span class="token punctuation">.</span>name<span class="token punctuation">,</span>      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">else</span> <span class="token keyword">return</span> child<span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//çˆ¶ç»„ä»¶</span><span class="token keyword">function</span> <span class="token function">RadioGroup</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">></span><span class="token punctuation">{</span><span class="token function">renderChildren</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token operator">&lt;</span>RadioGroup name<span class="token operator">=</span><span class="token string">"hello"</span><span class="token operator">></span>      <span class="token operator">&lt;</span>RadioOption label<span class="token operator">=</span><span class="token string">"é€‰é¡¹ä¸€"</span> value<span class="token operator">=</span><span class="token string">"1"</span> <span class="token operator">/</span><span class="token operator">></span>      <span class="token operator">&lt;</span>RadioOption label<span class="token operator">=</span><span class="token string">"é€‰é¡¹äºŒ"</span> value<span class="token operator">=</span><span class="token string">"2"</span> <span class="token operator">/</span><span class="token operator">></span>      <span class="token operator">&lt;</span>RadioOption label<span class="token operator">=</span><span class="token string">"é€‰é¡¹ä¸‰"</span> value<span class="token operator">=</span><span class="token string">"3"</span> <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span>RadioGroup<span class="token operator">></span>  <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»¥ä¸Šï¼Œ<code>React.Children.map</code>è®©æˆ‘ä»¬å¯¹çˆ¶ç»„ä»¶çš„æ‰€æœ‰å­ç»„ä»¶åˆæ›´çµæ´»çš„æ§åˆ¶ã€‚</p><h3 id="9-React-çš„çŠ¶æ€æå‡æ˜¯ä»€ä¹ˆï¼Ÿä½¿ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ"><a href="#9-React-çš„çŠ¶æ€æå‡æ˜¯ä»€ä¹ˆï¼Ÿä½¿ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="9. React çš„çŠ¶æ€æå‡æ˜¯ä»€ä¹ˆï¼Ÿä½¿ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ"></a>9. React çš„çŠ¶æ€æå‡æ˜¯ä»€ä¹ˆï¼Ÿä½¿ç”¨åœºæ™¯æœ‰å“ªäº›ï¼Ÿ</h3><p>React çš„çŠ¶æ€æå‡å°±æ˜¯ç”¨æˆ·å¯¹å­ç»„ä»¶æ“ä½œï¼Œå­ç»„ä»¶ä¸æ”¹å˜è‡ªå·±çš„çŠ¶æ€ï¼Œé€šè¿‡è‡ªå·±çš„ props æŠŠè¿™ä¸ªæ“ä½œæ”¹å˜çš„æ•°æ®ä¼ é€’ç»™çˆ¶ç»„ä»¶ï¼Œæ”¹å˜çˆ¶ç»„ä»¶çš„çŠ¶æ€ï¼Œä»è€Œæ”¹å˜å—çˆ¶ç»„ä»¶æ§åˆ¶çš„æ‰€æœ‰å­ç»„ä»¶çš„çŠ¶æ€ï¼Œè¿™ä¹Ÿæ˜¯ React å•é¡¹æ•°æ®æµçš„ç‰¹æ€§å†³å®šçš„ã€‚å®˜æ–¹çš„åŸè¯æ˜¯ï¼šå…±äº« state(çŠ¶æ€) æ˜¯é€šè¿‡å°†å…¶ç§»åŠ¨åˆ°éœ€è¦å®ƒçš„ç»„ä»¶çš„æœ€æ¥è¿‘çš„å…±åŒç¥–å…ˆç»„ä»¶æ¥å®ç°çš„ã€‚ è¿™è¢«ç§°ä¸ºâ€œçŠ¶æ€æå‡(Lifting State Up)â€ã€‚</p><p>æ¦‚æ‹¬æ¥è¯´å°±æ˜¯<strong>å°†å¤šä¸ªç»„ä»¶éœ€è¦å…±äº«çš„çŠ¶æ€æå‡åˆ°å®ƒä»¬æœ€è¿‘çš„çˆ¶ç»„ä»¶ä¸Š</strong>ï¼Œ<strong>åœ¨çˆ¶ç»„ä»¶ä¸Šæ”¹å˜è¿™ä¸ªçŠ¶æ€ç„¶åé€šè¿‡ props åˆ†å‘ç»™å­ç»„ä»¶ã€‚</strong></p><p>ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œçˆ¶ç»„ä»¶ä¸­æœ‰ä¸¤ä¸ª input å­ç»„ä»¶ï¼Œå¦‚æœæƒ³åœ¨ç¬¬ä¸€ä¸ªè¾“å…¥æ¡†è¾“å…¥æ•°æ®ï¼Œæ¥æ”¹å˜ç¬¬äºŒä¸ªè¾“å…¥æ¡†çš„å€¼ï¼Œè¿™å°±éœ€è¦ç”¨åˆ°çŠ¶æ€æå‡ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">Father</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>      Value1<span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>      Value2<span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">value1Change</span><span class="token punctuation">(</span>aa<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>      Value1<span class="token punctuation">:</span> aa<span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">value2Change</span><span class="token punctuation">(</span>bb<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>      Value2<span class="token punctuation">:</span> bb<span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> padding<span class="token punctuation">:</span> <span class="token string">"100px"</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">></span>        <span class="token operator">&lt;</span>Child1          value1<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>Value1<span class="token punctuation">}</span>          onvalue1Change<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>value1Change<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">}</span>        <span class="token operator">/</span><span class="token operator">></span>        <span class="token operator">&lt;</span>Child2 value2<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>Value1<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">Child1</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">changeValue</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">onvalue1Change</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>input value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>Value1<span class="token punctuation">}</span> onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>changeValue<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">Child2</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token operator">&lt;</span>input value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>value2<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span>ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>Father <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="10-React-ä¸­-constructor-å’Œ-getInitialState-çš„åŒºåˆ«"><a href="#10-React-ä¸­-constructor-å’Œ-getInitialState-çš„åŒºåˆ«" class="headerlink" title="10. React ä¸­ constructor å’Œ getInitialState çš„åŒºåˆ«?"></a>10. React ä¸­ constructor å’Œ getInitialState çš„åŒºåˆ«?</h3><p>ä¸¤è€…éƒ½æ˜¯ç”¨æ¥åˆå§‹åŒ– state çš„ã€‚å‰è€…æ˜¯ ES6 ä¸­çš„è¯­æ³•ï¼Œåè€…æ˜¯ ES5 ä¸­çš„è¯­æ³•ï¼Œæ–°ç‰ˆæœ¬çš„ React ä¸­å·²ç»åºŸå¼ƒäº†è¯¥æ–¹æ³•ã€‚</p><p>getInitialState æ˜¯ ES5 ä¸­çš„æ–¹æ³•ï¼Œå¦‚æœä½¿ç”¨ createClass æ–¹æ³•åˆ›å»ºä¸€ä¸ª Component ç»„ä»¶ï¼Œå¯ä»¥è‡ªåŠ¨è°ƒç”¨å®ƒçš„ getInitialState æ–¹æ³•æ¥è·å–åˆå§‹åŒ–çš„ State å¯¹è±¡ï¼Œ</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> APP <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">creatClass</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  <span class="token function">getInitialState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token punctuation">{</span>      userName<span class="token punctuation">:</span> <span class="token string">"hi"</span><span class="token punctuation">,</span>      userId<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>React åœ¨ ES6 çš„å®ç°ä¸­å»æ‰äº† getInitialState è¿™ä¸ª hook å‡½æ•°ï¼Œè§„å®š state åœ¨ constructor ä¸­å®ç°ï¼Œå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript">Class <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{</span>    <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">{</span>      <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="11-React-çš„ä¸¥æ ¼æ¨¡å¼å¦‚ä½•ä½¿ç”¨ï¼Œæœ‰ä»€ä¹ˆç”¨å¤„ï¼Ÿ"><a href="#11-React-çš„ä¸¥æ ¼æ¨¡å¼å¦‚ä½•ä½¿ç”¨ï¼Œæœ‰ä»€ä¹ˆç”¨å¤„ï¼Ÿ" class="headerlink" title="11. React çš„ä¸¥æ ¼æ¨¡å¼å¦‚ä½•ä½¿ç”¨ï¼Œæœ‰ä»€ä¹ˆç”¨å¤„ï¼Ÿ"></a>11. React çš„ä¸¥æ ¼æ¨¡å¼å¦‚ä½•ä½¿ç”¨ï¼Œæœ‰ä»€ä¹ˆç”¨å¤„ï¼Ÿ</h3><p><code>StrictMode</code> æ˜¯ä¸€ä¸ªç”¨æ¥çªå‡ºæ˜¾ç¤ºåº”ç”¨ç¨‹åºä¸­æ½œåœ¨é—®é¢˜çš„å·¥å…·ã€‚ä¸ <code>Fragment</code> ä¸€æ ·ï¼Œ<code>StrictMode</code> ä¸ä¼šæ¸²æŸ“ä»»ä½•å¯è§çš„ UIã€‚å®ƒä¸ºå…¶åä»£å…ƒç´ è§¦å‘é¢å¤–çš„æ£€æŸ¥å’Œè­¦å‘Šã€‚<br>å¯ä»¥ä¸ºåº”ç”¨ç¨‹åºçš„ä»»ä½•éƒ¨åˆ†å¯ç”¨ä¸¥æ ¼æ¨¡å¼ã€‚ä¾‹å¦‚ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">ExampleApplication</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token operator">&lt;</span>div<span class="token operator">></span>      <span class="token operator">&lt;</span>Header <span class="token operator">/</span><span class="token operator">></span>      <span class="token operator">&lt;</span>React<span class="token punctuation">.</span>StrictMode<span class="token operator">></span>        <span class="token operator">&lt;</span>div<span class="token operator">></span>          <span class="token operator">&lt;</span>ComponentOne <span class="token operator">/</span><span class="token operator">></span>          <span class="token operator">&lt;</span>ComponentTwo <span class="token operator">/</span><span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>      <span class="token operator">&lt;</span><span class="token operator">/</span>React<span class="token punctuation">.</span>StrictMode<span class="token operator">></span>      <span class="token operator">&lt;</span>Footer <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>  <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨ä¸Šè¿°çš„ç¤ºä¾‹ä¸­ï¼Œä¸ä¼šå¯¹ <code>Header</code> å’Œ <code>Footer</code> ç»„ä»¶è¿è¡Œä¸¥æ ¼æ¨¡å¼æ£€æŸ¥ã€‚ä½†æ˜¯ï¼Œ<code>ComponentOne</code> å’Œ <code>ComponentTwo</code> ä»¥åŠå®ƒä»¬çš„æ‰€æœ‰åä»£å…ƒç´ éƒ½å°†è¿›è¡Œæ£€æŸ¥ã€‚</p><p><code>StrictMode</code> ç›®å‰æœ‰åŠ©äºï¼š</p><ul><li>è¯†åˆ«ä¸å®‰å…¨çš„ç”Ÿå‘½å‘¨æœŸ</li><li>å…³äºä½¿ç”¨è¿‡æ—¶å­—ç¬¦ä¸² ref API çš„è­¦å‘Š</li><li>å…³äºä½¿ç”¨åºŸå¼ƒçš„ findDOMNode æ–¹æ³•çš„è­¦å‘Š</li><li>æ£€æµ‹æ„å¤–çš„å‰¯ä½œç”¨</li><li>æ£€æµ‹è¿‡æ—¶çš„ context API</li></ul><h3 id="12-åœ¨-React-ä¸­éå†çš„æ–¹æ³•æœ‰å“ªäº›ï¼Ÿ"><a href="#12-åœ¨-React-ä¸­éå†çš„æ–¹æ³•æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="12. åœ¨ React ä¸­éå†çš„æ–¹æ³•æœ‰å“ªäº›ï¼Ÿ"></a>12. åœ¨ React ä¸­éå†çš„æ–¹æ³•æœ‰å“ªäº›ï¼Ÿ</h3><p><strong>ï¼ˆ1ï¼‰éå†æ•°ç»„ï¼šmap &amp;&amp; forEach</strong></p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token string">"b"</span><span class="token punctuation">,</span> <span class="token string">"c"</span><span class="token punctuation">,</span> <span class="token string">"d"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>ul<span class="token operator">></span>        <span class="token punctuation">{</span>arr<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>          <span class="token keyword">return</span> <span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token punctuation">{</span>index<span class="token punctuation">}</span><span class="token operator">></span><span class="token punctuation">{</span>item<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">></span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span>      <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token string">"b"</span><span class="token punctuation">,</span> <span class="token string">"c"</span><span class="token punctuation">,</span> <span class="token string">"d"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>ul<span class="token operator">></span>        <span class="token punctuation">{</span>arr<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>          <span class="token keyword">return</span> <span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token punctuation">{</span>index<span class="token punctuation">}</span><span class="token operator">></span><span class="token punctuation">{</span>item<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">></span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span>      <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ï¼ˆ2ï¼‰éå†å¯¹è±¡ï¼šmap &amp;&amp; for in</strong></p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>      a<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>      b<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>      c<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>ul<span class="token operator">></span>        <span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>          <span class="token keyword">let</span> domArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>          <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>              <span class="token keyword">const</span> value <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>              domArr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token punctuation">{</span>key<span class="token punctuation">}</span><span class="token operator">></span><span class="token punctuation">{</span>value<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>          <span class="token punctuation">}</span>          <span class="token keyword">return</span> domArr<span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span>      <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// Object.entries() æŠŠå¯¹è±¡è½¬æ¢æˆæ•°ç»„</span><span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>      a<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>      b<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>      c<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>ul<span class="token operator">></span>        <span class="token punctuation">{</span>Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>key<span class="token punctuation">,</span> value<span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>          <span class="token comment" spellcheck="true">// itemæ˜¯ä¸€ä¸ªæ•°ç»„ï¼ŒæŠŠitemè§£æ„ï¼Œå†™æ³•æ˜¯[key, value]</span>          <span class="token keyword">return</span> <span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token punctuation">{</span>key<span class="token punctuation">}</span><span class="token operator">></span><span class="token punctuation">{</span>value<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">></span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span>      <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="13-åœ¨-React-ä¸­é¡µé¢é‡æ–°åŠ è½½æ—¶æ€æ ·ä¿ç•™æ•°æ®ï¼Ÿ"><a href="#13-åœ¨-React-ä¸­é¡µé¢é‡æ–°åŠ è½½æ—¶æ€æ ·ä¿ç•™æ•°æ®ï¼Ÿ" class="headerlink" title="13. åœ¨ React ä¸­é¡µé¢é‡æ–°åŠ è½½æ—¶æ€æ ·ä¿ç•™æ•°æ®ï¼Ÿ"></a>13. åœ¨ React ä¸­é¡µé¢é‡æ–°åŠ è½½æ—¶æ€æ ·ä¿ç•™æ•°æ®ï¼Ÿ</h3><p>è¿™ä¸ªé—®é¢˜å°±è®¾è®¡åˆ°äº†<strong>æ•°æ®æŒä¹…åŒ–ï¼Œ</strong> ä¸»è¦çš„å®ç°æ–¹å¼æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p><ul><li><strong>Reduxï¼š</strong> å°†é¡µé¢çš„æ•°æ®å­˜å‚¨åœ¨ redux ä¸­ï¼Œåœ¨é‡æ–°åŠ è½½é¡µé¢æ—¶ï¼Œè·å– Redux ä¸­çš„æ•°æ®ï¼›</li><li><strong>data.jsï¼š</strong> ä½¿ç”¨ webpack æ„å»ºçš„é¡¹ç›®ï¼Œå¯ä»¥å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œdata.jsï¼Œå°†æ•°æ®ä¿å­˜ data.js ä¸­ï¼Œè·³è½¬é¡µé¢åè·å–ï¼›</li><li><strong>sessionStorgeï¼š</strong> åœ¨è¿›å…¥é€‰æ‹©åœ°å€é¡µé¢ä¹‹å‰ï¼ŒcomponentWillUnMount çš„æ—¶å€™ï¼Œå°†æ•°æ®å­˜å‚¨åˆ° sessionStorage ä¸­ï¼Œæ¯æ¬¡è¿›å…¥é¡µé¢åˆ¤æ–­ sessionStorage ä¸­æœ‰æ²¡æœ‰å­˜å‚¨çš„é‚£ä¸ªå€¼ï¼Œæœ‰ï¼Œåˆ™è¯»å–æ¸²æŸ“æ•°æ®ï¼›æ²¡æœ‰ï¼Œåˆ™è¯´æ˜æ•°æ®æ˜¯åˆå§‹åŒ–çš„çŠ¶æ€ã€‚è¿”å›æˆ–è¿›å…¥é™¤äº†é€‰æ‹©åœ°å€ä»¥å¤–çš„é¡µé¢ï¼Œæ¸…æ‰å­˜å‚¨çš„ sessionStorageï¼Œä¿è¯ä¸‹æ¬¡è¿›å…¥æ˜¯åˆå§‹åŒ–çš„æ•°æ®</li><li><strong>history APIï¼š</strong> History API çš„ <code>pushState</code> å‡½æ•°å¯ä»¥ç»™å†å²è®°å½•å…³è”ä¸€ä¸ªä»»æ„çš„å¯åºåˆ—åŒ– <code>state</code>ï¼Œæ‰€ä»¥å¯ä»¥åœ¨è·¯ç”± <code>push</code> çš„æ—¶å€™å°†å½“å‰é¡µé¢çš„ä¸€äº›ä¿¡æ¯å­˜åˆ° <code>state</code> ä¸­ï¼Œä¸‹æ¬¡è¿”å›åˆ°è¿™ä¸ªé¡µé¢çš„æ—¶å€™å°±èƒ½ä» <code>state</code> é‡Œé¢å–å‡ºç¦»å¼€å‰çš„æ•°æ®é‡æ–°æ¸²æŸ“ã€‚react-router ç›´æ¥å¯ä»¥æ”¯æŒã€‚è¿™ä¸ªæ–¹æ³•é€‚åˆä¸€äº›éœ€è¦ä¸´æ—¶å­˜å‚¨çš„åœºæ™¯ã€‚</li></ul><h3 id="14-åŒæ—¶å¼•ç”¨è¿™ä¸‰ä¸ªåº“-react-jsã€react-dom-js-å’Œ-babel-js-å®ƒä»¬éƒ½æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ"><a href="#14-åŒæ—¶å¼•ç”¨è¿™ä¸‰ä¸ªåº“-react-jsã€react-dom-js-å’Œ-babel-js-å®ƒä»¬éƒ½æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ" class="headerlink" title="14. åŒæ—¶å¼•ç”¨è¿™ä¸‰ä¸ªåº“ react.jsã€react-dom.js å’Œ babel.js å®ƒä»¬éƒ½æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ"></a>14. åŒæ—¶å¼•ç”¨è¿™ä¸‰ä¸ªåº“ react.jsã€react-dom.js å’Œ babel.js å®ƒä»¬éƒ½æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</h3><ul><li>reactï¼šåŒ…å« react æ‰€å¿…é¡»çš„æ ¸å¿ƒä»£ç </li><li>react-domï¼šreact æ¸²æŸ“åœ¨ä¸åŒå¹³å°æ‰€éœ€è¦çš„æ ¸å¿ƒä»£ç </li><li>babelï¼šå°† jsx è½¬æ¢æˆ React ä»£ç çš„å·¥å…·</li></ul><h3 id="15-React-å¿…é¡»ä½¿ç”¨-JSX-å—ï¼Ÿ"><a href="#15-React-å¿…é¡»ä½¿ç”¨-JSX-å—ï¼Ÿ" class="headerlink" title="15. React å¿…é¡»ä½¿ç”¨ JSX å—ï¼Ÿ"></a>15. React å¿…é¡»ä½¿ç”¨ JSX å—ï¼Ÿ</h3><p>React å¹¶ä¸å¼ºåˆ¶è¦æ±‚ä½¿ç”¨ JSXã€‚å½“ä¸æƒ³åœ¨æ„å»ºç¯å¢ƒä¸­é…ç½®æœ‰å…³ JSX ç¼–è¯‘æ—¶ï¼Œä¸åœ¨ React ä¸­ä½¿ç”¨ JSX ä¼šæ›´åŠ æ–¹ä¾¿ã€‚</p><p>æ¯ä¸ª JSX å…ƒç´ åªæ˜¯è°ƒç”¨ <code>React.createElement(component, props, ...children)</code> çš„è¯­æ³•ç³–ã€‚å› æ­¤ï¼Œä½¿ç”¨ JSX å¯ä»¥å®Œæˆçš„ä»»ä½•äº‹æƒ…éƒ½å¯ä»¥é€šè¿‡çº¯ JavaScript å®Œæˆã€‚</p><p>ä¾‹å¦‚ï¼Œç”¨ JSX ç¼–å†™çš„ä»£ç ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">Hello</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">></span>Hello <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>toWhat<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span>ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>Hello toWhat<span class="token operator">=</span><span class="token string">"World"</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯ä»¥ç¼–å†™ä¸ºä¸ä½¿ç”¨ JSX çš„ä»£ç ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">Hello</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token string">`Hello </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>toWhat<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span>ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>  React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>Hello<span class="token punctuation">,</span> <span class="token punctuation">{</span> toWhat<span class="token punctuation">:</span> <span class="token string">"World"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="16-ä¸ºä»€ä¹ˆä½¿ç”¨-jsx-çš„ç»„ä»¶ä¸­æ²¡æœ‰çœ‹åˆ°ä½¿ç”¨-react-å´éœ€è¦å¼•å…¥-reactï¼Ÿ"><a href="#16-ä¸ºä»€ä¹ˆä½¿ç”¨-jsx-çš„ç»„ä»¶ä¸­æ²¡æœ‰çœ‹åˆ°ä½¿ç”¨-react-å´éœ€è¦å¼•å…¥-reactï¼Ÿ" class="headerlink" title="16. ä¸ºä»€ä¹ˆä½¿ç”¨ jsx çš„ç»„ä»¶ä¸­æ²¡æœ‰çœ‹åˆ°ä½¿ç”¨ react å´éœ€è¦å¼•å…¥ reactï¼Ÿ"></a>16. ä¸ºä»€ä¹ˆä½¿ç”¨ jsx çš„ç»„ä»¶ä¸­æ²¡æœ‰çœ‹åˆ°ä½¿ç”¨ react å´éœ€è¦å¼•å…¥ reactï¼Ÿ</h3><p>æœ¬è´¨ä¸Šæ¥è¯´ JSX æ˜¯<code>React.createElement(component, props, ...children)</code>æ–¹æ³•çš„è¯­æ³•ç³–ã€‚åœ¨ React 17 ä¹‹å‰ï¼Œå¦‚æœä½¿ç”¨äº† JSXï¼Œå…¶å®å°±æ˜¯åœ¨ä½¿ç”¨ Reactï¼Œ <code>babel</code>  ä¼šæŠŠç»„ä»¶è½¬æ¢ä¸º  <code>CreateElement</code>  å½¢å¼ã€‚åœ¨ React 17 ä¹‹åï¼Œå°±ä¸å†éœ€è¦å¼•å…¥ï¼Œå› ä¸º  <code>babel</code>  å·²ç»å¯ä»¥å¸®æˆ‘ä»¬è‡ªåŠ¨å¼•å…¥ reactã€‚</p><h3 id="17-åœ¨-React-ä¸­æ€ä¹ˆä½¿ç”¨-async-awaitï¼Ÿ"><a href="#17-åœ¨-React-ä¸­æ€ä¹ˆä½¿ç”¨-async-awaitï¼Ÿ" class="headerlink" title="17. åœ¨ React ä¸­æ€ä¹ˆä½¿ç”¨ async/awaitï¼Ÿ"></a>17. åœ¨ React ä¸­æ€ä¹ˆä½¿ç”¨ async/awaitï¼Ÿ</h3><p>async/await æ˜¯ ES7 æ ‡å‡†ä¸­çš„æ–°ç‰¹æ€§ã€‚å¦‚æœæ˜¯ä½¿ç”¨ React å®˜æ–¹çš„è„šæ‰‹æ¶åˆ›å»ºçš„é¡¹ç›®ï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚å¦‚æœæ˜¯åœ¨è‡ªå·±æ­å»ºçš„ webpack é…ç½®çš„é¡¹ç›®ä¸­ä½¿ç”¨ï¼Œå¯èƒ½ä¼šé‡åˆ°  <strong>regeneratorRuntime is not defined</strong>  çš„å¼‚å¸¸é”™è¯¯ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦å¼•å…¥ babelï¼Œå¹¶åœ¨ babel ä¸­é…ç½®ä½¿ç”¨ async/awaitã€‚å¯ä»¥åˆ©ç”¨ babel çš„ transform-async-to-module-method æ’ä»¶æ¥è½¬æ¢å…¶æˆä¸ºæµè§ˆå™¨æ”¯æŒçš„è¯­æ³•ï¼Œè™½ç„¶æ²¡æœ‰æ€§èƒ½çš„æå‡ï¼Œä½†å¯¹äºä»£ç ç¼–å†™ä½“éªŒè¦æ›´å¥½ã€‚</p><h3 id="18-React-Children-map-å’Œ-js-çš„-map-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#18-React-Children-map-å’Œ-js-çš„-map-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="18. React.Children.map å’Œ js çš„ map æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>18. React.Children.map å’Œ js çš„ map æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>JavaScript ä¸­çš„ map ä¸ä¼šå¯¹ä¸º null æˆ–è€… undefined çš„æ•°æ®è¿›è¡Œå¤„ç†ï¼Œè€Œ React.Children.map ä¸­çš„ map å¯ä»¥å¤„ç† React.Children ä¸º null æˆ–è€… undefined çš„æƒ…å†µã€‚</p><h3 id="19-å¯¹-React-SSR-çš„ç†è§£"><a href="#19-å¯¹-React-SSR-çš„ç†è§£" class="headerlink" title="19. å¯¹ React SSR çš„ç†è§£"></a>19. å¯¹ React SSR çš„ç†è§£</h3><p>æœåŠ¡ç«¯æ¸²æŸ“æ˜¯æ•°æ®ä¸æ¨¡ç‰ˆç»„æˆçš„ htmlï¼Œå³ HTML = æ•°æ® ï¼‹ æ¨¡ç‰ˆã€‚å°†ç»„ä»¶æˆ–é¡µé¢é€šè¿‡æœåŠ¡å™¨ç”Ÿæˆ html å­—ç¬¦ä¸²ï¼Œå†å‘é€åˆ°æµè§ˆå™¨ï¼Œæœ€åå°†é™æ€æ ‡è®°â€æ··åˆâ€ä¸ºå®¢æˆ·ç«¯ä¸Šå®Œå…¨äº¤äº’çš„åº”ç”¨ç¨‹åºã€‚é¡µé¢æ²¡ä½¿ç”¨æœåŠ¡æ¸²æŸ“ï¼Œå½“è¯·æ±‚é¡µé¢æ—¶ï¼Œè¿”å›çš„ body é‡Œä¸ºç©ºï¼Œä¹‹åæ‰§è¡Œ js å°† html ç»“æ„æ³¨å…¥åˆ° body é‡Œï¼Œç»“åˆ css æ˜¾ç¤ºå‡ºæ¥;</p><p><strong>SSR çš„ä¼˜åŠ¿ï¼š</strong></p><ul><li>å¯¹ SEO å‹å¥½</li><li>æ‰€æœ‰çš„æ¨¡ç‰ˆã€å›¾ç‰‡ç­‰èµ„æºéƒ½å­˜åœ¨æœåŠ¡å™¨ç«¯</li><li>ä¸€ä¸ª html è¿”å›æ‰€æœ‰æ•°æ®</li><li>å‡å°‘ HTTP è¯·æ±‚</li><li>å“åº”å¿«ã€ç”¨æˆ·ä½“éªŒå¥½ã€é¦–å±æ¸²æŸ“å¿«</li></ul><p><strong>1ï¼‰æ›´åˆ©äº SEO</strong></p><p>ä¸åŒçˆ¬è™«å·¥ä½œåŸç†ç±»ä¼¼ï¼Œåªä¼šçˆ¬å–æºç ï¼Œä¸ä¼šæ‰§è¡Œç½‘ç«™çš„ä»»ä½•è„šæœ¬ä½¿ç”¨äº† React æˆ–è€…å…¶å®ƒ MVVM æ¡†æ¶ä¹‹åï¼Œé¡µé¢å¤§å¤šæ•° DOM å…ƒç´ éƒ½æ˜¯åœ¨å®¢æˆ·ç«¯æ ¹æ® js åŠ¨æ€ç”Ÿæˆï¼Œå¯ä¾›çˆ¬è™«æŠ“å–åˆ†æçš„å†…å®¹å¤§å¤§å‡å°‘ã€‚å¦å¤–ï¼Œæµè§ˆå™¨çˆ¬è™«ä¸ä¼šç­‰å¾…æˆ‘ä»¬çš„æ•°æ®å®Œæˆä¹‹åå†å»æŠ“å–é¡µé¢æ•°æ®ã€‚æœåŠ¡ç«¯æ¸²æŸ“è¿”å›ç»™å®¢æˆ·ç«¯çš„æ˜¯å·²ç»è·å–äº†å¼‚æ­¥æ•°æ®å¹¶æ‰§è¡Œ JavaScript è„šæœ¬çš„æœ€ç»ˆ HTMLï¼Œç½‘ç»œçˆ¬ä¸­å°±å¯ä»¥æŠ“å–åˆ°å®Œæ•´é¡µé¢çš„ä¿¡æ¯ã€‚</p><p><strong>2ï¼‰æ›´åˆ©äºé¦–å±æ¸²æŸ“</strong></p><p>é¦–å±çš„æ¸²æŸ“æ˜¯ node å‘é€è¿‡æ¥çš„ html å­—ç¬¦ä¸²ï¼Œå¹¶ä¸ä¾èµ–äº js æ–‡ä»¶äº†ï¼Œè¿™å°±ä¼šä½¿ç”¨æˆ·æ›´å¿«çš„çœ‹åˆ°é¡µé¢çš„å†…å®¹ã€‚å°¤å…¶æ˜¯é’ˆå¯¹å¤§å‹å•é¡µåº”ç”¨ï¼Œæ‰“åŒ…åæ–‡ä»¶ä½“ç§¯æ¯”è¾ƒå¤§ï¼Œæ™®é€šå®¢æˆ·ç«¯æ¸²æŸ“åŠ è½½æ‰€æœ‰æ‰€éœ€æ–‡ä»¶æ—¶é—´è¾ƒé•¿ï¼Œé¦–é¡µå°±ä¼šæœ‰ä¸€ä¸ªå¾ˆé•¿çš„ç™½å±ç­‰å¾…æ—¶é—´ã€‚</p><p><strong>SSR çš„å±€é™ï¼š</strong></p><p><strong>1ï¼‰æœåŠ¡ç«¯å‹åŠ›è¾ƒå¤§</strong></p><p>æœ¬æ¥æ˜¯é€šè¿‡å®¢æˆ·ç«¯å®Œæˆæ¸²æŸ“ï¼Œç°åœ¨ç»Ÿä¸€åˆ°æœåŠ¡ç«¯ node æœåŠ¡å»åšã€‚å°¤å…¶æ˜¯é«˜å¹¶å‘è®¿é—®çš„æƒ…å†µï¼Œä¼šå¤§é‡å ç”¨æœåŠ¡ç«¯ CPU èµ„æº;</p><p><strong>2ï¼‰å¼€å‘æ¡ä»¶å—é™</strong></p><p>åœ¨æœåŠ¡ç«¯æ¸²æŸ“ä¸­ï¼Œåªä¼šæ‰§è¡Œåˆ° componentDidMount ä¹‹å‰çš„ç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œå› æ­¤é¡¹ç›®å¼•ç”¨çš„ç¬¬ä¸‰æ–¹çš„åº“ä¹Ÿä¸å¯ç”¨å…¶å®ƒç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œè¿™å¯¹å¼•ç”¨åº“çš„é€‰æ‹©äº§ç”Ÿäº†å¾ˆå¤§çš„é™åˆ¶;</p><p><strong>3ï¼‰å­¦ä¹ æˆæœ¬ç›¸å¯¹è¾ƒé«˜</strong><br>é™¤äº†å¯¹ webpackã€MVVM æ¡†æ¶è¦ç†Ÿæ‚‰ï¼Œè¿˜éœ€è¦æŒæ¡ nodeã€ Koa2 ç­‰ç›¸å…³æŠ€æœ¯ã€‚ç›¸å¯¹äºå®¢æˆ·ç«¯æ¸²æŸ“ï¼Œé¡¹ç›®æ„å»ºã€éƒ¨ç½²è¿‡ç¨‹æ›´åŠ å¤æ‚ã€‚</p><p><strong>æ—¶é—´è€—æ—¶æ¯”è¾ƒï¼š</strong></p><p><strong>1ï¼‰æ•°æ®è¯·æ±‚</strong></p><p>ç”±æœåŠ¡ç«¯è¯·æ±‚é¦–å±æ•°æ®ï¼Œè€Œä¸æ˜¯å®¢æˆ·ç«¯è¯·æ±‚é¦–å±æ•°æ®ï¼Œè¿™æ˜¯â€å¿«â€çš„ä¸€ä¸ªä¸»è¦åŸå› ã€‚æœåŠ¡ç«¯åœ¨å†…ç½‘è¿›è¡Œè¯·æ±‚ï¼Œæ•°æ®å“åº”é€Ÿåº¦å¿«ã€‚å®¢æˆ·ç«¯åœ¨ä¸åŒç½‘ç»œç¯å¢ƒè¿›è¡Œæ•°æ®è¯·æ±‚ï¼Œä¸”å¤–ç½‘ http è¯·æ±‚å¼€é”€å¤§ï¼Œå¯¼è‡´æ—¶é—´å·®</p><ul><li>å®¢æˆ·ç«¯æ•°æ®è¯·æ±‚</li></ul><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="5.jpg" alt="51612599334_.pic.jpg"></p><ul><li>æœåŠ¡ç«¯æ•°æ®è¯·æ±‚</li></ul><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="6.jpg" alt="61612599340_.pic.jpg"><br><strong>2ï¼‰html æ¸²æŸ“</strong><br>æœåŠ¡ç«¯æ¸²æŸ“æ˜¯å…ˆå‘åç«¯æœåŠ¡å™¨è¯·æ±‚æ•°æ®ï¼Œç„¶åç”Ÿæˆå®Œæ•´é¦–å± html è¿”å›ç»™æµè§ˆå™¨ï¼›è€Œå®¢æˆ·ç«¯æ¸²æŸ“æ˜¯ç­‰ js ä»£ç ä¸‹è½½ã€åŠ è½½ã€è§£æå®Œæˆåå†è¯·æ±‚æ•°æ®æ¸²æŸ“ï¼Œç­‰å¾…çš„è¿‡ç¨‹é¡µé¢æ˜¯ä»€ä¹ˆéƒ½æ²¡æœ‰çš„ï¼Œå°±æ˜¯ç”¨æˆ·çœ‹åˆ°çš„ç™½å±ã€‚å°±æ˜¯æœåŠ¡ç«¯æ¸²æŸ“ä¸éœ€è¦ç­‰å¾… js ä»£ç ä¸‹è½½å®Œæˆå¹¶è¯·æ±‚æ•°æ®ï¼Œå°±å¯ä»¥è¿”å›ä¸€ä¸ªå·²æœ‰å®Œæ•´æ•°æ®çš„é¦–å±é¡µé¢ã€‚</p><ul><li>é ssr html æ¸²æŸ“</li></ul><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="7.jpg" alt="31612599269_.pic.jpg"></p><ul><li>ssr html æ¸²æŸ“</li></ul><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="8.jpg" alt="41612599275_.pic.jpg"></p><h3 id="20-ä¸ºä»€ä¹ˆ-React-è¦ç”¨-JSXï¼Ÿ"><a href="#20-ä¸ºä»€ä¹ˆ-React-è¦ç”¨-JSXï¼Ÿ" class="headerlink" title="20. ä¸ºä»€ä¹ˆ  React è¦ç”¨ JSXï¼Ÿ"></a>20. ä¸ºä»€ä¹ˆ  React è¦ç”¨ JSXï¼Ÿ</h3><p>JSX æ˜¯ä¸€ä¸ª JavaScript çš„è¯­æ³•æ‰©å±•ï¼Œæˆ–è€…è¯´æ˜¯ä¸€ä¸ªç±»ä¼¼äº XML çš„ ECMAScript è¯­æ³•æ‰©å±•ã€‚å®ƒæœ¬èº«æ²¡æœ‰å¤ªå¤šçš„è¯­æ³•å®šä¹‰ï¼Œä¹Ÿä¸æœŸæœ›å¼•å…¥æ›´å¤šçš„æ ‡å‡†ã€‚</p><p>å…¶å® React æœ¬èº«å¹¶ä¸å¼ºåˆ¶ä½¿ç”¨ JSXã€‚åœ¨æ²¡æœ‰ JSX çš„æ—¶å€™ï¼ŒReact å®ç°ä¸€ä¸ªç»„ä»¶ä¾èµ–äºä½¿ç”¨ React.createElement å‡½æ•°ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">Hello</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token string">`Hello </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>toWhat<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span>ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>  React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>Hello<span class="token punctuation">,</span> <span class="token punctuation">{</span> toWhat<span class="token punctuation">:</span> <span class="token string">"World"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è€Œ JSX æ›´åƒæ˜¯ä¸€ç§è¯­æ³•ç³–ï¼Œé€šè¿‡ç±»ä¼¼ XML çš„æè¿°æ–¹å¼ï¼Œæå†™å‡½æ•°å¯¹è±¡ã€‚åœ¨é‡‡ç”¨ JSX ä¹‹åï¼Œè¿™æ®µä»£ç ä¼šè¿™æ ·å†™ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">Hello</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">></span>Hello <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>toWhat<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span>ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>Hello toWhat<span class="token operator">=</span><span class="token string">"World"</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"root"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡å¯¹æ¯”ï¼Œå¯ä»¥æ¸…æ™°åœ°å‘ç°ï¼Œä»£ç å˜å¾—æ›´ä¸ºç®€æ´ï¼Œè€Œä¸”ä»£ç ç»“æ„å±‚æ¬¡æ›´ä¸ºæ¸…æ™°ã€‚</p><p>å› ä¸º React éœ€è¦å°†ç»„ä»¶è½¬åŒ–ä¸ºè™šæ‹Ÿ DOM æ ‘ï¼Œæ‰€ä»¥åœ¨ç¼–å†™ä»£ç æ—¶ï¼Œå®é™…ä¸Šæ˜¯åœ¨æ‰‹å†™ä¸€æ£µç»“æ„æ ‘ã€‚è€Œ<strong>XML åœ¨æ ‘ç»“æ„çš„æè¿°ä¸Šå¤©ç”Ÿå…·æœ‰å¯è¯»æ€§å¼ºçš„ä¼˜åŠ¿ã€‚</strong></p><p>ä½†è¿™æ ·å¯è¯»æ€§å¼ºçš„ä»£ç ä»…ä»…æ˜¯ç»™å†™ç¨‹åºçš„åŒå­¦çœ‹çš„ï¼Œå®é™…ä¸Šåœ¨è¿è¡Œçš„æ—¶å€™ï¼Œä¼šä½¿ç”¨ Babel æ’ä»¶å°† JSX è¯­æ³•çš„ä»£ç è¿˜åŸä¸º React.createElement çš„ä»£ç ã€‚</p><p><strong>æ€»ç»“ï¼š</strong><br>JSX æ˜¯ä¸€ä¸ª JavaScript çš„è¯­æ³•æ‰©å±•ï¼Œç»“æ„ç±»ä¼¼ XMLã€‚JSX ä¸»è¦ç”¨äºå£°æ˜ React å…ƒç´ ï¼Œä½† React ä¸­å¹¶ä¸å¼ºåˆ¶ä½¿ç”¨ JSXã€‚å³ä½¿ä½¿ç”¨äº† JSXï¼Œä¹Ÿä¼šåœ¨æ„å»ºè¿‡ç¨‹ä¸­ï¼Œé€šè¿‡ Babel æ’ä»¶ç¼–è¯‘ä¸º React.createElementã€‚æ‰€ä»¥ JSX æ›´åƒæ˜¯ React.createElement çš„ä¸€ç§è¯­æ³•ç³–ã€‚</p><p>React å›¢é˜Ÿå¹¶ä¸æƒ³å¼•å…¥ JavaScript æœ¬èº«ä»¥å¤–çš„å¼€å‘ä½“ç³»ã€‚è€Œæ˜¯å¸Œæœ›é€šè¿‡åˆç†çš„å…³æ³¨ç‚¹åˆ†ç¦»ä¿æŒç»„ä»¶å¼€å‘çš„çº¯ç²¹æ€§ã€‚</p><h3 id="21-HOC-ç›¸æ¯”-mixins-æœ‰ä»€ä¹ˆä¼˜ç‚¹ï¼Ÿ"><a href="#21-HOC-ç›¸æ¯”-mixins-æœ‰ä»€ä¹ˆä¼˜ç‚¹ï¼Ÿ" class="headerlink" title="21. HOC ç›¸æ¯” mixins æœ‰ä»€ä¹ˆä¼˜ç‚¹ï¼Ÿ"></a>21. HOC ç›¸æ¯” mixins æœ‰ä»€ä¹ˆä¼˜ç‚¹ï¼Ÿ</h3><p>HOC å’Œ Vue ä¸­çš„ mixins ä½œç”¨æ˜¯ä¸€è‡´çš„ï¼Œå¹¶ä¸”åœ¨æ—©æœŸ React ä¹Ÿæ˜¯ä½¿ç”¨ mixins çš„æ–¹å¼ã€‚ä½†æ˜¯åœ¨ä½¿ç”¨ class çš„æ–¹å¼åˆ›å»ºç»„ä»¶ä»¥åï¼Œmixins çš„æ–¹å¼å°±ä¸èƒ½ä½¿ç”¨äº†ï¼Œå¹¶ä¸”å…¶å® mixins ä¹Ÿæ˜¯å­˜åœ¨ä¸€äº›é—®é¢˜çš„ï¼Œæ¯”å¦‚ï¼š</p><ul><li>éšå«äº†ä¸€äº›ä¾èµ–ï¼Œæ¯”å¦‚æˆ‘åœ¨ç»„ä»¶ä¸­å†™äº†æŸä¸ª <code>state</code> å¹¶ä¸”åœ¨ <code>mixin</code> ä¸­ä½¿ç”¨äº†ï¼Œå°±è¿™å­˜åœ¨äº†ä¸€ä¸ªä¾èµ–å…³ç³»ã€‚ä¸‡ä¸€ä¸‹æ¬¡åˆ«äººè¦ç§»é™¤å®ƒï¼Œå°±å¾—å» <code>mixin</code> ä¸­æŸ¥æ‰¾ä¾èµ–</li><li>å¤šä¸ª <code>mixin</code> ä¸­å¯èƒ½å­˜åœ¨ç›¸åŒå‘½åçš„å‡½æ•°ï¼ŒåŒæ—¶ä»£ç ç»„ä»¶ä¸­ä¹Ÿä¸èƒ½å‡ºç°ç›¸åŒå‘½åçš„å‡½æ•°ï¼Œå¦åˆ™å°±æ˜¯é‡å†™äº†ï¼Œå…¶å®æˆ‘ä¸€ç›´è§‰å¾—å‘½åçœŸçš„æ˜¯ä¸€ä»¶éº»çƒ¦äº‹ã€‚ã€‚</li><li>é›ªçƒæ•ˆåº”ï¼Œè™½ç„¶æˆ‘ä¸€ä¸ªç»„ä»¶è¿˜æ˜¯ä½¿ç”¨ç€åŒä¸€ä¸ª <code>mixin</code>ï¼Œä½†æ˜¯ä¸€ä¸ª <code>mixin</code> ä¼šè¢«å¤šä¸ªç»„ä»¶ä½¿ç”¨ï¼Œå¯èƒ½ä¼šå­˜åœ¨éœ€æ±‚ä½¿å¾— <code>mixin</code> ä¿®æ”¹åŸæœ¬çš„å‡½æ•°æˆ–è€…æ–°å¢æ›´å¤šçš„å‡½æ•°ï¼Œè¿™æ ·å¯èƒ½å°±ä¼šäº§ç”Ÿä¸€ä¸ªç»´æŠ¤æˆæœ¬</li></ul><p>HOC è§£å†³äº†è¿™äº›é—®é¢˜ï¼Œå¹¶ä¸”å®ƒä»¬è¾¾æˆçš„æ•ˆæœä¹Ÿæ˜¯ä¸€è‡´çš„ï¼ŒåŒæ—¶ä¹Ÿæ›´åŠ çš„æ”¿æ²»æ­£ç¡®ï¼ˆæ¯•ç«Ÿæ›´åŠ å‡½æ•°å¼äº†ï¼‰ã€‚</p><h3 id="22-React-ä¸­çš„é«˜é˜¶ç»„ä»¶è¿ç”¨äº†ä»€ä¹ˆè®¾è®¡æ¨¡å¼ï¼Ÿ"><a href="#22-React-ä¸­çš„é«˜é˜¶ç»„ä»¶è¿ç”¨äº†ä»€ä¹ˆè®¾è®¡æ¨¡å¼ï¼Ÿ" class="headerlink" title="22. React ä¸­çš„é«˜é˜¶ç»„ä»¶è¿ç”¨äº†ä»€ä¹ˆè®¾è®¡æ¨¡å¼ï¼Ÿ"></a>22. React ä¸­çš„é«˜é˜¶ç»„ä»¶è¿ç”¨äº†ä»€ä¹ˆè®¾è®¡æ¨¡å¼ï¼Ÿ</h3><p>ä½¿ç”¨äº†è£…é¥°æ¨¡å¼ï¼Œé«˜é˜¶ç»„ä»¶çš„è¿ç”¨ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">withWindowWidth</span><span class="token punctuation">(</span>BaseComponent<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">class</span> <span class="token class-name">DerivedClass</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>    state <span class="token operator">=</span> <span class="token punctuation">{</span>      windowWidth<span class="token punctuation">:</span> window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    onResize <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>        windowWidth<span class="token punctuation">:</span> window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">,</span>      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"resize"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>onResize<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      window<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">"resize"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>onResize<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">return</span> <span class="token operator">&lt;</span>BaseComponent <span class="token punctuation">{</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">}</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> DerivedClass<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">const</span> MyComponent <span class="token operator">=</span> <span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">></span>Window width is<span class="token punctuation">:</span> <span class="token punctuation">{</span>props<span class="token punctuation">.</span>windowWidth<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">withWindowWidth</span><span class="token punctuation">(</span>MyComponent<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è£…é¥°æ¨¡å¼çš„ç‰¹ç‚¹æ˜¯ä¸éœ€è¦æ”¹å˜ è¢«è£…é¥°å¯¹è±¡ æœ¬èº«ï¼Œè€Œåªæ˜¯åœ¨å¤–é¢å¥—ä¸€ä¸ªå¤–å£³æ¥å£ã€‚JavaScript ç›®å‰å·²ç»æœ‰äº†åŸç”Ÿè£…é¥°å™¨çš„ææ¡ˆï¼Œå…¶ç”¨æ³•å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript">@testable<span class="token keyword">class</span> <span class="token class-name">MyTestableClass</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> reactå¸¸è§é—®é¢˜æ±‡æ€»2 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Github </tag>
            
            <tag> åšå®¢ </tag>
            
            <tag> reactå¸¸è§é—®é¢˜æ±‡æ€»2 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AIå®æˆ˜é¡¹ç›®æ–‡æ¡£</title>
      <link href="/2024/12/20/ai-shi-zhan-xiang-mu-wen-dang/"/>
      <url>/2024/12/20/ai-shi-zhan-xiang-mu-wen-dang/</url>
      
        <content type="html"><![CDATA[<h1 id="AI-å®æˆ˜é¡¹ç›®æ–‡æ¡£"><a href="#AI-å®æˆ˜é¡¹ç›®æ–‡æ¡£" class="headerlink" title="AI å®æˆ˜é¡¹ç›®æ–‡æ¡£"></a>AI å®æˆ˜é¡¹ç›®æ–‡æ¡£</h1><h2 id="ğŸ“–-é¡¹ç›®æ¦‚è¿°"><a href="#ğŸ“–-é¡¹ç›®æ¦‚è¿°" class="headerlink" title="ğŸ“– é¡¹ç›®æ¦‚è¿°"></a>ğŸ“– é¡¹ç›®æ¦‚è¿°</h2><p><strong>AI è™šæ‹Ÿäººæ™ºæ…§å¤§å±</strong> æ˜¯ä¸€ä¸ªåŸºäºå¤šæ¨¡æ€ AI æŠ€æœ¯çš„æ™ºèƒ½äº¤äº’ç³»ç»Ÿï¼Œé€šè¿‡è¯­éŸ³è¯†åˆ«ã€äººè„¸è¯†åˆ«ã€æ•°å­—äººå¯¹è¯ç­‰æŠ€æœ¯ï¼Œä¸ºçº¿ä¸‹åœºæ™¯ï¼ˆå±•å…ã€å•†åœºã€è¥ä¸šå…ç­‰ï¼‰æä¾›æ™ºèƒ½åŒ–æœåŠ¡ã€‚æœ¬é¡¹ç›®é‡‡ç”¨ Vue 3 + Electron æ¶æ„ï¼Œå®ç°äº†å®Œæ•´çš„ AI äº¤äº’é—­ç¯ã€‚</p><h3 id="æ ¸å¿ƒç‰¹æ€§"><a href="#æ ¸å¿ƒç‰¹æ€§" class="headerlink" title="æ ¸å¿ƒç‰¹æ€§"></a>æ ¸å¿ƒç‰¹æ€§</h3><ul><li>ğŸ¤ <strong>å®æ—¶è¯­éŸ³è¯†åˆ«ï¼ˆASRï¼‰</strong>ï¼šæ”¯æŒå¤šç§ ASR å¼•æ“ï¼Œå¯æ’æ‹”å¼æ¶æ„</li><li>ğŸ‘¤ <strong>äººè„¸è¯†åˆ«ä¸è·Ÿè¸ª</strong>ï¼šå®æ—¶äººè„¸æ£€æµ‹ã€æƒ…ç»ªè¯†åˆ«ã€è§†çº¿è·Ÿè¸ª</li><li>ğŸ¤– <strong>æ•°å­—äººå¯¹è¯</strong>ï¼šè‡ªç„¶è¯­è¨€ç†è§£ã€å¤šè½®å¯¹è¯ã€ä¸Šä¸‹æ–‡æ„ŸçŸ¥</li><li>ğŸ¨ <strong>å¤šæ¨¡æ€äº¤äº’</strong>ï¼šè¯­éŸ³ã€è§†è§‰ã€è§¦æ§ç­‰å¤šç§äº¤äº’æ–¹å¼èåˆ</li><li>ğŸ”„ <strong>å¯æ‰©å±•æ¶æ„</strong>ï¼šæ”¯æŒå¤šç§ AI æœåŠ¡æä¾›å•†åˆ‡æ¢</li></ul><hr><h2 id="ğŸ—ï¸-æŠ€æœ¯æ¶æ„"><a href="#ğŸ—ï¸-æŠ€æœ¯æ¶æ„" class="headerlink" title="ğŸ—ï¸ æŠ€æœ¯æ¶æ„"></a>ğŸ—ï¸ æŠ€æœ¯æ¶æ„</h2><h3 id="æŠ€æœ¯æ ˆ"><a href="#æŠ€æœ¯æ ˆ" class="headerlink" title="æŠ€æœ¯æ ˆ"></a>æŠ€æœ¯æ ˆ</h3><pre><code>å‰ç«¯æ¡†æ¶ï¼šVue 3 (Composition API)æ¡Œé¢æ¡†æ¶ï¼šElectron 23.xç±»å‹ç³»ç»Ÿï¼šTypeScript 4.xçŠ¶æ€ç®¡ç†ï¼šVuex 4 + vuex-module-decoratorsè·¯ç”±ç®¡ç†ï¼šVue Router 4UIæ¡†æ¶ï¼šWindiCSSæ„å»ºå·¥å…·ï¼šVue CLI 4.5</code></pre><h3 id="æ ¸å¿ƒä¾èµ–"><a href="#æ ¸å¿ƒä¾èµ–" class="headerlink" title="æ ¸å¿ƒä¾èµ–"></a>æ ¸å¿ƒä¾èµ–</h3><pre class="line-numbers language-json"><code class="language-json"><span class="token punctuation">{</span>  <span class="token property">"@xmov/walle"</span><span class="token operator">:</span> <span class="token string">"2.0.1"</span><span class="token punctuation">,</span> // AIå¤šåª’ä½“å¤„ç†å¼•æ“  <span class="token property">"@xmov/detect-face"</span><span class="token operator">:</span> <span class="token string">"^0.0.6"</span><span class="token punctuation">,</span> // äººè„¸è¯†åˆ«åº“  <span class="token property">"@xmov/web-recorder"</span><span class="token operator">:</span> <span class="token string">"^0.0.6"</span><span class="token punctuation">,</span> // éŸ³é¢‘å½•åˆ¶  <span class="token property">"@xmov/video-call"</span><span class="token operator">:</span> <span class="token string">"^0.0.3"</span><span class="token punctuation">,</span> // è§†é¢‘é€šè¯èƒ½åŠ›  <span class="token property">"face-api.js"</span><span class="token operator">:</span> <span class="token string">"^0.22.2"</span><span class="token punctuation">,</span> // äººè„¸æ£€æµ‹æ¨¡å‹  <span class="token property">"axios"</span><span class="token operator">:</span> <span class="token string">"^0.24.0"</span><span class="token punctuation">,</span> // HTTPå®¢æˆ·ç«¯  <span class="token property">"socket.io-client"</span><span class="token operator">:</span> <span class="token string">"^2.3.0"</span> // WebSocketé€šä¿¡<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="ğŸ¯-æ ¸å¿ƒåŠŸèƒ½å®ç°"><a href="#ğŸ¯-æ ¸å¿ƒåŠŸèƒ½å®ç°" class="headerlink" title="ğŸ¯ æ ¸å¿ƒåŠŸèƒ½å®ç°"></a>ğŸ¯ æ ¸å¿ƒåŠŸèƒ½å®ç°</h2><h3 id="1-å¯æ’æ‹”-ASR-ç³»ç»Ÿ"><a href="#1-å¯æ’æ‹”-ASR-ç³»ç»Ÿ" class="headerlink" title="1. å¯æ’æ‹” ASR ç³»ç»Ÿ"></a>1. å¯æ’æ‹” ASR ç³»ç»Ÿ</h3><h4 id="1-1-æ¶æ„è®¾è®¡"><a href="#1-1-æ¶æ„è®¾è®¡" class="headerlink" title="1.1 æ¶æ„è®¾è®¡"></a>1.1 æ¶æ„è®¾è®¡</h4><p>é¡¹ç›®å®ç°äº†<strong>å¯æ’æ‹”çš„ ASRï¼ˆè‡ªåŠ¨è¯­éŸ³è¯†åˆ«ï¼‰æ¶æ„</strong>ï¼Œæ”¯æŒåœ¨ä¸åŒ ASR å¼•æ“é—´æ— ç¼åˆ‡æ¢ã€‚</p><p><strong>æ ¸å¿ƒæ–‡ä»¶ç»“æ„ï¼š</strong></p><pre><code>src/â”œâ”€â”€ interfaces/â”‚   â””â”€â”€ IAsrProvider.ts          # ç»Ÿä¸€æ¥å£å®šä¹‰â”œâ”€â”€ providers/â”‚   â”œâ”€â”€ ProviderFactory.ts       # å·¥å‚æ¨¡å¼åˆ›å»ºæä¾›è€…â”‚   â”œâ”€â”€ WalleProvider.ts         # Walleå¼•æ“é€‚é…å™¨â”‚   â””â”€â”€ TencentAsrProvider.ts    # è…¾è®¯äº‘ASRé€‚é…å™¨â”œâ”€â”€ hooks/â”‚   â””â”€â”€ usePluggableAsr.ts       # ç»Ÿä¸€Hookå±‚â””â”€â”€ config/    â””â”€â”€ pluggable-asr.config.ts  # é…ç½®ç®¡ç†</code></pre><h4 id="1-2-æ¥å£æŠ½è±¡å±‚"><a href="#1-2-æ¥å£æŠ½è±¡å±‚" class="headerlink" title="1.2 æ¥å£æŠ½è±¡å±‚"></a>1.2 æ¥å£æŠ½è±¡å±‚</h4><p>é€šè¿‡ <code>IAsrProvider</code> æ¥å£ç»Ÿä¸€ä¸åŒ ASR æœåŠ¡çš„å®ç°ï¼š</p><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">IAsrProvider</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// çŠ¶æ€å±æ€§</span>  readonly asrText<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">;</span>  readonly asrState<span class="token punctuation">:</span> AsrState<span class="token punctuation">;</span>  readonly faceDetected<span class="token punctuation">:</span> <span class="token keyword">boolean</span><span class="token punctuation">;</span>  readonly faceData<span class="token punctuation">:</span> FaceDetectionResult <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// ç”Ÿå‘½å‘¨æœŸ</span>  <span class="token function">init</span><span class="token punctuation">(</span>config<span class="token punctuation">:</span> ProviderConfig<span class="token punctuation">)</span><span class="token punctuation">:</span> Promise<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span><span class="token punctuation">;</span>  <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> Promise<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// ASRæ§åˆ¶</span>  <span class="token function">startAsr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> Promise<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span><span class="token punctuation">;</span>  <span class="token function">stopAsr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> Promise<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// äººè„¸è¯†åˆ«æ§åˆ¶</span>  <span class="token function">startFaceDetection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> Promise<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span><span class="token punctuation">;</span>  <span class="token function">stopFaceDetection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> Promise<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// å›è°ƒè®¾ç½®</span>  <span class="token function">setCallbacks</span><span class="token punctuation">(</span>callbacks<span class="token punctuation">:</span> <span class="token punctuation">{</span>    onAsrStart<span class="token operator">?</span><span class="token punctuation">:</span> AsrStartCallback<span class="token punctuation">;</span>    onAsrResult<span class="token operator">?</span><span class="token punctuation">:</span> AsrCallback<span class="token punctuation">;</span>    onAsrUpdate<span class="token operator">?</span><span class="token punctuation">:</span> AsrUpdateCallback<span class="token punctuation">;</span>    onFaceDetected<span class="token operator">?</span><span class="token punctuation">:</span> FaceCallback<span class="token punctuation">;</span>    onTimeout<span class="token operator">?</span><span class="token punctuation">:</span> TimeoutCallback<span class="token punctuation">;</span>    onError<span class="token operator">?</span><span class="token punctuation">:</span> ErrorCallback<span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="1-3-æä¾›è€…å®ç°"><a href="#1-3-æä¾›è€…å®ç°" class="headerlink" title="1.3 æä¾›è€…å®ç°"></a>1.3 æä¾›è€…å®ç°</h4><p><strong>WalleProviderï¼ˆæ¨èæ–¹æ¡ˆï¼‰ï¼š</strong></p><ul><li>âœ… ç»Ÿä¸€çš„ WebSocket é€šä¿¡</li><li>âœ… å®æ—¶è§†é¢‘/éŸ³é¢‘æµå¤„ç†</li><li>âœ… å†…ç½®äººè„¸è¯†åˆ«èƒ½åŠ›</li><li>âœ… ä½å»¶è¿Ÿè¯­éŸ³è¯†åˆ«</li></ul><p><strong>TencentAsrProviderï¼ˆå¤‡é€‰æ–¹æ¡ˆï¼‰ï¼š</strong></p><ul><li>âœ… è…¾è®¯äº‘å®æ—¶è¯­éŸ³è¯†åˆ«</li><li>âœ… é«˜å‡†ç¡®ç‡è¯†åˆ«</li><li>âœ… å¤šè¯­è¨€æ”¯æŒ</li></ul><h4 id="1-4-ä½¿ç”¨ç¤ºä¾‹"><a href="#1-4-ä½¿ç”¨ç¤ºä¾‹" class="headerlink" title="1.4 ä½¿ç”¨ç¤ºä¾‹"></a>1.4 ä½¿ç”¨ç¤ºä¾‹</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> usePluggableAsr <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@/hooks/usePluggableAsr"</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span> ProviderType <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@/interfaces/IAsrProvider"</span><span class="token punctuation">;</span><span class="token keyword">const</span> voiceStart <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token keyword">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// åˆå§‹åŒ–å¯æ’æ‹”ASR</span><span class="token keyword">const</span> <span class="token punctuation">{</span>  currentProvider<span class="token punctuation">,</span>  asrText<span class="token punctuation">,</span>  asrState<span class="token punctuation">,</span>  switchProvider<span class="token punctuation">,</span>  init<span class="token punctuation">,</span>  startAsr<span class="token punctuation">,</span>  stopAsr<span class="token punctuation">,</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">usePluggableAsr</span><span class="token punctuation">(</span>voiceStart<span class="token punctuation">,</span> <span class="token punctuation">{</span>  defaultProvider<span class="token punctuation">:</span> ProviderType<span class="token punctuation">.</span>WALLE<span class="token punctuation">,</span>  autoInit<span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// åˆå§‹åŒ–Walleå¼•æ“</span>await <span class="token function">switchProvider</span><span class="token punctuation">(</span>ProviderType<span class="token punctuation">.</span>WALLE<span class="token punctuation">,</span> <span class="token punctuation">{</span>  serverUrl<span class="token punctuation">:</span> <span class="token string">"ws://localhost:39999"</span><span class="token punctuation">,</span>  videoCanvas<span class="token punctuation">:</span> canvasElement<span class="token punctuation">,</span>  renderOptions<span class="token punctuation">:</span> <span class="token punctuation">{</span>    fps<span class="token punctuation">:</span> <span class="token punctuation">{</span> layout<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span> size<span class="token punctuation">:</span> <span class="token number">16</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// è®¾ç½®å›è°ƒ</span><span class="token function">setCallbacks</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  onAsrResult<span class="token punctuation">:</span> <span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"è¯†åˆ«ç»“æœ:"</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// å‘é€ç»™æ•°å­—äººè¿›è¡Œå›å¤</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  onFaceDetected<span class="token punctuation">:</span> <span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"æ£€æµ‹åˆ°äººè„¸:"</span><span class="token punctuation">,</span> result<span class="token punctuation">.</span>faceCount<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// å¯åŠ¨ASR</span>await <span class="token function">startAsr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h3 id="2-äººè„¸è¯†åˆ«ç³»ç»Ÿ"><a href="#2-äººè„¸è¯†åˆ«ç³»ç»Ÿ" class="headerlink" title="2. äººè„¸è¯†åˆ«ç³»ç»Ÿ"></a>2. äººè„¸è¯†åˆ«ç³»ç»Ÿ</h3><h4 id="2-1-äººè„¸æ£€æµ‹æµç¨‹"><a href="#2-1-äººè„¸æ£€æµ‹æµç¨‹" class="headerlink" title="2.1 äººè„¸æ£€æµ‹æµç¨‹"></a>2.1 äººè„¸æ£€æµ‹æµç¨‹</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// Walleå¼•æ“è‡ªåŠ¨æä¾›äººè„¸æ£€æµ‹ä¿¡æ¯</span><span class="token keyword">this</span><span class="token punctuation">.</span>walleClient<span class="token punctuation">.</span><span class="token function">subject</span><span class="token punctuation">(</span><span class="token string">"videoframe"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span>frameInfo<span class="token punctuation">:</span> <span class="token keyword">any</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> <span class="token punctuation">{</span> has_face<span class="token punctuation">,</span> face_num<span class="token punctuation">,</span> face_x<span class="token punctuation">,</span> face_y<span class="token punctuation">,</span> face_w<span class="token punctuation">,</span> face_h <span class="token punctuation">}</span> <span class="token operator">=</span> frameInfo<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// æ›´æ–°æ£€æµ‹çŠ¶æ€</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>faceDetected <span class="token operator">=</span> has_face <span class="token operator">&amp;&amp;</span> face_num <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// ç»˜åˆ¶äººè„¸æ¡†</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>has_face <span class="token operator">&amp;&amp;</span> canvasContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>    canvasContext<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">"rgba(0, 255, 0, 0.9)"</span><span class="token punctuation">;</span>    canvasContext<span class="token punctuation">.</span><span class="token function">strokeRect</span><span class="token punctuation">(</span>face_x<span class="token punctuation">,</span> face_y<span class="token punctuation">,</span> face_w<span class="token punctuation">,</span> face_h<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-2-äººè„¸è¯†åˆ«ä¼˜åŒ–ç­–ç•¥"><a href="#2-2-äººè„¸è¯†åˆ«ä¼˜åŒ–ç­–ç•¥" class="headerlink" title="2.2 äººè„¸è¯†åˆ«ä¼˜åŒ–ç­–ç•¥"></a>2.2 äººè„¸è¯†åˆ«ä¼˜åŒ–ç­–ç•¥</h4><ul><li><strong>å¹³æ»‘å¤„ç†</strong>ï¼šä½¿ç”¨è¿ç»­æ£€æµ‹è®¡æ•°é¿å…æŠ–åŠ¨</li><li><strong>é˜ˆå€¼æ§åˆ¶</strong>ï¼šå¯é…ç½®çš„ç½®ä¿¡åº¦é˜ˆå€¼</li><li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šæ§åˆ¶æ£€æµ‹é¢‘ç‡ï¼Œé¿å…è¿‡åº¦æ¶ˆè€—èµ„æº</li></ul><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// äººè„¸æ£€æµ‹å¹³æ»‘å¤„ç†</span><span class="token keyword">private</span> consecutiveHasFace<span class="token punctuation">:</span> <span class="token keyword">number</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">private</span> consecutiveNoFace<span class="token punctuation">:</span> <span class="token keyword">number</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">private</span> hasFaceTotal<span class="token punctuation">:</span> <span class="token keyword">number</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token keyword">private</span> noFaceTotal<span class="token punctuation">:</span> <span class="token keyword">number</span> <span class="token operator">=</span> <span class="token number">15</span><span class="token comment" spellcheck="true">// åªæœ‰è¿ç»­æ£€æµ‹åˆ°ä¸€å®šæ¬¡æ•°æ‰è®¤ä¸ºæœ‰äººè„¸</span><span class="token keyword">if</span> <span class="token punctuation">(</span>has_face<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>consecutiveHasFace<span class="token operator">++</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>consecutiveNoFace <span class="token operator">=</span> <span class="token number">0</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>consecutiveHasFace <span class="token operator">>=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>hasFaceTotal<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>faceDetected <span class="token operator">=</span> <span class="token keyword">true</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>consecutiveNoFace<span class="token operator">++</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>consecutiveHasFace <span class="token operator">=</span> <span class="token number">0</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>consecutiveNoFace <span class="token operator">>=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>noFaceTotal<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>faceDetected <span class="token operator">=</span> <span class="token keyword">false</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h3 id="3-è¯­éŸ³å”¤é†’ç³»ç»Ÿ"><a href="#3-è¯­éŸ³å”¤é†’ç³»ç»Ÿ" class="headerlink" title="3. è¯­éŸ³å”¤é†’ç³»ç»Ÿ"></a>3. è¯­éŸ³å”¤é†’ç³»ç»Ÿ</h3><h4 id="3-1-ç¦»çº¿è¯­éŸ³å”¤é†’"><a href="#3-1-ç¦»çº¿è¯­éŸ³å”¤é†’" class="headerlink" title="3.1 ç¦»çº¿è¯­éŸ³å”¤é†’"></a>3.1 ç¦»çº¿è¯­éŸ³å”¤é†’</h4><p>é¡¹ç›®é›†æˆ<strong>è®¯é£ç¦»çº¿è¯­éŸ³å”¤é†’ SDK</strong>ï¼Œå®ç°æœ¬åœ°å”¤é†’è¯æ£€æµ‹ï¼š</p><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// src/modules/loop-worker.ts</span><span class="token keyword">import</span> <span class="token punctuation">{</span> wakeUpWorker <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./wakeUpWorker"</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// å¯åŠ¨å”¤é†’ç›‘å¬</span><span class="token keyword">const</span> startWakeUp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  wakeUpWorker<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">{</span>    onWakeUp<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"æ£€æµ‹åˆ°å”¤é†’è¯"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment" spellcheck="true">// å¯åŠ¨ASRè¯†åˆ«</span>      <span class="token function">startAsr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3-2-å”¤é†’æµç¨‹"><a href="#3-2-å”¤é†’æµç¨‹" class="headerlink" title="3.2 å”¤é†’æµç¨‹"></a>3.2 å”¤é†’æµç¨‹</h4><ol><li><strong>åˆå§‹åŒ–</strong>ï¼šåŠ è½½å”¤é†’æ¨¡å‹æ–‡ä»¶</li><li><strong>ç›‘å¬</strong>ï¼šæŒç»­ç›‘å¬éŸ³é¢‘è¾“å…¥</li><li><strong>æ£€æµ‹</strong>ï¼šè¯†åˆ«å”¤é†’è¯ï¼ˆå¦‚â€å°åŠ©æ‰‹â€ï¼‰</li><li><strong>è§¦å‘</strong>ï¼šå”¤é†’æˆåŠŸåè‡ªåŠ¨å¯åŠ¨ ASR</li></ol><hr><h3 id="4-æ•°å­—äººå¯¹è¯ç³»ç»Ÿ"><a href="#4-æ•°å­—äººå¯¹è¯ç³»ç»Ÿ" class="headerlink" title="4. æ•°å­—äººå¯¹è¯ç³»ç»Ÿ"></a>4. æ•°å­—äººå¯¹è¯ç³»ç»Ÿ</h3><h4 id="4-1-å¯¹è¯æµç¨‹"><a href="#4-1-å¯¹è¯æµç¨‹" class="headerlink" title="4.1 å¯¹è¯æµç¨‹"></a>4.1 å¯¹è¯æµç¨‹</h4><pre><code>ç”¨æˆ·è¯­éŸ³è¾“å…¥    â†“ASRè¯†åˆ«è½¬æ–‡å­—    â†“æ–‡æœ¬é¢„å¤„ç†ï¼ˆå…³é”®è¯è¿‡æ»¤ã€çº é”™ï¼‰    â†“å‘é€ç»™å¯¹è¯å¼•æ“    â†“æ•°å­—äººç†è§£å¹¶ç”Ÿæˆå›å¤    â†“TTSè¯­éŸ³åˆæˆ    â†“æ•°å­—äººåŠ¨ç”»é©±åŠ¨ï¼ˆå£å‹ã€è¡¨æƒ…ã€æ‰‹åŠ¿ï¼‰    â†“éŸ³é¢‘è¾“å‡º</code></pre><h4 id="4-2-å¯¹è¯ä¸Šä¸‹æ–‡ç®¡ç†"><a href="#4-2-å¯¹è¯ä¸Šä¸‹æ–‡ç®¡ç†" class="headerlink" title="4.2 å¯¹è¯ä¸Šä¸‹æ–‡ç®¡ç†"></a>4.2 å¯¹è¯ä¸Šä¸‹æ–‡ç®¡ç†</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// ä¿å­˜å¯¹è¯å†å²</span><span class="token keyword">interface</span> <span class="token class-name">ConversationInfo</span> <span class="token punctuation">{</span>  id<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">;</span>  question<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">;</span>  answer<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">;</span>  question_time<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">;</span>  answer_time<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">;</span>  type<span class="token punctuation">:</span> <span class="token string">"consult"</span> <span class="token operator">|</span> <span class="token string">"guide"</span> <span class="token operator">|</span> <span class="token string">"other"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// ç®¡ç†å¯¹è¯åˆ—è¡¨</span><span class="token keyword">const</span> conversations <span class="token operator">=</span> ref<span class="token operator">&lt;</span>ConversationInfo<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// æ·»åŠ æ–°å¯¹è¯</span><span class="token keyword">const</span> addConversation <span class="token operator">=</span> <span class="token punctuation">(</span>question<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">,</span> answer<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  conversations<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>    id<span class="token punctuation">:</span> <span class="token function">createId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    question<span class="token punctuation">,</span>    answer<span class="token punctuation">,</span>    question_time<span class="token punctuation">:</span> <span class="token function">getCurrentFormattedTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    answer_time<span class="token punctuation">:</span> <span class="token function">getCurrentFormattedTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    type<span class="token punctuation">:</span> <span class="token string">"consult"</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="4-3-å¤šè½®å¯¹è¯æ”¯æŒ"><a href="#4-3-å¤šè½®å¯¹è¯æ”¯æŒ" class="headerlink" title="4.3 å¤šè½®å¯¹è¯æ”¯æŒ"></a>4.3 å¤šè½®å¯¹è¯æ”¯æŒ</h4><ul><li><strong>ä¸Šä¸‹æ–‡è®°å¿†</strong>ï¼šä¿ç•™æœ€è¿‘ N è½®å¯¹è¯å†å²</li><li><strong>å®ä½“è¿½è¸ª</strong>ï¼šè¯†åˆ«å¯¹è¯ä¸­çš„å…³é”®å®ä½“</li><li><strong>æ„å›¾ç†è§£</strong>ï¼šå‡†ç¡®ç†è§£ç”¨æˆ·æ„å›¾</li></ul><hr><h3 id="5-å¤šåª’ä½“å¤„ç†"><a href="#5-å¤šåª’ä½“å¤„ç†" class="headerlink" title="5. å¤šåª’ä½“å¤„ç†"></a>5. å¤šåª’ä½“å¤„ç†</h3><h4 id="5-1-è§†é¢‘æµå¤„ç†"><a href="#5-1-è§†é¢‘æµå¤„ç†" class="headerlink" title="5.1 è§†é¢‘æµå¤„ç†"></a>5.1 è§†é¢‘æµå¤„ç†</h4><p>ä½¿ç”¨ Walle å¼•æ“å¤„ç†å®æ—¶è§†é¢‘æµï¼š</p><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// è®¢é˜…è§†é¢‘å¸§</span><span class="token keyword">this</span><span class="token punctuation">.</span>walleClient<span class="token punctuation">.</span><span class="token function">subject</span><span class="token punctuation">(</span><span class="token string">"videoframe"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span>frameInfo<span class="token punctuation">:</span> <span class="token keyword">any</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> <span class="token punctuation">{</span> frame<span class="token punctuation">,</span> img_w<span class="token punctuation">,</span> img_h <span class="token punctuation">}</span> <span class="token operator">=</span> frameInfo<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// ç»˜åˆ¶åˆ°Canvas</span>  canvasContext<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>frame<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> img_w<span class="token punctuation">,</span> img_h<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// å…³é—­VideoFrameé‡Šæ”¾å†…å­˜</span>  frame<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="5-2-éŸ³é¢‘æµå¤„ç†"><a href="#5-2-éŸ³é¢‘æµå¤„ç†" class="headerlink" title="5.2 éŸ³é¢‘æµå¤„ç†"></a>5.2 éŸ³é¢‘æµå¤„ç†</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// è®¢é˜…éŸ³é¢‘å¸§</span><span class="token keyword">this</span><span class="token punctuation">.</span>walleClient<span class="token punctuation">.</span><span class="token function">subject</span><span class="token punctuation">(</span><span class="token string">"audioframe"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span>audioData<span class="token punctuation">:</span> <span class="token keyword">any</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// å¤„ç†éŸ³é¢‘æ•°æ®</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>callbacks<span class="token punctuation">.</span>onAudioFrame<span class="token operator">?</span><span class="token punctuation">.</span><span class="token punctuation">(</span>audioData<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// å¯ç”¨äºå®æ—¶åˆ†ææˆ–ä¿å­˜</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="ğŸ”§-å…³é”®æŠ€æœ¯ç‚¹"><a href="#ğŸ”§-å…³é”®æŠ€æœ¯ç‚¹" class="headerlink" title="ğŸ”§ å…³é”®æŠ€æœ¯ç‚¹"></a>ğŸ”§ å…³é”®æŠ€æœ¯ç‚¹</h2><h3 id="1-WebCodecs-API-ä½¿ç”¨"><a href="#1-WebCodecs-API-ä½¿ç”¨" class="headerlink" title="1. WebCodecs API ä½¿ç”¨"></a>1. WebCodecs API ä½¿ç”¨</h3><p>é¡¹ç›®ä½¿ç”¨ WebCodecs API è¿›è¡Œé«˜æ•ˆè§†é¢‘è§£ç ï¼š</p><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// æ£€æŸ¥WebCodecsæ”¯æŒ</span><span class="token keyword">const</span> supportsWebCodecs <span class="token operator">=</span> <span class="token keyword">typeof</span> globalThis<span class="token punctuation">.</span>VideoDecoder <span class="token operator">!==</span> <span class="token string">"undefined"</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span>supportsWebCodecs<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// ä½¿ç”¨VideoDecoderè¿›è¡Œç¡¬ä»¶åŠ é€Ÿè§£ç </span>  <span class="token keyword">this</span><span class="token punctuation">.</span>walleClient<span class="token punctuation">.</span><span class="token function">renderTo</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>videoCanvas<span class="token punctuation">,</span> renderOptions<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">"å½“å‰ç¯å¢ƒä¸æ”¯æŒWebCodecsï¼Œå°†ä½¿ç”¨é™çº§æ–¹æ¡ˆ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-WebWorker-ä¼˜åŒ–"><a href="#2-WebWorker-ä¼˜åŒ–" class="headerlink" title="2. WebWorker ä¼˜åŒ–"></a>2. WebWorker ä¼˜åŒ–</h3><p>ä½¿ç”¨ Worker å¤„ç†è®¡ç®—å¯†é›†å‹ä»»åŠ¡ï¼Œé¿å…é˜»å¡ä¸»çº¿ç¨‹ï¼š</p><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// éŸ³é¢‘è§£ç Worker</span><span class="token keyword">import</span> AudioWorker <span class="token keyword">from</span> <span class="token string">"worker-loader!@xmov/walle/dist/workers/audio-decode.worker.js"</span><span class="token punctuation">;</span><span class="token keyword">const</span> audioWorker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AudioWorker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>audioWorker<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token punctuation">:</span> <span class="token string">"decode"</span><span class="token punctuation">,</span> data<span class="token punctuation">:</span> audioBuffer <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-çŠ¶æ€ç®¡ç†"><a href="#3-çŠ¶æ€ç®¡ç†" class="headerlink" title="3. çŠ¶æ€ç®¡ç†"></a>3. çŠ¶æ€ç®¡ç†</h3><p>ä½¿ç”¨ Vuex è¿›è¡Œå…¨å±€çŠ¶æ€ç®¡ç†ï¼š</p><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// src/views/store.ts</span>@<span class="token function">Module</span><span class="token punctuation">(</span><span class="token punctuation">{</span> namespaced<span class="token punctuation">:</span> <span class="token keyword">true</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">"app"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">AppModule</span> <span class="token keyword">extends</span> <span class="token class-name">VuexModule</span> <span class="token punctuation">{</span>  conversionId <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>  scanChatId <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>  currentWeChatQuestion<span class="token punctuation">:</span> <span class="token keyword">any</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  @Mutation  <span class="token function">setConversionId</span><span class="token punctuation">(</span>id<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>conversionId <span class="token operator">=</span> id<span class="token punctuation">;</span>  <span class="token punctuation">}</span>  @Mutation  <span class="token function">setCurrentWeChatQuestion</span><span class="token punctuation">(</span>question<span class="token punctuation">:</span> <span class="token keyword">any</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>currentWeChatQuestion <span class="token operator">=</span> question<span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-é”™è¯¯å¤„ç†ä¸é‡è¯•æœºåˆ¶"><a href="#4-é”™è¯¯å¤„ç†ä¸é‡è¯•æœºåˆ¶" class="headerlink" title="4. é”™è¯¯å¤„ç†ä¸é‡è¯•æœºåˆ¶"></a>4. é”™è¯¯å¤„ç†ä¸é‡è¯•æœºåˆ¶</h3><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// é‡è¯•æœºåˆ¶</span><span class="token keyword">const</span> withRetry <span class="token operator">=</span> async <span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">(</span>  operation<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> Promise<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">,</span>  maxRetries<span class="token punctuation">:</span> <span class="token keyword">number</span> <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span> Promise<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> attempt <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> attempt <span class="token operator">&lt;=</span> maxRetries<span class="token punctuation">;</span> attempt<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>      <span class="token keyword">return</span> await <span class="token function">operation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>attempt <span class="token operator">===</span> maxRetries<span class="token punctuation">)</span> <span class="token keyword">throw</span> error<span class="token punctuation">;</span>      await <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">"é‡è¯•å¤±è´¥"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="ğŸ“Š-æ€§èƒ½ä¼˜åŒ–"><a href="#ğŸ“Š-æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="ğŸ“Š æ€§èƒ½ä¼˜åŒ–"></a>ğŸ“Š æ€§èƒ½ä¼˜åŒ–</h2><h3 id="1-å†…å­˜ç®¡ç†"><a href="#1-å†…å­˜ç®¡ç†" class="headerlink" title="1. å†…å­˜ç®¡ç†"></a>1. å†…å­˜ç®¡ç†</h3><ul><li><strong>åŠæ—¶é‡Šæ”¾ VideoFrame</strong>ï¼šä½¿ç”¨ <code>frame.close()</code> é‡Šæ”¾å†…å­˜</li><li><strong>é™åˆ¶å¹¶å‘è¿æ¥</strong>ï¼šåŒä¸€æ—¶é—´åªå…è®¸ä¸€ä¸ª ASR è¿æ¥</li><li><strong>æ¸…ç†å®šæ—¶å™¨</strong>ï¼šç»„ä»¶é”€æ¯æ—¶æ¸…ç†æ‰€æœ‰å®šæ—¶å™¨</li></ul><h3 id="2-ç½‘ç»œä¼˜åŒ–"><a href="#2-ç½‘ç»œä¼˜åŒ–" class="headerlink" title="2. ç½‘ç»œä¼˜åŒ–"></a>2. ç½‘ç»œä¼˜åŒ–</h3><ul><li><strong>WebSocket è¿æ¥æ± </strong>ï¼šå¤ç”¨ WebSocket è¿æ¥</li><li><strong>æ•°æ®å‹ç¼©</strong>ï¼šå¯¹ä¼ è¾“çš„æ•°æ®è¿›è¡Œå‹ç¼©</li><li><strong>æ–­çº¿é‡è¿</strong>ï¼šè‡ªåŠ¨é‡è¿æœºåˆ¶</li></ul><h3 id="3-æ¸²æŸ“ä¼˜åŒ–"><a href="#3-æ¸²æŸ“ä¼˜åŒ–" class="headerlink" title="3. æ¸²æŸ“ä¼˜åŒ–"></a>3. æ¸²æŸ“ä¼˜åŒ–</h3><ul><li><strong>Canvas ç¼“å­˜</strong>ï¼šå¤ç”¨ Canvas å…ƒç´ </li><li><strong>å¸§ç‡æ§åˆ¶</strong>ï¼šé™åˆ¶æœ€å¤§å¸§ç‡ï¼Œé¿å…è¿‡åº¦æ¸²æŸ“</li><li><strong>æŒ‰éœ€æ¸²æŸ“</strong>ï¼šåªåœ¨å¯è§æ—¶æ‰è¿›è¡Œæ¸²æŸ“</li></ul><hr><h2 id="ğŸ§ª-æµ‹è¯•ç­–ç•¥"><a href="#ğŸ§ª-æµ‹è¯•ç­–ç•¥" class="headerlink" title="ğŸ§ª æµ‹è¯•ç­–ç•¥"></a>ğŸ§ª æµ‹è¯•ç­–ç•¥</h2><h3 id="1-å•å…ƒæµ‹è¯•"><a href="#1-å•å…ƒæµ‹è¯•" class="headerlink" title="1. å•å…ƒæµ‹è¯•"></a>1. å•å…ƒæµ‹è¯•</h3><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// æµ‹è¯•ASRæä¾›è€…åˆ‡æ¢</span><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">"usePluggableAsr"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">"åº”è¯¥èƒ½å¤Ÿåˆ‡æ¢æä¾›è€…"</span><span class="token punctuation">,</span> async <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> switchProvider <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">usePluggableAsr</span><span class="token punctuation">(</span>voiceStart<span class="token punctuation">)</span><span class="token punctuation">;</span>    await <span class="token function">switchProvider</span><span class="token punctuation">(</span>ProviderType<span class="token punctuation">.</span>WALLE<span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">expect</span><span class="token punctuation">(</span>currentProvider<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeDefined</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-é›†æˆæµ‹è¯•"><a href="#2-é›†æˆæµ‹è¯•" class="headerlink" title="2. é›†æˆæµ‹è¯•"></a>2. é›†æˆæµ‹è¯•</h3><ul><li>æµ‹è¯•å®Œæ•´å¯¹è¯æµç¨‹</li><li>æµ‹è¯•äººè„¸è¯†åˆ«å‡†ç¡®æ€§</li><li>æµ‹è¯•å¤šè½®å¯¹è¯ä¸Šä¸‹æ–‡</li></ul><h3 id="3-æ€§èƒ½æµ‹è¯•"><a href="#3-æ€§èƒ½æµ‹è¯•" class="headerlink" title="3. æ€§èƒ½æµ‹è¯•"></a>3. æ€§èƒ½æµ‹è¯•</h3><ul><li>ASR è¯†åˆ«å»¶è¿Ÿæµ‹è¯•</li><li>å†…å­˜æ³„æ¼æ£€æµ‹</li><li>CPU ä½¿ç”¨ç‡ç›‘æ§</li></ul><hr><h2 id="ğŸš€-éƒ¨ç½²ä¸è¿ç»´"><a href="#ğŸš€-éƒ¨ç½²ä¸è¿ç»´" class="headerlink" title="ğŸš€ éƒ¨ç½²ä¸è¿ç»´"></a>ğŸš€ éƒ¨ç½²ä¸è¿ç»´</h2><h3 id="1-ç¯å¢ƒé…ç½®"><a href="#1-ç¯å¢ƒé…ç½®" class="headerlink" title="1. ç¯å¢ƒé…ç½®"></a>1. ç¯å¢ƒé…ç½®</h3><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// ä¸åŒç¯å¢ƒçš„é…ç½®</span><span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>  development<span class="token punctuation">:</span> <span class="token punctuation">{</span>    serverUrl<span class="token punctuation">:</span> <span class="token string">"ws://localhost:39999"</span><span class="token punctuation">,</span>    debug<span class="token punctuation">:</span> <span class="token keyword">true</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  production<span class="token punctuation">:</span> <span class="token punctuation">{</span>    serverUrl<span class="token punctuation">:</span> <span class="token string">"ws://prod-server:39999"</span><span class="token punctuation">,</span>    debug<span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-æ—¥å¿—ç³»ç»Ÿ"><a href="#2-æ—¥å¿—ç³»ç»Ÿ" class="headerlink" title="2. æ—¥å¿—ç³»ç»Ÿ"></a>2. æ—¥å¿—ç³»ç»Ÿ</h3><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> ElectronLogger <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@xmov/electron-extension"</span><span class="token punctuation">;</span>ElectronLogger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"ASRè¯†åˆ«ç»“æœ:"</span><span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">;</span>ElectronLogger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"è¿æ¥å¤±è´¥:"</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>ElectronLogger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"æœåŠ¡å¯åŠ¨æˆåŠŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-ç›‘æ§æŒ‡æ ‡"><a href="#3-ç›‘æ§æŒ‡æ ‡" class="headerlink" title="3. ç›‘æ§æŒ‡æ ‡"></a>3. ç›‘æ§æŒ‡æ ‡</h3><ul><li>ASR è¯†åˆ«å‡†ç¡®ç‡</li><li>å“åº”å»¶è¿Ÿæ—¶é—´</li><li>é”™è¯¯ç‡ç»Ÿè®¡</li><li>ç”¨æˆ·äº¤äº’æ—¶é•¿</li></ul><hr><h2 id="ğŸ“š-æœ€ä½³å®è·µ"><a href="#ğŸ“š-æœ€ä½³å®è·µ" class="headerlink" title="ğŸ“š æœ€ä½³å®è·µ"></a>ğŸ“š æœ€ä½³å®è·µ</h2><h3 id="1-ä»£ç ç»„ç»‡"><a href="#1-ä»£ç ç»„ç»‡" class="headerlink" title="1. ä»£ç ç»„ç»‡"></a>1. ä»£ç ç»„ç»‡</h3><ul><li>ä½¿ç”¨ Composition API ç»„ç»‡é€»è¾‘</li><li>æŠ½ç¦»å¯å¤ç”¨çš„ Hooks</li><li>ç»Ÿä¸€é”™è¯¯å¤„ç†</li></ul><h3 id="2-ç±»å‹å®‰å…¨"><a href="#2-ç±»å‹å®‰å…¨" class="headerlink" title="2. ç±»å‹å®‰å…¨"></a>2. ç±»å‹å®‰å…¨</h3><ul><li>å®Œå–„çš„ TypeScript ç±»å‹å®šä¹‰</li><li>é¿å…ä½¿ç”¨ <code>any</code> ç±»å‹</li><li>ä½¿ç”¨ç±»å‹å®ˆå«</li></ul><h3 id="3-æ€§èƒ½è€ƒè™‘"><a href="#3-æ€§èƒ½è€ƒè™‘" class="headerlink" title="3. æ€§èƒ½è€ƒè™‘"></a>3. æ€§èƒ½è€ƒè™‘</h3><ul><li>é¿å…ä¸å¿…è¦çš„å“åº”å¼æ•°æ®</li><li>ä½¿ç”¨ <code>shallowRef</code> ä¼˜åŒ–å¤§å¯¹è±¡</li><li>åˆç†ä½¿ç”¨é˜²æŠ–å’ŒèŠ‚æµ</li></ul><hr><h2 id="ğŸ”—-ç›¸å…³èµ„æº"><a href="#ğŸ”—-ç›¸å…³èµ„æº" class="headerlink" title="ğŸ”— ç›¸å…³èµ„æº"></a>ğŸ”— ç›¸å…³èµ„æº</h2><ul><li><a href="https://v3.cn.vuejs.org/">Vue 3 å®˜æ–¹æ–‡æ¡£</a></li><li><a href="https://www.electronjs.org/">Electron å®˜æ–¹æ–‡æ¡£</a></li><li><a href="https://www.typescriptlang.org/">TypeScript å®˜æ–¹æ–‡æ¡£</a></li><li><a href="https://www.w3.org/TR/webcodecs/">WebCodecs API</a></li></ul><hr><h2 id="ğŸ“-æ€»ç»“"><a href="#ğŸ“-æ€»ç»“" class="headerlink" title="ğŸ“ æ€»ç»“"></a>ğŸ“ æ€»ç»“</h2><p>æœ¬é¡¹ç›®æˆåŠŸå®ç°äº†ï¼š</p><ul><li>âœ… <strong>å¯æ’æ‹” ASR æ¶æ„</strong>ï¼šçµæ´»çš„å¼•æ“åˆ‡æ¢èƒ½åŠ›</li><li>âœ… <strong>å®æ—¶äººè„¸è¯†åˆ«</strong>ï¼šå‡†ç¡®çš„äººè„¸æ£€æµ‹å’Œè·Ÿè¸ª</li><li>âœ… <strong>è‡ªç„¶å¯¹è¯äº¤äº’</strong>ï¼šæµç•…çš„å¤šè½®å¯¹è¯ä½“éªŒ</li><li>âœ… <strong>é«˜æ€§èƒ½æ¸²æŸ“</strong>ï¼šä¼˜åŒ–çš„è§†é¢‘å’ŒéŸ³é¢‘å¤„ç†</li><li>âœ… <strong>å®Œå–„çš„é”™è¯¯å¤„ç†</strong>ï¼šå¥å£®çš„é”™è¯¯æ¢å¤æœºåˆ¶</li></ul><p>é€šè¿‡æœ¬é¡¹ç›®çš„å®è·µï¼Œå±•ç¤ºäº†å¦‚ä½•å°†å¤šç§ AI æŠ€æœ¯æœ‰æœºèåˆï¼Œæ„å»ºä¸€ä¸ªå®Œæ•´çš„æ™ºèƒ½äº¤äº’ç³»ç»Ÿã€‚</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> AIå®æˆ˜é¡¹ç›® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
            <tag> Vue3 </tag>
            
            <tag> Electron </tag>
            
            <tag> TypeScript </tag>
            
            <tag> è¯­éŸ³è¯†åˆ« </tag>
            
            <tag> äººè„¸è¯†åˆ« </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ElectronæŠ€æœ¯å®è·µæ–‡æ¡£</title>
      <link href="/2024/12/20/electron-ji-zhu-shi-jian-wen-dang/"/>
      <url>/2024/12/20/electron-ji-zhu-shi-jian-wen-dang/</url>
      
        <content type="html"><![CDATA[<h1 id="Electron-æŠ€æœ¯å®è·µæ–‡æ¡£"><a href="#Electron-æŠ€æœ¯å®è·µæ–‡æ¡£" class="headerlink" title="Electron æŠ€æœ¯å®è·µæ–‡æ¡£"></a>Electron æŠ€æœ¯å®è·µæ–‡æ¡£</h1><h2 id="ğŸ“–-æ–‡æ¡£æ¦‚è¿°"><a href="#ğŸ“–-æ–‡æ¡£æ¦‚è¿°" class="headerlink" title="ğŸ“– æ–‡æ¡£æ¦‚è¿°"></a>ğŸ“– æ–‡æ¡£æ¦‚è¿°</h2><p>æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç»äº†åœ¨<strong>AI è™šæ‹Ÿäººæ™ºæ…§å¤§å±</strong>é¡¹ç›®ä¸­ Electron æŠ€æœ¯çš„å®è·µåº”ç”¨ï¼ŒåŒ…æ‹¬ä¸»è¿›ç¨‹æ¶æ„ã€æ¸²æŸ“è¿›ç¨‹é€šä¿¡ã€çª—å£ç®¡ç†ã€æ–‡ä»¶ç³»ç»Ÿæ“ä½œã€æœ¬åœ°æœåŠ¡é›†æˆç­‰æ ¸å¿ƒåŠŸèƒ½çš„å®ç°ã€‚</p><hr><h2 id="ğŸ—ï¸-é¡¹ç›®æ¶æ„"><a href="#ğŸ—ï¸-é¡¹ç›®æ¶æ„" class="headerlink" title="ğŸ—ï¸ é¡¹ç›®æ¶æ„"></a>ğŸ—ï¸ é¡¹ç›®æ¶æ„</h2><h3 id="æŠ€æœ¯æ ˆ"><a href="#æŠ€æœ¯æ ˆ" class="headerlink" title="æŠ€æœ¯æ ˆ"></a>æŠ€æœ¯æ ˆ</h3><pre><code>Electronç‰ˆæœ¬ï¼š23.3.13Vue CLI Pluginï¼švue-cli-plugin-electron-builder ~2.1.1æ„å»ºå·¥å…·ï¼šelectron-builderNodeç‰ˆæœ¬ï¼š16.x</code></pre><h3 id="é¡¹ç›®ç»“æ„"><a href="#é¡¹ç›®ç»“æ„" class="headerlink" title="é¡¹ç›®ç»“æ„"></a>é¡¹ç›®ç»“æ„</h3><pre><code>smart-ai/â”œâ”€â”€ src/â”‚   â”œâ”€â”€ background.ts          # Electronä¸»è¿›ç¨‹å…¥å£â”‚   â”œâ”€â”€ main.ts                # æ¸²æŸ“è¿›ç¨‹å…¥å£â”‚   â”œâ”€â”€ service.ts             # æœ¬åœ°æœåŠ¡ç®¡ç†â”‚   â””â”€â”€ modules/â”‚       â””â”€â”€ rendererIpc.ts     # IPCé€šä¿¡å°è£…â”œâ”€â”€ public/â”‚   â””â”€â”€ preload.js             # é¢„åŠ è½½è„šæœ¬â””â”€â”€ vue.config.js              # Electron Builderé…ç½®</code></pre><hr><h2 id="ğŸ¯-æ ¸å¿ƒåŠŸèƒ½å®ç°"><a href="#ğŸ¯-æ ¸å¿ƒåŠŸèƒ½å®ç°" class="headerlink" title="ğŸ¯ æ ¸å¿ƒåŠŸèƒ½å®ç°"></a>ğŸ¯ æ ¸å¿ƒåŠŸèƒ½å®ç°</h2><h3 id="1-ä¸»è¿›ç¨‹æ¶æ„è®¾è®¡"><a href="#1-ä¸»è¿›ç¨‹æ¶æ„è®¾è®¡" class="headerlink" title="1. ä¸»è¿›ç¨‹æ¶æ„è®¾è®¡"></a>1. ä¸»è¿›ç¨‹æ¶æ„è®¾è®¡</h3><h4 id="1-1-å…¥å£æ–‡ä»¶ç»“æ„"><a href="#1-1-å…¥å£æ–‡ä»¶ç»“æ„" class="headerlink" title="1.1 å…¥å£æ–‡ä»¶ç»“æ„"></a>1.1 å…¥å£æ–‡ä»¶ç»“æ„</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// src/background.ts</span><span class="token keyword">import</span> <span class="token punctuation">{</span> app<span class="token punctuation">,</span> BrowserWindow<span class="token punctuation">,</span> ipcMain <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"electron"</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span> createProtocol <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"vue-cli-plugin-electron-builder/lib"</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span> runServer<span class="token punctuation">,</span> closeServer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./service"</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// çª—å£å®ä¾‹</span><span class="token keyword">let</span> win<span class="token punctuation">:</span> Electron<span class="token punctuation">.</span>BrowserWindow <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token keyword">let</span> workerWin<span class="token punctuation">:</span> Electron<span class="token punctuation">.</span>BrowserWindow <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token keyword">let</span> loadingWin<span class="token punctuation">:</span> Electron<span class="token punctuation">.</span>BrowserWindow <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// åº”ç”¨ç”Ÿå‘½å‘¨æœŸç®¡ç†</span>app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"ready"</span><span class="token punctuation">,</span> async <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  await <span class="token function">runServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// å¯åŠ¨æœ¬åœ°æœåŠ¡</span>  <span class="token function">createWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// åˆ›å»ºä¸»çª—å£</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"will-quit"</span><span class="token punctuation">,</span> async <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  await <span class="token function">closeServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// å…³é—­æœ¬åœ°æœåŠ¡</span>  app<span class="token punctuation">.</span><span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="1-2-å•ä¾‹åº”ç”¨æ§åˆ¶"><a href="#1-2-å•ä¾‹åº”ç”¨æ§åˆ¶" class="headerlink" title="1.2 å•ä¾‹åº”ç”¨æ§åˆ¶"></a>1.2 å•ä¾‹åº”ç”¨æ§åˆ¶</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// ç¡®ä¿åº”ç”¨åªæœ‰ä¸€ä¸ªå®ä¾‹è¿è¡Œ</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>app<span class="token punctuation">.</span><span class="token function">requestSingleInstanceLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  app<span class="token punctuation">.</span><span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  process<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// å¤„ç†ç¬¬äºŒä¸ªå®ä¾‹çš„å¯åŠ¨</span>app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"second-instance"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>win<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>win<span class="token punctuation">.</span><span class="token function">isMinimized</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> win<span class="token punctuation">.</span><span class="token function">restore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    win<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="1-3-åè®®æ³¨å†Œ"><a href="#1-3-åè®®æ³¨å†Œ" class="headerlink" title="1.3 åè®®æ³¨å†Œ"></a>1.3 åè®®æ³¨å†Œ</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// æ³¨å†Œè‡ªå®šä¹‰åè®®</span>protocol<span class="token punctuation">.</span><span class="token function">registerSchemesAsPrivileged</span><span class="token punctuation">(</span><span class="token punctuation">[</span>  <span class="token punctuation">{</span>    scheme<span class="token punctuation">:</span> <span class="token string">"app"</span><span class="token punctuation">,</span>    privileges<span class="token punctuation">:</span> <span class="token punctuation">{</span>      secure<span class="token punctuation">:</span> <span class="token keyword">true</span><span class="token punctuation">,</span>      standard<span class="token punctuation">:</span> <span class="token keyword">true</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// æ–‡ä»¶åè®®å¤„ç†</span>protocol<span class="token punctuation">.</span><span class="token function">registerFileProtocol</span><span class="token punctuation">(</span><span class="token string">"xmov"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>request<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> url <span class="token operator">=</span> request<span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// ç§»é™¤ 'xmov://' å‰ç¼€</span>  <span class="token function">callback</span><span class="token punctuation">(</span><span class="token function">decodeURI</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">normalize</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h3 id="2-çª—å£ç®¡ç†"><a href="#2-çª—å£ç®¡ç†" class="headerlink" title="2. çª—å£ç®¡ç†"></a>2. çª—å£ç®¡ç†</h3><h4 id="2-1-ä¸»çª—å£åˆ›å»º"><a href="#2-1-ä¸»çª—å£åˆ›å»º" class="headerlink" title="2.1 ä¸»çª—å£åˆ›å»º"></a>2.1 ä¸»çª—å£åˆ›å»º</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token keyword">function</span> <span class="token function">createWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  win <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>    width<span class="token punctuation">:</span> <span class="token number">540</span><span class="token punctuation">,</span>    height<span class="token punctuation">:</span> <span class="token number">990</span><span class="token punctuation">,</span>    backgroundColor<span class="token punctuation">:</span> <span class="token string">"#f4f4ff"</span><span class="token punctuation">,</span>    show<span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// åˆå§‹ä¸æ˜¾ç¤º</span>    frame<span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// æ— è¾¹æ¡†çª—å£</span>    webPreferences<span class="token punctuation">:</span> <span class="token punctuation">{</span>      nodeIntegration<span class="token punctuation">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>ELECTRON_NODE_INTEGRATION as <span class="token keyword">boolean</span><span class="token punctuation">,</span>      contextIsolation<span class="token punctuation">:</span> <span class="token operator">!</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>ELECTRON_NODE_INTEGRATION<span class="token punctuation">,</span>      preload<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__static<span class="token punctuation">,</span> <span class="token string">"preload.js"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>      webSecurity<span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// å…è®¸è·¨åŸŸï¼ˆå¼€å‘ç¯å¢ƒï¼‰</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// è®¾ç½®çª—å£å®½é«˜æ¯”</span>  win<span class="token punctuation">.</span><span class="token function">setAspectRatio</span><span class="token punctuation">(</span><span class="token number">6</span> <span class="token operator">/</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// åŠ è½½å†…å®¹</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>WEBPACK_DEV_SERVER_URL<span class="token punctuation">)</span> <span class="token punctuation">{</span>    win<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>WEBPACK_DEV_SERVER_URL<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>    <span class="token function">createProtocol</span><span class="token punctuation">(</span><span class="token string">"app"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    win<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span><span class="token string">"app://./index.html"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token comment" spellcheck="true">// çª—å£å‡†å¤‡æ˜¾ç¤ºæ—¶</span>  win<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"ready-to-show"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token function">closeLoadingWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    win<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-2-å¤šçª—å£ç®¡ç†"><a href="#2-2-å¤šçª—å£ç®¡ç†" class="headerlink" title="2.2 å¤šçª—å£ç®¡ç†"></a>2.2 å¤šçª—å£ç®¡ç†</h4><p><strong>Worker çª—å£ï¼ˆåå°å¤„ç†ï¼‰ï¼š</strong></p><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token keyword">function</span> <span class="token function">createWorkerWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  workerWin <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>    modal<span class="token punctuation">:</span> <span class="token keyword">true</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// æ¨¡æ€çª—å£</span>    width<span class="token punctuation">:</span> <span class="token number">300</span><span class="token punctuation">,</span>    height<span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">,</span>    show<span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">,</span>    webPreferences<span class="token punctuation">:</span> <span class="token punctuation">{</span>      nodeIntegration<span class="token punctuation">:</span> <span class="token keyword">true</span><span class="token punctuation">,</span>      contextIsolation<span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">,</span>      preload<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__static<span class="token punctuation">,</span> <span class="token string">"preload.js"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// åŠ è½½workeré¡µé¢</span>  workerWin<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>WEBPACK_DEV_SERVER_URL <span class="token operator">+</span> <span class="token string">"#worker"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>Loading çª—å£ï¼ˆå¯åŠ¨ç”»é¢ï¼‰ï¼š</strong></p><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token keyword">function</span> <span class="token function">createLoadingWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>win<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>  loadingWin <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>    parent<span class="token punctuation">:</span> win<span class="token punctuation">,</span>    modal<span class="token punctuation">:</span> <span class="token keyword">true</span><span class="token punctuation">,</span>    width<span class="token punctuation">:</span> <span class="token number">540</span><span class="token punctuation">,</span>    height<span class="token punctuation">:</span> <span class="token number">990</span><span class="token punctuation">,</span>    resizable<span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">,</span>    frame<span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  loadingWin<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__static<span class="token punctuation">,</span> <span class="token string">"./html/loading.html"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-3-çª—å£æ§åˆ¶-IPC"><a href="#2-3-çª—å£æ§åˆ¶-IPC" class="headerlink" title="2.3 çª—å£æ§åˆ¶ IPC"></a>2.3 çª—å£æ§åˆ¶ IPC</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// å…³é—­çª—å£</span>ipcMain<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"window_close"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>win<span class="token punctuation">)</span> win<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// æœ€å°åŒ–çª—å£</span>ipcMain<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"window_mini"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>win<span class="token punctuation">)</span> win<span class="token punctuation">.</span><span class="token function">minimize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// å…¨å±</span>ipcMain<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"window_full"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>win<span class="token punctuation">)</span> win<span class="token punctuation">.</span><span class="token function">setFullScreen</span><span class="token punctuation">(</span><span class="token keyword">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// é€€å‡ºå…¨å±</span>ipcMain<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"window_normal"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>win<span class="token punctuation">)</span> <span class="token punctuation">{</span>    win<span class="token punctuation">.</span><span class="token function">setFullScreen</span><span class="token punctuation">(</span><span class="token keyword">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    win<span class="token punctuation">.</span><span class="token function">center</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h3 id="3-IPC-é€šä¿¡æœºåˆ¶"><a href="#3-IPC-é€šä¿¡æœºåˆ¶" class="headerlink" title="3. IPC é€šä¿¡æœºåˆ¶"></a>3. IPC é€šä¿¡æœºåˆ¶</h3><h4 id="3-1-é¢„åŠ è½½è„šæœ¬"><a href="#3-1-é¢„åŠ è½½è„šæœ¬" class="headerlink" title="3.1 é¢„åŠ è½½è„šæœ¬"></a>3.1 é¢„åŠ è½½è„šæœ¬</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// public/preload.js</span><span class="token keyword">const</span> <span class="token punctuation">{</span> contextBridge<span class="token punctuation">,</span> ipcRenderer <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"electron"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// æš´éœ²å®‰å…¨çš„APIåˆ°æ¸²æŸ“è¿›ç¨‹</span>contextBridge<span class="token punctuation">.</span><span class="token function">exposeInMainWorld</span><span class="token punctuation">(</span><span class="token string">"ipc"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// å‘é€æ¶ˆæ¯ï¼ˆä¸ç­‰å¾…å“åº”ï¼‰</span>  send<span class="token punctuation">:</span> <span class="token punctuation">(</span>channel<span class="token punctuation">,</span> data<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    ipcRenderer<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>channel<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true">// å‘é€æ¶ˆæ¯å¹¶ç­‰å¾…å“åº”</span>  invoke<span class="token punctuation">:</span> <span class="token punctuation">(</span>channel<span class="token punctuation">,</span> data<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> ipcRenderer<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>channel<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true">// ç›‘å¬æ¶ˆæ¯</span>  on<span class="token punctuation">:</span> <span class="token punctuation">(</span>channel<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    ipcRenderer<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span>channel<span class="token punctuation">,</span> <span class="token punctuation">(</span>event<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>      <span class="token function">callback</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true">// ç§»é™¤ç›‘å¬</span>  removeAllListeners<span class="token punctuation">:</span> <span class="token punctuation">(</span>channel<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    ipcRenderer<span class="token punctuation">.</span><span class="token function">removeAllListeners</span><span class="token punctuation">(</span>channel<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// æš´éœ²æ–‡ä»¶è·¯å¾„</span>contextBridge<span class="token punctuation">.</span><span class="token function">exposeInMainWorld</span><span class="token punctuation">(</span><span class="token string">"exePath"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3-2-æ¸²æŸ“è¿›ç¨‹é€šä¿¡å°è£…"><a href="#3-2-æ¸²æŸ“è¿›ç¨‹é€šä¿¡å°è£…" class="headerlink" title="3.2 æ¸²æŸ“è¿›ç¨‹é€šä¿¡å°è£…"></a>3.2 æ¸²æŸ“è¿›ç¨‹é€šä¿¡å°è£…</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// src/modules/rendererIpc.ts</span><span class="token keyword">declare</span> global <span class="token punctuation">{</span>  <span class="token keyword">interface</span> <span class="token class-name">Window</span> <span class="token punctuation">{</span>    ipc<span class="token punctuation">:</span> <span class="token punctuation">{</span>      send<span class="token punctuation">:</span> <span class="token punctuation">(</span>channel<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">,</span> data<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token keyword">any</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">void</span><span class="token punctuation">;</span>      invoke<span class="token punctuation">:</span> <span class="token punctuation">(</span>channel<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">,</span> data<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token keyword">any</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> Promise<span class="token operator">&lt;</span><span class="token keyword">any</span><span class="token operator">></span><span class="token punctuation">;</span>      on<span class="token punctuation">:</span> <span class="token punctuation">(</span>channel<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">,</span> callback<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">:</span> <span class="token keyword">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">void</span><span class="token punctuation">;</span>      removeAllListeners<span class="token punctuation">:</span> <span class="token punctuation">(</span>channel<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">void</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    exePath<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// å°è£…IPCè°ƒç”¨</span><span class="token keyword">export</span> <span class="token keyword">const</span> rendererIpc <span class="token operator">=</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// å…³é—­çª—å£</span>  closeWindow<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    window<span class="token punctuation">.</span>ipc<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"window_close"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true">// è·å–ä¸‹è½½æ–‡ä»¶</span>  getDownloadFiles<span class="token punctuation">:</span> <span class="token punctuation">(</span>urls<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span> Promise<span class="token operator">&lt;</span>Record<span class="token operator">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token operator">></span><span class="token operator">></span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> window<span class="token punctuation">.</span>ipc<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token string">"window_get_download"</span><span class="token punctuation">,</span> urls<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true">// æ£€æŸ¥ä¸‹è½½æ–‡ä»¶</span>  checkDownloadFiles<span class="token punctuation">:</span> <span class="token punctuation">(</span>urls<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span> Promise<span class="token operator">&lt;</span><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> window<span class="token punctuation">.</span>ipc<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token string">"window_check_download"</span><span class="token punctuation">,</span> urls<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3-3-åŒå‘é€šä¿¡ç¤ºä¾‹"><a href="#3-3-åŒå‘é€šä¿¡ç¤ºä¾‹" class="headerlink" title="3.3 åŒå‘é€šä¿¡ç¤ºä¾‹"></a>3.3 åŒå‘é€šä¿¡ç¤ºä¾‹</h4><p><strong>ä¸»è¿›ç¨‹ â†’ æ¸²æŸ“è¿›ç¨‹ï¼š</strong></p><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// ä¸»è¿›ç¨‹å‘é€</span>win<span class="token punctuation">.</span>webContents<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"get-exe-path"</span><span class="token punctuation">,</span> app<span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token string">"exe"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// æ¸²æŸ“è¿›ç¨‹æ¥æ”¶</span>window<span class="token punctuation">.</span>ipc<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"get-exe-path"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>path<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  window<span class="token punctuation">.</span>exePath <span class="token operator">=</span> path<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>æ¸²æŸ“è¿›ç¨‹ â†’ ä¸»è¿›ç¨‹ï¼š</strong></p><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// æ¸²æŸ“è¿›ç¨‹å‘é€</span>window<span class="token punctuation">.</span>ipc<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span><span class="token string">"get_xmov_config"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// ä¸»è¿›ç¨‹å¤„ç†</span>ipcMain<span class="token punctuation">.</span><span class="token function">handle</span><span class="token punctuation">(</span><span class="token string">"get_xmov_config"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> electronConfig <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ElectronConfig</span><span class="token punctuation">(</span><span class="token string">"./modelPath/model.gbl"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> electronConfig<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h3 id="4-æ–‡ä»¶ç³»ç»Ÿæ“ä½œ"><a href="#4-æ–‡ä»¶ç³»ç»Ÿæ“ä½œ" class="headerlink" title="4. æ–‡ä»¶ç³»ç»Ÿæ“ä½œ"></a>4. æ–‡ä»¶ç³»ç»Ÿæ“ä½œ</h3><h4 id="4-1-æ–‡ä»¶ä¸‹è½½ç®¡ç†"><a href="#4-1-æ–‡ä»¶ä¸‹è½½ç®¡ç†" class="headerlink" title="4.1 æ–‡ä»¶ä¸‹è½½ç®¡ç†"></a>4.1 æ–‡ä»¶ä¸‹è½½ç®¡ç†</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// ä½¿ç”¨electron-extensionå°è£…çš„ä¸‹è½½åŠŸèƒ½</span><span class="token keyword">import</span> <span class="token punctuation">{</span> ElectronDownload <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@xmov/electron-extension"</span><span class="token punctuation">;</span><span class="token keyword">let</span> electronDownload<span class="token punctuation">:</span> ElectronDownload <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// åˆå§‹åŒ–ä¸‹è½½å™¨</span>electronDownload <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ElectronDownload</span><span class="token punctuation">(</span>win<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// ä¸‹è½½æ–‡ä»¶</span>ipcMain<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"window_download_start"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>e<span class="token punctuation">,</span> url<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>win <span class="token operator">||</span> <span class="token operator">!</span>electronDownload<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>  electronDownload<span class="token punctuation">.</span><span class="token function">download</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> downloadPath<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">finally</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    win<span class="token operator">?</span><span class="token punctuation">.</span>webContents<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"window_download_end"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// ä¸‹è½½è¿›åº¦å›è°ƒ</span>  electronDownload<span class="token punctuation">.</span>onProgress <span class="token operator">=</span> <span class="token punctuation">(</span>item<span class="token punctuation">:</span> <span class="token keyword">any</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    win<span class="token operator">?</span><span class="token punctuation">.</span>webContents<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">"window_download_progress"</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>progress<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="4-2-æ–‡ä»¶è·¯å¾„ç®¡ç†"><a href="#4-2-æ–‡ä»¶è·¯å¾„ç®¡ç†" class="headerlink" title="4.2 æ–‡ä»¶è·¯å¾„ç®¡ç†"></a>4.2 æ–‡ä»¶è·¯å¾„ç®¡ç†</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒçš„è·¯å¾„å¤„ç†</span><span class="token keyword">const</span> isDevelopment <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>NODE_ENV <span class="token operator">===</span> <span class="token string">"development"</span><span class="token punctuation">;</span><span class="token keyword">const</span> downloadPath <span class="token operator">=</span> isDevelopment  <span class="token operator">?</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token string">"videos"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// å¼€å‘ï¼šç³»ç»Ÿè§†é¢‘ç›®å½•</span>  <span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>app<span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token string">"exe"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"../"</span><span class="token punctuation">,</span> <span class="token string">"download"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// ç”Ÿäº§ï¼šåº”ç”¨ç›®å½•</span><span class="token comment" spellcheck="true">// è·å–å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„</span>ipcMain<span class="token punctuation">.</span><span class="token function">handle</span><span class="token punctuation">(</span><span class="token string">"get_exe_path"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> app<span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token string">"exe"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="4-3-æ–‡ä»¶æ£€æŸ¥"><a href="#4-3-æ–‡ä»¶æ£€æŸ¥" class="headerlink" title="4.3 æ–‡ä»¶æ£€æŸ¥"></a>4.3 æ–‡ä»¶æ£€æŸ¥</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span>ipcMain<span class="token punctuation">.</span><span class="token function">handle</span><span class="token punctuation">(</span><span class="token string">"window_check_download"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>e<span class="token punctuation">,</span> urls<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> urls<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> fileName <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">""</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> filePath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>downloadPath<span class="token punctuation">,</span> fileName<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> fileName <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>fs<span class="token punctuation">.</span><span class="token function">existsSync</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// è·å–å·²ä¸‹è½½æ–‡ä»¶çš„æœ¬åœ°è·¯å¾„</span>ipcMain<span class="token punctuation">.</span><span class="token function">handle</span><span class="token punctuation">(</span><span class="token string">"window_get_download"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>e<span class="token punctuation">,</span> urls<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> cacheMap<span class="token punctuation">:</span> Record<span class="token operator">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token operator">></span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>  urls<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>url<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> fileName <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">""</span><span class="token punctuation">;</span>    <span class="token keyword">const</span> filePath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>downloadPath<span class="token punctuation">,</span> fileName<span class="token punctuation">)</span><span class="token punctuation">;</span>    cacheMap<span class="token punctuation">[</span>url<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"xmov://"</span> <span class="token operator">+</span> filePath<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// ä½¿ç”¨è‡ªå®šä¹‰åè®®</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> cacheMap<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h3 id="5-æœ¬åœ°æœåŠ¡é›†æˆ"><a href="#5-æœ¬åœ°æœåŠ¡é›†æˆ" class="headerlink" title="5. æœ¬åœ°æœåŠ¡é›†æˆ"></a>5. æœ¬åœ°æœåŠ¡é›†æˆ</h3><h4 id="5-1-æœåŠ¡å¯åŠ¨ç®¡ç†"><a href="#5-1-æœåŠ¡å¯åŠ¨ç®¡ç†" class="headerlink" title="5.1 æœåŠ¡å¯åŠ¨ç®¡ç†"></a>5.1 æœåŠ¡å¯åŠ¨ç®¡ç†</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// src/service.ts</span><span class="token keyword">import</span> <span class="token punctuation">{</span> app <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"electron"</span><span class="token punctuation">;</span><span class="token keyword">import</span> path <span class="token keyword">from</span> <span class="token string">"path"</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span> exec <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"child_process"</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span> ElectronLogger <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@xmov/electron-extension"</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// è·å–æœåŠ¡è·¯å¾„</span><span class="token keyword">let</span> appPath <span class="token operator">=</span> app<span class="token punctuation">.</span><span class="token function">getPath</span><span class="token punctuation">(</span><span class="token string">"exe"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">let</span> serverPath <span class="token operator">=</span> app<span class="token punctuation">.</span>isPackaged  <span class="token operator">?</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>appPath<span class="token punctuation">,</span> <span class="token string">"../server/main"</span><span class="token punctuation">)</span>  <span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">"../public/server/main"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// å¯åŠ¨æœ¬åœ°æœåŠ¡</span><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">runServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> cmdStr <span class="token operator">=</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>WAKEUP_EXE_NAME<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> --host 0.0.0.0 --port </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>LOCAL_SERVER_PORT<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">;</span>  fs<span class="token punctuation">.</span><span class="token function">stat</span><span class="token punctuation">(</span>serverPath<span class="token punctuation">,</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>      ElectronLogger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"æœåŠ¡å¯åŠ¨å¤±è´¥:"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>      <span class="token function">runExec</span><span class="token punctuation">(</span>serverPath<span class="token punctuation">)</span><span class="token punctuation">;</span>      ElectronLogger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"æœåŠ¡å¯åŠ¨æˆåŠŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">runExec</span><span class="token punctuation">(</span>path<span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> workerProcess <span class="token operator">=</span> <span class="token function">exec</span><span class="token punctuation">(</span>cmdStr<span class="token punctuation">,</span> <span class="token punctuation">{</span> cwd<span class="token punctuation">:</span> path <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  workerProcess<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"data"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    ElectronLogger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"stdout: "</span> <span class="token operator">+</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  workerProcess<span class="token punctuation">.</span>stderr<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"data"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    ElectronLogger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"stderr: "</span> <span class="token operator">+</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  workerProcess<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"close"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>code<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    ElectronLogger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"è¿›ç¨‹é€€å‡ºï¼Œä»£ç : "</span> <span class="token operator">+</span> code<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="5-2-æœåŠ¡å…³é—­ç®¡ç†"><a href="#5-2-æœåŠ¡å…³é—­ç®¡ç†" class="headerlink" title="5.2 æœåŠ¡å…³é—­ç®¡ç†"></a>5.2 æœåŠ¡å…³é—­ç®¡ç†</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// å…³é—­æœ¬åœ°æœåŠ¡</span><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">closeServer</span><span class="token punctuation">(</span>callback<span class="token operator">?</span><span class="token punctuation">:</span> <span class="token keyword">Function</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token function">promiseExec</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`cmd /c taskkill /f /t /im </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>WAKEUP_EXE_NAME<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>      ElectronLogger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"æœåŠ¡å·²å…³é—­"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      callback<span class="token operator">?</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>      ElectronLogger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"å…³é—­æœåŠ¡å¤±è´¥:"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>      callback<span class="token operator">?</span><span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// ä¼˜é›…é€€å‡º</span>app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"will-quit"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">closeServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">finally</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    app<span class="token punctuation">.</span><span class="token function">quit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h3 id="6-é…ç½®ç®¡ç†"><a href="#6-é…ç½®ç®¡ç†" class="headerlink" title="6. é…ç½®ç®¡ç†"></a>6. é…ç½®ç®¡ç†</h3><h4 id="6-1-Electron-Builder-é…ç½®"><a href="#6-1-Electron-Builder-é…ç½®" class="headerlink" title="6.1 Electron Builder é…ç½®"></a>6.1 Electron Builder é…ç½®</h4><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// vue.config.js</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>  pluginOptions<span class="token punctuation">:</span> <span class="token punctuation">{</span>    electronBuilder<span class="token punctuation">:</span> <span class="token punctuation">{</span>      builderOptions<span class="token punctuation">:</span> <span class="token punctuation">{</span>        asar<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// æ‰“åŒ…ä¸ºasar</span>        productName<span class="token punctuation">:</span> productName<span class="token punctuation">,</span>        appId<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>pkg<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.com.xmov.ai`</span></span><span class="token punctuation">,</span>        win<span class="token punctuation">:</span> <span class="token punctuation">{</span>          icon<span class="token punctuation">:</span> <span class="token string">"./src/assets/logo.png"</span><span class="token punctuation">,</span>          target<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"nsis"</span><span class="token punctuation">,</span> <span class="token string">"zip"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// ç”Ÿæˆå®‰è£…åŒ…å’Œå‹ç¼©åŒ…</span>          requestedExecutionLevel<span class="token punctuation">:</span> <span class="token string">"highestAvailable"</span><span class="token punctuation">,</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>        nsis<span class="token punctuation">:</span> <span class="token punctuation">{</span>          oneClick<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// è‡ªå®šä¹‰å®‰è£…</span>          allowToChangeInstallationDirectory<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>          perMachine<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// æ‰€æœ‰ç”¨æˆ·å®‰è£…</span>          allowElevation<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// å…è®¸ææƒ</span>          artifactName<span class="token punctuation">:</span> <span class="token string">"${productName}-installer.${ext}"</span><span class="token punctuation">,</span>          runAfterFinish<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span>        extraResources<span class="token punctuation">:</span> <span class="token punctuation">[</span>          <span class="token comment" spellcheck="true">// é¢å¤–èµ„æºæ–‡ä»¶</span>          <span class="token punctuation">{</span>            <span class="token keyword">from</span><span class="token punctuation">:</span> <span class="token string">"./public/weights"</span><span class="token punctuation">,</span>            to<span class="token punctuation">:</span> <span class="token string">"../weights"</span><span class="token punctuation">,</span>          <span class="token punctuation">}</span><span class="token punctuation">,</span>          <span class="token punctuation">{</span>            <span class="token keyword">from</span><span class="token punctuation">:</span> <span class="token string">"./public/server"</span><span class="token punctuation">,</span>            to<span class="token punctuation">:</span> <span class="token string">"../server"</span><span class="token punctuation">,</span>          <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>      <span class="token punctuation">}</span><span class="token punctuation">,</span>      nodeIntegration<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="6-2-ç¯å¢ƒé…ç½®ç®¡ç†"><a href="#6-2-ç¯å¢ƒé…ç½®ç®¡ç†" class="headerlink" title="6.2 ç¯å¢ƒé…ç½®ç®¡ç†"></a>6.2 ç¯å¢ƒé…ç½®ç®¡ç†</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// package-env.ts</span><span class="token keyword">export</span> <span class="token keyword">enum</span> EnvType <span class="token punctuation">{</span>  DEV <span class="token operator">=</span> <span class="token string">"dev"</span><span class="token punctuation">,</span>  TEST <span class="token operator">=</span> <span class="token string">"test"</span><span class="token punctuation">,</span>  PRODUCTION <span class="token operator">=</span> <span class="token string">"production"</span><span class="token punctuation">,</span>  PRIVATE <span class="token operator">=</span> <span class="token string">"private"</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// set-package-env.js</span><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"fs"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> envType <span class="token operator">=</span> process<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token string">"dev"</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// æ ¹æ®ç¯å¢ƒè®¾ç½®ä¸åŒçš„é…ç½®</span><span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>  dev<span class="token punctuation">:</span> <span class="token punctuation">{</span> apiBase<span class="token punctuation">:</span> <span class="token string">"http://localhost:8080"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>  test<span class="token punctuation">:</span> <span class="token punctuation">{</span> apiBase<span class="token punctuation">:</span> <span class="token string">"https://test-api.example.com"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>  production<span class="token punctuation">:</span> <span class="token punctuation">{</span> apiBase<span class="token punctuation">:</span> <span class="token string">"https://api.example.com"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span>fs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span>  <span class="token string">"./package-env.json"</span><span class="token punctuation">,</span>  JSON<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>config<span class="token punctuation">[</span>envType<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h3 id="7-å¼€å‘å·¥å…·é›†æˆ"><a href="#7-å¼€å‘å·¥å…·é›†æˆ" class="headerlink" title="7. å¼€å‘å·¥å…·é›†æˆ"></a>7. å¼€å‘å·¥å…·é›†æˆ</h3><h4 id="7-1-Vue-DevTools"><a href="#7-1-Vue-DevTools" class="headerlink" title="7.1 Vue DevTools"></a>7.1 Vue DevTools</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token keyword">import</span> installExtension<span class="token punctuation">,</span> <span class="token punctuation">{</span> VUEJS3_DEVTOOLS <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"electron-devtools-installer"</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"ready"</span><span class="token punctuation">,</span> async <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>isDevelopment <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span>IS_TEST<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>      await <span class="token function">installExtension</span><span class="token punctuation">(</span>VUEJS3_DEVTOOLS<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"Vue Devtoolså®‰è£…å¤±è´¥:"</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="7-2-å¿«æ·é”®è°ƒè¯•"><a href="#7-2-å¿«æ·é”®è°ƒè¯•" class="headerlink" title="7.2 å¿«æ·é”®è°ƒè¯•"></a>7.2 å¿«æ·é”®è°ƒè¯•</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> globalShortcut <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"electron"</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// æ³¨å†Œå¿«æ·é”®æ‰“å¼€å¼€å‘è€…å·¥å…·</span>globalShortcut<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">"CommandOrControl+Shift+i"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>win<span class="token punctuation">)</span> <span class="token punctuation">{</span>    win<span class="token punctuation">.</span>webContents<span class="token punctuation">.</span><span class="token function">openDevTools</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="7-3-æ—¥å¿—ç³»ç»Ÿ"><a href="#7-3-æ—¥å¿—ç³»ç»Ÿ" class="headerlink" title="7.3 æ—¥å¿—ç³»ç»Ÿ"></a>7.3 æ—¥å¿—ç³»ç»Ÿ</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> ElectronLogger <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@xmov/electron-extension"</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// ä¸åŒçº§åˆ«çš„æ—¥å¿—</span>ElectronLogger<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">"è°ƒè¯•ä¿¡æ¯"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>ElectronLogger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"æ™®é€šä¿¡æ¯"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>ElectronLogger<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">"è­¦å‘Šä¿¡æ¯"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>ElectronLogger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"é”™è¯¯ä¿¡æ¯"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h3 id="8-å®‰å…¨æœ€ä½³å®è·µ"><a href="#8-å®‰å…¨æœ€ä½³å®è·µ" class="headerlink" title="8. å®‰å…¨æœ€ä½³å®è·µ"></a>8. å®‰å…¨æœ€ä½³å®è·µ</h3><h4 id="8-1-Context-Isolation"><a href="#8-1-Context-Isolation" class="headerlink" title="8.1 Context Isolation"></a>8.1 Context Isolation</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// å¯ç”¨ä¸Šä¸‹æ–‡éš”ç¦»ï¼ˆæ¨èï¼‰</span>webPreferences<span class="token punctuation">:</span> <span class="token punctuation">{</span>  contextIsolation<span class="token punctuation">:</span> <span class="token keyword">true</span><span class="token punctuation">,</span>  nodeIntegration<span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">,</span>  preload<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__static<span class="token punctuation">,</span> <span class="token string">'preload.js'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// é€šè¿‡preloadè„šæœ¬å®‰å…¨æš´éœ²API</span>contextBridge<span class="token punctuation">.</span><span class="token function">exposeInMainWorld</span><span class="token punctuation">(</span><span class="token string">'api'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// åªæš´éœ²å¿…è¦çš„API</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="8-2-CSP-ç­–ç•¥"><a href="#8-2-CSP-ç­–ç•¥" class="headerlink" title="8.2 CSP ç­–ç•¥"></a>8.2 CSP ç­–ç•¥</h4><pre class="line-numbers language-html"><code class="language-html"><span class="token comment" spellcheck="true">&lt;!-- index.html --></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span>  <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Content-Security-Policy<span class="token punctuation">"</span></span>  <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>default-src <span class="token punctuation">'</span>self<span class="token punctuation">'</span>; script-src <span class="token punctuation">'</span>self<span class="token punctuation">'</span> <span class="token punctuation">'</span>unsafe-inline<span class="token punctuation">'</span><span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="8-3-å†…å®¹å®‰å…¨"><a href="#8-3-å†…å®¹å®‰å…¨" class="headerlink" title="8.3 å†…å®¹å®‰å…¨"></a>8.3 å†…å®¹å®‰å…¨</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// ç§»é™¤ä¸å®‰å…¨çš„HTTPå¤´</span>win<span class="token punctuation">.</span>webContents<span class="token punctuation">.</span>session<span class="token punctuation">.</span>webRequest<span class="token punctuation">.</span><span class="token function">onHeadersReceived</span><span class="token punctuation">(</span><span class="token punctuation">(</span>details<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">{</span>    responseHeaders<span class="token punctuation">:</span> Object<span class="token punctuation">.</span><span class="token function">fromEntries</span><span class="token punctuation">(</span>      Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>details<span class="token punctuation">.</span>responseHeaders<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>        <span class="token punctuation">(</span>header<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">!</span><span class="token regex">/x-frame-options|content-security-policy/i</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>header<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>      <span class="token punctuation">)</span>    <span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h3 id="9-æ€§èƒ½ä¼˜åŒ–"><a href="#9-æ€§èƒ½ä¼˜åŒ–" class="headerlink" title="9. æ€§èƒ½ä¼˜åŒ–"></a>9. æ€§èƒ½ä¼˜åŒ–</h3><h4 id="9-1-ç¡¬ä»¶åŠ é€Ÿ"><a href="#9-1-ç¡¬ä»¶åŠ é€Ÿ" class="headerlink" title="9.1 ç¡¬ä»¶åŠ é€Ÿ"></a>9.1 ç¡¬ä»¶åŠ é€Ÿ</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// æ ¹æ®éœ€è¦ç¦ç”¨ç¡¬ä»¶åŠ é€Ÿï¼ˆæŸäº›æƒ…å†µä¸‹å¯è§£å†³æ¸²æŸ“é—®é¢˜ï¼‰</span><span class="token comment" spellcheck="true">// if (app.isPackaged) {</span><span class="token comment" spellcheck="true">//   app.disableHardwareAcceleration()</span><span class="token comment" spellcheck="true">// }</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="9-2-èµ„æºåŠ è½½ä¼˜åŒ–"><a href="#9-2-èµ„æºåŠ è½½ä¼˜åŒ–" class="headerlink" title="9.2 èµ„æºåŠ è½½ä¼˜åŒ–"></a>9.2 èµ„æºåŠ è½½ä¼˜åŒ–</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// å»¶è¿ŸåŠ è½½éå…³é”®èµ„æº</span>win<span class="token punctuation">.</span>webContents<span class="token punctuation">.</span><span class="token function">once</span><span class="token punctuation">(</span><span class="token string">"dom-ready"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// åŠ è½½é¢å¤–èµ„æº</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="9-3-å†…å­˜ç®¡ç†"><a href="#9-3-å†…å­˜ç®¡ç†" class="headerlink" title="9.3 å†…å­˜ç®¡ç†"></a>9.3 å†…å­˜ç®¡ç†</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// ç›‘æ§å†…å­˜ä½¿ç”¨</span>app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"ready"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> memInfo <span class="token operator">=</span> process<span class="token punctuation">.</span><span class="token function">memoryUsage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"å†…å­˜ä½¿ç”¨:"</span><span class="token punctuation">,</span> memInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">30000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h3 id="10-æ‰“åŒ…ä¸åˆ†å‘"><a href="#10-æ‰“åŒ…ä¸åˆ†å‘" class="headerlink" title="10. æ‰“åŒ…ä¸åˆ†å‘"></a>10. æ‰“åŒ…ä¸åˆ†å‘</h3><h4 id="10-1-æ„å»ºå‘½ä»¤"><a href="#10-1-æ„å»ºå‘½ä»¤" class="headerlink" title="10.1 æ„å»ºå‘½ä»¤"></a>10.1 æ„å»ºå‘½ä»¤</h4><pre class="line-numbers language-json"><code class="language-json"><span class="token punctuation">{</span>  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token property">"dev"</span><span class="token operator">:</span> <span class="token string">"node set-package-env.js dev &amp;&amp; vue-cli-service electron:serve"</span><span class="token punctuation">,</span>    <span class="token property">"electron-build-test"</span><span class="token operator">:</span> <span class="token string">"node set-package-env.js test &amp;&amp; vue-cli-service electron:build"</span><span class="token punctuation">,</span>    <span class="token property">"electron-build-production"</span><span class="token operator">:</span> <span class="token string">"node set-package-env.js production &amp;&amp; vue-cli-service electron:build"</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="10-2-æ„å»ºäº§ç‰©"><a href="#10-2-æ„å»ºäº§ç‰©" class="headerlink" title="10.2 æ„å»ºäº§ç‰©"></a>10.2 æ„å»ºäº§ç‰©</h4><pre><code>dist_electron/â”œâ”€â”€ bundled/              # æ‰“åŒ…åçš„åº”ç”¨â”œâ”€â”€ win-unpacked/         # Windowsè§£å‹ç‰ˆæœ¬â”œâ”€â”€ *.exe                 # å®‰è£…åŒ…â””â”€â”€ *.exe.blockmap       # æ›´æ–°æ˜ å°„æ–‡ä»¶</code></pre><h4 id="10-3-è‡ªåŠ¨æ›´æ–°"><a href="#10-3-è‡ªåŠ¨æ›´æ–°" class="headerlink" title="10.3 è‡ªåŠ¨æ›´æ–°"></a>10.3 è‡ªåŠ¨æ›´æ–°</h4><pre class="line-numbers language-typescript"><code class="language-typescript"><span class="token comment" spellcheck="true">// é›†æˆelectron-updater</span><span class="token keyword">import</span> <span class="token punctuation">{</span> autoUpdater <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"electron-updater"</span><span class="token punctuation">;</span>autoUpdater<span class="token punctuation">.</span><span class="token function">checkForUpdatesAndNotify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="ğŸ”§-å¸¸è§é—®é¢˜è§£å†³"><a href="#ğŸ”§-å¸¸è§é—®é¢˜è§£å†³" class="headerlink" title="ğŸ”§ å¸¸è§é—®é¢˜è§£å†³"></a>ğŸ”§ å¸¸è§é—®é¢˜è§£å†³</h2><h3 id="1-ç™½å±é—®é¢˜"><a href="#1-ç™½å±é—®é¢˜" class="headerlink" title="1. ç™½å±é—®é¢˜"></a>1. ç™½å±é—®é¢˜</h3><p><strong>åŸå› </strong>ï¼šWebSecurity é˜»æ­¢äº†èµ„æºåŠ è½½</p><p><strong>è§£å†³</strong>ï¼š</p><pre class="line-numbers language-typescript"><code class="language-typescript">webPreferences<span class="token punctuation">:</span> <span class="token punctuation">{</span>  webSecurity<span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// å¼€å‘ç¯å¢ƒ</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="2-IPC-é€šä¿¡å¤±è´¥"><a href="#2-IPC-é€šä¿¡å¤±è´¥" class="headerlink" title="2. IPC é€šä¿¡å¤±è´¥"></a>2. IPC é€šä¿¡å¤±è´¥</h3><p><strong>åŸå› </strong>ï¼šcontextIsolation å¯ç”¨ä½† preload æœªæ­£ç¡®æš´éœ² API</p><p><strong>è§£å†³</strong>ï¼šæ£€æŸ¥ preload.js ä¸­çš„ contextBridge ä½¿ç”¨</p><h3 id="3-æ–‡ä»¶è·¯å¾„é—®é¢˜"><a href="#3-æ–‡ä»¶è·¯å¾„é—®é¢˜" class="headerlink" title="3. æ–‡ä»¶è·¯å¾„é—®é¢˜"></a>3. æ–‡ä»¶è·¯å¾„é—®é¢˜</h3><p><strong>åŸå› </strong>ï¼šå¼€å‘å’Œç”Ÿäº§ç¯å¢ƒè·¯å¾„ä¸ä¸€è‡´</p><p><strong>è§£å†³</strong>ï¼šä½¿ç”¨ <code>app.isPackaged</code> åˆ¤æ–­ç¯å¢ƒ</p><h3 id="4-æœåŠ¡å¯åŠ¨å¤±è´¥"><a href="#4-æœåŠ¡å¯åŠ¨å¤±è´¥" class="headerlink" title="4. æœåŠ¡å¯åŠ¨å¤±è´¥"></a>4. æœåŠ¡å¯åŠ¨å¤±è´¥</h3><p><strong>åŸå› </strong>ï¼šæœåŠ¡è¿›ç¨‹æœªæ­£ç¡®å…³é—­</p><p><strong>è§£å†³</strong>ï¼šç¡®ä¿åœ¨ <code>will-quit</code> äº‹ä»¶ä¸­å…³é—­æœåŠ¡</p><hr><h2 id="ğŸ“š-æœ€ä½³å®è·µæ€»ç»“"><a href="#ğŸ“š-æœ€ä½³å®è·µæ€»ç»“" class="headerlink" title="ğŸ“š æœ€ä½³å®è·µæ€»ç»“"></a>ğŸ“š æœ€ä½³å®è·µæ€»ç»“</h2><ol><li><strong>å®‰å…¨æ€§</strong>ï¼šå§‹ç»ˆå¯ç”¨ contextIsolationï¼Œé€šè¿‡ preload æš´éœ² API</li><li><strong>æ€§èƒ½</strong>ï¼šåˆç†ä½¿ç”¨ç¡¬ä»¶åŠ é€Ÿï¼ŒåŠæ—¶é‡Šæ”¾èµ„æº</li><li><strong>ç¨³å®šæ€§</strong>ï¼šå®Œå–„çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•</li><li><strong>å¯ç»´æŠ¤æ€§</strong>ï¼šæ¸…æ™°çš„ä»£ç ç»“æ„å’Œæ³¨é‡Š</li><li><strong>ç”¨æˆ·ä½“éªŒ</strong>ï¼šå¹³æ»‘çš„å¯åŠ¨æµç¨‹å’ŒåŠ è½½æç¤º</li></ol><hr><h2 id="ğŸ”—-ç›¸å…³èµ„æº"><a href="#ğŸ”—-ç›¸å…³èµ„æº" class="headerlink" title="ğŸ”— ç›¸å…³èµ„æº"></a>ğŸ”— ç›¸å…³èµ„æº</h2><ul><li><a href="https://www.electronjs.org/docs/latest/">Electron å®˜æ–¹æ–‡æ¡£</a></li><li><a href="https://www.electron.build/">electron-builder æ–‡æ¡£</a></li><li><a href="https://nklayman.github.io/vue-cli-plugin-electron-builder/">Vue CLI Plugin Electron Builder</a></li><li><a href="https://www.electronjs.org/docs/latest/tutorial/security">Electron å®‰å…¨æŒ‡å—</a></li></ul><hr><h2 id="ğŸ“-æ€»ç»“"><a href="#ğŸ“-æ€»ç»“" class="headerlink" title="ğŸ“ æ€»ç»“"></a>ğŸ“ æ€»ç»“</h2><p>æœ¬é¡¹ç›®æˆåŠŸå®ç°äº†ï¼š</p><ul><li>âœ… <strong>å®Œå–„çš„çª—å£ç®¡ç†</strong>ï¼šå¤šçª—å£åè°ƒå·¥ä½œ</li><li>âœ… <strong>é«˜æ•ˆçš„ IPC é€šä¿¡</strong>ï¼šå®‰å…¨çš„è¿›ç¨‹é—´é€šä¿¡</li><li>âœ… <strong>æœ¬åœ°æœåŠ¡é›†æˆ</strong>ï¼šæ— ç¼çš„æœ¬åœ°æœåŠ¡ç®¡ç†</li><li>âœ… <strong>çµæ´»çš„é…ç½®ç³»ç»Ÿ</strong>ï¼šå¤šç¯å¢ƒé…ç½®æ”¯æŒ</li><li>âœ… <strong>ä¸“ä¸šçš„æ‰“åŒ…æ–¹æ¡ˆ</strong>ï¼šæ ‡å‡†åŒ–çš„æ„å»ºæµç¨‹</li></ul><p>é€šè¿‡ Electron æŠ€æœ¯ï¼ŒæˆåŠŸå°† Web æŠ€æœ¯æ ˆåº”ç”¨åˆ°æ¡Œé¢åº”ç”¨åœºæ™¯ï¼Œå®ç°äº†è·¨å¹³å°éƒ¨ç½²çš„ AI è™šæ‹Ÿäººç³»ç»Ÿã€‚</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> ElectronæŠ€æœ¯å®è·µ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vue3 </tag>
            
            <tag> Electron </tag>
            
            <tag> æ¡Œé¢åº”ç”¨ </tag>
            
            <tag> IPCé€šä¿¡ </tag>
            
            <tag> çª—å£ç®¡ç† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>reactå¸¸è§é—®é¢˜æ±‡æ€»1ï¼ˆæŒç»­æ›´æ–°ä¸­....ï¼‰</title>
      <link href="/2024/12/10/reactinterview1/"/>
      <url>/2024/12/10/reactinterview1/</url>
      
        <content type="html"><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/reactreactInterview1/1.png" alt="React.png"></p><h2 id="ä¸€ã€ç»„ä»¶åŸºç¡€"><a href="#ä¸€ã€ç»„ä»¶åŸºç¡€" class="headerlink" title="ä¸€ã€ç»„ä»¶åŸºç¡€"></a>ä¸€ã€ç»„ä»¶åŸºç¡€</h2><h3 id="1-React-äº‹ä»¶æœºåˆ¶"><a href="#1-React-äº‹ä»¶æœºåˆ¶" class="headerlink" title="1. React äº‹ä»¶æœºåˆ¶"></a>1. React äº‹ä»¶æœºåˆ¶</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>div onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleClick<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span>ç‚¹æˆ‘<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>React å¹¶ä¸æ˜¯å°† click äº‹ä»¶ç»‘å®šåˆ°äº† div çš„çœŸå® DOM ä¸Šï¼Œè€Œæ˜¯åœ¨ document å¤„ç›‘å¬äº†æ‰€æœ‰çš„äº‹ä»¶ï¼Œå½“äº‹ä»¶å‘ç”Ÿå¹¶ä¸”å†’æ³¡åˆ° document å¤„çš„æ—¶å€™ï¼ŒReact å°†äº‹ä»¶å†…å®¹å°è£…å¹¶äº¤ç”±çœŸæ­£çš„å¤„ç†å‡½æ•°è¿è¡Œã€‚è¿™æ ·çš„æ–¹å¼ä¸ä»…ä»…å‡å°‘äº†å†…å­˜çš„æ¶ˆè€—ï¼Œè¿˜èƒ½åœ¨ç»„ä»¶æŒ‚åœ¨é”€æ¯æ—¶ç»Ÿä¸€è®¢é˜…å’Œç§»é™¤äº‹ä»¶ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œå†’æ³¡åˆ° document ä¸Šçš„äº‹ä»¶ä¹Ÿä¸æ˜¯åŸç”Ÿçš„æµè§ˆå™¨äº‹ä»¶ï¼Œè€Œæ˜¯ç”± react è‡ªå·±å®ç°çš„åˆæˆäº‹ä»¶ï¼ˆSyntheticEventï¼‰ã€‚å› æ­¤å¦‚æœä¸æƒ³è¦æ˜¯äº‹ä»¶å†’æ³¡çš„è¯åº”è¯¥è°ƒç”¨ event.preventDefault()æ–¹æ³•ï¼Œè€Œä¸æ˜¯è°ƒç”¨ event.stopProppagation()æ–¹æ³•ã€‚<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/reactreactInterview1/2.png" alt="77fa6b2a59c92e160bc171f9c80783e7.jpg"><br>JSX ä¸Šå†™çš„äº‹ä»¶å¹¶æ²¡æœ‰ç»‘å®šåœ¨å¯¹åº”çš„çœŸå® DOM ä¸Šï¼Œè€Œæ˜¯é€šè¿‡äº‹ä»¶ä»£ç†çš„æ–¹å¼ï¼Œå°†æ‰€æœ‰çš„äº‹ä»¶éƒ½ç»Ÿä¸€ç»‘å®šåœ¨äº† <code>document</code> ä¸Šã€‚è¿™æ ·çš„æ–¹å¼ä¸ä»…å‡å°‘äº†å†…å­˜æ¶ˆè€—ï¼Œè¿˜èƒ½åœ¨ç»„ä»¶æŒ‚è½½é”€æ¯æ—¶ç»Ÿä¸€è®¢é˜…å’Œç§»é™¤äº‹ä»¶ã€‚</p><p>å¦å¤–å†’æ³¡åˆ° <code>document</code> ä¸Šçš„äº‹ä»¶ä¹Ÿä¸æ˜¯åŸç”Ÿæµè§ˆå™¨äº‹ä»¶ï¼Œè€Œæ˜¯ React è‡ªå·±å®ç°çš„åˆæˆäº‹ä»¶ï¼ˆSyntheticEventï¼‰ã€‚å› æ­¤æˆ‘ä»¬å¦‚æœä¸æƒ³è¦äº‹ä»¶å†’æ³¡çš„è¯ï¼Œè°ƒç”¨ <code>event.stopPropagation</code> æ˜¯æ— æ•ˆçš„ï¼Œè€Œåº”è¯¥è°ƒç”¨ <code>event.preventDefault</code>ã€‚</p><p>å®ç°åˆæˆäº‹ä»¶çš„ç›®çš„å¦‚ä¸‹ï¼š</p><ul><li>åˆæˆäº‹ä»¶é¦–å…ˆæŠ¹å¹³äº†æµè§ˆå™¨ä¹‹é—´çš„å…¼å®¹é—®é¢˜ï¼Œå¦å¤–è¿™æ˜¯ä¸€ä¸ªè·¨æµè§ˆå™¨åŸç”Ÿäº‹ä»¶åŒ…è£…å™¨ï¼Œèµ‹äºˆäº†è·¨æµè§ˆå™¨å¼€å‘çš„èƒ½åŠ›ï¼›</li><li>å¯¹äºåŸç”Ÿæµè§ˆå™¨äº‹ä»¶æ¥è¯´ï¼Œæµè§ˆå™¨ä¼šç»™ç›‘å¬å™¨åˆ›å»ºä¸€ä¸ªäº‹ä»¶å¯¹è±¡ã€‚å¦‚æœä½ æœ‰å¾ˆå¤šçš„äº‹ä»¶ç›‘å¬ï¼Œé‚£ä¹ˆå°±éœ€è¦åˆ†é…å¾ˆå¤šçš„äº‹ä»¶å¯¹è±¡ï¼Œé€ æˆé«˜é¢çš„å†…å­˜åˆ†é…é—®é¢˜ã€‚ä½†æ˜¯å¯¹äºåˆæˆäº‹ä»¶æ¥è¯´ï¼Œæœ‰ä¸€ä¸ªäº‹ä»¶æ± ä¸“é—¨æ¥ç®¡ç†å®ƒä»¬çš„åˆ›å»ºå’Œé”€æ¯ï¼Œå½“äº‹ä»¶éœ€è¦è¢«ä½¿ç”¨æ—¶ï¼Œå°±ä¼šä»æ± å­ä¸­å¤ç”¨å¯¹è±¡ï¼Œäº‹ä»¶å›è°ƒç»“æŸåï¼Œå°±ä¼šé”€æ¯äº‹ä»¶å¯¹è±¡ä¸Šçš„å±æ€§ï¼Œä»è€Œä¾¿äºä¸‹æ¬¡å¤ç”¨äº‹ä»¶å¯¹è±¡ã€‚</li></ul><h3 id="2-React-çš„äº‹ä»¶å’Œæ™®é€šçš„-HTML-äº‹ä»¶æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ"><a href="#2-React-çš„äº‹ä»¶å’Œæ™®é€šçš„-HTML-äº‹ä»¶æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ" class="headerlink" title="2. React çš„äº‹ä»¶å’Œæ™®é€šçš„ HTML äº‹ä»¶æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ"></a>2. React çš„äº‹ä»¶å’Œæ™®é€šçš„ HTML äº‹ä»¶æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ</h3><p>åŒºåˆ«ï¼š</p><ul><li>å¯¹äºäº‹ä»¶åç§°å‘½åæ–¹å¼ï¼ŒåŸç”Ÿäº‹ä»¶ä¸ºå…¨å°å†™ï¼Œreact äº‹ä»¶é‡‡ç”¨å°é©¼å³°ï¼›</li><li>å¯¹äºäº‹ä»¶å‡½æ•°å¤„ç†è¯­æ³•ï¼ŒåŸç”Ÿäº‹ä»¶ä¸ºå­—ç¬¦ä¸²ï¼Œreact äº‹ä»¶ä¸ºå‡½æ•°ï¼›</li><li>react äº‹ä»¶ä¸èƒ½é‡‡ç”¨ return false çš„æ–¹å¼æ¥é˜»æ­¢æµè§ˆå™¨çš„é»˜è®¤è¡Œä¸ºï¼Œè€Œå¿…é¡»è¦åœ°æ˜ç¡®åœ°è°ƒç”¨<code>preventDefault()</code>æ¥é˜»æ­¢é»˜è®¤è¡Œä¸ºã€‚</li></ul><p>åˆæˆäº‹ä»¶æ˜¯ react æ¨¡æ‹ŸåŸç”Ÿ DOM äº‹ä»¶æ‰€æœ‰èƒ½åŠ›çš„ä¸€ä¸ªäº‹ä»¶å¯¹è±¡ï¼Œå…¶ä¼˜ç‚¹å¦‚ä¸‹ï¼š</p><ul><li>å…¼å®¹æ‰€æœ‰æµè§ˆå™¨ï¼Œæ›´å¥½çš„è·¨å¹³å°ï¼›</li><li>å°†äº‹ä»¶ç»Ÿä¸€å­˜æ”¾åœ¨ä¸€ä¸ªæ•°ç»„ï¼Œé¿å…é¢‘ç¹çš„æ–°å¢ä¸åˆ é™¤ï¼ˆåƒåœ¾å›æ”¶ï¼‰ã€‚</li><li>æ–¹ä¾¿ react ç»Ÿä¸€ç®¡ç†å’Œäº‹åŠ¡æœºåˆ¶ã€‚</li></ul><p>äº‹ä»¶çš„æ‰§è¡Œé¡ºåºä¸ºåŸç”Ÿäº‹ä»¶å…ˆæ‰§è¡Œï¼Œåˆæˆäº‹ä»¶åæ‰§è¡Œï¼Œåˆæˆäº‹ä»¶ä¼šå†’æ³¡ç»‘å®šåˆ° document ä¸Šï¼Œæ‰€ä»¥å°½é‡é¿å…åŸç”Ÿäº‹ä»¶ä¸åˆæˆäº‹ä»¶æ··ç”¨ï¼Œå¦‚æœåŸç”Ÿäº‹ä»¶é˜»æ­¢å†’æ³¡ï¼Œå¯èƒ½ä¼šå¯¼è‡´åˆæˆäº‹ä»¶ä¸æ‰§è¡Œï¼Œå› ä¸ºéœ€è¦å†’æ³¡åˆ° document ä¸Šåˆæˆäº‹ä»¶æ‰ä¼šæ‰§è¡Œã€‚</p><h3 id="3-React-ç»„ä»¶ä¸­æ€ä¹ˆåšäº‹ä»¶ä»£ç†ï¼Ÿå®ƒçš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#3-React-ç»„ä»¶ä¸­æ€ä¹ˆåšäº‹ä»¶ä»£ç†ï¼Ÿå®ƒçš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="3. React ç»„ä»¶ä¸­æ€ä¹ˆåšäº‹ä»¶ä»£ç†ï¼Ÿå®ƒçš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"></a>3. React ç»„ä»¶ä¸­æ€ä¹ˆåšäº‹ä»¶ä»£ç†ï¼Ÿå®ƒçš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>React åŸºäº Virtual DOM å®ç°äº†ä¸€ä¸ª SyntheticEvent å±‚ï¼ˆåˆæˆäº‹ä»¶å±‚ï¼‰ï¼Œå®šä¹‰çš„äº‹ä»¶å¤„ç†å™¨ä¼šæ¥æ”¶åˆ°ä¸€ä¸ªåˆæˆäº‹ä»¶å¯¹è±¡çš„å®ä¾‹ï¼Œå®ƒç¬¦åˆ W3C æ ‡å‡†ï¼Œä¸”ä¸åŸç”Ÿçš„æµè§ˆå™¨äº‹ä»¶æ‹¥æœ‰åŒæ ·çš„æ¥å£ï¼Œæ”¯æŒå†’æ³¡æœºåˆ¶ï¼Œæ‰€æœ‰çš„äº‹ä»¶éƒ½è‡ªåŠ¨ç»‘å®šåœ¨æœ€å¤–å±‚ä¸Šã€‚</p><p>åœ¨ React åº•å±‚ï¼Œä¸»è¦å¯¹åˆæˆäº‹ä»¶åšäº†ä¸¤ä»¶äº‹ï¼š</p><ul><li><strong>äº‹ä»¶å§”æ´¾ï¼š</strong> React ä¼šæŠŠæ‰€æœ‰çš„äº‹ä»¶ç»‘å®šåˆ°ç»“æ„çš„æœ€å¤–å±‚ï¼Œä½¿ç”¨ç»Ÿä¸€çš„äº‹ä»¶ç›‘å¬å™¨ï¼Œè¿™ä¸ªäº‹ä»¶ç›‘å¬å™¨ä¸Šç»´æŒäº†ä¸€ä¸ªæ˜ å°„æ¥ä¿å­˜æ‰€æœ‰ç»„ä»¶å†…éƒ¨äº‹ä»¶ç›‘å¬å’Œå¤„ç†å‡½æ•°ã€‚</li><li><strong>è‡ªåŠ¨ç»‘å®šï¼š</strong> React ç»„ä»¶ä¸­ï¼Œæ¯ä¸ªæ–¹æ³•çš„ä¸Šä¸‹æ–‡éƒ½ä¼šæŒ‡å‘è¯¥ç»„ä»¶çš„å®ä¾‹ï¼Œå³è‡ªåŠ¨ç»‘å®š this ä¸ºå½“å‰ç»„ä»¶ã€‚</li></ul><h3 id="4-React-é«˜é˜¶ç»„ä»¶ã€Render-propsã€hooks-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œä¸ºä»€ä¹ˆè¦ä¸æ–­è¿­ä»£"><a href="#4-React-é«˜é˜¶ç»„ä»¶ã€Render-propsã€hooks-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œä¸ºä»€ä¹ˆè¦ä¸æ–­è¿­ä»£" class="headerlink" title="4. React é«˜é˜¶ç»„ä»¶ã€Render propsã€hooks æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œä¸ºä»€ä¹ˆè¦ä¸æ–­è¿­ä»£"></a>4. React é«˜é˜¶ç»„ä»¶ã€Render propsã€hooks æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œä¸ºä»€ä¹ˆè¦ä¸æ–­è¿­ä»£</h3><p>è¿™ä¸‰è€…æ˜¯ç›®å‰ react è§£å†³ä»£ç å¤ç”¨çš„ä¸»è¦æ–¹å¼ï¼š</p><ul><li>é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰æ˜¯ React ä¸­ç”¨äºå¤ç”¨ç»„ä»¶é€»è¾‘çš„ä¸€ç§é«˜çº§æŠ€å·§ã€‚HOC è‡ªèº«ä¸æ˜¯ React API çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒæ˜¯ä¸€ç§åŸºäº React çš„ç»„åˆç‰¹æ€§è€Œå½¢æˆçš„è®¾è®¡æ¨¡å¼ã€‚å…·ä½“è€Œè¨€ï¼Œé«˜é˜¶ç»„ä»¶æ˜¯å‚æ•°ä¸ºç»„ä»¶ï¼Œè¿”å›å€¼ä¸ºæ–°ç»„ä»¶çš„å‡½æ•°ã€‚</li><li>render props æ˜¯æŒ‡ä¸€ç§åœ¨ React ç»„ä»¶ä¹‹é—´ä½¿ç”¨ä¸€ä¸ªå€¼ä¸ºå‡½æ•°çš„ prop å…±äº«ä»£ç çš„ç®€å•æŠ€æœ¯ï¼Œæ›´å…·ä½“çš„è¯´ï¼Œrender prop æ˜¯ä¸€ä¸ªç”¨äºå‘ŠçŸ¥ç»„ä»¶éœ€è¦æ¸²æŸ“ä»€ä¹ˆå†…å®¹çš„å‡½æ•° propã€‚</li><li>é€šå¸¸ï¼Œrender props å’Œé«˜é˜¶ç»„ä»¶åªæ¸²æŸ“ä¸€ä¸ªå­èŠ‚ç‚¹ã€‚è®© Hook æ¥æœåŠ¡è¿™ä¸ªä½¿ç”¨åœºæ™¯æ›´åŠ ç®€å•ã€‚è¿™ä¸¤ç§æ¨¡å¼ä»æœ‰ç”¨æ­¦ä¹‹åœ°ï¼Œï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ªè™šæ‹Ÿæ»šåŠ¨æ¡ç»„ä»¶æˆ–è®¸ä¼šæœ‰ä¸€ä¸ª renderltem å±æ€§ï¼Œæˆ–æ˜¯ä¸€ä¸ªå¯è§çš„å®¹å™¨ç»„ä»¶æˆ–è®¸ä¼šæœ‰å®ƒè‡ªå·±çš„ DOM ç»“æ„ï¼‰ã€‚ä½†åœ¨å¤§éƒ¨åˆ†åœºæ™¯ä¸‹ï¼ŒHook è¶³å¤Ÿäº†ï¼Œå¹¶ä¸”èƒ½å¤Ÿå¸®åŠ©å‡å°‘åµŒå¥—ã€‚</li></ul><p><strong>ï¼ˆ1ï¼‰HOC</strong><br>å®˜æ–¹è§£é‡Š âˆ¶</p><blockquote><p>é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰æ˜¯ React ä¸­ç”¨äºå¤ç”¨ç»„ä»¶é€»è¾‘çš„ä¸€ç§é«˜çº§æŠ€å·§ã€‚HOC è‡ªèº«ä¸æ˜¯ React API çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒæ˜¯ä¸€ç§åŸºäº React çš„ç»„åˆç‰¹æ€§è€Œå½¢æˆçš„è®¾è®¡æ¨¡å¼ã€‚</p></blockquote><p>ç®€è¨€ä¹‹ï¼ŒHOC æ˜¯ä¸€ç§ç»„ä»¶çš„è®¾è®¡æ¨¡å¼ï¼ŒHOC æ¥å—ä¸€ä¸ªç»„ä»¶å’Œé¢å¤–çš„å‚æ•°ï¼ˆå¦‚æœéœ€è¦ï¼‰ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„ç»„ä»¶ã€‚HOC æ˜¯çº¯å‡½æ•°ï¼Œæ²¡æœ‰å‰¯ä½œç”¨ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// hocçš„å®šä¹‰</span><span class="token keyword">function</span> <span class="token function">withSubscription</span><span class="token punctuation">(</span>WrappedComponent<span class="token punctuation">,</span> selectData<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> React<span class="token punctuation">.</span>Component <span class="token punctuation">{</span>    <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>        data<span class="token punctuation">:</span> <span class="token function">selectData</span><span class="token punctuation">(</span>DataSource<span class="token punctuation">,</span> props<span class="token punctuation">)</span>      <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// ä¸€äº›é€šç”¨çš„é€»è¾‘å¤„ç†</span>    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token comment" spellcheck="true">// ... å¹¶ä½¿ç”¨æ–°æ•°æ®æ¸²æŸ“è¢«åŒ…è£…çš„ç»„ä»¶!</span>      <span class="token keyword">return</span> <span class="token operator">&lt;</span>WrappedComponent data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>data<span class="token punctuation">}</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// ä½¿ç”¨</span><span class="token keyword">const</span> BlogPostWithSubscription <span class="token operator">=</span> <span class="token function">withSubscription</span><span class="token punctuation">(</span>BlogPost<span class="token punctuation">,</span>  <span class="token punctuation">(</span>DataSource<span class="token punctuation">,</span> props<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> DataSource<span class="token punctuation">.</span><span class="token function">getBlogPost</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>HOC çš„ä¼˜ç¼ºç‚¹ âˆ¶</p><ul><li>ä¼˜ç‚¹ âˆ¶ é€»è¾‘æœç”¨ã€ä¸å½±å“è¢«åŒ…è£¹ç»„ä»¶çš„å†…éƒ¨é€»è¾‘ã€‚</li><li>ç¼ºç‚¹ âˆ¶ hoc ä¼ é€’ç»™è¢«åŒ…è£¹ç»„ä»¶çš„ props å®¹æ˜“å’Œè¢«åŒ…è£¹åçš„ç»„ä»¶é‡åï¼Œè¿›è€Œè¢«è¦†ç›–</li></ul><p><strong>ï¼ˆ2ï¼‰Render props</strong><br>å®˜æ–¹è§£é‡Š âˆ¶</p><blockquote><p>â€œrender propâ€æ˜¯æŒ‡ä¸€ç§åœ¨ React ç»„ä»¶ä¹‹é—´ä½¿ç”¨ä¸€ä¸ªå€¼ä¸ºå‡½æ•°çš„ prop å…±äº«ä»£ç çš„ç®€å•æŠ€æœ¯</p></blockquote><p>å…·æœ‰ render prop çš„ç»„ä»¶æ¥å—ä¸€ä¸ªè¿”å› React å…ƒç´ çš„å‡½æ•°ï¼Œå°† render çš„æ¸²æŸ“é€»è¾‘æ³¨å…¥åˆ°ç»„ä»¶å†…éƒ¨ã€‚åœ¨è¿™é‡Œï¼Œâ€renderâ€çš„å‘½åå¯ä»¥æ˜¯ä»»ä½•å…¶ä»–æœ‰æ•ˆçš„æ ‡è¯†ç¬¦ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// DataProviderç»„ä»¶å†…éƒ¨çš„æ¸²æŸ“é€»è¾‘å¦‚ä¸‹</span><span class="token keyword">class</span> <span class="token class-name">DataProvider</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Components</span> <span class="token punctuation">{</span>  state <span class="token operator">=</span> <span class="token punctuation">{</span>    name<span class="token punctuation">:</span> <span class="token string">"Tom"</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>div<span class="token operator">></span>        <span class="token operator">&lt;</span>p<span class="token operator">></span>å…±äº«æ•°æ®ç»„ä»¶è‡ªå·±å†…éƒ¨çš„æ¸²æŸ“é€»è¾‘<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>        <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">)</span><span class="token punctuation">}</span>      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// è°ƒç”¨æ–¹å¼</span><span class="token operator">&lt;</span>DataProvider render<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">&lt;</span>h1<span class="token operator">></span>Hello <span class="token punctuation">{</span>data<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç”±æ­¤å¯ä»¥çœ‹åˆ°ï¼Œrender props çš„ä¼˜ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ âˆ¶</p><ul><li>ä¼˜ç‚¹ï¼šæ•°æ®å…±äº«ã€ä»£ç å¤ç”¨ï¼Œå°†ç»„ä»¶å†…çš„ state ä½œä¸º props ä¼ é€’ç»™è°ƒç”¨è€…ï¼Œå°†æ¸²æŸ“é€»è¾‘äº¤ç»™è°ƒç”¨è€…ã€‚</li><li>ç¼ºç‚¹ï¼šæ— æ³•åœ¨ return è¯­å¥å¤–è®¿é—®æ•°æ®ã€åµŒå¥—å†™æ³•ä¸å¤Ÿä¼˜é›…</li></ul><p><strong>ï¼ˆ3ï¼‰Hooks</strong><br>å®˜æ–¹è§£é‡Š âˆ¶</p><blockquote><p>Hook æ˜¯ React 16.8 çš„æ–°å¢ç‰¹æ€§ã€‚å®ƒå¯ä»¥è®©ä½ åœ¨ä¸ç¼–å†™ class çš„æƒ…å†µä¸‹ä½¿ç”¨ state ä»¥åŠå…¶ä»–çš„ React ç‰¹æ€§ã€‚é€šè¿‡è‡ªå®šä¹‰ hookï¼Œå¯ä»¥å¤ç”¨ä»£ç é€»è¾‘ã€‚</p></blockquote><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// è‡ªå®šä¹‰ä¸€ä¸ªè·å–è®¢é˜…æ•°æ®çš„hook</span><span class="token keyword">function</span> <span class="token function">useSubscription</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> data <span class="token operator">=</span> DataSource<span class="token punctuation">.</span><span class="token function">getComments</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token punctuation">[</span>data<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//</span><span class="token keyword">function</span> <span class="token function">CommentList</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> <span class="token punctuation">{</span>data<span class="token punctuation">}</span> <span class="token operator">=</span> props<span class="token punctuation">;</span>  <span class="token keyword">const</span> <span class="token punctuation">[</span>subData<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useSubscription</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">...</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// ä½¿ç”¨</span><span class="token operator">&lt;</span>CommentList data<span class="token operator">=</span><span class="token string">'hello'</span> <span class="token operator">/</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»¥ä¸Šå¯ä»¥çœ‹å‡ºï¼Œhook è§£å†³äº† hoc çš„ prop è¦†ç›–çš„é—®é¢˜ï¼ŒåŒæ—¶ä½¿ç”¨çš„æ–¹å¼è§£å†³äº† render props çš„åµŒå¥—åœ°ç‹±çš„é—®é¢˜ã€‚hook çš„ä¼˜ç‚¹å¦‚ä¸‹ âˆ¶</p><ul><li>ä½¿ç”¨ç›´è§‚ï¼›</li><li>è§£å†³ hoc çš„ prop é‡åé—®é¢˜ï¼›</li><li>è§£å†³ render props å› å…±äº«æ•°æ® è€Œå‡ºç°åµŒå¥—åœ°ç‹±çš„é—®é¢˜ï¼›</li><li>èƒ½åœ¨ return ä¹‹å¤–ä½¿ç”¨æ•°æ®çš„é—®é¢˜ã€‚</li></ul><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šhook åªèƒ½åœ¨ç»„ä»¶é¡¶å±‚ä½¿ç”¨ï¼Œä¸å¯åœ¨åˆ†æ”¯è¯­å¥ä¸­ä½¿ç”¨ã€‚</p><p><strong>æ€»ç»“ âˆ¶</strong><br>Hocã€render props å’Œ hook éƒ½æ˜¯ä¸ºäº†è§£å†³ä»£ç å¤ç”¨çš„é—®é¢˜ï¼Œä½†æ˜¯ hoc å’Œ render props éƒ½æœ‰ç‰¹å®šçš„ä½¿ç”¨åœºæ™¯å’Œæ˜æ˜¾çš„ç¼ºç‚¹ã€‚hook æ˜¯ react16.8 æ›´æ–°çš„æ–°çš„ APIï¼Œè®©ç»„ä»¶é€»è¾‘å¤ç”¨æ›´ç®€æ´æ˜äº†ï¼ŒåŒæ—¶ä¹Ÿè§£å†³äº† hoc å’Œ render props çš„ä¸€äº›ç¼ºç‚¹ã€‚</p><h3 id="5-å¯¹-React-Fiber-çš„ç†è§£ï¼Œå®ƒè§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ"><a href="#5-å¯¹-React-Fiber-çš„ç†è§£ï¼Œå®ƒè§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ" class="headerlink" title="5. å¯¹ React-Fiber çš„ç†è§£ï¼Œå®ƒè§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ"></a>5. å¯¹ React-Fiber çš„ç†è§£ï¼Œå®ƒè§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ</h3><p>React V15 åœ¨æ¸²æŸ“æ—¶ï¼Œä¼šé€’å½’æ¯”å¯¹ VirtualDOM æ ‘ï¼Œæ‰¾å‡ºéœ€è¦å˜åŠ¨çš„èŠ‚ç‚¹ï¼Œç„¶ååŒæ­¥æ›´æ–°å®ƒä»¬ï¼Œ ä¸€æ°”å‘µæˆã€‚è¿™ä¸ªè¿‡ç¨‹æœŸé—´ï¼Œ React ä¼šå æ®æµè§ˆå™¨èµ„æºï¼Œè¿™ä¼šå¯¼è‡´ç”¨æˆ·è§¦å‘çš„äº‹ä»¶å¾—ä¸åˆ°å“åº”ï¼Œå¹¶ä¸”ä¼šå¯¼è‡´æ‰å¸§ï¼Œ<strong>å¯¼è‡´ç”¨æˆ·æ„Ÿè§‰åˆ°å¡é¡¿</strong>ã€‚</p><p>ä¸ºäº†ç»™ç”¨æˆ·åˆ¶é€ ä¸€ç§åº”ç”¨å¾ˆå¿«çš„â€œå‡è±¡â€ï¼Œä¸èƒ½è®©ä¸€ä¸ªä»»åŠ¡é•¿æœŸéœ¸å ç€èµ„æºã€‚ å¯ä»¥å°†æµè§ˆå™¨çš„æ¸²æŸ“ã€å¸ƒå±€ã€ç»˜åˆ¶ã€èµ„æºåŠ è½½(ä¾‹å¦‚ HTML è§£æ)ã€äº‹ä»¶å“åº”ã€è„šæœ¬æ‰§è¡Œè§†ä½œæ“ä½œç³»ç»Ÿçš„â€œè¿›ç¨‹â€ï¼Œéœ€è¦é€šè¿‡æŸäº›è°ƒåº¦ç­–ç•¥åˆç†åœ°åˆ†é… CPU èµ„æºï¼Œä»è€Œæé«˜æµè§ˆå™¨çš„ç”¨æˆ·å“åº”é€Ÿç‡, åŒæ—¶å…¼é¡¾ä»»åŠ¡æ‰§è¡Œæ•ˆç‡ã€‚</p><p>æ‰€ä»¥ React é€šè¿‡ Fiber æ¶æ„ï¼Œè®©è¿™ä¸ªæ‰§è¡Œè¿‡ç¨‹å˜æˆå¯è¢«ä¸­æ–­ã€‚â€œé€‚æ—¶â€åœ°è®©å‡º CPU æ‰§è¡Œæƒï¼Œé™¤äº†å¯ä»¥è®©æµè§ˆå™¨åŠæ—¶åœ°å“åº”ç”¨æˆ·çš„äº¤äº’ï¼Œè¿˜æœ‰å…¶ä»–å¥½å¤„:</p><ul><li>åˆ†æ‰¹å»¶æ—¶å¯¹ DOM è¿›è¡Œæ“ä½œï¼Œé¿å…ä¸€æ¬¡æ€§æ“ä½œå¤§é‡ DOM èŠ‚ç‚¹ï¼Œå¯ä»¥å¾—åˆ°æ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼›</li><li>ç»™æµè§ˆå™¨ä¸€ç‚¹å–˜æ¯çš„æœºä¼šï¼Œå®ƒä¼šå¯¹ä»£ç è¿›è¡Œç¼–è¯‘ä¼˜åŒ–ï¼ˆJITï¼‰åŠè¿›è¡Œçƒ­ä»£ç ä¼˜åŒ–ï¼Œæˆ–è€…å¯¹ reflow è¿›è¡Œä¿®æ­£ã€‚</li></ul><p><strong>æ ¸å¿ƒæ€æƒ³:</strong> Fiber ä¹Ÿç§°åç¨‹æˆ–è€…çº¤ç¨‹ã€‚å®ƒå’Œçº¿ç¨‹å¹¶ä¸ä¸€æ ·ï¼Œåç¨‹æœ¬èº«æ˜¯æ²¡æœ‰å¹¶å‘æˆ–è€…å¹¶è¡Œèƒ½åŠ›çš„ï¼ˆéœ€è¦é…åˆçº¿ç¨‹ï¼‰ï¼Œå®ƒåªæ˜¯ä¸€ç§æ§åˆ¶æµç¨‹çš„è®©å‡ºæœºåˆ¶ã€‚è®©å‡º CPU çš„æ‰§è¡Œæƒï¼Œè®© CPU èƒ½åœ¨è¿™æ®µæ—¶é—´æ‰§è¡Œå…¶ä»–çš„æ“ä½œã€‚æ¸²æŸ“çš„è¿‡ç¨‹å¯ä»¥è¢«ä¸­æ–­ï¼Œå¯ä»¥å°†æ§åˆ¶æƒäº¤å›æµè§ˆå™¨ï¼Œè®©ä½ç»™é«˜ä¼˜å…ˆçº§çš„ä»»åŠ¡ï¼Œæµè§ˆå™¨ç©ºé—²åå†æ¢å¤æ¸²æŸ“ã€‚</p><h3 id="6-React-Component-å’Œ-React-PureComponent-çš„åŒºåˆ«"><a href="#6-React-Component-å’Œ-React-PureComponent-çš„åŒºåˆ«" class="headerlink" title="6. React.Component å’Œ React.PureComponent çš„åŒºåˆ«"></a>6. React.Component å’Œ React.PureComponent çš„åŒºåˆ«</h3><p>PureComponent è¡¨ç¤ºä¸€ä¸ªçº¯ç»„ä»¶ï¼Œå¯ä»¥ç”¨æ¥ä¼˜åŒ– React ç¨‹åºï¼Œå‡å°‘ render å‡½æ•°æ‰§è¡Œçš„æ¬¡æ•°ï¼Œä»è€Œæé«˜ç»„ä»¶çš„æ€§èƒ½ã€‚</p><p>åœ¨ React ä¸­ï¼Œå½“ prop æˆ–è€… state å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¯ä»¥é€šè¿‡åœ¨ shouldComponentUpdate ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸­æ‰§è¡Œ return false æ¥é˜»æ­¢é¡µé¢çš„æ›´æ–°ï¼Œä»è€Œå‡å°‘ä¸å¿…è¦çš„ render æ‰§è¡Œã€‚React.PureComponent ä¼šè‡ªåŠ¨æ‰§è¡Œ  shouldComponentUpdateã€‚</p><p>ä¸è¿‡ï¼ŒpureComponent ä¸­çš„ shouldComponentUpdate()  è¿›è¡Œçš„æ˜¯<strong>æµ…æ¯”è¾ƒ</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœæ˜¯å¼•ç”¨æ•°æ®ç±»å‹çš„æ•°æ®ï¼Œåªä¼šæ¯”è¾ƒä¸æ˜¯åŒä¸€ä¸ªåœ°å€ï¼Œè€Œä¸ä¼šæ¯”è¾ƒè¿™ä¸ªåœ°å€é‡Œé¢çš„æ•°æ®æ˜¯å¦ä¸€è‡´ã€‚æµ…æ¯”è¾ƒä¼šå¿½ç•¥å±æ€§å’Œæˆ–çŠ¶æ€çªå˜æƒ…å†µï¼Œå…¶å®ä¹Ÿå°±æ˜¯æ•°æ®å¼•ç”¨æŒ‡é’ˆæ²¡æœ‰å˜åŒ–ï¼Œè€Œæ•°æ®å‘ç”Ÿæ”¹å˜çš„æ—¶å€™ render æ˜¯ä¸ä¼šæ‰§è¡Œçš„ã€‚å¦‚æœéœ€è¦é‡æ–°æ¸²æŸ“é‚£ä¹ˆå°±éœ€è¦é‡æ–°å¼€è¾Ÿç©ºé—´å¼•ç”¨æ•°æ®ã€‚PureComponent ä¸€èˆ¬ä¼šç”¨åœ¨ä¸€äº›çº¯å±•ç¤ºç»„ä»¶ä¸Šã€‚</p><p>ä½¿ç”¨ pureComponent çš„<strong>å¥½å¤„</strong>ï¼šå½“ç»„ä»¶æ›´æ–°æ—¶ï¼Œå¦‚æœç»„ä»¶çš„ props æˆ–è€… state éƒ½æ²¡æœ‰æ”¹å˜ï¼Œrender å‡½æ•°å°±ä¸ä¼šè§¦å‘ã€‚çœå»è™šæ‹Ÿ DOM çš„ç”Ÿæˆå’Œå¯¹æ¯”è¿‡ç¨‹ï¼Œè¾¾åˆ°æå‡æ€§èƒ½çš„ç›®çš„ã€‚è¿™æ˜¯å› ä¸º react è‡ªåŠ¨åšäº†ä¸€å±‚æµ…æ¯”è¾ƒã€‚</p><h3 id="7-Component-Element-Instance-ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«å’Œè”ç³»ï¼Ÿ"><a href="#7-Component-Element-Instance-ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«å’Œè”ç³»ï¼Ÿ" class="headerlink" title="7. Component, Element, Instance ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«å’Œè”ç³»ï¼Ÿ"></a>7. Component, Element, Instance ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«å’Œè”ç³»ï¼Ÿ</h3><ul><li><strong>å…ƒç´ ï¼š</strong> ä¸€ä¸ªå…ƒç´ <code>element</code>æ˜¯ä¸€ä¸ªæ™®é€šå¯¹è±¡(plain object)ï¼Œæè¿°äº†å¯¹äºä¸€ä¸ª DOM èŠ‚ç‚¹æˆ–è€…å…¶ä»–ç»„ä»¶<code>component</code>ï¼Œä½ æƒ³è®©å®ƒåœ¨å±å¹•ä¸Šå‘ˆç°æˆä»€ä¹ˆæ ·å­ã€‚å…ƒç´ <code>element</code>å¯ä»¥åœ¨å®ƒçš„å±æ€§<code>props</code>ä¸­åŒ…å«å…¶ä»–å…ƒç´ (è¯‘æ³¨:ç”¨äºå½¢æˆå…ƒç´ æ ‘)ã€‚åˆ›å»ºä¸€ä¸ª React å…ƒç´ <code>element</code>æˆæœ¬å¾ˆä½ã€‚å…ƒç´ <code>element</code>åˆ›å»ºä¹‹åæ˜¯ä¸å¯å˜çš„ã€‚</li><li><strong>ç»„ä»¶ï¼š</strong> ä¸€ä¸ªç»„ä»¶<code>component</code>å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼å£°æ˜ã€‚å¯ä»¥æ˜¯å¸¦æœ‰ä¸€ä¸ª<code>render()</code>æ–¹æ³•çš„ç±»ï¼Œç®€å•ç‚¹ä¹Ÿå¯ä»¥å®šä¹‰ä¸ºä¸€ä¸ªå‡½æ•°ã€‚è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œå®ƒéƒ½æŠŠå±æ€§<code>props</code>ä½œä¸ºè¾“å…¥ï¼ŒæŠŠè¿”å›çš„ä¸€æ£µå…ƒç´ æ ‘ä½œä¸ºè¾“å‡ºã€‚</li><li><strong>å®ä¾‹ï¼š</strong> ä¸€ä¸ªå®ä¾‹<code>instance</code>æ˜¯ä½ åœ¨æ‰€å†™çš„ç»„ä»¶ç±»<code>component class</code>ä¸­ä½¿ç”¨å…³é”®å­—<code>this</code>æ‰€æŒ‡å‘çš„ä¸œè¥¿(è¯‘æ³¨:ç»„ä»¶å®ä¾‹)ã€‚å®ƒç”¨æ¥å­˜å‚¨æœ¬åœ°çŠ¶æ€å’Œå“åº”ç”Ÿå‘½å‘¨æœŸäº‹ä»¶å¾ˆæœ‰ç”¨ã€‚</li></ul><p>å‡½æ•°å¼ç»„ä»¶(<code>Functional component</code>)æ ¹æœ¬æ²¡æœ‰å®ä¾‹<code>instance</code>ã€‚ç±»ç»„ä»¶(<code>Class component</code>)æœ‰å®ä¾‹<code>instance</code>ï¼Œä½†æ˜¯æ°¸è¿œä¹Ÿä¸éœ€è¦ç›´æ¥åˆ›å»ºä¸€ä¸ªç»„ä»¶çš„å®ä¾‹ï¼Œå› ä¸º React å¸®æˆ‘ä»¬åšäº†è¿™äº›ã€‚</p><h3 id="8-React-createClass-å’Œ-extends-Component-çš„åŒºåˆ«æœ‰å“ªäº›ï¼Ÿ"><a href="#8-React-createClass-å’Œ-extends-Component-çš„åŒºåˆ«æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="8. React.createClass å’Œ extends Component çš„åŒºåˆ«æœ‰å“ªäº›ï¼Ÿ"></a>8. React.createClass å’Œ extends Component çš„åŒºåˆ«æœ‰å“ªäº›ï¼Ÿ</h3><p>React.createClass å’Œ extends Component çš„ bai åŒºåˆ«ä¸»è¦åœ¨äºï¼š</p><p><strong>ï¼ˆ1ï¼‰è¯­æ³•åŒºåˆ«</strong></p><ul><li>createClass æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå·¥å‚å‡½æ•°ï¼Œextends çš„æ–¹å¼æ›´åŠ æ¥è¿‘æœ€æ–°çš„ ES6 è§„èŒƒçš„ class å†™æ³•ã€‚ä¸¤ç§æ–¹å¼åœ¨è¯­æ³•ä¸Šçš„å·®åˆ«ä¸»è¦ä½“ç°åœ¨æ–¹æ³•çš„å®šä¹‰å’Œé™æ€å±æ€§çš„å£°æ˜ä¸Šã€‚</li><li>createClass æ–¹å¼çš„æ–¹æ³•å®šä¹‰ä½¿ç”¨é€—å·ï¼Œéš”å¼€ï¼Œå› ä¸º creatClass æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¼ é€’ç»™å®ƒçš„æ˜¯ä¸€ä¸ª Objectï¼›è€Œ class çš„æ–¹å¼å®šä¹‰æ–¹æ³•æ—¶åŠ¡å¿…è°¨è®°ä¸è¦ä½¿ç”¨é€—å·éš”å¼€ï¼Œè¿™æ˜¯ ES6 class çš„è¯­æ³•è§„èŒƒã€‚</li></ul><p><strong>ï¼ˆ2ï¼‰propType å’Œ getDefaultProps</strong></p><ul><li>React.createClassï¼šé€šè¿‡ proTypes å¯¹è±¡å’Œ getDefaultProps()æ–¹æ³•æ¥è®¾ç½®å’Œè·å– props.</li><li>React.Componentï¼šé€šè¿‡è®¾ç½®ä¸¤ä¸ªå±æ€§ propTypes å’Œ defaultProps</li></ul><p><strong>ï¼ˆ3ï¼‰çŠ¶æ€çš„åŒºåˆ«</strong></p><ul><li>React.createClassï¼šé€šè¿‡ getInitialState()æ–¹æ³•è¿”å›ä¸€ä¸ªåŒ…å«åˆå§‹å€¼çš„å¯¹è±¡</li><li>React.Componentï¼šé€šè¿‡ constructor è®¾ç½®åˆå§‹çŠ¶æ€</li></ul><p><strong>ï¼ˆ4ï¼‰this åŒºåˆ«</strong></p><ul><li>React.createClassï¼šä¼šæ­£ç¡®ç»‘å®š this</li><li>React.Componentï¼šç”±äºä½¿ç”¨äº† ES6ï¼Œè¿™é‡Œä¼šæœ‰äº›å¾®ä¸åŒï¼Œå±æ€§å¹¶ä¸ä¼šè‡ªåŠ¨ç»‘å®šåˆ° React ç±»çš„å®ä¾‹ä¸Šã€‚</li></ul><p><strong>ï¼ˆ5ï¼‰Mixins</strong></p><ul><li>React.createClassï¼šä½¿ç”¨ React.createClass çš„è¯ï¼Œå¯ä»¥åœ¨åˆ›å»ºç»„ä»¶æ—¶æ·»åŠ ä¸€ä¸ªå«åš mixins çš„å±æ€§ï¼Œå¹¶å°†å¯ä¾›æ··åˆçš„ç±»çš„é›†åˆä»¥æ•°ç»„çš„å½¢å¼èµ‹ç»™ mixinsã€‚</li><li>å¦‚æœä½¿ç”¨ ES6 çš„æ–¹å¼æ¥åˆ›å»ºç»„ä»¶ï¼Œé‚£ä¹ˆ <code>React mixins</code> çš„ç‰¹æ€§å°†ä¸èƒ½è¢«ä½¿ç”¨äº†ã€‚</li></ul><h3 id="9-React-é«˜é˜¶ç»„ä»¶æ˜¯ä»€ä¹ˆï¼Œå’Œæ™®é€šç»„ä»¶æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œé€‚ç”¨ä»€ä¹ˆåœºæ™¯"><a href="#9-React-é«˜é˜¶ç»„ä»¶æ˜¯ä»€ä¹ˆï¼Œå’Œæ™®é€šç»„ä»¶æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œé€‚ç”¨ä»€ä¹ˆåœºæ™¯" class="headerlink" title="9. React é«˜é˜¶ç»„ä»¶æ˜¯ä»€ä¹ˆï¼Œå’Œæ™®é€šç»„ä»¶æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œé€‚ç”¨ä»€ä¹ˆåœºæ™¯"></a>9. React é«˜é˜¶ç»„ä»¶æ˜¯ä»€ä¹ˆï¼Œå’Œæ™®é€šç»„ä»¶æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œé€‚ç”¨ä»€ä¹ˆåœºæ™¯</h3><p>å®˜æ–¹è§£é‡Š âˆ¶</p><blockquote><p>é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰æ˜¯ React ä¸­ç”¨äºå¤ç”¨ç»„ä»¶é€»è¾‘çš„ä¸€ç§é«˜çº§æŠ€å·§ã€‚HOC è‡ªèº«ä¸æ˜¯ React API çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒæ˜¯ä¸€ç§åŸºäº React çš„ç»„åˆç‰¹æ€§è€Œå½¢æˆçš„è®¾è®¡æ¨¡å¼ã€‚</p></blockquote><p>é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¸”è¯¥å‡½æ•°æ¥å—ä¸€ä¸ªç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„ç»„ä»¶ï¼Œå®ƒåªæ˜¯ä¸€ç§ç»„ä»¶çš„è®¾è®¡æ¨¡å¼ï¼Œè¿™ç§è®¾è®¡æ¨¡å¼æ˜¯ç”± react è‡ªèº«çš„ç»„åˆæ€§è´¨å¿…ç„¶äº§ç”Ÿçš„ã€‚æˆ‘ä»¬å°†å®ƒä»¬ç§°ä¸ºçº¯ç»„ä»¶ï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥æ¥å—ä»»ä½•åŠ¨æ€æä¾›çš„å­ç»„ä»¶ï¼Œä½†å®ƒä»¬ä¸ä¼šä¿®æ”¹æˆ–å¤åˆ¶å…¶è¾“å…¥ç»„ä»¶ä¸­çš„ä»»ä½•è¡Œä¸ºã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// hocçš„å®šä¹‰</span><span class="token keyword">function</span> <span class="token function">withSubscription</span><span class="token punctuation">(</span>WrappedComponent<span class="token punctuation">,</span> selectData<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> React<span class="token punctuation">.</span>Component <span class="token punctuation">{</span>    <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>        data<span class="token punctuation">:</span> <span class="token function">selectData</span><span class="token punctuation">(</span>DataSource<span class="token punctuation">,</span> props<span class="token punctuation">)</span>      <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// ä¸€äº›é€šç”¨çš„é€»è¾‘å¤„ç†</span>    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token comment" spellcheck="true">// ... å¹¶ä½¿ç”¨æ–°æ•°æ®æ¸²æŸ“è¢«åŒ…è£…çš„ç»„ä»¶!</span>      <span class="token keyword">return</span> <span class="token operator">&lt;</span>WrappedComponent data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>data<span class="token punctuation">}</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// ä½¿ç”¨</span><span class="token keyword">const</span> BlogPostWithSubscription <span class="token operator">=</span> <span class="token function">withSubscription</span><span class="token punctuation">(</span>BlogPost<span class="token punctuation">,</span>  <span class="token punctuation">(</span>DataSource<span class="token punctuation">,</span> props<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> DataSource<span class="token punctuation">.</span><span class="token function">getBlogPost</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>1ï¼‰HOC çš„ä¼˜ç¼ºç‚¹</strong></p><ul><li>ä¼˜ç‚¹ âˆ¶ é€»è¾‘æœç”¨ã€ä¸å½±å“è¢«åŒ…è£¹ç»„ä»¶çš„å†…éƒ¨é€»è¾‘ã€‚</li><li>ç¼ºç‚¹ âˆ¶hoc ä¼ é€’ç»™è¢«åŒ…è£¹ç»„ä»¶çš„ props å®¹æ˜“å’Œè¢«åŒ…è£¹åçš„ç»„ä»¶é‡åï¼Œè¿›è€Œè¢«è¦†ç›–</li></ul><p><strong>2ï¼‰é€‚ç”¨åœºæ™¯</strong></p><ul><li>ä»£ç å¤ç”¨ï¼Œé€»è¾‘æŠ½è±¡</li><li>æ¸²æŸ“åŠ«æŒ</li><li>State æŠ½è±¡å’Œæ›´æ”¹</li><li>Props æ›´æ”¹</li></ul><p><strong>3ï¼‰å…·ä½“åº”ç”¨ä¾‹å­</strong></p><ul><li><strong>æƒé™æ§åˆ¶ï¼š</strong> åˆ©ç”¨é«˜é˜¶ç»„ä»¶çš„ <strong>æ¡ä»¶æ¸²æŸ“</strong> ç‰¹æ€§å¯ä»¥å¯¹é¡µé¢è¿›è¡Œæƒé™æ§åˆ¶ï¼Œæƒé™æ§åˆ¶ä¸€èˆ¬åˆ†ä¸ºä¸¤ä¸ªç»´åº¦ï¼šé¡µé¢çº§åˆ«å’Œ é¡µé¢å…ƒç´ çº§åˆ«</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// HOC.js</span><span class="token keyword">function</span> <span class="token function">withAdminAuth</span><span class="token punctuation">(</span>WrappedComponent<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> React<span class="token punctuation">.</span>Component <span class="token punctuation">{</span>        state <span class="token operator">=</span> <span class="token punctuation">{</span>            isAdmin<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>        <span class="token punctuation">}</span>        <span class="token keyword">async</span> <span class="token function">UNSAFE_componentWillMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">const</span> currentRole <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getCurrentUserRole</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>                isAdmin<span class="token punctuation">:</span> currentRole <span class="token operator">===</span> <span class="token string">'Admin'</span><span class="token punctuation">,</span>            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>isAdmin<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">return</span> <span class="token operator">&lt;</span>WrappedComponent <span class="token punctuation">{</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>div<span class="token operator">></span>æ‚¨æ²¡æœ‰æƒé™æŸ¥çœ‹è¯¥é¡µé¢ï¼Œè¯·è”ç³»ç®¡ç†å‘˜ï¼<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// pages/page-a.js</span><span class="token keyword">class</span> <span class="token class-name">PageA</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>    <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// something here...</span>    <span class="token punctuation">}</span>    <span class="token function">UNSAFE_componentWillMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// fetching data</span>    <span class="token punctuation">}</span>    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// render page with data</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">withAdminAuth</span><span class="token punctuation">(</span>PageA<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// pages/page-b.js</span><span class="token keyword">class</span> <span class="token class-name">PageB</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>    <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// something here...</span>        <span class="token punctuation">}</span>    <span class="token function">UNSAFE_componentWillMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// fetching data</span>    <span class="token punctuation">}</span>    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// render page with data</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">withAdminAuth</span><span class="token punctuation">(</span>PageB<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>ç»„ä»¶æ¸²æŸ“æ€§èƒ½è¿½è¸ªï¼š</strong> å€ŸåŠ©çˆ¶ç»„ä»¶å­ç»„ä»¶ç”Ÿå‘½å‘¨æœŸè§„åˆ™æ•è·å­ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼Œå¯ä»¥æ–¹ä¾¿çš„å¯¹æŸä¸ªç»„ä»¶çš„æ¸²æŸ“æ—¶é—´è¿›è¡Œè®°å½• âˆ¶</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">Home</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token operator">&lt;</span>h1<span class="token operator">></span>Hello World<span class="token punctuation">.</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">withTiming</span><span class="token punctuation">(</span>WrappedComponent<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> WrappedComponent <span class="token punctuation">{</span>    <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>start <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>end <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">UNSAFE_componentWillMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">super</span><span class="token punctuation">.</span>componentWillMount <span class="token operator">&amp;&amp;</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">componentWillMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>start <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">super</span><span class="token punctuation">.</span>componentDidMount <span class="token operator">&amp;&amp;</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>end <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>        <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>WrappedComponent<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> ç»„ä»¶æ¸²æŸ“æ—¶é—´ä¸º </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>end <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span>start<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> ms`</span></span>      <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">withTiming</span><span class="token punctuation">(</span>Home<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨æ„ï¼šwithTiming æ˜¯åˆ©ç”¨ åå‘ç»§æ‰¿ å®ç°çš„ä¸€ä¸ªé«˜é˜¶ç»„ä»¶ï¼ŒåŠŸèƒ½æ˜¯è®¡ç®—è¢«åŒ…è£¹ç»„ä»¶ï¼ˆè¿™é‡Œæ˜¯ Home ç»„ä»¶ï¼‰çš„æ¸²æŸ“æ—¶é—´ã€‚</p><ul><li><strong>é¡µé¢å¤ç”¨</strong></li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> withFetching <span class="token operator">=</span> fetching <span class="token operator">=</span><span class="token operator">></span> WrappedComponent <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> React<span class="token punctuation">.</span>Component <span class="token punctuation">{</span>        state <span class="token operator">=</span> <span class="token punctuation">{</span>            data<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">}</span>        <span class="token keyword">async</span> <span class="token function">UNSAFE_componentWillMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetching</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>                data<span class="token punctuation">,</span>            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">return</span> <span class="token operator">&lt;</span>WrappedComponent data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>data<span class="token punctuation">}</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// pages/page-a.js</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">withFetching</span><span class="token punctuation">(</span><span class="token function">fetching</span><span class="token punctuation">(</span><span class="token string">'science-fiction'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span>MovieList<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// pages/page-b.js</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">withFetching</span><span class="token punctuation">(</span><span class="token function">fetching</span><span class="token punctuation">(</span><span class="token string">'action'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span>MovieList<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// pages/page-other.js</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">withFetching</span><span class="token punctuation">(</span><span class="token function">fetching</span><span class="token punctuation">(</span><span class="token string">'some-other-type'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span>MovieList<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="10-å¯¹-componentWillReceiveProps-çš„ç†è§£"><a href="#10-å¯¹-componentWillReceiveProps-çš„ç†è§£" class="headerlink" title="10. å¯¹ componentWillReceiveProps çš„ç†è§£"></a>10. å¯¹ componentWillReceiveProps çš„ç†è§£</h3><p>è¯¥æ–¹æ³•å½“<code>props</code>å‘ç”Ÿå˜åŒ–æ—¶æ‰§è¡Œï¼Œåˆå§‹åŒ–<code>render</code>æ—¶ä¸æ‰§è¡Œï¼Œåœ¨è¿™ä¸ªå›è°ƒå‡½æ•°é‡Œé¢ï¼Œä½ å¯ä»¥æ ¹æ®å±æ€§çš„å˜åŒ–ï¼Œé€šè¿‡è°ƒç”¨<code>this.setState()</code>æ¥æ›´æ–°ä½ çš„ç»„ä»¶çŠ¶æ€ï¼Œæ—§çš„å±æ€§è¿˜æ˜¯å¯ä»¥é€šè¿‡<code>this.props</code>æ¥è·å–,è¿™é‡Œè°ƒç”¨æ›´æ–°çŠ¶æ€æ˜¯å®‰å…¨çš„ï¼Œå¹¶ä¸ä¼šè§¦å‘é¢å¤–çš„<code>render</code>è°ƒç”¨ã€‚</p><p><strong>ä½¿ç”¨å¥½å¤„ï¼š</strong> åœ¨è¿™ä¸ªç”Ÿå‘½å‘¨æœŸä¸­ï¼Œå¯ä»¥åœ¨å­ç»„ä»¶çš„ render å‡½æ•°æ‰§è¡Œå‰è·å–æ–°çš„ propsï¼Œä»è€Œæ›´æ–°å­ç»„ä»¶è‡ªå·±çš„ stateã€‚  å¯ä»¥å°†æ•°æ®è¯·æ±‚æ”¾åœ¨è¿™é‡Œè¿›è¡Œæ‰§è¡Œï¼Œéœ€è¦ä¼ çš„å‚æ•°åˆ™ä» componentWillReceiveProps(nextProps)ä¸­è·å–ã€‚è€Œä¸å¿…å°†æ‰€æœ‰çš„è¯·æ±‚éƒ½æ”¾åœ¨çˆ¶ç»„ä»¶ä¸­ã€‚äºæ˜¯è¯¥è¯·æ±‚åªä¼šåœ¨è¯¥ç»„ä»¶æ¸²æŸ“æ—¶æ‰ä¼šå‘å‡ºï¼Œä»è€Œå‡è½»è¯·æ±‚è´Ÿæ‹…ã€‚</p><p>componentWillReceiveProps åœ¨åˆå§‹åŒ– render çš„æ—¶å€™ä¸ä¼šæ‰§è¡Œï¼Œå®ƒä¼šåœ¨ Component æ¥å—åˆ°æ–°çš„çŠ¶æ€(Props)æ—¶è¢«è§¦å‘ï¼Œä¸€èˆ¬ç”¨äºçˆ¶ç»„ä»¶çŠ¶æ€æ›´æ–°æ—¶å­ç»„ä»¶çš„é‡æ–°æ¸²æŸ“ã€‚</p><h3 id="11-å“ªäº›æ–¹æ³•ä¼šè§¦å‘-React-é‡æ–°æ¸²æŸ“ï¼Ÿé‡æ–°æ¸²æŸ“-render-ä¼šåšäº›ä»€ä¹ˆï¼Ÿ"><a href="#11-å“ªäº›æ–¹æ³•ä¼šè§¦å‘-React-é‡æ–°æ¸²æŸ“ï¼Ÿé‡æ–°æ¸²æŸ“-render-ä¼šåšäº›ä»€ä¹ˆï¼Ÿ" class="headerlink" title="11. å“ªäº›æ–¹æ³•ä¼šè§¦å‘ React é‡æ–°æ¸²æŸ“ï¼Ÿé‡æ–°æ¸²æŸ“ render ä¼šåšäº›ä»€ä¹ˆï¼Ÿ"></a>11. å“ªäº›æ–¹æ³•ä¼šè§¦å‘ React é‡æ–°æ¸²æŸ“ï¼Ÿé‡æ–°æ¸²æŸ“ render ä¼šåšäº›ä»€ä¹ˆï¼Ÿ</h3><p><strong>ï¼ˆ1ï¼‰å“ªäº›æ–¹æ³•ä¼šè§¦å‘ react é‡æ–°æ¸²æŸ“?</strong></p><ul><li><strong>setStateï¼ˆï¼‰æ–¹æ³•è¢«è°ƒç”¨</strong></li></ul><p>setState æ˜¯ React ä¸­æœ€å¸¸ç”¨çš„å‘½ä»¤ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œæ‰§è¡Œ setState ä¼šè§¦å‘ renderã€‚ä½†æ˜¯è¿™é‡Œæœ‰ä¸ªç‚¹å€¼å¾—å…³æ³¨ï¼Œæ‰§è¡Œ setState çš„æ—¶å€™ä¸ä¸€å®šä¼šé‡æ–°æ¸²æŸ“ã€‚å½“ setState ä¼ å…¥ null æ—¶ï¼Œå¹¶ä¸ä¼šè§¦å‘ renderã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  state <span class="token operator">=</span> <span class="token punctuation">{</span>    a<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"render"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>React<span class="token punctuation">.</span>Fragement<span class="token operator">></span>        <span class="token operator">&lt;</span>p<span class="token operator">></span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>a<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>        <span class="token operator">&lt;</span>button          onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> a<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// è¿™é‡Œå¹¶æ²¡æœ‰æ”¹å˜ a çš„å€¼</span>          <span class="token punctuation">}</span><span class="token punctuation">}</span>        <span class="token operator">></span>          Click me        <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span>        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span>setState <span class="token keyword">null</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span>        <span class="token operator">&lt;</span>Child <span class="token operator">/</span><span class="token operator">></span>      <span class="token operator">&lt;</span><span class="token operator">/</span>React<span class="token punctuation">.</span>Fragement<span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>çˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“</strong></li></ul><p>åªè¦çˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“äº†ï¼Œå³ä½¿ä¼ å…¥å­ç»„ä»¶çš„ props æœªå‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆå­ç»„ä»¶ä¹Ÿä¼šé‡æ–°æ¸²æŸ“ï¼Œè¿›è€Œè§¦å‘ render</p><p><strong>ï¼ˆ2ï¼‰é‡æ–°æ¸²æŸ“ render ä¼šåšäº›ä»€ä¹ˆ?</strong></p><ul><li>ä¼šå¯¹æ–°æ—§ VNode è¿›è¡Œå¯¹æ¯”ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„ Diff ç®—æ³•ã€‚</li><li>å¯¹æ–°æ—§ä¸¤æ£µæ ‘è¿›è¡Œä¸€ä¸ªæ·±åº¦ä¼˜å…ˆéå†ï¼Œè¿™æ ·æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½ä¼šä¸€ä¸ªæ ‡è®°ï¼Œåœ¨åˆ°æ·±åº¦éå†çš„æ—¶å€™ï¼Œæ¯éå†åˆ°ä¸€å’Œä¸ªèŠ‚ç‚¹ï¼Œå°±æŠŠè¯¥èŠ‚ç‚¹å’Œæ–°çš„èŠ‚ç‚¹æ ‘è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æœæœ‰å·®å¼‚å°±æ”¾åˆ°ä¸€ä¸ªå¯¹è±¡é‡Œé¢</li><li>éå†å·®å¼‚å¯¹è±¡ï¼Œæ ¹æ®å·®å¼‚çš„ç±»å‹ï¼Œæ ¹æ®å¯¹åº”å¯¹è§„åˆ™æ›´æ–° VNode</li></ul><p>React çš„å¤„ç† render çš„åŸºæœ¬æ€ç»´æ¨¡å¼æ˜¯æ¯æ¬¡ä¸€æœ‰å˜åŠ¨å°±ä¼šå»é‡æ–°æ¸²æŸ“æ•´ä¸ªåº”ç”¨ã€‚åœ¨ Virtual DOM æ²¡æœ‰å‡ºç°ä¹‹å‰ï¼Œæœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯ç›´æ¥è°ƒç”¨ innerHTMLã€‚Virtual DOM å‰å®³çš„åœ°æ–¹å¹¶ä¸æ˜¯è¯´å®ƒæ¯”ç›´æ¥æ“ä½œ DOM å¿«ï¼Œè€Œæ˜¯è¯´ä¸ç®¡æ•°æ®æ€ä¹ˆå˜ï¼Œéƒ½ä¼šå°½é‡ä»¥æœ€å°çš„ä»£ä»·å»æ›´æ–° DOMã€‚React å°† render å‡½æ•°è¿”å›çš„è™šæ‹Ÿ DOM æ ‘ä¸è€çš„è¿›è¡Œæ¯”è¾ƒï¼Œä»è€Œç¡®å®š DOM è¦ä¸è¦æ›´æ–°ã€æ€ä¹ˆæ›´æ–°ã€‚å½“ DOM æ ‘å¾ˆå¤§æ—¶ï¼Œéå†ä¸¤æ£µæ ‘è¿›è¡Œå„ç§æ¯”å¯¹è¿˜æ˜¯ç›¸å½“è€—æ€§èƒ½çš„ï¼Œç‰¹åˆ«æ˜¯åœ¨é¡¶å±‚ setState ä¸€ä¸ªå¾®å°çš„ä¿®æ”¹ï¼Œé»˜è®¤ä¼šå»éå†æ•´æ£µæ ‘ã€‚å°½ç®¡ React ä½¿ç”¨é«˜åº¦ä¼˜åŒ–çš„ Diff ç®—æ³•ï¼Œä½†æ˜¯è¿™ä¸ªè¿‡ç¨‹ä»ç„¶ä¼šæŸè€—æ€§èƒ½.</p><h3 id="12-React-å¦‚ä½•åˆ¤æ–­ä»€ä¹ˆæ—¶å€™é‡æ–°æ¸²æŸ“ç»„ä»¶ï¼Ÿ"><a href="#12-React-å¦‚ä½•åˆ¤æ–­ä»€ä¹ˆæ—¶å€™é‡æ–°æ¸²æŸ“ç»„ä»¶ï¼Ÿ" class="headerlink" title="12. React å¦‚ä½•åˆ¤æ–­ä»€ä¹ˆæ—¶å€™é‡æ–°æ¸²æŸ“ç»„ä»¶ï¼Ÿ"></a>12. React å¦‚ä½•åˆ¤æ–­ä»€ä¹ˆæ—¶å€™é‡æ–°æ¸²æŸ“ç»„ä»¶ï¼Ÿ</h3><p>ç»„ä»¶çŠ¶æ€çš„æ”¹å˜å¯ä»¥å› ä¸º<code>props</code>çš„æ”¹å˜ï¼Œæˆ–è€…ç›´æ¥é€šè¿‡<code>setState</code>æ–¹æ³•æ”¹å˜ã€‚ç»„ä»¶è·å¾—æ–°çš„çŠ¶æ€ï¼Œç„¶å React å†³å®šæ˜¯å¦åº”è¯¥é‡æ–°æ¸²æŸ“ç»„ä»¶ã€‚åªè¦ç»„ä»¶çš„ state å‘ç”Ÿå˜åŒ–ï¼ŒReact å°±ä¼šå¯¹ç»„ä»¶è¿›è¡Œé‡æ–°æ¸²æŸ“ã€‚è¿™æ˜¯å› ä¸º React ä¸­çš„<code>shouldComponentUpdate</code>æ–¹æ³•é»˜è®¤è¿”å›<code>true</code>ï¼Œè¿™å°±æ˜¯å¯¼è‡´æ¯æ¬¡æ›´æ–°éƒ½é‡æ–°æ¸²æŸ“çš„åŸå› ã€‚</p><p>å½“ React å°†è¦æ¸²æŸ“ç»„ä»¶æ—¶ä¼šæ‰§è¡Œ<code>shouldComponentUpdate</code>æ–¹æ³•æ¥çœ‹å®ƒæ˜¯å¦è¿”å›<code>true</code>ï¼ˆç»„ä»¶åº”è¯¥æ›´æ–°ï¼Œä¹Ÿå°±æ˜¯é‡æ–°æ¸²æŸ“ï¼‰ã€‚æ‰€ä»¥éœ€è¦é‡å†™<code>shouldComponentUpdate</code>æ–¹æ³•è®©å®ƒæ ¹æ®æƒ…å†µè¿”å›<code>true</code>æˆ–è€…<code>false</code>æ¥å‘Šè¯‰ React ä»€ä¹ˆæ—¶å€™é‡æ–°æ¸²æŸ“ä»€ä¹ˆæ—¶å€™è·³è¿‡é‡æ–°æ¸²æŸ“ã€‚</p><h3 id="13-React-å£°æ˜ç»„ä»¶æœ‰å“ªå‡ ç§æ–¹æ³•ï¼Œæœ‰ä»€ä¹ˆä¸åŒï¼Ÿ"><a href="#13-React-å£°æ˜ç»„ä»¶æœ‰å“ªå‡ ç§æ–¹æ³•ï¼Œæœ‰ä»€ä¹ˆä¸åŒï¼Ÿ" class="headerlink" title="13. React å£°æ˜ç»„ä»¶æœ‰å“ªå‡ ç§æ–¹æ³•ï¼Œæœ‰ä»€ä¹ˆä¸åŒï¼Ÿ"></a>13. React å£°æ˜ç»„ä»¶æœ‰å“ªå‡ ç§æ–¹æ³•ï¼Œæœ‰ä»€ä¹ˆä¸åŒï¼Ÿ</h3><p>React å£°æ˜ç»„ä»¶çš„ä¸‰ç§æ–¹å¼ï¼š</p><ul><li>å‡½æ•°å¼å®šä¹‰çš„<code>æ— çŠ¶æ€ç»„ä»¶</code></li><li>ES5 åŸç”Ÿæ–¹å¼<code>React.createClass</code>å®šä¹‰çš„ç»„ä»¶</li><li>ES6 å½¢å¼çš„<code>extends React.Component</code>å®šä¹‰çš„ç»„ä»¶</li></ul><p><strong>ï¼ˆ1ï¼‰æ— çŠ¶æ€å‡½æ•°å¼ç»„ä»¶</strong><br>å®ƒæ˜¯ä¸ºäº†åˆ›å»ºçº¯å±•ç¤ºç»„ä»¶ï¼Œè¿™ç§ç»„ä»¶åªè´Ÿè´£æ ¹æ®ä¼ å…¥çš„ props æ¥å±•ç¤ºï¼Œä¸æ¶‰åŠåˆ° state çŠ¶æ€çš„æ“ä½œ<br>ç»„ä»¶ä¸ä¼šè¢«å®ä¾‹åŒ–ï¼Œæ•´ä½“æ¸²æŸ“æ€§èƒ½å¾—åˆ°æå‡ï¼Œä¸èƒ½è®¿é—® this å¯¹è±¡ï¼Œä¸èƒ½è®¿é—®ç”Ÿå‘½å‘¨æœŸçš„æ–¹æ³•</p><p><strong>ï¼ˆ2ï¼‰ES5 åŸç”Ÿæ–¹å¼ React.createClass // RFC</strong><br>React.createClass ä¼šè‡ªç»‘å®šå‡½æ•°æ–¹æ³•ï¼Œå¯¼è‡´ä¸å¿…è¦çš„æ€§èƒ½å¼€é”€ï¼Œå¢åŠ ä»£ç è¿‡æ—¶çš„å¯èƒ½æ€§ã€‚</p><p><strong>ï¼ˆ3ï¼‰E6 ç»§æ‰¿å½¢å¼ React.Component // RCC</strong><br>ç›®å‰æä¸ºæ¨èçš„åˆ›å»ºæœ‰çŠ¶æ€ç»„ä»¶çš„æ–¹å¼ï¼Œæœ€ç»ˆä¼šå–ä»£ React.createClass å½¢å¼ï¼›ç›¸å¯¹äº React.createClass å¯ä»¥æ›´å¥½å®ç°ä»£ç å¤ç”¨ã€‚</p><p><strong>æ— çŠ¶æ€ç»„ä»¶ç›¸å¯¹äºäºåè€…çš„åŒºåˆ«ï¼š</strong><br>ä¸æ— çŠ¶æ€ç»„ä»¶ç›¸æ¯”ï¼ŒReact.createClass å’Œ React.Component éƒ½æ˜¯åˆ›å»ºæœ‰çŠ¶æ€çš„ç»„ä»¶ï¼Œè¿™äº›ç»„ä»¶æ˜¯è¦è¢«å®ä¾‹åŒ–çš„ï¼Œå¹¶ä¸”å¯ä»¥è®¿é—®ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚</p><p><strong>React.createClass ä¸ React.Component åŒºåˆ«ï¼š</strong></p><p><strong>â‘  å‡½æ•° this è‡ªç»‘å®š</strong></p><ul><li>React.createClass åˆ›å»ºçš„ç»„ä»¶ï¼Œå…¶æ¯ä¸€ä¸ªæˆå‘˜å‡½æ•°çš„ this éƒ½æœ‰ React è‡ªåŠ¨ç»‘å®šï¼Œå‡½æ•°ä¸­çš„ this ä¼šè¢«æ­£ç¡®è®¾ç½®ã€‚</li><li>React.Component åˆ›å»ºçš„ç»„ä»¶ï¼Œå…¶æˆå‘˜å‡½æ•°ä¸ä¼šè‡ªåŠ¨ç»‘å®š thisï¼Œéœ€è¦å¼€å‘è€…æ‰‹åŠ¨ç»‘å®šï¼Œå¦åˆ™ this ä¸èƒ½è·å–å½“å‰ç»„ä»¶å®ä¾‹å¯¹è±¡ã€‚</li></ul><p><strong>â‘¡ ç»„ä»¶å±æ€§ç±»å‹ propTypes åŠå…¶é»˜è®¤ props å±æ€§ defaultProps é…ç½®ä¸åŒ</strong></p><ul><li>React.createClass åœ¨åˆ›å»ºç»„ä»¶æ—¶ï¼Œæœ‰å…³ç»„ä»¶ props çš„å±æ€§ç±»å‹åŠç»„ä»¶é»˜è®¤çš„å±æ€§ä¼šä½œä¸ºç»„ä»¶å®ä¾‹çš„å±æ€§æ¥é…ç½®ï¼Œå…¶ä¸­ defaultProps æ˜¯ä½¿ç”¨ getDefaultProps çš„æ–¹æ³•æ¥è·å–é»˜è®¤ç»„ä»¶å±æ€§çš„</li><li>React.Component åœ¨åˆ›å»ºç»„ä»¶æ—¶é…ç½®è¿™ä¸¤ä¸ªå¯¹åº”ä¿¡æ¯æ—¶ï¼Œä»–ä»¬æ˜¯ä½œä¸ºç»„ä»¶ç±»çš„å±æ€§ï¼Œä¸æ˜¯ç»„ä»¶å®ä¾‹çš„å±æ€§ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„ç±»çš„é™æ€å±æ€§æ¥é…ç½®çš„ã€‚</li></ul><p><strong>â‘¢ ç»„ä»¶åˆå§‹çŠ¶æ€ state çš„é…ç½®ä¸åŒ</strong></p><ul><li>React.createClass åˆ›å»ºçš„ç»„ä»¶ï¼Œå…¶çŠ¶æ€ state æ˜¯é€šè¿‡ getInitialState æ–¹æ³•æ¥é…ç½®ç»„ä»¶ç›¸å…³çš„çŠ¶æ€ï¼›</li><li>React.Component åˆ›å»ºçš„ç»„ä»¶ï¼Œå…¶çŠ¶æ€ state æ˜¯åœ¨ constructor ä¸­åƒåˆå§‹åŒ–ç»„ä»¶å±æ€§ä¸€æ ·å£°æ˜çš„ã€‚</li></ul><h3 id="14-å¯¹æœ‰çŠ¶æ€ç»„ä»¶å’Œæ— çŠ¶æ€ç»„ä»¶çš„ç†è§£åŠä½¿ç”¨åœºæ™¯"><a href="#14-å¯¹æœ‰çŠ¶æ€ç»„ä»¶å’Œæ— çŠ¶æ€ç»„ä»¶çš„ç†è§£åŠä½¿ç”¨åœºæ™¯" class="headerlink" title="14. å¯¹æœ‰çŠ¶æ€ç»„ä»¶å’Œæ— çŠ¶æ€ç»„ä»¶çš„ç†è§£åŠä½¿ç”¨åœºæ™¯"></a>14. å¯¹æœ‰çŠ¶æ€ç»„ä»¶å’Œæ— çŠ¶æ€ç»„ä»¶çš„ç†è§£åŠä½¿ç”¨åœºæ™¯</h3><p><strong>ï¼ˆ1ï¼‰æœ‰çŠ¶æ€ç»„ä»¶</strong></p><p><strong>ç‰¹ç‚¹ï¼š</strong></p><ul><li>æ˜¯ç±»ç»„ä»¶</li><li>æœ‰ç»§æ‰¿</li><li>å¯ä»¥ä½¿ç”¨ this</li><li>å¯ä»¥ä½¿ç”¨ react çš„ç”Ÿå‘½å‘¨æœŸ</li><li>ä½¿ç”¨è¾ƒå¤šï¼Œå®¹æ˜“é¢‘ç¹è§¦å‘ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°ï¼Œå½±å“æ€§èƒ½</li><li>å†…éƒ¨ä½¿ç”¨ stateï¼Œç»´æŠ¤è‡ªèº«çŠ¶æ€çš„å˜åŒ–ï¼Œæœ‰çŠ¶æ€ç»„ä»¶æ ¹æ®å¤–éƒ¨ç»„ä»¶ä¼ å…¥çš„ props å’Œè‡ªèº«çš„ state è¿›è¡Œæ¸²æŸ“ã€‚</li></ul><p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p><ul><li>éœ€è¦ä½¿ç”¨åˆ°çŠ¶æ€çš„ã€‚</li><li>éœ€è¦ä½¿ç”¨çŠ¶æ€æ“ä½œç»„ä»¶çš„ï¼ˆæ— çŠ¶æ€ç»„ä»¶çš„ä¹Ÿå¯ä»¥å®ç°æ–°ç‰ˆæœ¬ react hooks ä¹Ÿå¯å®ç°ï¼‰</li></ul><p><strong>æ€»ç»“ï¼š</strong><br>ç±»ç»„ä»¶å¯ä»¥ç»´æŠ¤è‡ªèº«çš„çŠ¶æ€å˜é‡ï¼Œå³ç»„ä»¶çš„ state ï¼Œç±»ç»„ä»¶è¿˜æœ‰ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œå¯ä»¥è®©å¼€å‘è€…èƒ½å¤Ÿåœ¨ç»„ä»¶çš„ä¸åŒé˜¶æ®µï¼ˆæŒ‚è½½ã€æ›´æ–°ã€å¸è½½ï¼‰ï¼Œå¯¹ç»„ä»¶åšæ›´å¤šçš„æ§åˆ¶ã€‚ç±»ç»„ä»¶åˆ™æ—¢å¯ä»¥å……å½“æ— çŠ¶æ€ç»„ä»¶ï¼Œä¹Ÿå¯ä»¥å……å½“æœ‰çŠ¶æ€ç»„ä»¶ã€‚å½“ä¸€ä¸ªç±»ç»„ä»¶ä¸éœ€è¦ç®¡ç†è‡ªèº«çŠ¶æ€æ—¶ï¼Œä¹Ÿå¯ç§°ä¸ºæ— çŠ¶æ€ç»„ä»¶ã€‚</p><p><strong>ï¼ˆ2ï¼‰æ— çŠ¶æ€ç»„ä»¶</strong><br><strong>ç‰¹ç‚¹ï¼š</strong></p><ul><li>ä¸ä¾èµ–è‡ªèº«çš„çŠ¶æ€ state</li><li>å¯ä»¥æ˜¯ç±»ç»„ä»¶æˆ–è€…å‡½æ•°ç»„ä»¶ã€‚</li><li>å¯ä»¥å®Œå…¨é¿å…ä½¿ç”¨ this å…³é”®å­—ã€‚ï¼ˆç”±äºä½¿ç”¨çš„æ˜¯ç®­å¤´å‡½æ•°äº‹ä»¶æ— éœ€ç»‘å®šï¼‰</li><li>æœ‰æ›´é«˜çš„æ€§èƒ½ã€‚å½“ä¸éœ€è¦ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸé’©å­æ—¶ï¼Œåº”è¯¥é¦–å…ˆä½¿ç”¨æ— çŠ¶æ€å‡½æ•°ç»„ä»¶</li><li>ç»„ä»¶å†…éƒ¨ä¸ç»´æŠ¤ state ï¼Œåªæ ¹æ®å¤–éƒ¨ç»„ä»¶ä¼ å…¥çš„ props è¿›è¡Œæ¸²æŸ“çš„ç»„ä»¶ï¼Œå½“ props æ”¹å˜æ—¶ï¼Œç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚</li></ul><p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p><ul><li>ç»„ä»¶ä¸éœ€è¦ç®¡ç† stateï¼Œçº¯å±•ç¤º</li></ul><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>ç®€åŒ–ä»£ç ã€ä¸“æ³¨äº render</li><li>ç»„ä»¶ä¸éœ€è¦è¢«å®ä¾‹åŒ–ï¼Œæ— ç”Ÿå‘½å‘¨æœŸï¼Œæå‡æ€§èƒ½ã€‚ è¾“å‡ºï¼ˆæ¸²æŸ“ï¼‰åªå–å†³äºè¾“å…¥ï¼ˆå±æ€§ï¼‰ï¼Œæ— å‰¯ä½œç”¨</li><li>è§†å›¾å’Œæ•°æ®çš„è§£è€¦åˆ†ç¦»</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>æ— æ³•ä½¿ç”¨ ref</li><li>æ— ç”Ÿå‘½å‘¨æœŸæ–¹æ³•</li><li>æ— æ³•æ§åˆ¶ç»„ä»¶çš„é‡æ¸²æŸ“ï¼Œå› ä¸ºæ— æ³•ä½¿ç”¨ shouldComponentUpdate æ–¹æ³•ï¼Œå½“ç»„ä»¶æ¥å—åˆ°æ–°çš„å±æ€§æ—¶åˆ™ä¼šé‡æ¸²æŸ“</li></ul><p><strong>æ€»ç»“ï¼š</strong><br>ç»„ä»¶å†…éƒ¨çŠ¶æ€ä¸”ä¸å¤–éƒ¨æ— å…³çš„ç»„ä»¶ï¼Œå¯ä»¥è€ƒè™‘ç”¨çŠ¶æ€ç»„ä»¶ï¼Œè¿™æ ·çŠ¶æ€æ ‘å°±ä¸ä¼šè¿‡äºå¤æ‚ï¼Œæ˜“äºç†è§£å’Œç®¡ç†ã€‚å½“ä¸€ä¸ªç»„ä»¶ä¸éœ€è¦ç®¡ç†è‡ªèº«çŠ¶æ€æ—¶ï¼Œä¹Ÿå°±æ˜¯æ— çŠ¶æ€ç»„ä»¶ï¼Œåº”è¯¥ä¼˜å…ˆè®¾è®¡ä¸ºå‡½æ•°ç»„ä»¶ã€‚æ¯”å¦‚è‡ªå®šä¹‰çš„ <code>&lt;Button/&gt;</code>ã€ <code>&lt;Input /&gt;</code> ç­‰ç»„ä»¶ã€‚</p><h3 id="15-å¯¹-React-ä¸­-Fragment-çš„ç†è§£ï¼Œå®ƒçš„ä½¿ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#15-å¯¹-React-ä¸­-Fragment-çš„ç†è§£ï¼Œå®ƒçš„ä½¿ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="15. å¯¹ React ä¸­ Fragment çš„ç†è§£ï¼Œå®ƒçš„ä½¿ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ"></a>15. å¯¹ React ä¸­ Fragment çš„ç†è§£ï¼Œå®ƒçš„ä½¿ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>åœ¨ React ä¸­ï¼Œç»„ä»¶è¿”å›çš„å…ƒç´ åªèƒ½æœ‰ä¸€ä¸ªæ ¹å…ƒç´ ã€‚ä¸ºäº†ä¸æ·»åŠ å¤šä½™çš„ DOM èŠ‚ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Fragment æ ‡ç­¾æ¥åŒ…è£¹æ‰€æœ‰çš„å…ƒç´ ï¼ŒFragment æ ‡ç­¾ä¸ä¼šæ¸²æŸ“å‡ºä»»ä½•å…ƒç´ ã€‚React å®˜æ–¹å¯¹ Fragment çš„è§£é‡Šï¼š</p><blockquote><p>React ä¸­çš„ä¸€ä¸ªå¸¸è§æ¨¡å¼æ˜¯ä¸€ä¸ªç»„ä»¶è¿”å›å¤šä¸ªå…ƒç´ ã€‚Fragments å…è®¸ä½ å°†å­åˆ—è¡¨åˆ†ç»„ï¼Œè€Œæ— éœ€å‘ DOM æ·»åŠ é¢å¤–èŠ‚ç‚¹ã€‚</p></blockquote><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> Fragment <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token comment" spellcheck="true">// ä¸€èˆ¬å½¢å¼</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token operator">&lt;</span>React<span class="token punctuation">.</span>Fragment<span class="token operator">></span>      <span class="token operator">&lt;</span>ChildA <span class="token operator">/</span><span class="token operator">></span>      <span class="token operator">&lt;</span>ChildB <span class="token operator">/</span><span class="token operator">></span>      <span class="token operator">&lt;</span>ChildC <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span>React<span class="token punctuation">.</span>Fragment<span class="token operator">></span>  <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// ä¹Ÿå¯ä»¥å†™æˆä»¥ä¸‹å½¢å¼</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token operator">&lt;</span><span class="token operator">></span>      <span class="token operator">&lt;</span>ChildA <span class="token operator">/</span><span class="token operator">></span>      <span class="token operator">&lt;</span>ChildB <span class="token operator">/</span><span class="token operator">></span>      <span class="token operator">&lt;</span>ChildC <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">></span>  <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="16-React-å¦‚ä½•è·å–ç»„ä»¶å¯¹åº”çš„-DOM-å…ƒç´ ï¼Ÿ"><a href="#16-React-å¦‚ä½•è·å–ç»„ä»¶å¯¹åº”çš„-DOM-å…ƒç´ ï¼Ÿ" class="headerlink" title="16. React å¦‚ä½•è·å–ç»„ä»¶å¯¹åº”çš„ DOM å…ƒç´ ï¼Ÿ"></a>16. React å¦‚ä½•è·å–ç»„ä»¶å¯¹åº”çš„ DOM å…ƒç´ ï¼Ÿ</h3><p>å¯ä»¥ç”¨ ref æ¥è·å–æŸä¸ªå­èŠ‚ç‚¹çš„å®ä¾‹ï¼Œç„¶åé€šè¿‡å½“å‰ class ç»„ä»¶å®ä¾‹çš„ä¸€äº›ç‰¹å®šå±æ€§æ¥ç›´æ¥è·å–å­èŠ‚ç‚¹å®ä¾‹ã€‚ref æœ‰ä¸‰ç§å®ç°æ–¹æ³•:</p><ul><li><strong>å­—ç¬¦ä¸²æ ¼å¼</strong>ï¼šå­—ç¬¦ä¸²æ ¼å¼ï¼Œè¿™æ˜¯ React16 ç‰ˆæœ¬ä¹‹å‰ç”¨å¾—æœ€å¤šçš„ï¼Œä¾‹å¦‚ï¼š<code>&lt;p ref="info"&gt;span&lt;/p&gt;</code></li><li><strong>å‡½æ•°æ ¼å¼</strong>ï¼šref å¯¹åº”ä¸€ä¸ªæ–¹æ³•ï¼Œè¯¥æ–¹æ³•æœ‰ä¸€ä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯å¯¹åº”çš„èŠ‚ç‚¹å®ä¾‹ï¼Œä¾‹å¦‚ï¼š<code>&lt;p ref={ele =&gt; this.info = ele}&gt;&lt;/p&gt;</code></li><li><strong>createRef æ–¹æ³•</strong>ï¼šReact 16 æä¾›çš„ä¸€ä¸ª APIï¼Œä½¿ç”¨ React.createRef()æ¥å®ç°</li></ul><h3 id="17-React-ä¸­å¯ä»¥åœ¨-render-è®¿é—®-refs-å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ"><a href="#17-React-ä¸­å¯ä»¥åœ¨-render-è®¿é—®-refs-å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ" class="headerlink" title="17. React ä¸­å¯ä»¥åœ¨ render è®¿é—® refs å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ"></a>17. React ä¸­å¯ä»¥åœ¨ render è®¿é—® refs å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span><span class="token operator">></span>  <span class="token operator">&lt;</span>span id<span class="token operator">=</span><span class="token string">"name"</span> ref<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>spanRef<span class="token punctuation">}</span><span class="token operator">></span>    <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>title<span class="token punctuation">}</span>  <span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span>  <span class="token operator">&lt;</span>span<span class="token operator">></span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>spanRef<span class="token punctuation">.</span>current <span class="token operator">?</span> <span class="token string">"æœ‰å€¼"</span> <span class="token punctuation">:</span> <span class="token string">"æ— å€¼"</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸å¯ä»¥ï¼Œrender é˜¶æ®µ DOM è¿˜æ²¡æœ‰ç”Ÿæˆï¼Œæ— æ³•è·å– DOMã€‚DOM çš„è·å–éœ€è¦åœ¨ pre-commit é˜¶æ®µå’Œ commit é˜¶æ®µï¼š<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/reactreactInterview1/3.png" alt="image.png"></p><h3 id="18-å¯¹-React-çš„æ’æ§½-Portals-çš„ç†è§£ï¼Œå¦‚ä½•ä½¿ç”¨ï¼Œæœ‰å“ªäº›ä½¿ç”¨åœºæ™¯"><a href="#18-å¯¹-React-çš„æ’æ§½-Portals-çš„ç†è§£ï¼Œå¦‚ä½•ä½¿ç”¨ï¼Œæœ‰å“ªäº›ä½¿ç”¨åœºæ™¯" class="headerlink" title="18. å¯¹ React çš„æ’æ§½(Portals)çš„ç†è§£ï¼Œå¦‚ä½•ä½¿ç”¨ï¼Œæœ‰å“ªäº›ä½¿ç”¨åœºæ™¯"></a>18. å¯¹ React çš„æ’æ§½(Portals)çš„ç†è§£ï¼Œå¦‚ä½•ä½¿ç”¨ï¼Œæœ‰å“ªäº›ä½¿ç”¨åœºæ™¯</h3><p>React å®˜æ–¹å¯¹ Portals çš„å®šä¹‰ï¼š</p><blockquote><p>Portal æä¾›äº†ä¸€ç§å°†å­èŠ‚ç‚¹æ¸²æŸ“åˆ°å­˜åœ¨äºçˆ¶ç»„ä»¶ä»¥å¤–çš„ DOM èŠ‚ç‚¹çš„ä¼˜ç§€çš„æ–¹æ¡ˆ</p></blockquote><p>Portals æ˜¯ React 16 æä¾›çš„å®˜æ–¹è§£å†³æ–¹æ¡ˆï¼Œä½¿å¾—ç»„ä»¶å¯ä»¥è„±ç¦»çˆ¶ç»„ä»¶å±‚çº§æŒ‚è½½åœ¨ DOM æ ‘çš„ä»»ä½•ä½ç½®ã€‚é€šä¿—æ¥è®²ï¼Œå°±æ˜¯æˆ‘ä»¬ render ä¸€ä¸ªç»„ä»¶ï¼Œä½†è¿™ä¸ªç»„ä»¶çš„ DOM ç»“æ„å¹¶ä¸åœ¨æœ¬ç»„ä»¶å†…ã€‚</p><p>Portals è¯­æ³•å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript">ReactDOM<span class="token punctuation">.</span><span class="token function">createPortal</span><span class="token punctuation">(</span>child<span class="token punctuation">,</span> container<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>ç¬¬ä¸€ä¸ªå‚æ•° child æ˜¯å¯æ¸²æŸ“çš„ React å­é¡¹ï¼Œæ¯”å¦‚å…ƒç´ ï¼Œå­—ç¬¦ä¸²æˆ–è€…ç‰‡æ®µç­‰;</li><li>ç¬¬äºŒä¸ªå‚æ•° container æ˜¯ä¸€ä¸ª DOM å…ƒç´ ã€‚</li></ul><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç»„ä»¶çš„ render å‡½æ•°è¿”å›çš„å…ƒç´ ä¼šè¢«æŒ‚è½½åœ¨å®ƒçš„çˆ¶çº§ç»„ä»¶ä¸Šï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> DemoComponent <span class="token keyword">from</span> <span class="token string">'./DemoComponent'</span><span class="token punctuation">;</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// DemoComponentå…ƒç´ ä¼šè¢«æŒ‚è½½åœ¨idä¸ºparentçš„divçš„å…ƒç´ ä¸Š</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"parent"</span><span class="token operator">></span>        <span class="token operator">&lt;</span>DemoComponent <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>  <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶è€Œï¼Œæœ‰äº›å…ƒç´ éœ€è¦è¢«æŒ‚è½½åœ¨æ›´é«˜å±‚çº§çš„ä½ç½®ã€‚æœ€å…¸å‹çš„åº”ç”¨åœºæ™¯ï¼šå½“çˆ¶ç»„ä»¶å…·æœ‰<code>overflow: hidden</code>æˆ–è€…<code>z-index</code>çš„æ ·å¼è®¾ç½®æ—¶ï¼Œç»„ä»¶æœ‰å¯èƒ½è¢«å…¶ä»–å…ƒç´ é®æŒ¡ï¼Œè¿™æ—¶å°±å¯ä»¥è€ƒè™‘è¦ä¸è¦ä½¿ç”¨ Portal ä½¿ç»„ä»¶çš„æŒ‚è½½è„±ç¦»çˆ¶ç»„ä»¶ã€‚ä¾‹å¦‚ï¼šå¯¹è¯æ¡†ï¼Œæ¨¡æ€çª—ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> DemoComponent <span class="token keyword">from</span> <span class="token string">'./DemoComponent'</span><span class="token punctuation">;</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// DemoComponentå…ƒç´ ä¼šè¢«æŒ‚è½½åœ¨idä¸ºparentçš„divçš„å…ƒç´ ä¸Š</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"parent"</span><span class="token operator">></span>        <span class="token operator">&lt;</span>DemoComponent <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>  <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="19-åœ¨-React-ä¸­å¦‚ä½•é¿å…ä¸å¿…è¦çš„-renderï¼Ÿ"><a href="#19-åœ¨-React-ä¸­å¦‚ä½•é¿å…ä¸å¿…è¦çš„-renderï¼Ÿ" class="headerlink" title="19. åœ¨ React ä¸­å¦‚ä½•é¿å…ä¸å¿…è¦çš„ renderï¼Ÿ"></a>19. åœ¨ React ä¸­å¦‚ä½•é¿å…ä¸å¿…è¦çš„ renderï¼Ÿ</h3><p>React åŸºäºè™šæ‹Ÿ DOM å’Œé«˜æ•ˆ Diff ç®—æ³•çš„å®Œç¾é…åˆï¼Œå®ç°äº†å¯¹ DOM æœ€å°ç²’åº¦çš„æ›´æ–°ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒReact å¯¹ DOM çš„æ¸²æŸ“æ•ˆç‡è¶³ä»¥ä¸šåŠ¡æ—¥å¸¸ã€‚ä½†åœ¨ä¸ªåˆ«å¤æ‚ä¸šåŠ¡åœºæ™¯ä¸‹ï¼Œæ€§èƒ½é—®é¢˜ä¾ç„¶ä¼šå›°æ‰°æˆ‘ä»¬ã€‚æ­¤æ—¶éœ€è¦é‡‡å–ä¸€äº›æªæ–½æ¥æå‡è¿è¡Œæ€§èƒ½ï¼Œå…¶å¾ˆé‡è¦çš„ä¸€ä¸ªæ–¹å‘ï¼Œå°±æ˜¯é¿å…ä¸å¿…è¦çš„æ¸²æŸ“ï¼ˆRenderï¼‰ã€‚è¿™é‡Œæä¸‹ä¼˜åŒ–çš„ç‚¹ï¼š</p><ul><li><strong>shouldComponentUpdate å’Œ PureComponent</strong></li></ul><p>åœ¨ React ç±»ç»„ä»¶ä¸­ï¼Œå¯ä»¥åˆ©ç”¨ shouldComponentUpdate æˆ–è€… PureComponent æ¥å‡å°‘å› çˆ¶ç»„ä»¶æ›´æ–°è€Œè§¦å‘å­ç»„ä»¶çš„ renderï¼Œä»è€Œè¾¾åˆ°ç›®çš„ã€‚shouldComponentUpdate æ¥å†³å®šæ˜¯å¦ç»„ä»¶æ˜¯å¦é‡æ–°æ¸²æŸ“ï¼Œå¦‚æœä¸å¸Œæœ›ç»„ä»¶é‡æ–°æ¸²æŸ“ï¼Œè¿”å› false å³å¯ã€‚</p><ul><li><strong>åˆ©ç”¨é«˜é˜¶ç»„ä»¶</strong></li></ul><p>åœ¨å‡½æ•°ç»„ä»¶ä¸­ï¼Œå¹¶æ²¡æœ‰ shouldComponentUpdate è¿™ä¸ªç”Ÿå‘½å‘¨æœŸï¼Œå¯ä»¥åˆ©ç”¨é«˜é˜¶ç»„ä»¶ï¼Œå°è£…ä¸€ä¸ªç±»ä¼¼ PureComponet çš„åŠŸèƒ½</p><ul><li><strong>ä½¿ç”¨ React.memo</strong></li></ul><p>React.memo æ˜¯ React 16.6 æ–°çš„ä¸€ä¸ª APIï¼Œç”¨æ¥ç¼“å­˜ç»„ä»¶çš„æ¸²æŸ“ï¼Œé¿å…ä¸å¿…è¦çš„æ›´æ–°ï¼Œå…¶å®ä¹Ÿæ˜¯ä¸€ä¸ªé«˜é˜¶ç»„ä»¶ï¼Œä¸ PureComponent ååˆ†ç±»ä¼¼ï¼Œä½†ä¸åŒçš„æ˜¯ï¼Œ React.memo åªèƒ½ç”¨äºå‡½æ•°ç»„ä»¶ã€‚</p><h3 id="20-å¯¹-React-Intl-çš„ç†è§£ï¼Œå®ƒçš„å·¥ä½œåŸç†ï¼Ÿ"><a href="#20-å¯¹-React-Intl-çš„ç†è§£ï¼Œå®ƒçš„å·¥ä½œåŸç†ï¼Ÿ" class="headerlink" title="20. å¯¹ React-Intl çš„ç†è§£ï¼Œå®ƒçš„å·¥ä½œåŸç†ï¼Ÿ"></a>20. å¯¹ React-Intl çš„ç†è§£ï¼Œå®ƒçš„å·¥ä½œåŸç†ï¼Ÿ</h3><p>React-intl æ˜¯é›…è™çš„è¯­è¨€å›½é™…åŒ–å¼€æºé¡¹ç›® FormatJS çš„ä¸€éƒ¨åˆ†ï¼Œé€šè¿‡å…¶æä¾›çš„ç»„ä»¶å’Œ API å¯ä»¥ä¸ ReactJS ç»‘å®šã€‚</p><p>React-intl æä¾›äº†ä¸¤ç§ä½¿ç”¨æ–¹æ³•ï¼Œä¸€ç§æ˜¯å¼•ç”¨ React ç»„ä»¶ï¼Œå¦ä¸€ç§æ˜¯ç›´æ¥è°ƒå– APIï¼Œå®˜æ–¹æ›´åŠ æ¨èåœ¨ React é¡¹ç›®ä¸­ä½¿ç”¨å‰è€…ï¼Œåªæœ‰åœ¨æ— æ³•ä½¿ç”¨ React ç»„ä»¶çš„åœ°æ–¹ï¼Œæ‰åº”è¯¥è°ƒç”¨æ¡†æ¶æä¾›çš„ APIã€‚å®ƒæä¾›äº†ä¸€ç³»åˆ—çš„ React ç»„ä»¶ï¼ŒåŒ…æ‹¬æ•°å­—æ ¼å¼åŒ–ã€å­—ç¬¦ä¸²æ ¼å¼åŒ–ã€æ—¥æœŸæ ¼å¼åŒ–ç­‰ã€‚</p><p>åœ¨ React-intl ä¸­ï¼Œå¯ä»¥é…ç½®ä¸åŒçš„è¯­è¨€åŒ…ï¼Œä»–çš„å·¥ä½œåŸç†å°±æ˜¯æ ¹æ®éœ€è¦ï¼Œåœ¨è¯­è¨€åŒ…ä¹‹é—´è¿›è¡Œåˆ‡æ¢ã€‚</p><h3 id="21-å¯¹-React-context-çš„ç†è§£"><a href="#21-å¯¹-React-context-çš„ç†è§£" class="headerlink" title="21. å¯¹ React context çš„ç†è§£"></a>21. å¯¹ React context çš„ç†è§£</h3><p>åœ¨ React ä¸­ï¼Œæ•°æ®ä¼ é€’ä¸€èˆ¬ä½¿ç”¨ props ä¼ é€’æ•°æ®ï¼Œç»´æŒå•å‘æ•°æ®æµï¼Œè¿™æ ·å¯ä»¥è®©ç»„ä»¶ä¹‹é—´çš„å…³ç³»å˜å¾—ç®€å•ä¸”å¯é¢„æµ‹ï¼Œä½†æ˜¯å•é¡¹æ•°æ®æµåœ¨æŸäº›åœºæ™¯ä¸­å¹¶ä¸é€‚ç”¨ã€‚å•çº¯ä¸€å¯¹çš„çˆ¶å­ç»„ä»¶ä¼ é€’å¹¶æ— é—®é¢˜ï¼Œä½†è¦æ˜¯ç»„ä»¶ä¹‹é—´å±‚å±‚ä¾èµ–æ·±å…¥ï¼Œprops å°±éœ€è¦å±‚å±‚ä¼ é€’æ˜¾ç„¶ï¼Œè¿™æ ·åšå¤ªç¹çäº†ã€‚</p><p>Context æä¾›äº†ä¸€ç§åœ¨ç»„ä»¶ä¹‹é—´å…±äº«æ­¤ç±»å€¼çš„æ–¹å¼ï¼Œè€Œä¸å¿…æ˜¾å¼åœ°é€šè¿‡ç»„ä»¶æ ‘çš„é€å±‚ä¼ é€’ propsã€‚</p><p>å¯ä»¥æŠŠ context å½“åšæ˜¯ç‰¹å®šä¸€ä¸ªç»„ä»¶æ ‘å†…å…±äº«çš„ storeï¼Œç”¨æ¥åšæ•°æ®ä¼ é€’ã€‚<strong>ç®€å•è¯´å°±æ˜¯ï¼Œå½“ä½ ä¸æƒ³åœ¨ç»„ä»¶æ ‘ä¸­é€šè¿‡é€å±‚ä¼ é€’ props æˆ–è€… state çš„æ–¹å¼æ¥ä¼ é€’æ•°æ®æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ Context æ¥å®ç°è·¨å±‚çº§çš„ç»„ä»¶æ•°æ®ä¼ é€’ã€‚</strong></p><p>JS çš„ä»£ç å—åœ¨æ‰§è¡ŒæœŸé—´ï¼Œä¼šåˆ›å»ºä¸€ä¸ªç›¸åº”çš„ä½œç”¨åŸŸé“¾ï¼Œè¿™ä¸ªä½œç”¨åŸŸé“¾è®°å½•ç€è¿è¡Œæ—¶ JS ä»£ç å—æ‰§è¡ŒæœŸé—´æ‰€èƒ½è®¿é—®çš„æ´»åŠ¨å¯¹è±¡ï¼ŒåŒ…æ‹¬å˜é‡å’Œå‡½æ•°ï¼ŒJS ç¨‹åºé€šè¿‡ä½œç”¨åŸŸé“¾è®¿é—®åˆ°ä»£ç å—å†…éƒ¨æˆ–è€…å¤–éƒ¨çš„å˜é‡å’Œå‡½æ•°ã€‚</p><p>å‡å¦‚ä»¥ JS çš„ä½œç”¨åŸŸé“¾ä½œä¸ºç±»æ¯”ï¼ŒReact ç»„ä»¶æä¾›çš„ Context å¯¹è±¡å…¶å®å°±å¥½æ¯”ä¸€ä¸ªæä¾›ç»™å­ç»„ä»¶è®¿é—®çš„ä½œç”¨åŸŸï¼Œè€Œ Context å¯¹è±¡çš„å±æ€§å¯ä»¥çœ‹æˆä½œç”¨åŸŸä¸Šçš„æ´»åŠ¨å¯¹è±¡ã€‚ç”±äºç»„ä»¶ çš„ Context ç”±å…¶çˆ¶èŠ‚ç‚¹é“¾ä¸Šæ‰€æœ‰ç»„ä»¶é€š è¿‡ getChildContextï¼ˆï¼‰è¿”å›çš„ Context å¯¹è±¡ç»„åˆè€Œæˆï¼Œæ‰€ä»¥ï¼Œç»„ä»¶é€šè¿‡ Context æ˜¯å¯ä»¥è®¿é—®åˆ°å…¶çˆ¶ç»„ä»¶é“¾ä¸Šæ‰€æœ‰èŠ‚ç‚¹ç»„ä»¶æä¾›çš„ Context çš„å±æ€§ã€‚</p><h3 id="22-ä¸ºä»€ä¹ˆ-React-å¹¶ä¸æ¨èä¼˜å…ˆè€ƒè™‘ä½¿ç”¨-Contextï¼Ÿ"><a href="#22-ä¸ºä»€ä¹ˆ-React-å¹¶ä¸æ¨èä¼˜å…ˆè€ƒè™‘ä½¿ç”¨-Contextï¼Ÿ" class="headerlink" title="22. ä¸ºä»€ä¹ˆ React å¹¶ä¸æ¨èä¼˜å…ˆè€ƒè™‘ä½¿ç”¨ Contextï¼Ÿ"></a>22. ä¸ºä»€ä¹ˆ React å¹¶ä¸æ¨èä¼˜å…ˆè€ƒè™‘ä½¿ç”¨ Contextï¼Ÿ</h3><ul><li>Context ç›®å‰è¿˜å¤„äºå®éªŒé˜¶æ®µï¼Œå¯èƒ½ä¼šåœ¨åé¢çš„å‘è¡Œç‰ˆæœ¬ä¸­æœ‰å¾ˆå¤§çš„å˜åŒ–ï¼Œäº‹å®ä¸Šè¿™ç§æƒ…å†µå·²ç»å‘ç”Ÿäº†ï¼Œæ‰€ä»¥ä¸ºäº†é¿å…ç»™ä»Šåå‡çº§å¸¦æ¥å¤§çš„å½±å“å’Œéº»çƒ¦ï¼Œä¸å»ºè®®åœ¨ app ä¸­ä½¿ç”¨ contextã€‚</li><li>å°½ç®¡ä¸å»ºè®®åœ¨ app ä¸­ä½¿ç”¨ contextï¼Œä½†æ˜¯ç‹¬æœ‰ç»„ä»¶è€Œè¨€ï¼Œç”±äºå½±å“èŒƒå›´å°äº appï¼Œå¦‚æœå¯ä»¥åšåˆ°é«˜å†…èšï¼Œä¸ç ´åç»„ä»¶æ ‘ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ context</li><li>å¯¹äºç»„ä»¶ä¹‹é—´çš„æ•°æ®é€šä¿¡æˆ–è€…çŠ¶æ€ç®¡ç†ï¼Œæœ‰æ•ˆä½¿ç”¨ props æˆ–è€… state è§£å†³ï¼Œç„¶åå†è€ƒè™‘ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„æˆç†Ÿåº“è¿›è¡Œè§£å†³ï¼Œä»¥ä¸Šçš„æ–¹æ³•éƒ½ä¸æ˜¯æœ€ä½³çš„æ–¹æ¡ˆçš„æ—¶å€™ï¼Œåœ¨è€ƒè™‘ contextã€‚</li><li>context çš„æ›´æ–°éœ€è¦é€šè¿‡ setState()è§¦å‘ï¼Œä½†æ˜¯è¿™å¹¶ä¸æ˜¯å¾ˆå¯é çš„ï¼ŒContext æ”¯æŒè·¨ç»„ä»¶çš„è®¿é—®ï¼Œä½†æ˜¯å¦‚æœä¸­é—´çš„å­ç»„ä»¶é€šè¿‡ä¸€äº›æ–¹æ³•ä¸å½±å“æ›´æ–°ï¼Œæ¯”å¦‚ shouldComponentUpdate() è¿”å› false é‚£ä¹ˆä¸èƒ½ä¿è¯ Context çš„æ›´æ–°ä¸€å®šå¯ä»¥ä½¿ç”¨ Context çš„å­ç»„ä»¶ï¼Œå› æ­¤ï¼ŒContext çš„å¯é æ€§éœ€è¦å…³æ³¨</li></ul><h3 id="23-React-ä¸­ä»€ä¹ˆæ˜¯å—æ§ç»„ä»¶å’Œéæ§ç»„ä»¶ï¼Ÿ"><a href="#23-React-ä¸­ä»€ä¹ˆæ˜¯å—æ§ç»„ä»¶å’Œéæ§ç»„ä»¶ï¼Ÿ" class="headerlink" title="23. React ä¸­ä»€ä¹ˆæ˜¯å—æ§ç»„ä»¶å’Œéæ§ç»„ä»¶ï¼Ÿ"></a>23. React ä¸­ä»€ä¹ˆæ˜¯å—æ§ç»„ä»¶å’Œéæ§ç»„ä»¶ï¼Ÿ</h3><p><strong>ï¼ˆ1ï¼‰å—æ§ç»„ä»¶</strong><br>åœ¨ä½¿ç”¨è¡¨å•æ¥æ”¶é›†ç”¨æˆ·è¾“å…¥æ—¶ï¼Œä¾‹å¦‚<code>&lt;input&gt;&lt;select&gt;&lt;textearea&gt;</code>ç­‰å…ƒç´ éƒ½è¦ç»‘å®šä¸€ä¸ª change äº‹ä»¶ï¼Œå½“è¡¨å•çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–ï¼Œå°±ä¼šè§¦å‘ onChange äº‹ä»¶ï¼Œæ›´æ–°ç»„ä»¶çš„ stateã€‚è¿™ç§ç»„ä»¶åœ¨ React ä¸­è¢«ç§°ä¸º<strong>å—æ§ç»„ä»¶</strong>ï¼Œåœ¨å—æ§ç»„ä»¶ä¸­ï¼Œç»„ä»¶æ¸²æŸ“å‡ºçš„çŠ¶æ€ä¸å®ƒçš„ value æˆ– checked å±æ€§ç›¸å¯¹åº”ï¼Œreact é€šè¿‡è¿™ç§æ–¹å¼æ¶ˆé™¤äº†ç»„ä»¶çš„å±€éƒ¨çŠ¶æ€ï¼Œä½¿æ•´ä¸ªçŠ¶æ€å¯æ§ã€‚react å®˜æ–¹æ¨èä½¿ç”¨å—æ§è¡¨å•ç»„ä»¶ã€‚</p><p>å—æ§ç»„ä»¶æ›´æ–° state çš„æµç¨‹ï¼š</p><ul><li>å¯ä»¥é€šè¿‡åˆå§‹ state ä¸­è®¾ç½®è¡¨å•çš„é»˜è®¤å€¼</li><li>æ¯å½“è¡¨å•çš„å€¼å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè°ƒç”¨ onChange äº‹ä»¶å¤„ç†å™¨</li><li>äº‹ä»¶å¤„ç†å™¨é€šè¿‡äº‹ä»¶å¯¹è±¡ e æ‹¿åˆ°æ”¹å˜åçš„çŠ¶æ€ï¼Œå¹¶æ›´æ–°ç»„ä»¶çš„ state</li><li>ä¸€æ—¦é€šè¿‡ setState æ–¹æ³•æ›´æ–° stateï¼Œå°±ä¼šè§¦å‘è§†å›¾çš„é‡æ–°æ¸²æŸ“ï¼Œå®Œæˆè¡¨å•ç»„ä»¶çš„æ›´æ–°</li></ul><p><strong>å—æ§ç»„ä»¶ç¼ºé™·ï¼š</strong><br>è¡¨å•å…ƒç´ çš„å€¼éƒ½æ˜¯ç”± React ç»„ä»¶è¿›è¡Œç®¡ç†ï¼Œå½“æœ‰å¤šä¸ªè¾“å…¥æ¡†ï¼Œæˆ–è€…å¤šä¸ªè¿™ç§ç»„ä»¶æ—¶ï¼Œå¦‚æœæƒ³åŒæ—¶è·å–åˆ°å…¨éƒ¨çš„å€¼å°±å¿…é¡»æ¯ä¸ªéƒ½è¦ç¼–å†™äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œè¿™ä¼šè®©ä»£ç çœ‹ç€å¾ˆè‡ƒè‚¿ï¼Œæ‰€ä»¥ä¸ºäº†è§£å†³è¿™ç§æƒ…å†µï¼Œå‡ºç°äº†éå—æ§ç»„ä»¶ã€‚</p><p><strong>ï¼ˆ2ï¼‰éå—æ§ç»„ä»¶</strong><br>å¦‚æœä¸€ä¸ªè¡¨å•ç»„ä»¶æ²¡æœ‰ value propsï¼ˆå•é€‰å’Œå¤é€‰æŒ‰é’®å¯¹åº”çš„æ˜¯ checked propsï¼‰æ—¶ï¼Œå°±å¯ä»¥ç§°ä¸ºéå—æ§ç»„ä»¶ã€‚åœ¨éå—æ§ç»„ä»¶ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ª ref æ¥ä» DOM è·å¾—è¡¨å•å€¼ã€‚è€Œä¸æ˜¯ä¸ºæ¯ä¸ªçŠ¶æ€æ›´æ–°ç¼–å†™ä¸€ä¸ªäº‹ä»¶å¤„ç†ç¨‹åºã€‚</p><p>React å®˜æ–¹çš„è§£é‡Šï¼š</p><blockquote><p>è¦ç¼–å†™ä¸€ä¸ªéå—æ§ç»„ä»¶ï¼Œè€Œä¸æ˜¯ä¸ºæ¯ä¸ªçŠ¶æ€æ›´æ–°éƒ½ç¼–å†™æ•°æ®å¤„ç†å‡½æ•°ï¼Œä½ å¯ä»¥ä½¿ç”¨ ref æ¥ä» DOM èŠ‚ç‚¹ä¸­è·å–è¡¨å•æ•°æ®ã€‚<br>å› ä¸ºéå—æ§ç»„ä»¶å°†çœŸå®æ•°æ®å‚¨å­˜åœ¨ DOM èŠ‚ç‚¹ä¸­ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨éå—æ§ç»„ä»¶æ—¶ï¼Œæœ‰æ—¶å€™åè€Œæ›´å®¹æ˜“åŒæ—¶é›†æˆ React å’Œé React ä»£ç ã€‚å¦‚æœä½ ä¸ä»‹æ„ä»£ç ç¾è§‚æ€§ï¼Œå¹¶ä¸”å¸Œæœ›å¿«é€Ÿç¼–å†™ä»£ç ï¼Œä½¿ç”¨éå—æ§ç»„ä»¶å¾€å¾€å¯ä»¥å‡å°‘ä½ çš„ä»£ç é‡ã€‚å¦åˆ™ï¼Œä½ åº”è¯¥ä½¿ç”¨å—æ§ç»„ä»¶ã€‚</p></blockquote><p>ä¾‹å¦‚ï¼Œä¸‹é¢çš„ä»£ç åœ¨éå—æ§ç»„ä»¶ä¸­æ¥æ”¶å•ä¸ªå±æ€§ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">NameForm</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>handleSubmit <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleSubmit<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">handleSubmit</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"A name was submitted: "</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>input<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>    event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>form onSubmit<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleSubmit<span class="token punctuation">}</span><span class="token operator">></span>        <span class="token operator">&lt;</span>label<span class="token operator">></span>          Name<span class="token punctuation">:</span>          <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> ref<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>input <span class="token operator">=</span> input<span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">></span>        <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"submit"</span> value<span class="token operator">=</span><span class="token string">"Submit"</span> <span class="token operator">/</span><span class="token operator">></span>      <span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>æ€»ç»“ï¼š</strong> é¡µé¢ä¸­æ‰€æœ‰è¾“å…¥ç±»çš„ DOM å¦‚æœæ˜¯ç°ç”¨ç°å–çš„ç§°ä¸ºéå—æ§ç»„ä»¶ï¼Œè€Œé€šè¿‡ setState å°†è¾“å…¥çš„å€¼ç»´æŠ¤åˆ°äº† state ä¸­ï¼Œéœ€è¦æ—¶å†ä» state ä¸­å–å‡ºï¼Œè¿™é‡Œçš„æ•°æ®å°±å—åˆ°äº† state çš„æ§åˆ¶ï¼Œç§°ä¸ºå—æ§ç»„ä»¶ã€‚</p><h3 id="24-React-ä¸­-refs-çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿæœ‰å“ªäº›åº”ç”¨åœºæ™¯ï¼Ÿ"><a href="#24-React-ä¸­-refs-çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿæœ‰å“ªäº›åº”ç”¨åœºæ™¯ï¼Ÿ" class="headerlink" title="24. React ä¸­ refs çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿæœ‰å“ªäº›åº”ç”¨åœºæ™¯ï¼Ÿ"></a>24. React ä¸­ refs çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿæœ‰å“ªäº›åº”ç”¨åœºæ™¯ï¼Ÿ</h3><p>Refs æä¾›äº†ä¸€ç§æ–¹å¼ï¼Œç”¨äºè®¿é—®åœ¨ render æ–¹æ³•ä¸­åˆ›å»ºçš„ React å…ƒç´ æˆ– DOM èŠ‚ç‚¹ã€‚Refs åº”è¯¥è°¨æ…ä½¿ç”¨ï¼Œå¦‚ä¸‹åœºæ™¯ä½¿ç”¨ Refs æ¯”è¾ƒé€‚åˆï¼š</p><ul><li>å¤„ç†ç„¦ç‚¹ã€æ–‡æœ¬é€‰æ‹©æˆ–è€…åª’ä½“çš„æ§åˆ¶</li><li>è§¦å‘å¿…è¦çš„åŠ¨ç”»</li><li>é›†æˆç¬¬ä¸‰æ–¹ DOM åº“</li></ul><p>Refs æ˜¯ä½¿ç”¨ <code>React.createRef()</code> æ–¹æ³•åˆ›å»ºçš„ï¼Œä»–é€šè¿‡ <code>ref</code> å±æ€§é™„åŠ åˆ° React å…ƒç´ ä¸Šã€‚è¦åœ¨æ•´ä¸ªç»„ä»¶ä¸­ä½¿ç”¨ Refsï¼Œéœ€è¦å°† <code>ref</code> åœ¨æ„é€ å‡½æ•°ä¸­åˆ†é…ç»™å…¶å®ä¾‹å±æ€§ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">MyComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>myRef <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div ref<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>myRef<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç”±äºå‡½æ•°ç»„ä»¶æ²¡æœ‰å®ä¾‹ï¼Œå› æ­¤ä¸èƒ½åœ¨å‡½æ•°ç»„ä»¶ä¸Šç›´æ¥ä½¿ç”¨ <code>ref</code>ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">MyFunctionalComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token operator">&lt;</span>input <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">Parent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>textInput <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// è¿™å°†ä¸ä¼šå·¥ä½œï¼</span>    <span class="token keyword">return</span> <span class="token operator">&lt;</span>MyFunctionalComponent ref<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>textInput<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½†å¯ä»¥é€šè¿‡é—­åˆçš„å¸®åŠ©åœ¨å‡½æ•°ç»„ä»¶å†…éƒ¨è¿›è¡Œä½¿ç”¨ Refsï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">CustomTextInput</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// è¿™é‡Œå¿…é¡»å£°æ˜ textInputï¼Œè¿™æ · ref å›è°ƒæ‰å¯ä»¥å¼•ç”¨å®ƒ</span>  <span class="token keyword">let</span> textInput <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  <span class="token keyword">function</span> <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    textInput<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token operator">&lt;</span>div<span class="token operator">></span>      <span class="token operator">&lt;</span>input        type<span class="token operator">=</span><span class="token string">"text"</span>        ref<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>          textInput <span class="token operator">=</span> input<span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">}</span>      <span class="token operator">/</span><span class="token operator">></span>      <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"button"</span> value<span class="token operator">=</span><span class="token string">"Focus the text input"</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>  <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>æ³¨æ„ï¼š</strong></p><ul><li>ä¸åº”è¯¥è¿‡åº¦çš„ä½¿ç”¨ Refs</li><li><code>ref</code> çš„è¿”å›å€¼å–å†³äºèŠ‚ç‚¹çš„ç±»å‹ï¼š<ul><li>å½“ <code>ref</code> å±æ€§è¢«ç”¨äºä¸€ä¸ªæ™®é€šçš„ HTML å…ƒç´ æ—¶ï¼Œ<code>React.createRef()</code> å°†æ¥æ”¶åº•å±‚ DOM å…ƒç´ ä½œä¸ºä»–çš„ <code>current</code> å±æ€§ä»¥åˆ›å»º <code>ref</code>ã€‚</li><li>å½“ <code>ref</code> å±æ€§è¢«ç”¨äºä¸€ä¸ªè‡ªå®šä¹‰çš„ç±»ç»„ä»¶æ—¶ï¼Œ<code>ref</code> å¯¹è±¡å°†æ¥æ”¶è¯¥ç»„ä»¶å·²æŒ‚è½½çš„å®ä¾‹ä½œä¸ºä»–çš„ <code>current</code>ã€‚</li></ul></li><li>å½“åœ¨çˆ¶ç»„ä»¶ä¸­éœ€è¦è®¿é—®å­ç»„ä»¶ä¸­çš„ <code>ref</code> æ—¶å¯ä½¿ç”¨ä¼ é€’ Refs æˆ–å›è°ƒ Refsã€‚</li></ul><h3 id="26-React-ç»„ä»¶çš„æ„é€ å‡½æ•°æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿå®ƒæ˜¯å¿…é¡»çš„å—ï¼Ÿ"><a href="#26-React-ç»„ä»¶çš„æ„é€ å‡½æ•°æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿå®ƒæ˜¯å¿…é¡»çš„å—ï¼Ÿ" class="headerlink" title="26. React ç»„ä»¶çš„æ„é€ å‡½æ•°æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿå®ƒæ˜¯å¿…é¡»çš„å—ï¼Ÿ"></a>26. React ç»„ä»¶çš„æ„é€ å‡½æ•°æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿå®ƒæ˜¯å¿…é¡»çš„å—ï¼Ÿ</h3><p>æ„é€ å‡½æ•°ä¸»è¦ç”¨äºä¸¤ä¸ªç›®çš„ï¼š</p><ul><li>é€šè¿‡å°†å¯¹è±¡åˆ†é…ç»™ this.state æ¥åˆå§‹åŒ–æœ¬åœ°çŠ¶æ€</li><li>å°†äº‹ä»¶å¤„ç†ç¨‹åºæ–¹æ³•ç»‘å®šåˆ°å®ä¾‹ä¸Š</li></ul><p>æ‰€ä»¥ï¼Œå½“åœ¨ React class ä¸­éœ€è¦è®¾ç½® state çš„åˆå§‹å€¼æˆ–è€…ç»‘å®šäº‹ä»¶æ—¶ï¼Œéœ€è¦åŠ ä¸Šæ„é€ å‡½æ•°ï¼Œå®˜æ–¹ Demoï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">LikeButton</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>      liked<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>handleClick <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleClick<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> liked<span class="token punctuation">:</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>liked <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> text <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>liked <span class="token operator">?</span> <span class="token string">"liked"</span> <span class="token punctuation">:</span> <span class="token string">"haven't liked"</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>div onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleClick<span class="token punctuation">}</span><span class="token operator">></span>You <span class="token punctuation">{</span>text<span class="token punctuation">}</span> <span class="token keyword">this</span><span class="token punctuation">.</span> Click to toggle<span class="token punctuation">.</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span>ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>LikeButton <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"example"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ„é€ å‡½æ•°ç”¨æ¥æ–°å»ºçˆ¶ç±»çš„ this å¯¹è±¡ï¼›å­ç±»å¿…é¡»åœ¨ constructor æ–¹æ³•ä¸­è°ƒç”¨ super æ–¹æ³•ï¼›å¦åˆ™æ–°å»ºå®ä¾‹æ—¶ä¼šæŠ¥é”™ï¼›å› ä¸ºå­ç±»æ²¡æœ‰è‡ªå·±çš„ this å¯¹è±¡ï¼Œè€Œæ˜¯ç»§æ‰¿çˆ¶ç±»çš„ this å¯¹è±¡ï¼Œç„¶åå¯¹å…¶è¿›è¡ŒåŠ å·¥ã€‚å¦‚æœä¸è°ƒç”¨ super æ–¹æ³•ï¼›å­ç±»å°±å¾—ä¸åˆ° this å¯¹è±¡ã€‚</p><p><strong>æ³¨æ„ï¼š</strong></p><ul><li>constructor () å¿…é¡»é…ä¸Š super(), å¦‚æœè¦åœ¨ constructor å†…éƒ¨ä½¿ç”¨ this.props å°±è¦ ä¼ å…¥ props , å¦åˆ™ä¸ç”¨</li><li>JavaScript ä¸­çš„ bind æ¯æ¬¡éƒ½ä¼šè¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°, ä¸ºäº†æ€§èƒ½ç­‰è€ƒè™‘, å°½é‡åœ¨ constructor ä¸­ç»‘å®šäº‹ä»¶</li></ul><h3 id="27-React-forwardRef-æ˜¯ä»€ä¹ˆï¼Ÿå®ƒæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ"><a href="#27-React-forwardRef-æ˜¯ä»€ä¹ˆï¼Ÿå®ƒæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ" class="headerlink" title="27. React.forwardRef æ˜¯ä»€ä¹ˆï¼Ÿå®ƒæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ"></a>27. React.forwardRef æ˜¯ä»€ä¹ˆï¼Ÿå®ƒæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</h3><p>React.forwardRef ä¼šåˆ›å»ºä¸€ä¸ª React ç»„ä»¶ï¼Œè¿™ä¸ªç»„ä»¶èƒ½å¤Ÿå°†å…¶æ¥å—çš„ ref å±æ€§è½¬å‘åˆ°å…¶ç»„ä»¶æ ‘ä¸‹çš„å¦ä¸€ä¸ªç»„ä»¶ä¸­ã€‚è¿™ç§æŠ€æœ¯å¹¶ä¸å¸¸è§ï¼Œä½†åœ¨ä»¥ä¸‹ä¸¤ç§åœºæ™¯ä¸­ç‰¹åˆ«æœ‰ç”¨ï¼š</p><ul><li>è½¬å‘ refs åˆ° DOM ç»„ä»¶</li><li>åœ¨é«˜é˜¶ç»„ä»¶ä¸­è½¬å‘ refs</li></ul><h3 id="28-ç±»ç»„ä»¶ä¸å‡½æ•°ç»„ä»¶æœ‰ä»€ä¹ˆå¼‚åŒï¼Ÿ"><a href="#28-ç±»ç»„ä»¶ä¸å‡½æ•°ç»„ä»¶æœ‰ä»€ä¹ˆå¼‚åŒï¼Ÿ" class="headerlink" title="28. ç±»ç»„ä»¶ä¸å‡½æ•°ç»„ä»¶æœ‰ä»€ä¹ˆå¼‚åŒï¼Ÿ"></a>28. ç±»ç»„ä»¶ä¸å‡½æ•°ç»„ä»¶æœ‰ä»€ä¹ˆå¼‚åŒï¼Ÿ</h3><p><strong>ç›¸åŒç‚¹ï¼š</strong><br>ç»„ä»¶æ˜¯ React å¯å¤ç”¨çš„æœ€å°ä»£ç ç‰‡æ®µï¼Œå®ƒä»¬ä¼šè¿”å›è¦åœ¨é¡µé¢ä¸­æ¸²æŸ“çš„ React å…ƒç´ ã€‚ä¹Ÿæ­£å› ä¸ºç»„ä»¶æ˜¯ React çš„æœ€å°ç¼–ç å•ä½ï¼Œæ‰€ä»¥æ— è®ºæ˜¯å‡½æ•°ç»„ä»¶è¿˜æ˜¯ç±»ç»„ä»¶ï¼Œåœ¨ä½¿ç”¨æ–¹å¼å’Œæœ€ç»ˆå‘ˆç°æ•ˆæœä¸Šéƒ½æ˜¯å®Œå…¨ä¸€è‡´çš„ã€‚</p><p>æˆ‘ä»¬ç”šè‡³å¯ä»¥å°†ä¸€ä¸ªç±»ç»„ä»¶æ”¹å†™æˆå‡½æ•°ç»„ä»¶ï¼Œæˆ–è€…æŠŠå‡½æ•°ç»„ä»¶æ”¹å†™æˆä¸€ä¸ªç±»ç»„ä»¶ï¼ˆè™½ç„¶å¹¶ä¸æ¨èè¿™ç§é‡æ„è¡Œä¸ºï¼‰ã€‚ä»ä½¿ç”¨è€…çš„è§’åº¦è€Œè¨€ï¼Œå¾ˆéš¾ä»ä½¿ç”¨ä½“éªŒä¸ŠåŒºåˆ†ä¸¤è€…ï¼Œè€Œä¸”åœ¨ç°ä»£æµè§ˆå™¨ä¸­ï¼Œé—­åŒ…å’Œç±»çš„æ€§èƒ½åªåœ¨æç«¯åœºæ™¯ä¸‹æ‰ä¼šæœ‰æ˜æ˜¾çš„å·®åˆ«ã€‚æ‰€ä»¥ï¼ŒåŸºæœ¬å¯è®¤ä¸ºä¸¤è€…ä½œä¸ºç»„ä»¶æ˜¯å®Œå…¨ä¸€è‡´çš„ã€‚</p><p><strong>ä¸åŒç‚¹ï¼š</strong></p><ul><li>å®ƒä»¬åœ¨å¼€å‘æ—¶çš„å¿ƒæ™ºæ¨¡å‹ä¸Šå´å­˜åœ¨å·¨å¤§çš„å·®å¼‚ã€‚ç±»ç»„ä»¶æ˜¯åŸºäºé¢å‘å¯¹è±¡ç¼–ç¨‹çš„ï¼Œå®ƒä¸»æ‰“çš„æ˜¯ç»§æ‰¿ã€ç”Ÿå‘½å‘¨æœŸç­‰æ ¸å¿ƒæ¦‚å¿µï¼›è€Œå‡½æ•°ç»„ä»¶å†…æ ¸æ˜¯å‡½æ•°å¼ç¼–ç¨‹ï¼Œä¸»æ‰“çš„æ˜¯ immutableã€æ²¡æœ‰å‰¯ä½œç”¨ã€å¼•ç”¨é€æ˜ç­‰ç‰¹ç‚¹ã€‚</li><li>ä¹‹å‰ï¼Œåœ¨ä½¿ç”¨åœºæ™¯ä¸Šï¼Œå¦‚æœå­˜åœ¨éœ€è¦ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸçš„ç»„ä»¶ï¼Œé‚£ä¹ˆä¸»æ¨ç±»ç»„ä»¶ï¼›è®¾è®¡æ¨¡å¼ä¸Šï¼Œå¦‚æœéœ€è¦ä½¿ç”¨ç»§æ‰¿ï¼Œé‚£ä¹ˆä¸»æ¨ç±»ç»„ä»¶ã€‚ä½†ç°åœ¨ç”±äº React Hooks çš„æ¨å‡ºï¼Œç”Ÿå‘½å‘¨æœŸæ¦‚å¿µçš„æ·¡å‡ºï¼Œå‡½æ•°ç»„ä»¶å¯ä»¥å®Œå…¨å–ä»£ç±»ç»„ä»¶ã€‚å…¶æ¬¡ç»§æ‰¿å¹¶ä¸æ˜¯ç»„ä»¶æœ€ä½³çš„è®¾è®¡æ¨¡å¼ï¼Œå®˜æ–¹æ›´æ¨å´‡â€œç»„åˆä¼˜äºç»§æ‰¿â€çš„è®¾è®¡æ¦‚å¿µï¼Œæ‰€ä»¥ç±»ç»„ä»¶åœ¨è¿™æ–¹é¢çš„ä¼˜åŠ¿ä¹Ÿåœ¨æ·¡å‡ºã€‚</li><li>æ€§èƒ½ä¼˜åŒ–ä¸Šï¼Œç±»ç»„ä»¶ä¸»è¦ä¾é  shouldComponentUpdate  é˜»æ–­æ¸²æŸ“æ¥æå‡æ€§èƒ½ï¼Œè€Œå‡½æ•°ç»„ä»¶ä¾é  React.memo ç¼“å­˜æ¸²æŸ“ç»“æœæ¥æå‡æ€§èƒ½ã€‚</li><li>ä»ä¸Šæ‰‹ç¨‹åº¦è€Œè¨€ï¼Œç±»ç»„ä»¶æ›´å®¹æ˜“ä¸Šæ‰‹ï¼Œä»æœªæ¥è¶‹åŠ¿ä¸Šçœ‹ï¼Œç”±äº React Hooks çš„æ¨å‡ºï¼Œå‡½æ•°ç»„ä»¶æˆäº†ç¤¾åŒºæœªæ¥ä¸»æ¨çš„æ–¹æ¡ˆã€‚</li><li>ç±»ç»„ä»¶åœ¨æœªæ¥æ—¶é—´åˆ‡ç‰‡ä¸å¹¶å‘æ¨¡å¼ä¸­ï¼Œç”±äºç”Ÿå‘½å‘¨æœŸå¸¦æ¥çš„å¤æ‚åº¦ï¼Œå¹¶ä¸æ˜“äºä¼˜åŒ–ã€‚è€Œå‡½æ•°ç»„ä»¶æœ¬èº«è½»é‡ç®€å•ï¼Œä¸”åœ¨ Hooks çš„åŸºç¡€ä¸Šæä¾›äº†æ¯”åŸå…ˆæ›´ç»†ç²’åº¦çš„é€»è¾‘ç»„ç»‡ä¸å¤ç”¨ï¼Œæ›´èƒ½é€‚åº” React çš„æœªæ¥å‘å±•ã€‚</li></ul><h2 id="äºŒã€æ•°æ®ç®¡ç†"><a href="#äºŒã€æ•°æ®ç®¡ç†" class="headerlink" title="äºŒã€æ•°æ®ç®¡ç†"></a>äºŒã€æ•°æ®ç®¡ç†</h2><h3 id="1-React-setState-è°ƒç”¨çš„åŸç†"><a href="#1-React-setState-è°ƒç”¨çš„åŸç†" class="headerlink" title="1. React setState è°ƒç”¨çš„åŸç†"></a>1. React setState è°ƒç”¨çš„åŸç†</h3><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/reactreactInterview1/4.png" alt="image.png"><br>å…·ä½“çš„æ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹ï¼ˆæºç çº§è§£æï¼‰ï¼š</p><ul><li>é¦–å…ˆè°ƒç”¨äº†<code>setState</code> å…¥å£å‡½æ•°ï¼Œå…¥å£å‡½æ•°åœ¨è¿™é‡Œå°±æ˜¯å……å½“ä¸€ä¸ªåˆ†å‘å™¨çš„è§’è‰²ï¼Œæ ¹æ®å…¥å‚çš„ä¸åŒï¼Œå°†å…¶åˆ†å‘åˆ°ä¸åŒçš„åŠŸèƒ½å‡½æ•°ä¸­å»ï¼›</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript">ReactComponent<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>setState <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>partialState<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>updater<span class="token punctuation">.</span><span class="token function">enqueueSetState</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> partialState<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>updater<span class="token punctuation">.</span><span class="token function">enqueueCallback</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> callback<span class="token punctuation">,</span> <span class="token string">"setState"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><code>enqueueSetState</code> æ–¹æ³•å°†æ–°çš„ <code>state</code> æ”¾è¿›ç»„ä»¶çš„çŠ¶æ€é˜Ÿåˆ—é‡Œï¼Œå¹¶è°ƒç”¨ <code>enqueueUpdate</code> æ¥å¤„ç†å°†è¦æ›´æ–°çš„å®ä¾‹å¯¹è±¡ï¼›</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript">enqueueSetState<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>publicInstance<span class="token punctuation">,</span> partialState<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// æ ¹æ® this æ‹¿åˆ°å¯¹åº”çš„ç»„ä»¶å®ä¾‹</span>  <span class="token keyword">var</span> internalInstance <span class="token operator">=</span> <span class="token function">getInternalInstanceReadyForUpdate</span><span class="token punctuation">(</span>publicInstance<span class="token punctuation">,</span> <span class="token string">'setState'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// è¿™ä¸ª queue å¯¹åº”çš„å°±æ˜¯ä¸€ä¸ªç»„ä»¶å®ä¾‹çš„ state æ•°ç»„</span>  <span class="token keyword">var</span> queue <span class="token operator">=</span> internalInstance<span class="token punctuation">.</span>_pendingStateQueue <span class="token operator">||</span> <span class="token punctuation">(</span>internalInstance<span class="token punctuation">.</span>_pendingStateQueue <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  queue<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>partialState<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//  enqueueUpdate ç”¨æ¥å¤„ç†å½“å‰çš„ç»„ä»¶å®ä¾‹</span>  <span class="token function">enqueueUpdate</span><span class="token punctuation">(</span>internalInstance<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>åœ¨ <code>enqueueUpdate</code> æ–¹æ³•ä¸­å¼•å‡ºäº†ä¸€ä¸ªå…³é”®çš„å¯¹è±¡â€”â€”<code>batchingStrategy</code>ï¼Œè¯¥å¯¹è±¡æ‰€å…·å¤‡çš„<code>isBatchingUpdates</code> å±æ€§ç›´æ¥å†³å®šäº†å½“ä¸‹æ˜¯è¦èµ°æ›´æ–°æµç¨‹ï¼Œè¿˜æ˜¯åº”è¯¥æ’é˜Ÿç­‰å¾…ï¼›å¦‚æœè½®åˆ°æ‰§è¡Œï¼Œå°±è°ƒç”¨ <code>batchedUpdates</code> æ–¹æ³•æ¥ç›´æ¥å‘èµ·æ›´æ–°æµç¨‹ã€‚ç”±æ­¤å¯ä»¥æ¨æµ‹ï¼Œ<code>batchingStrategy</code> æˆ–è®¸æ­£æ˜¯ React å†…éƒ¨ä¸“é—¨ç”¨äºç®¡æ§æ‰¹é‡æ›´æ–°çš„å¯¹è±¡ã€‚</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">enqueueUpdate</span><span class="token punctuation">(</span>component<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token function">ensureInjected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// æ³¨æ„è¿™ä¸€å¥æ˜¯é—®é¢˜çš„å…³é”®ï¼ŒisBatchingUpdatesæ ‡è¯†ç€å½“å‰æ˜¯å¦å¤„äºæ‰¹é‡åˆ›å»º/æ›´æ–°ç»„ä»¶çš„é˜¶æ®µ</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>batchingStrategy<span class="token punctuation">.</span>isBatchingUpdates<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// è‹¥å½“å‰æ²¡æœ‰å¤„äºæ‰¹é‡åˆ›å»º/æ›´æ–°ç»„ä»¶çš„é˜¶æ®µï¼Œåˆ™ç«‹å³æ›´æ–°ç»„ä»¶</span>    batchingStrategy<span class="token punctuation">.</span><span class="token function">batchedUpdates</span><span class="token punctuation">(</span>enqueueUpdate<span class="token punctuation">,</span> component<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token comment" spellcheck="true">// å¦åˆ™ï¼Œå…ˆæŠŠç»„ä»¶å¡å…¥ dirtyComponents é˜Ÿåˆ—é‡Œï¼Œè®©å®ƒâ€œå†ç­‰ç­‰â€</span>  dirtyComponents<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>component<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>component<span class="token punctuation">.</span>_updateBatchNumber <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    component<span class="token punctuation">.</span>_updateBatchNumber <span class="token operator">=</span> updateBatchNumber <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>æ³¨æ„ï¼š</strong><code>batchingStrategy</code> å¯¹è±¡å¯ä»¥ç†è§£ä¸ºâ€œé”ç®¡ç†å™¨â€ã€‚è¿™é‡Œçš„â€œé”â€ï¼Œæ˜¯æŒ‡ React å…¨å±€å”¯ä¸€çš„ <code>isBatchingUpdates</code> å˜é‡ï¼Œ<code>isBatchingUpdates</code> çš„åˆå§‹å€¼æ˜¯ <code>false</code>ï¼Œæ„å‘³ç€â€œå½“å‰å¹¶æœªè¿›è¡Œä»»ä½•æ‰¹é‡æ›´æ–°æ“ä½œâ€ã€‚æ¯å½“ React è°ƒç”¨ <code>batchedUpdate</code> å»æ‰§è¡Œæ›´æ–°åŠ¨ä½œæ—¶ï¼Œä¼šå…ˆæŠŠè¿™ä¸ªé”ç»™â€œé”ä¸Šâ€ï¼ˆç½®ä¸º <code>true</code>ï¼‰ï¼Œè¡¨æ˜â€œç°åœ¨æ­£å¤„äºæ‰¹é‡æ›´æ–°è¿‡ç¨‹ä¸­â€ã€‚å½“é”è¢«â€œé”ä¸Šâ€çš„æ—¶å€™ï¼Œä»»ä½•éœ€è¦æ›´æ–°çš„ç»„ä»¶éƒ½åªèƒ½æš‚æ—¶è¿›å…¥ <code>dirtyComponents</code> é‡Œæ’é˜Ÿç­‰å€™ä¸‹ä¸€æ¬¡çš„æ‰¹é‡æ›´æ–°ï¼Œè€Œä¸èƒ½éšæ„â€œæ’é˜Ÿâ€ã€‚æ­¤å¤„ä½“ç°çš„â€œä»»åŠ¡é”â€çš„æ€æƒ³ï¼Œæ˜¯ React é¢å¯¹å¤§é‡çŠ¶æ€ä»ç„¶èƒ½å¤Ÿå®ç°æœ‰åºåˆ†æ‰¹å¤„ç†çš„åŸºçŸ³ã€‚</p><h3 id="2-React-setState-è°ƒç”¨ä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿæ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥ï¼Ÿ"><a href="#2-React-setState-è°ƒç”¨ä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿæ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥ï¼Ÿ" class="headerlink" title="2. React setState è°ƒç”¨ä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿæ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥ï¼Ÿ"></a>2. React setState è°ƒç”¨ä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿæ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥ï¼Ÿ</h3><p><strong>ï¼ˆ1ï¼‰React ä¸­ setState åå‘ç”Ÿäº†ä»€ä¹ˆ</strong></p><p>åœ¨ä»£ç ä¸­è°ƒç”¨ setState å‡½æ•°ä¹‹åï¼ŒReact ä¼šå°†ä¼ å…¥çš„å‚æ•°å¯¹è±¡ä¸ç»„ä»¶å½“å‰çš„çŠ¶æ€åˆå¹¶ï¼Œç„¶åè§¦å‘è°ƒå’Œè¿‡ç¨‹(Reconciliation)ã€‚ç»è¿‡è°ƒå’Œè¿‡ç¨‹ï¼ŒReact ä¼šä»¥ç›¸å¯¹é«˜æ•ˆçš„æ–¹å¼æ ¹æ®æ–°çš„çŠ¶æ€æ„å»º React å…ƒç´ æ ‘å¹¶ä¸”ç€æ‰‹é‡æ–°æ¸²æŸ“æ•´ä¸ª UI ç•Œé¢ã€‚</p><p>åœ¨ React å¾—åˆ°å…ƒç´ æ ‘ä¹‹åï¼ŒReact ä¼šè‡ªåŠ¨è®¡ç®—å‡ºæ–°çš„æ ‘ä¸è€æ ‘çš„èŠ‚ç‚¹å·®å¼‚ï¼Œç„¶åæ ¹æ®å·®å¼‚å¯¹ç•Œé¢è¿›è¡Œæœ€å°åŒ–é‡æ¸²æŸ“ã€‚åœ¨å·®å¼‚è®¡ç®—ç®—æ³•ä¸­ï¼ŒReact èƒ½å¤Ÿç›¸å¯¹ç²¾ç¡®åœ°çŸ¥é“å“ªäº›ä½ç½®å‘ç”Ÿäº†æ”¹å˜ä»¥åŠåº”è¯¥å¦‚ä½•æ”¹å˜ï¼Œè¿™å°±ä¿è¯äº†æŒ‰éœ€æ›´æ–°ï¼Œè€Œä¸æ˜¯å…¨éƒ¨é‡æ–°æ¸²æŸ“ã€‚</p><p>å¦‚æœåœ¨çŸ­æ—¶é—´å†…é¢‘ç¹ setStateã€‚React ä¼šå°† state çš„æ”¹å˜å‹å…¥æ ˆä¸­ï¼Œåœ¨åˆé€‚çš„æ—¶æœºï¼Œæ‰¹é‡æ›´æ–° state å’Œè§†å›¾ï¼Œè¾¾åˆ°æé«˜æ€§èƒ½çš„æ•ˆæœã€‚</p><p><strong>ï¼ˆ2ï¼‰setState æ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥çš„</strong></p><p>å‡å¦‚æ‰€æœ‰ setState æ˜¯åŒæ­¥çš„ï¼Œæ„å‘³ç€æ¯æ‰§è¡Œä¸€æ¬¡ setState æ—¶ï¼ˆæœ‰å¯èƒ½ä¸€ä¸ªåŒæ­¥ä»£ç ä¸­ï¼Œå¤šæ¬¡ setStateï¼‰ï¼Œéƒ½é‡æ–° vnode diff + dom ä¿®æ”¹ï¼Œè¿™å¯¹æ€§èƒ½æ¥è¯´æ˜¯æä¸ºä¸å¥½çš„ã€‚å¦‚æœæ˜¯å¼‚æ­¥ï¼Œåˆ™å¯ä»¥æŠŠä¸€ä¸ªåŒæ­¥ä»£ç ä¸­çš„å¤šä¸ª setState åˆå¹¶æˆä¸€æ¬¡ç»„ä»¶æ›´æ–°ã€‚æ‰€ä»¥é»˜è®¤æ˜¯å¼‚æ­¥çš„ï¼Œä½†æ˜¯åœ¨ä¸€äº›æƒ…å†µä¸‹æ˜¯åŒæ­¥çš„ã€‚</p><p>setState å¹¶ä¸æ˜¯å•çº¯åŒæ­¥/å¼‚æ­¥çš„ï¼Œå®ƒçš„è¡¨ç°ä¼šå› è°ƒç”¨åœºæ™¯çš„ä¸åŒè€Œä¸åŒã€‚åœ¨æºç ä¸­ï¼Œé€šè¿‡ isBatchingUpdates æ¥åˆ¤æ–­ setState æ˜¯å…ˆå­˜è¿› state é˜Ÿåˆ—è¿˜æ˜¯ç›´æ¥æ›´æ–°ï¼Œå¦‚æœå€¼ä¸º true åˆ™æ‰§è¡Œå¼‚æ­¥æ“ä½œï¼Œä¸º false åˆ™ç›´æ¥æ›´æ–°ã€‚</p><ul><li><strong>å¼‚æ­¥ï¼š</strong> åœ¨ React å¯ä»¥æ§åˆ¶çš„åœ°æ–¹ï¼Œå°±ä¸º trueï¼Œæ¯”å¦‚åœ¨ React ç”Ÿå‘½å‘¨æœŸäº‹ä»¶å’Œåˆæˆäº‹ä»¶ä¸­ï¼Œéƒ½ä¼šèµ°åˆå¹¶æ“ä½œï¼Œå»¶è¿Ÿæ›´æ–°çš„ç­–ç•¥ã€‚</li><li><strong>åŒæ­¥ï¼š</strong> åœ¨ React æ— æ³•æ§åˆ¶çš„åœ°æ–¹ï¼Œæ¯”å¦‚åŸç”Ÿäº‹ä»¶ï¼Œå…·ä½“å°±æ˜¯åœ¨ addEventListener ã€setTimeoutã€setInterval ç­‰äº‹ä»¶ä¸­ï¼Œå°±åªèƒ½åŒæ­¥æ›´æ–°ã€‚</li></ul><p>ä¸€èˆ¬è®¤ä¸ºï¼Œåšå¼‚æ­¥è®¾è®¡æ˜¯ä¸ºäº†æ€§èƒ½ä¼˜åŒ–ã€å‡å°‘æ¸²æŸ“æ¬¡æ•°ï¼š</p><ul><li><code>setState</code>è®¾è®¡ä¸ºå¼‚æ­¥ï¼Œå¯ä»¥æ˜¾è‘—çš„æå‡æ€§èƒ½ã€‚å¦‚æœæ¯æ¬¡è°ƒç”¨ <code>setState</code>éƒ½è¿›è¡Œä¸€æ¬¡æ›´æ–°ï¼Œé‚£ä¹ˆæ„å‘³ç€<code>render</code>å‡½æ•°ä¼šè¢«é¢‘ç¹è°ƒç”¨ï¼Œç•Œé¢é‡æ–°æ¸²æŸ“ï¼Œè¿™æ ·æ•ˆç‡æ˜¯å¾ˆä½çš„ï¼›æœ€å¥½çš„åŠæ³•åº”è¯¥æ˜¯è·å–åˆ°å¤šä¸ªæ›´æ–°ï¼Œä¹‹åè¿›è¡Œæ‰¹é‡æ›´æ–°ï¼›</li><li>å¦‚æœåŒæ­¥æ›´æ–°äº†<code>state</code>ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰æ‰§è¡Œ<code>render</code>å‡½æ•°ï¼Œé‚£ä¹ˆ<code>state</code>å’Œ<code>props</code>ä¸èƒ½ä¿æŒåŒæ­¥ã€‚<code>state</code>å’Œ<code>props</code>ä¸èƒ½ä¿æŒä¸€è‡´æ€§ï¼Œä¼šåœ¨å¼€å‘ä¸­äº§ç”Ÿå¾ˆå¤šçš„é—®é¢˜ï¼›</li></ul><h3 id="3-React-ä¸­çš„-setState-æ‰¹é‡æ›´æ–°çš„è¿‡ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#3-React-ä¸­çš„-setState-æ‰¹é‡æ›´æ–°çš„è¿‡ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="3. React ä¸­çš„ setState æ‰¹é‡æ›´æ–°çš„è¿‡ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ"></a>3. React ä¸­çš„ setState æ‰¹é‡æ›´æ–°çš„è¿‡ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>è°ƒç”¨ <code>setState</code> æ—¶ï¼Œç»„ä»¶çš„ <code>state</code> å¹¶ä¸ä¼šç«‹å³æ”¹å˜ï¼Œ <code>setState</code> åªæ˜¯æŠŠè¦ä¿®æ”¹çš„ <code>state</code> æ”¾å…¥ä¸€ä¸ªé˜Ÿåˆ—ï¼Œ <code>React</code> ä¼šä¼˜åŒ–çœŸæ­£çš„æ‰§è¡Œæ—¶æœºï¼Œå¹¶å‡ºäºæ€§èƒ½åŸå› ï¼Œä¼šå°† <code>React</code> äº‹ä»¶å¤„ç†ç¨‹åºä¸­çš„å¤šæ¬¡<code>React</code> äº‹ä»¶å¤„ç†ç¨‹åºä¸­çš„å¤šæ¬¡ <code>setState</code> çš„çŠ¶æ€ä¿®æ”¹åˆå¹¶æˆä¸€æ¬¡çŠ¶æ€ä¿®æ”¹ã€‚ æœ€ç»ˆæ›´æ–°åªäº§ç”Ÿä¸€æ¬¡ç»„ä»¶åŠå…¶å­ç»„ä»¶çš„é‡æ–°æ¸²æŸ“ï¼Œè¿™å¯¹äºå¤§å‹åº”ç”¨ç¨‹åºä¸­çš„æ€§èƒ½æå‡è‡³å…³é‡è¦ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  count<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>count <span class="token operator">+</span> <span class="token number">1</span>    <span class="token operator">===</span><span class="token operator">></span>    å…¥é˜Ÿï¼Œ<span class="token punctuation">[</span>count<span class="token operator">+</span><span class="token number">1</span>çš„ä»»åŠ¡<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  count<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>count <span class="token operator">+</span> <span class="token number">1</span>    <span class="token operator">===</span><span class="token operator">></span>    å…¥é˜Ÿï¼Œ<span class="token punctuation">[</span>count<span class="token operator">+</span><span class="token number">1</span>çš„ä»»åŠ¡ï¼Œcount<span class="token operator">+</span><span class="token number">1</span>çš„ä»»åŠ¡<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                          â†“                                         åˆå¹¶ stateï¼Œ<span class="token punctuation">[</span>count<span class="token operator">+</span><span class="token number">1</span>çš„ä»»åŠ¡<span class="token punctuation">]</span>                                          â†“                                         æ‰§è¡Œ count<span class="token operator">+</span><span class="token number">1</span>çš„ä»»åŠ¡<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåªè¦åŒæ­¥ä»£ç è¿˜åœ¨æ‰§è¡Œï¼Œâ€œæ”’èµ·æ¥â€è¿™ä¸ªåŠ¨ä½œå°±ä¸ä¼šåœæ­¢ã€‚ï¼ˆæ³¨ï¼šè¿™é‡Œä¹‹æ‰€ä»¥å¤šæ¬¡ +1 æœ€ç»ˆåªæœ‰ä¸€æ¬¡ç”Ÿæ•ˆï¼Œæ˜¯å› ä¸ºåœ¨åŒä¸€ä¸ªæ–¹æ³•ä¸­å¤šæ¬¡ setState çš„åˆå¹¶åŠ¨ä½œä¸æ˜¯å•çº¯åœ°å°†æ›´æ–°ç´¯åŠ ã€‚æ¯”å¦‚è¿™é‡Œå¯¹äºç›¸åŒå±æ€§çš„è®¾ç½®ï¼ŒReact åªä¼šä¸ºå…¶ä¿ç•™æœ€åä¸€æ¬¡çš„æ›´æ–°ï¼‰ã€‚</p><h3 id="4-React-ä¸­æœ‰ä½¿ç”¨è¿‡-getDefaultProps-å—ï¼Ÿå®ƒæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ"><a href="#4-React-ä¸­æœ‰ä½¿ç”¨è¿‡-getDefaultProps-å—ï¼Ÿå®ƒæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ" class="headerlink" title="4. React ä¸­æœ‰ä½¿ç”¨è¿‡ getDefaultProps å—ï¼Ÿå®ƒæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ"></a>4. React ä¸­æœ‰ä½¿ç”¨è¿‡ getDefaultProps å—ï¼Ÿå®ƒæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</h3><p>é€šè¿‡å®ç°ç»„ä»¶çš„ getDefaultPropsï¼Œå¯¹å±æ€§è®¾ç½®é»˜è®¤å€¼ï¼ˆES5 çš„å†™æ³•ï¼‰ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> ShowTitle <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createClass</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  getDefaultProps<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token punctuation">{</span>      title<span class="token punctuation">:</span> <span class="token string">"React"</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  render<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token operator">&lt;</span>h1<span class="token operator">></span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-React-ä¸­-setState-çš„ç¬¬äºŒä¸ªå‚æ•°ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#5-React-ä¸­-setState-çš„ç¬¬äºŒä¸ªå‚æ•°ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="5. React ä¸­ setState çš„ç¬¬äºŒä¸ªå‚æ•°ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ"></a>5. React ä¸­ setState çš„ç¬¬äºŒä¸ªå‚æ•°ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><code>setState</code> çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¯é€‰çš„å›è°ƒå‡½æ•°ã€‚è¿™ä¸ªå›è°ƒå‡½æ•°å°†åœ¨ç»„ä»¶é‡æ–°æ¸²æŸ“åæ‰§è¡Œã€‚ç­‰ä»·äºåœ¨ <code>componentDidUpdate</code> ç”Ÿå‘½å‘¨æœŸå†…æ‰§è¡Œã€‚é€šå¸¸å»ºè®®ä½¿ç”¨ <code>componentDidUpdate</code> æ¥ä»£æ›¿æ­¤æ–¹å¼ã€‚åœ¨è¿™ä¸ªå›è°ƒå‡½æ•°ä¸­ä½ å¯ä»¥æ‹¿åˆ°æ›´æ–°å <code>state</code> çš„å€¼ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>    key1<span class="token punctuation">:</span> newState1<span class="token punctuation">,</span>    key2<span class="token punctuation">:</span> newState2<span class="token punctuation">,</span>    <span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// ç¬¬äºŒä¸ªå‚æ•°æ˜¯ state æ›´æ–°å®Œæˆåçš„å›è°ƒå‡½æ•°</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="6-React-ä¸­çš„-setState-å’Œ-replaceState-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#6-React-ä¸­çš„-setState-å’Œ-replaceState-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="6. React ä¸­çš„ setState å’Œ replaceState çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"></a>6. React ä¸­çš„ setState å’Œ replaceState çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><strong>ï¼ˆ1ï¼‰setState()</strong><br>setState()ç”¨äºè®¾ç½®çŠ¶æ€å¯¹è±¡ï¼Œå…¶è¯­æ³•å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token function">setState</span><span class="token punctuation">(</span>object nextState<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token keyword">function</span> callback<span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>nextStateï¼Œå°†è¦è®¾ç½®çš„æ–°çŠ¶æ€ï¼Œè¯¥çŠ¶æ€ä¼šå’Œå½“å‰çš„ state åˆå¹¶</li><li>callbackï¼Œå¯é€‰å‚æ•°ï¼Œå›è°ƒå‡½æ•°ã€‚è¯¥å‡½æ•°ä¼šåœ¨ setState è®¾ç½®æˆåŠŸï¼Œä¸”ç»„ä»¶é‡æ–°æ¸²æŸ“åè°ƒç”¨ã€‚</li></ul><p>åˆå¹¶ nextState å’Œå½“å‰ stateï¼Œå¹¶é‡æ–°æ¸²æŸ“ç»„ä»¶ã€‚setState æ˜¯ React äº‹ä»¶å¤„ç†å‡½æ•°ä¸­å’Œè¯·æ±‚å›è°ƒå‡½æ•°ä¸­è§¦å‘ UI æ›´æ–°çš„ä¸»è¦æ–¹æ³•ã€‚</p><p><strong>ï¼ˆ2ï¼‰replaceState()</strong><br>replaceState()æ–¹æ³•ä¸ setState()ç±»ä¼¼ï¼Œä½†æ˜¯æ–¹æ³•åªä¼šä¿ç•™ nextState ä¸­çŠ¶æ€ï¼ŒåŸ state ä¸åœ¨ nextState ä¸­çš„çŠ¶æ€éƒ½ä¼šè¢«åˆ é™¤ã€‚å…¶è¯­æ³•å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token function">replaceState</span><span class="token punctuation">(</span>object nextState<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token keyword">function</span> callback<span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>nextStateï¼Œå°†è¦è®¾ç½®çš„æ–°çŠ¶æ€ï¼Œè¯¥çŠ¶æ€ä¼šæ›¿æ¢å½“å‰çš„ stateã€‚</li><li>callbackï¼Œå¯é€‰å‚æ•°ï¼Œå›è°ƒå‡½æ•°ã€‚è¯¥å‡½æ•°ä¼šåœ¨ replaceState è®¾ç½®æˆåŠŸï¼Œä¸”ç»„ä»¶é‡æ–°æ¸²æŸ“åè°ƒç”¨ã€‚</li></ul><p><strong>æ€»ç»“ï¼š</strong> setState  æ˜¯ä¿®æ”¹å…¶ä¸­çš„éƒ¨åˆ†çŠ¶æ€ï¼Œç›¸å½“äº Object.assignï¼Œåªæ˜¯è¦†ç›–ï¼Œä¸ä¼šå‡å°‘åŸæ¥çš„çŠ¶æ€ã€‚è€Œ replaceState æ˜¯å®Œå…¨æ›¿æ¢åŸæ¥çš„çŠ¶æ€ï¼Œç›¸å½“äºèµ‹å€¼ï¼Œå°†åŸæ¥çš„ state æ›¿æ¢ä¸ºå¦ä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚æœæ–°çŠ¶æ€å±æ€§å‡å°‘ï¼Œé‚£ä¹ˆ state ä¸­å°±æ²¡æœ‰è¿™ä¸ªçŠ¶æ€äº†ã€‚</p><h3 id="7-åœ¨-React-ä¸­ç»„ä»¶çš„-this-state-å’Œ-setState-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#7-åœ¨-React-ä¸­ç»„ä»¶çš„-this-state-å’Œ-setState-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="7. åœ¨ React ä¸­ç»„ä»¶çš„ this.state å’Œ setState æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>7. åœ¨ React ä¸­ç»„ä»¶çš„ this.state å’Œ setState æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>this.state é€šå¸¸æ˜¯ç”¨æ¥åˆå§‹åŒ– state çš„ï¼Œthis.setState æ˜¯ç”¨æ¥ä¿®æ”¹ state å€¼çš„ã€‚å¦‚æœåˆå§‹åŒ–äº† state ä¹‹åå†ä½¿ç”¨ this.stateï¼Œä¹‹å‰çš„ state ä¼šè¢«è¦†ç›–æ‰ï¼Œå¦‚æœä½¿ç”¨ this.setStateï¼Œåªä¼šæ›¿æ¢æ‰ç›¸åº”çš„ state å€¼ã€‚æ‰€ä»¥ï¼Œå¦‚æœæƒ³è¦ä¿®æ”¹ state çš„å€¼ï¼Œå°±éœ€è¦ä½¿ç”¨ setStateï¼Œè€Œä¸èƒ½ç›´æ¥ä¿®æ”¹ stateï¼Œç›´æ¥ä¿®æ”¹ state ä¹‹åé¡µé¢æ˜¯ä¸ä¼šæ›´æ–°çš„ã€‚</p><h3 id="8-state-æ˜¯æ€ä¹ˆæ³¨å…¥åˆ°ç»„ä»¶çš„ï¼Œä»-reducer-åˆ°ç»„ä»¶ç»å†äº†ä»€ä¹ˆæ ·çš„è¿‡ç¨‹"><a href="#8-state-æ˜¯æ€ä¹ˆæ³¨å…¥åˆ°ç»„ä»¶çš„ï¼Œä»-reducer-åˆ°ç»„ä»¶ç»å†äº†ä»€ä¹ˆæ ·çš„è¿‡ç¨‹" class="headerlink" title="8. state æ˜¯æ€ä¹ˆæ³¨å…¥åˆ°ç»„ä»¶çš„ï¼Œä» reducer åˆ°ç»„ä»¶ç»å†äº†ä»€ä¹ˆæ ·çš„è¿‡ç¨‹"></a>8. state æ˜¯æ€ä¹ˆæ³¨å…¥åˆ°ç»„ä»¶çš„ï¼Œä» reducer åˆ°ç»„ä»¶ç»å†äº†ä»€ä¹ˆæ ·çš„è¿‡ç¨‹</h3><p>é€šè¿‡ connect å’Œ mapStateToProps å°† state æ³¨å…¥åˆ°ç»„ä»¶ä¸­ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> connect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react-redux"</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span> setVisibilityFilter <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@/reducers/Todo/actions"</span><span class="token punctuation">;</span><span class="token keyword">import</span> Link <span class="token keyword">from</span> <span class="token string">"@/containers/Todo/components/Link"</span><span class="token punctuation">;</span><span class="token keyword">const</span> mapStateToProps <span class="token operator">=</span> <span class="token punctuation">(</span>state<span class="token punctuation">,</span> ownProps<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>  active<span class="token punctuation">:</span> ownProps<span class="token punctuation">.</span>filter <span class="token operator">===</span> state<span class="token punctuation">.</span>visibilityFilter<span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> mapDispatchToProps <span class="token operator">=</span> <span class="token punctuation">(</span>dispatch<span class="token punctuation">,</span> ownProps<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>  setFilter<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">setVisibilityFilter</span><span class="token punctuation">(</span>ownProps<span class="token punctuation">.</span>filter<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">,</span> mapDispatchToProps<span class="token punctuation">)</span><span class="token punctuation">(</span>Link<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸Šé¢ä»£ç ä¸­ï¼Œactive å°±æ˜¯æ³¨å…¥åˆ° Link ç»„ä»¶ä¸­çš„çŠ¶æ€ã€‚ mapStateToPropsï¼ˆstateï¼ŒownPropsï¼‰ä¸­å¸¦æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œå«ä¹‰æ˜¯ âˆ¶</p><ul><li>state-store ç®¡ç†çš„å…¨å±€çŠ¶æ€å¯¹è±¡ï¼Œæ‰€æœ‰éƒ½ç»„ä»¶çŠ¶æ€æ•°æ®éƒ½å­˜å‚¨åœ¨è¯¥å¯¹è±¡ä¸­ã€‚</li><li>ownProps ç»„ä»¶é€šè¿‡ props ä¼ å…¥çš„å‚æ•°ã€‚</li></ul><p><strong>reducer åˆ°ç»„ä»¶ç»å†çš„è¿‡ç¨‹ï¼š</strong></p><ul><li>reducer å¯¹ action å¯¹è±¡å¤„ç†ï¼Œæ›´æ–°ç»„ä»¶çŠ¶æ€ï¼Œå¹¶å°†æ–°çš„çŠ¶æ€å€¼è¿”å› storeã€‚</li><li>é€šè¿‡ connectï¼ˆmapStateToPropsï¼ŒmapDispatchToPropsï¼‰ï¼ˆComponentï¼‰å¯¹ç»„ä»¶ Component è¿›è¡Œå‡çº§ï¼Œæ­¤æ—¶å°†çŠ¶æ€å€¼ä» store å–å‡ºå¹¶ä½œä¸º props å‚æ•°ä¼ é€’åˆ°ç»„ä»¶ã€‚</li></ul><p><strong>é«˜é˜¶ç»„ä»¶å®ç°æºç  âˆ¶</strong></p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span><span class="token keyword">import</span> PropTypes <span class="token keyword">from</span> <span class="token string">"prop-types"</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// é«˜é˜¶ç»„ä»¶ contect</span><span class="token keyword">export</span> <span class="token keyword">const</span> connect <span class="token operator">=</span>  <span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">,</span> mapDispatchToProps<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">(</span>WrappedComponent<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">class</span> <span class="token class-name">Connect</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>      <span class="token comment" spellcheck="true">// é€šè¿‡å¯¹contextè°ƒç”¨è·å–store</span>      <span class="token keyword">static</span> contextTypes <span class="token operator">=</span> <span class="token punctuation">{</span>        store<span class="token punctuation">:</span> PropTypes<span class="token punctuation">.</span>object<span class="token punctuation">,</span>      <span class="token punctuation">}</span><span class="token punctuation">;</span>      <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>          allProps<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token punctuation">}</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>      <span class="token comment" spellcheck="true">// ç¬¬ä¸€ééœ€åˆå§‹åŒ–æ‰€æœ‰ç»„ä»¶åˆå§‹çŠ¶æ€</span>      <span class="token function">componentWillMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span>store<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_updateProps</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        store<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_updateProps</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// åŠ å…¥_updateProps()è‡³storeé‡Œçš„ç›‘å¬äº‹ä»¶åˆ—è¡¨</span>      <span class="token punctuation">}</span>      <span class="token comment" spellcheck="true">// æ‰§è¡Œactionåæ›´æ–°propsï¼Œä½¿ç»„ä»¶å¯ä»¥æ›´æ–°è‡³æœ€æ–°çŠ¶æ€ï¼ˆç±»ä¼¼äºsetStateï¼‰</span>      <span class="token function">_updateProps</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span>store<span class="token punctuation">;</span>        <span class="token keyword">let</span> stateProps <span class="token operator">=</span> mapStateToProps          <span class="token operator">?</span> <span class="token function">mapStateToProps</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">)</span>          <span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// é˜²æ­¢ mapStateToProps æ²¡æœ‰ä¼ å…¥</span>        <span class="token keyword">let</span> dispatchProps <span class="token operator">=</span> mapDispatchToProps          <span class="token operator">?</span> <span class="token function">mapDispatchToProps</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>dispatch<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">)</span>          <span class="token punctuation">:</span> <span class="token punctuation">{</span>              dispatch<span class="token punctuation">:</span> store<span class="token punctuation">.</span>dispatch<span class="token punctuation">,</span>            <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// é˜²æ­¢ mapDispatchToProps æ²¡æœ‰ä¼ å…¥</span>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>          allProps<span class="token punctuation">:</span> <span class="token punctuation">{</span>            <span class="token operator">...</span>stateProps<span class="token punctuation">,</span>            <span class="token operator">...</span>dispatchProps<span class="token punctuation">,</span>            <span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">,</span>          <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>      <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token operator">&lt;</span>WrappedComponent <span class="token punctuation">{</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>allProps<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> Connect<span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="9-React-ç»„ä»¶çš„-state-å’Œ-props-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#9-React-ç»„ä»¶çš„-state-å’Œ-props-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="9. React ç»„ä»¶çš„ state å’Œ props æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>9. React ç»„ä»¶çš„ state å’Œ props æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p><strong>ï¼ˆ1ï¼‰props</strong></p><p>props æ˜¯ä¸€ä¸ªä»å¤–éƒ¨ä¼ è¿›ç»„ä»¶çš„å‚æ•°ï¼Œä¸»è¦ä½œä¸ºå°±æ˜¯ä»çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’æ•°æ®ï¼Œå®ƒå…·æœ‰å¯è¯»æ€§å’Œä¸å˜æ€§ï¼Œåªèƒ½é€šè¿‡å¤–éƒ¨ç»„ä»¶ä¸»åŠ¨ä¼ å…¥æ–°çš„ props æ¥é‡æ–°æ¸²æŸ“å­ç»„ä»¶ï¼Œå¦åˆ™å­ç»„ä»¶çš„ props ä»¥åŠå±•ç°å½¢å¼ä¸ä¼šæ”¹å˜ã€‚</p><p><strong>ï¼ˆ2ï¼‰state</strong></p><p>state çš„ä¸»è¦ä½œç”¨æ˜¯ç”¨äºç»„ä»¶ä¿å­˜ã€æ§åˆ¶ä»¥åŠä¿®æ”¹è‡ªå·±çš„çŠ¶æ€ï¼Œå®ƒåªèƒ½åœ¨ constructor ä¸­åˆå§‹åŒ–ï¼Œå®ƒç®—æ˜¯ç»„ä»¶çš„ç§æœ‰å±æ€§ï¼Œä¸å¯é€šè¿‡å¤–éƒ¨è®¿é—®å’Œä¿®æ”¹ï¼Œåªèƒ½é€šè¿‡ç»„ä»¶å†…éƒ¨çš„ this.setState æ¥ä¿®æ”¹ï¼Œä¿®æ”¹ state å±æ€§ä¼šå¯¼è‡´ç»„ä»¶çš„é‡æ–°æ¸²æŸ“ã€‚</p><p><strong>ï¼ˆ3ï¼‰åŒºåˆ«</strong></p><ul><li>props æ˜¯ä¼ é€’ç»™ç»„ä»¶çš„ï¼ˆç±»ä¼¼äºå‡½æ•°çš„å½¢å‚ï¼‰ï¼Œè€Œ state æ˜¯åœ¨ç»„ä»¶å†…è¢«ç»„ä»¶è‡ªå·±ç®¡ç†çš„ï¼ˆç±»ä¼¼äºåœ¨ä¸€ä¸ªå‡½æ•°å†…å£°æ˜çš„å˜é‡ï¼‰ã€‚</li><li>props æ˜¯ä¸å¯ä¿®æ”¹çš„ï¼Œæ‰€æœ‰ React ç»„ä»¶éƒ½å¿…é¡»åƒçº¯å‡½æ•°ä¸€æ ·ä¿æŠ¤å®ƒä»¬çš„ props ä¸è¢«æ›´æ”¹ã€‚</li><li>state æ˜¯åœ¨ç»„ä»¶ä¸­åˆ›å»ºçš„ï¼Œä¸€èˆ¬åœ¨ constructor ä¸­åˆå§‹åŒ– stateã€‚state æ˜¯å¤šå˜çš„ã€å¯ä»¥ä¿®æ”¹ï¼Œæ¯æ¬¡ setState éƒ½å¼‚æ­¥æ›´æ–°çš„ã€‚</li></ul><h3 id="10-React-ä¸­çš„-props-ä¸ºä»€ä¹ˆæ˜¯åªè¯»çš„ï¼Ÿ"><a href="#10-React-ä¸­çš„-props-ä¸ºä»€ä¹ˆæ˜¯åªè¯»çš„ï¼Ÿ" class="headerlink" title="10. React ä¸­çš„ props ä¸ºä»€ä¹ˆæ˜¯åªè¯»çš„ï¼Ÿ"></a>10. React ä¸­çš„ props ä¸ºä»€ä¹ˆæ˜¯åªè¯»çš„ï¼Ÿ</h3><p><code>this.props</code>æ˜¯ç»„ä»¶ä¹‹é—´æ²Ÿé€šçš„ä¸€ä¸ªæ¥å£ï¼ŒåŸåˆ™ä¸Šæ¥è®²ï¼Œå®ƒåªèƒ½ä»çˆ¶ç»„ä»¶æµå‘å­ç»„ä»¶ã€‚React å…·æœ‰æµ“é‡çš„å‡½æ•°å¼ç¼–ç¨‹çš„æ€æƒ³ã€‚</p><p>æåˆ°å‡½æ•°å¼ç¼–ç¨‹å°±è¦æä¸€ä¸ªæ¦‚å¿µï¼šçº¯å‡½æ•°ã€‚å®ƒæœ‰å‡ ä¸ªç‰¹ç‚¹ï¼š</p><ul><li>ç»™å®šç›¸åŒçš„è¾“å…¥ï¼Œæ€»æ˜¯è¿”å›ç›¸åŒçš„è¾“å‡ºã€‚</li><li>è¿‡ç¨‹æ²¡æœ‰å‰¯ä½œç”¨ã€‚</li><li>ä¸ä¾èµ–å¤–éƒ¨çŠ¶æ€ã€‚</li></ul><p><code>this.props</code>å°±æ˜¯æ±²å–äº†çº¯å‡½æ•°çš„æ€æƒ³ã€‚props çš„ä¸å¯ä»¥å˜æ€§å°±ä¿è¯çš„ç›¸åŒçš„è¾“å…¥ï¼Œé¡µé¢æ˜¾ç¤ºçš„å†…å®¹æ˜¯ä¸€æ ·çš„ï¼Œå¹¶ä¸”ä¸ä¼šäº§ç”Ÿå‰¯ä½œç”¨</p><h3 id="11-åœ¨-React-ä¸­ç»„ä»¶çš„-props-æ”¹å˜æ—¶æ›´æ–°ç»„ä»¶çš„æœ‰å“ªäº›æ–¹æ³•ï¼Ÿ"><a href="#11-åœ¨-React-ä¸­ç»„ä»¶çš„-props-æ”¹å˜æ—¶æ›´æ–°ç»„ä»¶çš„æœ‰å“ªäº›æ–¹æ³•ï¼Ÿ" class="headerlink" title="11. åœ¨ React ä¸­ç»„ä»¶çš„ props æ”¹å˜æ—¶æ›´æ–°ç»„ä»¶çš„æœ‰å“ªäº›æ–¹æ³•ï¼Ÿ"></a>11. åœ¨ React ä¸­ç»„ä»¶çš„ props æ”¹å˜æ—¶æ›´æ–°ç»„ä»¶çš„æœ‰å“ªäº›æ–¹æ³•ï¼Ÿ</h3><p>åœ¨ä¸€ä¸ªç»„ä»¶ä¼ å…¥çš„ props æ›´æ–°æ—¶é‡æ–°æ¸²æŸ“è¯¥ç»„ä»¶å¸¸ç”¨çš„æ–¹æ³•æ˜¯åœ¨<code>componentWillReceiveProps</code>ä¸­å°†æ–°çš„ props æ›´æ–°åˆ°ç»„ä»¶çš„ state ä¸­ï¼ˆè¿™ç§ state è¢«æˆä¸ºæ´¾ç”ŸçŠ¶æ€ï¼ˆDerived Stateï¼‰ï¼‰ï¼Œä»è€Œå®ç°é‡æ–°æ¸²æŸ“ã€‚React 16.3 ä¸­è¿˜å¼•å…¥äº†ä¸€ä¸ªæ–°çš„é’©å­å‡½æ•°<code>getDerivedStateFromProps</code>æ¥ä¸“é—¨å®ç°è¿™ä¸€éœ€æ±‚ã€‚</p><p><strong>ï¼ˆ1ï¼‰componentWillReceivePropsï¼ˆå·²åºŸå¼ƒï¼‰</strong></p><p>åœ¨ react çš„ componentWillReceiveProps(nextProps)ç”Ÿå‘½å‘¨æœŸä¸­ï¼Œå¯ä»¥åœ¨å­ç»„ä»¶çš„ render å‡½æ•°æ‰§è¡Œå‰ï¼Œé€šè¿‡ this.props è·å–æ—§çš„å±æ€§ï¼Œé€šè¿‡ nextProps è·å–æ–°çš„ propsï¼Œå¯¹æ¯”ä¸¤æ¬¡ props æ˜¯å¦ç›¸åŒï¼Œä»è€Œæ›´æ–°å­ç»„ä»¶è‡ªå·±çš„ stateã€‚</p><p>è¿™æ ·çš„å¥½å¤„æ˜¯ï¼Œå¯ä»¥å°†æ•°æ®è¯·æ±‚æ”¾åœ¨è¿™é‡Œè¿›è¡Œæ‰§è¡Œï¼Œéœ€è¦ä¼ çš„å‚æ•°åˆ™ä» componentWillReceiveProps(nextProps)ä¸­è·å–ã€‚è€Œä¸å¿…å°†æ‰€æœ‰çš„è¯·æ±‚éƒ½æ”¾åœ¨çˆ¶ç»„ä»¶ä¸­ã€‚äºæ˜¯è¯¥è¯·æ±‚åªä¼šåœ¨è¯¥ç»„ä»¶æ¸²æŸ“æ—¶æ‰ä¼šå‘å‡ºï¼Œä»è€Œå‡è½»è¯·æ±‚è´Ÿæ‹…ã€‚</p><p><strong>ï¼ˆ2ï¼‰getDerivedStateFromPropsï¼ˆ16.3 å¼•å…¥ï¼‰</strong></p><p>è¿™ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°æ˜¯ä¸ºäº†æ›¿ä»£<code>componentWillReceiveProps</code>å­˜åœ¨çš„ï¼Œæ‰€ä»¥åœ¨éœ€è¦ä½¿ç”¨<code>componentWillReceiveProps</code>æ—¶ï¼Œå°±å¯ä»¥è€ƒè™‘ä½¿ç”¨<code>getDerivedStateFromProps</code>æ¥è¿›è¡Œæ›¿ä»£ã€‚</p><p>ä¸¤è€…çš„å‚æ•°æ˜¯ä¸ç›¸åŒçš„ï¼Œè€Œ<code>getDerivedStateFromProps</code>æ˜¯ä¸€ä¸ªé™æ€å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªå‡½æ•°ä¸èƒ½é€šè¿‡ this è®¿é—®åˆ° class çš„å±æ€§ï¼Œä¹Ÿå¹¶ä¸æ¨èç›´æ¥è®¿é—®å±æ€§ã€‚è€Œæ˜¯åº”è¯¥é€šè¿‡å‚æ•°æä¾›çš„ nextProps ä»¥åŠ prevState æ¥è¿›è¡Œåˆ¤æ–­ï¼Œæ ¹æ®æ–°ä¼ å…¥çš„ props æ¥æ˜ å°„åˆ° stateã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>å¦‚æœ props ä¼ å…¥çš„å†…å®¹ä¸éœ€è¦å½±å“åˆ°ä½ çš„ stateï¼Œé‚£ä¹ˆå°±éœ€è¦è¿”å›ä¸€ä¸ª null</strong>ï¼Œè¿™ä¸ªè¿”å›å€¼æ˜¯å¿…é¡»çš„ï¼Œæ‰€ä»¥å°½é‡å°†å…¶å†™åˆ°å‡½æ•°çš„æœ«å°¾ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">static</span> <span class="token function">getDerivedStateFromProps</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">,</span> prevState<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span>type<span class="token punctuation">}</span> <span class="token operator">=</span> nextProps<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// å½“ä¼ å…¥çš„typeå‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œæ›´æ–°state</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">!==</span> prevState<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token punctuation">{</span>            type<span class="token punctuation">,</span>        <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// å¦åˆ™ï¼Œå¯¹äºstateä¸è¿›è¡Œä»»ä½•æ“ä½œ</span>    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="12-React-ä¸­æ€ä¹ˆæ£€éªŒ-propsï¼ŸéªŒè¯-props-çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#12-React-ä¸­æ€ä¹ˆæ£€éªŒ-propsï¼ŸéªŒè¯-props-çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="12. React ä¸­æ€ä¹ˆæ£€éªŒ propsï¼ŸéªŒè¯ props çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ"></a>12. React ä¸­æ€ä¹ˆæ£€éªŒ propsï¼ŸéªŒè¯ props çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><strong>React</strong>ä¸ºæˆ‘ä»¬æä¾›äº†<strong>PropTypes</strong>ä»¥ä¾›éªŒè¯ä½¿ç”¨ã€‚å½“æˆ‘ä»¬å‘<strong>Props</strong>ä¼ å…¥çš„æ•°æ®æ— æ•ˆï¼ˆå‘ Props ä¼ å…¥çš„æ•°æ®ç±»å‹å’ŒéªŒè¯çš„æ•°æ®ç±»å‹ä¸ç¬¦ï¼‰å°±ä¼šåœ¨æ§åˆ¶å°å‘å‡ºè­¦å‘Šä¿¡æ¯ã€‚å®ƒå¯ä»¥é¿å…éšç€åº”ç”¨è¶Šæ¥è¶Šå¤æ‚ä»è€Œå‡ºç°çš„é—®é¢˜ã€‚å¹¶ä¸”ï¼Œå®ƒè¿˜å¯ä»¥è®©ç¨‹åºå˜å¾—æ›´æ˜“è¯»ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> PropTypes <span class="token keyword">from</span> <span class="token string">"prop-types"</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Greeting</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token operator">&lt;</span>h1<span class="token operator">></span>Hello<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span>Greeting<span class="token punctuation">.</span>propTypes <span class="token operator">=</span> <span class="token punctuation">{</span>  name<span class="token punctuation">:</span> PropTypes<span class="token punctuation">.</span>string<span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å½“ç„¶ï¼Œå¦‚æœé¡¹ç›®æ±‡ä¸­ä½¿ç”¨äº† TypeScriptï¼Œé‚£ä¹ˆå°±å¯ä»¥ä¸ç”¨ PropTypes æ¥æ ¡éªŒï¼Œè€Œä½¿ç”¨ TypeScript å®šä¹‰æ¥å£æ¥æ ¡éªŒ propsã€‚</p><h2 id="ä¸‰ã€ç”Ÿå‘½å‘¨æœŸ"><a href="#ä¸‰ã€ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ä¸‰ã€ç”Ÿå‘½å‘¨æœŸ"></a>ä¸‰ã€ç”Ÿå‘½å‘¨æœŸ</h2><h3 id="1-React-çš„ç”Ÿå‘½å‘¨æœŸæœ‰å“ªäº›ï¼Ÿ"><a href="#1-React-çš„ç”Ÿå‘½å‘¨æœŸæœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="1. React çš„ç”Ÿå‘½å‘¨æœŸæœ‰å“ªäº›ï¼Ÿ"></a>1. React çš„ç”Ÿå‘½å‘¨æœŸæœ‰å“ªäº›ï¼Ÿ</h3><p>React é€šå¸¸å°†ç»„ä»¶ç”Ÿå‘½å‘¨æœŸåˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š</p><ul><li>è£…è½½é˜¶æ®µï¼ˆMountï¼‰ï¼Œç»„ä»¶ç¬¬ä¸€æ¬¡åœ¨ DOM æ ‘ä¸­è¢«æ¸²æŸ“çš„è¿‡ç¨‹ï¼›</li><li>æ›´æ–°è¿‡ç¨‹ï¼ˆUpdateï¼‰ï¼Œç»„ä»¶çŠ¶æ€å‘ç”Ÿå˜åŒ–ï¼Œé‡æ–°æ›´æ–°æ¸²æŸ“çš„è¿‡ç¨‹ï¼›</li><li>å¸è½½è¿‡ç¨‹ï¼ˆUnmountï¼‰ï¼Œç»„ä»¶ä» DOM æ ‘ä¸­è¢«ç§»é™¤çš„è¿‡ç¨‹ï¼›</li></ul><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/reactreactInterview1/5.png" alt="image.png"></p><h4 id="1ï¼‰ç»„ä»¶æŒ‚è½½é˜¶æ®µ"><a href="#1ï¼‰ç»„ä»¶æŒ‚è½½é˜¶æ®µ" class="headerlink" title="1ï¼‰ç»„ä»¶æŒ‚è½½é˜¶æ®µ"></a>1ï¼‰ç»„ä»¶æŒ‚è½½é˜¶æ®µ</h4><p>æŒ‚è½½é˜¶æ®µç»„ä»¶è¢«åˆ›å»ºï¼Œç„¶åç»„ä»¶å®ä¾‹æ’å…¥åˆ° DOM ä¸­ï¼Œå®Œæˆç»„ä»¶çš„ç¬¬ä¸€æ¬¡æ¸²æŸ“ï¼Œè¯¥è¿‡ç¨‹åªä¼šå‘ç”Ÿä¸€æ¬¡ï¼Œåœ¨æ­¤é˜¶æ®µä¼šä¾æ¬¡è°ƒç”¨ä»¥ä¸‹è¿™äº›æ–¹æ³•ï¼š</p><ul><li>constructor</li><li>getDerivedStateFromProps</li><li>render</li><li>componentDidMount</li></ul><h5 id="ï¼ˆ1ï¼‰constructor"><a href="#ï¼ˆ1ï¼‰constructor" class="headerlink" title="ï¼ˆ1ï¼‰constructor"></a>ï¼ˆ1ï¼‰constructor</h5><p>ç»„ä»¶çš„æ„é€ å‡½æ•°ï¼Œç¬¬ä¸€ä¸ªè¢«æ‰§è¡Œï¼Œè‹¥æ²¡æœ‰æ˜¾å¼å®šä¹‰å®ƒï¼Œä¼šæœ‰ä¸€ä¸ªé»˜è®¤çš„æ„é€ å‡½æ•°ï¼Œä½†æ˜¯è‹¥æ˜¾å¼å®šä¹‰äº†æ„é€ å‡½æ•°ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨æ„é€ å‡½æ•°ä¸­æ‰§è¡Œ <code>super(props)</code>ï¼Œå¦åˆ™æ— æ³•åœ¨æ„é€ å‡½æ•°ä¸­æ‹¿åˆ° thisã€‚</p><p>å¦‚æœä¸åˆå§‹åŒ– state æˆ–ä¸è¿›è¡Œæ–¹æ³•ç»‘å®šï¼Œåˆ™ä¸éœ€è¦ä¸º React ç»„ä»¶å®ç°æ„é€ å‡½æ•°<strong>Constructor</strong>ã€‚</p><p>constructor ä¸­é€šå¸¸åªåšä¸¤ä»¶äº‹ï¼š</p><ul><li>åˆå§‹åŒ–ç»„ä»¶çš„ state</li><li>ç»™äº‹ä»¶å¤„ç†æ–¹æ³•ç»‘å®š this</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// ä¸è¦åœ¨æ„é€ å‡½æ•°ä¸­è°ƒç”¨ setStateï¼Œå¯ä»¥ç›´æ¥ç»™ state è®¾ç½®åˆå§‹å€¼</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span> counter<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token punctuation">}</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>handleClick <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleClick<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="ï¼ˆ2ï¼‰getDerivedStateFromProps"><a href="#ï¼ˆ2ï¼‰getDerivedStateFromProps" class="headerlink" title="ï¼ˆ2ï¼‰getDerivedStateFromProps"></a>ï¼ˆ2ï¼‰getDerivedStateFromProps</h5><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">static</span> <span class="token function">getDerivedStateFromProps</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> state<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™æ˜¯ä¸ªé™æ€æ–¹æ³•ï¼Œæ‰€ä»¥ä¸èƒ½åœ¨è¿™ä¸ªå‡½æ•°é‡Œä½¿ç”¨ <code>this</code>ï¼Œæœ‰ä¸¤ä¸ªå‚æ•° <code>props</code> å’Œ <code>state</code>ï¼Œåˆ†åˆ«æŒ‡æ¥æ”¶åˆ°çš„æ–°å‚æ•°å’Œå½“å‰ç»„ä»¶çš„ <code>state</code> å¯¹è±¡ï¼Œè¿™ä¸ªå‡½æ•°ä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ç”¨æ¥æ›´æ–°å½“å‰çš„ <code>state</code> å¯¹è±¡ï¼Œå¦‚æœä¸éœ€è¦æ›´æ–°å¯ä»¥è¿”å› <code>null</code>ã€‚</p><p>è¯¥å‡½æ•°ä¼šåœ¨è£…è½½æ—¶ï¼Œæ¥æ”¶åˆ°æ–°çš„ <code>props</code> æˆ–è€…è°ƒç”¨äº† <code>setState</code> å’Œ <code>forceUpdate</code> æ—¶è¢«è°ƒç”¨ã€‚å¦‚å½“æ¥æ”¶åˆ°æ–°çš„å±æ€§æƒ³ä¿®æ”¹ <code>state</code> ï¼Œå°±å¯ä»¥ä½¿ç”¨ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// å½“ props.counter å˜åŒ–æ—¶ï¼Œèµ‹å€¼ç»™ state</span><span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>      counter<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">static</span> <span class="token function">getDerivedStateFromProps</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> state<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>props<span class="token punctuation">.</span>counter <span class="token operator">!==</span> state<span class="token punctuation">.</span>counter<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">return</span> <span class="token punctuation">{</span>        counter<span class="token punctuation">:</span> props<span class="token punctuation">.</span>counter<span class="token punctuation">,</span>      <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  handleClick <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>      counter<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>counter <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>div<span class="token operator">></span>        <span class="token operator">&lt;</span>h1 onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleClick<span class="token punctuation">}</span><span class="token operator">></span>Hello<span class="token punctuation">,</span> world<span class="token operator">!</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>counter<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span>      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç°åœ¨å¯ä»¥æ˜¾å¼ä¼ å…¥ <code>counter</code> ï¼Œä½†æ˜¯è¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼Œå¦‚æœæƒ³è¦é€šè¿‡ç‚¹å‡»å®ç° <code>state.counter</code> çš„å¢åŠ ï¼Œä½†è¿™æ—¶ä¼šå‘ç°å€¼ä¸ä¼šå‘ç”Ÿä»»ä½•å˜åŒ–ï¼Œä¸€ç›´ä¿æŒ <code>props</code> ä¼ è¿›æ¥çš„å€¼ã€‚è¿™æ˜¯ç”±äºåœ¨ React 16.4^ çš„ç‰ˆæœ¬ä¸­ <code>setState</code> å’Œ <code>forceUpdate</code> ä¹Ÿä¼šè§¦å‘è¿™ä¸ªç”Ÿå‘½å‘¨æœŸï¼Œæ‰€ä»¥å½“ç»„ä»¶å†…éƒ¨ <code>state</code> å˜åŒ–åï¼Œå°±ä¼šé‡æ–°èµ°è¿™ä¸ªæ–¹æ³•ï¼ŒåŒæ—¶ä¼šæŠŠ <code>state</code> å€¼èµ‹å€¼ä¸º <code>props</code> çš„å€¼ã€‚å› æ­¤éœ€è¦å¤šåŠ ä¸€ä¸ªå­—æ®µæ¥è®°å½•ä¹‹å‰çš„ <code>props</code> å€¼ï¼Œè¿™æ ·å°±ä¼šè§£å†³ä¸Šè¿°é—®é¢˜ã€‚å…·ä½“å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// è¿™é‡Œåªåˆ—å‡ºéœ€è¦å˜åŒ–çš„åœ°æ–¹</span><span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>      <span class="token comment" spellcheck="true">// å¢åŠ ä¸€ä¸ª preCounter æ¥è®°å½•ä¹‹å‰çš„ props ä¼ æ¥çš„å€¼</span>      preCounter<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>      counter<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">static</span> <span class="token function">getDerivedStateFromProps</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> state<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// è·Ÿ state.preCounter è¿›è¡Œæ¯”è¾ƒ</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>props<span class="token punctuation">.</span>counter <span class="token operator">!==</span> state<span class="token punctuation">.</span>preCounter<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">return</span> <span class="token punctuation">{</span>        counter<span class="token punctuation">:</span> props<span class="token punctuation">.</span>counter<span class="token punctuation">,</span>        preCounter<span class="token punctuation">:</span> props<span class="token punctuation">.</span>counter<span class="token punctuation">,</span>      <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  handleClick <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>      counter<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>counter <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>div<span class="token operator">></span>        <span class="token operator">&lt;</span>h1 onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleClick<span class="token punctuation">}</span><span class="token operator">></span>Hello<span class="token punctuation">,</span> world<span class="token operator">!</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>counter<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span>      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="ï¼ˆ3ï¼‰render"><a href="#ï¼ˆ3ï¼‰render" class="headerlink" title="ï¼ˆ3ï¼‰render"></a>ï¼ˆ3ï¼‰render</h5><p>render æ˜¯ React ä¸­æœ€æ ¸å¿ƒçš„æ–¹æ³•ï¼Œä¸€ä¸ªç»„ä»¶ä¸­å¿…é¡»è¦æœ‰è¿™ä¸ªæ–¹æ³•ï¼Œå®ƒä¼šæ ¹æ®çŠ¶æ€ <code>state</code> å’Œå±æ€§ <code>props</code> æ¸²æŸ“ç»„ä»¶ã€‚è¿™ä¸ªå‡½æ•°åªåšä¸€ä»¶äº‹ï¼Œå°±æ˜¯è¿”å›éœ€è¦æ¸²æŸ“çš„å†…å®¹ï¼Œæ‰€ä»¥ä¸è¦åœ¨è¿™ä¸ªå‡½æ•°å†…åšå…¶ä»–ä¸šåŠ¡é€»è¾‘ï¼Œé€šå¸¸è°ƒç”¨è¯¥æ–¹æ³•ä¼šè¿”å›ä»¥ä¸‹ç±»å‹ä¸­ä¸€ä¸ªï¼š</p><ul><li><strong>React å…ƒç´ </strong>ï¼šè¿™é‡ŒåŒ…æ‹¬åŸç”Ÿçš„ DOM ä»¥åŠ React ç»„ä»¶ï¼›</li><li><strong>æ•°ç»„å’Œ Fragmentï¼ˆç‰‡æ®µï¼‰</strong>ï¼šå¯ä»¥è¿”å›å¤šä¸ªå…ƒç´ ï¼›</li><li><strong>Portalsï¼ˆæ’æ§½ï¼‰</strong>ï¼šå¯ä»¥å°†å­å…ƒç´ æ¸²æŸ“åˆ°ä¸åŒçš„ DOM å­æ ‘ç§ï¼›</li><li><strong>å­—ç¬¦ä¸²å’Œæ•°å­—</strong>ï¼šè¢«æ¸²æŸ“æˆ DOM ä¸­çš„ text èŠ‚ç‚¹ï¼›</li><li><strong>å¸ƒå°”å€¼æˆ– null</strong>ï¼šä¸æ¸²æŸ“ä»»ä½•å†…å®¹ã€‚</li></ul><h5 id="ï¼ˆ4ï¼‰componentDidMount"><a href="#ï¼ˆ4ï¼‰componentDidMount" class="headerlink" title="ï¼ˆ4ï¼‰componentDidMount()"></a>ï¼ˆ4ï¼‰componentDidMount()</h5><p>componentDidMount()ä¼šåœ¨ç»„ä»¶æŒ‚è½½åï¼ˆæ’å…¥ DOM æ ‘ä¸­ï¼‰ç«‹å³è°ƒã€‚è¯¥é˜¶æ®µé€šå¸¸è¿›è¡Œä»¥ä¸‹æ“ä½œï¼š</p><ul><li>æ‰§è¡Œä¾èµ–äº DOM çš„æ“ä½œï¼›</li><li>å‘é€ç½‘ç»œè¯·æ±‚ï¼›ï¼ˆå®˜æ–¹å»ºè®®ï¼‰</li><li>æ·»åŠ è®¢é˜…æ¶ˆæ¯ï¼ˆä¼šåœ¨ componentWillUnmount å–æ¶ˆè®¢é˜…ï¼‰ï¼›</li></ul><p>å¦‚æœåœ¨ <code>componentDidMount</code> ä¸­è°ƒç”¨ <code>setState</code> ï¼Œå°±ä¼šè§¦å‘ä¸€æ¬¡é¢å¤–çš„æ¸²æŸ“ï¼Œå¤šè°ƒç”¨äº†ä¸€æ¬¡ <code>render</code> å‡½æ•°ï¼Œç”±äºå®ƒæ˜¯åœ¨æµè§ˆå™¨åˆ·æ–°å±å¹•å‰æ‰§è¡Œçš„ï¼Œæ‰€ä»¥ç”¨æˆ·å¯¹æ­¤æ˜¯æ²¡æœ‰æ„ŸçŸ¥çš„ï¼Œä½†æ˜¯æˆ‘åº”å½“é¿å…è¿™æ ·ä½¿ç”¨ï¼Œè¿™æ ·ä¼šå¸¦æ¥ä¸€å®šçš„æ€§èƒ½é—®é¢˜ï¼Œå°½é‡æ˜¯åœ¨ <code>constructor</code> ä¸­åˆå§‹åŒ– <code>state</code> å¯¹è±¡ã€‚</p><p>åœ¨ç»„ä»¶è£…è½½ä¹‹åï¼Œå°†è®¡æ•°æ•°å­—å˜ä¸º 1ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>      counter<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>      counter<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"counter"</span><span class="token operator">></span>counterå€¼<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>counter<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2ï¼‰ç»„ä»¶æ›´æ–°é˜¶æ®µ"><a href="#2ï¼‰ç»„ä»¶æ›´æ–°é˜¶æ®µ" class="headerlink" title="2ï¼‰ç»„ä»¶æ›´æ–°é˜¶æ®µ"></a>2ï¼‰ç»„ä»¶æ›´æ–°é˜¶æ®µ</h4><p>å½“ç»„ä»¶çš„ <code>props</code> æ”¹å˜äº†ï¼Œæˆ–ç»„ä»¶å†…éƒ¨è°ƒç”¨äº† <code>setState/forceUpdate</code>ï¼Œä¼šè§¦å‘æ›´æ–°é‡æ–°æ¸²æŸ“ï¼Œè¿™ä¸ªè¿‡ç¨‹å¯èƒ½ä¼šå‘ç”Ÿå¤šæ¬¡ã€‚è¿™ä¸ªé˜¶æ®µä¼šä¾æ¬¡è°ƒç”¨ä¸‹é¢è¿™äº›æ–¹æ³•ï¼š</p><ul><li>getDerivedStateFromProps</li><li>shouldComponentUpdate</li><li>render</li><li>getSnapshotBeforeUpdate</li><li>componentDidUpdate</li></ul><h5 id="ï¼ˆ1ï¼‰shouldComponentUpdate"><a href="#ï¼ˆ1ï¼‰shouldComponentUpdate" class="headerlink" title="ï¼ˆ1ï¼‰shouldComponentUpdate"></a>ï¼ˆ1ï¼‰shouldComponentUpdate</h5><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token function">shouldComponentUpdate</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">,</span> nextState<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åœ¨è¯´è¿™ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¹‹å‰ï¼Œæ¥çœ‹ä¸¤ä¸ªé—®é¢˜ï¼š</p><ul><li><strong>setState å‡½æ•°åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½ä¼šå¯¼è‡´ç»„ä»¶é‡æ–°æ¸²æŸ“å—ï¼Ÿä¾‹å¦‚ä¸‹é¢è¿™ç§æƒ…å†µï¼š</strong></li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> number<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>number <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><strong>å¦‚æœæ²¡æœ‰è°ƒç”¨ setStateï¼Œprops å€¼ä¹Ÿæ²¡æœ‰å˜åŒ–ï¼Œæ˜¯ä¸æ˜¯ç»„ä»¶å°±ä¸ä¼šé‡æ–°æ¸²æŸ“ï¼Ÿ</strong></li></ul><p>ç¬¬ä¸€ä¸ªé—®é¢˜ç­”æ¡ˆæ˜¯ <strong>ä¼š</strong> ï¼Œç¬¬äºŒä¸ªé—®é¢˜å¦‚æœæ˜¯çˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“æ—¶ï¼Œä¸ç®¡ä¼ å…¥çš„ props æœ‰æ²¡æœ‰å˜åŒ–ï¼Œéƒ½ä¼šå¼•èµ·å­ç»„ä»¶çš„é‡æ–°æ¸²æŸ“ã€‚</p><p>é‚£ä¹ˆæœ‰æ²¡æœ‰ä»€ä¹ˆæ–¹æ³•è§£å†³åœ¨è¿™ä¸¤ä¸ªåœºæ™¯ä¸‹ä¸è®©ç»„ä»¶é‡æ–°æ¸²æŸ“è¿›è€Œæå‡æ€§èƒ½å‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™ <code>shouldComponentUpdate</code> ç™»åœºäº†ï¼Œè¿™ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°æ˜¯ç”¨æ¥æå‡é€Ÿåº¦çš„ï¼Œå®ƒæ˜¯åœ¨é‡æ–°æ¸²æŸ“ç»„ä»¶å¼€å§‹å‰è§¦å‘çš„ï¼Œé»˜è®¤è¿”å› <code>true</code>ï¼Œå¯ä»¥æ¯”è¾ƒ <code>this.props</code> å’Œ <code>nextProps</code> ï¼Œ<code>this.state</code> å’Œ <code>nextState</code> å€¼æ˜¯å¦å˜åŒ–ï¼Œæ¥ç¡®è®¤è¿”å› true æˆ–è€… <code>false</code>ã€‚å½“è¿”å› <code>false</code> æ—¶ï¼Œç»„ä»¶çš„æ›´æ–°è¿‡ç¨‹åœæ­¢ï¼Œåç»­çš„ <code>render</code>ã€<code>componentDidUpdate</code> ä¹Ÿä¸ä¼šè¢«è°ƒç”¨ã€‚</p><p><strong>æ³¨æ„ï¼š</strong> æ·»åŠ  <code>shouldComponentUpdate</code> æ–¹æ³•æ—¶ï¼Œä¸å»ºè®®ä½¿ç”¨æ·±åº¦ç›¸ç­‰æ£€æŸ¥ï¼ˆå¦‚ä½¿ç”¨ <code>JSON.stringify()</code>ï¼‰ï¼Œå› ä¸ºæ·±æ¯”è¾ƒæ•ˆç‡å¾ˆä½ï¼Œå¯èƒ½ä¼šæ¯”é‡æ–°æ¸²æŸ“ç»„ä»¶æ•ˆç‡è¿˜ä½ã€‚è€Œä¸”è¯¥æ–¹æ³•ç»´æŠ¤æ¯”è¾ƒå›°éš¾ï¼Œå»ºè®®ä½¿ç”¨è¯¥æ–¹æ³•ä¼šäº§ç”Ÿæ˜æ˜¾çš„æ€§èƒ½æå‡æ—¶ä½¿ç”¨ã€‚</p><h5 id="ï¼ˆ2ï¼‰getSnapshotBeforeUpdate"><a href="#ï¼ˆ2ï¼‰getSnapshotBeforeUpdate" class="headerlink" title="ï¼ˆ2ï¼‰getSnapshotBeforeUpdate"></a>ï¼ˆ2ï¼‰getSnapshotBeforeUpdate</h5><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token function">getSnapshotBeforeUpdate</span><span class="token punctuation">(</span>prevProps<span class="token punctuation">,</span> prevState<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™ä¸ªæ–¹æ³•åœ¨ <code>render</code> ä¹‹åï¼Œ<code>componentDidUpdate</code> ä¹‹å‰è°ƒç”¨ï¼Œæœ‰ä¸¤ä¸ªå‚æ•° <code>prevProps</code> å’Œ <code>prevState</code>ï¼Œè¡¨ç¤ºæ›´æ–°ä¹‹å‰çš„ <code>props</code> å’Œ <code>state</code>ï¼Œè¿™ä¸ªå‡½æ•°å¿…é¡»è¦å’Œ <code>componentDidUpdate</code> ä¸€èµ·ä½¿ç”¨ï¼Œå¹¶ä¸”è¦æœ‰ä¸€ä¸ªè¿”å›å€¼ï¼Œé»˜è®¤æ˜¯ <code>null</code>ï¼Œè¿™ä¸ªè¿”å›å€¼ä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°ä¼ ç»™ <code>componentDidUpdate</code>ã€‚</p><h5 id="ï¼ˆ3ï¼‰componentDidUpdate"><a href="#ï¼ˆ3ï¼‰componentDidUpdate" class="headerlink" title="ï¼ˆ3ï¼‰componentDidUpdate"></a>ï¼ˆ3ï¼‰componentDidUpdate</h5><p>componentDidUpdate() ä¼šåœ¨æ›´æ–°åä¼šè¢«ç«‹å³è°ƒç”¨ï¼Œé¦–æ¬¡æ¸²æŸ“ä¸ä¼šæ‰§è¡Œæ­¤æ–¹æ³•ã€‚ è¯¥é˜¶æ®µé€šå¸¸è¿›è¡Œä»¥ä¸‹æ“ä½œï¼š</p><ul><li>å½“ç»„ä»¶æ›´æ–°åï¼Œå¯¹ DOM è¿›è¡Œæ“ä½œï¼›</li><li>å¦‚æœä½ å¯¹æ›´æ–°å‰åçš„ props è¿›è¡Œäº†æ¯”è¾ƒï¼Œä¹Ÿå¯ä»¥é€‰æ‹©åœ¨æ­¤å¤„è¿›è¡Œç½‘ç»œè¯·æ±‚ï¼›ï¼ˆä¾‹å¦‚ï¼Œå½“ props æœªå‘ç”Ÿå˜åŒ–æ—¶ï¼Œåˆ™ä¸ä¼šæ‰§è¡Œç½‘ç»œè¯·æ±‚ï¼‰ã€‚</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token function">componentDidUpdate</span><span class="token punctuation">(</span>prevProps<span class="token punctuation">,</span> prevState<span class="token punctuation">,</span> snapshot<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¯¥æ–¹æ³•æœ‰ä¸‰ä¸ªå‚æ•°ï¼š</p><ul><li>prevProps: æ›´æ–°å‰çš„ props</li><li>prevState: æ›´æ–°å‰çš„ state</li><li>snapshot: getSnapshotBeforeUpdate()ç”Ÿå‘½å‘¨æœŸçš„è¿”å›å€¼</li></ul><h4 id="3ï¼‰ç»„ä»¶å¸è½½é˜¶æ®µ"><a href="#3ï¼‰ç»„ä»¶å¸è½½é˜¶æ®µ" class="headerlink" title="3ï¼‰ç»„ä»¶å¸è½½é˜¶æ®µ"></a>3ï¼‰ç»„ä»¶å¸è½½é˜¶æ®µ</h4><p>å¸è½½é˜¶æ®µåªæœ‰ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼ŒcomponentWillUnmount() ä¼šåœ¨ç»„ä»¶å¸è½½åŠé”€æ¯ä¹‹å‰ç›´æ¥è°ƒç”¨ã€‚åœ¨æ­¤æ–¹æ³•ä¸­æ‰§è¡Œå¿…è¦çš„æ¸…ç†æ“ä½œï¼š</p><ul><li>æ¸…é™¤ timerï¼Œå–æ¶ˆç½‘ç»œè¯·æ±‚æˆ–æ¸…é™¤</li><li>å–æ¶ˆåœ¨ componentDidMount() ä¸­åˆ›å»ºçš„è®¢é˜…ç­‰ï¼›</li></ul><p>è¿™ä¸ªç”Ÿå‘½å‘¨æœŸåœ¨ä¸€ä¸ªç»„ä»¶è¢«å¸è½½å’Œé”€æ¯ä¹‹å‰è¢«è°ƒç”¨ï¼Œå› æ­¤ä½ ä¸åº”è¯¥å†è¿™ä¸ªæ–¹æ³•ä¸­ä½¿ç”¨ <code>setState</code>ï¼Œå› ä¸ºç»„ä»¶ä¸€æ—¦è¢«å¸è½½ï¼Œå°±ä¸ä¼šå†è£…è½½ï¼Œä¹Ÿå°±ä¸ä¼šé‡æ–°æ¸²æŸ“ã€‚</p><h4 id="4ï¼‰é”™è¯¯å¤„ç†é˜¶æ®µ"><a href="#4ï¼‰é”™è¯¯å¤„ç†é˜¶æ®µ" class="headerlink" title="4ï¼‰é”™è¯¯å¤„ç†é˜¶æ®µ"></a>4ï¼‰é”™è¯¯å¤„ç†é˜¶æ®µ</h4><p>componentDidCatch(error, info)ï¼Œæ­¤ç”Ÿå‘½å‘¨æœŸåœ¨åä»£ç»„ä»¶æŠ›å‡ºé”™è¯¯åè¢«è°ƒç”¨ã€‚ å®ƒæ¥æ”¶ä¸¤ä¸ªå‚æ•° âˆ¶</p><ul><li>errorï¼šæŠ›å‡ºçš„é”™è¯¯ã€‚</li><li>infoï¼šå¸¦æœ‰ componentStack key çš„å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«æœ‰å…³ç»„ä»¶å¼•å‘é”™è¯¯çš„æ ˆä¿¡æ¯</li></ul><p>React å¸¸è§çš„ç”Ÿå‘½å‘¨æœŸå¦‚ä¸‹ï¼š<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/reactreactInterview1/6.png" alt="image.png"><br><strong>React å¸¸è§ç”Ÿå‘½å‘¨æœŸçš„è¿‡ç¨‹å¤§è‡´å¦‚ä¸‹ï¼š</strong></p><ul><li>æŒ‚è½½é˜¶æ®µï¼Œé¦–å…ˆæ‰§è¡Œ constructor æ„é€ æ–¹æ³•ï¼Œæ¥åˆ›å»ºç»„ä»¶</li><li>åˆ›å»ºå®Œæˆä¹‹åï¼Œå°±ä¼šæ‰§è¡Œ render æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šè¿”å›éœ€è¦æ¸²æŸ“çš„å†…å®¹</li><li>éšåï¼ŒReact ä¼šå°†éœ€è¦æ¸²æŸ“çš„å†…å®¹æŒ‚è½½åˆ° DOM æ ‘ä¸Š</li><li><strong>æŒ‚è½½å®Œæˆä¹‹åå°±ä¼šæ‰§è¡Œ componentDidMount ç”Ÿå‘½å‘¨æœŸå‡½æ•°</strong></li><li>å¦‚æœæˆ‘ä»¬ç»™ç»„ä»¶åˆ›å»ºä¸€ä¸ª propsï¼ˆç”¨äºç»„ä»¶é€šä¿¡ï¼‰ã€è°ƒç”¨ setStateï¼ˆæ›´æ”¹ state ä¸­çš„æ•°æ®ï¼‰ã€è°ƒç”¨ forceUpdateï¼ˆå¼ºåˆ¶æ›´æ–°ç»„ä»¶ï¼‰æ—¶ï¼Œéƒ½ä¼šé‡æ–°è°ƒç”¨ render å‡½æ•°</li><li>render å‡½æ•°é‡æ–°æ‰§è¡Œä¹‹åï¼Œå°±ä¼šé‡æ–°è¿›è¡Œ DOM æ ‘çš„æŒ‚è½½</li><li><strong>æŒ‚è½½å®Œæˆä¹‹åå°±ä¼šæ‰§è¡Œ componentDidUpdate ç”Ÿå‘½å‘¨æœŸå‡½æ•°</strong></li><li><strong>å½“ç§»é™¤ç»„ä»¶æ—¶ï¼Œå°±ä¼šæ‰§è¡Œ componentWillUnmount ç”Ÿå‘½å‘¨æœŸå‡½æ•°</strong></li></ul><p><strong>React ä¸»è¦ç”Ÿå‘½å‘¨æœŸæ€»ç»“ï¼š</strong></p><ol><li><strong>getDefaultProps</strong>ï¼šè¿™ä¸ªå‡½æ•°ä¼šåœ¨ç»„ä»¶åˆ›å»ºä¹‹å‰è¢«è°ƒç”¨ä¸€æ¬¡ï¼ˆæœ‰ä¸”ä»…æœ‰ä¸€æ¬¡ï¼‰ï¼Œå®ƒè¢«ç”¨æ¥åˆå§‹åŒ–ç»„ä»¶çš„ Propsï¼›</li><li><strong>getInitialState</strong>ï¼šç”¨äºåˆå§‹åŒ–ç»„ä»¶çš„ state å€¼ï¼›</li><li><strong>componentWillMount</strong>ï¼šåœ¨ç»„ä»¶åˆ›å»ºåã€render ä¹‹å‰ï¼Œä¼šèµ°åˆ° componentWillMount é˜¶æ®µã€‚è¿™ä¸ªé˜¶æ®µæˆ‘ä¸ªäººä¸€ç›´æ²¡ç”¨è¿‡ã€éå¸¸é¸¡è‚‹ã€‚åæ¥ React å®˜æ–¹å·²ç»ä¸æ¨èå¤§å®¶åœ¨ componentWillMount é‡Œåšä»»ä½•äº‹æƒ…ã€åˆ°ç°åœ¨ <strong>React16 ç›´æ¥åºŸå¼ƒäº†è¿™ä¸ªç”Ÿå‘½å‘¨æœŸ</strong>ï¼Œè¶³è§å…¶é¸¡è‚‹ç¨‹åº¦äº†ï¼›</li><li><strong>render</strong>ï¼šè¿™æ˜¯æ‰€æœ‰ç”Ÿå‘½å‘¨æœŸä¸­å”¯ä¸€ä¸€ä¸ªä½ å¿…é¡»è¦å®ç°çš„æ–¹æ³•ã€‚ä¸€èˆ¬æ¥è¯´éœ€è¦è¿”å›ä¸€ä¸ª jsx å…ƒç´ ï¼Œè¿™æ—¶ React ä¼šæ ¹æ® props å’Œ state æ¥æŠŠç»„ä»¶æ¸²æŸ“åˆ°ç•Œé¢ä¸Šï¼›ä¸è¿‡æœ‰æ—¶ï¼Œä½ å¯èƒ½ä¸æƒ³æ¸²æŸ“ä»»ä½•ä¸œè¥¿ï¼Œè¿™ç§æƒ…å†µä¸‹è®©å®ƒè¿”å› null æˆ–è€… false å³å¯ï¼›</li><li><strong>componentDidMount</strong>ï¼šä¼šåœ¨ç»„ä»¶æŒ‚è½½åï¼ˆæ’å…¥ DOM æ ‘ä¸­åï¼‰ç«‹å³è°ƒç”¨ï¼Œæ ‡å¿—ç€ç»„ä»¶æŒ‚è½½å®Œæˆã€‚ä¸€äº›æ“ä½œå¦‚æœä¾èµ–è·å–åˆ° DOM èŠ‚ç‚¹ä¿¡æ¯ï¼Œæˆ‘ä»¬å°±ä¼šæ”¾åœ¨è¿™ä¸ªé˜¶æ®µæ¥åšã€‚æ­¤å¤–ï¼Œè¿™è¿˜æ˜¯ React å®˜æ–¹æ¨èçš„å‘èµ· ajax è¯·æ±‚çš„æ—¶æœºã€‚è¯¥æ–¹æ³•å’Œ componentWillMount ä¸€æ ·ï¼Œæœ‰ä¸”ä»…æœ‰ä¸€æ¬¡è°ƒç”¨ã€‚</li></ol><h3 id="2-React-åºŸå¼ƒäº†å“ªäº›ç”Ÿå‘½å‘¨æœŸï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ"><a href="#2-React-åºŸå¼ƒäº†å“ªäº›ç”Ÿå‘½å‘¨æœŸï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ" class="headerlink" title="2. React åºŸå¼ƒäº†å“ªäº›ç”Ÿå‘½å‘¨æœŸï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ"></a>2. React åºŸå¼ƒäº†å“ªäº›ç”Ÿå‘½å‘¨æœŸï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</h3><p>è¢«åºŸå¼ƒçš„ä¸‰ä¸ªå‡½æ•°éƒ½æ˜¯åœ¨ render ä¹‹å‰ï¼Œå› ä¸º fber çš„å‡ºç°ï¼Œå¾ˆå¯èƒ½å› ä¸ºé«˜ä¼˜å…ˆçº§ä»»åŠ¡çš„å‡ºç°è€Œæ‰“æ–­ç°æœ‰ä»»åŠ¡å¯¼è‡´å®ƒä»¬ä¼šè¢«æ‰§è¡Œå¤šæ¬¡ã€‚å¦å¤–çš„ä¸€ä¸ªåŸå› åˆ™æ˜¯ï¼ŒReact æƒ³çº¦æŸä½¿ç”¨è€…ï¼Œå¥½çš„æ¡†æ¶èƒ½å¤Ÿè®©äººä¸å¾—å·²å†™å‡ºå®¹æ˜“ç»´æŠ¤å’Œæ‰©å±•çš„ä»£ç ï¼Œè¿™ä¸€ç‚¹åˆæ˜¯ä»ä½•è°ˆèµ·ï¼Œå¯ä»¥ä»æ–°å¢åŠ ä»¥åŠå³å°†åºŸå¼ƒçš„ç”Ÿå‘½å‘¨æœŸåˆ†æå…¥æ‰‹</p><p><strong>1) componentWillMount</strong></p><p>é¦–å…ˆè¿™ä¸ªå‡½æ•°çš„åŠŸèƒ½å®Œå…¨å¯ä»¥ä½¿ç”¨ componentDidMount å’Œ constructor æ¥ä»£æ›¿ï¼Œå¼‚æ­¥è·å–çš„æ•°æ®çš„æƒ…å†µä¸Šé¢å·²ç»è¯´æ˜äº†ï¼Œè€Œå¦‚æœæŠ›å»å¼‚æ­¥è·å–æ•°æ®ï¼Œå…¶ä½™çš„å³æ˜¯åˆå§‹åŒ–è€Œå·²ï¼Œè¿™äº›åŠŸèƒ½éƒ½å¯ä»¥åœ¨ constructor ä¸­æ‰§è¡Œï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œå¦‚æœåœ¨ willMount ä¸­è®¢é˜…äº‹ä»¶ï¼Œä½†åœ¨æœåŠ¡ç«¯è¿™å¹¶ä¸ä¼šæ‰§è¡Œ willUnMount äº‹ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´æœåŠ¡ç«¯ä¼šå¯¼è‡´å†…å­˜æ³„æ¼æ‰€ä»¥ componentWilIMount å®Œå…¨å¯ä»¥ä¸ä½¿ç”¨ï¼Œä½†ä½¿ç”¨è€…æœ‰æ—¶å€™éš¾å…å› ä¸ºå„ ç§å„æ ·çš„æƒ…å†µåœ¨ componentWilMount ä¸­åšä¸€äº›æ“ä½œï¼Œé‚£ä¹ˆ React ä¸ºäº†çº¦æŸå¼€å‘è€…ï¼Œå¹²è„†å°±æŠ›æ‰äº†è¿™ä¸ª API</p><p><strong>2) componentWillReceiveProps</strong></p><p>åœ¨è€ç‰ˆæœ¬çš„ React ä¸­ï¼Œå¦‚æœç»„ä»¶è‡ªèº«çš„æŸä¸ª state è·Ÿå…¶ props å¯†åˆ‡ç›¸å…³çš„è¯ï¼Œä¸€ç›´éƒ½æ²¡æœ‰ä¸€ç§å¾ˆä¼˜é›…çš„å¤„ç†æ–¹å¼å»æ›´æ–° stateï¼Œè€Œæ˜¯éœ€è¦åœ¨ componentWilReceiveProps ä¸­åˆ¤æ–­å‰åä¸¤ä¸ª props æ˜¯å¦ç›¸åŒï¼Œå¦‚æœä¸åŒå†å°†æ–°çš„ props æ›´æ–°åˆ°ç›¸åº”çš„ state ä¸Šå»ã€‚è¿™æ ·åšä¸€æ¥ä¼šç ´å state æ•°æ®çš„å•ä¸€æ•°æ®æºï¼Œå¯¼è‡´ç»„ä»¶çŠ¶æ€å˜å¾—ä¸å¯é¢„æµ‹ï¼Œå¦ä¸€æ–¹é¢ä¹Ÿä¼šå¢åŠ ç»„ä»¶çš„é‡ç»˜æ¬¡æ•°ã€‚ç±»ä¼¼çš„ä¸šåŠ¡éœ€æ±‚ä¹Ÿæœ‰å¾ˆå¤šï¼Œå¦‚ä¸€ä¸ªå¯ä»¥æ¨ªå‘æ»‘åŠ¨çš„åˆ—è¡¨ï¼Œå½“å‰é«˜äº®çš„ Tab æ˜¾ç„¶éš¶å±äºåˆ—è¡¨è‡ªèº«çš„æ—¶ï¼Œæ ¹æ®ä¼ å…¥çš„æŸä¸ªå€¼ï¼Œç›´æ¥å®šä½åˆ°æŸä¸ª Tabã€‚ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼ŒReact å¼•å…¥äº†ç¬¬ä¸€ä¸ªæ–°çš„ç”Ÿå‘½å‘¨æœŸï¼šgetDerivedStateFromPropsã€‚å®ƒæœ‰ä»¥ä¸‹çš„ä¼˜ç‚¹ âˆ¶</p><ul><li>getDSFP æ˜¯é™æ€æ–¹æ³•ï¼Œåœ¨è¿™é‡Œä¸èƒ½ä½¿ç”¨ thisï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œå¼€å‘è€…ä¸èƒ½å†™å‡ºå‰¯ä½œç”¨çš„ä»£ç </li><li>å¼€å‘è€…åªèƒ½é€šè¿‡ prevState è€Œä¸æ˜¯ prevProps æ¥åšå¯¹æ¯”ï¼Œä¿è¯äº† state å’Œ props ä¹‹é—´çš„ç®€å•å…³ç³»ä»¥åŠä¸éœ€è¦å¤„ç†ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶ prevProps ä¸ºç©ºçš„æƒ…å†µ</li><li>åŸºäºç¬¬ä¸€ç‚¹ï¼Œå°†çŠ¶æ€å˜åŒ–ï¼ˆsetStateï¼‰å’Œæ˜‚è´µæ“ä½œï¼ˆtabChangeï¼‰åŒºåˆ†å¼€ï¼Œæ›´åŠ ä¾¿äº render å’Œ commit é˜¶æ®µæ“ä½œæˆ–è€…è¯´ä¼˜åŒ–ã€‚</li></ul><p><strong>3) componentWillUpdate</strong></p><p>ä¸ componentWillReceiveProps ç±»ä¼¼ï¼Œè®¸å¤šå¼€å‘è€…ä¹Ÿä¼šåœ¨ componentWillUpdate ä¸­æ ¹æ® props çš„å˜åŒ–å»è§¦å‘ä¸€äº›å›è°ƒ ã€‚ ä½†ä¸è®ºæ˜¯ componentWilReceiveProps è¿˜ æ˜¯ componentWilUpdateï¼Œéƒ½æœ‰å¯èƒ½åœ¨ä¸€æ¬¡æ›´æ–°ä¸­è¢«è°ƒç”¨å¤šæ¬¡ï¼Œä¹Ÿå°±æ˜¯è¯´å†™åœ¨è¿™é‡Œçš„å›è°ƒå‡½æ•°ä¹Ÿæœ‰å¯èƒ½ä¼šè¢«è°ƒç”¨å¤šæ¬¡ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸å¯å–çš„ã€‚ä¸ componentDidMount ç±» ä¼¼ï¼Œ componentDidUpdate ä¹Ÿä¸å­˜åœ¨è¿™æ ·çš„é—®é¢˜ï¼Œä¸€æ¬¡æ›´æ–°ä¸­ componentDidUpdate åªä¼šè¢«è°ƒç”¨ä¸€æ¬¡ï¼Œæ‰€ä»¥å°†åŸå…ˆå†™åœ¨ componentWillUpdate ä¸­ çš„ å› è°ƒ è¿ ç§» è‡³ componentDidUpdate å°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p>å¦å¤–ä¸€ç§æƒ…å†µåˆ™æ˜¯éœ€è¦è·å– DOM å…ƒç´ çŠ¶æ€ï¼Œä½†æ˜¯ç”±äºåœ¨ fber ä¸­ï¼Œrender å¯æ‰“æ–­ï¼Œå¯èƒ½åœ¨ wilMount ä¸­è·å–åˆ°çš„å…ƒç´ çŠ¶æ€å¾ˆå¯èƒ½ä¸å®é™…éœ€è¦çš„ä¸åŒï¼Œè¿™ä¸ªé€šå¸¸å¯ä»¥ä½¿ç”¨ç¬¬äºŒä¸ªæ–°å¢çš„ç”Ÿå‘½å‡½æ•°çš„è§£å†³ getSnapshotBeforeUpdate(prevProps, prevState)</p><p><strong>4) getSnapshotBeforeUpdate(prevProps, prevState)</strong></p><p>è¿”å›çš„å€¼ä½œä¸º componentDidUpdate çš„ç¬¬ä¸‰ä¸ªå‚æ•°ã€‚ä¸ willMount ä¸åŒçš„æ˜¯ï¼ŒgetSnapshotBeforeUpdate ä¼šåœ¨æœ€ç»ˆç¡®å®šçš„ render æ‰§è¡Œä¹‹å‰æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯èƒ½ä¿è¯å…¶è·å–åˆ°çš„å…ƒç´ çŠ¶æ€ä¸ didUpdate ä¸­è·å–åˆ°çš„å…ƒç´ çŠ¶æ€ç›¸åŒã€‚å®˜æ–¹å‚è€ƒä»£ç ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">ScrollingList</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>listRef <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">getSnapshotBeforeUpdate</span><span class="token punctuation">(</span>prevProps<span class="token punctuation">,</span> prevState<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// æˆ‘ä»¬æ˜¯å¦åœ¨ list ä¸­æ·»åŠ æ–°çš„ items ï¼Ÿ</span>    <span class="token comment" spellcheck="true">// æ•è·æ»šåŠ¨â€‹â€‹ä½ç½®ä»¥ä¾¿æˆ‘ä»¬ç¨åè°ƒæ•´æ»šåŠ¨ä½ç½®ã€‚</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>prevProps<span class="token punctuation">.</span>list<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>list<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>listRef<span class="token punctuation">.</span>current<span class="token punctuation">;</span>      <span class="token keyword">return</span> list<span class="token punctuation">.</span>scrollHeight <span class="token operator">-</span> list<span class="token punctuation">.</span>scrollTop<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">componentDidUpdate</span><span class="token punctuation">(</span>prevProps<span class="token punctuation">,</span> prevState<span class="token punctuation">,</span> snapshot<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// å¦‚æœæˆ‘ä»¬ snapshot æœ‰å€¼ï¼Œè¯´æ˜æˆ‘ä»¬åˆšåˆšæ·»åŠ äº†æ–°çš„ itemsï¼Œ</span>    <span class="token comment" spellcheck="true">// è°ƒæ•´æ»šåŠ¨ä½ç½®ä½¿å¾—è¿™äº›æ–° items ä¸ä¼šå°†æ—§çš„ items æ¨å‡ºè§†å›¾ã€‚</span>    <span class="token comment" spellcheck="true">//ï¼ˆè¿™é‡Œçš„ snapshot æ˜¯ getSnapshotBeforeUpdate çš„è¿”å›å€¼ï¼‰</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>snapshot <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>listRef<span class="token punctuation">.</span>current<span class="token punctuation">;</span>      list<span class="token punctuation">.</span>scrollTop <span class="token operator">=</span> list<span class="token punctuation">.</span>scrollHeight <span class="token operator">-</span> snapshot<span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div ref<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>listRef<span class="token punctuation">}</span><span class="token operator">></span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">/* ...contents... */</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-React-16-X-ä¸­-props-æ”¹å˜ååœ¨å“ªä¸ªç”Ÿå‘½å‘¨æœŸä¸­å¤„ç†"><a href="#3-React-16-X-ä¸­-props-æ”¹å˜ååœ¨å“ªä¸ªç”Ÿå‘½å‘¨æœŸä¸­å¤„ç†" class="headerlink" title="3. React 16.X ä¸­ props æ”¹å˜ååœ¨å“ªä¸ªç”Ÿå‘½å‘¨æœŸä¸­å¤„ç†"></a>3. React 16.X ä¸­ props æ”¹å˜ååœ¨å“ªä¸ªç”Ÿå‘½å‘¨æœŸä¸­å¤„ç†</h3><p><strong>åœ¨ getDerivedStateFromProps ä¸­è¿›è¡Œå¤„ç†ã€‚</strong></p><p>è¿™ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°æ˜¯ä¸ºäº†æ›¿ä»£<code>componentWillReceiveProps</code>å­˜åœ¨çš„ï¼Œæ‰€ä»¥åœ¨éœ€è¦ä½¿ç”¨<code>componentWillReceiveProps</code>æ—¶ï¼Œå°±å¯ä»¥è€ƒè™‘ä½¿ç”¨<code>getDerivedStateFromProps</code>æ¥è¿›è¡Œæ›¿ä»£ã€‚</p><p>ä¸¤è€…çš„å‚æ•°æ˜¯ä¸ç›¸åŒçš„ï¼Œè€Œ<code>getDerivedStateFromProps</code>æ˜¯ä¸€ä¸ªé™æ€å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªå‡½æ•°ä¸èƒ½é€šè¿‡ this è®¿é—®åˆ° class çš„å±æ€§ï¼Œä¹Ÿå¹¶ä¸æ¨èç›´æ¥è®¿é—®å±æ€§ã€‚è€Œæ˜¯åº”è¯¥é€šè¿‡å‚æ•°æä¾›çš„ nextProps ä»¥åŠ prevState æ¥è¿›è¡Œåˆ¤æ–­ï¼Œæ ¹æ®æ–°ä¼ å…¥çš„ props æ¥æ˜ å°„åˆ° stateã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>å¦‚æœ props ä¼ å…¥çš„å†…å®¹ä¸éœ€è¦å½±å“åˆ°ä½ çš„ stateï¼Œé‚£ä¹ˆå°±éœ€è¦è¿”å›ä¸€ä¸ª null</strong>ï¼Œè¿™ä¸ªè¿”å›å€¼æ˜¯å¿…é¡»çš„ï¼Œæ‰€ä»¥å°½é‡å°†å…¶å†™åˆ°å‡½æ•°çš„æœ«å°¾ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">static</span> <span class="token function">getDerivedStateFromProps</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">,</span> prevState<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span>type<span class="token punctuation">}</span> <span class="token operator">=</span> nextProps<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// å½“ä¼ å…¥çš„typeå‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œæ›´æ–°state</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">!==</span> prevState<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token punctuation">{</span>            type<span class="token punctuation">,</span>        <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// å¦åˆ™ï¼Œå¯¹äºstateä¸è¿›è¡Œä»»ä½•æ“ä½œ</span>    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-React-æ€§èƒ½ä¼˜åŒ–åœ¨å“ªä¸ªç”Ÿå‘½å‘¨æœŸï¼Ÿå®ƒä¼˜åŒ–çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#4-React-æ€§èƒ½ä¼˜åŒ–åœ¨å“ªä¸ªç”Ÿå‘½å‘¨æœŸï¼Ÿå®ƒä¼˜åŒ–çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="4. React æ€§èƒ½ä¼˜åŒ–åœ¨å“ªä¸ªç”Ÿå‘½å‘¨æœŸï¼Ÿå®ƒä¼˜åŒ–çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"></a>4. React æ€§èƒ½ä¼˜åŒ–åœ¨å“ªä¸ªç”Ÿå‘½å‘¨æœŸï¼Ÿå®ƒä¼˜åŒ–çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>react çš„çˆ¶çº§ç»„ä»¶çš„ render å‡½æ•°é‡æ–°æ¸²æŸ“ä¼šå¼•èµ·å­ç»„ä»¶çš„ render æ–¹æ³•çš„é‡æ–°æ¸²æŸ“ã€‚ä½†æ˜¯ï¼Œæœ‰çš„æ—¶å€™å­ç»„ä»¶çš„æ¥å—çˆ¶ç»„ä»¶çš„æ•°æ®æ²¡æœ‰å˜åŠ¨ã€‚å­ç»„ä»¶ render çš„æ‰§è¡Œä¼šå½±å“æ€§èƒ½ï¼Œè¿™æ—¶å°±å¯ä»¥ä½¿ç”¨ shouldComponentUpdate æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p>ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token function">shouldComponentUpdate</span><span class="token punctuation">(</span>nexrProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>num <span class="token operator">===</span> nexrProps<span class="token punctuation">.</span>num<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token boolean">false</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>shouldComponentUpdate æä¾›äº†ä¸¤ä¸ªå‚æ•° nextProps å’Œ nextStateï¼Œè¡¨ç¤ºä¸‹ä¸€æ¬¡ props å’Œä¸€æ¬¡ state çš„å€¼ï¼Œå½“å‡½æ•°è¿”å› false æ—¶å€™ï¼Œrender()æ–¹æ³•ä¸æ‰§è¡Œï¼Œç»„ä»¶ä¹Ÿå°±ä¸ä¼šæ¸²æŸ“ï¼Œè¿”å› true æ—¶ï¼Œç»„ä»¶ç…§å¸¸é‡æ¸²æŸ“ã€‚æ­¤æ–¹æ³•å°±æ˜¯æ‹¿å½“å‰ props ä¸­å€¼å’Œä¸‹ä¸€æ¬¡ props ä¸­çš„å€¼è¿›è¡Œå¯¹æ¯”ï¼Œæ•°æ®ç›¸ç­‰æ—¶ï¼Œè¿”å› falseï¼Œåä¹‹è¿”å› trueã€‚</p><p>éœ€è¦æ³¨æ„ï¼Œåœ¨è¿›è¡Œæ–°æ—§å¯¹æ¯”çš„æ—¶å€™ï¼Œæ˜¯<strong>æµ…å¯¹æ¯”ï¼Œ</strong>ä¹Ÿå°±æ˜¯è¯´å¦‚æœæ¯”è¾ƒçš„æ•°æ®æ—¶å¼•ç”¨æ•°æ®ç±»å‹ï¼Œåªè¦æ•°æ®çš„å¼•ç”¨çš„åœ°å€æ²¡å˜ï¼Œå³ä½¿å†…å®¹å˜äº†ï¼Œä¹Ÿä¼šè¢«åˆ¤å®šä¸º trueã€‚</p><p>é¢å¯¹è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹æ³•è¿›è¡Œè§£å†³ï¼š<br>ï¼ˆ1ï¼‰ä½¿ç”¨ setState æ”¹å˜æ•°æ®ä¹‹å‰ï¼Œå…ˆé‡‡ç”¨ ES6 ä¸­ assgin è¿›è¡Œæ‹·è´ï¼Œä½†æ˜¯ assgin åªæ·±æ‹·è´çš„æ•°æ®çš„ç¬¬ä¸€å±‚ï¼Œæ‰€ä»¥è¯´ä¸æ˜¯æœ€å®Œç¾çš„è§£å†³åŠæ³•ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> o2 <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>o2<span class="token punctuation">.</span>student<span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token string">"00000"</span><span class="token punctuation">;</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  obj<span class="token punctuation">:</span> o2<span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ï¼ˆ2ï¼‰ä½¿ç”¨ JSON.parse(JSON.stringfy())è¿›è¡Œæ·±æ‹·è´ï¼Œä½†æ˜¯é‡åˆ°æ•°æ®ä¸º undefined å’Œå‡½æ•°æ—¶å°±ä¼šé”™ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> o2 <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>JSON<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>o2<span class="token punctuation">.</span>student<span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token string">"00000"</span><span class="token punctuation">;</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  obj<span class="token punctuation">:</span> o2<span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-state-å’Œ-props-è§¦å‘æ›´æ–°çš„ç”Ÿå‘½å‘¨æœŸåˆ†åˆ«æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#5-state-å’Œ-props-è§¦å‘æ›´æ–°çš„ç”Ÿå‘½å‘¨æœŸåˆ†åˆ«æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="5. state å’Œ props è§¦å‘æ›´æ–°çš„ç”Ÿå‘½å‘¨æœŸåˆ†åˆ«æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>5. state å’Œ props è§¦å‘æ›´æ–°çš„ç”Ÿå‘½å‘¨æœŸåˆ†åˆ«æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p><strong>state æ›´æ–°æµç¨‹ï¼š</strong><br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/reactreactInterview1/7.png" alt=""><br>è¿™ä¸ªè¿‡ç¨‹å½“ä¸­æ¶‰åŠçš„å‡½æ•°ï¼š</p><ol><li>shouldComponentUpdate: å½“ç»„ä»¶çš„ state æˆ– props å‘ç”Ÿæ”¹å˜æ—¶ï¼Œéƒ½ä¼šé¦–å…ˆè§¦å‘è¿™ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°ã€‚å®ƒä¼šæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šnextProps, nextStateâ€”â€”å®ƒä»¬åˆ†åˆ«ä»£è¡¨ä¼ å…¥çš„æ–° props å’Œæ–°çš„ state å€¼ã€‚æ‹¿åˆ°è¿™ä¸¤ä¸ªå€¼ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¸€äº›å¯¹æ¯”é€»è¾‘æ¥å†³å®šæ˜¯å¦æœ‰ re-renderï¼ˆé‡æ¸²æŸ“ï¼‰çš„å¿…è¦äº†ã€‚å¦‚æœè¯¥å‡½æ•°çš„è¿”å›å€¼ä¸º falseï¼Œåˆ™ç”Ÿå‘½å‘¨æœŸç»ˆæ­¢ï¼Œåä¹‹ç»§ç»­ï¼›</li></ol><blockquote><p>æ³¨æ„ï¼šæ­¤æ–¹æ³•ä»…ä½œä¸º<strong>æ€§èƒ½ä¼˜åŒ–çš„æ–¹å¼</strong>è€Œå­˜åœ¨ã€‚ä¸è¦ä¼å›¾ä¾é æ­¤æ–¹æ³•æ¥â€œé˜»æ­¢â€æ¸²æŸ“ï¼Œå› ä¸ºè¿™å¯èƒ½ä¼šäº§ç”Ÿ bugã€‚åº”è¯¥<strong>è€ƒè™‘ä½¿ç”¨å†…ç½®çš„ PureComponent ç»„ä»¶</strong>ï¼Œè€Œä¸æ˜¯æ‰‹åŠ¨ç¼–å†™ <code>shouldComponentUpdate()</code></p></blockquote><ol start="2"><li>componentWillUpdateï¼šå½“ç»„ä»¶çš„ state æˆ– props å‘ç”Ÿæ”¹å˜æ—¶ï¼Œä¼šåœ¨æ¸²æŸ“ä¹‹å‰è°ƒç”¨ componentWillUpdateã€‚componentWillUpdate <strong>æ˜¯ React16 åºŸå¼ƒçš„ä¸‰ä¸ªç”Ÿå‘½å‘¨æœŸä¹‹ä¸€</strong>ã€‚è¿‡å»ï¼Œæˆ‘ä»¬å¯èƒ½å¸Œæœ›èƒ½åœ¨è¿™ä¸ªé˜¶æ®µå»æ”¶é›†ä¸€äº›å¿…è¦çš„ä¿¡æ¯ï¼ˆæ¯”å¦‚æ›´æ–°å‰çš„ DOM ä¿¡æ¯ç­‰ç­‰ï¼‰ï¼Œç°åœ¨æˆ‘ä»¬å®Œå…¨å¯ä»¥åœ¨ React16 çš„ getSnapshotBeforeUpdate ä¸­å»åšè¿™äº›äº‹ï¼›</li><li>componentDidUpdateï¼šcomponentDidUpdate() ä¼šåœ¨ UI æ›´æ–°åä¼šè¢«ç«‹å³è°ƒç”¨ã€‚å®ƒæ¥æ”¶ prevPropsï¼ˆä¸Šä¸€æ¬¡çš„ props å€¼ï¼‰ä½œä¸ºå…¥å‚ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨æ­¤å¤„æˆ‘ä»¬ä»ç„¶å¯ä»¥è¿›è¡Œ props å€¼å¯¹æ¯”ï¼ˆå†æ¬¡è¯´æ˜ componentWillUpdate ç¡®å®é¸¡è‚‹å“ˆï¼‰ã€‚</li></ol><p><strong>â€‹</strong></p><p><strong>props æ›´æ–°æµç¨‹ï¼š</strong><br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/reactreactInterview1/8.png" alt=""><br>ç›¸å¯¹äº state æ›´æ–°ï¼Œprops æ›´æ–°åå”¯ä¸€çš„åŒºåˆ«æ˜¯å¢åŠ äº†å¯¹ componentWillReceiveProps çš„è°ƒç”¨ã€‚å…³äº componentWillReceivePropsï¼Œéœ€è¦çŸ¥é“è¿™äº›äº‹æƒ…ï¼š</p><ul><li>componentWillReceivePropsï¼šå®ƒåœ¨ Component æ¥å—åˆ°æ–°çš„ props æ—¶è¢«è§¦å‘ã€‚componentWillReceiveProps ä¼šæ¥æ”¶ä¸€ä¸ªåä¸º nextProps çš„å‚æ•°ï¼ˆå¯¹åº”æ–°çš„ props å€¼ï¼‰ã€‚<strong>è¯¥ç”Ÿå‘½å‘¨æœŸæ˜¯ React16 åºŸå¼ƒæ‰çš„ä¸‰ä¸ªç”Ÿå‘½å‘¨æœŸä¹‹ä¸€</strong>ã€‚åœ¨å®ƒè¢«åºŸå¼ƒå‰ï¼Œå¯ä»¥ç”¨å®ƒæ¥æ¯”è¾ƒ this.props å’Œ nextProps æ¥é‡æ–° setStateã€‚åœ¨ React16 ä¸­ï¼Œç”¨ä¸€ä¸ªç±»ä¼¼çš„æ–°ç”Ÿå‘½å‘¨æœŸ getDerivedStateFromProps æ¥ä»£æ›¿å®ƒã€‚</li></ul><h3 id="6-React-ä¸­å‘èµ·ç½‘ç»œè¯·æ±‚åº”è¯¥åœ¨å“ªä¸ªç”Ÿå‘½å‘¨æœŸä¸­è¿›è¡Œï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ"><a href="#6-React-ä¸­å‘èµ·ç½‘ç»œè¯·æ±‚åº”è¯¥åœ¨å“ªä¸ªç”Ÿå‘½å‘¨æœŸä¸­è¿›è¡Œï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ" class="headerlink" title="6. React ä¸­å‘èµ·ç½‘ç»œè¯·æ±‚åº”è¯¥åœ¨å“ªä¸ªç”Ÿå‘½å‘¨æœŸä¸­è¿›è¡Œï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ"></a>6. React ä¸­å‘èµ·ç½‘ç»œè¯·æ±‚åº”è¯¥åœ¨å“ªä¸ªç”Ÿå‘½å‘¨æœŸä¸­è¿›è¡Œï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</h3><p>å¯¹äºå¼‚æ­¥è¯·æ±‚ï¼Œæœ€å¥½æ”¾åœ¨ componentDidMount ä¸­å»æ“ä½œï¼Œå¯¹äºåŒæ­¥çš„çŠ¶æ€æ”¹å˜ï¼Œå¯ä»¥æ”¾åœ¨ componentWillMount ä¸­ï¼Œä¸€èˆ¬ç”¨çš„æ¯”è¾ƒå°‘ã€‚</p><p>å¦‚æœè®¤ä¸ºåœ¨ componentWillMount é‡Œå‘èµ·è¯·æ±‚èƒ½ææ—©è·å¾—ç»“æœï¼Œè¿™ç§æƒ³æ³•å…¶å®æ˜¯é”™è¯¯çš„ï¼Œé€šå¸¸ componentWillMount æ¯” componentDidMount æ—©ä¸äº†å¤šå°‘å¾®ç§’ï¼Œç½‘ç»œä¸Šä»»ä½•ä¸€ç‚¹å»¶è¿Ÿï¼Œè¿™ä¸€ç‚¹å·®å¼‚éƒ½å¯å¿½ç•¥ä¸è®¡ã€‚</p><p><strong>react çš„ç”Ÿå‘½å‘¨æœŸï¼š</strong> constructor() -&gt; componentWillMount() -&gt; render() -&gt; componentDidMount()</p><p>ä¸Šé¢è¿™äº›æ–¹æ³•çš„è°ƒç”¨æ˜¯æœ‰æ¬¡åºçš„ï¼Œç”±ä¸Šè€Œä¸‹ä¾æ¬¡è°ƒç”¨ã€‚</p><ul><li>constructor è¢«è°ƒç”¨æ˜¯åœ¨ç»„ä»¶å‡†å¤‡è¦æŒ‚è½½çš„æœ€å¼€å§‹ï¼Œæ­¤æ—¶ç»„ä»¶å°šæœªæŒ‚è½½åˆ°ç½‘é¡µä¸Šã€‚</li><li>componentWillMount æ–¹æ³•çš„è°ƒç”¨åœ¨ constructor ä¹‹åï¼Œåœ¨ render ä¹‹å‰ï¼Œåœ¨è¿™æ–¹æ³•é‡Œçš„ä»£ç è°ƒç”¨ setState æ–¹æ³•ä¸ä¼šè§¦å‘é‡æ–° renderï¼Œæ‰€ä»¥å®ƒä¸€èˆ¬ä¸ä¼šç”¨æ¥ä½œåŠ è½½æ•°æ®ä¹‹ç”¨ã€‚</li><li>componentDidMount æ–¹æ³•ä¸­çš„ä»£ç ï¼Œæ˜¯åœ¨ç»„ä»¶å·²ç»å®Œå…¨æŒ‚è½½åˆ°ç½‘é¡µä¸Šæ‰ä¼šè°ƒç”¨è¢«æ‰§è¡Œï¼Œæ‰€ä»¥å¯ä»¥ä¿è¯æ•°æ®çš„åŠ è½½ã€‚æ­¤å¤–ï¼Œåœ¨è¿™æ–¹æ³•ä¸­è°ƒç”¨ setState æ–¹æ³•ï¼Œä¼šè§¦å‘é‡æ–°æ¸²æŸ“ã€‚æ‰€ä»¥ï¼Œå®˜æ–¹è®¾è®¡è¿™ä¸ªæ–¹æ³•å°±æ˜¯ç”¨æ¥åŠ è½½å¤–éƒ¨æ•°æ®ç”¨çš„ï¼Œæˆ–å¤„ç†å…¶ä»–çš„å‰¯ä½œç”¨ä»£ç ã€‚ä¸ç»„ä»¶ä¸Šçš„æ•°æ®æ— å…³çš„åŠ è½½ï¼Œä¹Ÿå¯ä»¥åœ¨ constructor é‡Œåšï¼Œä½† constructor æ˜¯åšç»„ä»¶ state åˆç»åŒ–å·¥ä½œï¼Œå¹¶ä¸æ˜¯åšåŠ è½½æ•°æ®è¿™å·¥ä½œçš„ï¼Œconstructor é‡Œä¹Ÿä¸èƒ½ setStateï¼Œè¿˜æœ‰åŠ è½½çš„æ—¶é—´å¤ªé•¿æˆ–è€…å‡ºé”™ï¼Œé¡µé¢å°±æ— æ³•åŠ è½½å‡ºæ¥ã€‚æ‰€ä»¥æœ‰å‰¯ä½œç”¨çš„ä»£ç éƒ½ä¼šé›†ä¸­åœ¨ componentDidMount æ–¹æ³•é‡Œã€‚</li></ul><p>æ€»ç»“ï¼š</p><ul><li>è·ŸæœåŠ¡å™¨ç«¯æ¸²æŸ“ï¼ˆåŒæ„ï¼‰æœ‰å…³ç³»ï¼Œå¦‚æœåœ¨ componentWillMount é‡Œé¢è·å–æ•°æ®ï¼Œfetch data ä¼šæ‰§è¡Œä¸¤æ¬¡ï¼Œä¸€æ¬¡åœ¨æœåŠ¡å™¨ç«¯ä¸€æ¬¡åœ¨å®¢æˆ·ç«¯ã€‚åœ¨ componentDidMount ä¸­å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒcomponentWillMount åŒæ ·ä¹Ÿä¼š render ä¸¤æ¬¡ã€‚</li><li>åœ¨ componentWillMount ä¸­ fetch dataï¼Œæ•°æ®ä¸€å®šåœ¨ render åæ‰èƒ½åˆ°è¾¾ï¼Œå¦‚æœå¿˜è®°äº†è®¾ç½®åˆå§‹çŠ¶æ€ï¼Œç”¨æˆ·ä½“éªŒä¸å¥½ã€‚</li><li>react16.0 ä»¥åï¼ŒcomponentWillMount å¯èƒ½ä¼šè¢«æ‰§è¡Œå¤šæ¬¡ã€‚</li></ul><h3 id="7-React-16-ä¸­æ–°ç”Ÿå‘½å‘¨æœŸæœ‰å“ªäº›"><a href="#7-React-16-ä¸­æ–°ç”Ÿå‘½å‘¨æœŸæœ‰å“ªäº›" class="headerlink" title="7. React 16 ä¸­æ–°ç”Ÿå‘½å‘¨æœŸæœ‰å“ªäº›"></a>7. React 16 ä¸­æ–°ç”Ÿå‘½å‘¨æœŸæœ‰å“ªäº›</h3><p>å…³äº React16 å¼€å§‹åº”ç”¨çš„æ–°ç”Ÿå‘½å‘¨æœŸï¼š<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/reactreactInterview1/9.png" alt=""><br>å¯ä»¥çœ‹å‡ºï¼ŒReact16 è‡ªä¸Šè€Œä¸‹åœ°å¯¹ç”Ÿå‘½å‘¨æœŸåšäº†å¦ä¸€ç§ç»´åº¦çš„è§£è¯»ï¼š</p><ul><li><strong>Render é˜¶æ®µ</strong>ï¼šç”¨äºè®¡ç®—ä¸€äº›å¿…è¦çš„çŠ¶æ€ä¿¡æ¯ã€‚è¿™ä¸ªé˜¶æ®µå¯èƒ½ä¼šè¢« React æš‚åœï¼Œè¿™ä¸€ç‚¹å’Œ React16 å¼•å…¥çš„ Fiber æ¶æ„ï¼ˆæˆ‘ä»¬åé¢ä¼šé‡ç‚¹è®²è§£ï¼‰æ˜¯æœ‰å…³çš„ï¼›</li><li><strong>Pre-commit é˜¶æ®µ</strong>ï¼šæ‰€è°“â€œcommitâ€ï¼Œè¿™é‡ŒæŒ‡çš„æ˜¯â€œæ›´æ–°çœŸæ­£çš„ DOM èŠ‚ç‚¹â€è¿™ä¸ªåŠ¨ä½œã€‚æ‰€è°“ Pre-commitï¼Œå°±æ˜¯è¯´æˆ‘åœ¨è¿™ä¸ªé˜¶æ®µå…¶å®è¿˜å¹¶æ²¡æœ‰å»æ›´æ–°çœŸå®çš„ DOMï¼Œä¸è¿‡ DOM ä¿¡æ¯å·²ç»æ˜¯å¯ä»¥è¯»å–çš„äº†ï¼›</li><li><strong>Commit é˜¶æ®µ</strong>ï¼šåœ¨è¿™ä¸€æ­¥ï¼ŒReact ä¼šå®ŒæˆçœŸå® DOM çš„æ›´æ–°å·¥ä½œã€‚Commit é˜¶æ®µï¼Œæˆ‘ä»¬å¯ä»¥æ‹¿åˆ°çœŸå® DOMï¼ˆåŒ…æ‹¬ refsï¼‰ã€‚</li></ul><p>ä¸æ­¤åŒæ—¶ï¼Œæ–°çš„ç”Ÿå‘½å‘¨æœŸåœ¨æµç¨‹æ–¹é¢ï¼Œä»ç„¶éµå¾ªâ€œæŒ‚è½½â€ã€â€œæ›´æ–°â€ã€â€œå¸è½½â€è¿™ä¸‰ä¸ªå¹¿ä¹‰çš„åˆ’åˆ†æ–¹å¼ã€‚å®ƒä»¬åˆ†åˆ«å¯¹åº”åˆ°ï¼š</p><ul><li>æŒ‚è½½è¿‡ç¨‹ï¼š<ul><li><strong>constructor</strong></li><li><strong>getDerivedStateFromProps</strong></li><li><strong>render</strong></li><li><strong>componentDidMount</strong></li></ul></li><li>æ›´æ–°è¿‡ç¨‹ï¼š<ul><li><strong>getDerivedStateFromProps</strong></li><li><strong>shouldComponentUpdate</strong></li><li><strong>render</strong></li><li><strong>getSnapshotBeforeUpdate</strong></li><li><strong>componentDidUpdate</strong></li></ul></li><li>å¸è½½è¿‡ç¨‹ï¼š<ul><li><strong>componentWillUnmount</strong></li></ul></li></ul><h2 id="å››ã€ç»„ä»¶é€šä¿¡"><a href="#å››ã€ç»„ä»¶é€šä¿¡" class="headerlink" title="å››ã€ç»„ä»¶é€šä¿¡"></a>å››ã€ç»„ä»¶é€šä¿¡</h2><p>React ç»„ä»¶é—´é€šä¿¡å¸¸è§çš„å‡ ç§æƒ…å†µ:</p><ul><li>çˆ¶ç»„ä»¶å‘å­ç»„ä»¶é€šä¿¡</li><li>å­ç»„ä»¶å‘çˆ¶ç»„ä»¶é€šä¿¡</li><li>è·¨çº§ç»„ä»¶é€šä¿¡</li><li>éåµŒå¥—å…³ç³»çš„ç»„ä»¶é€šä¿¡</li></ul><h3 id="1-çˆ¶å­ç»„ä»¶çš„é€šä¿¡æ–¹å¼ï¼Ÿ"><a href="#1-çˆ¶å­ç»„ä»¶çš„é€šä¿¡æ–¹å¼ï¼Ÿ" class="headerlink" title="1. çˆ¶å­ç»„ä»¶çš„é€šä¿¡æ–¹å¼ï¼Ÿ"></a>1. çˆ¶å­ç»„ä»¶çš„é€šä¿¡æ–¹å¼ï¼Ÿ</h3><p><strong>çˆ¶ç»„ä»¶å‘å­ç»„ä»¶é€šä¿¡</strong>ï¼šçˆ¶ç»„ä»¶é€šè¿‡ props å‘å­ç»„ä»¶ä¼ é€’éœ€è¦çš„ä¿¡æ¯ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// å­ç»„ä»¶: Child</span><span class="token keyword">const</span> Child <span class="token operator">=</span> <span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token operator">&lt;</span>p<span class="token operator">></span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// çˆ¶ç»„ä»¶ Parent</span><span class="token keyword">const</span> Parent <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token operator">&lt;</span>Child name<span class="token operator">=</span><span class="token string">"react"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>Child<span class="token operator">></span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>å­ç»„ä»¶å‘çˆ¶ç»„ä»¶é€šä¿¡</strong>ï¼š: props+å›è°ƒçš„æ–¹å¼ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// å­ç»„ä»¶: Child</span><span class="token keyword">const</span> Child <span class="token operator">=</span> <span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> cb <span class="token operator">=</span> <span class="token punctuation">(</span>msg<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>      props<span class="token punctuation">.</span><span class="token function">callback</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token function">cb</span><span class="token punctuation">(</span><span class="token string">"ä½ å¥½!"</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span>ä½ å¥½<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// çˆ¶ç»„ä»¶ Parent</span><span class="token keyword">class</span> <span class="token class-name">Parent</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>  <span class="token function">callback</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token operator">&lt;</span>Child callback<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>callback<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>Child<span class="token operator">></span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-è·¨çº§ç»„ä»¶çš„é€šä¿¡æ–¹å¼ï¼Ÿ"><a href="#2-è·¨çº§ç»„ä»¶çš„é€šä¿¡æ–¹å¼ï¼Ÿ" class="headerlink" title="2. è·¨çº§ç»„ä»¶çš„é€šä¿¡æ–¹å¼ï¼Ÿ"></a>2. è·¨çº§ç»„ä»¶çš„é€šä¿¡æ–¹å¼ï¼Ÿ</h3><p>çˆ¶ç»„ä»¶å‘å­ç»„ä»¶çš„å­ç»„ä»¶é€šä¿¡ï¼Œå‘æ›´æ·±å±‚å­ç»„ä»¶é€šä¿¡ï¼š</p><ul><li>ä½¿ç”¨ propsï¼Œåˆ©ç”¨ä¸­é—´ç»„ä»¶å±‚å±‚ä¼ é€’,ä½†æ˜¯å¦‚æœçˆ¶ç»„ä»¶ç»“æ„è¾ƒæ·±ï¼Œé‚£ä¹ˆä¸­é—´æ¯ä¸€å±‚ç»„ä»¶éƒ½è¦å»ä¼ é€’ propsï¼Œå¢åŠ äº†å¤æ‚åº¦ï¼Œå¹¶ä¸”è¿™äº› props å¹¶ä¸æ˜¯ä¸­é—´ç»„ä»¶è‡ªå·±éœ€è¦çš„ã€‚</li><li>ä½¿ç”¨ contextï¼Œcontext ç›¸å½“äºä¸€ä¸ªå¤§å®¹å™¨ï¼Œå¯ä»¥æŠŠè¦é€šä¿¡çš„å†…å®¹æ”¾åœ¨è¿™ä¸ªå®¹å™¨ä¸­ï¼Œè¿™æ ·ä¸ç®¡åµŒå¥—å¤šæ·±ï¼Œéƒ½å¯ä»¥éšæ„å–ç”¨ï¼Œå¯¹äºè·¨è¶Šå¤šå±‚çš„å…¨å±€æ•°æ®å¯ä»¥ä½¿ç”¨ context å®ç°ã€‚</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// contextæ–¹å¼å®ç°è·¨çº§ç»„ä»¶é€šä¿¡</span><span class="token comment" spellcheck="true">// Context è®¾è®¡ç›®çš„æ˜¯ä¸ºäº†å…±äº«é‚£äº›å¯¹äºä¸€ä¸ªç»„ä»¶æ ‘è€Œè¨€æ˜¯â€œå…¨å±€â€çš„æ•°æ®</span><span class="token keyword">const</span> BatteryContext <span class="token operator">=</span> <span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//  å­ç»„ä»¶çš„å­ç»„ä»¶</span><span class="token keyword">class</span> <span class="token class-name">GrandChild</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>BatteryContext<span class="token punctuation">.</span>Consumer<span class="token operator">></span>        <span class="token punctuation">{</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">&lt;</span>h1 style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> color<span class="token punctuation">:</span> color <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">></span>æˆ‘æ˜¯çº¢è‰²çš„<span class="token punctuation">:</span><span class="token punctuation">{</span>color<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">}</span>      <span class="token operator">&lt;</span><span class="token operator">/</span>BatteryContext<span class="token punctuation">.</span>Consumer<span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//  å­ç»„ä»¶</span><span class="token keyword">const</span> Child <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token operator">&lt;</span>GrandChild <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// çˆ¶ç»„ä»¶</span><span class="token keyword">class</span> <span class="token class-name">Parent</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>  state <span class="token operator">=</span> <span class="token punctuation">{</span>    color<span class="token punctuation">:</span> <span class="token string">"red"</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> color <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>BatteryContext<span class="token punctuation">.</span>Provider value<span class="token operator">=</span><span class="token punctuation">{</span>color<span class="token punctuation">}</span><span class="token operator">></span>        <span class="token operator">&lt;</span>Child<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>Child<span class="token operator">></span>      <span class="token operator">&lt;</span><span class="token operator">/</span>BatteryContext<span class="token punctuation">.</span>Provider<span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>###</p><h3 id="3-éåµŒå¥—å…³ç³»ç»„ä»¶çš„é€šä¿¡æ–¹å¼ï¼Ÿ"><a href="#3-éåµŒå¥—å…³ç³»ç»„ä»¶çš„é€šä¿¡æ–¹å¼ï¼Ÿ" class="headerlink" title="3. éåµŒå¥—å…³ç³»ç»„ä»¶çš„é€šä¿¡æ–¹å¼ï¼Ÿ"></a>3. éåµŒå¥—å…³ç³»ç»„ä»¶çš„é€šä¿¡æ–¹å¼ï¼Ÿ</h3><p>å³æ²¡æœ‰ä»»ä½•åŒ…å«å…³ç³»çš„ç»„ä»¶ï¼ŒåŒ…æ‹¬å…„å¼Ÿç»„ä»¶ä»¥åŠä¸åœ¨åŒä¸€ä¸ªçˆ¶çº§ä¸­çš„éå…„å¼Ÿç»„ä»¶ã€‚</p><ul><li>å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰äº‹ä»¶é€šä¿¡ï¼ˆå‘å¸ƒè®¢é˜…æ¨¡å¼ï¼‰</li><li>å¯ä»¥é€šè¿‡ redux ç­‰è¿›è¡Œå…¨å±€çŠ¶æ€ç®¡ç†</li><li>å¦‚æœæ˜¯å…„å¼Ÿç»„ä»¶é€šä¿¡ï¼Œå¯ä»¥æ‰¾åˆ°è¿™ä¸¤ä¸ªå…„å¼ŸèŠ‚ç‚¹å…±åŒçš„çˆ¶èŠ‚ç‚¹, ç»“åˆçˆ¶å­é—´é€šä¿¡æ–¹å¼è¿›è¡Œé€šä¿¡ã€‚</li></ul><h3 id="4-å¦‚ä½•è§£å†³-props-å±‚çº§è¿‡æ·±çš„é—®é¢˜"><a href="#4-å¦‚ä½•è§£å†³-props-å±‚çº§è¿‡æ·±çš„é—®é¢˜" class="headerlink" title="4. å¦‚ä½•è§£å†³ props å±‚çº§è¿‡æ·±çš„é—®é¢˜"></a>4. å¦‚ä½•è§£å†³ props å±‚çº§è¿‡æ·±çš„é—®é¢˜</h3><ul><li>ä½¿ç”¨ Context APIï¼šæä¾›ä¸€ç§ç»„ä»¶ä¹‹é—´çš„çŠ¶æ€å…±äº«ï¼Œè€Œä¸å¿…é€šè¿‡æ˜¾å¼ç»„ä»¶æ ‘é€å±‚ä¼ é€’ propsï¼›</li><li>ä½¿ç”¨ Redux ç­‰çŠ¶æ€åº“ã€‚</li></ul><h3 id="5-ç»„ä»¶é€šä¿¡çš„æ–¹å¼æœ‰å“ªäº›"><a href="#5-ç»„ä»¶é€šä¿¡çš„æ–¹å¼æœ‰å“ªäº›" class="headerlink" title="5. ç»„ä»¶é€šä¿¡çš„æ–¹å¼æœ‰å“ªäº›"></a>5. ç»„ä»¶é€šä¿¡çš„æ–¹å¼æœ‰å“ªäº›</h3><ul><li><strong>â½—ç»„ä»¶å‘â¼¦ç»„ä»¶é€šè®¯</strong>: â½—ç»„ä»¶å¯ä»¥å‘â¼¦ç»„ä»¶é€šè¿‡ä¼  props çš„â½…å¼ï¼Œå‘â¼¦ç»„ä»¶è¿›â¾é€šè®¯</li><li><strong>â¼¦ç»„ä»¶å‘â½—ç»„ä»¶é€šè®¯</strong>: props+å›è°ƒçš„â½…å¼ï¼Œâ½—ç»„ä»¶å‘â¼¦ç»„ä»¶ä¼ é€’ props è¿›â¾é€šè®¯ï¼Œæ­¤ props ä¸ºä½œâ½¤åŸŸä¸ºâ½—ç»„ä»¶â¾ƒèº«çš„å‡½ æ•°ï¼Œâ¼¦ç»„ä»¶è°ƒâ½¤è¯¥å‡½æ•°ï¼Œå°†â¼¦ç»„ä»¶æƒ³è¦ä¼ é€’çš„ä¿¡æ¯ï¼Œä½œä¸ºå‚æ•°ï¼Œä¼ é€’åˆ°â½—ç»„ä»¶çš„ä½œâ½¤åŸŸä¸­</li><li><strong>å…„å¼Ÿç»„ä»¶é€šä¿¡</strong>: æ‰¾åˆ°è¿™ä¸¤ä¸ªå…„å¼ŸèŠ‚ç‚¹å…±åŒçš„â½—èŠ‚ç‚¹,ç»“åˆä¸Šâ¾¯ä¸¤ç§â½…å¼ç”±â½—èŠ‚ç‚¹è½¬å‘ä¿¡æ¯è¿›â¾é€šä¿¡</li><li><strong>è·¨å±‚çº§é€šä¿¡</strong>: Context è®¾è®¡â½¬çš„æ˜¯ä¸ºäº†å…±äº«é‚£äº›å¯¹äºâ¼€ä¸ªç»„ä»¶æ ‘â½½â¾”æ˜¯â€œå…¨å±€â€çš„æ•°æ®ï¼Œä¾‹å¦‚å½“å‰è®¤è¯çš„â½¤æˆ·ã€ä¸»é¢˜æˆ–â¾¸é€‰è¯­â¾”ï¼Œå¯¹äºè·¨è¶Šå¤šå±‚çš„å…¨å±€æ•°æ®é€šè¿‡ Context é€šä¿¡å†é€‚åˆä¸è¿‡</li><li><strong>å‘å¸ƒè®¢é˜…æ¨¡å¼</strong>: å‘å¸ƒè€…å‘å¸ƒäº‹ä»¶ï¼Œè®¢é˜…è€…ç›‘å¬äº‹ä»¶å¹¶åšå‡ºååº”,æˆ‘ä»¬å¯ä»¥é€šè¿‡å¼•â¼Š event æ¨¡å—è¿›â¾é€šä¿¡</li><li><strong>å…¨å±€çŠ¶æ€ç®¡ç†â¼¯å…·</strong>: å€ŸåŠ© Redux æˆ–è€… Mobx ç­‰å…¨å±€çŠ¶æ€ç®¡ç†â¼¯å…·è¿›â¾é€šä¿¡,è¿™ç§â¼¯å…·ä¼šç»´æŠ¤â¼€ä¸ªå…¨å±€çŠ¶æ€ä¸­â¼¼ Store,å¹¶æ ¹æ®ä¸åŒçš„äº‹ä»¶äº§â½£æ–°çš„çŠ¶æ€</li></ul><h2 id="äº”ã€è·¯ç”±"><a href="#äº”ã€è·¯ç”±" class="headerlink" title="äº”ã€è·¯ç”±"></a>äº”ã€è·¯ç”±</h2><h3 id="1-React-Router-çš„å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-React-Router-çš„å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1. React-Router çš„å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"></a>1. React-Router çš„å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>å®¢æˆ·ç«¯è·¯ç”±å®ç°çš„æ€æƒ³ï¼š</p><ul><li>åŸºäº hash çš„è·¯ç”±ï¼šé€šè¿‡ç›‘å¬<code>hashchange</code>äº‹ä»¶ï¼Œæ„ŸçŸ¥ hash çš„å˜åŒ–<ul><li>æ”¹å˜ hash å¯ä»¥ç›´æ¥é€šè¿‡ location.hash=xxx</li></ul></li><li>åŸºäº H5 history è·¯ç”±ï¼š<ul><li>æ”¹å˜ url å¯ä»¥é€šè¿‡ history.pushState å’Œ resplaceState ç­‰ï¼Œä¼šå°† URL å‹å…¥å †æ ˆï¼ŒåŒæ—¶èƒ½å¤Ÿåº”ç”¨ <code>history.go()</code> ç­‰ API</li><li>ç›‘å¬ url çš„å˜åŒ–å¯ä»¥é€šè¿‡è‡ªå®šä¹‰äº‹ä»¶è§¦å‘å®ç°</li></ul></li></ul><p><strong>react-router å®ç°çš„æ€æƒ³ï¼š</strong></p><ul><li>åŸºäº <code>history</code> åº“æ¥å®ç°ä¸Šè¿°ä¸åŒçš„å®¢æˆ·ç«¯è·¯ç”±å®ç°æ€æƒ³ï¼Œå¹¶ä¸”èƒ½å¤Ÿä¿å­˜å†å²è®°å½•ç­‰ï¼Œç£¨å¹³æµè§ˆå™¨å·®å¼‚ï¼Œä¸Šå±‚æ— æ„ŸçŸ¥</li><li>é€šè¿‡ç»´æŠ¤çš„åˆ—è¡¨ï¼Œåœ¨æ¯æ¬¡ URL å‘ç”Ÿå˜åŒ–çš„å›æ”¶ï¼Œé€šè¿‡é…ç½®çš„ è·¯ç”±è·¯å¾„ï¼ŒåŒ¹é…åˆ°å¯¹åº”çš„ Componentï¼Œå¹¶ä¸” render</li></ul><h3 id="2-å¦‚ä½•é…ç½®-React-Router-å®ç°è·¯ç”±åˆ‡æ¢"><a href="#2-å¦‚ä½•é…ç½®-React-Router-å®ç°è·¯ç”±åˆ‡æ¢" class="headerlink" title="2. å¦‚ä½•é…ç½® React-Router å®ç°è·¯ç”±åˆ‡æ¢"></a>2. å¦‚ä½•é…ç½® React-Router å®ç°è·¯ç”±åˆ‡æ¢</h3><p><strong>ï¼ˆ1ï¼‰ä½¿ç”¨<code>&lt;Route&gt;</code> ç»„ä»¶</strong></p><p>è·¯ç”±åŒ¹é…æ˜¯é€šè¿‡æ¯”è¾ƒ <code>&lt;Route&gt;</code> çš„ path å±æ€§å’Œå½“å‰åœ°å€çš„ pathname æ¥å®ç°çš„ã€‚å½“ä¸€ä¸ª <code>&lt;Route&gt;</code> åŒ¹é…æˆåŠŸæ—¶ï¼Œå®ƒå°†æ¸²æŸ“å…¶å†…å®¹ï¼Œå½“å®ƒä¸åŒ¹é…æ—¶å°±ä¼šæ¸²æŸ“ nullã€‚æ²¡æœ‰è·¯å¾„çš„ <code>&lt;Route&gt;</code> å°†å§‹ç»ˆè¢«åŒ¹é…ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// when location = { pathname: '/about' }</span><span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">'/about'</span> component<span class="token operator">=</span><span class="token punctuation">{</span>About<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">></span> <span class="token comment" spellcheck="true">// renders &lt;About/></span><span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">'/contact'</span> component<span class="token operator">=</span><span class="token punctuation">{</span>Contact<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">></span> <span class="token comment" spellcheck="true">// renders null</span><span class="token operator">&lt;</span>Route component<span class="token operator">=</span><span class="token punctuation">{</span>Always<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">></span> <span class="token comment" spellcheck="true">// renders &lt;Always/></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ï¼ˆ2ï¼‰ç»“åˆä½¿ç”¨ <code>&lt;Switch&gt;</code> ç»„ä»¶å’Œ <code>&lt;Route&gt;</code> ç»„ä»¶</strong></p><p><code>&lt;Switch&gt;</code> ç”¨äºå°† <code>&lt;Route&gt;</code> åˆ†ç»„ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>Switch<span class="token operator">></span>  <span class="token operator">&lt;</span>Route exact path<span class="token operator">=</span><span class="token string">"/"</span> component<span class="token operator">=</span><span class="token punctuation">{</span>Home<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>  <span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">"/about"</span> component<span class="token operator">=</span><span class="token punctuation">{</span>About<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>  <span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">"/contact"</span> component<span class="token operator">=</span><span class="token punctuation">{</span>Contact<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>Switch<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>&lt;Switch&gt;</code> ä¸æ˜¯åˆ†ç»„ <code>&lt;Route&gt;</code> æ‰€å¿…é¡»çš„ï¼Œä½†ä»–é€šå¸¸å¾ˆæœ‰ç”¨ã€‚ ä¸€ä¸ª <code>&lt;Switch&gt;</code> ä¼šéå†å…¶æ‰€æœ‰çš„å­ <code>&lt;Route&gt;</code>å…ƒç´ ï¼Œå¹¶ä»…æ¸²æŸ“ä¸å½“å‰åœ°å€åŒ¹é…çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚</p><p><strong>ï¼ˆ3ï¼‰ä½¿ç”¨ <code>&lt;Link&gt;ã€ &lt;NavLink&gt;ã€&lt;Redirect&gt;</code> ç»„ä»¶</strong></p><p><code>&lt;Link&gt;</code> ç»„ä»¶æ¥åœ¨ä½ çš„åº”ç”¨ç¨‹åºä¸­åˆ›å»ºé“¾æ¥ã€‚æ— è®ºä½ åœ¨ä½•å¤„æ¸²æŸ“ä¸€ä¸ª<code>&lt;Link&gt;</code> ï¼Œéƒ½ä¼šåœ¨åº”ç”¨ç¨‹åºçš„ HTML ä¸­æ¸²æŸ“é”šï¼ˆ<code>&lt;a&gt;</code>ï¼‰ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>Link to<span class="token operator">=</span><span class="token string">"/"</span><span class="token operator">></span>Home<span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">></span><span class="token comment" spellcheck="true">// &lt;a href='/'>Home&lt;/a></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><navlink> æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„ <link> å½“å®ƒçš„ to å±æ€§ä¸å½“å‰åœ°å€åŒ¹é…æ—¶ï¼Œå¯ä»¥å°†å…¶å®šä¹‰ä¸ºâ€æ´»è·ƒçš„â€ã€‚</navlink></p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// location = { pathname: '/react' }</span><span class="token operator">&lt;</span>NavLink to<span class="token operator">=</span><span class="token string">"/react"</span> activeClassName<span class="token operator">=</span><span class="token string">"hurray"</span><span class="token operator">></span>  React<span class="token operator">&lt;</span><span class="token operator">/</span>NavLink<span class="token operator">></span><span class="token comment" spellcheck="true">// &lt;a href='/react' className='hurray'>React&lt;/a></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å½“æˆ‘ä»¬æƒ³å¼ºåˆ¶å¯¼èˆªæ—¶ï¼Œå¯ä»¥æ¸²æŸ“ä¸€ä¸ª<code>&lt;Redirect&gt;</code>ï¼Œå½“ä¸€ä¸ª<code>&lt;Redirect&gt;</code>æ¸²æŸ“æ—¶ï¼Œå®ƒå°†ä½¿ç”¨å®ƒçš„ to å±æ€§è¿›è¡Œå®šå‘ã€‚</p><h3 id="3-React-Router-æ€ä¹ˆè®¾ç½®é‡å®šå‘ï¼Ÿ"><a href="#3-React-Router-æ€ä¹ˆè®¾ç½®é‡å®šå‘ï¼Ÿ" class="headerlink" title="3. React-Router æ€ä¹ˆè®¾ç½®é‡å®šå‘ï¼Ÿ"></a>3. React-Router æ€ä¹ˆè®¾ç½®é‡å®šå‘ï¼Ÿ</h3><p>ä½¿ç”¨<code>&lt;Redirect&gt;</code>ç»„ä»¶å®ç°è·¯ç”±çš„é‡å®šå‘ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>Switch<span class="token operator">></span>  <span class="token operator">&lt;</span>Redirect <span class="token keyword">from</span><span class="token operator">=</span><span class="token string">"/users/:id"</span> to<span class="token operator">=</span><span class="token string">"/users/profile/:id"</span> <span class="token operator">/</span><span class="token operator">></span>  <span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">"/users/profile/:id"</span> component<span class="token operator">=</span><span class="token punctuation">{</span>Profile<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>Switch<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å½“è¯·æ±‚ <code>/users/:id</code> è¢«é‡å®šå‘å» <code>'/users/profile/:id'</code>ï¼š</p><ul><li>å±æ€§ <code>from: string</code>ï¼šéœ€è¦åŒ¹é…çš„å°†è¦è¢«é‡å®šå‘è·¯å¾„ã€‚</li><li>å±æ€§ <code>to: string</code>ï¼šé‡å®šå‘çš„ URL å­—ç¬¦ä¸²</li><li>å±æ€§ <code>to: object</code>ï¼šé‡å®šå‘çš„ location å¯¹è±¡</li><li>å±æ€§ <code>push: bool</code>ï¼šè‹¥ä¸ºçœŸï¼Œé‡å®šå‘æ“ä½œå°†ä¼šæŠŠæ–°åœ°å€åŠ å…¥åˆ°è®¿é—®å†å²è®°å½•é‡Œé¢ï¼Œå¹¶ä¸”æ— æ³•å›é€€åˆ°å‰é¢çš„é¡µé¢ã€‚</li></ul><h3 id="4-react-router-é‡Œçš„-Link-æ ‡ç­¾å’Œ-a-æ ‡ç­¾çš„åŒºåˆ«"><a href="#4-react-router-é‡Œçš„-Link-æ ‡ç­¾å’Œ-a-æ ‡ç­¾çš„åŒºåˆ«" class="headerlink" title="4. react-router é‡Œçš„ Link æ ‡ç­¾å’Œ a æ ‡ç­¾çš„åŒºåˆ«"></a>4. react-router é‡Œçš„ Link æ ‡ç­¾å’Œ a æ ‡ç­¾çš„åŒºåˆ«</h3><p>ä»æœ€ç»ˆæ¸²æŸ“çš„ DOM æ¥çœ‹ï¼Œè¿™ä¸¤è€…éƒ½æ˜¯é“¾æ¥ï¼Œéƒ½æ˜¯ æ ‡ç­¾ï¼ŒåŒºåˆ«æ˜¯ âˆ¶<br><code>&lt;Link&gt;</code>æ˜¯ react-router é‡Œå®ç°è·¯ç”±è·³è½¬çš„é“¾æ¥ï¼Œä¸€èˆ¬é…åˆ<code>&lt;Route&gt;</code> ä½¿ç”¨ï¼Œreact-router æ¥ç®¡äº†å…¶é»˜è®¤çš„é“¾æ¥è·³è½¬è¡Œä¸ºï¼ŒåŒºåˆ«äºä¼ ç»Ÿçš„é¡µé¢è·³è½¬ï¼Œ<code>&lt;Link&gt;</code> çš„â€œè·³è½¬â€è¡Œä¸ºåªä¼šè§¦å‘ç›¸åŒ¹é…çš„<code>&lt;Route&gt;</code>å¯¹åº”çš„é¡µé¢å†…å®¹æ›´æ–°ï¼Œè€Œä¸ä¼šåˆ·æ–°æ•´ä¸ªé¡µé¢ã€‚</p><p><code>&lt;Link&gt;</code>åšäº† 3 ä»¶äº‹æƒ…:</p><ul><li>æœ‰ onclick é‚£å°±æ‰§è¡Œ onclick</li><li>click çš„æ—¶å€™é˜»æ­¢ a æ ‡ç­¾é»˜è®¤äº‹ä»¶</li><li>æ ¹æ®è·³è½¬ href(å³æ˜¯ to)ï¼Œç”¨ history (web å‰ç«¯è·¯ç”±ä¸¤ç§æ–¹å¼ä¹‹ä¸€ï¼Œhistory &amp; hash)è·³è½¬ï¼Œæ­¤æ—¶åªæ˜¯é“¾æ¥å˜äº†ï¼Œå¹¶æ²¡æœ‰åˆ·æ–°é¡µé¢è€Œ<code>&lt;a&gt;</code>æ ‡ç­¾å°±æ˜¯æ™®é€šçš„è¶…é“¾æ¥äº†ï¼Œç”¨äºä»å½“å‰é¡µé¢è·³è½¬åˆ° href æŒ‡å‘çš„å¦ä¸€ ä¸ªé¡µé¢(éé”šç‚¹æƒ…å†µ)ã€‚</li></ul><p>a æ ‡ç­¾é»˜è®¤äº‹ä»¶ç¦æ‰ä¹‹ååšäº†ä»€ä¹ˆæ‰å®ç°äº†è·³è½¬?</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">let</span> domArr <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">...</span>domArr<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>item<span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>    item<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>href    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-React-Router-å¦‚ä½•è·å–-URL-çš„å‚æ•°å’Œå†å²å¯¹è±¡ï¼Ÿ"><a href="#5-React-Router-å¦‚ä½•è·å–-URL-çš„å‚æ•°å’Œå†å²å¯¹è±¡ï¼Ÿ" class="headerlink" title="5. React-Router å¦‚ä½•è·å– URL çš„å‚æ•°å’Œå†å²å¯¹è±¡ï¼Ÿ"></a>5. React-Router å¦‚ä½•è·å– URL çš„å‚æ•°å’Œå†å²å¯¹è±¡ï¼Ÿ</h3><p><strong>ï¼ˆ1ï¼‰è·å– URL çš„å‚æ•°</strong></p><ul><li><strong>get ä¼ å€¼</strong></li></ul><p>è·¯ç”±é…ç½®è¿˜æ˜¯æ™®é€šçš„é…ç½®ï¼Œå¦‚ï¼š<code>'admin'</code>ï¼Œä¼ å‚æ–¹å¼å¦‚ï¼š<code>'admin?id='1111''</code>ã€‚é€šè¿‡<code>this.props.location.search</code>è·å– url è·å–åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²<code>'?id='1111'</code><br>å¯ä»¥ç”¨ urlï¼Œqsï¼Œquerystringï¼Œæµè§ˆå™¨æä¾›çš„ api URLSearchParams å¯¹è±¡æˆ–è€…è‡ªå·±å°è£…çš„æ–¹æ³•å»è§£æå‡º id çš„å€¼ã€‚</p><ul><li><strong>åŠ¨æ€è·¯ç”±ä¼ å€¼</strong></li></ul><p>è·¯ç”±éœ€è¦é…ç½®æˆåŠ¨æ€è·¯ç”±ï¼šå¦‚<code>path='/admin/:id'</code>ï¼Œä¼ å‚æ–¹å¼ï¼Œå¦‚<code>'admin/111'</code>ã€‚é€šè¿‡<code>this.props.match.params.id</code> å–å¾— url ä¸­çš„åŠ¨æ€è·¯ç”± id éƒ¨åˆ†çš„å€¼ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜å¯ä»¥é€šè¿‡<code>useParamsï¼ˆHooksï¼‰</code>æ¥è·å–</p><ul><li><strong>é€šè¿‡ query æˆ– state ä¼ å€¼</strong></li></ul><p>ä¼ å‚æ–¹å¼å¦‚ï¼šåœ¨ Link ç»„ä»¶çš„ to å±æ€§ä¸­å¯ä»¥ä¼ é€’å¯¹è±¡<code>{pathname:'/admin',query:'111',state:'111'};</code>ã€‚é€šè¿‡<code>this.props.location.state</code>æˆ–<code>this.props.location.query</code>æ¥è·å–å³å¯ï¼Œä¼ é€’çš„å‚æ•°å¯ä»¥æ˜¯å¯¹è±¡ã€æ•°ç»„ç­‰ï¼Œä½†æ˜¯å­˜åœ¨ç¼ºç‚¹å°±æ˜¯åªè¦åˆ·æ–°é¡µé¢ï¼Œå‚æ•°å°±ä¼šä¸¢å¤±ã€‚</p><p><strong>ï¼ˆ2ï¼‰è·å–å†å²å¯¹è±¡</strong></p><ul><li>å¦‚æœ React &gt;= 16.8 æ—¶å¯ä»¥ä½¿ç”¨ React Router ä¸­æä¾›çš„ Hooks</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> useHistory <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react-router-dom"</span><span class="token punctuation">;</span><span class="token keyword">let</span> history <span class="token operator">=</span> <span class="token function">useHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>2.ä½¿ç”¨ this.props.history è·å–å†å²å¯¹è±¡</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">let</span> history <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>history<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="6-React-Router-4-æ€æ ·åœ¨è·¯ç”±å˜åŒ–æ—¶é‡æ–°æ¸²æŸ“åŒä¸€ä¸ªç»„ä»¶ï¼Ÿ"><a href="#6-React-Router-4-æ€æ ·åœ¨è·¯ç”±å˜åŒ–æ—¶é‡æ–°æ¸²æŸ“åŒä¸€ä¸ªç»„ä»¶ï¼Ÿ" class="headerlink" title="6. React-Router 4 æ€æ ·åœ¨è·¯ç”±å˜åŒ–æ—¶é‡æ–°æ¸²æŸ“åŒä¸€ä¸ªç»„ä»¶ï¼Ÿ"></a>6. React-Router 4 æ€æ ·åœ¨è·¯ç”±å˜åŒ–æ—¶é‡æ–°æ¸²æŸ“åŒä¸€ä¸ªç»„ä»¶ï¼Ÿ</h3><p>å½“è·¯ç”±å˜åŒ–æ—¶ï¼Œå³ç»„ä»¶çš„ props å‘ç”Ÿäº†å˜åŒ–ï¼Œä¼šè°ƒç”¨ componentWillReceiveProps ç­‰ç”Ÿå‘½å‘¨æœŸé’©å­ã€‚é‚£éœ€è¦åšçš„åªæ˜¯ï¼š å½“è·¯ç”±æ”¹å˜æ—¶ï¼Œæ ¹æ®è·¯ç”±ï¼Œä¹Ÿå»è¯·æ±‚æ•°æ®ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">NewsList</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>  componentDidMount <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">fetchData</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>location<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">fetchData</span><span class="token punctuation">(</span>location<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> type <span class="token operator">=</span> location<span class="token punctuation">.</span>pathname<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">'top'</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">fetchListData</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span>  <span class="token function">componentWillReceiveProps</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token keyword">if</span> <span class="token punctuation">(</span>nextProps<span class="token punctuation">.</span>location<span class="token punctuation">.</span>pathname <span class="token operator">!=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>location<span class="token punctuation">.</span>pathname<span class="token punctuation">)</span> <span class="token punctuation">{</span>         <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">fetchData</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">.</span>location<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  render <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token operator">...</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ©ç”¨ç”Ÿå‘½å‘¨æœŸ componentWillReceivePropsï¼Œè¿›è¡Œé‡æ–° render çš„é¢„å¤„ç†æ“ä½œã€‚</p><h3 id="7-React-Router-çš„è·¯ç”±æœ‰å‡ ç§æ¨¡å¼ï¼Ÿ"><a href="#7-React-Router-çš„è·¯ç”±æœ‰å‡ ç§æ¨¡å¼ï¼Ÿ" class="headerlink" title="7. React-Router çš„è·¯ç”±æœ‰å‡ ç§æ¨¡å¼ï¼Ÿ"></a>7. React-Router çš„è·¯ç”±æœ‰å‡ ç§æ¨¡å¼ï¼Ÿ</h3><p>React-Router æ”¯æŒä½¿ç”¨ hashï¼ˆå¯¹åº” HashRouterï¼‰å’Œ browserï¼ˆå¯¹åº” BrowserRouterï¼‰ ä¸¤ç§è·¯ç”±è§„åˆ™ï¼Œ react-router-dom æä¾›äº† BrowserRouter å’Œ HashRouter ä¸¤ä¸ªç»„ä»¶æ¥å®ç°åº”ç”¨çš„ UI å’Œ URL åŒæ­¥ï¼š</p><ul><li>BrowserRouter åˆ›å»ºçš„ URL æ ¼å¼ï¼š<a href="http://xxx.com/path">http://xxx.com/path</a></li><li>HashRouter åˆ›å»ºçš„ URL æ ¼å¼ï¼š<a href="http://xxx.com/#/path">http://xxx.com/#/path</a></li></ul><p><strong>ï¼ˆ1ï¼‰BrowserRouter</strong></p><p>å®ƒä½¿ç”¨ HTML5 æä¾›çš„ history APIï¼ˆpushStateã€replaceState å’Œ popstate äº‹ä»¶ï¼‰æ¥ä¿æŒ UI å’Œ URL çš„åŒæ­¥ã€‚ç”±æ­¤å¯ä»¥çœ‹å‡ºï¼Œ<strong>BrowserRouter æ˜¯ä½¿ç”¨ HTML 5 çš„ history API æ¥æ§åˆ¶è·¯ç”±è·³è½¬çš„ï¼š</strong></p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>BrowserRouter  basename<span class="token operator">=</span><span class="token punctuation">{</span>string<span class="token punctuation">}</span>  forceRefresh<span class="token operator">=</span><span class="token punctuation">{</span>bool<span class="token punctuation">}</span>  getUserConfirmation<span class="token operator">=</span><span class="token punctuation">{</span>func<span class="token punctuation">}</span>  keyLength<span class="token operator">=</span><span class="token punctuation">{</span>number<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>å…¶ä¸­çš„å±æ€§å¦‚ä¸‹ï¼š</strong></p><ul><li>basename æ‰€æœ‰è·¯ç”±çš„åŸºå‡† URLã€‚basename çš„æ­£ç¡®æ ¼å¼æ˜¯å‰é¢æœ‰ä¸€ä¸ªå‰å¯¼æ–œæ ï¼Œä½†ä¸èƒ½æœ‰å°¾éƒ¨æ–œæ ï¼›</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>BrowserRouter basename<span class="token operator">=</span><span class="token string">"/calendar"</span><span class="token operator">></span>  <span class="token operator">&lt;</span>Link to<span class="token operator">=</span><span class="token string">"/today"</span> <span class="token operator">/</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>BrowserRouter<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ç­‰åŒäº</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"/calendar/today"</span> <span class="token operator">/</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>forceRefresh å¦‚æœä¸º trueï¼Œåœ¨å¯¼èˆªçš„è¿‡ç¨‹ä¸­æ•´ä¸ªé¡µé¢å°†ä¼šåˆ·æ–°ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåªæœ‰åœ¨ä¸æ”¯æŒ HTML5 history API çš„æµè§ˆå™¨ä¸­ä½¿ç”¨æ­¤åŠŸèƒ½ï¼›</li><li>getUserConfirmation ç”¨äºç¡®è®¤å¯¼èˆªçš„å‡½æ•°ï¼Œé»˜è®¤ä½¿ç”¨ window.confirmã€‚ä¾‹å¦‚ï¼Œå½“ä» /a å¯¼èˆªè‡³ /b æ—¶ï¼Œä¼šä½¿ç”¨é»˜è®¤çš„ confirm å‡½æ•°å¼¹å‡ºä¸€ä¸ªæç¤ºï¼Œç”¨æˆ·ç‚¹å‡»ç¡®å®šåæ‰è¿›è¡Œå¯¼èˆªï¼Œå¦åˆ™ä¸åšä»»ä½•å¤„ç†ï¼›</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// è¿™æ˜¯é»˜è®¤çš„ç¡®è®¤å‡½æ•°</span><span class="token keyword">const</span> getConfirmation <span class="token operator">=</span> <span class="token punctuation">(</span>message<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> allowTransition <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">confirm</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">callback</span><span class="token punctuation">(</span>allowTransition<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token operator">&lt;</span>BrowserRouter getUserConfirmation<span class="token operator">=</span><span class="token punctuation">{</span>getConfirmation<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>éœ€è¦é…åˆ<code>&lt;Prompt&gt;</code> ä¸€èµ·ä½¿ç”¨ã€‚</p></blockquote><ul><li>KeyLength ç”¨æ¥è®¾ç½® Location.Key çš„é•¿åº¦ã€‚</li></ul><p><strong>ï¼ˆ2ï¼‰HashRouter</strong></p><p>ä½¿ç”¨ URL çš„ hash éƒ¨åˆ†ï¼ˆå³ window.location.hashï¼‰æ¥ä¿æŒ UI å’Œ URL çš„åŒæ­¥ã€‚ç”±æ­¤å¯ä»¥çœ‹å‡ºï¼Œ<strong>HashRouter æ˜¯é€šè¿‡ URL çš„ hash å±æ€§æ¥æ§åˆ¶è·¯ç”±è·³è½¬çš„ï¼š</strong></p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>HashRouter basename<span class="token operator">=</span><span class="token punctuation">{</span>string<span class="token punctuation">}</span> getUserConfirmation<span class="token operator">=</span><span class="token punctuation">{</span>func<span class="token punctuation">}</span> hashType<span class="token operator">=</span><span class="token punctuation">{</span>string<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>å…¶å‚æ•°å¦‚ä¸‹</strong>ï¼š</p><ul><li>basename, getUserConfirmation å’Œ <code>BrowserRouter</code> åŠŸèƒ½ä¸€æ ·ï¼›</li><li>hashType window.location.hash ä½¿ç”¨çš„ hash ç±»å‹ï¼Œæœ‰å¦‚ä¸‹å‡ ç§ï¼š<ul><li>slash - åé¢è·Ÿä¸€ä¸ªæ–œæ ï¼Œä¾‹å¦‚ #/ å’Œ #/sunshine/lollipopsï¼›</li><li>noslash - åé¢æ²¡æœ‰æ–œæ ï¼Œä¾‹å¦‚ # å’Œ #sunshine/lollipopsï¼›</li><li>hashbang - Google é£æ ¼çš„ ajax crawlableï¼Œä¾‹å¦‚ #!/ å’Œ #!/sunshine/lollipopsã€‚</li></ul></li></ul><h3 id="8-React-Router-4-çš„-Switch-æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"><a href="#8-React-Router-4-çš„-Switch-æœ‰ä»€ä¹ˆç”¨ï¼Ÿ" class="headerlink" title="8. React-Router 4 çš„ Switch æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"></a>8. React-Router 4 çš„ Switch æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h3><p>Switch é€šå¸¸è¢«ç”¨æ¥åŒ…è£¹ Routeï¼Œç”¨äºæ¸²æŸ“ä¸è·¯å¾„åŒ¹é…çš„ç¬¬ä¸€ä¸ªå­ <code>&lt;Route&gt;</code> æˆ– <code>&lt;Redirect&gt;</code>ï¼Œå®ƒé‡Œé¢ä¸èƒ½æ”¾å…¶ä»–å…ƒç´ ã€‚</p><p>å‡å¦‚ä¸åŠ  <code>&lt;Switch&gt;</code> ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> Route <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-router-dom'</span><span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">"/"</span> component<span class="token operator">=</span><span class="token punctuation">{</span>Home<span class="token punctuation">}</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>Route<span class="token operator">></span><span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">"/login"</span> component<span class="token operator">=</span><span class="token punctuation">{</span>Login<span class="token punctuation">}</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>Route<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>Route ç»„ä»¶çš„ path å±æ€§ç”¨äºåŒ¹é…è·¯å¾„ï¼Œå› ä¸ºéœ€è¦åŒ¹é… <code>/</code> åˆ° <code>Home</code>ï¼ŒåŒ¹é… <code>/login</code> åˆ° <code>Login</code>ï¼Œæ‰€ä»¥éœ€è¦ä¸¤ä¸ª Routeï¼Œä½†æ˜¯ä¸èƒ½è¿™ä¹ˆå†™ã€‚è¿™æ ·å†™çš„è¯ï¼Œå½“ URL çš„ path ä¸º â€œ/loginâ€ æ—¶ï¼Œ<code>&lt;Route path="/" /&gt;</code>å’Œ<code>&lt;Route path="/login" /&gt;</code> éƒ½ä¼šè¢«åŒ¹é…ï¼Œå› æ­¤é¡µé¢ä¼šå±•ç¤º Home å’Œ Login ä¸¤ä¸ªç»„ä»¶ã€‚è¿™æ—¶å°±éœ€è¦å€ŸåŠ© <code>&lt;Switch&gt;</code> æ¥åšåˆ°åªæ˜¾ç¤ºä¸€ä¸ªåŒ¹é…ç»„ä»¶ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> Switch<span class="token punctuation">,</span> Route <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react-router-dom"</span><span class="token punctuation">;</span><span class="token operator">&lt;</span>Switch<span class="token operator">></span>  <span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">"/"</span> component<span class="token operator">=</span><span class="token punctuation">{</span>Home<span class="token punctuation">}</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>Route<span class="token operator">></span>  <span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">"/login"</span> component<span class="token operator">=</span><span class="token punctuation">{</span>Login<span class="token punctuation">}</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>Route<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>Switch<span class="token operator">></span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ­¤æ—¶ï¼Œå†è®¿é—® â€œ/loginâ€ è·¯å¾„æ—¶ï¼Œå´åªæ˜¾ç¤ºäº† Home ç»„ä»¶ã€‚è¿™æ˜¯å°±ç”¨åˆ°äº† exact å±æ€§ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯ç²¾ç¡®åŒ¹é…è·¯å¾„ï¼Œç»å¸¸ä¸<code>&lt;Switch&gt;</code> è”åˆä½¿ç”¨ã€‚åªæœ‰å½“ URL å’Œè¯¥ <code>&lt;Route&gt;</code> çš„ path å±æ€§å®Œå…¨ä¸€è‡´çš„æƒ…å†µä¸‹æ‰èƒ½åŒ¹é…ä¸Šï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> Switch<span class="token punctuation">,</span> Route <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react-router-dom"</span><span class="token punctuation">;</span><span class="token operator">&lt;</span>Switch<span class="token operator">></span>  <span class="token operator">&lt;</span>Route exact path<span class="token operator">=</span><span class="token string">"/"</span> component<span class="token operator">=</span><span class="token punctuation">{</span>Home<span class="token punctuation">}</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>Route<span class="token operator">></span>  <span class="token operator">&lt;</span>Route exact path<span class="token operator">=</span><span class="token string">"/login"</span> component<span class="token operator">=</span><span class="token punctuation">{</span>Login<span class="token punctuation">}</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>Route<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>Switch<span class="token operator">></span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> reactå¸¸è§é—®é¢˜æ±‡æ€»1 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Github </tag>
            
            <tag> åšå®¢ </tag>
            
            <tag> reactå¸¸è§é—®é¢˜æ±‡æ€»1 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¡ç®—æœºç½‘ç»œ</title>
      <link href="/2023/07/10/network/"/>
      <url>/2023/07/10/network/</url>
      
        <content type="html"><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/network/1.png" alt="è®¡ç®—æœºç½‘ç»œé¢è¯•é¢˜.png"></p><h2 id="ä¸€ã€HTTPåè®®"><a href="#ä¸€ã€HTTPåè®®" class="headerlink" title="ä¸€ã€HTTPåè®®"></a>ä¸€ã€HTTPåè®®</h2><h3 id="1-GETå’ŒPOSTçš„è¯·æ±‚çš„åŒºåˆ«"><a href="#1-GETå’ŒPOSTçš„è¯·æ±‚çš„åŒºåˆ«" class="headerlink" title="1. GETå’ŒPOSTçš„è¯·æ±‚çš„åŒºåˆ«"></a>1. GETå’ŒPOSTçš„è¯·æ±‚çš„åŒºåˆ«</h3><p>Post å’Œ Get æ˜¯ HTTP è¯·æ±‚çš„ä¸¤ç§æ–¹æ³•ï¼Œå…¶åŒºåˆ«å¦‚ä¸‹ï¼š</p><ul><li><strong>åº”ç”¨åœºæ™¯ï¼š</strong> GET è¯·æ±‚æ˜¯ä¸€ä¸ªå¹‚ç­‰çš„è¯·æ±‚ï¼Œä¸€èˆ¬ Get è¯·æ±‚ç”¨äºå¯¹æœåŠ¡å™¨èµ„æºä¸ä¼šäº§ç”Ÿå½±å“çš„åœºæ™¯ï¼Œæ¯”å¦‚è¯´è¯·æ±‚ä¸€ä¸ªç½‘é¡µçš„èµ„æºã€‚è€Œ Post ä¸æ˜¯ä¸€ä¸ªå¹‚ç­‰çš„è¯·æ±‚ï¼Œä¸€èˆ¬ç”¨äºå¯¹æœåŠ¡å™¨èµ„æºä¼šäº§ç”Ÿå½±å“çš„æƒ…æ™¯ï¼Œæ¯”å¦‚æ³¨å†Œç”¨æˆ·è¿™ä¸€ç±»çš„æ“ä½œã€‚</li><li><strong>æ˜¯å¦ç¼“å­˜ï¼š</strong> å› ä¸ºä¸¤è€…åº”ç”¨åœºæ™¯ä¸åŒï¼Œæµè§ˆå™¨ä¸€èˆ¬ä¼šå¯¹ Get è¯·æ±‚ç¼“å­˜ï¼Œä½†å¾ˆå°‘å¯¹ Post è¯·æ±‚ç¼“å­˜ã€‚</li><li><strong>å‘é€çš„æŠ¥æ–‡æ ¼å¼ï¼š</strong> Get è¯·æ±‚çš„æŠ¥æ–‡ä¸­å®ä½“éƒ¨åˆ†ä¸ºç©ºï¼ŒPost è¯·æ±‚çš„æŠ¥æ–‡ä¸­å®ä½“éƒ¨åˆ†ä¸€èˆ¬ä¸ºå‘æœåŠ¡å™¨å‘é€çš„æ•°æ®ã€‚</li><li><strong>å®‰å…¨æ€§ï¼š</strong> Get è¯·æ±‚å¯ä»¥å°†è¯·æ±‚çš„å‚æ•°æ”¾å…¥ url ä¸­å‘æœåŠ¡å™¨å‘é€ï¼Œè¿™æ ·çš„åšæ³•ç›¸å¯¹äº Post è¯·æ±‚æ¥è¯´æ˜¯ä¸å¤ªå®‰å…¨çš„ï¼Œå› ä¸ºè¯·æ±‚çš„ url ä¼šè¢«ä¿ç•™åœ¨å†å²è®°å½•ä¸­ã€‚</li><li><strong>è¯·æ±‚é•¿åº¦ï¼š</strong> æµè§ˆå™¨ç”±äºå¯¹ url é•¿åº¦çš„é™åˆ¶ï¼Œæ‰€ä»¥ä¼šå½±å“ get è¯·æ±‚å‘é€æ•°æ®æ—¶çš„é•¿åº¦ã€‚è¿™ä¸ªé™åˆ¶æ˜¯æµè§ˆå™¨è§„å®šçš„ï¼Œå¹¶ä¸æ˜¯ RFC è§„å®šçš„ã€‚</li><li><strong>å‚æ•°ç±»å‹ï¼š</strong> post çš„å‚æ•°ä¼ é€’æ”¯æŒæ›´å¤šçš„æ•°æ®ç±»å‹ã€‚</li></ul><h3 id="2-POSTå’ŒPUTè¯·æ±‚çš„åŒºåˆ«"><a href="#2-POSTå’ŒPUTè¯·æ±‚çš„åŒºåˆ«" class="headerlink" title="2. POSTå’ŒPUTè¯·æ±‚çš„åŒºåˆ«"></a>2. POSTå’ŒPUTè¯·æ±‚çš„åŒºåˆ«</h3><ul><li>PUTè¯·æ±‚æ˜¯å‘æœåŠ¡å™¨ç«¯å‘é€æ•°æ®ï¼Œä»è€Œä¿®æ”¹æ•°æ®çš„å†…å®¹ï¼Œä½†æ˜¯ä¸ä¼šå¢åŠ æ•°æ®çš„ç§ç±»ç­‰ï¼Œä¹Ÿå°±æ˜¯è¯´æ— è®ºè¿›è¡Œå¤šå°‘æ¬¡PUTæ“ä½œï¼Œå…¶ç»“æœå¹¶æ²¡æœ‰ä¸åŒã€‚ï¼ˆå¯ä»¥ç†è§£ä¸ºæ—¶<strong>æ›´æ–°æ•°æ®</strong>ï¼‰</li><li>POSTè¯·æ±‚æ˜¯å‘æœåŠ¡å™¨ç«¯å‘é€æ•°æ®ï¼Œè¯¥è¯·æ±‚ä¼šæ”¹å˜æ•°æ®çš„ç§ç±»ç­‰èµ„æºï¼Œå®ƒä¼šåˆ›å»ºæ–°çš„å†…å®¹ã€‚ï¼ˆå¯ä»¥ç†è§£ä¸ºæ˜¯<strong>åˆ›å»ºæ•°æ®</strong>ï¼‰</li></ul><h3 id="3-å¸¸è§çš„HTTPè¯·æ±‚å¤´å’Œå“åº”å¤´"><a href="#3-å¸¸è§çš„HTTPè¯·æ±‚å¤´å’Œå“åº”å¤´" class="headerlink" title="3. å¸¸è§çš„HTTPè¯·æ±‚å¤´å’Œå“åº”å¤´"></a>3. å¸¸è§çš„HTTPè¯·æ±‚å¤´å’Œå“åº”å¤´</h3><p><strong>HTTP Request Header å¸¸è§çš„è¯·æ±‚å¤´ï¼š</strong></p><ul><li>Accept:æµè§ˆå™¨èƒ½å¤Ÿå¤„ç†çš„å†…å®¹ç±»å‹</li><li>Accept-Charset:æµè§ˆå™¨èƒ½å¤Ÿæ˜¾ç¤ºçš„å­—ç¬¦é›†</li><li>Accept-Encodingï¼šæµè§ˆå™¨èƒ½å¤Ÿå¤„ç†çš„å‹ç¼©ç¼–ç </li><li>Accept-Languageï¼šæµè§ˆå™¨å½“å‰è®¾ç½®çš„è¯­è¨€</li><li>Connectionï¼šæµè§ˆå™¨ä¸æœåŠ¡å™¨ä¹‹é—´è¿æ¥çš„ç±»å‹</li><li>Cookieï¼šå½“å‰é¡µé¢è®¾ç½®çš„ä»»ä½•Cookie</li><li>Hostï¼šå‘å‡ºè¯·æ±‚çš„é¡µé¢æ‰€åœ¨çš„åŸŸ</li><li>Refererï¼šå‘å‡ºè¯·æ±‚çš„é¡µé¢çš„URL</li><li>User-Agentï¼šæµè§ˆå™¨çš„ç”¨æˆ·ä»£ç†å­—ç¬¦ä¸²</li></ul><p><strong>HTTP Responses Header å¸¸è§çš„å“åº”å¤´ï¼š</strong></p><ul><li>Dateï¼šè¡¨ç¤ºæ¶ˆæ¯å‘é€çš„æ—¶é—´ï¼Œæ—¶é—´çš„æè¿°æ ¼å¼ç”±rfc822å®šä¹‰</li><li>server:æœåŠ¡å™¨åç§°</li><li>Connectionï¼šæµè§ˆå™¨ä¸æœåŠ¡å™¨ä¹‹é—´è¿æ¥çš„ç±»å‹</li><li>Cache-Controlï¼šæ§åˆ¶HTTPç¼“å­˜</li><li>content-type:è¡¨ç¤ºåé¢çš„æ–‡æ¡£å±äºä»€ä¹ˆMIMEç±»å‹</li></ul><p>å¸¸è§çš„ Content-Type å±æ€§å€¼æœ‰ä»¥ä¸‹å››ç§ï¼š</p><p>ï¼ˆ1ï¼‰application/x-www-form-urlencodedï¼šæµè§ˆå™¨çš„åŸç”Ÿ form è¡¨å•ï¼Œå¦‚æœä¸è®¾ç½® enctype å±æ€§ï¼Œé‚£ä¹ˆæœ€ç»ˆå°±ä¼šä»¥ application/x-www-form-urlencoded æ–¹å¼æäº¤æ•°æ®ã€‚è¯¥ç§æ–¹å¼æäº¤çš„æ•°æ®æ”¾åœ¨ body é‡Œé¢ï¼Œæ•°æ®æŒ‰ç…§ key1=val1&amp;key2=val2 çš„æ–¹å¼è¿›è¡Œç¼–ç ï¼Œkey å’Œ val éƒ½è¿›è¡Œäº† URLè½¬ç ã€‚</p><p>ï¼ˆ2ï¼‰multipart/form-dataï¼šè¯¥ç§æ–¹å¼ä¹Ÿæ˜¯ä¸€ä¸ªå¸¸è§çš„ POST æäº¤æ–¹å¼ï¼Œé€šå¸¸è¡¨å•ä¸Šä¼ æ–‡ä»¶æ—¶ä½¿ç”¨è¯¥ç§æ–¹å¼ã€‚</p><p>ï¼ˆ3ï¼‰application/jsonï¼šæœåŠ¡å™¨æ¶ˆæ¯ä¸»ä½“æ˜¯åºåˆ—åŒ–åçš„ JSON å­—ç¬¦ä¸²ã€‚</p><p>ï¼ˆ4ï¼‰text/xmlï¼šè¯¥ç§æ–¹å¼ä¸»è¦ç”¨æ¥æäº¤ XML æ ¼å¼çš„æ•°æ®ã€‚</p><h3 id="4-HTTPçŠ¶æ€ç 304æ˜¯å¤šå¥½è¿˜æ˜¯å°‘å¥½"><a href="#4-HTTPçŠ¶æ€ç 304æ˜¯å¤šå¥½è¿˜æ˜¯å°‘å¥½" class="headerlink" title="4. HTTPçŠ¶æ€ç 304æ˜¯å¤šå¥½è¿˜æ˜¯å°‘å¥½"></a>4. HTTPçŠ¶æ€ç 304æ˜¯å¤šå¥½è¿˜æ˜¯å°‘å¥½</h3><p>æœåŠ¡å™¨ä¸ºäº†æé«˜ç½‘ç«™è®¿é—®é€Ÿåº¦ï¼Œå¯¹ä¹‹å‰è®¿é—®çš„éƒ¨åˆ†é¡µé¢æŒ‡å®šç¼“å­˜æœºåˆ¶ï¼Œå½“å®¢æˆ·ç«¯åœ¨æ­¤å¯¹è¿™äº›é¡µé¢è¿›è¡Œè¯·æ±‚ï¼ŒæœåŠ¡å™¨ä¼šæ ¹æ®ç¼“å­˜å†…å®¹åˆ¤æ–­é¡µé¢ä¸ä¹‹å‰æ˜¯å¦ç›¸åŒï¼Œè‹¥ç›¸åŒä¾¿ç›´æ¥è¿”å›304ï¼Œæ­¤æ—¶å®¢æˆ·ç«¯è°ƒç”¨ç¼“å­˜å†…å®¹ï¼Œä¸å¿…è¿›è¡ŒäºŒæ¬¡ä¸‹è½½ã€‚</p><p>çŠ¶æ€ç 304ä¸åº”è¯¥è®¤ä¸ºæ˜¯ä¸€ç§é”™è¯¯ï¼Œè€Œæ˜¯å¯¹å®¢æˆ·ç«¯<strong>æœ‰ç¼“å­˜æƒ…å†µä¸‹</strong>æœåŠ¡ç«¯çš„ä¸€ç§å“åº”ã€‚</p><p>æœç´¢å¼•æ“èœ˜è››ä¼šæ›´åŠ é’çå†…å®¹æºæ›´æ–°é¢‘ç¹çš„ç½‘ç«™ã€‚é€šè¿‡ç‰¹å®šæ—¶é—´å†…å¯¹ç½‘ç«™æŠ“å–è¿”å›çš„çŠ¶æ€ç æ¥è°ƒèŠ‚å¯¹è¯¥ç½‘ç«™çš„æŠ“å–é¢‘æ¬¡ã€‚è‹¥ç½‘ç«™åœ¨ä¸€å®šæ—¶é—´å†…ä¸€ç›´å¤„äº304çš„çŠ¶æ€ï¼Œé‚£ä¹ˆèœ˜è››å¯èƒ½ä¼šé™ä½å¯¹ç½‘ç«™çš„æŠ“å–æ¬¡æ•°ã€‚ç›¸åï¼Œè‹¥ç½‘ç«™å˜åŒ–çš„é¢‘ç‡éå¸¸ä¹‹å¿«ï¼Œæ¯æ¬¡æŠ“å–éƒ½èƒ½è·å–æ–°å†…å®¹ï¼Œé‚£ä¹ˆæ—¥ç§¯æœˆç´¯ï¼Œçš„å›è®¿ç‡ä¹Ÿä¼šæé«˜ã€‚</p><p><strong>äº§ç”Ÿè¾ƒå¤š304çŠ¶æ€ç çš„åŸå› ï¼š</strong></p><ul><li>é¡µé¢æ›´æ–°å‘¨æœŸé•¿æˆ–ä¸æ›´æ–°</li><li>çº¯é™æ€é¡µé¢æˆ–å¼ºåˆ¶ç”Ÿæˆé™æ€html</li></ul><p><strong>304çŠ¶æ€ç å‡ºç°è¿‡å¤šä¼šé€ æˆä»¥ä¸‹é—®é¢˜ï¼š</strong></p><ul><li>ç½‘ç«™å¿«ç…§åœæ­¢ï¼›</li><li>æ”¶å½•å‡å°‘ï¼›</li><li>æƒé‡ä¸‹é™ã€‚</li></ul><h3 id="5-å¸¸è§çš„HTTPè¯·æ±‚æ–¹æ³•"><a href="#5-å¸¸è§çš„HTTPè¯·æ±‚æ–¹æ³•" class="headerlink" title="5. å¸¸è§çš„HTTPè¯·æ±‚æ–¹æ³•"></a>5. å¸¸è§çš„HTTPè¯·æ±‚æ–¹æ³•</h3><ul><li>GET: å‘æœåŠ¡å™¨è·å–æ•°æ®ï¼›</li><li>POSTï¼šå°†å®ä½“æäº¤åˆ°æŒ‡å®šçš„èµ„æºï¼Œé€šå¸¸ä¼šé€ æˆæœåŠ¡å™¨èµ„æºçš„ä¿®æ”¹ï¼›</li><li>PUTï¼šä¸Šä¼ æ–‡ä»¶ï¼Œæ›´æ–°æ•°æ®ï¼›</li><li>DELETEï¼šåˆ é™¤æœåŠ¡å™¨ä¸Šçš„å¯¹è±¡ï¼›</li><li>HEADï¼šè·å–æŠ¥æ–‡é¦–éƒ¨ï¼Œä¸GETç›¸æ¯”ï¼Œä¸è¿”å›æŠ¥æ–‡ä¸»ä½“éƒ¨åˆ†ï¼›</li><li>OPTIONSï¼šè¯¢é—®æ”¯æŒçš„è¯·æ±‚æ–¹æ³•ï¼Œç”¨æ¥è·¨åŸŸè¯·æ±‚ï¼›</li><li>CONNECTï¼šè¦æ±‚åœ¨ä¸ä»£ç†æœåŠ¡å™¨é€šä¿¡æ—¶å»ºç«‹éš§é“ï¼Œä½¿ç”¨éš§é“è¿›è¡ŒTCPé€šä¿¡ï¼›</li><li>TRACE: å›æ˜¾æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ï¼Œä¸»è¦â½¤äºæµ‹è¯•æˆ–è¯Šæ–­ã€‚</li></ul><h3 id="6-OPTIONSè¯·æ±‚æ–¹æ³•åŠä½¿ç”¨åœºæ™¯"><a href="#6-OPTIONSè¯·æ±‚æ–¹æ³•åŠä½¿ç”¨åœºæ™¯" class="headerlink" title="6. OPTIONSè¯·æ±‚æ–¹æ³•åŠä½¿ç”¨åœºæ™¯"></a>6. OPTIONSè¯·æ±‚æ–¹æ³•åŠä½¿ç”¨åœºæ™¯</h3><p>OPTIONSæ˜¯é™¤äº†GETå’ŒPOSTä¹‹å¤–çš„å…¶ä¸­ä¸€ç§ HTTPè¯·æ±‚æ–¹æ³•ã€‚</p><p>OPTIONSæ–¹æ³•æ˜¯ç”¨äºè¯·æ±‚è·å¾—ç”±<code>Request-URI</code>æ ‡è¯†çš„èµ„æºåœ¨è¯·æ±‚/å“åº”çš„é€šä¿¡è¿‡ç¨‹ä¸­å¯ä»¥ä½¿ç”¨çš„åŠŸèƒ½é€‰é¡¹ã€‚é€šè¿‡è¿™ä¸ªæ–¹æ³•ï¼Œå®¢æˆ·ç«¯å¯ä»¥<strong>åœ¨é‡‡å–å…·ä½“èµ„æºè¯·æ±‚ä¹‹å‰ï¼Œå†³å®šå¯¹è¯¥èµ„æºé‡‡å–ä½•ç§å¿…è¦æªæ–½ï¼Œæˆ–è€…äº†è§£æœåŠ¡å™¨çš„æ€§èƒ½</strong>ã€‚è¯¥è¯·æ±‚æ–¹æ³•çš„å“åº”ä¸èƒ½ç¼“å­˜ã€‚</p><p>OPTIONSè¯·æ±‚æ–¹æ³•çš„<strong>ä¸»è¦ç”¨é€”</strong>æœ‰ä¸¤ä¸ªï¼š</p><ul><li>è·å–æœåŠ¡å™¨æ”¯æŒçš„æ‰€æœ‰HTTPè¯·æ±‚æ–¹æ³•ï¼›</li><li>ç”¨æ¥æ£€æŸ¥è®¿é—®æƒé™ã€‚ä¾‹å¦‚ï¼šåœ¨è¿›è¡Œ CORS è·¨åŸŸèµ„æºå…±äº«æ—¶ï¼Œå¯¹äºå¤æ‚è¯·æ±‚ï¼Œå°±æ˜¯ä½¿ç”¨ OPTIONS æ–¹æ³•å‘é€å—…æ¢è¯·æ±‚ï¼Œä»¥åˆ¤æ–­æ˜¯å¦æœ‰å¯¹æŒ‡å®šèµ„æºçš„è®¿é—®æƒé™ã€‚</li></ul><h3 id="7-HTTP-1-0-å’Œ-HTTP-1-1-ä¹‹é—´æœ‰å“ªäº›åŒºåˆ«ï¼Ÿ"><a href="#7-HTTP-1-0-å’Œ-HTTP-1-1-ä¹‹é—´æœ‰å“ªäº›åŒºåˆ«ï¼Ÿ" class="headerlink" title="7. HTTP 1.0 å’Œ HTTP 1.1 ä¹‹é—´æœ‰å“ªäº›åŒºåˆ«ï¼Ÿ"></a>7. HTTP 1.0 å’Œ HTTP 1.1 ä¹‹é—´æœ‰å“ªäº›åŒºåˆ«ï¼Ÿ</h3><p><strong>HTTP 1.0å’Œ HTTP 1.1 æœ‰ä»¥ä¸‹åŒºåˆ«</strong>ï¼š</p><ul><li><strong>è¿æ¥æ–¹é¢</strong>ï¼Œhttp1.0 é»˜è®¤ä½¿ç”¨éæŒä¹…è¿æ¥ï¼Œè€Œ http1.1 é»˜è®¤ä½¿ç”¨æŒä¹…è¿æ¥ã€‚http1.1 é€šè¿‡ä½¿ç”¨æŒä¹…è¿æ¥æ¥ä½¿å¤šä¸ª http è¯·æ±‚å¤ç”¨åŒä¸€ä¸ª TCP è¿æ¥ï¼Œä»¥æ­¤æ¥é¿å…ä½¿ç”¨éæŒä¹…è¿æ¥æ—¶æ¯æ¬¡éœ€è¦å»ºç«‹è¿æ¥çš„æ—¶å»¶ã€‚</li><li><strong>èµ„æºè¯·æ±‚æ–¹é¢</strong>ï¼Œåœ¨ http1.0 ä¸­ï¼Œå­˜åœ¨ä¸€äº›æµªè´¹å¸¦å®½çš„ç°è±¡ï¼Œä¾‹å¦‚å®¢æˆ·ç«¯åªæ˜¯éœ€è¦æŸä¸ªå¯¹è±¡çš„ä¸€éƒ¨åˆ†ï¼Œè€ŒæœåŠ¡å™¨å´å°†æ•´ä¸ªå¯¹è±¡é€è¿‡æ¥äº†ï¼Œå¹¶ä¸”ä¸æ”¯æŒæ–­ç‚¹ç»­ä¼ åŠŸèƒ½ï¼Œhttp1.1 åˆ™åœ¨è¯·æ±‚å¤´å¼•å…¥äº† range å¤´åŸŸï¼Œå®ƒå…è®¸åªè¯·æ±‚èµ„æºçš„æŸä¸ªéƒ¨åˆ†ï¼Œå³è¿”å›ç æ˜¯ 206ï¼ˆPartial Contentï¼‰ï¼Œè¿™æ ·å°±æ–¹ä¾¿äº†å¼€å‘è€…è‡ªç”±çš„é€‰æ‹©ä»¥ä¾¿äºå……åˆ†åˆ©ç”¨å¸¦å®½å’Œè¿æ¥ã€‚</li><li><strong>ç¼“å­˜æ–¹é¢</strong>ï¼Œåœ¨ http1.0 ä¸­ä¸»è¦ä½¿ç”¨ header é‡Œçš„ If-Modified-Sinceã€Expires æ¥åšä¸ºç¼“å­˜åˆ¤æ–­çš„æ ‡å‡†ï¼Œhttp1.1 åˆ™å¼•å…¥äº†æ›´å¤šçš„ç¼“å­˜æ§åˆ¶ç­–ç•¥ï¼Œä¾‹å¦‚ Etagã€If-Unmodified-Sinceã€If-Matchã€If-None-Match ç­‰æ›´å¤šå¯ä¾›é€‰æ‹©çš„ç¼“å­˜å¤´æ¥æ§åˆ¶ç¼“å­˜ç­–ç•¥ã€‚</li><li>http1.1 ä¸­<strong>æ–°å¢äº† host å­—æ®µ</strong>ï¼Œç”¨æ¥æŒ‡å®šæœåŠ¡å™¨çš„åŸŸåã€‚http1.0 ä¸­è®¤ä¸ºæ¯å°æœåŠ¡å™¨éƒ½ç»‘å®šä¸€ä¸ªå”¯ä¸€çš„ IP åœ°å€ï¼Œå› æ­¤ï¼Œè¯·æ±‚æ¶ˆæ¯ä¸­çš„ URL å¹¶æ²¡æœ‰ä¼ é€’ä¸»æœºåï¼ˆhostnameï¼‰ã€‚ä½†éšç€è™šæ‹Ÿä¸»æœºæŠ€æœ¯çš„å‘å±•ï¼Œåœ¨ä¸€å°ç‰©ç†æœåŠ¡å™¨ä¸Šå¯ä»¥å­˜åœ¨å¤šä¸ªè™šæ‹Ÿä¸»æœºï¼Œå¹¶ä¸”å®ƒä»¬å…±äº«ä¸€ä¸ªIPåœ°å€ã€‚å› æ­¤æœ‰äº† host å­—æ®µï¼Œè¿™æ ·å°±å¯ä»¥å°†è¯·æ±‚å‘å¾€åˆ°åŒä¸€å°æœåŠ¡å™¨ä¸Šçš„ä¸åŒç½‘ç«™ã€‚</li><li>http1.1 ç›¸å¯¹äº http1.0 è¿˜æ–°å¢äº†å¾ˆå¤š<strong>è¯·æ±‚æ–¹æ³•</strong>ï¼Œå¦‚ PUTã€HEADã€OPTIONS ç­‰ã€‚</li></ul><h3 id="8-HTTP-1-1-å’Œ-HTTP-2-0-çš„åŒºåˆ«"><a href="#8-HTTP-1-1-å’Œ-HTTP-2-0-çš„åŒºåˆ«" class="headerlink" title="8. HTTP 1.1 å’Œ HTTP 2.0 çš„åŒºåˆ«"></a>8. HTTP 1.1 å’Œ HTTP 2.0 çš„åŒºåˆ«</h3><ul><li><strong>äºŒè¿›åˆ¶åè®®</strong>ï¼šHTTP/2 æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶åè®®ã€‚åœ¨ HTTP/1.1 ç‰ˆä¸­ï¼ŒæŠ¥æ–‡çš„å¤´ä¿¡æ¯å¿…é¡»æ˜¯æ–‡æœ¬ï¼ˆASCII ç¼–ç ï¼‰ï¼Œæ•°æ®ä½“å¯ä»¥æ˜¯æ–‡æœ¬ï¼Œä¹Ÿå¯ä»¥æ˜¯äºŒè¿›åˆ¶ã€‚HTTP/2 åˆ™æ˜¯ä¸€ä¸ªå½»åº•çš„äºŒè¿›åˆ¶åè®®ï¼Œå¤´ä¿¡æ¯å’Œæ•°æ®ä½“éƒ½æ˜¯äºŒè¿›åˆ¶ï¼Œå¹¶ä¸”ç»Ÿç§°ä¸ºâ€å¸§â€ï¼Œå¯ä»¥åˆ†ä¸ºå¤´ä¿¡æ¯å¸§å’Œæ•°æ®å¸§ã€‚ å¸§çš„æ¦‚å¿µæ˜¯å®ƒå®ç°å¤šè·¯å¤ç”¨çš„åŸºç¡€ã€‚</li><li><strong>å¤šè·¯å¤ç”¨ï¼š</strong> HTTP/2 å®ç°äº†å¤šè·¯å¤ç”¨ï¼ŒHTTP/2 ä»ç„¶å¤ç”¨ TCP è¿æ¥ï¼Œä½†æ˜¯åœ¨ä¸€ä¸ªè¿æ¥é‡Œï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éƒ½å¯ä»¥åŒæ—¶å‘é€å¤šä¸ªè¯·æ±‚æˆ–å›åº”ï¼Œè€Œä¸”ä¸ç”¨æŒ‰ç…§é¡ºåºä¸€ä¸€å‘é€ï¼Œè¿™æ ·å°±é¿å…äº†â€é˜Ÿå¤´å µå¡â€ã€1ã€‘çš„é—®é¢˜ã€‚</li><li><strong>æ•°æ®æµï¼š</strong> HTTP/2 ä½¿ç”¨äº†æ•°æ®æµçš„æ¦‚å¿µï¼Œå› ä¸º HTTP/2 çš„æ•°æ®åŒ…æ˜¯ä¸æŒ‰é¡ºåºå‘é€çš„ï¼ŒåŒä¸€ä¸ªè¿æ¥é‡Œé¢è¿ç»­çš„æ•°æ®åŒ…ï¼Œå¯èƒ½å±äºä¸åŒçš„è¯·æ±‚ã€‚å› æ­¤ï¼Œå¿…é¡»è¦å¯¹æ•°æ®åŒ…åšæ ‡è®°ï¼ŒæŒ‡å‡ºå®ƒå±äºå“ªä¸ªè¯·æ±‚ã€‚HTTP/2 å°†æ¯ä¸ªè¯·æ±‚æˆ–å›åº”çš„æ‰€æœ‰æ•°æ®åŒ…ï¼Œç§°ä¸ºä¸€ä¸ªæ•°æ®æµã€‚æ¯ä¸ªæ•°æ®æµéƒ½æœ‰ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„ç¼–å·ã€‚æ•°æ®åŒ…å‘é€æ—¶ï¼Œéƒ½å¿…é¡»æ ‡è®°æ•°æ®æµ ID ï¼Œç”¨æ¥åŒºåˆ†å®ƒå±äºå“ªä¸ªæ•°æ®æµã€‚</li><li><strong>å¤´ä¿¡æ¯å‹ç¼©ï¼š</strong> HTTP/2 å®ç°äº†å¤´ä¿¡æ¯å‹ç¼©ï¼Œç”±äº HTTP 1.1 åè®®ä¸å¸¦çŠ¶æ€ï¼Œæ¯æ¬¡è¯·æ±‚éƒ½å¿…é¡»é™„ä¸Šæ‰€æœ‰ä¿¡æ¯ã€‚æ‰€ä»¥ï¼Œè¯·æ±‚çš„å¾ˆå¤šå­—æ®µéƒ½æ˜¯é‡å¤çš„ï¼Œæ¯”å¦‚ Cookie å’Œ User Agent ï¼Œä¸€æ¨¡ä¸€æ ·çš„å†…å®¹ï¼Œæ¯æ¬¡è¯·æ±‚éƒ½å¿…é¡»é™„å¸¦ï¼Œè¿™ä¼šæµªè´¹å¾ˆå¤šå¸¦å®½ï¼Œä¹Ÿå½±å“é€Ÿåº¦ã€‚HTTP/2 å¯¹è¿™ä¸€ç‚¹åšäº†ä¼˜åŒ–ï¼Œå¼•å…¥äº†å¤´ä¿¡æ¯å‹ç¼©æœºåˆ¶ã€‚ä¸€æ–¹é¢ï¼Œå¤´ä¿¡æ¯ä½¿ç”¨ gzip æˆ– compress å‹ç¼©åå†å‘é€ï¼›å¦ä¸€æ–¹é¢ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åŒæ—¶ç»´æŠ¤ä¸€å¼ å¤´ä¿¡æ¯è¡¨ï¼Œæ‰€æœ‰å­—æ®µéƒ½ä¼šå­˜å…¥è¿™ä¸ªè¡¨ï¼Œç”Ÿæˆä¸€ä¸ªç´¢å¼•å·ï¼Œä»¥åå°±ä¸å‘é€åŒæ ·å­—æ®µäº†ï¼Œåªå‘é€ç´¢å¼•å·ï¼Œè¿™æ ·å°±èƒ½æé«˜é€Ÿåº¦äº†ã€‚</li><li><strong>æœåŠ¡å™¨æ¨é€ï¼š</strong> HTTP/2 å…è®¸æœåŠ¡å™¨æœªç»è¯·æ±‚ï¼Œä¸»åŠ¨å‘å®¢æˆ·ç«¯å‘é€èµ„æºï¼Œè¿™å«åšæœåŠ¡å™¨æ¨é€ã€‚ä½¿ç”¨æœåŠ¡å™¨æ¨é€æå‰ç»™å®¢æˆ·ç«¯æ¨é€å¿…è¦çš„èµ„æºï¼Œè¿™æ ·å°±å¯ä»¥ç›¸å¯¹å‡å°‘ä¸€äº›å»¶è¿Ÿæ—¶é—´ã€‚è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ http2 ä¸‹æœåŠ¡å™¨ä¸»åŠ¨æ¨é€çš„æ˜¯é™æ€èµ„æºï¼Œå’Œ WebSocket ä»¥åŠä½¿ç”¨ SSE ç­‰æ–¹å¼å‘å®¢æˆ·ç«¯å‘é€å³æ—¶æ•°æ®çš„æ¨é€æ˜¯ä¸åŒçš„ã€‚</li></ul><p><strong>ã€1ã€‘é˜Ÿå¤´å µå¡ï¼š</strong></p><blockquote><p>é˜Ÿå¤´é˜»å¡æ˜¯ç”± HTTP åŸºæœ¬çš„â€œè¯·æ±‚ - åº”ç­”â€æ¨¡å‹æ‰€å¯¼è‡´çš„ã€‚HTTP è§„å®šæŠ¥æ–‡å¿…é¡»æ˜¯â€œä¸€å‘ä¸€æ”¶â€ï¼Œè¿™å°±å½¢æˆäº†ä¸€ä¸ªå…ˆè¿›å…ˆå‡ºçš„â€œä¸²è¡Œâ€é˜Ÿåˆ—ã€‚é˜Ÿåˆ—é‡Œçš„è¯·æ±‚æ˜¯æ²¡æœ‰ä¼˜å…ˆçº§çš„ï¼Œåªæœ‰å…¥é˜Ÿçš„å…ˆåé¡ºåºï¼Œæ’åœ¨æœ€å‰é¢çš„è¯·æ±‚ä¼šè¢«æœ€ä¼˜å…ˆå¤„ç†ã€‚å¦‚æœé˜Ÿé¦–çš„è¯·æ±‚å› ä¸ºå¤„ç†çš„å¤ªæ…¢è€½è¯¯äº†æ—¶é—´ï¼Œé‚£ä¹ˆé˜Ÿåˆ—é‡Œåé¢çš„æ‰€æœ‰è¯·æ±‚ä¹Ÿä¸å¾—ä¸è·Ÿç€ä¸€èµ·ç­‰å¾…ï¼Œç»“æœå°±æ˜¯å…¶ä»–çš„è¯·æ±‚æ‰¿æ‹…äº†ä¸åº”æœ‰çš„æ—¶é—´æˆæœ¬ï¼Œé€ æˆäº†é˜Ÿå¤´å µå¡çš„ç°è±¡ã€‚</p></blockquote><h3 id="9-HTTPå’ŒHTTPSåè®®çš„åŒºåˆ«"><a href="#9-HTTPå’ŒHTTPSåè®®çš„åŒºåˆ«" class="headerlink" title="9. HTTPå’ŒHTTPSåè®®çš„åŒºåˆ«"></a>9. HTTPå’ŒHTTPSåè®®çš„åŒºåˆ«</h3><p>HTTPå’ŒHTTPSåè®®çš„ä¸»è¦åŒºåˆ«å¦‚ä¸‹ï¼š</p><ul><li>HTTPSåè®®éœ€è¦CAè¯ä¹¦ï¼Œè´¹ç”¨è¾ƒé«˜ï¼›è€ŒHTTPåè®®ä¸éœ€è¦ï¼›</li><li>HTTPåè®®æ˜¯è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œä¿¡æ¯æ˜¯æ˜æ–‡ä¼ è¾“çš„ï¼ŒHTTPSåˆ™æ˜¯å…·æœ‰å®‰å…¨æ€§çš„SSLåŠ å¯†ä¼ è¾“åè®®ï¼›</li><li>ä½¿ç”¨ä¸åŒçš„è¿æ¥æ–¹å¼ï¼Œç«¯å£ä¹Ÿä¸åŒï¼ŒHTTPåè®®ç«¯å£æ˜¯80ï¼ŒHTTPSåè®®ç«¯å£æ˜¯443ï¼›</li><li>HTTPåè®®è¿æ¥å¾ˆç®€å•ï¼Œæ˜¯æ— çŠ¶æ€çš„ï¼›HTTPSåè®®æ˜¯æœ‰SSLå’ŒHTTPåè®®æ„å»ºçš„å¯è¿›è¡ŒåŠ å¯†ä¼ è¾“ã€èº«ä»½è®¤è¯çš„ç½‘ç»œåè®®ï¼Œæ¯”HTTPæ›´åŠ å®‰å…¨ã€‚</li></ul><h3 id="10-GETæ–¹æ³•URLé•¿åº¦é™åˆ¶çš„åŸå› "><a href="#10-GETæ–¹æ³•URLé•¿åº¦é™åˆ¶çš„åŸå› " class="headerlink" title="10. GETæ–¹æ³•URLé•¿åº¦é™åˆ¶çš„åŸå› "></a>10. GETæ–¹æ³•URLé•¿åº¦é™åˆ¶çš„åŸå› </h3><p>å®é™…ä¸ŠHTTPåè®®è§„èŒƒå¹¶æ²¡æœ‰å¯¹getæ–¹æ³•è¯·æ±‚çš„urlé•¿åº¦è¿›è¡Œé™åˆ¶ï¼Œè¿™ä¸ªé™åˆ¶æ˜¯ç‰¹å®šçš„æµè§ˆå™¨åŠæœåŠ¡å™¨å¯¹å®ƒçš„é™åˆ¶ã€‚<br>IEå¯¹URLé•¿åº¦çš„é™åˆ¶æ˜¯2083å­—èŠ‚(2K+35)ã€‚ç”±äºIEæµè§ˆå™¨å¯¹URLé•¿åº¦çš„å…è®¸å€¼æ˜¯æœ€å°çš„ï¼Œæ‰€ä»¥å¼€å‘è¿‡ç¨‹ä¸­ï¼Œåªè¦URLä¸è¶…è¿‡2083å­—èŠ‚ï¼Œé‚£ä¹ˆåœ¨æ‰€æœ‰æµè§ˆå™¨ä¸­å·¥ä½œéƒ½ä¸ä¼šæœ‰é—®é¢˜ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript">GETçš„é•¿åº¦å€¼ <span class="token operator">=</span> URLï¼ˆ<span class="token number">2083</span>ï¼‰<span class="token operator">-</span> ï¼ˆä½ çš„Domain<span class="token operator">+</span>Pathï¼‰<span class="token operator">-</span><span class="token number">2</span>ï¼ˆ<span class="token number">2</span>æ˜¯<span class="token keyword">get</span>è¯·æ±‚ä¸­<span class="token operator">?</span><span class="token operator">=</span>ä¸¤ä¸ªå­—ç¬¦çš„é•¿åº¦ï¼‰<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¸‹é¢çœ‹ä¸€ä¸‹ä¸»æµæµè§ˆå™¨å¯¹getæ–¹æ³•ä¸­urlçš„é•¿åº¦é™åˆ¶èŒƒå›´ï¼š</p><ul><li>Microsoft Internet Explorer (Browser)ï¼šIEæµè§ˆå™¨å¯¹URLçš„æœ€å¤§é™åˆ¶ä¸º2083ä¸ªå­—ç¬¦ï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªæ•°å­—ï¼Œæäº¤æŒ‰é’®æ²¡æœ‰ä»»ä½•ååº”ã€‚</li><li>Firefox (Browser)ï¼šå¯¹äºFirefoxæµè§ˆå™¨URLçš„é•¿åº¦é™åˆ¶ä¸º 65,536 ä¸ªå­—ç¬¦ã€‚</li><li>Safari (Browser)ï¼šURLæœ€å¤§é•¿åº¦é™åˆ¶ä¸º 80,000 ä¸ªå­—ç¬¦ã€‚</li><li>Opera (Browser)ï¼šURLæœ€å¤§é•¿åº¦é™åˆ¶ä¸º 190,000 ä¸ªå­—ç¬¦ã€‚</li><li>Google (chrome)ï¼šURLæœ€å¤§é•¿åº¦é™åˆ¶ä¸º 8182 ä¸ªå­—ç¬¦ã€‚</li></ul><p>ä¸»æµçš„æœåŠ¡å™¨å¯¹getæ–¹æ³•ä¸­urlçš„é•¿åº¦é™åˆ¶èŒƒå›´ï¼š</p><ul><li>Apache (Server)ï¼šèƒ½æ¥å—æœ€å¤§urlé•¿åº¦ä¸º8192ä¸ªå­—ç¬¦ã€‚</li><li>Microsoft Internet Information Server(IIS)ï¼šèƒ½æ¥å—æœ€å¤§urlçš„é•¿åº¦ä¸º16384ä¸ªå­—ç¬¦ã€‚</li></ul><p>æ ¹æ®ä¸Šé¢çš„æ•°æ®ï¼Œå¯ä»¥çŸ¥é“ï¼Œgetæ–¹æ³•ä¸­çš„URLé•¿åº¦æœ€é•¿ä¸è¶…è¿‡2083ä¸ªå­—ç¬¦ï¼Œè¿™æ ·æ‰€æœ‰çš„æµè§ˆå™¨å’ŒæœåŠ¡å™¨éƒ½å¯èƒ½æ­£å¸¸å·¥ä½œã€‚</p><h3 id="11-å½“åœ¨æµè§ˆå™¨ä¸­è¾“å…¥-Google-com-å¹¶ä¸”æŒ‰ä¸‹å›è½¦ä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ"><a href="#11-å½“åœ¨æµè§ˆå™¨ä¸­è¾“å…¥-Google-com-å¹¶ä¸”æŒ‰ä¸‹å›è½¦ä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ" class="headerlink" title="11. å½“åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ Google.com å¹¶ä¸”æŒ‰ä¸‹å›è½¦ä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ"></a>11. å½“åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ Google.com å¹¶ä¸”æŒ‰ä¸‹å›è½¦ä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</h3><p>ï¼ˆ1ï¼‰<strong>è§£æURLï¼š</strong> é¦–å…ˆä¼šå¯¹ URL è¿›è¡Œè§£æï¼Œåˆ†ææ‰€éœ€è¦ä½¿ç”¨çš„ä¼ è¾“åè®®å’Œè¯·æ±‚çš„èµ„æºçš„è·¯å¾„ã€‚å¦‚æœè¾“å…¥çš„ URL ä¸­çš„åè®®æˆ–è€…ä¸»æœºåä¸åˆæ³•ï¼Œå°†ä¼šæŠŠåœ°å€æ ä¸­è¾“å…¥çš„å†…å®¹ä¼ é€’ç»™æœç´¢å¼•æ“ã€‚å¦‚æœæ²¡æœ‰é—®é¢˜ï¼Œæµè§ˆå™¨ä¼šæ£€æŸ¥ URL ä¸­æ˜¯å¦å‡ºç°äº†éæ³•å­—ç¬¦ï¼Œå¦‚æœå­˜åœ¨éæ³•å­—ç¬¦ï¼Œåˆ™å¯¹éæ³•å­—ç¬¦è¿›è¡Œè½¬ä¹‰åå†è¿›è¡Œä¸‹ä¸€è¿‡ç¨‹ã€‚</p><p>ï¼ˆ2ï¼‰<strong>ç¼“å­˜åˆ¤æ–­ï¼š</strong> æµè§ˆå™¨ä¼šåˆ¤æ–­æ‰€è¯·æ±‚çš„èµ„æºæ˜¯å¦åœ¨ç¼“å­˜é‡Œï¼Œå¦‚æœè¯·æ±‚çš„èµ„æºåœ¨ç¼“å­˜é‡Œå¹¶ä¸”æ²¡æœ‰å¤±æ•ˆï¼Œé‚£ä¹ˆå°±ç›´æ¥ä½¿ç”¨ï¼Œå¦åˆ™å‘æœåŠ¡å™¨å‘èµ·æ–°çš„è¯·æ±‚ã€‚</p><p>ï¼ˆ3ï¼‰<strong>DNSè§£æï¼š</strong> ä¸‹ä¸€æ­¥é¦–å…ˆéœ€è¦è·å–çš„æ˜¯è¾“å…¥çš„ URL ä¸­çš„åŸŸåçš„ IP åœ°å€ï¼Œé¦–å…ˆä¼šåˆ¤æ–­æœ¬åœ°æ˜¯å¦æœ‰è¯¥åŸŸåçš„ IP åœ°å€çš„ç¼“å­˜ï¼Œå¦‚æœæœ‰åˆ™ä½¿ç”¨ï¼Œå¦‚æœæ²¡æœ‰åˆ™å‘æœ¬åœ° DNS æœåŠ¡å™¨å‘èµ·è¯·æ±‚ã€‚æœ¬åœ° DNS æœåŠ¡å™¨ä¹Ÿä¼šå…ˆæ£€æŸ¥æ˜¯å¦å­˜åœ¨ç¼“å­˜ï¼Œå¦‚æœæ²¡æœ‰å°±ä¼šå…ˆå‘æ ¹åŸŸåæœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼Œè·å¾—è´Ÿè´£çš„é¡¶çº§åŸŸåæœåŠ¡å™¨çš„åœ°å€åï¼Œå†å‘é¡¶çº§åŸŸåæœåŠ¡å™¨è¯·æ±‚ï¼Œç„¶åè·å¾—è´Ÿè´£çš„æƒå¨åŸŸåæœåŠ¡å™¨çš„åœ°å€åï¼Œå†å‘æƒå¨åŸŸåæœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼Œæœ€ç»ˆè·å¾—åŸŸåçš„ IP åœ°å€åï¼Œæœ¬åœ° DNS æœåŠ¡å™¨å†å°†è¿™ä¸ª IP åœ°å€è¿”å›ç»™è¯·æ±‚çš„ç”¨æˆ·ã€‚ç”¨æˆ·å‘æœ¬åœ° DNS æœåŠ¡å™¨å‘èµ·è¯·æ±‚å±äºé€’å½’è¯·æ±‚ï¼Œæœ¬åœ° DNS æœåŠ¡å™¨å‘å„çº§åŸŸåæœåŠ¡å™¨å‘èµ·è¯·æ±‚å±äºè¿­ä»£è¯·æ±‚ã€‚</p><p>ï¼ˆ4ï¼‰<strong>è·å–MACåœ°å€ï¼š</strong> å½“æµè§ˆå™¨å¾—åˆ° IP åœ°å€åï¼Œæ•°æ®ä¼ è¾“è¿˜éœ€è¦çŸ¥é“ç›®çš„ä¸»æœº MAC åœ°å€ï¼Œå› ä¸ºåº”ç”¨å±‚ä¸‹å‘æ•°æ®ç»™ä¼ è¾“å±‚ï¼ŒTCP åè®®ä¼šæŒ‡å®šæºç«¯å£å·å’Œç›®çš„ç«¯å£å·ï¼Œç„¶åä¸‹å‘ç»™ç½‘ç»œå±‚ã€‚ç½‘ç»œå±‚ä¼šå°†æœ¬æœºåœ°å€ä½œä¸ºæºåœ°å€ï¼Œè·å–çš„ IP åœ°å€ä½œä¸ºç›®çš„åœ°å€ã€‚ç„¶åå°†ä¸‹å‘ç»™æ•°æ®é“¾è·¯å±‚ï¼Œæ•°æ®é“¾è·¯å±‚çš„å‘é€éœ€è¦åŠ å…¥é€šä¿¡åŒæ–¹çš„ MAC åœ°å€ï¼Œæœ¬æœºçš„ MAC åœ°å€ä½œä¸ºæº MAC åœ°å€ï¼Œç›®çš„ MAC åœ°å€éœ€è¦åˆ†æƒ…å†µå¤„ç†ã€‚é€šè¿‡å°† IP åœ°å€ä¸æœ¬æœºçš„å­ç½‘æ©ç ç›¸ä¸ï¼Œå¯ä»¥åˆ¤æ–­æ˜¯å¦ä¸è¯·æ±‚ä¸»æœºåœ¨åŒä¸€ä¸ªå­ç½‘é‡Œï¼Œå¦‚æœåœ¨åŒä¸€ä¸ªå­ç½‘é‡Œï¼Œå¯ä»¥ä½¿ç”¨ APR åè®®è·å–åˆ°ç›®çš„ä¸»æœºçš„ MAC åœ°å€ï¼Œå¦‚æœä¸åœ¨ä¸€ä¸ªå­ç½‘é‡Œï¼Œé‚£ä¹ˆè¯·æ±‚åº”è¯¥è½¬å‘ç»™ç½‘å…³ï¼Œç”±å®ƒä»£ä¸ºè½¬å‘ï¼Œæ­¤æ—¶åŒæ ·å¯ä»¥é€šè¿‡ ARP åè®®æ¥è·å–ç½‘å…³çš„ MAC åœ°å€ï¼Œæ­¤æ—¶ç›®çš„ä¸»æœºçš„ MAC åœ°å€åº”è¯¥ä¸ºç½‘å…³çš„åœ°å€ã€‚</p><p>ï¼ˆ5ï¼‰<strong>TCPä¸‰æ¬¡æ¡æ‰‹ï¼š</strong> ä¸‹é¢æ˜¯ TCP å»ºç«‹è¿æ¥çš„ä¸‰æ¬¡æ¡æ‰‹çš„è¿‡ç¨‹ï¼Œé¦–å…ˆå®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€ä¸€ä¸ª SYN è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µå’Œä¸€ä¸ªéšæœºåºå·ï¼ŒæœåŠ¡ç«¯æ¥æ”¶åˆ°è¯·æ±‚åå‘æœåŠ¡å™¨ç«¯å‘é€ä¸€ä¸ª SYN ACKæŠ¥æ–‡æ®µï¼Œç¡®è®¤è¿æ¥è¯·æ±‚ï¼Œå¹¶ä¸”ä¹Ÿå‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªéšæœºåºå·ã€‚å®¢æˆ·ç«¯æ¥æ”¶æœåŠ¡å™¨çš„ç¡®è®¤åº”ç­”åï¼Œè¿›å…¥è¿æ¥å»ºç«‹çš„çŠ¶æ€ï¼ŒåŒæ—¶å‘æœåŠ¡å™¨ä¹Ÿå‘é€ä¸€ä¸ªACK ç¡®è®¤æŠ¥æ–‡æ®µï¼ŒæœåŠ¡å™¨ç«¯æ¥æ”¶åˆ°ç¡®è®¤åï¼Œä¹Ÿè¿›å…¥è¿æ¥å»ºç«‹çŠ¶æ€ï¼Œæ­¤æ—¶åŒæ–¹çš„è¿æ¥å°±å»ºç«‹èµ·æ¥äº†ã€‚</p><p>ï¼ˆ6ï¼‰<strong>HTTPSæ¡æ‰‹ï¼š</strong> å¦‚æœä½¿ç”¨çš„æ˜¯ HTTPS åè®®ï¼Œåœ¨é€šä¿¡å‰è¿˜å­˜åœ¨ TLS çš„ä¸€ä¸ªå››æ¬¡æ¡æ‰‹çš„è¿‡ç¨‹ã€‚é¦–å…ˆç”±å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯å‘é€ä½¿ç”¨çš„åè®®çš„ç‰ˆæœ¬å·ã€ä¸€ä¸ªéšæœºæ•°å’Œå¯ä»¥ä½¿ç”¨çš„åŠ å¯†æ–¹æ³•ã€‚æœåŠ¡å™¨ç«¯æ”¶åˆ°åï¼Œç¡®è®¤åŠ å¯†çš„æ–¹æ³•ï¼Œä¹Ÿå‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªéšæœºæ•°å’Œè‡ªå·±çš„æ•°å­—è¯ä¹¦ã€‚å®¢æˆ·ç«¯æ”¶åˆ°åï¼Œé¦–å…ˆæ£€æŸ¥æ•°å­—è¯ä¹¦æ˜¯å¦æœ‰æ•ˆï¼Œå¦‚æœæœ‰æ•ˆï¼Œåˆ™å†ç”Ÿæˆä¸€ä¸ªéšæœºæ•°ï¼Œå¹¶ä½¿ç”¨è¯ä¹¦ä¸­çš„å…¬é’¥å¯¹éšæœºæ•°åŠ å¯†ï¼Œç„¶åå‘é€ç»™æœåŠ¡å™¨ç«¯ï¼Œå¹¶ä¸”è¿˜ä¼šæä¾›ä¸€ä¸ªå‰é¢æ‰€æœ‰å†…å®¹çš„ hash å€¼ä¾›æœåŠ¡å™¨ç«¯æ£€éªŒã€‚æœåŠ¡å™¨ç«¯æ¥æ”¶åï¼Œä½¿ç”¨è‡ªå·±çš„ç§é’¥å¯¹æ•°æ®è§£å¯†ï¼ŒåŒæ—¶å‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªå‰é¢æ‰€æœ‰å†…å®¹çš„ hash å€¼ä¾›å®¢æˆ·ç«¯æ£€éªŒã€‚è¿™ä¸ªæ—¶å€™åŒæ–¹éƒ½æœ‰äº†ä¸‰ä¸ªéšæœºæ•°ï¼ŒæŒ‰ç…§ä¹‹å‰æ‰€çº¦å®šçš„åŠ å¯†æ–¹æ³•ï¼Œä½¿ç”¨è¿™ä¸‰ä¸ªéšæœºæ•°ç”Ÿæˆä¸€æŠŠç§˜é’¥ï¼Œä»¥ååŒæ–¹é€šä¿¡å‰ï¼Œå°±ä½¿ç”¨è¿™ä¸ªç§˜é’¥å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†åå†ä¼ è¾“ã€‚</p><p>ï¼ˆ7ï¼‰<strong>è¿”å›æ•°æ®ï¼š</strong> å½“é¡µé¢è¯·æ±‚å‘é€åˆ°æœåŠ¡å™¨ç«¯åï¼ŒæœåŠ¡å™¨ç«¯ä¼šè¿”å›ä¸€ä¸ª html æ–‡ä»¶ä½œä¸ºå“åº”ï¼Œæµè§ˆå™¨æ¥æ”¶åˆ°å“åº”åï¼Œå¼€å§‹å¯¹ html æ–‡ä»¶è¿›è¡Œè§£æï¼Œå¼€å§‹é¡µé¢çš„æ¸²æŸ“è¿‡ç¨‹ã€‚</p><p>ï¼ˆ8ï¼‰<strong>é¡µé¢æ¸²æŸ“ï¼š</strong> æµè§ˆå™¨é¦–å…ˆä¼šæ ¹æ® html æ–‡ä»¶æ„å»º DOM æ ‘ï¼Œæ ¹æ®è§£æåˆ°çš„ css æ–‡ä»¶æ„å»º CSSOM æ ‘ï¼Œå¦‚æœé‡åˆ° script æ ‡ç­¾ï¼Œåˆ™åˆ¤ç«¯æ˜¯å¦å«æœ‰ defer æˆ–è€… async å±æ€§ï¼Œè¦ä¸ç„¶ script çš„åŠ è½½å’Œæ‰§è¡Œä¼šé€ æˆé¡µé¢çš„æ¸²æŸ“çš„é˜»å¡ã€‚å½“ DOM æ ‘å’Œ CSSOM æ ‘å»ºç«‹å¥½åï¼Œæ ¹æ®å®ƒä»¬æ¥æ„å»ºæ¸²æŸ“æ ‘ã€‚æ¸²æŸ“æ ‘æ„å»ºå¥½åï¼Œä¼šæ ¹æ®æ¸²æŸ“æ ‘æ¥è¿›è¡Œå¸ƒå±€ã€‚å¸ƒå±€å®Œæˆåï¼Œæœ€åä½¿ç”¨æµè§ˆå™¨çš„ UI æ¥å£å¯¹é¡µé¢è¿›è¡Œç»˜åˆ¶ã€‚è¿™ä¸ªæ—¶å€™æ•´ä¸ªé¡µé¢å°±æ˜¾ç¤ºå‡ºæ¥äº†ã€‚</p><p> ï¼ˆ9ï¼‰<strong>TCPå››æ¬¡æŒ¥æ‰‹ï¼š</strong> æœ€åä¸€æ­¥æ˜¯ TCP æ–­å¼€è¿æ¥çš„å››æ¬¡æŒ¥æ‰‹è¿‡ç¨‹ã€‚è‹¥å®¢æˆ·ç«¯è®¤ä¸ºæ•°æ®å‘é€å®Œæˆï¼Œåˆ™å®ƒéœ€è¦å‘æœåŠ¡ç«¯å‘é€è¿æ¥é‡Šæ”¾è¯·æ±‚ã€‚æœåŠ¡ç«¯æ”¶åˆ°è¿æ¥é‡Šæ”¾è¯·æ±‚åï¼Œä¼šå‘Šè¯‰åº”ç”¨å±‚è¦é‡Šæ”¾ TCP é“¾æ¥ã€‚ç„¶åä¼šå‘é€ ACK åŒ…ï¼Œå¹¶è¿›å…¥ CLOSE_WAIT çŠ¶æ€ï¼Œæ­¤æ—¶è¡¨æ˜å®¢æˆ·ç«¯åˆ°æœåŠ¡ç«¯çš„è¿æ¥å·²ç»é‡Šæ”¾ï¼Œä¸å†æ¥æ”¶å®¢æˆ·ç«¯å‘çš„æ•°æ®äº†ã€‚ä½†æ˜¯å› ä¸º TCP è¿æ¥æ˜¯åŒå‘çš„ï¼Œæ‰€ä»¥æœåŠ¡ç«¯ä»æ—§å¯ä»¥å‘é€æ•°æ®ç»™å®¢æˆ·ç«¯ã€‚æœåŠ¡ç«¯å¦‚æœæ­¤æ—¶è¿˜æœ‰æ²¡å‘å®Œçš„æ•°æ®ä¼šç»§ç»­å‘é€ï¼Œå®Œæ¯•åä¼šå‘å®¢æˆ·ç«¯å‘é€è¿æ¥é‡Šæ”¾è¯·æ±‚ï¼Œç„¶åæœåŠ¡ç«¯ä¾¿è¿›å…¥ LAST-ACK çŠ¶æ€ã€‚å®¢æˆ·ç«¯æ”¶åˆ°é‡Šæ”¾è¯·æ±‚åï¼Œå‘æœåŠ¡ç«¯å‘é€ç¡®è®¤åº”ç­”ï¼Œæ­¤æ—¶å®¢æˆ·ç«¯è¿›å…¥ TIME-WAIT çŠ¶æ€ã€‚è¯¥çŠ¶æ€ä¼šæŒç»­ 2MSLï¼ˆæœ€å¤§æ®µç”Ÿå­˜æœŸï¼ŒæŒ‡æŠ¥æ–‡æ®µåœ¨ç½‘ç»œä¸­ç”Ÿå­˜çš„æ—¶é—´ï¼Œè¶…æ—¶ä¼šè¢«æŠ›å¼ƒï¼‰ æ—¶é—´ï¼Œè‹¥è¯¥æ—¶é—´æ®µå†…æ²¡æœ‰æœåŠ¡ç«¯çš„é‡å‘è¯·æ±‚çš„è¯ï¼Œå°±è¿›å…¥ CLOSED çŠ¶æ€ã€‚å½“æœåŠ¡ç«¯æ”¶åˆ°ç¡®è®¤åº”ç­”åï¼Œä¹Ÿä¾¿è¿›å…¥ CLOSED çŠ¶æ€ã€‚</p><h3 id="12-å¯¹keep-aliveçš„ç†è§£"><a href="#12-å¯¹keep-aliveçš„ç†è§£" class="headerlink" title="12. å¯¹keep-aliveçš„ç†è§£"></a>12. å¯¹keep-aliveçš„ç†è§£</h3><p>HTTP1.0 ä¸­é»˜è®¤æ˜¯åœ¨æ¯æ¬¡è¯·æ±‚/åº”ç­”ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éƒ½è¦æ–°å»ºä¸€ä¸ªè¿æ¥ï¼Œå®Œæˆä¹‹åç«‹å³æ–­å¼€è¿æ¥ï¼Œè¿™å°±æ˜¯<strong>çŸ­è¿æ¥</strong>ã€‚å½“ä½¿ç”¨Keep-Aliveæ¨¡å¼æ—¶ï¼ŒKeep-AliveåŠŸèƒ½ä½¿å®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨ç«¯çš„è¿æ¥æŒç»­æœ‰æ•ˆï¼Œå½“å‡ºç°å¯¹æœåŠ¡å™¨çš„åç»§è¯·æ±‚æ—¶ï¼ŒKeep-AliveåŠŸèƒ½é¿å…äº†å»ºç«‹æˆ–è€…é‡æ–°å»ºç«‹è¿æ¥ï¼Œè¿™å°±æ˜¯<strong>é•¿è¿æ¥</strong>ã€‚å…¶ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p><ul><li>HTTP1.0ç‰ˆæœ¬æ˜¯é»˜è®¤æ²¡æœ‰Keep-aliveçš„ï¼ˆä¹Ÿå°±æ˜¯é»˜è®¤ä¼šå‘é€keep-aliveï¼‰ï¼Œæ‰€ä»¥è¦æƒ³è¿æ¥å¾—åˆ°ä¿æŒï¼Œå¿…é¡»æ‰‹åŠ¨é…ç½®å‘é€<code>Connection: keep-alive</code>å­—æ®µã€‚è‹¥æƒ³æ–­å¼€keep-aliveè¿æ¥ï¼Œéœ€å‘é€<code>Connection:close</code>å­—æ®µï¼›</li><li>HTTP1.1è§„å®šäº†é»˜è®¤ä¿æŒé•¿è¿æ¥ï¼Œæ•°æ®ä¼ è¾“å®Œæˆäº†ä¿æŒTCPè¿æ¥ä¸æ–­å¼€ï¼Œç­‰å¾…åœ¨åŒåŸŸåä¸‹ç»§ç»­ç”¨è¿™ä¸ªé€šé“ä¼ è¾“æ•°æ®ã€‚å¦‚æœéœ€è¦å…³é—­ï¼Œéœ€è¦å®¢æˆ·ç«¯å‘é€<code>Connectionï¼šclose</code>é¦–éƒ¨å­—æ®µã€‚</li></ul><p>Keep-Aliveçš„<strong>å»ºç«‹è¿‡ç¨‹</strong>ï¼š</p><ul><li>å®¢æˆ·ç«¯å‘æœåŠ¡å™¨åœ¨å‘é€è¯·æ±‚æŠ¥æ–‡åŒæ—¶åœ¨é¦–éƒ¨æ·»åŠ å‘é€Connectionå­—æ®µ</li><li>æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚å¹¶å¤„ç† Connectionå­—æ®µ</li><li>æœåŠ¡å™¨å›é€Connection:Keep-Aliveå­—æ®µç»™å®¢æˆ·ç«¯</li><li>å®¢æˆ·ç«¯æ¥æ”¶åˆ°Connectionå­—æ®µ</li><li>Keep-Aliveè¿æ¥å»ºç«‹æˆåŠŸ</li></ul><p><strong>æœåŠ¡ç«¯è‡ªåŠ¨æ–­å¼€è¿‡ç¨‹ï¼ˆä¹Ÿå°±æ˜¯æ²¡æœ‰keep-aliveï¼‰</strong>ï¼š</p><ul><li>å®¢æˆ·ç«¯å‘æœåŠ¡å™¨åªæ˜¯å‘é€å†…å®¹æŠ¥æ–‡ï¼ˆä¸åŒ…å«Connectionå­—æ®µï¼‰</li><li>æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚å¹¶å¤„ç†</li><li>æœåŠ¡å™¨è¿”å›å®¢æˆ·ç«¯è¯·æ±‚çš„èµ„æºå¹¶å…³é—­è¿æ¥</li><li>å®¢æˆ·ç«¯æ¥æ”¶èµ„æºï¼Œå‘ç°æ²¡æœ‰Connectionå­—æ®µï¼Œæ–­å¼€è¿æ¥</li></ul><p><strong>å®¢æˆ·ç«¯è¯·æ±‚æ–­å¼€è¿æ¥è¿‡ç¨‹</strong>ï¼š</p><ul><li>å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€Connection:closeå­—æ®µ</li><li>æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚å¹¶å¤„ç†connectionå­—æ®µ</li><li>æœåŠ¡å™¨å›é€å“åº”èµ„æºå¹¶æ–­å¼€è¿æ¥</li><li>å®¢æˆ·ç«¯æ¥æ”¶èµ„æºå¹¶æ–­å¼€è¿æ¥</li></ul><p>å¼€å¯Keep-Aliveçš„<strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>è¾ƒå°‘çš„CPUå’Œå†…å­˜çš„ä½¿â½¤ï¼ˆç”±äºåŒæ—¶æ‰“å¼€çš„è¿æ¥çš„å‡å°‘äº†ï¼‰ï¼›</li><li>å…è®¸è¯·æ±‚å’Œåº”ç­”çš„HTTPç®¡çº¿åŒ–ï¼› </li><li>é™ä½æ‹¥å¡æ§åˆ¶ ï¼ˆTCPè¿æ¥å‡å°‘äº†ï¼‰ï¼› </li><li>å‡å°‘äº†åç»­è¯·æ±‚çš„å»¶è¿Ÿï¼ˆâ½†éœ€å†è¿›â¾æ¡â¼¿ï¼‰ï¼› </li><li>æŠ¥å‘Šé”™è¯¯â½†éœ€å…³é—­TCPè¿ï¼›</li></ul><p>å¼€å¯Keep-Aliveçš„<strong>ç¼ºç‚¹</strong>ï¼š</p><ul><li>é•¿æ—¶é—´çš„Tcpè¿æ¥å®¹æ˜“å¯¼è‡´ç³»ç»Ÿèµ„æºæ— æ•ˆå ç”¨ï¼Œæµªè´¹ç³»ç»Ÿèµ„æºã€‚</li></ul><h3 id="13-é¡µé¢æœ‰å¤šå¼ å›¾ç‰‡ï¼ŒHTTPæ˜¯æ€æ ·çš„åŠ è½½è¡¨ç°ï¼Ÿ"><a href="#13-é¡µé¢æœ‰å¤šå¼ å›¾ç‰‡ï¼ŒHTTPæ˜¯æ€æ ·çš„åŠ è½½è¡¨ç°ï¼Ÿ" class="headerlink" title="13. é¡µé¢æœ‰å¤šå¼ å›¾ç‰‡ï¼ŒHTTPæ˜¯æ€æ ·çš„åŠ è½½è¡¨ç°ï¼Ÿ"></a>13. é¡µé¢æœ‰å¤šå¼ å›¾ç‰‡ï¼ŒHTTPæ˜¯æ€æ ·çš„åŠ è½½è¡¨ç°ï¼Ÿ</h3><ul><li>åœ¨<code>HTTP 1</code>ä¸‹ï¼Œæµè§ˆå™¨å¯¹ä¸€ä¸ªåŸŸåä¸‹æœ€å¤§TCPè¿æ¥æ•°ä¸º6ï¼Œæ‰€ä»¥ä¼šè¯·æ±‚å¤šæ¬¡ã€‚å¯ä»¥ç”¨<strong>å¤šåŸŸåéƒ¨ç½²</strong>è§£å†³ã€‚è¿™æ ·å¯ä»¥æé«˜åŒæ—¶è¯·æ±‚çš„æ•°ç›®ï¼ŒåŠ å¿«é¡µé¢å›¾ç‰‡çš„è·å–é€Ÿåº¦ã€‚</li><li>åœ¨<code>HTTP 2</code>ä¸‹ï¼Œå¯ä»¥ä¸€ç¬é—´åŠ è½½å‡ºæ¥å¾ˆå¤šèµ„æºï¼Œå› ä¸ºï¼ŒHTTP2æ”¯æŒå¤šè·¯å¤ç”¨ï¼Œå¯ä»¥åœ¨ä¸€ä¸ªTCPè¿æ¥ä¸­å‘é€å¤šä¸ªHTTPè¯·æ±‚ã€‚</li></ul><h3 id="14-HTTP2çš„å¤´éƒ¨å‹ç¼©ç®—æ³•æ˜¯æ€æ ·çš„ï¼Ÿ"><a href="#14-HTTP2çš„å¤´éƒ¨å‹ç¼©ç®—æ³•æ˜¯æ€æ ·çš„ï¼Ÿ" class="headerlink" title="14. HTTP2çš„å¤´éƒ¨å‹ç¼©ç®—æ³•æ˜¯æ€æ ·çš„ï¼Ÿ"></a>14. HTTP2çš„å¤´éƒ¨å‹ç¼©ç®—æ³•æ˜¯æ€æ ·çš„ï¼Ÿ</h3><p>HTTP2çš„å¤´éƒ¨å‹ç¼©æ˜¯HPACKç®—æ³•ã€‚åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¸¤ç«¯å»ºç«‹â€œå­—å…¸â€ï¼Œç”¨ç´¢å¼•å·è¡¨ç¤ºé‡å¤çš„å­—ç¬¦ä¸²ï¼Œé‡‡ç”¨å“ˆå¤«æ›¼ç¼–ç æ¥å‹ç¼©æ•´æ•°å’Œå­—ç¬¦ä¸²ï¼Œå¯ä»¥è¾¾åˆ°50%~90%çš„é«˜å‹ç¼©ç‡ã€‚</p><p>å…·ä½“æ¥è¯´:</p><ul><li>åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ä½¿ç”¨â€œé¦–éƒ¨è¡¨â€æ¥è·Ÿè¸ªå’Œå­˜å‚¨ä¹‹å‰å‘é€çš„é”®å€¼å¯¹ï¼Œå¯¹äºç›¸åŒçš„æ•°æ®ï¼Œä¸å†é€šè¿‡æ¯æ¬¡è¯·æ±‚å’Œå“åº”å‘é€ï¼›</li><li>é¦–éƒ¨è¡¨åœ¨HTTP/2çš„è¿æ¥å­˜ç»­æœŸå†…å§‹ç»ˆå­˜åœ¨ï¼Œç”±å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å…±åŒæ¸è¿›åœ°æ›´æ–°ï¼›</li><li>æ¯ä¸ªæ–°çš„é¦–éƒ¨é”®å€¼å¯¹è¦ä¹ˆè¢«è¿½åŠ åˆ°å½“å‰è¡¨çš„æœ«å°¾ï¼Œè¦ä¹ˆæ›¿æ¢è¡¨ä¸­ä¹‹å‰çš„å€¼ã€‚</li></ul><p>ä¾‹å¦‚ä¸‹å›¾ä¸­çš„ä¸¤ä¸ªè¯·æ±‚ï¼Œ è¯·æ±‚ä¸€å‘é€äº†æ‰€æœ‰çš„å¤´éƒ¨å­—æ®µï¼Œç¬¬äºŒä¸ªè¯·æ±‚åˆ™åªéœ€è¦å‘é€å·®å¼‚æ•°æ®ï¼Œè¿™æ ·å¯ä»¥å‡å°‘å†—ä½™æ•°æ®ï¼Œé™ä½å¼€é”€ã€‚<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/network/2.png" alt=""></p><h3 id="15-HTTPè¯·æ±‚æŠ¥æ–‡çš„æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ"><a href="#15-HTTPè¯·æ±‚æŠ¥æ–‡çš„æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ" class="headerlink" title="15. HTTPè¯·æ±‚æŠ¥æ–‡çš„æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ"></a>15. HTTPè¯·æ±‚æŠ¥æ–‡çš„æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ</h3><p>è¯·æ±‚æŠ¥â½‚æœ‰4éƒ¨åˆ†ç»„æˆ: </p><ul><li>è¯·æ±‚â¾ </li><li>è¯·æ±‚å¤´éƒ¨ </li><li>ç©ºâ¾</li><li>è¯·æ±‚ä½“ </li></ul><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/network/3.png" alt="image.png"><br><strong>å…¶ä¸­ï¼š</strong><br>ï¼ˆ1ï¼‰è¯·æ±‚â¾åŒ…æ‹¬ï¼šè¯·æ±‚â½…æ³•å­—æ®µã€URLå­—æ®µã€HTTPåè®®ç‰ˆæœ¬å­—æ®µã€‚å®ƒä»¬â½¤ç©ºæ ¼åˆ†éš”ã€‚ä¾‹å¦‚ï¼ŒGET /index.html HTTP/1.1ã€‚<br>ï¼ˆ2ï¼‰è¯·æ±‚å¤´éƒ¨:è¯·æ±‚å¤´éƒ¨ç”±å…³é”®å­—/å€¼å¯¹ç»„æˆï¼Œæ¯â¾â¼€å¯¹ï¼Œå…³é”®å­—å’Œå€¼â½¤è‹±â½‚å†’å·â€œ:â€åˆ†éš”  </p><ul><li>User-Agentï¼šäº§â½£è¯·æ±‚çš„æµè§ˆå™¨ç±»å‹ã€‚ </li><li>Acceptï¼šå®¢æˆ·ç«¯å¯è¯†åˆ«çš„å†…å®¹ç±»å‹åˆ—è¡¨ã€‚ </li><li>Hostï¼šè¯·æ±‚çš„ä¸»æœºåï¼Œå…è®¸å¤šä¸ªåŸŸååŒå¤„â¼€ä¸ªIPåœ°å€ï¼Œå³è™šæ‹Ÿä¸»æœºã€‚ </li></ul><p>ï¼ˆ3ï¼‰è¯·æ±‚ä½“: post putç­‰è¯·æ±‚æºå¸¦çš„æ•°æ®<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/network/4.png" alt="image.png"></p><h3 id="16-HTTPå“åº”æŠ¥æ–‡çš„æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ"><a href="#16-HTTPå“åº”æŠ¥æ–‡çš„æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ" class="headerlink" title="16. HTTPå“åº”æŠ¥æ–‡çš„æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ"></a>16. HTTPå“åº”æŠ¥æ–‡çš„æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ</h3><p>è¯·æ±‚æŠ¥â½‚æœ‰4éƒ¨åˆ†ç»„æˆ: </p><ul><li>å“åº”â¾ </li><li>å“åº”å¤´ </li><li>ç©ºâ¾</li><li>å“åº”ä½“ </li></ul><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/network/5.png" alt="image.png"></p><ul><li>å“åº”â¾ï¼šç”±ç½‘ç»œåè®®ç‰ˆæœ¬ï¼ŒçŠ¶æ€ç å’ŒçŠ¶æ€ç çš„åŸå› çŸ­è¯­ç»„æˆï¼Œä¾‹å¦‚ HTTP/1.1 200 OK ã€‚ </li><li>å“åº”å¤´ï¼šå“åº”éƒ¨â¾¸ç»„æˆ </li><li>å“åº”ä½“ï¼šæœåŠ¡å™¨å“åº”çš„æ•°æ® </li></ul><h3 id="17-HTTPåè®®çš„ä¼˜ç‚¹å’Œç¼ºç‚¹"><a href="#17-HTTPåè®®çš„ä¼˜ç‚¹å’Œç¼ºç‚¹" class="headerlink" title="17. HTTPåè®®çš„ä¼˜ç‚¹å’Œç¼ºç‚¹"></a>17. HTTPåè®®çš„ä¼˜ç‚¹å’Œç¼ºç‚¹</h3><p>HTTP æ˜¯è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œå®ƒå®šä¹‰äº†å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´äº¤æ¢æŠ¥æ–‡çš„æ ¼å¼å’Œæ–¹å¼ï¼Œé»˜è®¤ä½¿ç”¨ 80 ç«¯å£ã€‚å®ƒä½¿ç”¨ TCP ä½œä¸ºä¼ è¾“å±‚åè®®ï¼Œä¿è¯äº†æ•°æ®ä¼ è¾“çš„å¯é æ€§ã€‚</p><p>HTTPåè®®å…·æœ‰ä»¥ä¸‹<strong>ä¼˜ç‚¹</strong>ï¼š</p><ul><li>æ”¯æŒå®¢æˆ·ç«¯/æœåŠ¡å™¨æ¨¡å¼</li><li><strong>ç®€å•å¿«é€Ÿ</strong>ï¼šå®¢æˆ·å‘æœåŠ¡å™¨è¯·æ±‚æœåŠ¡æ—¶ï¼Œåªéœ€ä¼ é€è¯·æ±‚æ–¹æ³•å’Œè·¯å¾„ã€‚ç”±äº HTTP åè®®ç®€å•ï¼Œä½¿å¾— HTTP æœåŠ¡å™¨çš„ç¨‹åºè§„æ¨¡å°ï¼Œå› è€Œé€šä¿¡é€Ÿåº¦å¾ˆå¿«ã€‚</li><li><strong>æ— è¿æ¥</strong>ï¼šæ— è¿æ¥å°±æ˜¯é™åˆ¶æ¯æ¬¡è¿æ¥åªå¤„ç†ä¸€ä¸ªè¯·æ±‚ã€‚æœåŠ¡å™¨å¤„ç†å®Œå®¢æˆ·çš„è¯·æ±‚ï¼Œå¹¶æ”¶åˆ°å®¢æˆ·çš„åº”ç­”åï¼Œå³æ–­å¼€è¿æ¥ï¼Œé‡‡ç”¨è¿™ç§æ–¹å¼å¯ä»¥èŠ‚çœä¼ è¾“æ—¶é—´ã€‚</li><li><strong>æ— çŠ¶æ€</strong>ï¼šHTTP åè®®æ˜¯æ— çŠ¶æ€åè®®ï¼Œè¿™é‡Œçš„çŠ¶æ€æ˜¯æŒ‡é€šä¿¡è¿‡ç¨‹çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚ç¼ºå°‘çŠ¶æ€æ„å‘³ç€å¦‚æœåç»­å¤„ç†éœ€è¦å‰é¢çš„ä¿¡æ¯ï¼Œåˆ™å®ƒå¿…é¡»é‡ä¼ ï¼Œè¿™æ ·å¯èƒ½ä¼šå¯¼è‡´æ¯æ¬¡è¿æ¥ä¼ é€çš„æ•°æ®é‡å¢å¤§ã€‚å¦ä¸€æ–¹é¢ï¼Œåœ¨æœåŠ¡å™¨ä¸éœ€è¦å…ˆå‰ä¿¡æ¯æ—¶å®ƒçš„åº”ç­”å°±æ¯”è¾ƒå¿«ã€‚</li><li><strong>çµæ´»</strong>ï¼šHTTP å…è®¸ä¼ è¾“ä»»æ„ç±»å‹çš„æ•°æ®å¯¹è±¡ã€‚æ­£åœ¨ä¼ è¾“çš„ç±»å‹ç”± Content-Type åŠ ä»¥æ ‡è®°ã€‚</li></ul><p>HTTPåè®®å…·æœ‰ä»¥ä¸‹<strong>ç¼ºç‚¹</strong>ï¼š</p><ul><li><strong>æ— çŠ¶æ€ï¼š</strong> HTTP æ˜¯ä¸€ä¸ªæ— çŠ¶æ€çš„åè®®ï¼ŒHTTP æœåŠ¡å™¨ä¸ä¼šä¿å­˜å…³äºå®¢æˆ·çš„ä»»ä½•ä¿¡æ¯ã€‚</li><li><strong>æ˜æ–‡ä¼ è¾“ï¼š</strong> åè®®ä¸­çš„æŠ¥æ–‡ä½¿ç”¨çš„æ˜¯æ–‡æœ¬å½¢å¼ï¼Œè¿™å°±ç›´æ¥æš´éœ²ç»™å¤–ç•Œï¼Œä¸å®‰å…¨ã€‚</li><li><strong>ä¸å®‰å…¨</strong></li></ul><p>ï¼ˆ1ï¼‰é€šä¿¡ä½¿ç”¨æ˜æ–‡ï¼ˆä¸åŠ å¯†ï¼‰ï¼Œå†…å®¹å¯èƒ½ä¼šè¢«çªƒå¬ï¼›<br>ï¼ˆ2ï¼‰ä¸éªŒè¯é€šä¿¡æ–¹çš„èº«ä»½ï¼Œå› æ­¤æœ‰å¯èƒ½é­é‡ä¼ªè£…ï¼›<br>ï¼ˆ3ï¼‰æ— æ³•è¯æ˜æŠ¥æ–‡çš„å®Œæ•´æ€§ï¼Œæ‰€ä»¥æœ‰å¯èƒ½å·²é­ç¯¡æ”¹ï¼›</p><h3 id="18-è¯´ä¸€ä¸‹HTTP-3-0"><a href="#18-è¯´ä¸€ä¸‹HTTP-3-0" class="headerlink" title="18. è¯´ä¸€ä¸‹HTTP 3.0"></a>18. è¯´ä¸€ä¸‹HTTP 3.0</h3><p>HTTP/3åŸºäºUDPåè®®å®ç°äº†ç±»ä¼¼äºTCPçš„å¤šè·¯å¤ç”¨æ•°æ®æµã€ä¼ è¾“å¯é æ€§ç­‰åŠŸèƒ½ï¼Œè¿™å¥—åŠŸèƒ½è¢«ç§°ä¸ºQUICåè®®ã€‚<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/network/6.webp" alt=""></p><ol><li>æµé‡æ§åˆ¶ã€ä¼ è¾“å¯é æ€§åŠŸèƒ½ï¼šQUICåœ¨UDPçš„åŸºç¡€ä¸Šå¢åŠ äº†ä¸€å±‚æ¥ä¿è¯æ•°æ®ä¼ è¾“å¯é æ€§ï¼Œå®ƒæä¾›äº†æ•°æ®åŒ…é‡ä¼ ã€æ‹¥å¡æ§åˆ¶ã€ä»¥åŠå…¶ä»–ä¸€äº›TCPä¸­çš„ç‰¹æ€§ã€‚</li><li>é›†æˆTLSåŠ å¯†åŠŸèƒ½ï¼šç›®å‰QUICä½¿ç”¨TLS1.3ï¼Œå‡å°‘äº†æ¡æ‰‹æ‰€èŠ±è´¹çš„RTTæ•°ã€‚</li><li>å¤šè·¯å¤ç”¨ï¼šåŒä¸€ç‰©ç†è¿æ¥ä¸Šå¯ä»¥æœ‰å¤šä¸ªç‹¬ç«‹çš„é€»è¾‘æ•°æ®æµï¼Œå®ç°äº†æ•°æ®æµçš„å•ç‹¬ä¼ è¾“ï¼Œè§£å†³äº†TCPçš„é˜Ÿå¤´é˜»å¡é—®é¢˜ã€‚</li></ol><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/network/7.webp" alt=""></p><ol start="4"><li>å¿«é€Ÿæ¡æ‰‹ï¼šç”±äºåŸºäºUDPï¼Œå¯ä»¥å®ç°ä½¿ç”¨0 ~ 1ä¸ªRTTæ¥å»ºç«‹è¿æ¥ã€‚</li></ol><h3 id="19-HTTPåè®®çš„æ€§èƒ½æ€ä¹ˆæ ·"><a href="#19-HTTPåè®®çš„æ€§èƒ½æ€ä¹ˆæ ·" class="headerlink" title="19. HTTPåè®®çš„æ€§èƒ½æ€ä¹ˆæ ·"></a>19. HTTPåè®®çš„æ€§èƒ½æ€ä¹ˆæ ·</h3><p>HTTP åè®®æ˜¯åŸºäº TCP/IPï¼Œå¹¶ä¸”ä½¿ç”¨äº†<strong>è¯·æ±‚-åº”ç­”</strong>çš„é€šä¿¡æ¨¡å¼ï¼Œæ‰€ä»¥æ€§èƒ½çš„å…³é”®å°±åœ¨è¿™ä¸¤ç‚¹é‡Œã€‚</p><ul><li><strong>é•¿è¿æ¥</strong></li></ul><p>HTTPåè®®æœ‰ä¸¤ç§è¿æ¥æ¨¡å¼ï¼Œä¸€ç§æ˜¯æŒç»­è¿æ¥ï¼Œä¸€ç§éæŒç»­è¿æ¥ã€‚<br>ï¼ˆ1ï¼‰éæŒç»­è¿æ¥æŒ‡çš„æ˜¯æœåŠ¡å™¨å¿…é¡»ä¸ºæ¯ä¸€ä¸ªè¯·æ±‚çš„å¯¹è±¡å»ºç«‹å’Œç»´æŠ¤ä¸€ä¸ªå…¨æ–°çš„è¿æ¥ã€‚<br>ï¼ˆ2ï¼‰æŒç»­è¿æ¥ä¸‹ï¼ŒTCP è¿æ¥é»˜è®¤ä¸å…³é—­ï¼Œå¯ä»¥è¢«å¤šä¸ªè¯·æ±‚å¤ç”¨ã€‚é‡‡ç”¨æŒç»­è¿æ¥çš„å¥½å¤„æ˜¯å¯ä»¥é¿å…æ¯æ¬¡å»ºç«‹ TCP è¿æ¥ä¸‰æ¬¡æ¡æ‰‹æ—¶æ‰€èŠ±è´¹çš„æ—¶é—´ã€‚</p><p>å¯¹äºä¸åŒç‰ˆæœ¬çš„é‡‡ç”¨ä¸åŒçš„è¿æ¥æ–¹å¼ï¼š</p><ul><li>åœ¨HTTP/1.0 æ¯å‘èµ·ä¸€ä¸ªè¯·æ±‚ï¼Œéƒ½è¦æ–°å»ºä¸€æ¬¡ TCP è¿æ¥ï¼ˆä¸‰æ¬¡æ¡æ‰‹ï¼‰ï¼Œè€Œä¸”æ˜¯ä¸²è¡Œè¯·æ±‚ï¼Œåšäº†æ— ç•çš„ TCP è¿æ¥å»ºç«‹å’Œæ–­å¼€ï¼Œå¢åŠ äº†é€šä¿¡å¼€é”€ã€‚è¯¥ç‰ˆæœ¬ä½¿ç”¨çš„éæŒç»­çš„è¿æ¥ï¼Œä½†æ˜¯å¯ä»¥åœ¨è¯·æ±‚æ—¶ï¼ŒåŠ ä¸Š Connection: keep-a live æ¥è¦æ±‚æœåŠ¡å™¨ä¸è¦å…³é—­ TCP è¿æ¥ã€‚</li><li>åœ¨HTTP/1.1 æå‡ºäº†<strong>é•¿è¿æ¥</strong>çš„é€šä¿¡æ–¹å¼ï¼Œä¹Ÿå«æŒä¹…è¿æ¥ã€‚è¿™ç§æ–¹å¼çš„å¥½å¤„åœ¨äºå‡å°‘äº† TCP è¿æ¥çš„é‡å¤å»ºç«‹å’Œæ–­å¼€æ‰€é€ æˆçš„é¢å¤–å¼€é”€ï¼Œå‡è½»äº†æœåŠ¡å™¨ç«¯çš„è´Ÿè½½ã€‚è¯¥ç‰ˆæœ¬åŠä»¥åç‰ˆæœ¬é»˜è®¤é‡‡ç”¨çš„æ˜¯æŒç»­çš„è¿æ¥ã€‚ç›®å‰å¯¹äºåŒä¸€ä¸ªåŸŸï¼Œå¤§å¤šæ•°æµè§ˆå™¨æ”¯æŒåŒæ—¶å»ºç«‹ 6 ä¸ªæŒä¹…è¿æ¥ã€‚</li></ul><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/network/8.png" alt=""></p><ul><li><strong>ç®¡é“ç½‘ç»œä¼ è¾“</strong></li></ul><p>HTTP/1.1 é‡‡ç”¨äº†é•¿è¿æ¥çš„æ–¹å¼ï¼Œè¿™ä½¿å¾—ç®¡é“ï¼ˆpipelineï¼‰ç½‘ç»œä¼ è¾“æˆä¸ºäº†å¯èƒ½ã€‚</p><p>ç®¡é“ï¼ˆpipelineï¼‰ç½‘ç»œä¼ è¾“æ˜¯æŒ‡ï¼šå¯ä»¥åœ¨åŒä¸€ä¸ª TCP è¿æ¥é‡Œé¢ï¼Œå®¢æˆ·ç«¯å¯ä»¥å‘èµ·å¤šä¸ªè¯·æ±‚ï¼Œåªè¦ç¬¬ä¸€ä¸ªè¯·æ±‚å‘å‡ºå»äº†ï¼Œä¸å¿…ç­‰å…¶å›æ¥ï¼Œå°±å¯ä»¥å‘ç¬¬äºŒä¸ªè¯·æ±‚å‡ºå»ï¼Œå¯ä»¥å‡å°‘æ•´ä½“çš„å“åº”æ—¶é—´ã€‚ä½†æ˜¯æœåŠ¡å™¨è¿˜æ˜¯æŒ‰ç…§é¡ºåºå›åº”è¯·æ±‚ã€‚å¦‚æœå‰é¢çš„å›åº”ç‰¹åˆ«æ…¢ï¼Œåé¢å°±ä¼šæœ‰è®¸å¤šè¯·æ±‚æ’é˜Ÿç­‰ç€ã€‚è¿™ç§°ä¸ºé˜Ÿå¤´å µå¡ã€‚</p><ul><li><strong>é˜Ÿå¤´å µå¡</strong></li></ul><p>HTTP ä¼ è¾“çš„æŠ¥æ–‡å¿…é¡»æ˜¯ä¸€å‘ä¸€æ”¶ï¼Œä½†æ˜¯ï¼Œé‡Œé¢çš„ä»»åŠ¡è¢«æ”¾åœ¨ä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—ä¸­ä¸²è¡Œæ‰§è¡Œï¼Œä¸€æ—¦é˜Ÿé¦–çš„è¯·æ±‚å¤„ç†å¤ªæ…¢ï¼Œå°±ä¼šé˜»å¡åé¢è¯·æ±‚çš„å¤„ç†ã€‚è¿™å°±æ˜¯HTTPé˜Ÿå¤´é˜»å¡é—®é¢˜ã€‚</p><p><strong>é˜Ÿå¤´é˜»å¡çš„è§£å†³æ–¹æ¡ˆï¼š</strong><br>ï¼ˆ1ï¼‰å¹¶å‘è¿æ¥ï¼šå¯¹äºä¸€ä¸ªåŸŸåå…è®¸åˆ†é…å¤šä¸ªé•¿è¿æ¥ï¼Œé‚£ä¹ˆç›¸å½“äºå¢åŠ äº†ä»»åŠ¡é˜Ÿåˆ—ï¼Œä¸è‡³äºä¸€ä¸ªé˜Ÿä¼çš„ä»»åŠ¡é˜»å¡å…¶å®ƒæ‰€æœ‰ä»»åŠ¡ã€‚<br>ï¼ˆ2ï¼‰åŸŸååˆ†ç‰‡ï¼šå°†åŸŸååˆ†å‡ºå¾ˆå¤šäºŒçº§åŸŸåï¼Œå®ƒä»¬éƒ½æŒ‡å‘åŒæ ·çš„ä¸€å°æœåŠ¡å™¨ï¼Œèƒ½å¤Ÿå¹¶å‘çš„é•¿è¿æ¥æ•°å˜å¤šï¼Œè§£å†³äº†é˜Ÿå¤´é˜»å¡çš„é—®é¢˜ã€‚</p><h3 id="20-URLæœ‰å“ªäº›ç»„æˆéƒ¨åˆ†"><a href="#20-URLæœ‰å“ªäº›ç»„æˆéƒ¨åˆ†" class="headerlink" title="20. URLæœ‰å“ªäº›ç»„æˆéƒ¨åˆ†"></a>20. URLæœ‰å“ªäº›ç»„æˆéƒ¨åˆ†</h3><p>ä»¥ä¸‹é¢çš„URLä¸ºä¾‹ï¼š<strong><a href="http://www.aspxfans.com:8080/news/index.asp?boardID=5&amp;ID=24618&amp;page=1#name">http://www.aspxfans.com:8080/news/index.asp?boardID=5&amp;ID=24618&amp;page=1#name</a></strong></p><p>ä»ä¸Šé¢çš„URLå¯ä»¥çœ‹å‡ºï¼Œä¸€ä¸ªå®Œæ•´çš„URLåŒ…æ‹¬ä»¥ä¸‹å‡ éƒ¨åˆ†ï¼š</p><ul><li><strong>åè®®éƒ¨åˆ†</strong>ï¼šè¯¥URLçš„åè®®éƒ¨åˆ†ä¸ºâ€œhttpï¼šâ€ï¼Œè¿™ä»£è¡¨ç½‘é¡µä½¿ç”¨çš„æ˜¯HTTPåè®®ã€‚åœ¨Internetä¸­å¯ä»¥ä½¿ç”¨å¤šç§åè®®ï¼Œå¦‚HTTPï¼ŒFTPç­‰ç­‰æœ¬ä¾‹ä¸­ä½¿ç”¨çš„æ˜¯HTTPåè®®ã€‚åœ¨â€HTTPâ€åé¢çš„â€œ//â€ä¸ºåˆ†éš”ç¬¦ï¼›</li><li><strong>åŸŸåéƒ¨åˆ†</strong>ï¼šè¯¥URLçš„åŸŸåéƒ¨åˆ†ä¸ºâ€œ<a href="http://www.aspxfans.comâ€ã€‚ä¸€ä¸ªURLä¸­ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨IPåœ°å€ä½œä¸ºåŸŸåä½¿ç”¨">www.aspxfans.comâ€ã€‚ä¸€ä¸ªURLä¸­ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨IPåœ°å€ä½œä¸ºåŸŸåä½¿ç”¨</a></li><li><strong>ç«¯å£éƒ¨åˆ†</strong>ï¼šè·Ÿåœ¨åŸŸååé¢çš„æ˜¯ç«¯å£ï¼ŒåŸŸåå’Œç«¯å£ä¹‹é—´ä½¿ç”¨â€œ:â€ä½œä¸ºåˆ†éš”ç¬¦ã€‚ç«¯å£ä¸æ˜¯ä¸€ä¸ªURLå¿…é¡»çš„éƒ¨åˆ†ï¼Œå¦‚æœçœç•¥ç«¯å£éƒ¨åˆ†ï¼Œå°†é‡‡ç”¨é»˜è®¤ç«¯å£ï¼ˆHTTPåè®®é»˜è®¤ç«¯å£æ˜¯80ï¼ŒHTTPSåè®®é»˜è®¤ç«¯å£æ˜¯443ï¼‰ï¼›</li><li><strong>è™šæ‹Ÿç›®å½•éƒ¨åˆ†</strong>ï¼šä»åŸŸååçš„ç¬¬ä¸€ä¸ªâ€œ/â€å¼€å§‹åˆ°æœ€åä¸€ä¸ªâ€œ/â€ä¸ºæ­¢ï¼Œæ˜¯è™šæ‹Ÿç›®å½•éƒ¨åˆ†ã€‚è™šæ‹Ÿç›®å½•ä¹Ÿä¸æ˜¯ä¸€ä¸ªURLå¿…é¡»çš„éƒ¨åˆ†ã€‚æœ¬ä¾‹ä¸­çš„è™šæ‹Ÿç›®å½•æ˜¯â€œ/news/â€ï¼›</li><li><strong>æ–‡ä»¶åéƒ¨åˆ†</strong>ï¼šä»åŸŸååçš„æœ€åä¸€ä¸ªâ€œ/â€å¼€å§‹åˆ°â€œï¼Ÿâ€ä¸ºæ­¢ï¼Œæ˜¯æ–‡ä»¶åéƒ¨åˆ†ï¼Œå¦‚æœæ²¡æœ‰â€œ?â€,åˆ™æ˜¯ä»åŸŸååçš„æœ€åä¸€ä¸ªâ€œ/â€å¼€å§‹åˆ°â€œ#â€ä¸ºæ­¢ï¼Œæ˜¯æ–‡ä»¶éƒ¨åˆ†ï¼Œå¦‚æœæ²¡æœ‰â€œï¼Ÿâ€å’Œâ€œ#â€ï¼Œé‚£ä¹ˆä»åŸŸååçš„æœ€åä¸€ä¸ªâ€œ/â€å¼€å§‹åˆ°ç»“æŸï¼Œéƒ½æ˜¯æ–‡ä»¶åéƒ¨åˆ†ã€‚æœ¬ä¾‹ä¸­çš„æ–‡ä»¶åæ˜¯â€œindex.aspâ€ã€‚æ–‡ä»¶åéƒ¨åˆ†ä¹Ÿä¸æ˜¯ä¸€ä¸ªURLå¿…é¡»çš„éƒ¨åˆ†ï¼Œå¦‚æœçœç•¥è¯¥éƒ¨åˆ†ï¼Œåˆ™ä½¿ç”¨é»˜è®¤çš„æ–‡ä»¶åï¼›</li><li><strong>é”šéƒ¨åˆ†</strong>ï¼šä»â€œ#â€å¼€å§‹åˆ°æœ€åï¼Œéƒ½æ˜¯é”šéƒ¨åˆ†ã€‚æœ¬ä¾‹ä¸­çš„é”šéƒ¨åˆ†æ˜¯â€œnameâ€ã€‚é”šéƒ¨åˆ†ä¹Ÿä¸æ˜¯ä¸€ä¸ªURLå¿…é¡»çš„éƒ¨åˆ†ï¼›</li><li><strong>å‚æ•°éƒ¨åˆ†</strong>ï¼šä»â€œï¼Ÿâ€å¼€å§‹åˆ°â€œ#â€ä¸ºæ­¢ä¹‹é—´çš„éƒ¨åˆ†ä¸ºå‚æ•°éƒ¨åˆ†ï¼Œåˆç§°æœç´¢éƒ¨åˆ†ã€æŸ¥è¯¢éƒ¨åˆ†ã€‚æœ¬ä¾‹ä¸­çš„å‚æ•°éƒ¨åˆ†ä¸ºâ€œboardID=5&amp;ID=24618&amp;page=1â€ã€‚å‚æ•°å¯ä»¥å…è®¸æœ‰å¤šä¸ªå‚æ•°ï¼Œå‚æ•°ä¸å‚æ•°ä¹‹é—´ç”¨â€œ&amp;â€ä½œä¸ºåˆ†éš”ç¬¦ã€‚</li></ul><h3 id="21-ä¸ç¼“å­˜ç›¸å…³çš„HTTPè¯·æ±‚å¤´æœ‰å“ªäº›"><a href="#21-ä¸ç¼“å­˜ç›¸å…³çš„HTTPè¯·æ±‚å¤´æœ‰å“ªäº›" class="headerlink" title="21. ä¸ç¼“å­˜ç›¸å…³çš„HTTPè¯·æ±‚å¤´æœ‰å“ªäº›"></a>21. ä¸ç¼“å­˜ç›¸å…³çš„HTTPè¯·æ±‚å¤´æœ‰å“ªäº›</h3><p>å¼ºç¼“å­˜ï¼š</p><ul><li>Expires</li><li>Cache-Control</li></ul><p>åå•†ç¼“å­˜ï¼š</p><ul><li>Etagã€If-None-Match</li><li>Last-Modifiedã€If-Modified-Since</li></ul><h2 id="äºŒã€HTTPSåè®®"><a href="#äºŒã€HTTPSåè®®" class="headerlink" title="äºŒã€HTTPSåè®®"></a>äºŒã€HTTPSåè®®</h2><h3 id="1-ä»€ä¹ˆæ˜¯HTTPSåè®®ï¼Ÿ"><a href="#1-ä»€ä¹ˆæ˜¯HTTPSåè®®ï¼Ÿ" class="headerlink" title="1. ä»€ä¹ˆæ˜¯HTTPSåè®®ï¼Ÿ"></a>1. ä»€ä¹ˆæ˜¯HTTPSåè®®ï¼Ÿ</h3><p>è¶…æ–‡æœ¬ä¼ è¾“å®‰å…¨åè®®ï¼ˆHypertext Transfer Protocol Secureï¼Œç®€ç§°ï¼šHTTPSï¼‰æ˜¯ä¸€ç§é€šè¿‡è®¡ç®—æœºç½‘ç»œè¿›è¡Œå®‰å…¨é€šä¿¡çš„ä¼ è¾“åè®®ã€‚HTTPSç»ç”±HTTPè¿›è¡Œé€šä¿¡ï¼Œåˆ©ç”¨SSL/TLSæ¥åŠ å¯†æ•°æ®åŒ…ã€‚HTTPSçš„ä¸»è¦ç›®çš„æ˜¯æä¾›å¯¹ç½‘ç«™æœåŠ¡å™¨çš„èº«ä»½è®¤è¯ï¼Œä¿æŠ¤äº¤æ¢æ•°æ®çš„éšç§ä¸å®Œæ•´æ€§ã€‚<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/network/9.png" alt=""><br>HTTPåè®®é‡‡ç”¨<strong>æ˜æ–‡ä¼ è¾“</strong>ä¿¡æ¯ï¼Œå­˜åœ¨<strong>ä¿¡æ¯çªƒå¬</strong>ã€<strong>ä¿¡æ¯ç¯¡æ”¹</strong>å’Œ<strong>ä¿¡æ¯åŠ«æŒ</strong>çš„é£é™©ï¼Œè€Œåè®®TLS/SSLå…·æœ‰<strong>èº«ä»½éªŒè¯</strong>ã€<strong>ä¿¡æ¯åŠ å¯†</strong>å’Œ<strong>å®Œæ•´æ€§æ ¡éªŒ</strong>çš„åŠŸèƒ½ï¼Œå¯ä»¥é¿å…æ­¤ç±»é—®é¢˜å‘ç”Ÿã€‚</p><p>å®‰å…¨å±‚çš„ä¸»è¦èŒè´£å°±æ˜¯<strong>å¯¹å‘èµ·çš„HTTPè¯·æ±‚çš„æ•°æ®è¿›è¡ŒåŠ å¯†æ“ä½œ</strong> å’Œ <strong>å¯¹æ¥æ”¶åˆ°çš„HTTPçš„å†…å®¹è¿›è¡Œè§£å¯†æ“ä½œ</strong>ã€‚</p><h3 id="2-TLS-SSLçš„å·¥ä½œåŸç†"><a href="#2-TLS-SSLçš„å·¥ä½œåŸç†" class="headerlink" title="2. TLS/SSLçš„å·¥ä½œåŸç†"></a>2. TLS/SSLçš„å·¥ä½œåŸç†</h3><p><strong>TLS/SSL</strong>å…¨ç§°<strong>å®‰å…¨ä¼ è¾“å±‚åè®®</strong>ï¼ˆTransport Layer Securityï¼‰, æ˜¯ä»‹äºTCPå’ŒHTTPä¹‹é—´çš„ä¸€å±‚å®‰å…¨åè®®ï¼Œä¸å½±å“åŸæœ‰çš„TCPåè®®å’ŒHTTPåè®®ï¼Œæ‰€ä»¥ä½¿ç”¨HTTPSåŸºæœ¬ä¸Šä¸éœ€è¦å¯¹HTTPé¡µé¢è¿›è¡Œå¤ªå¤šçš„æ”¹é€ ã€‚</p><p>TLS/SSLçš„åŠŸèƒ½å®ç°ä¸»è¦ä¾èµ–ä¸‰ç±»åŸºæœ¬ç®—æ³•ï¼š<strong>æ•£åˆ—å‡½æ•°hash</strong>ã€<strong>å¯¹ç§°åŠ å¯†</strong>ã€<strong>éå¯¹ç§°åŠ å¯†</strong>ã€‚è¿™ä¸‰ç±»ç®—æ³•çš„ä½œç”¨å¦‚ä¸‹ï¼š</p><ul><li>åŸºäºæ•£åˆ—å‡½æ•°éªŒè¯ä¿¡æ¯çš„å®Œæ•´æ€§</li><li>å¯¹ç§°åŠ å¯†ç®—æ³•é‡‡ç”¨åå•†çš„ç§˜é’¥å¯¹æ•°æ®åŠ å¯†</li><li>éå¯¹ç§°åŠ å¯†å®ç°èº«ä»½è®¤è¯å’Œç§˜é’¥åå•†</li></ul><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/network/10.png" alt=""></p><h4 id="ï¼ˆ1ï¼‰æ•£åˆ—å‡½æ•°hash"><a href="#ï¼ˆ1ï¼‰æ•£åˆ—å‡½æ•°hash" class="headerlink" title="ï¼ˆ1ï¼‰æ•£åˆ—å‡½æ•°hash"></a>ï¼ˆ1ï¼‰æ•£åˆ—å‡½æ•°hash</h4><p>å¸¸è§çš„æ•£åˆ—å‡½æ•°æœ‰MD5ã€SHA1ã€SHA256ã€‚è¯¥å‡½æ•°çš„ç‰¹ç‚¹æ˜¯å•å‘ä¸å¯é€†ï¼Œå¯¹è¾“å…¥æ•°æ®éå¸¸æ•æ„Ÿï¼Œè¾“å‡ºçš„é•¿åº¦å›ºå®šï¼Œä»»ä½•æ•°æ®çš„ä¿®æ”¹éƒ½ä¼šæ”¹å˜æ•£åˆ—å‡½æ•°çš„ç»“æœï¼Œå¯ä»¥ç”¨äºé˜²æ­¢ä¿¡æ¯ç¯¡æ”¹å¹¶éªŒè¯æ•°æ®çš„å®Œæ•´æ€§ã€‚</p><p><strong>ç‰¹ç‚¹ï¼š</strong> åœ¨ä¿¡æ¯ä¼ è¾“è¿‡ç¨‹ä¸­ï¼Œæ•£åˆ—å‡½æ•°ä¸èƒ½ä¸‰éƒ½å®ç°ä¿¡æ¯é˜²ç¯¡æ”¹ï¼Œç”±äºä¼ è¾“æ˜¯æ˜æ–‡ä¼ è¾“ï¼Œä¸­é—´äººå¯ä»¥ä¿®æ”¹ä¿¡æ¯åé‡æ–°è®¡ç®—ä¿¡æ¯çš„æ‘˜è¦ï¼Œæ‰€ä»¥éœ€è¦å¯¹ä¼ è¾“çš„ä¿¡æ¯å’Œä¿¡æ¯æ‘˜è¦è¿›è¡ŒåŠ å¯†ã€‚</p><h4 id="ï¼ˆ2ï¼‰å¯¹ç§°åŠ å¯†"><a href="#ï¼ˆ2ï¼‰å¯¹ç§°åŠ å¯†" class="headerlink" title="ï¼ˆ2ï¼‰å¯¹ç§°åŠ å¯†"></a>ï¼ˆ2ï¼‰å¯¹ç§°åŠ å¯†</h4><p>å¯¹ç§°åŠ å¯†çš„æ–¹æ³•æ˜¯ï¼ŒåŒæ–¹ä½¿ç”¨åŒä¸€ä¸ªç§˜é’¥å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†å’Œè§£å¯†ã€‚ä½†æ˜¯å¯¹ç§°åŠ å¯†çš„å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å¦‚ä½•ä¿è¯ç§˜é’¥ä¼ è¾“çš„å®‰å…¨æ€§ï¼Œå› ä¸ºç§˜é’¥è¿˜æ˜¯ä¼šé€šè¿‡ç½‘ç»œä¼ è¾“çš„ï¼Œä¸€æ—¦ç§˜é’¥è¢«å…¶ä»–äººè·å–åˆ°ï¼Œé‚£ä¹ˆæ•´ä¸ªåŠ å¯†è¿‡ç¨‹å°±æ¯«æ— ä½œç”¨äº†ã€‚ è¿™å°±è¦ç”¨åˆ°éå¯¹ç§°åŠ å¯†çš„æ–¹æ³•ã€‚</p><p>å¸¸è§çš„å¯¹ç§°åŠ å¯†ç®—æ³•æœ‰AES-CBCã€DESã€3DESã€AES-GCMç­‰ã€‚ç›¸åŒçš„ç§˜é’¥å¯ä»¥ç”¨äºä¿¡æ¯çš„åŠ å¯†å’Œè§£å¯†ã€‚æŒæ¡ç§˜é’¥æ‰èƒ½è·å–ä¿¡æ¯ï¼Œé˜²æ­¢ä¿¡æ¯çªƒå¬ï¼Œå…¶é€šè®¯æ–¹å¼æ˜¯ä¸€å¯¹ä¸€ã€‚</p><p><strong>ç‰¹ç‚¹ï¼š</strong> å¯¹ç§°åŠ å¯†çš„ä¼˜åŠ¿å°±æ˜¯ä¿¡æ¯ä¼ è¾“ä½¿ç”¨ä¸€å¯¹ä¸€ï¼Œéœ€è¦å…±äº«ç›¸åŒçš„å¯†ç ï¼Œå¯†ç çš„å®‰å…¨æ˜¯ä¿è¯ä¿¡æ¯å®‰å…¨çš„åŸºç¡€ï¼ŒæœåŠ¡å™¨å’ŒNä¸ªå®¢æˆ·ç«¯é€šä¿¡ï¼Œéœ€è¦ç»´æŒNä¸ªå¯†ç è®°å½•ä¸”ä¸èƒ½ä¿®æ”¹å¯†ç ã€‚</p><h4 id="ï¼ˆ3ï¼‰éå¯¹ç§°åŠ å¯†"><a href="#ï¼ˆ3ï¼‰éå¯¹ç§°åŠ å¯†" class="headerlink" title="ï¼ˆ3ï¼‰éå¯¹ç§°åŠ å¯†"></a>ï¼ˆ3ï¼‰éå¯¹ç§°åŠ å¯†</h4><p>éå¯¹ç§°åŠ å¯†çš„æ–¹æ³•æ˜¯ï¼Œæˆ‘ä»¬æ‹¥æœ‰ä¸¤ä¸ªç§˜é’¥ï¼Œä¸€ä¸ªæ˜¯å…¬é’¥ï¼Œä¸€ä¸ªæ˜¯ç§é’¥ã€‚å…¬é’¥æ˜¯å…¬å¼€çš„ï¼Œç§é’¥æ˜¯ä¿å¯†çš„ã€‚ç”¨ç§é’¥åŠ å¯†çš„æ•°æ®ï¼Œåªæœ‰å¯¹åº”çš„å…¬é’¥æ‰èƒ½è§£å¯†ï¼Œç”¨å…¬é’¥åŠ å¯†çš„æ•°æ®ï¼Œåªæœ‰å¯¹åº”çš„ç§é’¥æ‰èƒ½è§£å¯†ã€‚æˆ‘ä»¬å¯ä»¥å°†å…¬é’¥å…¬å¸ƒå‡ºå»ï¼Œä»»ä½•æƒ³å’Œæˆ‘ä»¬é€šä¿¡çš„å®¢æˆ·ï¼Œ éƒ½å¯ä»¥ä½¿ç”¨æˆ‘ä»¬æä¾›çš„å…¬é’¥å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ç§é’¥è¿›è¡Œè§£å¯†ï¼Œè¿™æ ·å°±èƒ½ä¿è¯æ•°æ®çš„å®‰å…¨äº†ã€‚ä½†æ˜¯éå¯¹ç§°åŠ å¯†æœ‰ä¸€ä¸ªç¼ºç‚¹å°±æ˜¯åŠ å¯†çš„è¿‡ç¨‹å¾ˆæ…¢ï¼Œå› æ­¤å¦‚æœæ¯æ¬¡é€šä¿¡éƒ½ä½¿ç”¨éå¯¹ç§°åŠ å¯†çš„æ–¹å¼çš„è¯ï¼Œåè€Œä¼šé€ æˆç­‰å¾…æ—¶é—´è¿‡é•¿çš„é—®é¢˜ã€‚</p><p>å¸¸è§çš„éå¯¹ç§°åŠ å¯†ç®—æ³•æœ‰RSAã€ECCã€DHç­‰ã€‚ç§˜é’¥æˆå¯¹å‡ºç°ï¼Œä¸€èˆ¬ç§°ä¸ºå…¬é’¥ï¼ˆå…¬å¼€ï¼‰å’Œç§é’¥ï¼ˆä¿å¯†ï¼‰ã€‚å…¬é’¥åŠ å¯†çš„ä¿¡æ¯åªæœ‰ç§é’¥å¯ä»¥è§£å¼€ï¼Œç§é’¥åŠ å¯†çš„ä¿¡æ¯åªèƒ½å…¬é’¥è§£å¼€ï¼Œå› æ­¤æŒæ¡å…¬é’¥çš„ä¸åŒå®¢æˆ·ç«¯ä¹‹é—´ä¸èƒ½ç›¸äº’è§£å¯†ä¿¡æ¯ï¼Œåªèƒ½å’ŒæœåŠ¡å™¨è¿›è¡ŒåŠ å¯†é€šä¿¡ï¼ŒæœåŠ¡å™¨å¯ä»¥å®ç°ä¸€å¯¹å¤šçš„çš„é€šä¿¡ï¼Œå®¢æˆ·ç«¯ä¹Ÿå¯ä»¥ç”¨æ¥éªŒè¯æŒæ¡ç§é’¥çš„æœåŠ¡å™¨çš„èº«ä»½ã€‚</p><p><strong>ç‰¹ç‚¹ï¼š</strong> éå¯¹ç§°åŠ å¯†çš„ç‰¹ç‚¹å°±æ˜¯ä¿¡æ¯ä¸€å¯¹å¤šï¼ŒæœåŠ¡å™¨åªéœ€è¦ç»´æŒä¸€ä¸ªç§é’¥å°±å¯ä»¥å’Œå¤šä¸ªå®¢æˆ·ç«¯è¿›è¡Œé€šä¿¡ï¼Œä½†æœåŠ¡å™¨å‘å‡ºçš„ä¿¡æ¯èƒ½å¤Ÿè¢«æ‰€æœ‰çš„å®¢æˆ·ç«¯è§£å¯†ï¼Œä¸”è¯¥ç®—æ³•çš„è®¡ç®—å¤æ‚ï¼ŒåŠ å¯†çš„é€Ÿåº¦æ…¢ã€‚</p><p>ç»¼åˆä¸Šè¿°ç®—æ³•ç‰¹ç‚¹ï¼ŒTLS/SSLçš„å·¥ä½œæ–¹å¼å°±æ˜¯å®¢æˆ·ç«¯ä½¿ç”¨éå¯¹ç§°åŠ å¯†ä¸æœåŠ¡å™¨è¿›è¡Œé€šä¿¡ï¼Œå®ç°èº«ä»½çš„éªŒè¯å¹¶åå•†å¯¹ç§°åŠ å¯†ä½¿ç”¨çš„ç§˜é’¥ã€‚å¯¹ç§°åŠ å¯†ç®—æ³•é‡‡ç”¨åå•†ç§˜é’¥å¯¹ä¿¡æ¯ä»¥åŠä¿¡æ¯æ‘˜è¦è¿›è¡ŒåŠ å¯†é€šä¿¡ï¼Œä¸åŒèŠ‚ç‚¹ä¹‹é—´é‡‡ç”¨çš„å¯¹ç§°ç§˜é’¥ä¸åŒï¼Œä»è€Œä¿è¯ä¿¡æ¯åªèƒ½é€šä¿¡åŒæ–¹è·å–ã€‚è¿™æ ·å°±è§£å†³äº†ä¸¤ä¸ªæ–¹æ³•å„è‡ªå­˜åœ¨çš„é—®é¢˜ã€‚</p><h3 id="3-æ•°å­—è¯ä¹¦æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#3-æ•°å­—è¯ä¹¦æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="3. æ•°å­—è¯ä¹¦æ˜¯ä»€ä¹ˆï¼Ÿ"></a>3. æ•°å­—è¯ä¹¦æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>ç°åœ¨çš„æ–¹æ³•ä¹Ÿä¸ä¸€å®šæ˜¯å®‰å…¨çš„ï¼Œå› ä¸ºæ²¡æœ‰åŠæ³•ç¡®å®šå¾—åˆ°çš„å…¬é’¥å°±ä¸€å®šæ˜¯å®‰å…¨çš„å…¬é’¥ã€‚å¯èƒ½å­˜åœ¨ä¸€ä¸ªä¸­é—´äººï¼Œæˆªå–äº†å¯¹æ–¹å‘ç»™æˆ‘ä»¬çš„å…¬é’¥ï¼Œç„¶åå°†ä»–è‡ªå·±çš„å…¬é’¥å‘é€ç»™æˆ‘ä»¬ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨ä»–çš„å…¬é’¥åŠ å¯†åå‘é€çš„ä¿¡æ¯ï¼Œå°±å¯ä»¥è¢«ä»–ç”¨è‡ªå·±çš„ç§é’¥è§£å¯†ã€‚ç„¶åä»–ä¼ªè£…æˆæˆ‘ä»¬ä»¥åŒæ ·çš„æ–¹æ³•å‘å¯¹æ–¹å‘é€ä¿¡æ¯ï¼Œè¿™æ ·æˆ‘ä»¬çš„ä¿¡æ¯å°±è¢«çªƒå–äº†ï¼Œç„¶è€Œè‡ªå·±è¿˜ä¸çŸ¥é“ã€‚ä¸ºäº†è§£å†³è¿™æ ·çš„é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨æ•°å­—è¯ä¹¦ã€‚</p><p>é¦–å…ˆä½¿ç”¨ä¸€ç§ Hash ç®—æ³•æ¥å¯¹å…¬é’¥å’Œå…¶ä»–ä¿¡æ¯è¿›è¡ŒåŠ å¯†ï¼Œç”Ÿæˆä¸€ä¸ªä¿¡æ¯æ‘˜è¦ï¼Œç„¶åè®©æœ‰å…¬ä¿¡åŠ›çš„è®¤è¯ä¸­å¿ƒï¼ˆç®€ç§° CA ï¼‰ç”¨å®ƒçš„ç§é’¥å¯¹æ¶ˆæ¯æ‘˜è¦åŠ å¯†ï¼Œå½¢æˆç­¾åã€‚æœ€åå°†åŸå§‹çš„ä¿¡æ¯å’Œç­¾ååˆåœ¨ä¸€èµ·ï¼Œç§°ä¸ºæ•°å­—è¯ä¹¦ã€‚å½“æ¥æ”¶æ–¹æ”¶åˆ°æ•°å­—è¯ä¹¦çš„æ—¶å€™ï¼Œå…ˆæ ¹æ®åŸå§‹ä¿¡æ¯ä½¿ç”¨åŒæ ·çš„ Hash ç®—æ³•ç”Ÿæˆä¸€ä¸ªæ‘˜è¦ï¼Œç„¶åä½¿ç”¨å…¬è¯å¤„çš„å…¬é’¥æ¥å¯¹æ•°å­—è¯ä¹¦ä¸­çš„æ‘˜è¦è¿›è¡Œè§£å¯†ï¼Œæœ€åå°†è§£å¯†çš„æ‘˜è¦å’Œç”Ÿæˆçš„æ‘˜è¦è¿›è¡Œå¯¹æ¯”ï¼Œå°±èƒ½å‘ç°å¾—åˆ°çš„ä¿¡æ¯æ˜¯å¦è¢«æ›´æ”¹äº†ã€‚</p><p>è¿™ä¸ªæ–¹æ³•æœ€è¦çš„æ˜¯è®¤è¯ä¸­å¿ƒçš„å¯é æ€§ï¼Œä¸€èˆ¬æµè§ˆå™¨é‡Œä¼šå†…ç½®ä¸€äº›é¡¶å±‚çš„è®¤è¯ä¸­å¿ƒçš„è¯ä¹¦ï¼Œç›¸å½“äºæˆ‘ä»¬è‡ªåŠ¨ä¿¡ä»»äº†ä»–ä»¬ï¼Œåªæœ‰è¿™æ ·æ‰èƒ½ä¿è¯æ•°æ®çš„å®‰å…¨ã€‚<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/network/11.png" alt=""></p><h3 id="4-HTTPSé€šä¿¡ï¼ˆæ¡æ‰‹ï¼‰è¿‡ç¨‹"><a href="#4-HTTPSé€šä¿¡ï¼ˆæ¡æ‰‹ï¼‰è¿‡ç¨‹" class="headerlink" title="4. HTTPSé€šä¿¡ï¼ˆæ¡æ‰‹ï¼‰è¿‡ç¨‹"></a>4. HTTPSé€šä¿¡ï¼ˆæ¡æ‰‹ï¼‰è¿‡ç¨‹</h3><p>HTTPSçš„é€šä¿¡è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ol><li>å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼Œè¯·æ±‚ä¸­åŒ…å«ä½¿ç”¨çš„åè®®ç‰ˆæœ¬å·ã€ç”Ÿæˆçš„ä¸€ä¸ªéšæœºæ•°ã€ä»¥åŠå®¢æˆ·ç«¯æ”¯æŒçš„åŠ å¯†æ–¹æ³•ã€‚</li><li>æœåŠ¡å™¨ç«¯æ¥æ”¶åˆ°è¯·æ±‚åï¼Œç¡®è®¤åŒæ–¹ä½¿ç”¨çš„åŠ å¯†æ–¹æ³•ã€å¹¶ç»™å‡ºæœåŠ¡å™¨çš„è¯ä¹¦ã€ä»¥åŠä¸€ä¸ªæœåŠ¡å™¨ç”Ÿæˆçš„éšæœºæ•°ã€‚</li><li>å®¢æˆ·ç«¯ç¡®è®¤æœåŠ¡å™¨è¯ä¹¦æœ‰æ•ˆåï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„éšæœºæ•°ï¼Œå¹¶ä½¿ç”¨æ•°å­—è¯ä¹¦ä¸­çš„å…¬é’¥ï¼ŒåŠ å¯†è¿™ä¸ªéšæœºæ•°ï¼Œç„¶åå‘ç»™æœ åŠ¡å™¨ã€‚å¹¶ä¸”è¿˜ä¼šæä¾›ä¸€ä¸ªå‰é¢æ‰€æœ‰å†…å®¹çš„ hash çš„å€¼ï¼Œç”¨æ¥ä¾›æœåŠ¡å™¨æ£€éªŒã€‚</li><li>æœåŠ¡å™¨ä½¿ç”¨è‡ªå·±çš„ç§é’¥ï¼Œæ¥è§£å¯†å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„éšæœºæ•°ã€‚å¹¶æä¾›å‰é¢æ‰€æœ‰å†…å®¹çš„ hash å€¼æ¥ä¾›å®¢æˆ·ç«¯æ£€éªŒã€‚</li><li>å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯æ ¹æ®çº¦å®šçš„åŠ å¯†æ–¹æ³•ä½¿ç”¨å‰é¢çš„ä¸‰ä¸ªéšæœºæ•°ï¼Œç”Ÿæˆå¯¹è¯ç§˜é’¥ï¼Œä»¥åçš„å¯¹è¯è¿‡ç¨‹éƒ½ä½¿ç”¨è¿™ä¸ªç§˜é’¥æ¥åŠ å¯†ä¿¡æ¯ã€‚</li></ol><h3 id="5-HTTPSçš„ç‰¹ç‚¹"><a href="#5-HTTPSçš„ç‰¹ç‚¹" class="headerlink" title="5. HTTPSçš„ç‰¹ç‚¹"></a>5. HTTPSçš„ç‰¹ç‚¹</h3><p>HTTPSçš„<strong>ä¼˜ç‚¹</strong>å¦‚ä¸‹ï¼š</p><ul><li>ä½¿ç”¨HTTPSåè®®å¯ä»¥è®¤è¯ç”¨æˆ·å’ŒæœåŠ¡å™¨ï¼Œç¡®ä¿æ•°æ®å‘é€åˆ°æ­£ç¡®çš„å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ï¼›</li><li>ä½¿ç”¨HTTPSåè®®å¯ä»¥è¿›è¡ŒåŠ å¯†ä¼ è¾“ã€èº«ä»½è®¤è¯ï¼Œé€šä¿¡æ›´åŠ å®‰å…¨ï¼Œé˜²æ­¢æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­è¢«çªƒå–ã€ä¿®æ”¹ï¼Œç¡®ä¿æ•°æ®å®‰å…¨æ€§ï¼›</li><li>HTTPSæ˜¯ç°è¡Œæ¶æ„ä¸‹æœ€å®‰å…¨çš„è§£å†³æ–¹æ¡ˆï¼Œè™½ç„¶ä¸æ˜¯ç»å¯¹çš„å®‰å…¨ï¼Œä½†æ˜¯å¤§å¹…å¢åŠ äº†ä¸­é—´äººæ”»å‡»çš„æˆæœ¬ï¼›</li></ul><p>HTTPSçš„<strong>ç¼ºç‚¹</strong>å¦‚ä¸‹ï¼š</p><ul><li>HTTPSéœ€è¦åšæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯åŒæ–¹çš„åŠ å¯†ä¸ªè§£å¯†å¤„ç†ï¼Œè€—è´¹æ›´å¤šæœåŠ¡å™¨èµ„æºï¼Œè¿‡ç¨‹å¤æ‚ï¼›</li><li>HTTPSåè®®æ¡æ‰‹é˜¶æ®µæ¯”è¾ƒè´¹æ—¶ï¼Œå¢åŠ é¡µé¢çš„åŠ è½½æ—¶é—´ï¼›</li><li>SSLè¯ä¹¦æ˜¯æ”¶è´¹çš„ï¼ŒåŠŸèƒ½è¶Šå¼ºå¤§çš„è¯ä¹¦è´¹ç”¨è¶Šé«˜ï¼›</li><li>HTTPSè¿æ¥æœåŠ¡å™¨ç«¯èµ„æºå ç”¨é«˜å¾ˆå¤šï¼Œæ”¯æŒè®¿å®¢ç¨å¤šçš„ç½‘ç«™éœ€è¦æŠ•å…¥æ›´å¤§çš„æˆæœ¬ï¼›</li><li>SSLè¯ä¹¦éœ€è¦ç»‘å®šIPï¼Œä¸èƒ½å†åŒä¸€ä¸ªIPä¸Šç»‘å®šå¤šä¸ªåŸŸåã€‚</li></ul><h3 id="6-HTTPSæ˜¯å¦‚ä½•ä¿è¯å®‰å…¨çš„ï¼Ÿ"><a href="#6-HTTPSæ˜¯å¦‚ä½•ä¿è¯å®‰å…¨çš„ï¼Ÿ" class="headerlink" title="6. HTTPSæ˜¯å¦‚ä½•ä¿è¯å®‰å…¨çš„ï¼Ÿ"></a>6. <strong>HTTPS</strong>æ˜¯å¦‚ä½•ä¿è¯å®‰å…¨çš„ï¼Ÿ</h3><p>å…ˆç†è§£ä¸¤ä¸ªæ¦‚å¿µï¼š</p><ul><li>å¯¹ç§°åŠ å¯†ï¼šå³é€šä¿¡çš„åŒâ½…éƒ½ä½¿â½¤åŒâ¼€ä¸ªç§˜é’¥è¿›â¾åŠ è§£å¯†ï¼Œå¯¹ç§°åŠ å¯†è™½ç„¶å¾ˆç®€å•æ€§èƒ½ä¹Ÿå¥½ï¼Œä½†æ˜¯â½†æ³•è§£å†³â¾¸æ¬¡æŠŠç§˜é’¥å‘ç»™å¯¹â½…çš„é—®é¢˜ï¼Œå¾ˆå®¹æ˜“è¢«â¿Šå®¢æ‹¦æˆªç§˜é’¥ã€‚ </li><li>â¾®å¯¹ç§°åŠ å¯†ï¼š </li></ul><ol><li>ç§é’¥ + å…¬é’¥= å¯†é’¥å¯¹ </li><li>å³â½¤ç§é’¥åŠ å¯†çš„æ•°æ®,åªæœ‰å¯¹åº”çš„å…¬é’¥æ‰èƒ½è§£å¯†,â½¤å…¬é’¥åŠ å¯†çš„æ•°æ®,åªæœ‰å¯¹åº”çš„ç§é’¥æ‰èƒ½è§£å¯† </li><li>å› ä¸ºé€šä¿¡åŒâ½…çš„â¼¿â¾¥éƒ½æœ‰â¼€å¥—â¾ƒâ¼°çš„å¯†é’¥å¯¹,é€šä¿¡ä¹‹å‰åŒâ½…ä¼šå…ˆæŠŠâ¾ƒâ¼°çš„å…¬é’¥éƒ½å…ˆå‘ç»™å¯¹â½… </li><li>ç„¶åå¯¹â½…å†æ‹¿ç€è¿™ä¸ªå…¬é’¥æ¥åŠ å¯†æ•°æ®å“åº”ç»™å¯¹â½…,ç­‰åˆ°åˆ°äº†å¯¹â½…é‚£â¾¥,å¯¹â½…å†â½¤â¾ƒâ¼°çš„ç§é’¥è¿›â¾è§£å¯† </li></ol><p>â¾®å¯¹ç§°åŠ å¯†è™½ç„¶å®‰å…¨æ€§æ›´â¾¼ï¼Œä½†æ˜¯å¸¦æ¥çš„é—®é¢˜å°±æ˜¯é€Ÿåº¦å¾ˆæ…¢ï¼Œå½±å“æ€§èƒ½ã€‚ </p><p><strong>è§£å†³â½…æ¡ˆï¼š</strong></p><p>ç»“åˆä¸¤ç§åŠ å¯†â½…å¼ï¼Œå°†å¯¹ç§°åŠ å¯†çš„å¯†é’¥ä½¿â½¤â¾®å¯¹ç§°åŠ å¯†çš„å…¬é’¥è¿›â¾åŠ å¯†ï¼Œç„¶åå‘é€å‡ºå»ï¼Œæ¥æ”¶â½…ä½¿â½¤ç§é’¥è¿›â¾è§£å¯†å¾—åˆ°å¯¹ç§°åŠ å¯†çš„å¯†é’¥ï¼Œç„¶ååŒâ½…å¯ä»¥ä½¿â½¤å¯¹ç§°åŠ å¯†æ¥è¿›â¾æ²Ÿé€šã€‚ </p><p>æ­¤æ—¶â¼œå¸¦æ¥â¼€ä¸ªé—®é¢˜ï¼Œä¸­é—´â¼ˆé—®é¢˜ï¼š<br>å¦‚æœæ­¤æ—¶åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´å­˜åœ¨â¼€ä¸ªä¸­é—´â¼ˆ,è¿™ä¸ªä¸­é—´â¼ˆåªéœ€è¦æŠŠåŸæœ¬åŒâ½…é€šä¿¡äº’å‘çš„å…¬é’¥,æ¢æˆâ¾ƒâ¼°çš„å…¬é’¥,è¿™æ ·ä¸­é—´â¼ˆå°±å¯ä»¥è½»æ¾è§£å¯†é€šä¿¡åŒâ½…æ‰€å‘é€çš„æ‰€æœ‰æ•°æ®ã€‚ </p><p>æ‰€ä»¥è¿™ä¸ªæ—¶å€™éœ€è¦â¼€ä¸ªå®‰å…¨çš„ç¬¬ä¸‰â½…é¢å‘è¯ä¹¦ï¼ˆCAï¼‰ï¼Œè¯æ˜èº«ä»½çš„èº«ä»½ï¼Œé˜²â½Œè¢«ä¸­é—´â¼ˆæ”»å‡»ã€‚ è¯ä¹¦ä¸­åŒ…æ‹¬ï¼šç­¾å‘è€…ã€è¯ä¹¦â½¤é€”ã€ä½¿â½¤è€…å…¬é’¥ã€ä½¿â½¤è€…ç§é’¥ã€ä½¿â½¤è€…çš„HASHç®—æ³•ã€è¯ä¹¦åˆ°æœŸæ—¶é—´ç­‰ã€‚</p><p>ä½†æ˜¯é—®é¢˜æ¥äº†ï¼Œå¦‚æœä¸­é—´â¼ˆç¯¡æ”¹äº†è¯ä¹¦ï¼Œé‚£ä¹ˆèº«ä»½è¯æ˜æ˜¯ä¸æ˜¯å°±â½†æ•ˆäº†ï¼Ÿè¿™ä¸ªè¯æ˜å°±â½©ä¹°äº†ï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦â¼€ä¸ªæ–°çš„æŠ€æœ¯ï¼Œæ•°å­—ç­¾åã€‚ </p><p>æ•°å­—ç­¾åå°±æ˜¯â½¤CAâ¾ƒå¸¦çš„HASHç®—æ³•å¯¹è¯ä¹¦çš„å†…å®¹è¿›â¾HASHå¾—åˆ°â¼€ä¸ªæ‘˜è¦ï¼Œå†â½¤CAçš„ç§é’¥åŠ å¯†ï¼Œæœ€ç»ˆç»„æˆæ•°å­—ç­¾åã€‚å½“åˆ«â¼ˆæŠŠä»–çš„è¯ä¹¦å‘è¿‡æ¥çš„æ—¶å€™,æˆ‘å†â½¤åŒæ ·çš„Hashç®—æ³•,å†æ¬¡â½£æˆæ¶ˆæ¯æ‘˜è¦ï¼Œç„¶åâ½¤CAçš„å…¬é’¥å¯¹æ•°å­—ç­¾åè§£å¯†,å¾—åˆ°CAåˆ›å»ºçš„æ¶ˆæ¯æ‘˜è¦,ä¸¤è€…â¼€â½,å°±çŸ¥é“ä¸­é—´æœ‰æ²¡æœ‰è¢«â¼ˆç¯¡æ”¹äº†ã€‚è¿™ä¸ªæ—¶å€™å°±èƒ½æœ€â¼¤ç¨‹åº¦ä¿è¯é€šä¿¡çš„å®‰å…¨äº†ã€‚ </p><h2 id="ä¸‰ã€HTTPçŠ¶æ€ç "><a href="#ä¸‰ã€HTTPçŠ¶æ€ç " class="headerlink" title="ä¸‰ã€HTTPçŠ¶æ€ç "></a>ä¸‰ã€HTTPçŠ¶æ€ç </h2><p>çŠ¶æ€ç çš„ç±»åˆ«ï¼š</p><table><thead><tr><th><strong>ç±»åˆ«</strong></th><th><strong>åŸå› </strong></th><th><strong>æè¿°</strong></th></tr></thead><tbody><tr><td>1xx</td><td>Informational(ä¿¡æ¯æ€§çŠ¶æ€ç )</td><td>æ¥å—çš„è¯·æ±‚æ­£åœ¨å¤„ç†</td></tr><tr><td>2xx</td><td>Success(æˆåŠŸçŠ¶æ€ç )</td><td>è¯·æ±‚æ­£å¸¸å¤„ç†å®Œæ¯•</td></tr><tr><td>3xx</td><td>Redirection(é‡å®šå‘çŠ¶æ€ç )</td><td>éœ€è¦è¿›è¡Œé™„åŠ æ“ä½œä¸€å®Œæˆè¯·æ±‚</td></tr><tr><td>4xx</td><td>Client Error (å®¢æˆ·ç«¯é”™è¯¯çŠ¶æ€ç )</td><td>æœåŠ¡å™¨æ— æ³•å¤„ç†è¯·æ±‚</td></tr><tr><td>5xx</td><td>Server Error(æœåŠ¡å™¨é”™è¯¯çŠ¶æ€ç )</td><td>æœåŠ¡å™¨å¤„ç†è¯·æ±‚å‡ºé”™</td></tr></tbody></table><h3 id="1-2XX-Success-æˆåŠŸçŠ¶æ€ç "><a href="#1-2XX-Success-æˆåŠŸçŠ¶æ€ç " class="headerlink" title="1. 2XX (Success æˆåŠŸçŠ¶æ€ç )"></a>1. 2XX (Success æˆåŠŸçŠ¶æ€ç )</h3><p>çŠ¶æ€ç 2XXè¡¨ç¤ºè¯·æ±‚è¢«æ­£å¸¸å¤„ç†äº†ã€‚</p><h4 id="ï¼ˆ1ï¼‰200-OK"><a href="#ï¼ˆ1ï¼‰200-OK" class="headerlink" title="ï¼ˆ1ï¼‰200 OK"></a>ï¼ˆ1ï¼‰200 OK</h4><p>200 OKè¡¨ç¤ºå®¢æˆ·ç«¯å‘æ¥çš„è¯·æ±‚è¢«æœåŠ¡å™¨ç«¯æ­£å¸¸å¤„ç†äº†ã€‚</p><h4 id="ï¼ˆ2ï¼‰204-No-Content"><a href="#ï¼ˆ2ï¼‰204-No-Content" class="headerlink" title="ï¼ˆ2ï¼‰204 No Content"></a>ï¼ˆ2ï¼‰204 No Content</h4><p>è¯¥çŠ¶æ€ç è¡¨ç¤ºå®¢æˆ·ç«¯å‘é€çš„è¯·æ±‚å·²ç»åœ¨æœåŠ¡å™¨ç«¯æ­£å¸¸å¤„ç†äº†ï¼Œä½†æ˜¯æ²¡æœ‰è¿”å›çš„å†…å®¹ï¼Œå“åº”æŠ¥æ–‡ä¸­ä¸åŒ…å«å®ä½“çš„ä¸»ä½“éƒ¨åˆ†ã€‚ä¸€èˆ¬åœ¨åªéœ€è¦ä»å®¢æˆ·ç«¯å¾€æœåŠ¡å™¨ç«¯å‘é€ä¿¡æ¯ï¼Œè€ŒæœåŠ¡å™¨ç«¯ä¸éœ€è¦å¾€å®¢æˆ·ç«¯å‘é€å†…å®¹æ—¶ä½¿ç”¨ã€‚</p><h4 id="ï¼ˆ3ï¼‰206-Partial-Content"><a href="#ï¼ˆ3ï¼‰206-Partial-Content" class="headerlink" title="ï¼ˆ3ï¼‰206 Partial Content"></a>ï¼ˆ3ï¼‰206 Partial Content</h4><p>è¯¥çŠ¶æ€ç è¡¨ç¤ºå®¢æˆ·ç«¯è¿›è¡Œäº†èŒƒå›´è¯·æ±‚ï¼Œè€ŒæœåŠ¡å™¨ç«¯æ‰§è¡Œäº†è¿™éƒ¨åˆ†çš„ GET è¯·æ±‚ã€‚å“åº”æŠ¥æ–‡ä¸­åŒ…å«ç”± Content-Range æŒ‡å®šèŒƒå›´çš„å®ä½“å†…å®¹ã€‚</p><h3 id="2-3XX-Redirection-é‡å®šå‘çŠ¶æ€ç "><a href="#2-3XX-Redirection-é‡å®šå‘çŠ¶æ€ç " class="headerlink" title="2. 3XX (Redirection é‡å®šå‘çŠ¶æ€ç )"></a>2. 3XX (Redirection é‡å®šå‘çŠ¶æ€ç )</h3><p>3XX å“åº”ç»“æœè¡¨æ˜æµè§ˆå™¨éœ€è¦æ‰§è¡ŒæŸäº›ç‰¹æ®Šçš„å¤„ç†ä»¥æ­£ç¡®å¤„ç†è¯·æ±‚ã€‚</p><h4 id="ï¼ˆ1ï¼‰301-Moved-Permanently"><a href="#ï¼ˆ1ï¼‰301-Moved-Permanently" class="headerlink" title="ï¼ˆ1ï¼‰301 Moved Permanently"></a>ï¼ˆ1ï¼‰301 Moved Permanently</h4><p><strong>æ°¸ä¹…é‡å®šå‘ã€‚</strong><br>è¯¥çŠ¶æ€ç è¡¨ç¤ºè¯·æ±‚çš„èµ„æºå·²ç»è¢«åˆ†é…äº†æ–°çš„ URIï¼Œä»¥ååº”ä½¿ç”¨èµ„æºæŒ‡å®šçš„ URIã€‚æ–°çš„ URI ä¼šåœ¨ HTTP å“åº”å¤´ä¸­çš„ Location é¦–éƒ¨å­—æ®µæŒ‡å®šã€‚è‹¥ç”¨æˆ·å·²ç»æŠŠåŸæ¥çš„URIä¿å­˜ä¸ºä¹¦ç­¾ï¼Œæ­¤æ—¶ä¼šæŒ‰ç…§ Location ä¸­æ–°çš„URIé‡æ–°ä¿å­˜è¯¥ä¹¦ç­¾ã€‚åŒæ—¶ï¼Œæœç´¢å¼•æ“åœ¨æŠ“å–æ–°å†…å®¹çš„åŒæ—¶ä¹Ÿå°†æ—§çš„ç½‘å€æ›¿æ¢ä¸ºé‡å®šå‘ä¹‹åçš„ç½‘å€ã€‚</p><p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p><ul><li>å½“æˆ‘ä»¬æƒ³æ¢ä¸ªåŸŸåï¼Œæ—§çš„åŸŸåä¸å†ä½¿ç”¨æ—¶ï¼Œç”¨æˆ·è®¿é—®æ—§åŸŸåæ—¶ç”¨301å°±é‡å®šå‘åˆ°æ–°çš„åŸŸåã€‚å…¶å®ä¹Ÿæ˜¯å‘Šè¯‰æœç´¢å¼•æ“æ”¶å½•çš„åŸŸåéœ€è¦å¯¹æ–°çš„åŸŸåè¿›è¡Œæ”¶å½•ã€‚</li><li>åœ¨æœç´¢å¼•æ“çš„æœç´¢ç»“æœä¸­å‡ºç°äº†ä¸å¸¦wwwçš„åŸŸåï¼Œè€Œå¸¦wwwçš„åŸŸåå´æ²¡æœ‰æ”¶å½•ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥ç”¨301é‡å®šå‘æ¥å‘Šè¯‰æœç´¢å¼•æ“æˆ‘ä»¬ç›®æ ‡çš„åŸŸåæ˜¯å“ªä¸€ä¸ªã€‚</li></ul><h4 id="ï¼ˆ2ï¼‰302-Found"><a href="#ï¼ˆ2ï¼‰302-Found" class="headerlink" title="ï¼ˆ2ï¼‰302 Found"></a>ï¼ˆ2ï¼‰302 Found</h4><p><strong>ä¸´æ—¶é‡å®šå‘ã€‚</strong><br>è¯¥çŠ¶æ€ç è¡¨ç¤ºè¯·æ±‚çš„èµ„æºè¢«åˆ†é…åˆ°äº†æ–°çš„ URIï¼Œå¸Œæœ›ç”¨æˆ·ï¼ˆæœ¬æ¬¡ï¼‰èƒ½ä½¿ç”¨æ–°çš„ URI è®¿é—®èµ„æºã€‚å’Œ 301 Moved Permanently çŠ¶æ€ç ç›¸ä¼¼ï¼Œä½†æ˜¯ 302 ä»£è¡¨çš„èµ„æºä¸æ˜¯è¢«æ°¸ä¹…é‡å®šå‘ï¼Œåªæ˜¯ä¸´æ—¶æ€§è´¨çš„ã€‚ä¹Ÿå°±æ˜¯è¯´å·²ç§»åŠ¨çš„èµ„æºå¯¹åº”çš„ URI å°†æ¥è¿˜æœ‰å¯èƒ½å‘ç”Ÿæ”¹å˜ã€‚è‹¥ç”¨æˆ·æŠŠ URI ä¿å­˜æˆä¹¦ç­¾ï¼Œä½†ä¸ä¼šåƒ 301 çŠ¶æ€ç å‡ºç°æ—¶é‚£æ ·å»æ›´æ–°ä¹¦ç­¾ï¼Œè€Œæ˜¯ä»æ—§ä¿ç•™è¿”å› 302 çŠ¶æ€ç çš„é¡µé¢å¯¹åº”çš„ URIã€‚åŒæ—¶ï¼Œæœç´¢å¼•æ“ä¼šæŠ“å–æ–°çš„å†…å®¹è€Œä¿ç•™æ—§çš„ç½‘å€ã€‚å› ä¸ºæœåŠ¡å™¨è¿”å›302ä»£ç ï¼Œæœç´¢å¼•æ“è®¤ä¸ºæ–°çš„ç½‘å€åªæ˜¯æš‚æ—¶çš„ã€‚</p><p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p><ul><li>å½“æˆ‘ä»¬åœ¨åšæ´»åŠ¨æ—¶ï¼Œç™»å½•åˆ°é¦–é¡µè‡ªåŠ¨é‡å®šå‘ï¼Œè¿›å…¥æ´»åŠ¨é¡µé¢ã€‚</li><li>æœªç™»é™†çš„ç”¨æˆ·è®¿é—®ç”¨æˆ·ä¸­å¿ƒé‡å®šå‘åˆ°ç™»å½•é¡µé¢ã€‚</li><li>è®¿é—®404é¡µé¢é‡æ–°å®šå‘åˆ°é¦–é¡µã€‚</li></ul><h4 id="ï¼ˆ3ï¼‰303-See-Other"><a href="#ï¼ˆ3ï¼‰303-See-Other" class="headerlink" title="ï¼ˆ3ï¼‰303 See Other"></a>ï¼ˆ3ï¼‰303 See Other</h4><p>è¯¥çŠ¶æ€ç è¡¨ç¤ºç”±äºè¯·æ±‚å¯¹åº”çš„èµ„æºå­˜åœ¨ç€å¦ä¸€ä¸ª URIï¼Œåº”ä½¿ç”¨ GET æ–¹æ³•å®šå‘è·å–è¯·æ±‚çš„èµ„æºã€‚<br>303 çŠ¶æ€ç å’Œ 302 Found çŠ¶æ€ç æœ‰ç€ç›¸ä¼¼çš„åŠŸèƒ½ï¼Œä½†æ˜¯ 303 çŠ¶æ€ç æ˜ç¡®è¡¨ç¤ºå®¢æˆ·ç«¯åº”å½“é‡‡ç”¨ GET æ–¹æ³•è·å–èµ„æºã€‚</p><p>303 çŠ¶æ€ç é€šå¸¸ä½œä¸º PUT æˆ– POST æ“ä½œçš„è¿”å›ç»“æœï¼Œå®ƒè¡¨ç¤ºé‡å®šå‘é“¾æ¥æŒ‡å‘çš„ä¸æ˜¯æ–°ä¸Šä¼ çš„èµ„æºï¼Œè€Œæ˜¯å¦å¤–ä¸€ä¸ªé¡µé¢ï¼Œæ¯”å¦‚æ¶ˆæ¯ç¡®è®¤é¡µé¢æˆ–ä¸Šä¼ è¿›åº¦é¡µé¢ã€‚è€Œè¯·æ±‚é‡å®šå‘é¡µé¢çš„æ–¹æ³•è¦æ€»æ˜¯ä½¿ç”¨ GETã€‚</p><p>æ³¨æ„ï¼š</p><ul><li>å½“ 301ã€302ã€303 å“åº”çŠ¶æ€ç è¿”å›æ—¶ï¼Œå‡ ä¹æ‰€æœ‰çš„æµè§ˆå™¨éƒ½ä¼šæŠŠ POST æ”¹æˆGETï¼Œå¹¶åˆ é™¤è¯·æ±‚æŠ¥æ–‡å†…çš„ä¸»ä½“ï¼Œä¹‹åè¯·æ±‚ä¼šå†æ¬¡è‡ªåŠ¨å‘é€ã€‚</li><li>301ã€302 æ ‡å‡†æ˜¯ç¦æ­¢å°† POST æ–¹æ³•å˜æˆ GETæ–¹æ³•çš„ï¼Œä½†å®é™…å¤§å®¶éƒ½ä¼šè¿™ä¹ˆåšã€‚</li></ul><h4 id="ï¼ˆ4ï¼‰304-Not-Modified"><a href="#ï¼ˆ4ï¼‰304-Not-Modified" class="headerlink" title="ï¼ˆ4ï¼‰304 Not Modified"></a>ï¼ˆ4ï¼‰304 Not Modified</h4><p><strong>æµè§ˆå™¨ç¼“å­˜ç›¸å…³ã€‚</strong><br>è¯¥çŠ¶æ€ç è¡¨ç¤ºå®¢æˆ·ç«¯å‘é€é™„å¸¦æ¡ä»¶çš„è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨ç«¯å…è®¸è¯·æ±‚è®¿é—®èµ„æºï¼Œä½†æœªæ»¡è¶³æ¡ä»¶çš„æƒ…å†µã€‚304 çŠ¶æ€ç è¿”å›æ—¶ï¼Œä¸åŒ…å«ä»»ä½•å“åº”çš„ä¸»ä½“éƒ¨åˆ†ã€‚304 è™½ç„¶è¢«åˆ’åˆ†åœ¨ 3XX ç±»åˆ«ä¸­ï¼Œä½†æ˜¯å’Œé‡å®šå‘æ²¡æœ‰å…³ç³»ã€‚</p><p>å¸¦æ¡ä»¶çš„è¯·æ±‚ï¼ˆHttp æ¡ä»¶è¯·æ±‚ï¼‰ï¼šä½¿ç”¨ Getæ–¹æ³• è¯·æ±‚ï¼Œè¯·æ±‚æŠ¥æ–‡ä¸­åŒ…å«ï¼ˆ<code>if-match</code>ã€<code>if-none-match</code>ã€<code>if-modified-since</code>ã€<code>if-unmodified-since</code>ã€<code>if-range</code>ï¼‰ä¸­ä»»æ„é¦–éƒ¨ã€‚</p><p>çŠ¶æ€ç 304å¹¶ä¸æ˜¯ä¸€ç§é”™è¯¯ï¼Œè€Œæ˜¯å‘Šè¯‰å®¢æˆ·ç«¯æœ‰ç¼“å­˜ï¼Œç›´æ¥ä½¿ç”¨ç¼“å­˜ä¸­çš„æ•°æ®ã€‚è¿”å›é¡µé¢çš„åªæœ‰å¤´éƒ¨ä¿¡æ¯ï¼Œæ˜¯æ²¡æœ‰å†…å®¹éƒ¨åˆ†çš„ï¼Œè¿™æ ·åœ¨ä¸€å®šç¨‹åº¦ä¸Šæé«˜äº†ç½‘é¡µçš„æ€§èƒ½ã€‚</p><h4 id="ï¼ˆ5ï¼‰307-Temporary-Redirect"><a href="#ï¼ˆ5ï¼‰307-Temporary-Redirect" class="headerlink" title="ï¼ˆ5ï¼‰307 Temporary Redirect"></a>ï¼ˆ5ï¼‰307 Temporary Redirect</h4><p><strong>307è¡¨ç¤ºä¸´æ—¶é‡å®šå‘ã€‚</strong> è¯¥çŠ¶æ€ç ä¸ 302 Found æœ‰ç€ç›¸åŒå«ä¹‰ï¼Œå°½ç®¡ 302 æ ‡å‡†ç¦æ­¢ POST å˜æˆ GETï¼Œä½†æ˜¯å®é™…ä½¿ç”¨æ—¶è¿˜æ˜¯è¿™æ ·åšäº†ã€‚</p><p>307 ä¼šéµå®ˆæµè§ˆå™¨æ ‡å‡†ï¼Œ<strong>ä¸ä¼šä» POST å˜æˆ GET</strong>ã€‚ä½†æ˜¯å¯¹äºå¤„ç†è¯·æ±‚çš„è¡Œä¸ºæ—¶ï¼Œä¸åŒæµè§ˆå™¨è¿˜æ˜¯ä¼šå‡ºç°ä¸åŒçš„æƒ…å†µã€‚è§„èŒƒè¦æ±‚æµè§ˆå™¨ç»§ç»­å‘ Location çš„åœ°å€ POST å†…å®¹ã€‚è§„èŒƒè¦æ±‚æµè§ˆå™¨ç»§ç»­å‘ Location çš„åœ°å€ POST å†…å®¹ã€‚</p><h3 id="3-4XX-Client-Error-å®¢æˆ·ç«¯é”™è¯¯çŠ¶æ€ç "><a href="#3-4XX-Client-Error-å®¢æˆ·ç«¯é”™è¯¯çŠ¶æ€ç " class="headerlink" title="3. 4XX (Client Error å®¢æˆ·ç«¯é”™è¯¯çŠ¶æ€ç )"></a>3. 4XX (Client Error å®¢æˆ·ç«¯é”™è¯¯çŠ¶æ€ç )</h3><p>4XX çš„å“åº”ç»“æœè¡¨æ˜å®¢æˆ·ç«¯æ˜¯å‘ç”Ÿé”™è¯¯çš„åŸå› æ‰€åœ¨ã€‚</p><h4 id="ï¼ˆ1ï¼‰400-Bad-Request"><a href="#ï¼ˆ1ï¼‰400-Bad-Request" class="headerlink" title="ï¼ˆ1ï¼‰400 Bad Request"></a>ï¼ˆ1ï¼‰400 Bad Request</h4><p>è¯¥çŠ¶æ€ç è¡¨ç¤ºè¯·æ±‚æŠ¥æ–‡ä¸­å­˜åœ¨è¯­æ³•é”™è¯¯ã€‚å½“é”™è¯¯å‘ç”Ÿæ—¶ï¼Œéœ€ä¿®æ”¹è¯·æ±‚çš„å†…å®¹åå†æ¬¡å‘é€è¯·æ±‚ã€‚å¦å¤–ï¼Œæµè§ˆå™¨ä¼šåƒ 200 OK ä¸€æ ·å¯¹å¾…è¯¥çŠ¶æ€ç ã€‚</p><h4 id="ï¼ˆ2ï¼‰401-Unauthorized"><a href="#ï¼ˆ2ï¼‰401-Unauthorized" class="headerlink" title="ï¼ˆ2ï¼‰401 Unauthorized"></a>ï¼ˆ2ï¼‰401 Unauthorized</h4><p>è¯¥çŠ¶æ€ç è¡¨ç¤ºå‘é€çš„è¯·æ±‚éœ€è¦æœ‰é€šè¿‡ HTTP è®¤è¯(BASIC è®¤è¯ã€DIGEST è®¤è¯)çš„è®¤è¯ä¿¡æ¯ã€‚è‹¥ä¹‹å‰å·²è¿›è¡Œè¿‡ä¸€æ¬¡è¯·æ±‚ï¼Œåˆ™è¡¨ç¤ºç”¨æˆ·è®¤è¯å¤±è´¥</p><p>è¿”å›å«æœ‰ 401 çš„å“åº”å¿…é¡»åŒ…å«ä¸€ä¸ªé€‚ç”¨äºè¢«è¯·æ±‚èµ„æºçš„ WWW-Authenticate é¦–éƒ¨ç”¨ä»¥è´¨è¯¢(challenge)ç”¨æˆ·ä¿¡æ¯ã€‚å½“æµè§ˆå™¨åˆæ¬¡æ¥æ”¶åˆ° 401 å“åº”ï¼Œä¼šå¼¹å‡ºè®¤è¯ç”¨çš„å¯¹è¯çª—å£ã€‚</p><p>ä»¥ä¸‹æƒ…å†µä¼šå‡ºç°401ï¼š</p><ul><li>401.1 - ç™»å½•å¤±è´¥ã€‚</li><li>401.2 - æœåŠ¡å™¨é…ç½®å¯¼è‡´ç™»å½•å¤±è´¥ã€‚</li><li>401.3 - ç”±äº ACL å¯¹èµ„æºçš„é™åˆ¶è€Œæœªè·å¾—æˆæƒã€‚</li><li>401.4 - ç­›é€‰å™¨æˆæƒå¤±è´¥ã€‚</li><li>401.5 - ISAPI/CGI åº”ç”¨ç¨‹åºæˆæƒå¤±è´¥ã€‚</li><li>401.7 - è®¿é—®è¢« Web æœåŠ¡å™¨ä¸Šçš„ URL æˆæƒç­–ç•¥æ‹’ç»ã€‚è¿™ä¸ªé”™è¯¯ä»£ç ä¸º IIS 6.0 æ‰€ä¸“ç”¨ã€‚</li></ul><h4 id="ï¼ˆ3ï¼‰403-Forbidden"><a href="#ï¼ˆ3ï¼‰403-Forbidden" class="headerlink" title="ï¼ˆ3ï¼‰403 Forbidden"></a>ï¼ˆ3ï¼‰403 Forbidden</h4><p>è¯¥çŠ¶æ€ç è¡¨æ˜è¯·æ±‚èµ„æºçš„è®¿é—®è¢«æœåŠ¡å™¨æ‹’ç»äº†ï¼ŒæœåŠ¡å™¨ç«¯æ²¡æœ‰å¿…è¦ç»™å‡ºè¯¦ç»†ç†ç”±ï¼Œä½†æ˜¯å¯ä»¥åœ¨å“åº”æŠ¥æ–‡å®ä½“çš„ä¸»ä½“ä¸­è¿›è¡Œè¯´æ˜ã€‚è¿›å…¥è¯¥çŠ¶æ€åï¼Œä¸èƒ½å†ç»§ç»­è¿›è¡ŒéªŒè¯ã€‚è¯¥è®¿é—®æ˜¯æ°¸ä¹…ç¦æ­¢çš„ï¼Œå¹¶ä¸”ä¸åº”ç”¨é€»è¾‘å¯†åˆ‡ç›¸å…³ã€‚</p><p>IIS å®šä¹‰äº†è®¸å¤šä¸åŒçš„ 403 é”™è¯¯ï¼Œå®ƒä»¬æŒ‡æ˜æ›´ä¸ºå…·ä½“çš„é”™è¯¯åŸå› ï¼š</p><ul><li>403.1 - æ‰§è¡Œè®¿é—®è¢«ç¦æ­¢ã€‚</li><li>403.2 - è¯»è®¿é—®è¢«ç¦æ­¢ã€‚</li><li>403.3 - å†™è®¿é—®è¢«ç¦æ­¢ã€‚</li><li>403.4 - è¦æ±‚ SSLã€‚</li><li>403.5 - è¦æ±‚ SSL 128ã€‚</li><li>403.6 - IP åœ°å€è¢«æ‹’ç»ã€‚</li><li>403.7 - è¦æ±‚å®¢æˆ·ç«¯è¯ä¹¦ã€‚</li><li>403.8 - ç«™ç‚¹è®¿é—®è¢«æ‹’ç»ã€‚</li><li>403.9 - ç”¨æˆ·æ•°è¿‡å¤šã€‚</li><li>403.10 - é…ç½®æ— æ•ˆã€‚</li><li>403.11 - å¯†ç æ›´æ”¹ã€‚</li><li>403.12 - æ‹’ç»è®¿é—®æ˜ å°„è¡¨ã€‚</li><li>403.13 - å®¢æˆ·ç«¯è¯ä¹¦è¢«åŠé”€ã€‚</li><li>403.14 - æ‹’ç»ç›®å½•åˆ—è¡¨ã€‚</li><li>403.15 - è¶…å‡ºå®¢æˆ·ç«¯è®¿é—®è®¸å¯ã€‚</li><li>403.16 - å®¢æˆ·ç«¯è¯ä¹¦ä¸å—ä¿¡ä»»æˆ–æ— æ•ˆã€‚</li><li>403.17 - å®¢æˆ·ç«¯è¯ä¹¦å·²è¿‡æœŸæˆ–å°šæœªç”Ÿæ•ˆ</li><li>403.18 - åœ¨å½“å‰çš„åº”ç”¨ç¨‹åºæ± ä¸­ä¸èƒ½æ‰§è¡Œæ‰€è¯·æ±‚çš„ URLã€‚è¿™ä¸ªé”™è¯¯ä»£ç ä¸º IIS 6.0 æ‰€ä¸“ç”¨ã€‚</li><li>403.19 - ä¸èƒ½ä¸ºè¿™ä¸ªåº”ç”¨ç¨‹åºæ± ä¸­çš„å®¢æˆ·ç«¯æ‰§è¡Œ CGIã€‚è¿™ä¸ªé”™è¯¯ä»£ç ä¸º IIS 6.0 æ‰€ä¸“ç”¨ã€‚</li><li>403.20 - Passport ç™»å½•å¤±è´¥ã€‚è¿™ä¸ªé”™è¯¯ä»£ç ä¸º IIS 6.0 æ‰€ä¸“ç”¨ã€‚</li></ul><h4 id="ï¼ˆ4ï¼‰404-Not-Found"><a href="#ï¼ˆ4ï¼‰404-Not-Found" class="headerlink" title="ï¼ˆ4ï¼‰404 Not Found"></a>ï¼ˆ4ï¼‰404 Not Found</h4><p>è¯¥çŠ¶æ€ç è¡¨æ˜æœåŠ¡å™¨ä¸Šæ— æ³•æ‰¾åˆ°è¯·æ±‚çš„èµ„æºã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥åœ¨æœåŠ¡å™¨ç«¯æ‹’ç»è¯·æ±‚ä¸”ä¸æƒ³è¯´æ˜ç†ç”±æ—¶ä½¿ç”¨ã€‚<br>ä»¥ä¸‹æƒ…å†µä¼šå‡ºç°404ï¼š</p><ul><li>404.0 -ï¼ˆæ— ï¼‰ â€“ æ²¡æœ‰æ‰¾åˆ°æ–‡ä»¶æˆ–ç›®å½•ã€‚</li><li>404.1 - æ— æ³•åœ¨æ‰€è¯·æ±‚çš„ç«¯å£ä¸Šè®¿é—® Web ç«™ç‚¹ã€‚</li><li>404.2 - Web æœåŠ¡æ‰©å±•é”å®šç­–ç•¥é˜»æ­¢æœ¬è¯·æ±‚ã€‚</li><li>404.3 - MIME æ˜ å°„ç­–ç•¥é˜»æ­¢æœ¬è¯·æ±‚ã€‚</li></ul><h4 id="ï¼ˆ5ï¼‰405-Method-Not-Allowed"><a href="#ï¼ˆ5ï¼‰405-Method-Not-Allowed" class="headerlink" title="ï¼ˆ5ï¼‰405 Method Not Allowed"></a>ï¼ˆ5ï¼‰405 Method Not Allowed</h4><p>è¯¥çŠ¶æ€ç è¡¨ç¤ºå®¢æˆ·ç«¯è¯·æ±‚çš„æ–¹æ³•è™½ç„¶èƒ½è¢«æœåŠ¡å™¨è¯†åˆ«ï¼Œä½†æ˜¯æœåŠ¡å™¨ç¦æ­¢ä½¿ç”¨è¯¥æ–¹æ³•ã€‚GET å’Œ HEAD æ–¹æ³•ï¼ŒæœåŠ¡å™¨åº”è¯¥æ€»æ˜¯å…è®¸å®¢æˆ·ç«¯è¿›è¡Œè®¿é—®ã€‚å®¢æˆ·ç«¯å¯ä»¥é€šè¿‡ OPTIONS æ–¹æ³•ï¼ˆé¢„æ£€ï¼‰æ¥æŸ¥çœ‹æœåŠ¡å™¨å…è®¸çš„è®¿é—®æ–¹æ³•, å¦‚ä¸‹</p><pre class="line-numbers language-javascript"><code class="language-javascript">Access<span class="token operator">-</span>Control<span class="token operator">-</span>Allow<span class="token operator">-</span>Methods<span class="token punctuation">:</span> GET<span class="token punctuation">,</span>HEAD<span class="token punctuation">,</span>PUT<span class="token punctuation">,</span>PATCH<span class="token punctuation">,</span>POST<span class="token punctuation">,</span>DELETE<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="4-5XX-Server-Error-æœåŠ¡å™¨é”™è¯¯çŠ¶æ€ç "><a href="#4-5XX-Server-Error-æœåŠ¡å™¨é”™è¯¯çŠ¶æ€ç " class="headerlink" title="4. 5XX (Server Error æœåŠ¡å™¨é”™è¯¯çŠ¶æ€ç )"></a>4. 5XX (Server Error æœåŠ¡å™¨é”™è¯¯çŠ¶æ€ç )</h3><p>5XX çš„å“åº”ç»“æœè¡¨æ˜æœåŠ¡å™¨æœ¬èº«å‘ç”Ÿé”™è¯¯.</p><h4 id="ï¼ˆ1ï¼‰500-Internal-Server-Error"><a href="#ï¼ˆ1ï¼‰500-Internal-Server-Error" class="headerlink" title="ï¼ˆ1ï¼‰500 Internal Server Error"></a>ï¼ˆ1ï¼‰500 Internal Server Error</h4><p>è¯¥çŠ¶æ€ç è¡¨æ˜æœåŠ¡å™¨ç«¯åœ¨æ‰§è¡Œè¯·æ±‚æ—¶å‘ç”Ÿäº†é”™è¯¯ã€‚ä¹Ÿæœ‰å¯èƒ½æ˜¯ Web åº”ç”¨å­˜åœ¨çš„ bug æˆ–æŸäº›ä¸´æ—¶çš„æ•…éšœã€‚</p><h4 id="ï¼ˆ2ï¼‰502-Bad-Gateway"><a href="#ï¼ˆ2ï¼‰502-Bad-Gateway" class="headerlink" title="ï¼ˆ2ï¼‰502 Bad Gateway"></a>ï¼ˆ2ï¼‰502 Bad Gateway</h4><p>è¯¥çŠ¶æ€ç è¡¨æ˜æ‰®æ¼”ç½‘å…³æˆ–ä»£ç†è§’è‰²çš„æœåŠ¡å™¨ï¼Œä»ä¸Šæ¸¸æœåŠ¡å™¨ä¸­æ¥æ”¶åˆ°çš„å“åº”æ˜¯æ— æ•ˆçš„ã€‚æ³¨æ„ï¼Œ502 é”™è¯¯é€šå¸¸ä¸æ˜¯å®¢æˆ·ç«¯èƒ½å¤Ÿä¿®å¤çš„ï¼Œè€Œæ˜¯éœ€è¦ç”±é€”ç»çš„ Web æœåŠ¡å™¨æˆ–è€…ä»£ç†æœåŠ¡å™¨å¯¹å…¶è¿›è¡Œä¿®å¤ã€‚ä»¥ä¸‹æƒ…å†µä¼šå‡ºç°502ï¼š</p><ul><li>502.1 - CGI ï¼ˆé€šç”¨ç½‘å…³æ¥å£ï¼‰åº”ç”¨ç¨‹åºè¶…æ—¶ã€‚</li><li>502.2 - CGI ï¼ˆé€šç”¨ç½‘å…³æ¥å£ï¼‰åº”ç”¨ç¨‹åºå‡ºé”™ã€‚</li></ul><h4 id="ï¼ˆ3ï¼‰503-Service-Unavailable"><a href="#ï¼ˆ3ï¼‰503-Service-Unavailable" class="headerlink" title="ï¼ˆ3ï¼‰503 Service Unavailable"></a>ï¼ˆ3ï¼‰503 Service Unavailable</h4><p>è¯¥çŠ¶æ€ç è¡¨æ˜æœåŠ¡å™¨æš‚æ—¶å¤„äºè¶…è´Ÿè½½æˆ–æ­£åœ¨è¿›è¡Œåœæœºç»´æŠ¤ï¼Œç°åœ¨æ— æ³•å¤„ç†è¯·æ±‚ã€‚å¦‚æœäº‹å…ˆå¾—çŸ¥è§£é™¤ä»¥ä¸ŠçŠ¶å†µéœ€è¦çš„æ—¶é—´ï¼Œæœ€å¥½å†™å…¥ RetryAfter é¦–éƒ¨å­—æ®µå†è¿”å›ç»™å®¢æˆ·ç«¯ã€‚</p><p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p><ul><li>æœåŠ¡å™¨åœæœºç»´æŠ¤æ—¶ï¼Œä¸»åŠ¨ç”¨503å“åº”è¯·æ±‚ï¼›</li><li>nginx è®¾ç½®é™é€Ÿï¼Œè¶…è¿‡é™é€Ÿï¼Œä¼šè¿”å›503ã€‚</li></ul><h4 id="ï¼ˆ4ï¼‰504-Gateway-Timeout"><a href="#ï¼ˆ4ï¼‰504-Gateway-Timeout" class="headerlink" title="ï¼ˆ4ï¼‰504 Gateway Timeout"></a>ï¼ˆ4ï¼‰504 Gateway Timeout</h4><p>è¯¥çŠ¶æ€ç è¡¨ç¤ºç½‘å…³æˆ–è€…ä»£ç†çš„æœåŠ¡å™¨æ— æ³•åœ¨è§„å®šçš„æ—¶é—´å†…è·å¾—æƒ³è¦çš„å“åº”ã€‚ä»–æ˜¯HTTP 1.1ä¸­æ–°åŠ å…¥çš„ã€‚</p><p>ä½¿ç”¨åœºæ™¯ï¼šä»£ç æ‰§è¡Œæ—¶é—´è¶…æ—¶ï¼Œæˆ–è€…å‘ç”Ÿäº†æ­»å¾ªç¯ã€‚</p><h3 id="5-æ€»ç»“"><a href="#5-æ€»ç»“" class="headerlink" title="5. æ€»ç»“"></a>5. æ€»ç»“</h3><p><strong>ï¼ˆ1ï¼‰2XX æˆåŠŸ</strong></p><ul><li>200 OKï¼Œè¡¨ç¤ºä»å®¢æˆ·ç«¯å‘æ¥çš„è¯·æ±‚åœ¨æœåŠ¡å™¨ç«¯è¢«æ­£ç¡®å¤„ç†</li><li>204 No contentï¼Œè¡¨ç¤ºè¯·æ±‚æˆåŠŸï¼Œä½†å“åº”æŠ¥æ–‡ä¸å«å®ä½“çš„ä¸»ä½“éƒ¨åˆ†</li><li>205 Reset Contentï¼Œè¡¨ç¤ºè¯·æ±‚æˆåŠŸï¼Œä½†å“åº”æŠ¥æ–‡ä¸å«å®ä½“çš„ä¸»ä½“éƒ¨åˆ†ï¼Œä½†æ˜¯ä¸ 204 å“åº”ä¸åŒåœ¨äºè¦æ±‚è¯·æ±‚æ–¹é‡ç½®å†…å®¹</li><li>206 Partial Contentï¼Œè¿›è¡ŒèŒƒå›´è¯·æ±‚</li></ul><p><strong>ï¼ˆ2ï¼‰3XX é‡å®šå‘</strong></p><ul><li>301 moved permanentlyï¼Œæ°¸ä¹…æ€§é‡å®šå‘ï¼Œè¡¨ç¤ºèµ„æºå·²è¢«åˆ†é…äº†æ–°çš„ URL</li><li>302 foundï¼Œä¸´æ—¶æ€§é‡å®šå‘ï¼Œè¡¨ç¤ºèµ„æºä¸´æ—¶è¢«åˆ†é…äº†æ–°çš„ URL</li><li>303 see otherï¼Œè¡¨ç¤ºèµ„æºå­˜åœ¨ç€å¦ä¸€ä¸ª URLï¼Œåº”ä½¿ç”¨ GET æ–¹æ³•è·å–èµ„æº</li><li>304 not modifiedï¼Œè¡¨ç¤ºæœåŠ¡å™¨å…è®¸è®¿é—®èµ„æºï¼Œä½†å› å‘ç”Ÿè¯·æ±‚æœªæ»¡è¶³æ¡ä»¶çš„æƒ…å†µ</li><li>307 temporary redirectï¼Œä¸´æ—¶é‡å®šå‘ï¼Œå’Œ302å«ä¹‰ç±»ä¼¼ï¼Œä½†æ˜¯æœŸæœ›å®¢æˆ·ç«¯ä¿æŒè¯·æ±‚æ–¹æ³•ä¸å˜å‘æ–°çš„åœ°å€å‘å‡ºè¯·æ±‚</li></ul><p><strong>ï¼ˆ3ï¼‰4XX å®¢æˆ·ç«¯é”™è¯¯</strong></p><ul><li>400 bad requestï¼Œè¯·æ±‚æŠ¥æ–‡å­˜åœ¨è¯­æ³•é”™è¯¯</li><li>401 unauthorizedï¼Œè¡¨ç¤ºå‘é€çš„è¯·æ±‚éœ€è¦æœ‰é€šè¿‡ HTTP è®¤è¯çš„è®¤è¯ä¿¡æ¯</li><li>403 forbiddenï¼Œè¡¨ç¤ºå¯¹è¯·æ±‚èµ„æºçš„è®¿é—®è¢«æœåŠ¡å™¨æ‹’ç»</li><li>404 not foundï¼Œè¡¨ç¤ºåœ¨æœåŠ¡å™¨ä¸Šæ²¡æœ‰æ‰¾åˆ°è¯·æ±‚çš„èµ„æº</li></ul><p><strong>ï¼ˆ4ï¼‰5XX æœåŠ¡å™¨é”™è¯¯</strong></p><ul><li>500 internal sever errorï¼Œè¡¨ç¤ºæœåŠ¡å™¨ç«¯åœ¨æ‰§è¡Œè¯·æ±‚æ—¶å‘ç”Ÿäº†é”™è¯¯</li><li>501 Not Implementedï¼Œè¡¨ç¤ºæœåŠ¡å™¨ä¸æ”¯æŒå½“å‰è¯·æ±‚æ‰€éœ€è¦çš„æŸä¸ªåŠŸèƒ½</li><li>503 service unavailableï¼Œè¡¨æ˜æœåŠ¡å™¨æš‚æ—¶å¤„äºè¶…è´Ÿè½½æˆ–æ­£åœ¨åœæœºç»´æŠ¤ï¼Œæ— æ³•å¤„ç†è¯·æ±‚</li></ul><h3 id="6-åŒæ ·æ˜¯é‡å®šå‘ï¼Œ307ï¼Œ303ï¼Œ302çš„åŒºåˆ«ï¼Ÿ"><a href="#6-åŒæ ·æ˜¯é‡å®šå‘ï¼Œ307ï¼Œ303ï¼Œ302çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="6. åŒæ ·æ˜¯é‡å®šå‘ï¼Œ307ï¼Œ303ï¼Œ302çš„åŒºåˆ«ï¼Ÿ"></a>6. åŒæ ·æ˜¯é‡å®šå‘ï¼Œ<strong>307</strong>ï¼Œ<strong>303</strong>ï¼Œ<strong>302</strong>çš„åŒºåˆ«ï¼Ÿ</h3><p>302æ˜¯http1.0çš„åè®®çŠ¶æ€ç ï¼Œåœ¨http1.1ç‰ˆæœ¬çš„æ—¶å€™ä¸ºäº†ç»†åŒ–302çŠ¶æ€ç â¼œå‡ºæ¥äº†ä¸¤ä¸ª303å’Œ307ã€‚ 303æ˜ç¡®è¡¨ç¤ºå®¢æˆ·ç«¯åº”å½“é‡‡â½¤getâ½…æ³•è·å–èµ„æºï¼Œä»–ä¼šæŠŠPOSTè¯·æ±‚å˜ä¸ºGETè¯·æ±‚è¿›â¾é‡å®šå‘ã€‚ 307ä¼šéµç…§æµè§ˆå™¨æ ‡å‡†ï¼Œä¸ä¼šä»postå˜ä¸ºgetã€‚ </p><h2 id="å››ã€DNSåè®®ä»‹ç»"><a href="#å››ã€DNSåè®®ä»‹ç»" class="headerlink" title="å››ã€DNSåè®®ä»‹ç»"></a>å››ã€DNSåè®®ä»‹ç»</h2><h3 id="1-DNS-åè®®æ˜¯ä»€ä¹ˆ"><a href="#1-DNS-åè®®æ˜¯ä»€ä¹ˆ" class="headerlink" title="1. DNS åè®®æ˜¯ä»€ä¹ˆ"></a>1. DNS åè®®æ˜¯ä»€ä¹ˆ</h3><p><strong>æ¦‚å¿µ</strong>ï¼š DNS æ˜¯åŸŸåç³»ç»Ÿ (Domain Name System) çš„ç¼©å†™ï¼Œæä¾›çš„æ˜¯ä¸€ç§ä¸»æœºååˆ° IP åœ°å€çš„è½¬æ¢æœåŠ¡ï¼Œå°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„åŸŸåç³»ç»Ÿã€‚å®ƒæ˜¯ä¸€ä¸ªç”±åˆ†å±‚çš„ DNS æœåŠ¡å™¨ç»„æˆçš„åˆ†å¸ƒå¼æ•°æ®åº“ï¼Œæ˜¯å®šä¹‰äº†ä¸»æœºå¦‚ä½•æŸ¥è¯¢è¿™ä¸ªåˆ†å¸ƒå¼æ•°æ®åº“çš„æ–¹å¼çš„åº”ç”¨å±‚åè®®ã€‚èƒ½å¤Ÿä½¿äººæ›´æ–¹ä¾¿çš„è®¿é—®äº’è”ç½‘ï¼Œè€Œä¸ç”¨å»è®°ä½èƒ½å¤Ÿè¢«æœºå™¨ç›´æ¥è¯»å–çš„IPæ•°ä¸²ã€‚</p><p><strong>ä½œç”¨</strong>ï¼š å°†åŸŸåè§£æä¸ºIPåœ°å€ï¼Œå®¢æˆ·ç«¯å‘DNSæœåŠ¡å™¨ï¼ˆDNSæœåŠ¡å™¨æœ‰è‡ªå·±çš„IPåœ°å€ï¼‰å‘é€åŸŸåæŸ¥è¯¢è¯·æ±‚ï¼ŒDNSæœåŠ¡å™¨å‘ŠçŸ¥å®¢æˆ·æœºWebæœåŠ¡å™¨çš„ IP åœ°å€ã€‚</p><h3 id="2-DNSåŒæ—¶ä½¿ç”¨TCPå’ŒUDPåè®®ï¼Ÿ"><a href="#2-DNSåŒæ—¶ä½¿ç”¨TCPå’ŒUDPåè®®ï¼Ÿ" class="headerlink" title="2. DNSåŒæ—¶ä½¿ç”¨TCPå’ŒUDPåè®®ï¼Ÿ"></a>2. DNSåŒæ—¶ä½¿ç”¨TCPå’ŒUDPåè®®ï¼Ÿ</h3><p><strong>DNSå ç”¨53å·ç«¯å£ï¼ŒåŒæ—¶ä½¿ç”¨TCPå’ŒUDPåè®®ã€‚</strong><br>ï¼ˆ1ï¼‰åœ¨åŒºåŸŸä¼ è¾“çš„æ—¶å€™ä½¿ç”¨TCPåè®®</p><ul><li>è¾…åŸŸåæœåŠ¡å™¨ä¼šå®šæ—¶ï¼ˆä¸€èˆ¬3å°æ—¶ï¼‰å‘ä¸»åŸŸåæœåŠ¡å™¨è¿›è¡ŒæŸ¥è¯¢ä»¥ä¾¿äº†è§£æ•°æ®æ˜¯å¦æœ‰å˜åŠ¨ã€‚å¦‚æœ‰å˜åŠ¨ï¼Œä¼šæ‰§è¡Œä¸€æ¬¡åŒºåŸŸä¼ é€ï¼Œè¿›è¡Œæ•°æ®åŒæ­¥ã€‚åŒºåŸŸä¼ é€ä½¿ç”¨TCPè€Œä¸æ˜¯UDPï¼Œå› ä¸ºæ•°æ®åŒæ­¥ä¼ é€çš„æ•°æ®é‡æ¯”ä¸€ä¸ªè¯·æ±‚åº”ç­”çš„æ•°æ®é‡è¦å¤šå¾—å¤šã€‚</li><li>TCPæ˜¯ä¸€ç§å¯é è¿æ¥ï¼Œä¿è¯äº†æ•°æ®çš„å‡†ç¡®æ€§ã€‚</li></ul><p>ï¼ˆ2ï¼‰åœ¨åŸŸåè§£æçš„æ—¶å€™ä½¿ç”¨UDPåè®®</p><ul><li>å®¢æˆ·ç«¯å‘DNSæœåŠ¡å™¨æŸ¥è¯¢åŸŸåï¼Œä¸€èˆ¬è¿”å›çš„å†…å®¹éƒ½ä¸è¶…è¿‡512å­—èŠ‚ï¼Œç”¨UDPä¼ è¾“å³å¯ã€‚ä¸ç”¨ç»è¿‡ä¸‰æ¬¡æ¡æ‰‹ï¼Œè¿™æ ·DNSæœåŠ¡å™¨è´Ÿè½½æ›´ä½ï¼Œå“åº”æ›´å¿«ã€‚ç†è®ºä¸Šè¯´ï¼Œå®¢æˆ·ç«¯ä¹Ÿå¯ä»¥æŒ‡å®šå‘DNSæœåŠ¡å™¨æŸ¥è¯¢æ—¶ç”¨TCPï¼Œä½†äº‹å®ä¸Šï¼Œå¾ˆå¤šDNSæœåŠ¡å™¨è¿›è¡Œé…ç½®çš„æ—¶å€™ï¼Œä»…æ”¯æŒUDPæŸ¥è¯¢åŒ…ã€‚</li></ul><h3 id="3-DNSå®Œæ•´çš„æŸ¥è¯¢è¿‡ç¨‹"><a href="#3-DNSå®Œæ•´çš„æŸ¥è¯¢è¿‡ç¨‹" class="headerlink" title="3. DNSå®Œæ•´çš„æŸ¥è¯¢è¿‡ç¨‹"></a>3. DNSå®Œæ•´çš„æŸ¥è¯¢è¿‡ç¨‹</h3><p>DNSæœåŠ¡å™¨è§£æåŸŸåçš„è¿‡ç¨‹ï¼š</p><ul><li>é¦–å…ˆä¼šåœ¨<strong>æµè§ˆå™¨çš„ç¼“å­˜</strong>ä¸­æŸ¥æ‰¾å¯¹åº”çš„IPåœ°å€ï¼Œå¦‚æœæŸ¥æ‰¾åˆ°ç›´æ¥è¿”å›ï¼Œè‹¥æ‰¾ä¸åˆ°ç»§ç»­ä¸‹ä¸€æ­¥</li><li>å°†è¯·æ±‚å‘é€ç»™<strong>æœ¬åœ°DNSæœåŠ¡å™¨</strong>ï¼Œåœ¨æœ¬åœ°åŸŸåæœåŠ¡å™¨ç¼“å­˜ä¸­æŸ¥è¯¢ï¼Œå¦‚æœæŸ¥æ‰¾åˆ°ï¼Œå°±ç›´æ¥å°†æŸ¥æ‰¾ç»“æœè¿”å›ï¼Œè‹¥æ‰¾ä¸åˆ°ç»§ç»­ä¸‹ä¸€æ­¥</li><li>æœ¬åœ°DNSæœåŠ¡å™¨å‘<strong>æ ¹åŸŸåæœåŠ¡å™¨</strong>å‘é€è¯·æ±‚ï¼Œæ ¹åŸŸåæœåŠ¡å™¨ä¼šè¿”å›ä¸€ä¸ªæ‰€æŸ¥è¯¢åŸŸçš„é¡¶çº§åŸŸåæœåŠ¡å™¨åœ°å€</li><li>æœ¬åœ°DNSæœåŠ¡å™¨å‘<strong>é¡¶çº§åŸŸåæœåŠ¡å™¨</strong>å‘é€è¯·æ±‚ï¼Œæ¥å—è¯·æ±‚çš„æœåŠ¡å™¨æŸ¥è¯¢è‡ªå·±çš„ç¼“å­˜ï¼Œå¦‚æœæœ‰è®°å½•ï¼Œå°±è¿”å›æŸ¥è¯¢ç»“æœï¼Œå¦‚æœæ²¡æœ‰å°±è¿”å›ç›¸å…³çš„ä¸‹ä¸€çº§çš„æƒå¨åŸŸåæœåŠ¡å™¨çš„åœ°å€</li><li>æœ¬åœ°DNSæœåŠ¡å™¨å‘<strong>æƒå¨åŸŸåæœåŠ¡å™¨</strong>å‘é€è¯·æ±‚ï¼ŒåŸŸåæœåŠ¡å™¨è¿”å›å¯¹åº”çš„ç»“æœ</li><li>æœ¬åœ°DNSæœåŠ¡å™¨å°†è¿”å›ç»“æœä¿å­˜åœ¨ç¼“å­˜ä¸­ï¼Œä¾¿äºä¸‹æ¬¡ä½¿ç”¨</li><li>æœ¬åœ°DNSæœåŠ¡å™¨å°†è¿”å›ç»“æœè¿”å›ç»™æµè§ˆå™¨</li></ul><p>æ¯”å¦‚è¦æŸ¥è¯¢ <a href="http://www.baidu.com/">www.baidu.com</a> çš„ IP åœ°å€ï¼Œé¦–å…ˆä¼šåœ¨æµè§ˆå™¨çš„ç¼“å­˜ä¸­æŸ¥æ‰¾æ˜¯å¦æœ‰è¯¥åŸŸåçš„ç¼“å­˜ï¼Œå¦‚æœä¸å­˜åœ¨å°±å°†è¯·æ±‚å‘é€åˆ°æœ¬åœ°çš„ DNS æœåŠ¡å™¨ä¸­ï¼Œæœ¬åœ°DNSæœåŠ¡å™¨ä¼šåˆ¤æ–­æ˜¯å¦å­˜åœ¨è¯¥åŸŸåçš„ç¼“å­˜ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™å‘æ ¹åŸŸåæœåŠ¡å™¨å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œæ ¹åŸŸåæœåŠ¡å™¨è¿”å›è´Ÿè´£ .com çš„é¡¶çº§åŸŸåæœåŠ¡å™¨çš„ IP åœ°å€çš„åˆ—è¡¨ã€‚ç„¶åæœ¬åœ° DNS æœåŠ¡å™¨å†å‘å…¶ä¸­ä¸€ä¸ªè´Ÿè´£ .com çš„é¡¶çº§åŸŸåæœåŠ¡å™¨å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œè´Ÿè´£ .com çš„é¡¶çº§åŸŸåæœåŠ¡å™¨è¿”å›è´Ÿè´£ .baidu çš„æƒå¨åŸŸåæœåŠ¡å™¨çš„ IP åœ°å€åˆ—è¡¨ã€‚ç„¶åæœ¬åœ° DNS æœåŠ¡å™¨å†å‘å…¶ä¸­ä¸€ä¸ªæƒå¨åŸŸåæœåŠ¡å™¨å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œæœ€åæƒå¨åŸŸåæœåŠ¡å™¨è¿”å›ä¸€ä¸ªå¯¹åº”çš„ä¸»æœºåçš„ IP åœ°å€åˆ—è¡¨ã€‚</p><h3 id="4-è¿­ä»£æŸ¥è¯¢ä¸é€’å½’æŸ¥è¯¢"><a href="#4-è¿­ä»£æŸ¥è¯¢ä¸é€’å½’æŸ¥è¯¢" class="headerlink" title="4. è¿­ä»£æŸ¥è¯¢ä¸é€’å½’æŸ¥è¯¢"></a>4. è¿­ä»£æŸ¥è¯¢ä¸é€’å½’æŸ¥è¯¢</h3><p>å®é™…ä¸Šï¼ŒDNSè§£ææ˜¯ä¸€ä¸ªåŒ…å«è¿­ä»£æŸ¥è¯¢å’Œé€’å½’æŸ¥è¯¢çš„è¿‡ç¨‹ã€‚</p><ul><li><strong>é€’å½’æŸ¥è¯¢</strong>æŒ‡çš„æ˜¯æŸ¥è¯¢è¯·æ±‚å‘å‡ºåï¼ŒåŸŸåæœåŠ¡å™¨ä»£ä¸ºå‘ä¸‹ä¸€çº§åŸŸåæœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼Œæœ€åå‘ç”¨æˆ·è¿”å›æŸ¥è¯¢çš„æœ€ç»ˆç»“æœã€‚ä½¿ç”¨é€’å½’ æŸ¥è¯¢ï¼Œç”¨æˆ·åªéœ€è¦å‘å‡ºä¸€æ¬¡æŸ¥è¯¢è¯·æ±‚ã€‚</li><li><strong>è¿­ä»£æŸ¥è¯¢</strong>æŒ‡çš„æ˜¯æŸ¥è¯¢è¯·æ±‚åï¼ŒåŸŸåæœåŠ¡å™¨è¿”å›å•æ¬¡æŸ¥è¯¢çš„ç»“æœã€‚ä¸‹ä¸€çº§çš„æŸ¥è¯¢ç”±ç”¨æˆ·è‡ªå·±è¯·æ±‚ã€‚ä½¿ç”¨è¿­ä»£æŸ¥è¯¢ï¼Œç”¨æˆ·éœ€è¦å‘å‡º å¤šæ¬¡çš„æŸ¥è¯¢è¯·æ±‚ã€‚</li></ul><p>ä¸€èˆ¬æˆ‘ä»¬å‘æœ¬åœ° DNS æœåŠ¡å™¨å‘é€è¯·æ±‚çš„æ–¹å¼å°±æ˜¯é€’å½’æŸ¥è¯¢ï¼Œå› ä¸ºæˆ‘ä»¬åªéœ€è¦å‘å‡ºä¸€æ¬¡è¯·æ±‚ï¼Œç„¶åæœ¬åœ° DNS æœåŠ¡å™¨è¿”å›ç»™æˆ‘ ä»¬æœ€ç»ˆçš„è¯·æ±‚ç»“æœã€‚è€Œæœ¬åœ° DNS æœåŠ¡å™¨å‘å…¶ä»–åŸŸåæœåŠ¡å™¨è¯·æ±‚çš„è¿‡ç¨‹æ˜¯è¿­ä»£æŸ¥è¯¢çš„è¿‡ç¨‹ï¼Œå› ä¸ºæ¯ä¸€æ¬¡åŸŸåæœåŠ¡å™¨åªè¿”å›å•æ¬¡ æŸ¥è¯¢çš„ç»“æœï¼Œä¸‹ä¸€çº§çš„æŸ¥è¯¢ç”±æœ¬åœ° DNS æœåŠ¡å™¨è‡ªå·±è¿›è¡Œã€‚</p><h3 id="5-DNS-è®°å½•å’ŒæŠ¥æ–‡"><a href="#5-DNS-è®°å½•å’ŒæŠ¥æ–‡" class="headerlink" title="5. DNS è®°å½•å’ŒæŠ¥æ–‡"></a>5. DNS è®°å½•å’ŒæŠ¥æ–‡</h3><p>DNS æœåŠ¡å™¨ä¸­ä»¥èµ„æºè®°å½•çš„å½¢å¼å­˜å‚¨ä¿¡æ¯ï¼Œæ¯ä¸€ä¸ª DNS å“åº”æŠ¥æ–‡ä¸€èˆ¬åŒ…å«å¤šæ¡èµ„æºè®°å½•ã€‚ä¸€æ¡èµ„æºè®°å½•çš„å…·ä½“çš„æ ¼å¼ä¸º</p><pre class="line-numbers language-http"><code class="language-http">ï¼ˆNameï¼ŒValueï¼ŒTypeï¼ŒTTLï¼‰<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å…¶ä¸­ TTL æ˜¯èµ„æºè®°å½•çš„ç”Ÿå­˜æ—¶é—´ï¼Œå®ƒå®šä¹‰äº†èµ„æºè®°å½•èƒ½å¤Ÿè¢«å…¶ä»–çš„ DNS æœåŠ¡å™¨ç¼“å­˜å¤šé•¿æ—¶é—´ã€‚</p><p>å¸¸ç”¨çš„ä¸€å…±æœ‰å››ç§ Type çš„å€¼ï¼Œåˆ†åˆ«æ˜¯ Aã€NSã€CNAME å’Œ MX ï¼Œä¸åŒ Type çš„å€¼ï¼Œå¯¹åº”èµ„æºè®°å½•ä»£è¡¨çš„æ„ä¹‰ä¸åŒï¼š</p><ul><li>å¦‚æœ Type = Aï¼Œåˆ™ Name æ˜¯ä¸»æœºåï¼ŒValue æ˜¯ä¸»æœºåå¯¹åº”çš„ IP åœ°å€ã€‚å› æ­¤ä¸€æ¡è®°å½•ä¸º A çš„èµ„æºè®°å½•ï¼Œæä¾›äº†æ ‡ å‡†çš„ä¸»æœºååˆ° IP åœ°å€çš„æ˜ å°„ã€‚</li><li>å¦‚æœ Type = NSï¼Œåˆ™ Name æ˜¯ä¸ªåŸŸåï¼ŒValue æ˜¯è´Ÿè´£è¯¥åŸŸåçš„ DNS æœåŠ¡å™¨çš„ä¸»æœºåã€‚è¿™ä¸ªè®°å½•ä¸»è¦ç”¨äº DNS é“¾å¼ æŸ¥è¯¢æ—¶ï¼Œè¿”å›ä¸‹ä¸€çº§éœ€è¦æŸ¥è¯¢çš„ DNS æœåŠ¡å™¨çš„ä¿¡æ¯ã€‚</li><li>å¦‚æœ Type = CNAMEï¼Œåˆ™ Name ä¸ºåˆ«åï¼ŒValue ä¸ºè¯¥ä¸»æœºçš„è§„èŒƒä¸»æœºåã€‚è¯¥æ¡è®°å½•ç”¨äºå‘æŸ¥è¯¢çš„ä¸»æœºè¿”å›ä¸€ä¸ªä¸»æœºå å¯¹åº”çš„è§„èŒƒä¸»æœºåï¼Œä»è€Œå‘Šè¯‰æŸ¥è¯¢ä¸»æœºå»æŸ¥è¯¢è¿™ä¸ªä¸»æœºåçš„ IP åœ°å€ã€‚ä¸»æœºåˆ«åä¸»è¦æ˜¯ä¸ºäº†é€šè¿‡ç»™ä¸€äº›å¤æ‚çš„ä¸»æœºåæä¾› ä¸€ä¸ªä¾¿äºè®°å¿†çš„ç®€å•çš„åˆ«åã€‚</li><li>å¦‚æœ Type = MXï¼Œåˆ™ Name ä¸ºä¸€ä¸ªé‚®ä»¶æœåŠ¡å™¨çš„åˆ«åï¼ŒValue ä¸ºé‚®ä»¶æœåŠ¡å™¨çš„è§„èŒƒä¸»æœºåã€‚å®ƒçš„ä½œç”¨å’Œ CNAME æ˜¯ä¸€ æ ·çš„ï¼Œéƒ½æ˜¯ä¸ºäº†è§£å†³è§„èŒƒä¸»æœºåä¸åˆ©äºè®°å¿†çš„ç¼ºç‚¹ã€‚</li></ul><h2 id="äº”ã€ç½‘ç»œæ¨¡å‹"><a href="#äº”ã€ç½‘ç»œæ¨¡å‹" class="headerlink" title="äº”ã€ç½‘ç»œæ¨¡å‹"></a>äº”ã€ç½‘ç»œæ¨¡å‹</h2><h3 id="1-OSIä¸ƒå±‚æ¨¡å‹"><a href="#1-OSIä¸ƒå±‚æ¨¡å‹" class="headerlink" title="1. OSIä¸ƒå±‚æ¨¡å‹"></a>1. OSIä¸ƒå±‚æ¨¡å‹</h3><p><code>ISO</code>ä¸ºäº†æ›´å¥½çš„ä½¿ç½‘ç»œåº”ç”¨æ›´ä¸ºæ™®åŠï¼Œæ¨å‡ºäº†<code>OSI</code>å‚è€ƒæ¨¡å‹ã€‚<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/network/12.webp" alt=""></p><h4 id="ï¼ˆ1ï¼‰åº”ç”¨å±‚"><a href="#ï¼ˆ1ï¼‰åº”ç”¨å±‚" class="headerlink" title="ï¼ˆ1ï¼‰åº”ç”¨å±‚"></a>ï¼ˆ1ï¼‰åº”ç”¨å±‚</h4><p><code>OSI</code>å‚è€ƒæ¨¡å‹ä¸­æœ€é è¿‘ç”¨æˆ·çš„ä¸€å±‚ï¼Œæ˜¯ä¸ºè®¡ç®—æœºç”¨æˆ·æä¾›åº”ç”¨æ¥å£ï¼Œä¹Ÿä¸ºç”¨æˆ·ç›´æ¥æä¾›å„ç§ç½‘ç»œæœåŠ¡ã€‚æˆ‘ä»¬å¸¸è§åº”ç”¨å±‚çš„ç½‘ç»œæœåŠ¡åè®®æœ‰ï¼š<code>HTTP</code>ï¼Œ<code>HTTPS</code>ï¼Œ<code>FTP</code>ï¼Œ<code>POP3</code>ã€<code>SMTP</code>ç­‰ã€‚</p><ul><li>åœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¸­ç»å¸¸ä¼šæœ‰æ•°æ®çš„è¯·æ±‚ï¼Œè¿™ä¸ªæ—¶å€™å°±æ˜¯ä¼šç”¨åˆ°<code>http(hyper text transfer protocol)(è¶…æ–‡æœ¬ä¼ è¾“åè®®)</code>æˆ–è€…<code>https</code>.åœ¨åç«¯è®¾è®¡æ•°æ®æ¥å£æ—¶ï¼Œæˆ‘ä»¬å¸¸å¸¸ä½¿ç”¨åˆ°è¿™ä¸ªåè®®ã€‚</li><li><code>FTP</code>æ˜¯æ–‡ä»¶ä¼ è¾“åè®®ï¼Œåœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä¸ªäººå¹¶æ²¡æœ‰æ¶‰åŠåˆ°ï¼Œä½†æ˜¯æˆ‘æƒ³ï¼Œåœ¨ä¸€äº›èµ„æºç½‘ç«™ï¼Œæ¯”å¦‚<code>ç™¾åº¦ç½‘ç›˜``è¿…é›·</code>åº”è¯¥æ˜¯åŸºäºæ­¤åè®®çš„ã€‚</li><li><code>SMTP</code>æ˜¯<code>simple mail transfer protocolï¼ˆç®€å•é‚®ä»¶ä¼ è¾“åè®®ï¼‰</code>ã€‚åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­ï¼Œåœ¨ç”¨æˆ·é‚®ç®±éªŒè¯ç ç™»å½•çš„åŠŸèƒ½æ—¶ï¼Œä½¿ç”¨åˆ°äº†è¿™ä¸ªåè®®ã€‚</li></ul><h4 id="ï¼ˆ2ï¼‰è¡¨ç¤ºå±‚"><a href="#ï¼ˆ2ï¼‰è¡¨ç¤ºå±‚" class="headerlink" title="ï¼ˆ2ï¼‰è¡¨ç¤ºå±‚"></a>ï¼ˆ2ï¼‰è¡¨ç¤ºå±‚</h4><p>è¡¨ç¤ºå±‚æä¾›å„ç§ç”¨äºåº”ç”¨å±‚æ•°æ®çš„ç¼–ç å’Œè½¬æ¢åŠŸèƒ½,ç¡®ä¿ä¸€ä¸ªç³»ç»Ÿçš„åº”ç”¨å±‚å‘é€çš„æ•°æ®èƒ½è¢«å¦ä¸€ä¸ªç³»ç»Ÿçš„åº”ç”¨å±‚è¯†åˆ«ã€‚å¦‚æœå¿…è¦ï¼Œè¯¥å±‚å¯æä¾›ä¸€ç§æ ‡å‡†è¡¨ç¤ºå½¢å¼ï¼Œç”¨äºå°†è®¡ç®—æœºå†…éƒ¨çš„å¤šç§æ•°æ®æ ¼å¼è½¬æ¢æˆé€šä¿¡ä¸­é‡‡ç”¨çš„æ ‡å‡†è¡¨ç¤ºå½¢å¼ã€‚æ•°æ®å‹ç¼©å’ŒåŠ å¯†ä¹Ÿæ˜¯è¡¨ç¤ºå±‚å¯æä¾›çš„è½¬æ¢åŠŸèƒ½ä¹‹ä¸€ã€‚</p><p>åœ¨é¡¹ç›®å¼€å‘ä¸­ï¼Œä¸ºäº†æ–¹ä¾¿æ•°æ®ä¼ è¾“ï¼Œå¯ä»¥ä½¿ç”¨<code>base64</code>å¯¹æ•°æ®è¿›è¡Œç¼–è§£ç ã€‚å¦‚æœæŒ‰åŠŸèƒ½æ¥åˆ’åˆ†ï¼Œ<code>base64</code>åº”è¯¥æ˜¯å·¥ä½œåœ¨è¡¨ç¤ºå±‚ã€‚</p><h4 id="ï¼ˆ3ï¼‰ä¼šè¯å±‚"><a href="#ï¼ˆ3ï¼‰ä¼šè¯å±‚" class="headerlink" title="ï¼ˆ3ï¼‰ä¼šè¯å±‚"></a>ï¼ˆ3ï¼‰ä¼šè¯å±‚</h4><p>ä¼šè¯å±‚å°±æ˜¯è´Ÿè´£å»ºç«‹ã€ç®¡ç†å’Œç»ˆæ­¢è¡¨ç¤ºå±‚å®ä½“ä¹‹é—´çš„é€šä¿¡ä¼šè¯ã€‚è¯¥å±‚çš„é€šä¿¡ç”±ä¸åŒè®¾å¤‡ä¸­çš„åº”ç”¨ç¨‹åºä¹‹é—´çš„æœåŠ¡è¯·æ±‚å’Œå“åº”ç»„æˆã€‚</p><h4 id="ï¼ˆ4ï¼‰ä¼ è¾“å±‚"><a href="#ï¼ˆ4ï¼‰ä¼ è¾“å±‚" class="headerlink" title="ï¼ˆ4ï¼‰ä¼ è¾“å±‚"></a>ï¼ˆ4ï¼‰ä¼ è¾“å±‚</h4><p>ä¼ è¾“å±‚å»ºç«‹äº†ä¸»æœºç«¯åˆ°ç«¯çš„é“¾æ¥ï¼Œä¼ è¾“å±‚çš„ä½œç”¨æ˜¯ä¸ºä¸Šå±‚åè®®æä¾›ç«¯åˆ°ç«¯çš„å¯é å’Œé€æ˜çš„æ•°æ®ä¼ è¾“æœåŠ¡ï¼ŒåŒ…æ‹¬å¤„ç†å·®é”™æ§åˆ¶å’Œæµé‡æ§åˆ¶ç­‰é—®é¢˜ã€‚è¯¥å±‚å‘é«˜å±‚å±è”½äº†ä¸‹å±‚æ•°æ®é€šä¿¡çš„ç»†èŠ‚ï¼Œä½¿é«˜å±‚ç”¨æˆ·çœ‹åˆ°çš„åªæ˜¯åœ¨ä¸¤ä¸ªä¼ è¾“å®ä½“é—´çš„ä¸€æ¡ä¸»æœºåˆ°ä¸»æœºçš„ã€å¯ç”±ç”¨æˆ·æ§åˆ¶å’Œè®¾å®šçš„ã€å¯é çš„æ•°æ®é€šè·¯ã€‚æˆ‘ä»¬é€šå¸¸è¯´çš„ï¼Œ<code>TCP</code> <code>UDP</code>å°±æ˜¯åœ¨è¿™ä¸€å±‚ã€‚ç«¯å£å·æ—¢æ˜¯è¿™é‡Œçš„â€œç«¯â€ã€‚</p><h4 id="ï¼ˆ5ï¼‰ç½‘ç»œå±‚"><a href="#ï¼ˆ5ï¼‰ç½‘ç»œå±‚" class="headerlink" title="ï¼ˆ5ï¼‰ç½‘ç»œå±‚"></a>ï¼ˆ5ï¼‰ç½‘ç»œå±‚</h4><p>æœ¬å±‚é€šè¿‡<code>IP</code>å¯»å€æ¥å»ºç«‹ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„è¿æ¥ï¼Œä¸ºæºç«¯çš„è¿è¾“å±‚é€æ¥çš„åˆ†ç»„ï¼Œé€‰æ‹©åˆé€‚çš„è·¯ç”±å’Œäº¤æ¢èŠ‚ç‚¹ï¼Œæ­£ç¡®æ— è¯¯åœ°æŒ‰ç…§åœ°å€ä¼ é€ç»™ç›®çš„ç«¯çš„è¿è¾“å±‚ã€‚å°±æ˜¯é€šå¸¸è¯´çš„<code>IP</code>å±‚ã€‚è¿™ä¸€å±‚å°±æ˜¯æˆ‘ä»¬ç»å¸¸è¯´çš„<code>IP</code>åè®®å±‚ã€‚<code>IP</code>åè®®æ˜¯<code>Internet</code>çš„åŸºç¡€ã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·ç†è§£ï¼Œç½‘ç»œå±‚è§„å®šäº†æ•°æ®åŒ…çš„ä¼ è¾“è·¯çº¿ï¼Œè€Œä¼ è¾“å±‚åˆ™è§„å®šäº†æ•°æ®åŒ…çš„ä¼ è¾“æ–¹å¼ã€‚</p><h4 id="ï¼ˆ6ï¼‰æ•°æ®é“¾è·¯å±‚"><a href="#ï¼ˆ6ï¼‰æ•°æ®é“¾è·¯å±‚" class="headerlink" title="ï¼ˆ6ï¼‰æ•°æ®é“¾è·¯å±‚"></a>ï¼ˆ6ï¼‰æ•°æ®é“¾è·¯å±‚</h4><p>å°†æ¯”ç‰¹ç»„åˆæˆå­—èŠ‚,å†å°†å­—èŠ‚ç»„åˆæˆå¸§,ä½¿ç”¨é“¾è·¯å±‚åœ°å€ (ä»¥å¤ªç½‘ä½¿ç”¨MACåœ°å€)æ¥è®¿é—®ä»‹è´¨,å¹¶è¿›è¡Œå·®é”™æ£€æµ‹ã€‚<br>ç½‘ç»œå±‚ä¸æ•°æ®é“¾è·¯å±‚çš„å¯¹æ¯”ï¼Œé€šè¿‡ä¸Šé¢çš„æè¿°ï¼Œæˆ‘ä»¬æˆ–è®¸å¯ä»¥è¿™æ ·ç†è§£ï¼Œç½‘ç»œå±‚æ˜¯è§„åˆ’äº†æ•°æ®åŒ…çš„ä¼ è¾“è·¯çº¿ï¼Œè€Œæ•°æ®é“¾è·¯å±‚å°±æ˜¯ä¼ è¾“è·¯çº¿ã€‚ä¸è¿‡ï¼Œåœ¨æ•°æ®é“¾è·¯å±‚ä¸Šè¿˜å¢åŠ äº†å·®é”™æ§åˆ¶çš„åŠŸèƒ½ã€‚</p><h4 id="ï¼ˆ7ï¼‰ç‰©ç†å±‚"><a href="#ï¼ˆ7ï¼‰ç‰©ç†å±‚" class="headerlink" title="ï¼ˆ7ï¼‰ç‰©ç†å±‚"></a>ï¼ˆ7ï¼‰ç‰©ç†å±‚</h4><p>å®é™…æœ€ç»ˆä¿¡å·çš„ä¼ è¾“æ˜¯é€šè¿‡ç‰©ç†å±‚å®ç°çš„ã€‚é€šè¿‡ç‰©ç†ä»‹è´¨ä¼ è¾“æ¯”ç‰¹æµã€‚è§„å®šäº†ç”µå¹³ã€é€Ÿåº¦å’Œç”µç¼†é’ˆè„šã€‚å¸¸ç”¨è®¾å¤‡æœ‰ï¼ˆå„ç§ç‰©ç†è®¾å¤‡ï¼‰é›†çº¿å™¨ã€ä¸­ç»§å™¨ã€è°ƒåˆ¶è§£è°ƒå™¨ã€ç½‘çº¿ã€åŒç»çº¿ã€åŒè½´ç”µç¼†ã€‚è¿™äº›éƒ½æ˜¯ç‰©ç†å±‚çš„ä¼ è¾“ä»‹è´¨ã€‚</p><p><strong>OSIä¸ƒå±‚æ¨¡å‹é€šä¿¡ç‰¹ç‚¹ï¼šå¯¹ç­‰é€šä¿¡</strong><br>å¯¹ç­‰é€šä¿¡ï¼Œä¸ºäº†ä½¿æ•°æ®åˆ†ç»„ä»æºä¼ é€åˆ°ç›®çš„åœ°ï¼Œæºç«¯OSIæ¨¡å‹çš„æ¯ä¸€å±‚éƒ½å¿…é¡»ä¸ç›®çš„ç«¯çš„å¯¹ç­‰å±‚è¿›è¡Œé€šä¿¡ï¼Œè¿™ç§é€šä¿¡æ–¹å¼ç§°ä¸ºå¯¹ç­‰å±‚é€šä¿¡ã€‚åœ¨æ¯ä¸€å±‚é€šä¿¡è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨æœ¬å±‚è‡ªå·±åè®®è¿›è¡Œé€šä¿¡ã€‚</p><h3 id="2-TCP-IPäº”å±‚åè®®"><a href="#2-TCP-IPäº”å±‚åè®®" class="headerlink" title="2. TCP/IPäº”å±‚åè®®"></a>2. TCP/IPäº”å±‚åè®®</h3><p><code>TCP/IP</code>äº”å±‚åè®®å’Œ<code>OSI</code>çš„ä¸ƒå±‚åè®®å¯¹åº”å…³ç³»å¦‚ä¸‹ï¼š<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/network/13.png" alt=""></p><ul><li><strong>åº”ç”¨å±‚ (application layer)</strong>ï¼šç›´æ¥ä¸ºåº”ç”¨è¿›ç¨‹æä¾›æœåŠ¡ã€‚åº”ç”¨å±‚åè®®å®šä¹‰çš„æ˜¯åº”ç”¨è¿›ç¨‹é—´é€šè®¯å’Œäº¤äº’çš„è§„åˆ™ï¼Œä¸åŒçš„åº”ç”¨æœ‰ç€ä¸åŒçš„åº”ç”¨å±‚åè®®ï¼Œå¦‚ HTTPåè®®ï¼ˆä¸‡ç»´ç½‘æœåŠ¡ï¼‰ã€FTPåè®®ï¼ˆæ–‡ä»¶ä¼ è¾“ï¼‰ã€SMTPåè®®ï¼ˆç”µå­é‚®ä»¶ï¼‰ã€DNSï¼ˆåŸŸåæŸ¥è¯¢ï¼‰ç­‰ã€‚</li><li><strong>ä¼ è¾“å±‚ (transport layer)</strong>ï¼šæœ‰æ—¶ä¹Ÿè¯‘ä¸ºè¿è¾“å±‚ï¼Œå®ƒè´Ÿè´£ä¸ºä¸¤å°ä¸»æœºä¸­çš„è¿›ç¨‹æä¾›é€šä¿¡æœåŠ¡ã€‚è¯¥å±‚ä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ç§åè®®ï¼š<ul><li>ä¼ è¾“æ§åˆ¶åè®® (Transmission Control Protocolï¼ŒTCP)ï¼šæä¾›é¢å‘è¿æ¥çš„ã€å¯é çš„æ•°æ®ä¼ è¾“æœåŠ¡ï¼Œæ•°æ®ä¼ è¾“çš„åŸºæœ¬å•ä½æ˜¯æŠ¥æ–‡æ®µï¼ˆsegmentï¼‰ï¼›</li><li>ç”¨æˆ·æ•°æ®æŠ¥åè®® (User Datagram Protocolï¼ŒUDP)ï¼šæä¾›æ— è¿æ¥çš„ã€å°½æœ€å¤§åŠªåŠ›çš„æ•°æ®ä¼ è¾“æœåŠ¡ï¼Œä½†ä¸ä¿è¯æ•°æ®ä¼ è¾“çš„å¯é æ€§ï¼Œæ•°æ®ä¼ è¾“çš„åŸºæœ¬å•ä½æ˜¯ç”¨æˆ·æ•°æ®æŠ¥ã€‚</li></ul></li><li><strong>ç½‘ç»œå±‚ (internet layer)</strong>ï¼šæœ‰æ—¶ä¹Ÿè¯‘ä¸ºç½‘é™…å±‚ï¼Œå®ƒè´Ÿè´£ä¸ºä¸¤å°ä¸»æœºæä¾›é€šä¿¡æœåŠ¡ï¼Œå¹¶é€šè¿‡é€‰æ‹©åˆé€‚çš„è·¯ç”±å°†æ•°æ®ä¼ é€’åˆ°ç›®æ ‡ä¸»æœºã€‚</li><li><strong>æ•°æ®é“¾è·¯å±‚ (data link layer)</strong>ï¼šè´Ÿè´£å°†ç½‘ç»œå±‚äº¤ä¸‹æ¥çš„ IP æ•°æ®æŠ¥å°è£…æˆå¸§ï¼Œå¹¶åœ¨é“¾è·¯çš„ä¸¤ä¸ªç›¸é‚»èŠ‚ç‚¹é—´ä¼ é€å¸§ï¼Œæ¯ä¸€å¸§éƒ½åŒ…å«æ•°æ®å’Œå¿…è¦çš„æ§åˆ¶ä¿¡æ¯ï¼ˆå¦‚åŒæ­¥ä¿¡æ¯ã€åœ°å€ä¿¡æ¯ã€å·®é”™æ§åˆ¶ç­‰ï¼‰ã€‚</li><li><strong>ç‰©ç†å±‚ (physical Layer)</strong>ï¼šç¡®ä¿æ•°æ®å¯ä»¥åœ¨å„ç§ç‰©ç†åª’ä»‹ä¸Šè¿›è¡Œä¼ è¾“ï¼Œä¸ºæ•°æ®çš„ä¼ è¾“æä¾›å¯é çš„ç¯å¢ƒã€‚</li></ul><p>ä»ä¸Šå›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œ<code>TCP/IP</code>æ¨¡å‹æ¯”<code>OSI</code>æ¨¡å‹æ›´åŠ ç®€æ´ï¼Œå®ƒæŠŠ<code>åº”ç”¨å±‚/è¡¨ç¤ºå±‚/ä¼šè¯å±‚</code>å…¨éƒ¨æ•´åˆä¸ºäº†<code>åº”ç”¨å±‚</code>ã€‚</p><p>åœ¨æ¯ä¸€å±‚éƒ½å·¥ä½œç€ä¸åŒçš„è®¾å¤‡ï¼Œæ¯”å¦‚æˆ‘ä»¬å¸¸ç”¨çš„äº¤æ¢æœºå°±å·¥ä½œåœ¨æ•°æ®é“¾è·¯å±‚çš„ï¼Œä¸€èˆ¬çš„è·¯ç”±å™¨æ˜¯å·¥ä½œåœ¨ç½‘ç»œå±‚çš„ã€‚<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/network/14.webp" alt=""><br>åœ¨æ¯ä¸€å±‚å®ç°çš„åè®®ä¹Ÿå„ä¸åŒï¼Œå³æ¯ä¸€å±‚çš„æœåŠ¡ä¹Ÿä¸åŒï¼Œä¸‹å›¾åˆ—å‡ºäº†æ¯å±‚ä¸»è¦çš„ä¼ è¾“åè®®ï¼š<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/network/15.webp" alt=""></p><p>åŒæ ·ï¼Œ<code>TCP/IP</code>äº”å±‚åè®®çš„é€šä¿¡æ–¹å¼ä¹Ÿæ˜¯å¯¹ç­‰é€šä¿¡ï¼š<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/network/16.png" alt="image.png"></p><h2 id="å…­ã€TCPä¸UDP"><a href="#å…­ã€TCPä¸UDP" class="headerlink" title="å…­ã€TCPä¸UDP"></a>å…­ã€TCPä¸UDP</h2><h3 id="1-TCP-å’Œ-UDPçš„æ¦‚å¿µåŠç‰¹ç‚¹"><a href="#1-TCP-å’Œ-UDPçš„æ¦‚å¿µåŠç‰¹ç‚¹" class="headerlink" title="1. TCP å’Œ UDPçš„æ¦‚å¿µåŠç‰¹ç‚¹"></a>1. TCP å’Œ UDPçš„æ¦‚å¿µåŠç‰¹ç‚¹</h3><p>TCP å’Œ UDPéƒ½æ˜¯ä¼ è¾“å±‚åè®®ï¼Œä»–ä»¬éƒ½å±äºTCP/IPåè®®æ—ï¼š</p><p><strong>ï¼ˆ1ï¼‰UDP</strong></p><p>UDPçš„å…¨ç§°æ˜¯<strong>ç”¨æˆ·æ•°æ®æŠ¥åè®®</strong>ï¼Œåœ¨ç½‘ç»œä¸­å®ƒä¸TCPåè®®ä¸€æ ·ç”¨äºå¤„ç†æ•°æ®åŒ…ï¼Œæ˜¯ä¸€ç§æ— è¿æ¥çš„åè®®ã€‚åœ¨OSIæ¨¡å‹ä¸­ï¼Œåœ¨ä¼ è¾“å±‚ï¼Œå¤„äºIPåè®®çš„ä¸Šä¸€å±‚ã€‚UDPæœ‰ä¸æä¾›æ•°æ®åŒ…åˆ†ç»„ã€ç»„è£…å’Œä¸èƒ½å¯¹æ•°æ®åŒ…è¿›è¡Œæ’åºçš„ç¼ºç‚¹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æŠ¥æ–‡å‘é€ä¹‹åï¼Œæ˜¯æ— æ³•å¾—çŸ¥å…¶æ˜¯å¦å®‰å…¨å®Œæ•´åˆ°è¾¾çš„ã€‚</p><p>å®ƒçš„ç‰¹ç‚¹å¦‚ä¸‹ï¼š</p><p><strong>1ï¼‰é¢å‘æ— è¿æ¥</strong></p><p>é¦–å…ˆ UDP æ˜¯ä¸éœ€è¦å’Œ TCPä¸€æ ·åœ¨å‘é€æ•°æ®å‰è¿›è¡Œä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¿æ¥çš„ï¼Œæƒ³å‘æ•°æ®å°±å¯ä»¥å¼€å§‹å‘é€äº†ã€‚å¹¶ä¸”ä¹Ÿåªæ˜¯æ•°æ®æŠ¥æ–‡çš„æ¬è¿å·¥ï¼Œä¸ä¼šå¯¹æ•°æ®æŠ¥æ–‡è¿›è¡Œä»»ä½•æ‹†åˆ†å’Œæ‹¼æ¥æ“ä½œã€‚</p><p>å…·ä½“æ¥è¯´å°±æ˜¯ï¼š</p><ul><li>åœ¨å‘é€ç«¯ï¼Œåº”ç”¨å±‚å°†æ•°æ®ä¼ é€’ç»™ä¼ è¾“å±‚çš„ UDP åè®®ï¼ŒUDP åªä¼šç»™æ•°æ®å¢åŠ ä¸€ä¸ª UDP å¤´æ ‡è¯†ä¸‹æ˜¯ UDP åè®®ï¼Œç„¶åå°±ä¼ é€’ç»™ç½‘ç»œå±‚äº†</li><li>åœ¨æ¥æ”¶ç«¯ï¼Œç½‘ç»œå±‚å°†æ•°æ®ä¼ é€’ç»™ä¼ è¾“å±‚ï¼ŒUDP åªå»é™¤ IP æŠ¥æ–‡å¤´å°±ä¼ é€’ç»™åº”ç”¨å±‚ï¼Œä¸ä¼šä»»ä½•æ‹¼æ¥æ“ä½œ</li></ul><p><strong>2ï¼‰æœ‰å•æ’­ï¼Œå¤šæ’­ï¼Œå¹¿æ’­çš„åŠŸèƒ½</strong></p><p>UDP ä¸æ­¢æ”¯æŒä¸€å¯¹ä¸€çš„ä¼ è¾“æ–¹å¼ï¼ŒåŒæ ·æ”¯æŒä¸€å¯¹å¤šï¼Œå¤šå¯¹å¤šï¼Œå¤šå¯¹ä¸€çš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯è¯´ UDP æä¾›äº†å•æ’­ï¼Œå¤šæ’­ï¼Œå¹¿æ’­çš„åŠŸèƒ½ã€‚</p><p><strong>3ï¼‰é¢å‘æŠ¥æ–‡</strong></p><p>å‘é€æ–¹çš„UDPå¯¹åº”ç”¨ç¨‹åºäº¤ä¸‹æ¥çš„æŠ¥æ–‡ï¼Œåœ¨æ·»åŠ é¦–éƒ¨åå°±å‘ä¸‹äº¤ä»˜IPå±‚ã€‚UDPå¯¹åº”ç”¨å±‚äº¤ä¸‹æ¥çš„æŠ¥æ–‡ï¼Œæ—¢ä¸åˆå¹¶ï¼Œä¹Ÿä¸æ‹†åˆ†ï¼Œè€Œæ˜¯ä¿ç•™è¿™äº›æŠ¥æ–‡çš„è¾¹ç•Œã€‚å› æ­¤ï¼Œåº”ç”¨ç¨‹åºå¿…é¡»é€‰æ‹©åˆé€‚å¤§å°çš„æŠ¥æ–‡</p><p><strong>4ï¼‰ä¸å¯é æ€§</strong></p><p>é¦–å…ˆä¸å¯é æ€§ä½“ç°åœ¨æ— è¿æ¥ä¸Šï¼Œé€šä¿¡éƒ½ä¸éœ€è¦å»ºç«‹è¿æ¥ï¼Œæƒ³å‘å°±å‘ï¼Œè¿™æ ·çš„æƒ…å†µè‚¯å®šä¸å¯é ã€‚</p><p>å¹¶ä¸”æ”¶åˆ°ä»€ä¹ˆæ•°æ®å°±ä¼ é€’ä»€ä¹ˆæ•°æ®ï¼Œå¹¶ä¸”ä¹Ÿä¸ä¼šå¤‡ä»½æ•°æ®ï¼Œå‘é€æ•°æ®ä¹Ÿä¸ä¼šå…³å¿ƒå¯¹æ–¹æ˜¯å¦å·²ç»æ­£ç¡®æ¥æ”¶åˆ°æ•°æ®äº†ã€‚</p><p>å†è€…ç½‘ç»œç¯å¢ƒæ—¶å¥½æ—¶åï¼Œä½†æ˜¯ UDP å› ä¸ºæ²¡æœ‰æ‹¥å¡æ§åˆ¶ï¼Œä¸€ç›´ä¼šä»¥æ’å®šçš„é€Ÿåº¦å‘é€æ•°æ®ã€‚å³ä½¿ç½‘ç»œæ¡ä»¶ä¸å¥½ï¼Œä¹Ÿä¸ä¼šå¯¹å‘é€é€Ÿç‡è¿›è¡Œè°ƒæ•´ã€‚è¿™æ ·å®ç°çš„å¼Šç«¯å°±æ˜¯åœ¨ç½‘ç»œæ¡ä»¶ä¸å¥½çš„æƒ…å†µä¸‹å¯èƒ½ä¼šå¯¼è‡´ä¸¢åŒ…ï¼Œä½†æ˜¯ä¼˜ç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œåœ¨æŸäº›å®æ—¶æ€§è¦æ±‚é«˜çš„åœºæ™¯ï¼ˆæ¯”å¦‚ç”µè¯ä¼šè®®ï¼‰å°±éœ€è¦ä½¿ç”¨ UDP è€Œä¸æ˜¯ TCPã€‚</p><p><strong>5ï¼‰å¤´éƒ¨å¼€é”€å°ï¼Œä¼ è¾“æ•°æ®æŠ¥æ–‡æ—¶æ˜¯å¾ˆé«˜æ•ˆçš„ã€‚</strong><br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/network/17.png" alt=""></p><p>UDP å¤´éƒ¨åŒ…å«äº†ä»¥ä¸‹å‡ ä¸ªæ•°æ®ï¼š</p><ul><li>ä¸¤ä¸ªåå…­ä½çš„ç«¯å£å·ï¼Œåˆ†åˆ«ä¸ºæºç«¯å£ï¼ˆå¯é€‰å­—æ®µï¼‰å’Œç›®æ ‡ç«¯å£</li><li>æ•´ä¸ªæ•°æ®æŠ¥æ–‡çš„é•¿åº¦</li><li>æ•´ä¸ªæ•°æ®æŠ¥æ–‡çš„æ£€éªŒå’Œï¼ˆIPv4 å¯é€‰å­—æ®µï¼‰ï¼Œè¯¥å­—æ®µç”¨äºå‘ç°å¤´éƒ¨ä¿¡æ¯å’Œæ•°æ®ä¸­çš„é”™è¯¯</li></ul><p>å› æ­¤ UDP çš„å¤´éƒ¨å¼€é”€å°ï¼Œåªæœ‰8å­—èŠ‚ï¼Œç›¸æ¯” TCP çš„è‡³å°‘20å­—èŠ‚è¦å°‘å¾—å¤šï¼Œåœ¨ä¼ è¾“æ•°æ®æŠ¥æ–‡æ—¶æ˜¯å¾ˆé«˜æ•ˆçš„ã€‚</p><p><strong>ï¼ˆ2ï¼‰TCP</strong><br>TCPçš„å…¨ç§°æ˜¯ä¼ è¾“æ§åˆ¶åè®®æ˜¯ä¸€ç§é¢å‘è¿æ¥çš„ã€å¯é çš„ã€åŸºäºå­—èŠ‚æµçš„ä¼ è¾“å±‚é€šä¿¡åè®®ã€‚TCP æ˜¯é¢å‘è¿æ¥çš„ã€å¯é çš„æµåè®®ï¼ˆæµå°±æ˜¯æŒ‡ä¸é—´æ–­çš„æ•°æ®ç»“æ„ï¼‰ã€‚</p><p>å®ƒæœ‰ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼š</p><p><strong>1ï¼‰é¢å‘è¿æ¥</strong></p><p>é¢å‘è¿æ¥ï¼Œæ˜¯æŒ‡å‘é€æ•°æ®ä¹‹å‰å¿…é¡»åœ¨ä¸¤ç«¯å»ºç«‹è¿æ¥ã€‚å»ºç«‹è¿æ¥çš„æ–¹æ³•æ˜¯â€œä¸‰æ¬¡æ¡æ‰‹â€ï¼Œè¿™æ ·èƒ½å»ºç«‹å¯é çš„è¿æ¥ã€‚å»ºç«‹è¿æ¥ï¼Œæ˜¯ä¸ºæ•°æ®çš„å¯é ä¼ è¾“æ‰“ä¸‹äº†åŸºç¡€ã€‚</p><p><strong>2ï¼‰ä»…æ”¯æŒå•æ’­ä¼ è¾“</strong></p><p>æ¯æ¡TCPä¼ è¾“è¿æ¥åªèƒ½æœ‰ä¸¤ä¸ªç«¯ç‚¹ï¼Œåªèƒ½è¿›è¡Œç‚¹å¯¹ç‚¹çš„æ•°æ®ä¼ è¾“ï¼Œä¸æ”¯æŒå¤šæ’­å’Œå¹¿æ’­ä¼ è¾“æ–¹å¼ã€‚</p><p><strong>3ï¼‰é¢å‘å­—èŠ‚æµ</strong></p><p>TCPä¸åƒUDPä¸€æ ·é‚£æ ·ä¸€ä¸ªä¸ªæŠ¥æ–‡ç‹¬ç«‹åœ°ä¼ è¾“ï¼Œè€Œæ˜¯åœ¨ä¸ä¿ç•™æŠ¥æ–‡è¾¹ç•Œçš„æƒ…å†µä¸‹ä»¥å­—èŠ‚æµæ–¹å¼è¿›è¡Œä¼ è¾“ã€‚</p><p><strong>4ï¼‰å¯é ä¼ è¾“</strong></p><p>å¯¹äºå¯é ä¼ è¾“ï¼Œåˆ¤æ–­ä¸¢åŒ…ã€è¯¯ç é çš„æ˜¯TCPçš„æ®µç¼–å·ä»¥åŠç¡®è®¤å·ã€‚TCPä¸ºäº†ä¿è¯æŠ¥æ–‡ä¼ è¾“çš„å¯é ï¼Œå°±ç»™æ¯ä¸ªåŒ…ä¸€ä¸ªåºå·ï¼ŒåŒæ—¶åºå·ä¹Ÿä¿è¯äº†ä¼ é€åˆ°æ¥æ”¶ç«¯å®ä½“çš„åŒ…çš„æŒ‰åºæ¥æ”¶ã€‚ç„¶åæ¥æ”¶ç«¯å®ä½“å¯¹å·²æˆåŠŸæ”¶åˆ°çš„å­—èŠ‚å‘å›ä¸€ä¸ªç›¸åº”çš„ç¡®è®¤(ACK)ï¼›å¦‚æœå‘é€ç«¯å®ä½“åœ¨åˆç†çš„å¾€è¿”æ—¶å»¶(RTT)å†…æœªæ”¶åˆ°ç¡®è®¤ï¼Œé‚£ä¹ˆå¯¹åº”çš„æ•°æ®ï¼ˆå‡è®¾ä¸¢å¤±äº†ï¼‰å°†ä¼šè¢«é‡ä¼ ã€‚</p><p><strong>5ï¼‰æä¾›æ‹¥å¡æ§åˆ¶</strong></p><p>å½“ç½‘ç»œå‡ºç°æ‹¥å¡çš„æ—¶å€™ï¼ŒTCPèƒ½å¤Ÿå‡å°å‘ç½‘ç»œæ³¨å…¥æ•°æ®çš„é€Ÿç‡å’Œæ•°é‡ï¼Œç¼“è§£æ‹¥å¡ã€‚</p><p><strong>6ï¼‰æä¾›å…¨åŒå·¥é€šä¿¡</strong></p><p>TCPå…è®¸é€šä¿¡åŒæ–¹çš„åº”ç”¨ç¨‹åºåœ¨ä»»ä½•æ—¶å€™éƒ½èƒ½å‘é€æ•°æ®ï¼Œå› ä¸ºTCPè¿æ¥çš„ä¸¤ç«¯éƒ½è®¾æœ‰ç¼“å­˜ï¼Œç”¨æ¥ä¸´æ—¶å­˜æ”¾åŒå‘é€šä¿¡çš„æ•°æ®ã€‚å½“ç„¶ï¼ŒTCPå¯ä»¥ç«‹å³å‘é€ä¸€ä¸ªæ•°æ®æ®µï¼Œä¹Ÿå¯ä»¥ç¼“å­˜ä¸€æ®µæ—¶é—´ä»¥ä¾¿ä¸€æ¬¡å‘é€æ›´å¤šçš„æ•°æ®æ®µï¼ˆæœ€å¤§çš„æ•°æ®æ®µå¤§å°å–å†³äºMSSï¼‰</p><h3 id="2-TCPå’ŒUDPçš„åŒºåˆ«"><a href="#2-TCPå’ŒUDPçš„åŒºåˆ«" class="headerlink" title="2. TCPå’ŒUDPçš„åŒºåˆ«"></a>2. TCPå’ŒUDPçš„åŒºåˆ«</h3><table><thead><tr><th></th><th>UDP</th><th>TCP</th></tr></thead><tbody><tr><td>æ˜¯å¦è¿æ¥</td><td>æ— è¿æ¥</td><td>é¢å‘è¿æ¥</td></tr><tr><td>æ˜¯å¦å¯é </td><td>ä¸å¯é ä¼ è¾“ï¼Œä¸ä½¿ç”¨æµé‡æ§åˆ¶å’Œæ‹¥å¡æ§åˆ¶</td><td>å¯é ä¼ è¾“ï¼ˆæ•°æ®é¡ºåºå’Œæ­£ç¡®æ€§ï¼‰ï¼Œä½¿ç”¨æµé‡æ§åˆ¶å’Œæ‹¥å¡æ§åˆ¶</td></tr><tr><td>è¿æ¥å¯¹è±¡ä¸ªæ•°</td><td>æ”¯æŒä¸€å¯¹ä¸€ï¼Œä¸€å¯¹å¤šï¼Œå¤šå¯¹ä¸€å’Œå¤šå¯¹å¤šäº¤äº’é€šä¿¡</td><td>åªèƒ½æ˜¯ä¸€å¯¹ä¸€é€šä¿¡</td></tr><tr><td>ä¼ è¾“æ–¹å¼</td><td>é¢å‘æŠ¥æ–‡</td><td>é¢å‘å­—èŠ‚æµ</td></tr><tr><td>é¦–éƒ¨å¼€é”€</td><td>é¦–éƒ¨å¼€é”€å°ï¼Œä»…8å­—èŠ‚</td><td>é¦–éƒ¨æœ€å°20å­—èŠ‚ï¼Œæœ€å¤§60å­—èŠ‚</td></tr><tr><td>é€‚ç”¨åœºæ™¯</td><td>é€‚ç”¨äºå®æ—¶åº”ç”¨ï¼Œä¾‹å¦‚è§†é¢‘ä¼šè®®ã€ç›´æ’­</td><td>é€‚ç”¨äºè¦æ±‚å¯é ä¼ è¾“çš„åº”ç”¨ï¼Œä¾‹å¦‚æ–‡ä»¶ä¼ è¾“</td></tr></tbody></table><h3 id="3-TCPå’ŒUDPçš„ä½¿ç”¨åœºæ™¯"><a href="#3-TCPå’ŒUDPçš„ä½¿ç”¨åœºæ™¯" class="headerlink" title="3. TCPå’ŒUDPçš„ä½¿ç”¨åœºæ™¯"></a>3. TCPå’ŒUDPçš„ä½¿ç”¨åœºæ™¯</h3><ul><li><strong>TCPåº”ç”¨åœºæ™¯ï¼š</strong> æ•ˆç‡è¦æ±‚ç›¸å¯¹ä½ï¼Œä½†å¯¹å‡†ç¡®æ€§è¦æ±‚ç›¸å¯¹é«˜çš„åœºæ™¯ã€‚å› ä¸ºä¼ è¾“ä¸­éœ€è¦å¯¹æ•°æ®ç¡®è®¤ã€é‡å‘ã€æ’åºç­‰æ“ä½œï¼Œç›¸æ¯”ä¹‹ä¸‹æ•ˆç‡æ²¡æœ‰UDPé«˜ã€‚ä¾‹å¦‚ï¼šæ–‡ä»¶ä¼ è¾“ï¼ˆå‡†ç¡®é«˜è¦æ±‚é«˜ã€ä½†æ˜¯é€Ÿåº¦å¯ä»¥ç›¸å¯¹æ…¢ï¼‰ã€æ¥å—é‚®ä»¶ã€è¿œç¨‹ç™»å½•ã€‚</li><li><strong>UDPåº”ç”¨åœºæ™¯ï¼š</strong> æ•ˆç‡è¦æ±‚ç›¸å¯¹é«˜ï¼Œå¯¹å‡†ç¡®æ€§è¦æ±‚ç›¸å¯¹ä½çš„åœºæ™¯ã€‚ä¾‹å¦‚ï¼šQQèŠå¤©ã€åœ¨çº¿è§†é¢‘ã€ç½‘ç»œè¯­éŸ³ç”µè¯ï¼ˆå³æ—¶é€šè®¯ï¼Œé€Ÿåº¦è¦æ±‚é«˜ï¼Œä½†æ˜¯å‡ºç°å¶å°”æ–­ç»­ä¸æ˜¯å¤ªå¤§é—®é¢˜ï¼Œå¹¶ä¸”æ­¤å¤„å®Œå…¨ä¸å¯ä»¥ä½¿ç”¨é‡å‘æœºåˆ¶ï¼‰ã€å¹¿æ’­é€šä¿¡ï¼ˆå¹¿æ’­ã€å¤šæ’­ï¼‰ã€‚</li></ul><h3 id="4-UDPåè®®ä¸ºä»€ä¹ˆä¸å¯é ï¼Ÿ"><a href="#4-UDPåè®®ä¸ºä»€ä¹ˆä¸å¯é ï¼Ÿ" class="headerlink" title="4. UDPåè®®ä¸ºä»€ä¹ˆä¸å¯é ï¼Ÿ"></a>4. UDPåè®®ä¸ºä»€ä¹ˆä¸å¯é ï¼Ÿ</h3><p>UDPåœ¨ä¼ è¾“æ•°æ®ä¹‹å‰ä¸éœ€è¦å…ˆå»ºç«‹è¿æ¥ï¼Œè¿œåœ°ä¸»æœºçš„è¿è¾“å±‚åœ¨æ¥æ”¶åˆ°UDPæŠ¥æ–‡åï¼Œä¸éœ€è¦ç¡®è®¤ï¼Œæä¾›ä¸å¯é äº¤ä»˜ã€‚æ€»ç»“å°±ä»¥ä¸‹å››ç‚¹ï¼š</p><ul><li>ä¸ä¿è¯æ¶ˆæ¯äº¤ä»˜ï¼šä¸ç¡®è®¤ï¼Œä¸é‡ä¼ ï¼Œæ— è¶…æ—¶</li><li>ä¸ä¿è¯äº¤ä»˜é¡ºåºï¼šä¸è®¾ç½®åŒ…åºå·ï¼Œä¸é‡æ’ï¼Œä¸ä¼šå‘ç”Ÿé˜Ÿé¦–é˜»å¡</li><li>ä¸è·Ÿè¸ªè¿æ¥çŠ¶æ€ï¼šä¸å¿…å»ºç«‹è¿æ¥æˆ–é‡å¯çŠ¶æ€æœº</li><li>ä¸è¿›è¡Œæ‹¥å¡æ§åˆ¶ï¼šä¸å†…ç½®å®¢æˆ·ç«¯æˆ–ç½‘ç»œåé¦ˆæœºåˆ¶</li></ul><h3 id="5-TCPçš„é‡ä¼ æœºåˆ¶"><a href="#5-TCPçš„é‡ä¼ æœºåˆ¶" class="headerlink" title="5. TCPçš„é‡ä¼ æœºåˆ¶"></a>5. TCPçš„é‡ä¼ æœºåˆ¶</h3><p>ç”±äºTCPçš„ä¸‹å±‚ç½‘ç»œï¼ˆç½‘ç»œå±‚ï¼‰å¯èƒ½å‡ºç°<strong>ä¸¢å¤±ã€é‡å¤æˆ–å¤±åº</strong>çš„æƒ…å†µï¼ŒTCPåè®®æä¾›å¯é æ•°æ®ä¼ è¾“æœåŠ¡ã€‚ä¸ºä¿è¯æ•°æ®ä¼ è¾“çš„æ­£ç¡®æ€§ï¼ŒTCPä¼šé‡ä¼ å…¶è®¤ä¸ºå·²ä¸¢å¤±ï¼ˆåŒ…æ‹¬æŠ¥æ–‡ä¸­çš„æ¯”ç‰¹é”™è¯¯ï¼‰çš„åŒ…ã€‚TCPä½¿ç”¨ä¸¤å¥—ç‹¬ç«‹çš„æœºåˆ¶æ¥å®Œæˆé‡ä¼ ï¼Œä¸€æ˜¯<strong>åŸºäºæ—¶é—´</strong>ï¼ŒäºŒæ˜¯<strong>åŸºäºç¡®è®¤ä¿¡æ¯</strong>ã€‚</p><p>TCPåœ¨å‘é€ä¸€ä¸ªæ•°æ®ä¹‹åï¼Œå°±å¼€å¯ä¸€ä¸ªå®šæ—¶å™¨ï¼Œè‹¥æ˜¯åœ¨è¿™ä¸ªæ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°å‘é€æ•°æ®çš„ACKç¡®è®¤æŠ¥æ–‡ï¼Œåˆ™å¯¹è¯¥æŠ¥æ–‡è¿›è¡Œé‡ä¼ ï¼Œåœ¨è¾¾åˆ°ä¸€å®šæ¬¡æ•°è¿˜æ²¡æœ‰æˆåŠŸæ—¶æ”¾å¼ƒå¹¶å‘é€ä¸€ä¸ªå¤ä½ä¿¡å·ã€‚</p><h3 id="6-TCPçš„æ‹¥å¡æ§åˆ¶æœºåˆ¶"><a href="#6-TCPçš„æ‹¥å¡æ§åˆ¶æœºåˆ¶" class="headerlink" title="6. TCPçš„æ‹¥å¡æ§åˆ¶æœºåˆ¶"></a>6. TCPçš„æ‹¥å¡æ§åˆ¶æœºåˆ¶</h3><p>TCPçš„æ‹¥å¡æ§åˆ¶æœºåˆ¶ä¸»è¦æ˜¯ä»¥ä¸‹å››ç§æœºåˆ¶ï¼š</p><ul><li>æ…¢å¯åŠ¨ï¼ˆæ…¢å¼€å§‹ï¼‰</li><li>æ‹¥å¡é¿å…</li><li>å¿«é€Ÿé‡ä¼ </li><li>å¿«é€Ÿæ¢å¤</li></ul><p><strong>ï¼ˆ1ï¼‰æ…¢å¯åŠ¨ï¼ˆæ…¢å¼€å§‹ï¼‰</strong></p><ul><li>åœ¨å¼€å§‹å‘é€çš„æ—¶å€™è®¾ç½®cwnd = 1ï¼ˆcwndæŒ‡çš„æ˜¯æ‹¥å¡çª—å£ï¼‰</li><li>æ€è·¯ï¼šå¼€å§‹çš„æ—¶å€™ä¸è¦å‘é€å¤§é‡æ•°æ®ï¼Œè€Œæ˜¯å…ˆæµ‹è¯•ä¸€ä¸‹ç½‘ç»œçš„æ‹¥å¡ç¨‹åº¦ï¼Œç”±å°åˆ°å¤§å¢åŠ æ‹¥å¡çª—å£çš„å¤§å°ã€‚</li><li>ä¸ºäº†é˜²æ­¢cwndå¢é•¿è¿‡å¤§å¼•èµ·ç½‘ç»œæ‹¥å¡ï¼Œè®¾ç½®ä¸€ä¸ªæ…¢å¼€å§‹é—¨é™(ssthresh çŠ¶æ€å˜é‡)<ul><li>å½“cnwd &lt; ssthreshï¼Œä½¿ç”¨æ…¢å¼€å§‹ç®—æ³•</li><li>å½“cnwd = ssthreshï¼Œæ—¢å¯ä½¿ç”¨æ…¢å¼€å§‹ç®—æ³•ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ‹¥å¡é¿å…ç®—æ³•</li><li>å½“cnwd &gt; ssthreshï¼Œä½¿ç”¨æ‹¥å¡é¿å…ç®—æ³•</li></ul></li></ul><p><strong>ï¼ˆ2ï¼‰æ‹¥å¡é¿å…</strong></p><ul><li>æ‹¥å¡é¿å…æœªå¿…èƒ½å¤Ÿå®Œå…¨é¿å…æ‹¥å¡ï¼Œæ˜¯è¯´åœ¨æ‹¥å¡é¿å…é˜¶æ®µå°†æ‹¥å¡çª—å£æ§åˆ¶ä¸ºæŒ‰çº¿æ€§å¢é•¿ï¼Œä½¿ç½‘ç»œä¸å®¹æ˜“å‡ºç°é˜»å¡ã€‚</li><li>æ€è·¯ï¼š è®©æ‹¥å¡çª—å£cwndç¼“æ…¢çš„å¢å¤§ï¼Œå³æ¯ç»è¿‡ä¸€ä¸ªè¿”å›æ—¶é—´RTTå°±æŠŠå‘é€æ–¹çš„æ‹¥å¡æ§åˆ¶çª—å£åŠ ä¸€</li><li>æ— è®ºæ˜¯åœ¨æ…¢å¼€å§‹é˜¶æ®µè¿˜æ˜¯åœ¨æ‹¥å¡é¿å…é˜¶æ®µï¼Œåªè¦å‘é€æ–¹åˆ¤æ–­ç½‘ç»œå‡ºç°æ‹¥å¡ï¼Œå°±æŠŠæ…¢å¼€å§‹é—¨é™è®¾ç½®ä¸ºå‡ºç°æ‹¥å¡æ—¶çš„å‘é€çª—å£å¤§å°çš„ä¸€åŠã€‚ç„¶åæŠŠæ‹¥å¡çª—å£è®¾ç½®ä¸º1ï¼Œæ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•ã€‚å¦‚å›¾æ‰€ç¤º:<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/network/18.png" alt=""><br>å…¶ä¸­ï¼Œåˆ¤æ–­ç½‘ç»œå‡ºç°æ‹¥å¡çš„æ ¹æ®å°±æ˜¯æ²¡æœ‰æ”¶åˆ°ç¡®è®¤ï¼Œè™½ç„¶æ²¡æœ‰æ”¶åˆ°ç¡®è®¤å¯èƒ½æ˜¯å…¶ä»–åŸå› çš„åˆ†ç»„ä¸¢å¤±ï¼Œä½†æ˜¯å› ä¸ºæ— æ³•åˆ¤å®šï¼Œæ‰€ä»¥éƒ½å½“åšæ‹¥å¡æ¥å¤„ç†ã€‚</li></ul><p><strong>ï¼ˆ3ï¼‰å¿«é€Ÿé‡ä¼ </strong></p><ul><li>å¿«é‡ä¼ è¦æ±‚æ¥æ”¶æ–¹åœ¨æ”¶åˆ°ä¸€ä¸ªå¤±åºçš„æŠ¥æ–‡æ®µåå°±ç«‹å³å‘å‡ºé‡å¤ç¡®è®¤(ä¸ºçš„æ˜¯ä½¿å‘é€æ–¹åŠæ—©çŸ¥é“æœ‰æŠ¥æ–‡æ®µæ²¡æœ‰åˆ°è¾¾å¯¹æ–¹)ã€‚å‘é€æ–¹åªè¦è¿ç»­æ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤å°±ç«‹å³é‡ä¼ å¯¹æ–¹å°šæœªæ”¶åˆ°çš„æŠ¥æ–‡æ®µï¼Œè€Œä¸å¿…ç»§ç»­ç­‰å¾…è®¾ç½®çš„é‡ä¼ è®¡æ—¶å™¨æ—¶é—´åˆ°æœŸã€‚</li><li>ç”±äºä¸éœ€è¦ç­‰å¾…è®¾ç½®çš„é‡ä¼ è®¡æ—¶å™¨åˆ°æœŸï¼Œèƒ½å°½æ—©é‡ä¼ æœªè¢«ç¡®è®¤çš„æŠ¥æ–‡æ®µï¼Œèƒ½æé«˜æ•´ä¸ªç½‘ç»œçš„ååé‡</li></ul><p><strong>ï¼ˆ4ï¼‰å¿«é€Ÿæ¢å¤</strong></p><ul><li>å½“å‘é€æ–¹è¿ç»­æ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤æ—¶ï¼Œå°±æ‰§è¡Œâ€œä¹˜æ³•å‡å°â€ç®—æ³•ï¼ŒæŠŠssthreshé—¨é™å‡åŠã€‚ä½†æ˜¯æ¥ä¸‹å»å¹¶ä¸æ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•ã€‚</li><li>è€ƒè™‘åˆ°å¦‚æœç½‘ç»œå‡ºç°æ‹¥å¡çš„è¯å°±ä¸ä¼šæ”¶åˆ°å¥½å‡ ä¸ªé‡å¤çš„ç¡®è®¤ï¼Œæ‰€ä»¥å‘é€æ–¹ç°åœ¨è®¤ä¸ºç½‘ç»œå¯èƒ½æ²¡æœ‰å‡ºç°æ‹¥å¡ã€‚æ‰€ä»¥æ­¤æ—¶ä¸æ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•ï¼Œè€Œæ˜¯å°†cwndè®¾ç½®ä¸ºssthreshçš„å¤§å°ï¼Œç„¶åæ‰§è¡Œæ‹¥å¡é¿å…ç®—æ³•ã€‚<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/network/19.png" alt=""></li></ul><h3 id="7-TCPçš„æµé‡æ§åˆ¶æœºåˆ¶"><a href="#7-TCPçš„æµé‡æ§åˆ¶æœºåˆ¶" class="headerlink" title="7. TCPçš„æµé‡æ§åˆ¶æœºåˆ¶"></a>7. TCPçš„æµé‡æ§åˆ¶æœºåˆ¶</h3><p>ä¸€èˆ¬æ¥è¯´ï¼Œæµé‡æ§åˆ¶å°±æ˜¯ä¸ºäº†è®©å‘é€æ–¹å‘é€æ•°æ®çš„é€Ÿåº¦ä¸è¦å¤ªå¿«ï¼Œè¦è®©æ¥æ”¶æ–¹æ¥å¾—åŠæ¥æ”¶ã€‚TCPé‡‡ç”¨å¤§å°å¯å˜çš„<strong>æ»‘åŠ¨çª—å£</strong>è¿›è¡Œæµé‡æ§åˆ¶ï¼Œçª—å£å¤§å°çš„å•ä½æ˜¯å­—èŠ‚ã€‚è¿™é‡Œè¯´çš„çª—å£å¤§å°å…¶å®å°±æ˜¯æ¯æ¬¡ä¼ è¾“çš„æ•°æ®å¤§å°ã€‚</p><ul><li>å½“ä¸€ä¸ªè¿æ¥å»ºç«‹æ—¶ï¼Œè¿æ¥çš„æ¯ä¸€ç«¯åˆ†é…ä¸€ä¸ªç¼“å†²åŒºæ¥ä¿å­˜è¾“å…¥çš„æ•°æ®ï¼Œå¹¶å°†ç¼“å†²åŒºçš„å¤§å°å‘é€ç»™å¦ä¸€ç«¯ã€‚</li><li>å½“æ•°æ®åˆ°è¾¾æ—¶ï¼Œæ¥æ”¶æ–¹å‘é€ç¡®è®¤ï¼Œå…¶ä¸­åŒ…å«äº†è‡ªå·±å‰©ä½™çš„ç¼“å†²åŒºå¤§å°ã€‚ï¼ˆå‰©ä½™çš„ç¼“å†²åŒºç©ºé—´çš„å¤§å°è¢«ç§°ä¸ºçª—å£ï¼ŒæŒ‡å‡ºçª—å£å¤§å°çš„é€šçŸ¥ç§°ä¸ºçª—å£é€šå‘Š ã€‚æ¥æ”¶æ–¹åœ¨å‘é€çš„æ¯ä¸€ç¡®è®¤ä¸­éƒ½å«æœ‰ä¸€ä¸ªçª—å£é€šå‘Šã€‚ï¼‰</li><li>å¦‚æœæ¥æ”¶æ–¹åº”ç”¨ç¨‹åºè¯»æ•°æ®çš„é€Ÿåº¦èƒ½å¤Ÿä¸æ•°æ®åˆ°è¾¾çš„é€Ÿåº¦ä¸€æ ·å¿«ï¼Œæ¥æ”¶æ–¹å°†åœ¨æ¯ä¸€ç¡®è®¤ä¸­å‘é€ä¸€ä¸ªæ­£çš„çª—å£é€šå‘Šã€‚</li><li>å¦‚æœå‘é€æ–¹æ“ä½œçš„é€Ÿåº¦å¿«äºæ¥æ”¶æ–¹ï¼Œæ¥æ”¶åˆ°çš„æ•°æ®æœ€ç»ˆå°†å……æ»¡æ¥æ”¶æ–¹çš„ç¼“å†²åŒºï¼Œå¯¼è‡´æ¥æ”¶æ–¹é€šå‘Šä¸€ä¸ªé›¶çª—å£ ã€‚å‘é€æ–¹æ”¶åˆ°ä¸€ä¸ªé›¶çª—å£é€šå‘Šæ—¶ï¼Œå¿…é¡»åœæ­¢å‘é€ï¼Œç›´åˆ°æ¥æ”¶æ–¹é‡æ–°é€šå‘Šä¸€ä¸ªæ­£çš„çª—å£ã€‚</li></ul><h3 id="8-TCPçš„å¯é ä¼ è¾“æœºåˆ¶"><a href="#8-TCPçš„å¯é ä¼ è¾“æœºåˆ¶" class="headerlink" title="8. TCPçš„å¯é ä¼ è¾“æœºåˆ¶"></a>8. TCPçš„å¯é ä¼ è¾“æœºåˆ¶</h3><p>TCP çš„å¯é ä¼ è¾“æœºåˆ¶æ˜¯åŸºäºè¿ç»­ ARQ åè®®å’Œæ»‘åŠ¨çª—å£åè®®çš„ã€‚</p><p>TCP åè®®åœ¨å‘é€æ–¹ç»´æŒäº†ä¸€ä¸ªå‘é€çª—å£ï¼Œå‘é€çª—å£ä»¥å‰çš„æŠ¥æ–‡æ®µæ˜¯å·²ç»å‘é€å¹¶ç¡®è®¤äº†çš„æŠ¥æ–‡æ®µï¼Œå‘é€çª—å£ä¸­åŒ…å«äº†å·²ç»å‘é€ä½† æœªç¡®è®¤çš„æŠ¥æ–‡æ®µå’Œå…è®¸å‘é€ä½†è¿˜æœªå‘é€çš„æŠ¥æ–‡æ®µï¼Œå‘é€çª—å£ä»¥åçš„æŠ¥æ–‡æ®µæ˜¯ç¼“å­˜ä¸­è¿˜ä¸å…è®¸å‘é€çš„æŠ¥æ–‡æ®µã€‚å½“å‘é€æ–¹å‘æ¥æ”¶æ–¹å‘ é€æŠ¥æ–‡æ—¶ï¼Œä¼šä¾æ¬¡å‘é€çª—å£å†…çš„æ‰€æœ‰æŠ¥æ–‡æ®µï¼Œå¹¶ä¸”è®¾ç½®ä¸€ä¸ªå®šæ—¶å™¨ï¼Œè¿™ä¸ªå®šæ—¶å™¨å¯ä»¥ç†è§£ä¸ºæ˜¯æœ€æ—©å‘é€ä½†æœªæ”¶åˆ°ç¡®è®¤çš„æŠ¥æ–‡æ®µã€‚ å¦‚æœåœ¨å®šæ—¶å™¨çš„æ—¶é—´å†…æ”¶åˆ°æŸä¸€ä¸ªæŠ¥æ–‡æ®µçš„ç¡®è®¤å›ç­”ï¼Œåˆ™æ»‘åŠ¨çª—å£ï¼Œå°†çª—å£çš„é¦–éƒ¨å‘åæ»‘åŠ¨åˆ°ç¡®è®¤æŠ¥æ–‡æ®µçš„åä¸€ä¸ªä½ç½®ï¼Œæ­¤æ—¶å¦‚ æœè¿˜æœ‰å·²å‘é€ä½†æ²¡æœ‰ç¡®è®¤çš„æŠ¥æ–‡æ®µï¼Œåˆ™é‡æ–°è®¾ç½®å®šæ—¶å™¨ï¼Œå¦‚æœæ²¡æœ‰äº†åˆ™å…³é—­å®šæ—¶å™¨ã€‚å¦‚æœå®šæ—¶å™¨è¶…æ—¶ï¼Œåˆ™é‡æ–°å‘é€æ‰€æœ‰å·²ç»å‘é€ ä½†è¿˜æœªæ”¶åˆ°ç¡®è®¤çš„æŠ¥æ–‡æ®µï¼Œå¹¶å°†è¶…æ—¶çš„é—´éš”è®¾ç½®ä¸ºä»¥å‰çš„ä¸¤å€ã€‚å½“å‘é€æ–¹æ”¶åˆ°æ¥æ”¶æ–¹çš„ä¸‰ä¸ªå†—ä½™çš„ç¡®è®¤åº”ç­”åï¼Œè¿™æ˜¯ä¸€ç§æŒ‡ç¤ºï¼Œ è¯´æ˜è¯¥æŠ¥æ–‡æ®µä»¥åçš„æŠ¥æ–‡æ®µå¾ˆæœ‰å¯èƒ½å‘ç”Ÿä¸¢å¤±äº†ï¼Œé‚£ä¹ˆå‘é€æ–¹ä¼šå¯ç”¨å¿«é€Ÿé‡ä¼ çš„æœºåˆ¶ï¼Œå°±æ˜¯å½“å‰å®šæ—¶å™¨ç»“æŸå‰ï¼Œå‘é€æ‰€æœ‰çš„å·²å‘ é€ä½†ç¡®è®¤çš„æŠ¥æ–‡æ®µã€‚</p><p>æ¥æ”¶æ–¹ä½¿ç”¨çš„æ˜¯ç´¯è®¡ç¡®è®¤çš„æœºåˆ¶ï¼Œå¯¹äºæ‰€æœ‰æŒ‰åºåˆ°è¾¾çš„æŠ¥æ–‡æ®µï¼Œæ¥æ”¶æ–¹è¿”å›ä¸€ä¸ªæŠ¥æ–‡æ®µçš„è‚¯å®šå›ç­”ã€‚å¦‚æœæ”¶åˆ°äº†ä¸€ä¸ªä¹±åºçš„æŠ¥æ–‡ æ®µï¼Œé‚£ä¹ˆæ¥æ–¹ä¼šç›´æ¥ä¸¢å¼ƒï¼Œå¹¶è¿”å›ä¸€ä¸ªæœ€è¿‘çš„æŒ‰åºåˆ°è¾¾çš„æŠ¥æ–‡æ®µçš„è‚¯å®šå›ç­”ã€‚ä½¿ç”¨ç´¯è®¡ç¡®è®¤ä¿è¯äº†è¿”å›çš„ç¡®è®¤å·ä¹‹å‰çš„æŠ¥æ–‡æ®µéƒ½ å·²ç»æŒ‰åºåˆ°è¾¾äº†ï¼Œæ‰€ä»¥å‘é€çª—å£å¯ä»¥ç§»åŠ¨åˆ°å·²ç¡®è®¤æŠ¥æ–‡æ®µçš„åé¢ã€‚</p><p>å‘é€çª—å£çš„å¤§å°æ˜¯å˜åŒ–çš„ï¼Œå®ƒæ˜¯ç”±æ¥æ”¶çª—å£å‰©ä½™å¤§å°å’Œç½‘ç»œä¸­æ‹¥å¡ç¨‹åº¦æ¥å†³å®šçš„ï¼ŒTCP å°±æ˜¯é€šè¿‡æ§åˆ¶å‘é€çª—å£çš„é•¿åº¦æ¥æ§åˆ¶æŠ¥æ–‡ æ®µçš„å‘é€é€Ÿç‡ã€‚</p><p>ä½†æ˜¯ TCP åè®®å¹¶ä¸å®Œå…¨å’Œæ»‘åŠ¨çª—å£åè®®ç›¸åŒï¼Œå› ä¸ºè®¸å¤šçš„ TCP å®ç°ä¼šå°†å¤±åºçš„æŠ¥æ–‡æ®µç»™ç¼“å­˜èµ·æ¥ï¼Œå¹¶ä¸”å‘ç”Ÿé‡ä¼ æ—¶ï¼Œåªä¼šé‡ ä¼ ä¸€ä¸ªæŠ¥æ–‡æ®µï¼Œå› æ­¤ TCP åè®®çš„å¯é ä¼ è¾“æœºåˆ¶æ›´åƒæ˜¯çª—å£æ»‘åŠ¨åè®®å’Œé€‰æ‹©é‡ä¼ åè®®çš„ä¸€ä¸ªæ··åˆä½“ã€‚</p><h3 id="9-TCPçš„ä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹"><a href="#9-TCPçš„ä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹" class="headerlink" title="9. TCPçš„ä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹"></a>9. TCPçš„ä¸‰æ¬¡æ¡æ‰‹å’Œå››æ¬¡æŒ¥æ‰‹</h3><h4 id="ï¼ˆ1ï¼‰ä¸‰æ¬¡æ¡æ‰‹"><a href="#ï¼ˆ1ï¼‰ä¸‰æ¬¡æ¡æ‰‹" class="headerlink" title="ï¼ˆ1ï¼‰ä¸‰æ¬¡æ¡æ‰‹"></a>ï¼ˆ1ï¼‰ä¸‰æ¬¡æ¡æ‰‹</h4><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/network/20.png" alt=""><br>ä¸‰æ¬¡æ¡æ‰‹ï¼ˆThree-way Handshakeï¼‰å…¶å®å°±æ˜¯æŒ‡å»ºç«‹ä¸€ä¸ªTCPè¿æ¥æ—¶ï¼Œéœ€è¦å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨æ€»å…±å‘é€3ä¸ªåŒ…ã€‚è¿›è¡Œä¸‰æ¬¡æ¡æ‰‹çš„ä¸»è¦ä½œç”¨å°±æ˜¯ä¸ºäº†ç¡®è®¤åŒæ–¹çš„æ¥æ”¶èƒ½åŠ›å’Œå‘é€èƒ½åŠ›æ˜¯å¦æ­£å¸¸ã€æŒ‡å®šè‡ªå·±çš„åˆå§‹åŒ–åºåˆ—å·ä¸ºåé¢çš„å¯é æ€§ä¼ é€åšå‡†å¤‡ã€‚å®è´¨ä¸Šå…¶å®å°±æ˜¯è¿æ¥æœåŠ¡å™¨æŒ‡å®šç«¯å£ï¼Œå»ºç«‹TCPè¿æ¥ï¼Œå¹¶åŒæ­¥è¿æ¥åŒæ–¹çš„åºåˆ—å·å’Œç¡®è®¤å·ï¼Œäº¤æ¢TCPçª—å£å¤§å°ä¿¡æ¯ã€‚</p><p>åˆšå¼€å§‹å®¢æˆ·ç«¯å¤„äº Closed çš„çŠ¶æ€ï¼ŒæœåŠ¡ç«¯å¤„äº Listen çŠ¶æ€ã€‚</p><ul><li>ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯ç»™æœåŠ¡ç«¯å‘ä¸€ä¸ª SYN æŠ¥æ–‡ï¼Œå¹¶æŒ‡æ˜å®¢æˆ·ç«¯çš„åˆå§‹åŒ–åºåˆ—å· ISNï¼Œæ­¤æ—¶å®¢æˆ·ç«¯å¤„äº SYN_SEND çŠ¶æ€ã€‚</li></ul><blockquote><p>é¦–éƒ¨çš„åŒæ­¥ä½SYN=1ï¼Œåˆå§‹åºå·seq=xï¼ŒSYN=1çš„æŠ¥æ–‡æ®µä¸èƒ½æºå¸¦æ•°æ®ï¼Œä½†è¦æ¶ˆè€—æ‰ä¸€ä¸ªåºå·ã€‚</p></blockquote><ul><li>ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šæœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯çš„ SYN æŠ¥æ–‡ä¹‹åï¼Œä¼šä»¥è‡ªå·±çš„ SYN æŠ¥æ–‡ä½œä¸ºåº”ç­”ï¼Œå¹¶ä¸”ä¹Ÿæ˜¯æŒ‡å®šäº†è‡ªå·±çš„åˆå§‹åŒ–åºåˆ—å· ISNã€‚åŒæ—¶ä¼šæŠŠå®¢æˆ·ç«¯çš„ ISN + 1 ä½œä¸ºACK çš„å€¼ï¼Œè¡¨ç¤ºè‡ªå·±å·²ç»æ”¶åˆ°äº†å®¢æˆ·ç«¯çš„ SYNï¼Œæ­¤æ—¶æœåŠ¡å™¨å¤„äº SYN_REVD çš„çŠ¶æ€ã€‚</li></ul><blockquote><p>åœ¨ç¡®è®¤æŠ¥æ–‡æ®µä¸­SYN=1ï¼ŒACK=1ï¼Œç¡®è®¤å·ack=x+1ï¼Œåˆå§‹åºå·seq=y</p></blockquote><ul><li>ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯æ”¶åˆ° SYN æŠ¥æ–‡ä¹‹åï¼Œä¼šå‘é€ä¸€ä¸ª ACK æŠ¥æ–‡ï¼Œå½“ç„¶ï¼Œä¹Ÿæ˜¯ä¸€æ ·æŠŠæœåŠ¡å™¨çš„ ISN + 1 ä½œä¸º ACK çš„å€¼ï¼Œè¡¨ç¤ºå·²ç»æ”¶åˆ°äº†æœåŠ¡ç«¯çš„ SYN æŠ¥æ–‡ï¼Œæ­¤æ—¶å®¢æˆ·ç«¯å¤„äº ESTABLISHED çŠ¶æ€ã€‚æœåŠ¡å™¨æ”¶åˆ° ACK æŠ¥æ–‡ä¹‹åï¼Œä¹Ÿå¤„äº ESTABLISHED çŠ¶æ€ï¼Œæ­¤æ—¶ï¼ŒåŒæ–¹å·²å»ºç«‹èµ·äº†è¿æ¥ã€‚</li></ul><blockquote><p>ç¡®è®¤æŠ¥æ–‡æ®µACK=1ï¼Œç¡®è®¤å·ack=y+1ï¼Œåºå·seq=x+1ï¼ˆåˆå§‹ä¸ºseq=xï¼Œç¬¬äºŒä¸ªæŠ¥æ–‡æ®µæ‰€ä»¥è¦+1ï¼‰ï¼ŒACKæŠ¥æ–‡æ®µå¯ä»¥æºå¸¦æ•°æ®ï¼Œä¸æºå¸¦æ•°æ®åˆ™ä¸æ¶ˆè€—åºå·ã€‚</p></blockquote><p><strong>é‚£ä¸ºä»€ä¹ˆè¦ä¸‰æ¬¡æ¡æ‰‹å‘¢ï¼Ÿä¸¤æ¬¡ä¸è¡Œå—ï¼Ÿ</strong></p><ul><li>ä¸ºäº†ç¡®è®¤åŒæ–¹çš„æ¥æ”¶èƒ½åŠ›å’Œå‘é€èƒ½åŠ›éƒ½æ­£å¸¸</li><li>å¦‚æœæ˜¯ç”¨ä¸¤æ¬¡æ¡æ‰‹ï¼Œåˆ™ä¼šå‡ºç°ä¸‹é¢è¿™ç§æƒ…å†µï¼š</li></ul><blockquote><p>å¦‚å®¢æˆ·ç«¯å‘å‡ºè¿æ¥è¯·æ±‚ï¼Œä½†å› è¿æ¥è¯·æ±‚æŠ¥æ–‡ä¸¢å¤±è€Œæœªæ”¶åˆ°ç¡®è®¤ï¼Œäºæ˜¯å®¢æˆ·ç«¯å†é‡ä¼ ä¸€æ¬¡è¿æ¥è¯·æ±‚ã€‚åæ¥æ”¶åˆ°äº†ç¡®è®¤ï¼Œå»ºç«‹äº†è¿æ¥ã€‚æ•°æ®ä¼ è¾“å®Œæ¯•åï¼Œå°±é‡Šæ”¾äº†è¿æ¥ï¼Œå®¢æˆ·ç«¯å…±å‘å‡ºäº†ä¸¤ä¸ªè¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªä¸¢å¤±ï¼Œç¬¬äºŒä¸ªåˆ°è¾¾äº†æœåŠ¡ç«¯ï¼Œä½†æ˜¯ç¬¬ä¸€ä¸ªä¸¢å¤±çš„æŠ¥æ–‡æ®µåªæ˜¯åœ¨æŸäº›ç½‘ç»œç»“ç‚¹é•¿æ—¶é—´æ»ç•™äº†ï¼Œå»¶è¯¯åˆ°è¿æ¥é‡Šæ”¾ä»¥åçš„æŸä¸ªæ—¶é—´æ‰åˆ°è¾¾æœåŠ¡ç«¯ï¼Œæ­¤æ—¶æœåŠ¡ç«¯è¯¯è®¤ä¸ºå®¢æˆ·ç«¯åˆå‘å‡ºä¸€æ¬¡æ–°çš„è¿æ¥è¯·æ±‚ï¼Œäºæ˜¯å°±å‘å®¢æˆ·ç«¯å‘å‡ºç¡®è®¤æŠ¥æ–‡æ®µï¼ŒåŒæ„å»ºç«‹è¿æ¥ï¼Œä¸é‡‡ç”¨ä¸‰æ¬¡æ¡æ‰‹ï¼Œåªè¦æœåŠ¡ç«¯å‘å‡ºç¡®è®¤ï¼Œå°±å»ºç«‹æ–°çš„è¿æ¥äº†ï¼Œæ­¤æ—¶å®¢æˆ·ç«¯å¿½ç•¥æœåŠ¡ç«¯å‘æ¥çš„ç¡®è®¤ï¼Œä¹Ÿä¸å‘é€æ•°æ®ï¼Œåˆ™æœåŠ¡ç«¯ä¸€è‡´ç­‰å¾…å®¢æˆ·ç«¯å‘é€æ•°æ®ï¼Œæµªè´¹èµ„æºã€‚</p></blockquote><p><strong>ç®€å•æ¥è¯´å°±æ˜¯ä»¥ä¸‹ä¸‰æ­¥ï¼š</strong></p><ul><li><strong>ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼š</strong> å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µã€‚è¯¥æŠ¥æ–‡æ®µä¸­åŒ…å«è‡ªèº«çš„æ•°æ®é€šè®¯åˆå§‹åºå·ã€‚è¯·æ±‚å‘é€åï¼Œå®¢æˆ·ç«¯ä¾¿è¿›å…¥ SYN-SENT çŠ¶æ€ã€‚</li><li><strong>ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼š</strong> æœåŠ¡ç«¯æ”¶åˆ°è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µåï¼Œå¦‚æœåŒæ„è¿æ¥ï¼Œåˆ™ä¼šå‘é€ä¸€ä¸ªåº”ç­”ï¼Œè¯¥åº”ç­”ä¸­ä¹Ÿä¼šåŒ…å«è‡ªèº«çš„æ•°æ®é€šè®¯åˆå§‹åºå·ï¼Œå‘é€å®Œæˆåä¾¿è¿›å…¥ SYN-RECEIVED çŠ¶æ€ã€‚</li><li><strong>ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼š</strong> å½“å®¢æˆ·ç«¯æ”¶åˆ°è¿æ¥åŒæ„çš„åº”ç­”åï¼Œè¿˜è¦å‘æœåŠ¡ç«¯å‘é€ä¸€ä¸ªç¡®è®¤æŠ¥æ–‡ã€‚å®¢æˆ·ç«¯å‘å®Œè¿™ä¸ªæŠ¥æ–‡æ®µåä¾¿è¿›å…¥ ESTABLISHED çŠ¶æ€ï¼ŒæœåŠ¡ç«¯æ”¶åˆ°è¿™ä¸ªåº”ç­”åä¹Ÿè¿›å…¥ ESTABLISHED çŠ¶æ€ï¼Œæ­¤æ—¶è¿æ¥å»ºç«‹æˆåŠŸã€‚</li></ul><p>TCP ä¸‰æ¬¡æ¡æ‰‹çš„å»ºç«‹è¿æ¥çš„è¿‡ç¨‹å°±æ˜¯ç›¸äº’ç¡®è®¤åˆå§‹åºå·çš„è¿‡ç¨‹ï¼Œå‘Šè¯‰å¯¹æ–¹ï¼Œä»€ä¹ˆæ ·åºå·çš„æŠ¥æ–‡æ®µèƒ½å¤Ÿè¢«æ­£ç¡®æ¥æ”¶ã€‚ ç¬¬ä¸‰æ¬¡æ¡æ‰‹çš„ä½œç”¨æ˜¯å®¢æˆ·ç«¯å¯¹æœåŠ¡å™¨ç«¯çš„åˆå§‹åºå·çš„ç¡®è®¤ã€‚å¦‚æœåªä½¿ç”¨ä¸¤æ¬¡æ¡æ‰‹ï¼Œé‚£ä¹ˆæœåŠ¡å™¨å°±æ²¡æœ‰åŠæ³•çŸ¥é“è‡ªå·±çš„åºå·æ˜¯å¦ å·²è¢«ç¡®è®¤ã€‚åŒæ—¶è¿™æ ·ä¹Ÿæ˜¯ä¸ºäº†é˜²æ­¢å¤±æ•ˆçš„è¯·æ±‚æŠ¥æ–‡æ®µè¢«æœåŠ¡å™¨æ¥æ”¶ï¼Œè€Œå‡ºç°é”™è¯¯çš„æƒ…å†µã€‚</p><h4 id="ï¼ˆ2ï¼‰å››æ¬¡æŒ¥æ‰‹"><a href="#ï¼ˆ2ï¼‰å››æ¬¡æŒ¥æ‰‹" class="headerlink" title="ï¼ˆ2ï¼‰å››æ¬¡æŒ¥æ‰‹"></a>ï¼ˆ2ï¼‰å››æ¬¡æŒ¥æ‰‹</h4><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/network/21.png" alt=""><br>åˆšå¼€å§‹åŒæ–¹éƒ½å¤„äº ESTABLISHED çŠ¶æ€ï¼Œå‡å¦‚æ˜¯å®¢æˆ·ç«¯å…ˆå‘èµ·å…³é—­è¯·æ±‚ã€‚å››æ¬¡æŒ¥æ‰‹çš„è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ul><li>ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ï¼š å®¢æˆ·ç«¯ä¼šå‘é€ä¸€ä¸ª FIN æŠ¥æ–‡ï¼ŒæŠ¥æ–‡ä¸­ä¼šæŒ‡å®šä¸€ä¸ªåºåˆ—å·ã€‚æ­¤æ—¶å®¢æˆ·ç«¯å¤„äº FIN_WAIT1 çŠ¶æ€ã€‚</li></ul><blockquote><p>å³å‘å‡ºè¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µï¼ˆFIN=1ï¼Œåºå·seq=uï¼‰ï¼Œå¹¶åœæ­¢å†å‘é€æ•°æ®ï¼Œä¸»åŠ¨å…³é—­TCPè¿æ¥ï¼Œè¿›å…¥FIN_WAIT1ï¼ˆç»ˆæ­¢ç­‰å¾…1ï¼‰çŠ¶æ€ï¼Œç­‰å¾…æœåŠ¡ç«¯çš„ç¡®è®¤ã€‚</p></blockquote><ul><li>ç¬¬äºŒæ¬¡æŒ¥æ‰‹ï¼šæœåŠ¡ç«¯æ”¶åˆ° FIN ä¹‹åï¼Œä¼šå‘é€ ACK æŠ¥æ–‡ï¼Œä¸”æŠŠå®¢æˆ·ç«¯çš„åºåˆ—å·å€¼ +1 ä½œä¸º ACK æŠ¥æ–‡çš„åºåˆ—å·å€¼ï¼Œè¡¨æ˜å·²ç»æ”¶åˆ°å®¢æˆ·ç«¯çš„æŠ¥æ–‡äº†ï¼Œæ­¤æ—¶æœåŠ¡ç«¯å¤„äº CLOSE_WAIT çŠ¶æ€ã€‚</li></ul><blockquote><p>å³æœåŠ¡ç«¯æ”¶åˆ°è¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µåå³å‘å‡ºç¡®è®¤æŠ¥æ–‡æ®µï¼ˆACK=1ï¼Œç¡®è®¤å·ack=u+1ï¼Œåºå·seq=vï¼‰ï¼ŒæœåŠ¡ç«¯è¿›å…¥CLOSE_WAITï¼ˆå…³é—­ç­‰å¾…ï¼‰çŠ¶æ€ï¼Œæ­¤æ—¶çš„TCPå¤„äºåŠå…³é—­çŠ¶æ€ï¼Œå®¢æˆ·ç«¯åˆ°æœåŠ¡ç«¯çš„è¿æ¥é‡Šæ”¾ã€‚å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡ç«¯çš„ç¡®è®¤åï¼Œè¿›å…¥FIN_WAIT2ï¼ˆç»ˆæ­¢ç­‰å¾…2ï¼‰çŠ¶æ€ï¼Œç­‰å¾…æœåŠ¡ç«¯å‘å‡ºçš„è¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µã€‚</p></blockquote><ul><li>ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹ï¼šå¦‚æœæœåŠ¡ç«¯ä¹Ÿæƒ³æ–­å¼€è¿æ¥äº†ï¼Œå’Œå®¢æˆ·ç«¯çš„ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ä¸€æ ·ï¼Œå‘ç»™ FIN æŠ¥æ–‡ï¼Œä¸”æŒ‡å®šä¸€ä¸ªåºåˆ—å·ã€‚æ­¤æ—¶æœåŠ¡ç«¯å¤„äº LAST_ACK çš„çŠ¶æ€ã€‚</li></ul><blockquote><p>å³æœåŠ¡ç«¯æ²¡æœ‰è¦å‘å®¢æˆ·ç«¯å‘å‡ºçš„æ•°æ®ï¼ŒæœåŠ¡ç«¯å‘å‡ºè¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µï¼ˆFIN=1ï¼ŒACK=1ï¼Œåºå·seq=wï¼Œç¡®è®¤å·ack=u+1ï¼‰ï¼ŒæœåŠ¡ç«¯è¿›å…¥LAST_ACKï¼ˆæœ€åç¡®è®¤ï¼‰çŠ¶æ€ï¼Œç­‰å¾…å®¢æˆ·ç«¯çš„ç¡®è®¤ã€‚</p></blockquote><ul><li>ç¬¬å››æ¬¡æŒ¥æ‰‹ï¼šå®¢æˆ·ç«¯æ”¶åˆ° FIN ä¹‹åï¼Œä¸€æ ·å‘é€ä¸€ä¸ª ACK æŠ¥æ–‡ä½œä¸ºåº”ç­”ï¼Œä¸”æŠŠæœåŠ¡ç«¯çš„åºåˆ—å·å€¼ +1 ä½œä¸ºè‡ªå·± ACK æŠ¥æ–‡çš„åºåˆ—å·å€¼ï¼Œæ­¤æ—¶å®¢æˆ·ç«¯å¤„äº TIME_WAIT çŠ¶æ€ã€‚éœ€è¦è¿‡ä¸€é˜µå­ä»¥ç¡®ä¿æœåŠ¡ç«¯æ”¶åˆ°è‡ªå·±çš„ ACK æŠ¥æ–‡ä¹‹åæ‰ä¼šè¿›å…¥ CLOSED çŠ¶æ€ï¼ŒæœåŠ¡ç«¯æ”¶åˆ° ACK æŠ¥æ–‡ä¹‹åï¼Œå°±å¤„äºå…³é—­è¿æ¥äº†ï¼Œå¤„äº CLOSED çŠ¶æ€ã€‚</li></ul><blockquote><p>å³å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡ç«¯çš„è¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µåï¼Œå¯¹æ­¤å‘å‡ºç¡®è®¤æŠ¥æ–‡æ®µï¼ˆACK=1ï¼Œseq=u+1ï¼Œack=w+1ï¼‰ï¼Œå®¢æˆ·ç«¯è¿›å…¥TIME_WAITï¼ˆæ—¶é—´ç­‰å¾…ï¼‰çŠ¶æ€ã€‚æ­¤æ—¶TCPæœªé‡Šæ”¾æ‰ï¼Œéœ€è¦ç»è¿‡æ—¶é—´ç­‰å¾…è®¡æ—¶å™¨è®¾ç½®çš„æ—¶é—´2MSLåï¼Œå®¢æˆ·ç«¯æ‰è¿›å…¥CLOSEDçŠ¶æ€ã€‚</p></blockquote><p><strong>é‚£ä¸ºä»€ä¹ˆéœ€è¦å››æ¬¡æŒ¥æ‰‹å‘¢ï¼Ÿ</strong></p><blockquote><p>å› ä¸ºå½“æœåŠ¡ç«¯æ”¶åˆ°å®¢æˆ·ç«¯çš„SYNè¿æ¥è¯·æ±‚æŠ¥æ–‡åï¼Œå¯ä»¥ç›´æ¥å‘é€SYN+ACKæŠ¥æ–‡ã€‚å…¶ä¸­ACKæŠ¥æ–‡æ˜¯ç”¨æ¥åº”ç­”çš„ï¼ŒSYNæŠ¥æ–‡æ˜¯ç”¨æ¥åŒæ­¥çš„ã€‚ä½†æ˜¯å…³é—­è¿æ¥æ—¶ï¼Œå½“æœåŠ¡ç«¯æ”¶åˆ°FINæŠ¥æ–‡æ—¶ï¼Œå¾ˆå¯èƒ½å¹¶ä¸ä¼šç«‹å³å…³é—­SOCKETï¼Œæ‰€ä»¥åªèƒ½å…ˆå›å¤ä¸€ä¸ªACKæŠ¥æ–‡ï¼Œå‘Šè¯‰å®¢æˆ·ç«¯ï¼Œâ€œä½ å‘çš„FINæŠ¥æ–‡æˆ‘æ”¶åˆ°äº†â€ã€‚åªæœ‰ç­‰åˆ°æˆ‘æœåŠ¡ç«¯æ‰€æœ‰çš„æŠ¥æ–‡éƒ½å‘é€å®Œäº†ï¼Œæˆ‘æ‰èƒ½å‘é€FINæŠ¥æ–‡ï¼Œå› æ­¤ä¸èƒ½ä¸€èµ·å‘é€ï¼Œæ•…éœ€è¦å››æ¬¡æŒ¥æ‰‹ã€‚</p></blockquote><p><strong>ç®€å•æ¥è¯´å°±æ˜¯ä»¥ä¸‹å››æ­¥ï¼š</strong></p><ul><li><strong>ç¬¬ä¸€æ¬¡æŒ¥æ‰‹ï¼š</strong> è‹¥å®¢æˆ·ç«¯è®¤ä¸ºæ•°æ®å‘é€å®Œæˆï¼Œåˆ™å®ƒéœ€è¦å‘æœåŠ¡ç«¯å‘é€è¿æ¥é‡Šæ”¾è¯·æ±‚ã€‚</li><li><strong>ç¬¬äºŒæ¬¡æŒ¥æ‰‹</strong>ï¼šæœåŠ¡ç«¯æ”¶åˆ°è¿æ¥é‡Šæ”¾è¯·æ±‚åï¼Œä¼šå‘Šè¯‰åº”ç”¨å±‚è¦é‡Šæ”¾ TCP é“¾æ¥ã€‚ç„¶åä¼šå‘é€ ACK åŒ…ï¼Œå¹¶è¿›å…¥ CLOSE_WAIT çŠ¶æ€ï¼Œæ­¤æ—¶è¡¨æ˜å®¢æˆ·ç«¯åˆ°æœåŠ¡ç«¯çš„è¿æ¥å·²ç»é‡Šæ”¾ï¼Œä¸å†æ¥æ”¶å®¢æˆ·ç«¯å‘çš„æ•°æ®äº†ã€‚ä½†æ˜¯å› ä¸º TCP è¿æ¥æ˜¯åŒå‘çš„ï¼Œæ‰€ä»¥æœåŠ¡ç«¯ä»æ—§å¯ä»¥å‘é€æ•°æ®ç»™å®¢æˆ·ç«¯ã€‚</li><li><strong>ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹</strong>ï¼šæœåŠ¡ç«¯å¦‚æœæ­¤æ—¶è¿˜æœ‰æ²¡å‘å®Œçš„æ•°æ®ä¼šç»§ç»­å‘é€ï¼Œå®Œæ¯•åä¼šå‘å®¢æˆ·ç«¯å‘é€è¿æ¥é‡Šæ”¾è¯·æ±‚ï¼Œç„¶åæœåŠ¡ç«¯ä¾¿è¿›å…¥ LAST-ACK çŠ¶æ€ã€‚</li><li><strong>ç¬¬å››æ¬¡æŒ¥æ‰‹ï¼š</strong> å®¢æˆ·ç«¯æ”¶åˆ°é‡Šæ”¾è¯·æ±‚åï¼Œå‘æœåŠ¡ç«¯å‘é€ç¡®è®¤åº”ç­”ï¼Œæ­¤æ—¶å®¢æˆ·ç«¯è¿›å…¥ TIME-WAIT çŠ¶æ€ã€‚è¯¥çŠ¶æ€ä¼šæŒç»­ 2MSLï¼ˆæœ€å¤§æ®µç”Ÿå­˜æœŸï¼ŒæŒ‡æŠ¥æ–‡æ®µåœ¨ç½‘ç»œä¸­ç”Ÿå­˜çš„æ—¶é—´ï¼Œè¶…æ—¶ä¼šè¢«æŠ›å¼ƒï¼‰ æ—¶é—´ï¼Œè‹¥è¯¥æ—¶é—´æ®µå†…æ²¡æœ‰æœåŠ¡ç«¯çš„é‡å‘è¯·æ±‚çš„è¯ï¼Œå°±è¿›å…¥ CLOSED çŠ¶æ€ã€‚å½“æœåŠ¡ç«¯æ”¶åˆ°ç¡®è®¤åº”ç­”åï¼Œä¹Ÿä¾¿è¿›å…¥ CLOSED çŠ¶æ€ã€‚</li></ul><p>TCP ä½¿ç”¨å››æ¬¡æŒ¥æ‰‹çš„åŸå› æ˜¯å› ä¸º TCP çš„è¿æ¥æ˜¯å…¨åŒå·¥çš„ï¼Œæ‰€ä»¥éœ€è¦åŒæ–¹åˆ†åˆ«é‡Šæ”¾åˆ°å¯¹æ–¹çš„è¿æ¥ï¼Œå•ç‹¬ä¸€æ–¹çš„è¿æ¥é‡Šæ”¾ï¼Œåªä»£ è¡¨ä¸èƒ½å†å‘å¯¹æ–¹å‘é€æ•°æ®ï¼Œè¿æ¥å¤„äºçš„æ˜¯åŠé‡Šæ”¾çš„çŠ¶æ€ã€‚</p><p>æœ€åä¸€æ¬¡æŒ¥æ‰‹ä¸­ï¼Œå®¢æˆ·ç«¯ä¼šç­‰å¾…ä¸€æ®µæ—¶é—´å†å…³é—­çš„åŸå› ï¼Œæ˜¯ä¸ºäº†é˜²æ­¢å‘é€ç»™æœåŠ¡å™¨çš„ç¡®è®¤æŠ¥æ–‡æ®µä¸¢å¤±æˆ–è€…å‡ºé”™ï¼Œä»è€Œå¯¼è‡´æœåŠ¡å™¨ ç«¯ä¸èƒ½æ­£å¸¸å…³é—­ã€‚</p><h3 id="10-TCPç²˜åŒ…æ˜¯æ€ä¹ˆå›äº‹ï¼Œå¦‚ä½•å¤„ç†"><a href="#10-TCPç²˜åŒ…æ˜¯æ€ä¹ˆå›äº‹ï¼Œå¦‚ä½•å¤„ç†" class="headerlink" title="10. TCPç²˜åŒ…æ˜¯æ€ä¹ˆå›äº‹ï¼Œå¦‚ä½•å¤„ç†?"></a>10. TCPç²˜åŒ…æ˜¯æ€ä¹ˆå›äº‹ï¼Œå¦‚ä½•å¤„ç†?</h3><p>é»˜è®¤æƒ…å†µä¸‹, TCP è¿æ¥ä¼šå¯â½¤å»¶è¿Ÿä¼ é€ç®—æ³• (Nagle ç®—æ³•), åœ¨æ•°æ®å‘é€ä¹‹å‰ç¼“å­˜ä»–ä»¬. å¦‚æœçŸ­æ—¶é—´æœ‰å¤šä¸ªæ•°æ®å‘é€, ä¼šç¼“å†²åˆ°â¼€èµ·ä½œâ¼€æ¬¡å‘é€ (ç¼“å†²â¼¤â¼©â»… socket.bufferSize ), è¿™æ ·å¯ä»¥å‡å°‘ IO æ¶ˆè€—æâ¾¼æ€§èƒ½. </p><p>å¦‚æœæ˜¯ä¼ è¾“â½‚ä»¶çš„è¯, é‚£ä¹ˆæ ¹æœ¬ä¸â½¤å¤„ç†ç²˜åŒ…çš„é—®é¢˜, æ¥â¼€ä¸ªåŒ…æ‹¼â¼€ä¸ªåŒ…å°±å¥½äº†ã€‚ä½†æ˜¯å¦‚æœæ˜¯å¤šæ¡æ¶ˆæ¯, æˆ–è€…æ˜¯åˆ«çš„â½¤é€”çš„æ•°æ®é‚£ä¹ˆå°±éœ€è¦å¤„ç†ç²˜åŒ…. </p><p>ä¸‹é¢çœ‹â¼€ä¸ªä¾‹â¼¦, è¿ç»­è°ƒâ½¤ä¸¤æ¬¡ send åˆ†åˆ«å‘é€ä¸¤æ®µæ•°æ® data1 å’Œ data2, åœ¨æ¥æ”¶ç«¯æœ‰ä»¥ä¸‹â¼ç§å¸¸â»…çš„æƒ…å†µ:<br>A. å…ˆæ¥æ”¶åˆ° data1, ç„¶åæ¥æ”¶åˆ° data2 .<br>B. å…ˆæ¥æ”¶åˆ° data1 çš„éƒ¨åˆ†æ•°æ®, ç„¶åæ¥æ”¶åˆ° data1 ä½™ä¸‹çš„éƒ¨åˆ†ä»¥åŠ data2 çš„å…¨éƒ¨.<br>C. å…ˆæ¥æ”¶åˆ°äº† data1 çš„å…¨éƒ¨æ•°æ®å’Œ data2 çš„éƒ¨åˆ†æ•°æ®, ç„¶åæ¥æ”¶åˆ°äº† data2 çš„ä½™ä¸‹çš„æ•°æ®.<br>D. â¼€æ¬¡æ€§æ¥æ”¶åˆ°äº† data1 å’Œ data2 çš„å…¨éƒ¨æ•°æ®. </p><p>å…¶ä¸­çš„ BCD å°±æ˜¯æˆ‘ä»¬å¸¸â»…çš„ç²˜åŒ…çš„æƒ…å†µ. â½½å¯¹äºå¤„ç†ç²˜åŒ…çš„é—®é¢˜, å¸¸â»…çš„è§£å†³â½…æ¡ˆæœ‰: </p><ul><li><strong>å¤šæ¬¡å‘é€ä¹‹å‰é—´éš”â¼€ä¸ªç­‰å¾…æ—¶é—´</strong>ï¼šåªéœ€è¦ç­‰ä¸Šâ¼€æ®µæ—¶é—´å†è¿›â¾ä¸‹â¼€æ¬¡ send å°±å¥½, é€‚â½¤äºäº¤äº’é¢‘ç‡ç‰¹åˆ«ä½çš„åœºæ™¯. ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾, å¯¹äºâ½è¾ƒé¢‘ç¹çš„åœºæ™¯â½½â¾”ä¼ è¾“æ•ˆç‡å®åœ¨å¤ªä½ï¼Œä¸è¿‡â¼ä¹ä¸â½¤åšä»€ä¹ˆå¤„ç†. </li><li><strong>å…³é—­ Nagle ç®—æ³•</strong>ï¼šå…³é—­ Nagle ç®—æ³•, åœ¨ Node.js ä¸­ä½ å¯ä»¥é€šè¿‡ socket.setNoDelay() â½…æ³•æ¥å…³é—­ Nagle ç®—æ³•, è®©æ¯â¼€æ¬¡ send éƒ½ä¸ç¼“å†²ç›´æ¥å‘é€ã€‚è¯¥â½…æ³•â½è¾ƒé€‚â½¤äºæ¯æ¬¡å‘é€çš„æ•°æ®éƒ½â½è¾ƒâ¼¤ (ä½†ä¸æ˜¯â½‚ä»¶é‚£ä¹ˆâ¼¤), å¹¶ä¸”é¢‘ç‡ä¸æ˜¯ç‰¹åˆ«â¾¼çš„åœºæ™¯ã€‚å¦‚æœæ˜¯æ¯æ¬¡å‘é€çš„æ•°æ®é‡â½è¾ƒâ¼©, å¹¶ä¸”é¢‘ç‡ç‰¹åˆ«â¾¼çš„, å…³é—­ Nagle çº¯å±â¾ƒåºŸæ­¦åŠŸã€‚å¦å¤–, è¯¥â½…æ³•ä¸é€‚â½¤äºâ½¹ç»œè¾ƒå·®çš„æƒ…å†µ, å› ä¸º Nagle ç®—æ³•æ˜¯åœ¨æœåŠ¡ç«¯è¿›â¾çš„åŒ…åˆå¹¶æƒ…å†µ, ä½†æ˜¯å¦‚æœçŸ­æ—¶é—´å†…å®¢æˆ·ç«¯çš„â½¹ç»œæƒ…å†µä¸å¥½, æˆ–è€…åº”â½¤å±‚ç”±äºæŸäº›åŸå› ä¸èƒ½åŠæ—¶å°† TCP çš„æ•°æ® recv, å°±ä¼šé€ æˆå¤šä¸ªåŒ…åœ¨å®¢æˆ·ç«¯ç¼“å†²ä»â½½ç²˜åŒ…çš„æƒ…å†µã€‚ (å¦‚æœæ˜¯åœ¨ç¨³å®šçš„æœºæˆ¿å†…éƒ¨é€šä¿¡é‚£ä¹ˆè¿™ä¸ªæ¦‚ç‡æ˜¯â½è¾ƒâ¼©å¯ä»¥é€‰æ‹©å¿½ç•¥çš„)  </li><li><strong>è¿›â¾å°åŒ…/æ‹†åŒ…ï¼š</strong> å°åŒ…/æ‹†åŒ…æ˜¯â½¬å‰ä¸šå†…å¸¸â»…çš„è§£å†³â½…æ¡ˆäº†ã€‚å³ç»™æ¯ä¸ªæ•°æ®åŒ…åœ¨å‘é€ä¹‹å‰, äºå…¶å‰/åæ”¾â¼€äº›æœ‰ç‰¹å¾çš„æ•°æ®, ç„¶åæ”¶åˆ°æ•°æ®çš„æ—¶ å€™æ ¹æ®ç‰¹å¾æ•°æ®åˆ†å‰²å‡ºæ¥å„ä¸ªæ•°æ®åŒ…ã€‚</li></ul><h3 id="11-ä¸ºä»€ä¹ˆudpä¸ä¼šç²˜åŒ…ï¼Ÿ"><a href="#11-ä¸ºä»€ä¹ˆudpä¸ä¼šç²˜åŒ…ï¼Ÿ" class="headerlink" title="11. ä¸ºä»€ä¹ˆudpä¸ä¼šç²˜åŒ…ï¼Ÿ"></a>11. ä¸ºä»€ä¹ˆ<strong>udp</strong>ä¸ä¼šç²˜åŒ…ï¼Ÿ</h3><ul><li>TCPåè®®æ˜¯â¾¯å‘æµçš„åè®®ï¼ŒUDPæ˜¯â¾¯å‘æ¶ˆæ¯çš„åè®®ã€‚UDPæ®µéƒ½æ˜¯â¼€æ¡æ¶ˆæ¯ï¼Œåº”â½¤ç¨‹åºå¿…é¡»ä»¥æ¶ˆæ¯ä¸ºå•ä½æå–æ•°æ®ï¼Œä¸èƒ½â¼€æ¬¡æå–ä»»æ„å­—èŠ‚çš„æ•°æ® </li><li>UDPå…·æœ‰ä¿æŠ¤æ¶ˆæ¯è¾¹ç•Œï¼Œåœ¨æ¯ä¸ªUDPåŒ…ä¸­å°±æœ‰äº†æ¶ˆæ¯å¤´ï¼ˆæ¶ˆæ¯æ¥æºåœ°å€ï¼Œç«¯â¼ç­‰ä¿¡æ¯ï¼‰ï¼Œè¿™æ ·å¯¹äºæ¥æ”¶ç«¯æ¥è¯´å°±å®¹æ˜“è¿›â¾åŒºåˆ†å¤„ç†äº†ã€‚ä¼ è¾“åè®®æŠŠæ•°æ®å½“ä½œâ¼€æ¡ç‹¬â½´çš„æ¶ˆæ¯åœ¨â½¹ä¸Šä¼ è¾“ï¼Œæ¥æ”¶ç«¯åªèƒ½æ¥æ”¶ç‹¬â½´çš„æ¶ˆæ¯ã€‚æ¥æ”¶ç«¯â¼€æ¬¡åªèƒ½æ¥æ”¶å‘é€ç«¯å‘å‡ºçš„â¼€ä¸ªæ•°æ®åŒ…,å¦‚æœâ¼€æ¬¡æ¥å—æ•°æ®çš„â¼¤â¼©â¼©äºå‘é€ç«¯â¼€æ¬¡å‘é€çš„æ•°æ®â¼¤â¼©ï¼Œå°±ä¼šä¸¢å¤±â¼€éƒ¨åˆ†æ•°æ®ï¼Œå³ä½¿ä¸¢å¤±ï¼Œæ¥å—ç«¯ä¹Ÿä¸ä¼šåˆ†ä¸¤æ¬¡å»æ¥æ”¶ã€‚</li></ul><h2 id="ä¸ƒã€WebSocket"><a href="#ä¸ƒã€WebSocket" class="headerlink" title="ä¸ƒã€WebSocket"></a>ä¸ƒã€WebSocket</h2><h3 id="1-å¯¹-WebSocket-çš„ç†è§£"><a href="#1-å¯¹-WebSocket-çš„ç†è§£" class="headerlink" title="1. å¯¹ WebSocket çš„ç†è§£"></a>1. å¯¹ WebSocket çš„ç†è§£</h3><p>WebSocketæ˜¯HTML5æä¾›çš„ä¸€ç§æµè§ˆå™¨ä¸æœåŠ¡å™¨è¿›è¡Œ<strong>å…¨åŒå·¥é€šè®¯</strong>çš„ç½‘ç»œæŠ€æœ¯ï¼Œå±äºåº”ç”¨å±‚åè®®ã€‚å®ƒåŸºäºTCPä¼ è¾“åè®®ï¼Œå¹¶å¤ç”¨HTTPçš„æ¡æ‰‹é€šé“ã€‚æµè§ˆå™¨å’ŒæœåŠ¡å™¨åªéœ€è¦å®Œæˆä¸€æ¬¡æ¡æ‰‹ï¼Œä¸¤è€…ä¹‹é—´å°±ç›´æ¥å¯ä»¥åˆ›å»ºæŒä¹…æ€§çš„è¿æ¥ï¼Œ å¹¶è¿›è¡ŒåŒå‘æ•°æ®ä¼ è¾“ã€‚</p><p>WebSocket çš„å‡ºç°å°±è§£å†³äº†åŠåŒå·¥é€šä¿¡çš„å¼Šç«¯ã€‚å®ƒæœ€å¤§çš„ç‰¹ç‚¹æ˜¯ï¼š<strong>æœåŠ¡å™¨å¯ä»¥å‘å®¢æˆ·ç«¯ä¸»åŠ¨æ¨åŠ¨æ¶ˆæ¯ï¼Œå®¢æˆ·ç«¯ä¹Ÿå¯ä»¥ä¸»åŠ¨å‘æœåŠ¡å™¨æ¨é€æ¶ˆæ¯ã€‚</strong></p><p><strong>WebSocketåŸç†</strong>ï¼šå®¢æˆ·ç«¯å‘ WebSocket æœåŠ¡å™¨é€šçŸ¥ï¼ˆnotifyï¼‰ä¸€ä¸ªå¸¦æœ‰æ‰€æœ‰æ¥æ”¶è€…IDï¼ˆrecipients IDsï¼‰çš„äº‹ä»¶ï¼ˆeventï¼‰ï¼ŒæœåŠ¡å™¨æ¥æ”¶åç«‹å³é€šçŸ¥æ‰€æœ‰æ´»è·ƒçš„ï¼ˆactiveï¼‰å®¢æˆ·ç«¯ï¼Œåªæœ‰IDåœ¨æ¥æ”¶è€…IDåºåˆ—ä¸­çš„å®¢æˆ·ç«¯æ‰ä¼šå¤„ç†è¿™ä¸ªäº‹ä»¶ã€‚<br>â€‹</p><p><strong>WebSocket ç‰¹ç‚¹çš„å¦‚ä¸‹ï¼š</strong></p><ul><li>æ”¯æŒåŒå‘é€šä¿¡ï¼Œå®æ—¶æ€§æ›´å¼º</li><li>å¯ä»¥å‘é€æ–‡æœ¬ï¼Œä¹Ÿå¯ä»¥å‘é€äºŒè¿›åˆ¶æ•°æ®â€˜â€™</li><li>å»ºç«‹åœ¨TCPåè®®ä¹‹ä¸Šï¼ŒæœåŠ¡ç«¯çš„å®ç°æ¯”è¾ƒå®¹æ˜“</li><li>æ•°æ®æ ¼å¼æ¯”è¾ƒè½»é‡ï¼Œæ€§èƒ½å¼€é”€å°ï¼Œé€šä¿¡é«˜æ•ˆ</li><li>æ²¡æœ‰åŒæºé™åˆ¶ï¼Œå®¢æˆ·ç«¯å¯ä»¥ä¸ä»»æ„æœåŠ¡å™¨é€šä¿¡</li><li>åè®®æ ‡è¯†ç¬¦æ˜¯wsï¼ˆå¦‚æœåŠ å¯†ï¼Œåˆ™ä¸ºwssï¼‰ï¼ŒæœåŠ¡å™¨ç½‘å€å°±æ˜¯ URL</li><li>ä¸ HTTP åè®®æœ‰ç€è‰¯å¥½çš„å…¼å®¹æ€§ã€‚é»˜è®¤ç«¯å£ä¹Ÿæ˜¯80å’Œ443ï¼Œå¹¶ä¸”æ¡æ‰‹é˜¶æ®µé‡‡ç”¨ HTTP åè®®ï¼Œå› æ­¤æ¡æ‰‹æ—¶ä¸å®¹æ˜“å±è”½ï¼Œèƒ½é€šè¿‡å„ç§ HTTP ä»£ç†æœåŠ¡å™¨ã€‚</li></ul><p><strong>Websocketçš„ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</strong><br>â€‹</p><p>åœ¨å®¢æˆ·ç«¯ä¸­ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// åœ¨index.htmlä¸­ç›´æ¥å†™WebSocketï¼Œè®¾ç½®æœåŠ¡ç«¯çš„ç«¯å£å·ä¸º 9999</span><span class="token keyword">let</span> ws <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span><span class="token string">'ws://localhost:9999'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// åœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯å»ºç«‹è¿æ¥åè§¦å‘</span>ws<span class="token punctuation">.</span>onopen <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Connection open."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     ws<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// åœ¨æœåŠ¡ç«¯ç»™å®¢æˆ·ç«¯å‘æ¥æ¶ˆæ¯çš„æ—¶å€™è§¦å‘</span>ws<span class="token punctuation">.</span>onmessage <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment" spellcheck="true">// æ‰“å°çš„æ˜¯MessageEventå¯¹è±¡</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// æ‰“å°çš„æ˜¯æ”¶åˆ°çš„æ¶ˆæ¯</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// åœ¨å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯å»ºç«‹å…³é—­åè§¦å‘</span>ws<span class="token punctuation">.</span>onclose <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>evt<span class="token punctuation">)</span> <span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Connection closed."</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-å³æ—¶é€šè®¯çš„å®ç°ï¼šçŸ­è½®è¯¢ã€é•¿è½®è¯¢ã€SSE-å’Œ-WebSocket-é—´çš„åŒºåˆ«ï¼Ÿ"><a href="#2-å³æ—¶é€šè®¯çš„å®ç°ï¼šçŸ­è½®è¯¢ã€é•¿è½®è¯¢ã€SSE-å’Œ-WebSocket-é—´çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="2. å³æ—¶é€šè®¯çš„å®ç°ï¼šçŸ­è½®è¯¢ã€é•¿è½®è¯¢ã€SSE å’Œ WebSocket é—´çš„åŒºåˆ«ï¼Ÿ"></a>2. å³æ—¶é€šè®¯çš„å®ç°ï¼šçŸ­è½®è¯¢ã€é•¿è½®è¯¢ã€SSE å’Œ WebSocket é—´çš„åŒºåˆ«ï¼Ÿ</h3><p>çŸ­è½®è¯¢å’Œé•¿è½®è¯¢çš„ç›®çš„éƒ½æ˜¯ç”¨äºå®ç°å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯çš„ä¸€ä¸ªå³æ—¶é€šè®¯ã€‚</p><p><strong>çŸ­è½®è¯¢çš„åŸºæœ¬æ€è·¯ï¼š</strong> æµè§ˆå™¨æ¯éš”ä¸€æ®µæ—¶é—´å‘æµè§ˆå™¨å‘é€ http è¯·æ±‚ï¼ŒæœåŠ¡å™¨ç«¯åœ¨æ”¶åˆ°è¯·æ±‚åï¼Œä¸è®ºæ˜¯å¦æœ‰æ•°æ®æ›´æ–°ï¼Œéƒ½ç›´æ¥è¿›è¡Œå“åº”ã€‚è¿™ç§æ–¹å¼å®ç°çš„å³æ—¶é€šä¿¡ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯æµè§ˆå™¨å‘é€è¯·æ±‚ï¼ŒæœåŠ¡å™¨æ¥å—è¯·æ±‚çš„ä¸€ä¸ªè¿‡ç¨‹ï¼Œé€šè¿‡è®©å®¢æˆ·ç«¯ä¸æ–­çš„è¿›è¡Œè¯·æ±‚ï¼Œä½¿å¾—å®¢æˆ·ç«¯èƒ½å¤Ÿæ¨¡æ‹Ÿå®æ—¶åœ°æ”¶åˆ°æœåŠ¡å™¨ç«¯çš„æ•°æ®çš„å˜åŒ–ã€‚è¿™ç§æ–¹å¼çš„ä¼˜ç‚¹æ˜¯æ¯”è¾ƒç®€å•ï¼Œæ˜“äºç†è§£ã€‚ç¼ºç‚¹æ˜¯è¿™ç§æ–¹å¼ç”±äºéœ€è¦ä¸æ–­çš„å»ºç«‹ http è¿æ¥ï¼Œä¸¥é‡æµªè´¹äº†æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯çš„èµ„æºã€‚å½“ç”¨æˆ·å¢åŠ æ—¶ï¼ŒæœåŠ¡å™¨ç«¯çš„å‹åŠ›å°±ä¼šå˜å¤§ï¼Œè¿™æ˜¯å¾ˆä¸åˆç†çš„ã€‚</p><p><strong>é•¿è½®è¯¢çš„åŸºæœ¬æ€è·¯ï¼š</strong> é¦–å…ˆç”±å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼Œå½“æœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯å‘æ¥çš„è¯·æ±‚åï¼ŒæœåŠ¡å™¨ç«¯ä¸ä¼šç›´æ¥è¿›è¡Œå“åº”ï¼Œè€Œæ˜¯å…ˆå°†è¿™ä¸ªè¯·æ±‚æŒ‚èµ·ï¼Œç„¶ååˆ¤æ–­æœåŠ¡å™¨ç«¯æ•°æ®æ˜¯å¦æœ‰æ›´æ–°ã€‚å¦‚æœæœ‰æ›´æ–°ï¼Œåˆ™è¿›è¡Œå“åº”ï¼Œå¦‚æœä¸€ç›´æ²¡æœ‰æ•°æ®ï¼Œåˆ™åˆ°è¾¾ä¸€å®šçš„æ—¶é—´é™åˆ¶æ‰è¿”å›ã€‚å®¢æˆ·ç«¯ JavaScript å“åº”å¤„ç†å‡½æ•°ä¼šåœ¨å¤„ç†å®ŒæœåŠ¡å™¨è¿”å›çš„ä¿¡æ¯åï¼Œå†æ¬¡å‘å‡ºè¯·æ±‚ï¼Œé‡æ–°å»ºç«‹è¿æ¥ã€‚é•¿è½®è¯¢å’ŒçŸ­è½®è¯¢æ¯”èµ·æ¥ï¼Œå®ƒçš„ä¼˜ç‚¹æ˜¯æ˜æ˜¾å‡å°‘äº†å¾ˆå¤šä¸å¿…è¦çš„ http è¯·æ±‚æ¬¡æ•°ï¼Œç›¸æ¯”ä¹‹ä¸‹èŠ‚çº¦äº†èµ„æºã€‚é•¿è½®è¯¢çš„ç¼ºç‚¹åœ¨äºï¼Œè¿æ¥æŒ‚èµ·ä¹Ÿä¼šå¯¼è‡´èµ„æºçš„æµªè´¹ã€‚</p><p><strong>SSE çš„åŸºæœ¬æ€æƒ³ï¼š</strong> æœåŠ¡å™¨ä½¿ç”¨æµä¿¡æ¯å‘æœåŠ¡å™¨æ¨é€ä¿¡æ¯ã€‚ä¸¥æ ¼åœ°è¯´ï¼Œhttp åè®®æ— æ³•åšåˆ°æœåŠ¡å™¨ä¸»åŠ¨æ¨é€ä¿¡æ¯ã€‚ä½†æ˜¯ï¼Œæœ‰ä¸€ç§å˜é€šæ–¹æ³•ï¼Œå°±æ˜¯æœåŠ¡å™¨å‘å®¢æˆ·ç«¯å£°æ˜ï¼Œæ¥ä¸‹æ¥è¦å‘é€çš„æ˜¯æµä¿¡æ¯ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå‘é€çš„ä¸æ˜¯ä¸€æ¬¡æ€§çš„æ•°æ®åŒ…ï¼Œè€Œæ˜¯ä¸€ä¸ªæ•°æ®æµï¼Œä¼šè¿ç»­ä¸æ–­åœ°å‘é€è¿‡æ¥ã€‚è¿™æ—¶ï¼Œå®¢æˆ·ç«¯ä¸ä¼šå…³é—­è¿æ¥ï¼Œä¼šä¸€ç›´ç­‰ç€æœåŠ¡å™¨å‘è¿‡æ¥çš„æ–°çš„æ•°æ®æµï¼Œè§†é¢‘æ’­æ”¾å°±æ˜¯è¿™æ ·çš„ä¾‹å­ã€‚SSE å°±æ˜¯åˆ©ç”¨è¿™ç§æœºåˆ¶ï¼Œä½¿ç”¨æµä¿¡æ¯å‘æµè§ˆå™¨æ¨é€ä¿¡æ¯ã€‚å®ƒåŸºäº http åè®®ï¼Œç›®å‰é™¤äº† IE/Edgeï¼Œå…¶ä»–æµè§ˆå™¨éƒ½æ”¯æŒã€‚å®ƒç›¸å¯¹äºå‰é¢ä¸¤ç§æ–¹å¼æ¥è¯´ï¼Œä¸éœ€è¦å»ºç«‹è¿‡å¤šçš„ http è¯·æ±‚ï¼Œç›¸æ¯”ä¹‹ä¸‹èŠ‚çº¦äº†èµ„æºã€‚</p><p><strong>WebSocket</strong> æ˜¯ HTML5 å®šä¹‰çš„ä¸€ä¸ªæ–°åè®®è®®ï¼Œä¸ä¼ ç»Ÿçš„ http åè®®ä¸åŒï¼Œè¯¥åè®®å…è®¸ç”±æœåŠ¡å™¨ä¸»åŠ¨çš„å‘å®¢æˆ·ç«¯æ¨é€ä¿¡æ¯ã€‚ä½¿ç”¨ WebSocket åè®®çš„ç¼ºç‚¹æ˜¯åœ¨æœåŠ¡å™¨ç«¯çš„é…ç½®æ¯”è¾ƒå¤æ‚ã€‚WebSocket æ˜¯ä¸€ä¸ªå…¨åŒå·¥çš„åè®®ï¼Œä¹Ÿå°±æ˜¯é€šä¿¡åŒæ–¹æ˜¯å¹³ç­‰çš„ï¼Œå¯ä»¥ç›¸äº’å‘é€æ¶ˆæ¯ï¼Œè€Œ SSE çš„æ–¹å¼æ˜¯å•å‘é€šä¿¡çš„ï¼Œåªèƒ½ç”±æœåŠ¡å™¨ç«¯å‘å®¢æˆ·ç«¯æ¨é€ä¿¡æ¯ï¼Œå¦‚æœå®¢æˆ·ç«¯éœ€è¦å‘é€ä¿¡æ¯å°±æ˜¯å±äºä¸‹ä¸€ä¸ª http è¯·æ±‚äº†ã€‚</p><p><strong>ä¸Šé¢çš„å››ä¸ªé€šä¿¡åè®®ï¼Œå‰ä¸‰ä¸ªéƒ½æ˜¯åŸºäºHTTPåè®®çš„ã€‚</strong></p><p>å¯¹äºè¿™å››ç§å³ä½¿é€šä¿¡åè®®ï¼Œä»æ€§èƒ½çš„è§’åº¦æ¥çœ‹ï¼š<br><strong>WebSocket &gt; é•¿è¿æ¥ï¼ˆSEEï¼‰ &gt; é•¿è½®è¯¢ &gt; çŸ­è½®è¯¢</strong><br>ä½†æ˜¯ï¼Œæˆ‘ä»¬å¦‚æœè€ƒè™‘æµè§ˆå™¨çš„å…¼å®¹æ€§é—®é¢˜ï¼Œé¡ºåºå°±æ°æ°ç›¸åäº†ï¼š<br><strong>çŸ­è½®è¯¢ &gt; é•¿è½®è¯¢ &gt; é•¿è¿æ¥ï¼ˆSEEï¼‰ &gt; WebSocket</strong><br>æ‰€ä»¥ï¼Œè¿˜æ˜¯è¦æ ¹æ®å…·ä½“çš„ä½¿ç”¨åœºæ™¯æ¥åˆ¤æ–­ä½¿ç”¨å“ªç§æ–¹å¼ã€‚</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> è®¡ç®—æœºç½‘ç»œ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Github </tag>
            
            <tag> åšå®¢ </tag>
            
            <tag> è®¡ç®—æœºç½‘ç»œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æµè§ˆå™¨åŸç†</title>
      <link href="/2022/08/30/theory/"/>
      <url>/2022/08/30/theory/</url>
      
        <content type="html"><![CDATA[<p> <img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/theory/1.png" alt="æµè§ˆå™¨åŸç†.png"></p><h2 id="ä¸€ã€æµè§ˆå™¨å®‰å…¨"><a href="#ä¸€ã€æµè§ˆå™¨å®‰å…¨" class="headerlink" title="ä¸€ã€æµè§ˆå™¨å®‰å…¨"></a>ä¸€ã€æµè§ˆå™¨å®‰å…¨</h2><h3 id="1-ä»€ä¹ˆæ˜¯-XSS-æ”»å‡»ï¼Ÿ"><a href="#1-ä»€ä¹ˆæ˜¯-XSS-æ”»å‡»ï¼Ÿ" class="headerlink" title="1.  ä»€ä¹ˆæ˜¯ XSS æ”»å‡»ï¼Ÿ"></a>1.  ä»€ä¹ˆæ˜¯ XSS æ”»å‡»ï¼Ÿ</h3><h4 id="ï¼ˆ1ï¼‰æ¦‚å¿µ"><a href="#ï¼ˆ1ï¼‰æ¦‚å¿µ" class="headerlink" title="ï¼ˆ1ï¼‰æ¦‚å¿µ"></a>ï¼ˆ1ï¼‰æ¦‚å¿µ</h4><p>XSS æ”»å‡»æŒ‡çš„æ˜¯è·¨ç«™è„šæœ¬æ”»å‡»ï¼Œæ˜¯ä¸€ç§ä»£ç æ³¨å…¥æ”»å‡»ã€‚æ”»å‡»è€…é€šè¿‡åœ¨ç½‘ç«™æ³¨å…¥æ¶æ„è„šæœ¬ï¼Œä½¿ä¹‹åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸Šè¿è¡Œï¼Œä»è€Œç›—å–ç”¨æˆ·çš„ä¿¡æ¯å¦‚ cookie ç­‰ã€‚</p><p>XSS çš„æœ¬è´¨æ˜¯å› ä¸ºç½‘ç«™æ²¡æœ‰å¯¹æ¶æ„ä»£ç è¿›è¡Œè¿‡æ»¤ï¼Œä¸æ­£å¸¸çš„ä»£ç æ··åˆåœ¨ä¸€èµ·äº†ï¼Œæµè§ˆå™¨æ²¡æœ‰åŠæ³•åˆ†è¾¨å“ªäº›è„šæœ¬æ˜¯å¯ä¿¡çš„ï¼Œä»è€Œå¯¼è‡´äº†æ¶æ„ä»£ç çš„æ‰§è¡Œã€‚</p><p>æ”»å‡»è€…å¯ä»¥é€šè¿‡è¿™ç§æ”»å‡»æ–¹å¼å¯ä»¥è¿›è¡Œä»¥ä¸‹æ“ä½œï¼š</p><ul><li>è·å–é¡µé¢çš„æ•°æ®ï¼Œå¦‚DOMã€cookieã€localStorageï¼›</li><li>DOSæ”»å‡»ï¼Œå‘é€åˆç†è¯·æ±‚ï¼Œå ç”¨æœåŠ¡å™¨èµ„æºï¼Œä»è€Œä½¿ç”¨æˆ·æ— æ³•è®¿é—®æœåŠ¡å™¨ï¼›</li><li>ç ´åé¡µé¢ç»“æ„ï¼›</li><li>æµé‡åŠ«æŒï¼ˆå°†é“¾æ¥æŒ‡å‘æŸç½‘ç«™ï¼‰ï¼›</li></ul><h4 id="ï¼ˆ2ï¼‰æ”»å‡»ç±»å‹"><a href="#ï¼ˆ2ï¼‰æ”»å‡»ç±»å‹" class="headerlink" title="ï¼ˆ2ï¼‰æ”»å‡»ç±»å‹"></a>ï¼ˆ2ï¼‰æ”»å‡»ç±»å‹</h4><p>XSS å¯ä»¥åˆ†ä¸ºå­˜å‚¨å‹ã€åå°„å‹å’Œ DOM å‹ï¼š</p><ul><li>å­˜å‚¨å‹æŒ‡çš„æ˜¯æ¶æ„è„šæœ¬ä¼šå­˜å‚¨åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šï¼Œå½“æµè§ˆå™¨è¯·æ±‚æ•°æ®æ—¶ï¼Œè„šæœ¬ä»æœåŠ¡å™¨ä¼ å›å¹¶æ‰§è¡Œã€‚</li><li>åå°„å‹æŒ‡çš„æ˜¯æ”»å‡»è€…è¯±å¯¼ç”¨æˆ·è®¿é—®ä¸€ä¸ªå¸¦æœ‰æ¶æ„ä»£ç çš„ URL åï¼ŒæœåŠ¡å™¨ç«¯æ¥æ”¶æ•°æ®åå¤„ç†ï¼Œç„¶åæŠŠå¸¦æœ‰æ¶æ„ä»£ç çš„æ•°æ®å‘é€åˆ°æµè§ˆå™¨ç«¯ï¼Œæµè§ˆå™¨ç«¯è§£æè¿™æ®µå¸¦æœ‰ XSS ä»£ç çš„æ•°æ®åå½“åšè„šæœ¬æ‰§è¡Œï¼Œæœ€ç»ˆå®Œæˆ XSS æ”»å‡»ã€‚ </li><li>DOM å‹æŒ‡çš„é€šè¿‡ä¿®æ”¹é¡µé¢çš„ DOM èŠ‚ç‚¹å½¢æˆçš„ XSSã€‚</li></ul><p><strong>1ï¼‰å­˜å‚¨å‹ XSS çš„æ”»å‡»æ­¥éª¤ï¼š</strong></p><ol><li>æ”»å‡»è€…å°†æ¶æ„ä»£ç æäº¤åˆ°â½¬æ ‡â½¹ç«™çš„æ•°æ®åº“ä¸­ã€‚ </li><li>â½¤æˆ·æ‰“å¼€â½¬æ ‡â½¹ç«™æ—¶ï¼Œâ½¹ç«™æœåŠ¡ç«¯å°†æ¶æ„ä»£ç ä»æ•°æ®åº“å–å‡ºï¼Œæ‹¼æ¥åœ¨ HTML ä¸­è¿”å›ç»™æµè§ˆå™¨ã€‚ </li><li>â½¤æˆ·æµè§ˆå™¨æ¥æ”¶åˆ°å“åº”åè§£ææ‰§â¾ï¼Œæ··åœ¨å…¶ä¸­çš„æ¶æ„ä»£ç ä¹Ÿè¢«æ‰§â¾ã€‚ </li><li>æ¶æ„ä»£ç çªƒå–â½¤æˆ·æ•°æ®å¹¶å‘é€åˆ°æ”»å‡»è€…çš„â½¹ç«™ï¼Œæˆ–è€…å†’å……â½¤æˆ·çš„â¾ä¸ºï¼Œè°ƒâ½¤â½¬æ ‡â½¹ç«™æ¥â¼æ‰§â¾æ”»å‡»è€…æŒ‡å®šçš„æ“ä½œã€‚ </li></ol><p>è¿™ç§æ”»å‡»å¸¸â»…äºå¸¦æœ‰â½¤æˆ·ä¿å­˜æ•°æ®çš„â½¹ç«™åŠŸèƒ½ï¼Œå¦‚è®ºå›å‘å¸–ã€å•†å“è¯„è®ºã€â½¤æˆ·ç§ä¿¡ç­‰ã€‚</p><p><strong>2ï¼‰åå°„å‹ XSS çš„æ”»å‡»æ­¥éª¤ï¼š</strong></p><ol><li>æ”»å‡»è€…æ„é€ å‡ºç‰¹æ®Šçš„ URLï¼Œå…¶ä¸­åŒ…å«æ¶æ„ä»£ç ã€‚ </li><li>â½¤æˆ·æ‰“å¼€å¸¦æœ‰æ¶æ„ä»£ç çš„ URL æ—¶ï¼Œâ½¹ç«™æœåŠ¡ç«¯å°†æ¶æ„ä»£ç ä» URL ä¸­å–å‡ºï¼Œæ‹¼æ¥åœ¨ HTML ä¸­è¿”å›ç»™æµè§ˆå™¨ã€‚ </li><li>â½¤æˆ·æµè§ˆå™¨æ¥æ”¶åˆ°å“åº”åè§£ææ‰§â¾ï¼Œæ··åœ¨å…¶ä¸­çš„æ¶æ„ä»£ç ä¹Ÿè¢«æ‰§â¾ã€‚ </li><li>æ¶æ„ä»£ç çªƒå–â½¤æˆ·æ•°æ®å¹¶å‘é€åˆ°æ”»å‡»è€…çš„â½¹ç«™ï¼Œæˆ–è€…å†’å……â½¤æˆ·çš„â¾ä¸ºï¼Œè°ƒâ½¤â½¬æ ‡â½¹ç«™æ¥â¼æ‰§â¾æ”»å‡»è€…æŒ‡å®šçš„æ“ä½œã€‚ </li></ol><p>åå°„å‹ XSS è·Ÿå­˜å‚¨å‹ XSS çš„åŒºåˆ«æ˜¯ï¼šå­˜å‚¨å‹ XSS çš„æ¶æ„ä»£ç å­˜åœ¨æ•°æ®åº“â¾¥ï¼Œåå°„å‹ XSS çš„æ¶æ„ä»£ç å­˜åœ¨ URL â¾¥ã€‚ </p><p>åå°„å‹ XSS æ¼æ´å¸¸â»…äºé€šè¿‡ URL ä¼ é€’å‚æ•°çš„åŠŸèƒ½ï¼Œå¦‚â½¹ç«™æœç´¢ã€è·³è½¬ç­‰ã€‚ ç”±äºéœ€è¦â½¤æˆ·ä¸»åŠ¨æ‰“å¼€æ¶æ„çš„ URL æ‰èƒ½â½£æ•ˆï¼Œæ”»å‡»è€…å¾€å¾€ä¼šç»“åˆå¤šç§â¼¿æ®µè¯±å¯¼â½¤æˆ·ç‚¹å‡»ã€‚  </p><p><strong>3ï¼‰DOM å‹ XSS çš„æ”»å‡»æ­¥éª¤ï¼š</strong> </p><ol><li>æ”»å‡»è€…æ„é€ å‡ºç‰¹æ®Šçš„ URLï¼Œå…¶ä¸­åŒ…å«æ¶æ„ä»£ç ã€‚ </li><li>â½¤æˆ·æ‰“å¼€å¸¦æœ‰æ¶æ„ä»£ç çš„ URLã€‚ </li><li>â½¤æˆ·æµè§ˆå™¨æ¥æ”¶åˆ°å“åº”åè§£ææ‰§â¾ï¼Œå‰ç«¯ JavaScript å–å‡º URL ä¸­çš„æ¶æ„ä»£ç å¹¶æ‰§â¾ã€‚ </li><li>æ¶æ„ä»£ç çªƒå–â½¤æˆ·æ•°æ®å¹¶å‘é€åˆ°æ”»å‡»è€…çš„â½¹ç«™ï¼Œæˆ–è€…å†’å……â½¤æˆ·çš„â¾ä¸ºï¼Œè°ƒâ½¤â½¬æ ‡â½¹ç«™æ¥â¼æ‰§â¾æ”»å‡»è€…æŒ‡å®šçš„æ“ä½œã€‚ </li></ol><p>DOM å‹ XSS è·Ÿå‰ä¸¤ç§ XSS çš„åŒºåˆ«ï¼šDOM å‹ XSS æ”»å‡»ä¸­ï¼Œå–å‡ºå’Œæ‰§â¾æ¶æ„ä»£ç ç”±æµè§ˆå™¨ç«¯å®Œæˆï¼Œå±äºå‰ç«¯JavaScript â¾ƒèº«çš„å®‰å…¨æ¼æ´ï¼Œâ½½å…¶ä»–ä¸¤ç§ XSS éƒ½å±äºæœåŠ¡ç«¯çš„å®‰å…¨æ¼æ´ã€‚ </p><h3 id="2-å¦‚ä½•é˜²å¾¡-XSS-æ”»å‡»ï¼Ÿ"><a href="#2-å¦‚ä½•é˜²å¾¡-XSS-æ”»å‡»ï¼Ÿ" class="headerlink" title="2. å¦‚ä½•é˜²å¾¡ XSS æ”»å‡»ï¼Ÿ"></a>2. å¦‚ä½•é˜²å¾¡ XSS æ”»å‡»ï¼Ÿ</h3><p>å¯ä»¥çœ‹åˆ°XSSå±å®³å¦‚æ­¤ä¹‹å¤§ï¼Œ é‚£ä¹ˆåœ¨å¼€å‘ç½‘ç«™æ—¶å°±è¦åšå¥½é˜²å¾¡æªæ–½ï¼Œå…·ä½“æªæ–½å¦‚ä¸‹ï¼š</p><ul><li>å¯ä»¥ä»æµè§ˆå™¨çš„æ‰§è¡Œæ¥è¿›è¡Œé¢„é˜²ï¼Œä¸€ç§æ˜¯ä½¿ç”¨çº¯å‰ç«¯çš„æ–¹å¼ï¼Œä¸ç”¨æœåŠ¡å™¨ç«¯æ‹¼æ¥åè¿”å›ï¼ˆä¸ä½¿ç”¨æœåŠ¡ç«¯æ¸²æŸ“ï¼‰ã€‚å¦ä¸€ç§æ˜¯å¯¹éœ€è¦æ’å…¥åˆ° HTML ä¸­çš„ä»£ç åšå¥½å……åˆ†çš„è½¬ä¹‰ã€‚å¯¹äº DOM å‹çš„æ”»å‡»ï¼Œä¸»è¦æ˜¯å‰ç«¯è„šæœ¬çš„ä¸å¯é è€Œé€ æˆçš„ï¼Œå¯¹äºæ•°æ®è·å–æ¸²æŸ“å’Œå­—ç¬¦ä¸²æ‹¼æ¥çš„æ—¶å€™åº”è¯¥å¯¹å¯èƒ½å‡ºç°çš„æ¶æ„ä»£ç æƒ…å†µè¿›è¡Œåˆ¤æ–­ã€‚</li><li>ä½¿ç”¨ CSP ï¼ŒCSP çš„æœ¬è´¨æ˜¯å»ºç«‹ä¸€ä¸ªç™½åå•ï¼Œå‘Šè¯‰æµè§ˆå™¨å“ªäº›å¤–éƒ¨èµ„æºå¯ä»¥åŠ è½½å’Œæ‰§è¡Œï¼Œä»è€Œé˜²æ­¢æ¶æ„ä»£ç çš„æ³¨å…¥æ”»å‡»ã€‚</li></ul><blockquote><ol><li>CSP æŒ‡çš„æ˜¯å†…å®¹å®‰å…¨ç­–ç•¥ï¼Œå®ƒçš„æœ¬è´¨æ˜¯å»ºç«‹ä¸€ä¸ªç™½åå•ï¼Œå‘Šè¯‰æµè§ˆå™¨å“ªäº›å¤–éƒ¨èµ„æºå¯ä»¥åŠ è½½å’Œæ‰§è¡Œã€‚æˆ‘ä»¬åªéœ€è¦é…ç½®è§„åˆ™ï¼Œå¦‚ä½•æ‹¦æˆªç”±æµè§ˆå™¨è‡ªå·±æ¥å®ç°ã€‚</li><li>é€šå¸¸æœ‰ä¸¤ç§æ–¹å¼æ¥å¼€å¯ CSPï¼Œä¸€ç§æ˜¯è®¾ç½® HTTP é¦–éƒ¨ä¸­çš„ Content-Security-Policyï¼Œä¸€ç§æ˜¯è®¾ç½® meta æ ‡ç­¾çš„æ–¹å¼ <meta http-equiv="Content-Security-Policy"></li></ol></blockquote><ul><li>å¯¹ä¸€äº›æ•æ„Ÿä¿¡æ¯è¿›è¡Œä¿æŠ¤ï¼Œæ¯”å¦‚ cookie ä½¿ç”¨ http-onlyï¼Œä½¿å¾—è„šæœ¬æ— æ³•è·å–ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨éªŒè¯ç ï¼Œé¿å…è„šæœ¬ä¼ªè£…æˆç”¨æˆ·æ‰§è¡Œä¸€äº›æ“ä½œã€‚</li></ul><h3 id="3-ä»€ä¹ˆæ˜¯-CSRF-æ”»å‡»ï¼Ÿ"><a href="#3-ä»€ä¹ˆæ˜¯-CSRF-æ”»å‡»ï¼Ÿ" class="headerlink" title="3. ä»€ä¹ˆæ˜¯ CSRF æ”»å‡»ï¼Ÿ"></a>3. ä»€ä¹ˆæ˜¯ CSRF æ”»å‡»ï¼Ÿ</h3><h4 id="ï¼ˆ1ï¼‰æ¦‚å¿µ-1"><a href="#ï¼ˆ1ï¼‰æ¦‚å¿µ-1" class="headerlink" title="ï¼ˆ1ï¼‰æ¦‚å¿µ"></a>ï¼ˆ1ï¼‰æ¦‚å¿µ</h4><p>CSRF æ”»å‡»æŒ‡çš„æ˜¯<strong>è·¨ç«™è¯·æ±‚ä¼ªé€ æ”»å‡»</strong>ï¼Œæ”»å‡»è€…è¯±å¯¼ç”¨æˆ·è¿›å…¥ä¸€ä¸ªç¬¬ä¸‰æ–¹ç½‘ç«™ï¼Œç„¶åè¯¥ç½‘ç«™å‘è¢«æ”»å‡»ç½‘ç«™å‘é€è·¨ç«™è¯·æ±‚ã€‚å¦‚æœç”¨æˆ·åœ¨è¢«æ”»å‡»ç½‘ç«™ä¸­ä¿å­˜äº†ç™»å½•çŠ¶æ€ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªç™»å½•çŠ¶æ€ï¼Œç»•è¿‡åå°çš„ç”¨æˆ·éªŒè¯ï¼Œå†’å……ç”¨æˆ·å‘æœåŠ¡å™¨æ‰§è¡Œä¸€äº›æ“ä½œã€‚</p><p>CSRF æ”»å‡»çš„<strong>æœ¬è´¨æ˜¯åˆ©ç”¨ cookie ä¼šåœ¨åŒæºè¯·æ±‚ä¸­æºå¸¦å‘é€ç»™æœåŠ¡å™¨çš„ç‰¹ç‚¹ï¼Œä»¥æ­¤æ¥å®ç°ç”¨æˆ·çš„å†’å……ã€‚</strong></p><h4 id="ï¼ˆ2ï¼‰æ”»å‡»ç±»å‹-1"><a href="#ï¼ˆ2ï¼‰æ”»å‡»ç±»å‹-1" class="headerlink" title="ï¼ˆ2ï¼‰æ”»å‡»ç±»å‹"></a>ï¼ˆ2ï¼‰æ”»å‡»ç±»å‹</h4><p>å¸¸è§çš„ CSRF æ”»å‡»æœ‰ä¸‰ç§ï¼š</p><ul><li>GET ç±»å‹çš„ CSRF æ”»å‡»ï¼Œæ¯”å¦‚åœ¨ç½‘ç«™ä¸­çš„ä¸€ä¸ª img æ ‡ç­¾é‡Œæ„å»ºä¸€ä¸ªè¯·æ±‚ï¼Œå½“ç”¨æˆ·æ‰“å¼€è¿™ä¸ªç½‘ç«™çš„æ—¶å€™å°±ä¼šè‡ªåŠ¨å‘èµ·æäº¤ã€‚</li><li>POST ç±»å‹çš„ CSRF æ”»å‡»ï¼Œæ¯”å¦‚æ„å»ºä¸€ä¸ªè¡¨å•ï¼Œç„¶åéšè—å®ƒï¼Œå½“ç”¨æˆ·è¿›å…¥é¡µé¢æ—¶ï¼Œè‡ªåŠ¨æäº¤è¿™ä¸ªè¡¨å•ã€‚</li><li>é“¾æ¥ç±»å‹çš„ CSRF æ”»å‡»ï¼Œæ¯”å¦‚åœ¨ a æ ‡ç­¾çš„ href å±æ€§é‡Œæ„å»ºä¸€ä¸ªè¯·æ±‚ï¼Œç„¶åè¯±å¯¼ç”¨æˆ·å»ç‚¹å‡»ã€‚</li></ul><h3 id="4-å¦‚ä½•é˜²å¾¡-CSRF-æ”»å‡»ï¼Ÿ"><a href="#4-å¦‚ä½•é˜²å¾¡-CSRF-æ”»å‡»ï¼Ÿ" class="headerlink" title="4. å¦‚ä½•é˜²å¾¡ CSRF æ”»å‡»ï¼Ÿ"></a>4. å¦‚ä½•é˜²å¾¡ CSRF æ”»å‡»ï¼Ÿ</h3><p><strong>CSRF æ”»å‡»å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•æ¥é˜²æŠ¤ï¼š</strong></p><ul><li><strong>è¿›è¡ŒåŒæºæ£€æµ‹</strong>ï¼ŒæœåŠ¡å™¨æ ¹æ® http è¯·æ±‚å¤´ä¸­ origin æˆ–è€… referer ä¿¡æ¯æ¥åˆ¤æ–­è¯·æ±‚æ˜¯å¦ä¸ºå…è®¸è®¿é—®çš„ç«™ç‚¹ï¼Œä»è€Œå¯¹è¯·æ±‚è¿›è¡Œè¿‡æ»¤ã€‚å½“ origin æˆ–è€… referer ä¿¡æ¯éƒ½ä¸å­˜åœ¨çš„æ—¶å€™ï¼Œç›´æ¥é˜»æ­¢è¯·æ±‚ã€‚è¿™ç§æ–¹å¼çš„ç¼ºç‚¹æ˜¯æœ‰äº›æƒ…å†µä¸‹ referer å¯ä»¥è¢«ä¼ªé€ ï¼ŒåŒæ—¶è¿˜ä¼šæŠŠæœç´¢å¼•æ“çš„é“¾æ¥ä¹Ÿç»™å±è”½äº†ã€‚æ‰€ä»¥ä¸€èˆ¬ç½‘ç«™ä¼šå…è®¸æœç´¢å¼•æ“çš„é¡µé¢è¯·æ±‚ï¼Œä½†æ˜¯ç›¸åº”çš„é¡µé¢è¯·æ±‚è¿™ç§è¯·æ±‚æ–¹å¼ä¹Ÿå¯èƒ½è¢«æ”»å‡»è€…ç»™åˆ©ç”¨ã€‚ï¼ˆReferer å­—æ®µä¼šå‘Šè¯‰æœåŠ¡å™¨è¯¥ç½‘é¡µæ˜¯ä»å“ªä¸ªé¡µé¢é“¾æ¥è¿‡æ¥çš„ï¼‰</li><li><strong>ä½¿ç”¨ CSRF Token è¿›è¡ŒéªŒè¯</strong>ï¼ŒæœåŠ¡å™¨å‘ç”¨æˆ·è¿”å›ä¸€ä¸ªéšæœºæ•° Token ï¼Œå½“ç½‘ç«™å†æ¬¡å‘èµ·è¯·æ±‚æ—¶ï¼Œåœ¨è¯·æ±‚å‚æ•°ä¸­åŠ å…¥æœåŠ¡å™¨ç«¯è¿”å›çš„ token ï¼Œç„¶åæœåŠ¡å™¨å¯¹è¿™ä¸ª token è¿›è¡ŒéªŒè¯ã€‚è¿™ç§æ–¹æ³•è§£å†³äº†ä½¿ç”¨ cookie å•ä¸€éªŒè¯æ–¹å¼æ—¶ï¼Œå¯èƒ½ä¼šè¢«å†’ç”¨çš„é—®é¢˜ï¼Œä½†æ˜¯è¿™ç§æ–¹æ³•å­˜åœ¨ä¸€ä¸ªç¼ºç‚¹å°±æ˜¯ï¼Œæˆ‘ä»¬éœ€è¦ç»™ç½‘ç«™ä¸­çš„æ‰€æœ‰è¯·æ±‚éƒ½æ·»åŠ ä¸Šè¿™ä¸ª tokenï¼Œæ“ä½œæ¯”è¾ƒç¹çã€‚è¿˜æœ‰ä¸€ä¸ªé—®é¢˜æ˜¯ä¸€èˆ¬ä¸ä¼šåªæœ‰ä¸€å°ç½‘ç«™æœåŠ¡å™¨ï¼Œå¦‚æœè¯·æ±‚ç»è¿‡è´Ÿè½½å¹³è¡¡è½¬ç§»åˆ°äº†å…¶ä»–çš„æœåŠ¡å™¨ï¼Œä½†æ˜¯è¿™ä¸ªæœåŠ¡å™¨çš„ session ä¸­æ²¡æœ‰ä¿ç•™è¿™ä¸ª token çš„è¯ï¼Œå°±æ²¡æœ‰åŠæ³•éªŒè¯äº†ã€‚è¿™ç§æƒ…å†µå¯ä»¥é€šè¿‡æ”¹å˜ token çš„æ„å»ºæ–¹å¼æ¥è§£å†³ã€‚</li><li><strong>å¯¹ Cookie è¿›è¡ŒåŒé‡éªŒè¯</strong>ï¼ŒæœåŠ¡å™¨åœ¨ç”¨æˆ·è®¿é—®ç½‘ç«™é¡µé¢æ—¶ï¼Œå‘è¯·æ±‚åŸŸåæ³¨å…¥ä¸€ä¸ªCookieï¼Œå†…å®¹ä¸ºéšæœºå­—ç¬¦ä¸²ï¼Œç„¶åå½“ç”¨æˆ·å†æ¬¡å‘æœåŠ¡å™¨å‘é€è¯·æ±‚çš„æ—¶å€™ï¼Œä» cookie ä¸­å–å‡ºè¿™ä¸ªå­—ç¬¦ä¸²ï¼Œæ·»åŠ åˆ° URL å‚æ•°ä¸­ï¼Œç„¶åæœåŠ¡å™¨é€šè¿‡å¯¹ cookie ä¸­çš„æ•°æ®å’Œå‚æ•°ä¸­çš„æ•°æ®è¿›è¡Œæ¯”è¾ƒï¼Œæ¥è¿›è¡ŒéªŒè¯ã€‚ä½¿ç”¨è¿™ç§æ–¹å¼æ˜¯åˆ©ç”¨äº†æ”»å‡»è€…åªèƒ½åˆ©ç”¨ cookieï¼Œä½†æ˜¯ä¸èƒ½è®¿é—®è·å– cookie çš„ç‰¹ç‚¹ã€‚å¹¶ä¸”è¿™ç§æ–¹æ³•æ¯” CSRF Token çš„æ–¹æ³•æ›´åŠ æ–¹ä¾¿ï¼Œå¹¶ä¸”ä¸æ¶‰åŠåˆ°åˆ†å¸ƒå¼è®¿é—®çš„é—®é¢˜ã€‚è¿™ç§æ–¹æ³•çš„ç¼ºç‚¹æ˜¯å¦‚æœç½‘ç«™å­˜åœ¨ XSS æ¼æ´çš„ï¼Œé‚£ä¹ˆè¿™ç§æ–¹å¼ä¼šå¤±æ•ˆã€‚åŒæ—¶è¿™ç§æ–¹å¼ä¸èƒ½åšåˆ°å­åŸŸåçš„éš”ç¦»ã€‚</li><li><strong>åœ¨è®¾ç½® cookie å±æ€§çš„æ—¶å€™è®¾ç½® Samesite ï¼Œé™åˆ¶ cookie ä¸èƒ½ä½œä¸ºè¢«ç¬¬ä¸‰æ–¹ä½¿ç”¨</strong>ï¼Œä»è€Œå¯ä»¥é¿å…è¢«æ”»å‡»è€…åˆ©ç”¨ã€‚Samesite ä¸€å…±æœ‰ä¸¤ç§æ¨¡å¼ï¼Œä¸€ç§æ˜¯ä¸¥æ ¼æ¨¡å¼ï¼Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ cookie åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½ä¸å¯èƒ½ä½œä¸ºç¬¬ä¸‰æ–¹ Cookie ä½¿ç”¨ï¼Œåœ¨å®½æ¾æ¨¡å¼ä¸‹ï¼Œcookie å¯ä»¥è¢«è¯·æ±‚æ˜¯ GET è¯·æ±‚ï¼Œä¸”ä¼šå‘ç”Ÿé¡µé¢è·³è½¬çš„è¯·æ±‚æ‰€ä½¿ç”¨ã€‚</li></ul><h3 id="5-ä»€ä¹ˆæ˜¯ä¸­é—´äººæ”»å‡»ï¼Ÿå¦‚ä½•é˜²èŒƒä¸­é—´äººæ”»å‡»ï¼Ÿ"><a href="#5-ä»€ä¹ˆæ˜¯ä¸­é—´äººæ”»å‡»ï¼Ÿå¦‚ä½•é˜²èŒƒä¸­é—´äººæ”»å‡»ï¼Ÿ" class="headerlink" title="5. ä»€ä¹ˆæ˜¯ä¸­é—´äººæ”»å‡»ï¼Ÿå¦‚ä½•é˜²èŒƒä¸­é—´äººæ”»å‡»ï¼Ÿ"></a>5. ä»€ä¹ˆæ˜¯ä¸­é—´äººæ”»å‡»ï¼Ÿå¦‚ä½•é˜²èŒƒä¸­é—´äººæ”»å‡»ï¼Ÿ</h3><p>ä¸­é—´â¼ˆ (Man-in-the-middle attack, MITM) æ˜¯æŒ‡æ”»å‡»è€…ä¸é€šè®¯çš„ä¸¤ç«¯åˆ†åˆ«åˆ›å»ºç‹¬â½´çš„è”ç³», å¹¶äº¤æ¢å…¶æ‰€æ”¶åˆ°çš„æ•°æ®, ä½¿é€šè®¯çš„ä¸¤ç«¯è®¤ä¸ºä»–ä»¬æ­£åœ¨é€šè¿‡â¼€ä¸ªç§å¯†çš„è¿æ¥ä¸å¯¹â½…ç›´æ¥å¯¹è¯, ä½†äº‹å®ä¸Šæ•´ä¸ªä¼šè¯éƒ½è¢«æ”»å‡»è€…å®Œå…¨æ§åˆ¶ã€‚åœ¨ä¸­é—´â¼ˆæ”»å‡»ä¸­ï¼Œæ”»å‡»è€…å¯ä»¥æ‹¦æˆªé€šè®¯åŒâ½…çš„é€šè¯å¹¶æ’â¼Šæ–°çš„å†…å®¹ã€‚</p><p>æ”»å‡»è¿‡ç¨‹å¦‚ä¸‹: </p><ul><li>å®¢æˆ·ç«¯å‘é€è¯·æ±‚åˆ°æœåŠ¡ç«¯ï¼Œè¯·æ±‚è¢«ä¸­é—´â¼ˆæˆªè· </li><li>æœåŠ¡å™¨å‘å®¢æˆ·ç«¯å‘é€å…¬é’¥ </li><li>ä¸­é—´â¼ˆæˆªè·å…¬é’¥ï¼Œä¿ç•™åœ¨â¾ƒâ¼°â¼¿ä¸Šã€‚ç„¶åâ¾ƒâ¼°â½£æˆâ¼€ä¸ª<strong>ä¼ªé€ çš„</strong>å…¬é’¥ï¼Œå‘ç»™å®¢æˆ·ç«¯ </li><li>å®¢æˆ·ç«¯æ”¶åˆ°ä¼ªé€ çš„å…¬é’¥åï¼Œâ½£æˆåŠ å¯†hashå€¼å‘ç»™æœåŠ¡å™¨ </li><li>ä¸­é—´â¼ˆè·å¾—åŠ å¯†hashå€¼ï¼Œâ½¤â¾ƒâ¼°çš„ç§é’¥è§£å¯†è·å¾—çœŸç§˜é’¥,åŒæ—¶â½£æˆå‡çš„åŠ å¯†hashå€¼ï¼Œå‘ç»™æœåŠ¡å™¨ </li><li>æœåŠ¡å™¨â½¤ç§é’¥è§£å¯†è·å¾—å‡å¯†é’¥,ç„¶ååŠ å¯†æ•°æ®ä¼ è¾“ç»™å®¢æˆ·ç«¯ </li></ul><h3 id="6-æœ‰å“ªäº›å¯èƒ½å¼•èµ·å‰ç«¯å®‰å…¨çš„é—®é¢˜"><a href="#6-æœ‰å“ªäº›å¯èƒ½å¼•èµ·å‰ç«¯å®‰å…¨çš„é—®é¢˜" class="headerlink" title="6. æœ‰å“ªäº›å¯èƒ½å¼•èµ·å‰ç«¯å®‰å…¨çš„é—®é¢˜?"></a>6. æœ‰å“ªäº›å¯èƒ½å¼•èµ·å‰ç«¯å®‰å…¨çš„é—®é¢˜?</h3><ul><li>è·¨ç«™è„šæœ¬ (Cross-Site Scripting, XSS): â¼€ç§ä»£ç æ³¨â¼Šâ½…å¼, ä¸ºäº†ä¸ CSS åŒºåˆ†æ‰€ä»¥è¢«ç§°ä½œ XSSã€‚æ—©æœŸå¸¸â»…äºâ½¹ç»œè®ºå›, èµ·å› æ˜¯â½¹ç«™æ²¡æœ‰å¯¹â½¤æˆ·çš„è¾“â¼Šè¿›â¾ä¸¥æ ¼çš„é™åˆ¶, ä½¿å¾—æ”»å‡»è€…å¯ä»¥å°†è„šæœ¬ä¸Šä¼ åˆ°å¸–â¼¦è®©å…¶ä»–â¼ˆæµè§ˆåˆ°æœ‰æ¶æ„è„šæœ¬çš„â»šâ¾¯, å…¶æ³¨â¼Šâ½…å¼å¾ˆç®€å•åŒ…æ‹¬ä½†ä¸é™äº JavaScript / CSS / Flash ç­‰ï¼› </li><li>iframeçš„æ»¥â½¤: iframeä¸­çš„å†…å®¹æ˜¯ç”±ç¬¬ä¸‰â½…æ¥æä¾›çš„ï¼Œé»˜è®¤æƒ…å†µä¸‹ä»–ä»¬ä¸å—æ§åˆ¶ï¼Œä»–ä»¬å¯ä»¥åœ¨iframeä¸­è¿â¾JavaScirptè„šæœ¬ã€Flashæ’ä»¶ã€å¼¹å‡ºå¯¹è¯æ¡†ç­‰ç­‰ï¼Œè¿™å¯èƒ½ä¼šç ´åå‰ç«¯â½¤æˆ·ä½“éªŒï¼›</li><li>è·¨ç«™ç‚¹è¯·æ±‚ä¼ªé€ ï¼ˆCross-Site Request Forgeriesï¼ŒCSRFï¼‰: æŒ‡æ”»å‡»è€…é€šè¿‡è®¾ç½®å¥½çš„é™·é˜±ï¼Œå¼ºåˆ¶å¯¹å·²å®Œæˆè®¤è¯çš„â½¤æˆ·è¿›â¾â¾®é¢„æœŸçš„ä¸ªâ¼ˆä¿¡æ¯æˆ–è®¾å®šä¿¡æ¯ç­‰æŸäº›çŠ¶æ€æ›´æ–°ï¼Œå±äºè¢«åŠ¨æ”»å‡» </li><li>æ¶æ„ç¬¬ä¸‰â½…åº“: â½†è®ºæ˜¯åç«¯æœåŠ¡å™¨åº”â½¤è¿˜æ˜¯å‰ç«¯åº”â½¤å¼€å‘ï¼Œç»â¼¤å¤šæ•°æ—¶å€™éƒ½æ˜¯åœ¨å€ŸåŠ©å¼€å‘æ¡†æ¶å’Œå„ç§ç±»åº“è¿›â¾å¿«é€Ÿå¼€å‘ï¼Œâ¼€æ—¦ç¬¬ä¸‰â½…åº“è¢«æ¤â¼Šæ¶æ„ä»£ç å¾ˆå®¹æ˜“å¼•èµ·å®‰å…¨é—®é¢˜ã€‚</li></ul><h3 id="7-ç½‘ç»œåŠ«æŒæœ‰å“ªå‡ ç§ï¼Œå¦‚ä½•é˜²èŒƒï¼Ÿ"><a href="#7-ç½‘ç»œåŠ«æŒæœ‰å“ªå‡ ç§ï¼Œå¦‚ä½•é˜²èŒƒï¼Ÿ" class="headerlink" title="7. ç½‘ç»œåŠ«æŒæœ‰å“ªå‡ ç§ï¼Œå¦‚ä½•é˜²èŒƒï¼Ÿ"></a>7. ç½‘ç»œåŠ«æŒæœ‰å“ªå‡ ç§ï¼Œå¦‚ä½•é˜²èŒƒï¼Ÿ</h3><p>â½¹ç»œåŠ«æŒåˆ†ä¸ºä¸¤ç§: </p><p>ï¼ˆ1ï¼‰<strong>DNSåŠ«æŒ</strong>: (è¾“â¼Šäº¬ä¸œè¢«å¼ºåˆ¶è·³è½¬åˆ°æ·˜å®è¿™å°±å±äºdnsåŠ«æŒ) </p><ul><li>DNSå¼ºåˆ¶è§£æ: é€šè¿‡ä¿®æ”¹è¿è¥å•†çš„æœ¬åœ°DNSè®°å½•ï¼Œæ¥å¼•å¯¼â½¤æˆ·æµé‡åˆ°ç¼“å­˜æœåŠ¡å™¨</li><li>302è·³è½¬çš„â½…å¼: é€šè¿‡ç›‘æ§â½¹ç»œå‡ºâ¼çš„æµé‡ï¼Œåˆ†æåˆ¤æ–­å“ªäº›å†…å®¹æ˜¯å¯ä»¥è¿›â¾åŠ«æŒå¤„ç†çš„,å†å¯¹åŠ«æŒçš„å†…å­˜å‘èµ·302è·³è½¬çš„å›å¤ï¼Œå¼•å¯¼â½¤æˆ·è·å–å†…å®¹ </li></ul><p>ï¼ˆ2ï¼‰<strong>HTTPåŠ«æŒ</strong>: (è®¿é—®â¾•æ­Œä½†æ˜¯â¼€ç›´æœ‰è´ªç©è“â½‰çš„â¼´å‘Š),ç”±äºhttpæ˜â½‚ä¼ è¾“,è¿è¥å•†ä¼šä¿®æ”¹ä½ çš„httpå“åº”å†…å®¹(å³åŠ â¼´å‘Š) </p><p>DNSåŠ«æŒç”±äºæ¶‰å«Œè¿æ³•ï¼Œå·²ç»è¢«ç›‘ç®¡èµ·æ¥ï¼Œç°åœ¨å¾ˆå°‘ä¼šæœ‰DNSåŠ«æŒï¼Œâ½½httpåŠ«æŒä¾ç„¶â¾®å¸¸ç››â¾ï¼Œæœ€æœ‰æ•ˆçš„åŠæ³•å°±æ˜¯å…¨ç«™HTTPSï¼Œå°†HTTPåŠ å¯†ï¼Œè¿™ä½¿å¾—è¿è¥å•†â½†æ³•è·å–æ˜â½‚ï¼Œå°±â½†æ³•åŠ«æŒä½ çš„å“åº”å†…å®¹ã€‚ </p><h2 id="äºŒã€è¿›ç¨‹ä¸çº¿ç¨‹"><a href="#äºŒã€è¿›ç¨‹ä¸çº¿ç¨‹" class="headerlink" title="äºŒã€è¿›ç¨‹ä¸çº¿ç¨‹"></a>äºŒã€è¿›ç¨‹ä¸çº¿ç¨‹</h2><h3 id="1-è¿›ç¨‹ä¸çº¿ç¨‹çš„æ¦‚å¿µ"><a href="#1-è¿›ç¨‹ä¸çº¿ç¨‹çš„æ¦‚å¿µ" class="headerlink" title="1. è¿›ç¨‹ä¸çº¿ç¨‹çš„æ¦‚å¿µ"></a>1. è¿›ç¨‹ä¸çº¿ç¨‹çš„æ¦‚å¿µ</h3><p>ä»æœ¬è´¨ä¸Šè¯´ï¼Œè¿›ç¨‹å’Œçº¿ç¨‹éƒ½æ˜¯ CPU å·¥ä½œæ—¶é—´ç‰‡çš„ä¸€ä¸ªæè¿°ï¼š</p><ul><li>è¿›ç¨‹æè¿°äº† CPU åœ¨è¿è¡ŒæŒ‡ä»¤åŠåŠ è½½å’Œä¿å­˜ä¸Šä¸‹æ–‡æ‰€éœ€çš„æ—¶é—´ï¼Œæ”¾åœ¨åº”ç”¨ä¸Šæ¥è¯´å°±ä»£è¡¨äº†ä¸€ä¸ªç¨‹åºã€‚</li><li>çº¿ç¨‹æ˜¯è¿›ç¨‹ä¸­çš„æ›´å°å•ä½ï¼Œæè¿°äº†æ‰§è¡Œä¸€æ®µæŒ‡ä»¤æ‰€éœ€çš„æ—¶é—´ã€‚</li></ul><p><strong>è¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„æœ€å°å•ä½ï¼Œçº¿ç¨‹æ˜¯CPUè°ƒåº¦çš„æœ€å°å•ä½ã€‚</strong></p><p>ä¸€ä¸ªè¿›ç¨‹å°±æ˜¯ä¸€ä¸ªç¨‹åºçš„è¿è¡Œå®ä¾‹ã€‚è¯¦ç»†è§£é‡Šå°±æ˜¯ï¼Œå¯åŠ¨ä¸€ä¸ªç¨‹åºçš„æ—¶å€™ï¼Œæ“ä½œç³»ç»Ÿä¼šä¸ºè¯¥ç¨‹åºåˆ›å»ºä¸€å—å†…å­˜ï¼Œç”¨æ¥å­˜æ”¾ä»£ç ã€è¿è¡Œä¸­çš„æ•°æ®å’Œä¸€ä¸ªæ‰§è¡Œä»»åŠ¡çš„ä¸»çº¿ç¨‹ï¼Œæˆ‘ä»¬æŠŠè¿™æ ·çš„ä¸€ä¸ªè¿è¡Œç¯å¢ƒå«<strong>è¿›ç¨‹</strong>ã€‚<strong>è¿›ç¨‹æ˜¯è¿è¡Œåœ¨è™šæ‹Ÿå†…å­˜ä¸Šçš„ï¼Œè™šæ‹Ÿå†…å­˜æ˜¯ç”¨æ¥è§£å†³ç”¨æˆ·å¯¹ç¡¬ä»¶èµ„æºçš„æ— é™éœ€æ±‚å’Œæœ‰é™çš„ç¡¬ä»¶èµ„æºä¹‹é—´çš„çŸ›ç›¾çš„ã€‚ä»æ“ä½œç³»ç»Ÿè§’åº¦æ¥çœ‹ï¼Œè™šæ‹Ÿå†…å­˜å³äº¤æ¢æ–‡ä»¶ï¼›ä»å¤„ç†å™¨è§’åº¦çœ‹ï¼Œè™šæ‹Ÿå†…å­˜å³è™šæ‹Ÿåœ°å€ç©ºé—´ã€‚</strong></p><p>å¦‚æœç¨‹åºå¾ˆå¤šæ—¶ï¼Œå†…å­˜å¯èƒ½ä¼šä¸å¤Ÿï¼Œæ“ä½œç³»ç»Ÿä¸ºæ¯ä¸ªè¿›ç¨‹æä¾›ä¸€å¥—ç‹¬ç«‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´ï¼Œä»è€Œä½¿å¾—åŒä¸€å—ç‰©ç†å†…å­˜åœ¨ä¸åŒçš„è¿›ç¨‹ä¸­å¯ä»¥å¯¹åº”åˆ°ä¸åŒæˆ–ç›¸åŒçš„è™šæ‹Ÿåœ°å€ï¼Œå˜ç›¸çš„å¢åŠ äº†ç¨‹åºå¯ä»¥ä½¿ç”¨çš„å†…å­˜ã€‚</p><p>è¿›ç¨‹å’Œçº¿ç¨‹ä¹‹é—´çš„å…³ç³»æœ‰ä»¥ä¸‹å››ä¸ªç‰¹ç‚¹ï¼š</p><p><strong>ï¼ˆ1ï¼‰è¿›ç¨‹ä¸­çš„ä»»æ„ä¸€çº¿ç¨‹æ‰§è¡Œå‡ºé”™ï¼Œéƒ½ä¼šå¯¼è‡´æ•´ä¸ªè¿›ç¨‹çš„å´©æºƒã€‚</strong></p><p><strong>ï¼ˆ2ï¼‰çº¿ç¨‹ä¹‹é—´å…±äº«è¿›ç¨‹ä¸­çš„æ•°æ®ã€‚</strong></p><p><strong>ï¼ˆ3ï¼‰å½“ä¸€ä¸ªè¿›ç¨‹å…³é—­ä¹‹åï¼Œæ“ä½œç³»ç»Ÿä¼šå›æ”¶è¿›ç¨‹æ‰€å ç”¨çš„å†…å­˜ï¼Œ</strong> å½“ä¸€ä¸ªè¿›ç¨‹é€€å‡ºæ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šå›æ”¶è¯¥è¿›ç¨‹æ‰€ç”³è¯·çš„æ‰€æœ‰èµ„æºï¼›å³ä½¿å…¶ä¸­ä»»æ„çº¿ç¨‹å› ä¸ºæ“ä½œä¸å½“å¯¼è‡´å†…å­˜æ³„æ¼ï¼Œå½“è¿›ç¨‹é€€å‡ºæ—¶ï¼Œè¿™äº›å†…å­˜ä¹Ÿä¼šè¢«æ­£ç¡®å›æ”¶ã€‚</p><p><strong>ï¼ˆ4ï¼‰è¿›ç¨‹ä¹‹é—´çš„å†…å®¹ç›¸äº’éš”ç¦»ã€‚</strong> è¿›ç¨‹éš”ç¦»å°±æ˜¯ä¸ºäº†ä½¿æ“ä½œç³»ç»Ÿä¸­çš„è¿›ç¨‹äº’ä¸å¹²æ‰°ï¼Œæ¯ä¸€ä¸ªè¿›ç¨‹åªèƒ½è®¿é—®è‡ªå·±å æœ‰çš„æ•°æ®ï¼Œä¹Ÿå°±é¿å…å‡ºç°è¿›ç¨‹ A å†™å…¥æ•°æ®åˆ°è¿›ç¨‹ B çš„æƒ…å†µã€‚æ­£æ˜¯å› ä¸ºè¿›ç¨‹ä¹‹é—´çš„æ•°æ®æ˜¯ä¸¥æ ¼éš”ç¦»çš„ï¼Œæ‰€ä»¥ä¸€ä¸ªè¿›ç¨‹å¦‚æœå´©æºƒäº†ï¼Œæˆ–è€…æŒ‚èµ·äº†ï¼Œæ˜¯ä¸ä¼šå½±å“åˆ°å…¶ä»–è¿›ç¨‹çš„ã€‚å¦‚æœè¿›ç¨‹ä¹‹é—´éœ€è¦è¿›è¡Œæ•°æ®çš„é€šä¿¡ï¼Œè¿™æ—¶å€™ï¼Œå°±éœ€è¦ä½¿ç”¨ç”¨äºè¿›ç¨‹é—´é€šä¿¡çš„æœºåˆ¶äº†ã€‚</p><p><strong>Chromeæµè§ˆå™¨çš„æ¶æ„å›¾</strong>ï¼š<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/theory/2.png" alt=""><br>ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œæœ€æ–°çš„ Chrome æµè§ˆå™¨åŒ…æ‹¬ï¼š</p><ul><li>1 ä¸ªæµè§ˆå™¨ä¸»è¿›ç¨‹</li><li>1 ä¸ª GPU è¿›ç¨‹</li><li>1 ä¸ªç½‘ç»œè¿›ç¨‹</li><li>å¤šä¸ªæ¸²æŸ“è¿›ç¨‹</li><li>å¤šä¸ªæ’ä»¶è¿›ç¨‹</li></ul><p>è¿™äº›è¿›ç¨‹çš„åŠŸèƒ½ï¼š</p><ul><li><strong>æµè§ˆå™¨è¿›ç¨‹</strong>ï¼šä¸»è¦è´Ÿè´£ç•Œé¢æ˜¾ç¤ºã€ç”¨æˆ·äº¤äº’ã€å­è¿›ç¨‹ç®¡ç†ï¼ŒåŒæ—¶æä¾›å­˜å‚¨ç­‰åŠŸèƒ½ã€‚</li><li><strong>æ¸²æŸ“è¿›ç¨‹</strong>ï¼šæ ¸å¿ƒä»»åŠ¡æ˜¯å°† HTMLã€CSS å’Œ JavaScript è½¬æ¢ä¸ºç”¨æˆ·å¯ä»¥ä¸ä¹‹äº¤äº’çš„ç½‘é¡µï¼Œæ’ç‰ˆå¼•æ“ Blink å’Œ JavaScript å¼•æ“ V8 éƒ½æ˜¯è¿è¡Œåœ¨è¯¥è¿›ç¨‹ä¸­ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼ŒChrome ä¼šä¸ºæ¯ä¸ª Tab æ ‡ç­¾åˆ›å»ºä¸€ä¸ªæ¸²æŸ“è¿›ç¨‹ã€‚å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œæ¸²æŸ“è¿›ç¨‹éƒ½æ˜¯è¿è¡Œåœ¨æ²™ç®±æ¨¡å¼ä¸‹ã€‚</li><li><strong>GPU è¿›ç¨‹</strong>ï¼šå…¶å®ï¼Œ GPU çš„ä½¿ç”¨åˆè¡·æ˜¯ä¸ºäº†å®ç° 3D CSS çš„æ•ˆæœï¼Œåªæ˜¯éšåç½‘é¡µã€Chrome çš„ UI ç•Œé¢éƒ½é€‰æ‹©é‡‡ç”¨ GPU æ¥ç»˜åˆ¶ï¼Œè¿™ä½¿å¾— GPU æˆä¸ºæµè§ˆå™¨æ™®éçš„éœ€æ±‚ã€‚æœ€åï¼ŒChrome åœ¨å…¶å¤šè¿›ç¨‹æ¶æ„ä¸Šä¹Ÿå¼•å…¥äº† GPU è¿›ç¨‹ã€‚</li><li><strong>ç½‘ç»œè¿›ç¨‹</strong>ï¼šä¸»è¦è´Ÿè´£é¡µé¢çš„ç½‘ç»œèµ„æºåŠ è½½ï¼Œä¹‹å‰æ˜¯ä½œä¸ºä¸€ä¸ªæ¨¡å—è¿è¡Œåœ¨æµè§ˆå™¨è¿›ç¨‹é‡Œé¢çš„ï¼Œç›´è‡³æœ€è¿‘æ‰ç‹¬ç«‹å‡ºæ¥ï¼Œæˆä¸ºä¸€ä¸ªå•ç‹¬çš„è¿›ç¨‹ã€‚</li><li><strong>æ’ä»¶è¿›ç¨‹</strong>ï¼šä¸»è¦æ˜¯è´Ÿè´£æ’ä»¶çš„è¿è¡Œï¼Œå› æ’ä»¶æ˜“å´©æºƒï¼Œæ‰€ä»¥éœ€è¦é€šè¿‡æ’ä»¶è¿›ç¨‹æ¥éš”ç¦»ï¼Œä»¥ä¿è¯æ’ä»¶è¿›ç¨‹å´©æºƒä¸ä¼šå¯¹æµè§ˆå™¨å’Œé¡µé¢é€ æˆå½±å“ã€‚</li></ul><p>æ‰€ä»¥ï¼Œ<strong>æ‰“å¼€ä¸€ä¸ªç½‘é¡µï¼Œæœ€å°‘éœ€è¦å››ä¸ªè¿›ç¨‹</strong>ï¼š1 ä¸ªç½‘ç»œè¿›ç¨‹ã€1 ä¸ªæµè§ˆå™¨è¿›ç¨‹ã€1 ä¸ª GPU è¿›ç¨‹ä»¥åŠ 1 ä¸ªæ¸²æŸ“è¿›ç¨‹ã€‚å¦‚æœæ‰“å¼€çš„é¡µé¢æœ‰è¿è¡Œæ’ä»¶çš„è¯ï¼Œè¿˜éœ€è¦å†åŠ ä¸Š 1 ä¸ªæ’ä»¶è¿›ç¨‹ã€‚</p><p>è™½ç„¶å¤šè¿›ç¨‹æ¨¡å‹æå‡äº†æµè§ˆå™¨çš„ç¨³å®šæ€§ã€æµç•…æ€§å’Œå®‰å…¨æ€§ï¼Œä½†åŒæ ·ä¸å¯é¿å…åœ°å¸¦æ¥äº†ä¸€äº›é—®é¢˜ï¼š</p><ul><li><strong>æ›´é«˜çš„èµ„æºå ç”¨</strong>ï¼šå› ä¸ºæ¯ä¸ªè¿›ç¨‹éƒ½ä¼šåŒ…å«å…¬å…±åŸºç¡€ç»“æ„çš„å‰¯æœ¬ï¼ˆå¦‚ JavaScript è¿è¡Œç¯å¢ƒï¼‰ï¼Œè¿™å°±æ„å‘³ç€æµè§ˆå™¨ä¼šæ¶ˆè€—æ›´å¤šçš„å†…å­˜èµ„æºã€‚</li><li><strong>æ›´å¤æ‚çš„ä½“ç³»æ¶æ„</strong>ï¼šæµè§ˆå™¨å„æ¨¡å—ä¹‹é—´è€¦åˆæ€§é«˜ã€æ‰©å±•æ€§å·®ç­‰é—®é¢˜ï¼Œä¼šå¯¼è‡´ç°åœ¨çš„æ¶æ„å·²ç»å¾ˆéš¾é€‚åº”æ–°çš„éœ€æ±‚äº†ã€‚</li></ul><h3 id="2-è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«"><a href="#2-è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«" class="headerlink" title="2. è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«"></a>2. è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«</h3><ul><li>è¿›ç¨‹å¯ä»¥çœ‹åšç‹¬ç«‹åº”ç”¨ï¼Œçº¿ç¨‹ä¸èƒ½</li><li>èµ„æºï¼šè¿›ç¨‹æ˜¯cpuèµ„æºåˆ†é…çš„æœ€å°å•ä½ï¼ˆæ˜¯èƒ½æ‹¥æœ‰èµ„æºå’Œç‹¬ç«‹è¿è¡Œçš„æœ€å°å•ä½ï¼‰ï¼›çº¿ç¨‹æ˜¯cpuè°ƒåº¦çš„æœ€å°å•ä½ï¼ˆçº¿ç¨‹æ˜¯å»ºç«‹åœ¨è¿›ç¨‹çš„åŸºç¡€ä¸Šçš„ä¸€æ¬¡ç¨‹åºè¿è¡Œå•ä½ï¼Œä¸€ä¸ªè¿›ç¨‹ä¸­å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹ï¼‰ã€‚</li><li>é€šä¿¡æ–¹é¢ï¼šçº¿ç¨‹é—´å¯ä»¥é€šè¿‡ç›´æ¥å…±äº«åŒä¸€è¿›ç¨‹ä¸­çš„èµ„æºï¼Œè€Œè¿›ç¨‹é€šä¿¡éœ€è¦å€ŸåŠ© è¿›ç¨‹é—´é€šä¿¡ã€‚</li><li>è°ƒåº¦ï¼šè¿›ç¨‹åˆ‡æ¢æ¯”çº¿ç¨‹åˆ‡æ¢çš„å¼€é”€è¦å¤§ã€‚çº¿ç¨‹æ˜¯CPUè°ƒåº¦çš„åŸºæœ¬å•ä½ï¼Œçº¿ç¨‹çš„åˆ‡æ¢ä¸ä¼šå¼•èµ·è¿›ç¨‹åˆ‡æ¢ï¼Œä½†æŸä¸ªè¿›ç¨‹ä¸­çš„çº¿ç¨‹åˆ‡æ¢åˆ°å¦ä¸€ä¸ªè¿›ç¨‹ä¸­çš„çº¿ç¨‹æ—¶ï¼Œä¼šå¼•èµ·è¿›ç¨‹åˆ‡æ¢ã€‚</li><li>ç³»ç»Ÿå¼€é”€ï¼šç”±äºåˆ›å»ºæˆ–æ’¤é”€è¿›ç¨‹æ—¶ï¼Œç³»ç»Ÿéƒ½è¦ä¸ºä¹‹åˆ†é…æˆ–å›æ”¶èµ„æºï¼Œå¦‚å†…å­˜ã€I/O ç­‰ï¼Œå…¶å¼€é”€è¿œå¤§äºåˆ›å»ºæˆ–æ’¤é”€çº¿ç¨‹æ—¶çš„å¼€é”€ã€‚åŒç†ï¼Œåœ¨è¿›è¡Œè¿›ç¨‹åˆ‡æ¢æ—¶ï¼Œæ¶‰åŠå½“å‰æ‰§è¡Œè¿›ç¨‹ CPU ç¯å¢ƒè¿˜æœ‰å„ç§å„æ ·çŠ¶æ€çš„ä¿å­˜åŠæ–°è°ƒåº¦è¿›ç¨‹çŠ¶æ€çš„è®¾ç½®ï¼Œè€Œçº¿ç¨‹åˆ‡æ¢æ—¶åªéœ€ä¿å­˜å’Œè®¾ç½®å°‘é‡å¯„å­˜å™¨å†…å®¹ï¼Œå¼€é”€è¾ƒå°ã€‚</li></ul><h3 id="3-æµè§ˆå™¨æ¸²æŸ“è¿›ç¨‹çš„çº¿ç¨‹æœ‰å“ªäº›"><a href="#3-æµè§ˆå™¨æ¸²æŸ“è¿›ç¨‹çš„çº¿ç¨‹æœ‰å“ªäº›" class="headerlink" title="3. æµè§ˆå™¨æ¸²æŸ“è¿›ç¨‹çš„çº¿ç¨‹æœ‰å“ªäº›"></a>3. æµè§ˆå™¨æ¸²æŸ“è¿›ç¨‹çš„çº¿ç¨‹æœ‰å“ªäº›</h3><p>æµè§ˆå™¨çš„æ¸²æŸ“è¿›ç¨‹çš„çº¿ç¨‹æ€»å…±æœ‰äº”ç§ï¼š<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/theory/3.png" alt=""><br><strong>ï¼ˆ1ï¼‰GUIæ¸²æŸ“çº¿ç¨‹</strong><br>è´Ÿè´£æ¸²æŸ“æµè§ˆå™¨é¡µé¢ï¼Œè§£æHTMLã€CSSï¼Œæ„å»ºDOMæ ‘ã€æ„å»ºCSSOMæ ‘ã€æ„å»ºæ¸²æŸ“æ ‘å’Œç»˜åˆ¶é¡µé¢ï¼›å½“ç•Œé¢éœ€è¦<strong>é‡ç»˜</strong>æˆ–ç”±äºæŸç§æ“ä½œå¼•å‘<strong>å›æµ</strong>æ—¶ï¼Œè¯¥çº¿ç¨‹å°±ä¼šæ‰§è¡Œã€‚</p><p>æ³¨æ„ï¼šGUIæ¸²æŸ“çº¿ç¨‹å’ŒJSå¼•æ“çº¿ç¨‹æ˜¯äº’æ–¥çš„ï¼Œå½“JSå¼•æ“æ‰§è¡Œæ—¶GUIçº¿ç¨‹ä¼šè¢«æŒ‚èµ·ï¼ŒGUIæ›´æ–°ä¼šè¢«ä¿å­˜åœ¨ä¸€ä¸ªé˜Ÿåˆ—ä¸­ç­‰åˆ°JSå¼•æ“ç©ºé—²æ—¶ç«‹å³è¢«æ‰§è¡Œã€‚</p><p><strong>ï¼ˆ2ï¼‰JSå¼•æ“çº¿ç¨‹</strong><br>JSå¼•æ“çº¿ç¨‹ä¹Ÿç§°ä¸ºJSå†…æ ¸ï¼Œè´Ÿè´£å¤„ç†Javascriptè„šæœ¬ç¨‹åºï¼Œè§£æJavascriptè„šæœ¬ï¼Œè¿è¡Œä»£ç ï¼›JSå¼•æ“çº¿ç¨‹ä¸€ç›´ç­‰å¾…ç€ä»»åŠ¡é˜Ÿåˆ—ä¸­ä»»åŠ¡çš„åˆ°æ¥ï¼Œç„¶ååŠ ä»¥å¤„ç†ï¼Œä¸€ä¸ªTabé¡µä¸­æ— è®ºä»€ä¹ˆæ—¶å€™éƒ½åªæœ‰ä¸€ä¸ªJSå¼•æ“çº¿ç¨‹åœ¨è¿è¡ŒJSç¨‹åºï¼›</p><p>æ³¨æ„ï¼šGUIæ¸²æŸ“çº¿ç¨‹ä¸JSå¼•æ“çº¿ç¨‹çš„äº’æ–¥å…³ç³»ï¼Œæ‰€ä»¥å¦‚æœJSæ‰§è¡Œçš„æ—¶é—´è¿‡é•¿ï¼Œä¼šé€ æˆé¡µé¢çš„æ¸²æŸ“ä¸è¿è´¯ï¼Œå¯¼è‡´é¡µé¢æ¸²æŸ“åŠ è½½é˜»å¡ã€‚</p><p><strong>ï¼ˆ3ï¼‰æ—¶é—´è§¦å‘çº¿ç¨‹</strong><br><strong>æ—¶é—´è§¦å‘çº¿ç¨‹</strong>å±äºæµè§ˆå™¨è€Œä¸æ˜¯JSå¼•æ“ï¼Œç”¨æ¥æ§åˆ¶äº‹ä»¶å¾ªç¯ï¼›å½“JSå¼•æ“æ‰§è¡Œä»£ç å—å¦‚setTimeOutæ—¶ï¼ˆä¹Ÿå¯æ˜¯æ¥è‡ªæµè§ˆå™¨å†…æ ¸çš„å…¶ä»–çº¿ç¨‹,å¦‚é¼ æ ‡ç‚¹å‡»ã€AJAXå¼‚æ­¥è¯·æ±‚ç­‰ï¼‰ï¼Œä¼šå°†å¯¹åº”ä»»åŠ¡æ·»åŠ åˆ°äº‹ä»¶è§¦å‘çº¿ç¨‹ä¸­ï¼›å½“å¯¹åº”çš„äº‹ä»¶ç¬¦åˆè§¦å‘æ¡ä»¶è¢«è§¦å‘æ—¶ï¼Œè¯¥çº¿ç¨‹ä¼šæŠŠäº‹ä»¶æ·»åŠ åˆ°å¾…å¤„ç†é˜Ÿåˆ—çš„é˜Ÿå°¾ï¼Œç­‰å¾…JSå¼•æ“çš„å¤„ç†ï¼›</p><p>æ³¨æ„ï¼šç”±äºJSçš„å•çº¿ç¨‹å…³ç³»ï¼Œæ‰€ä»¥è¿™äº›å¾…å¤„ç†é˜Ÿåˆ—ä¸­çš„äº‹ä»¶éƒ½å¾—æ’é˜Ÿç­‰å¾…JSå¼•æ“å¤„ç†ï¼ˆå½“JSå¼•æ“ç©ºé—²æ—¶æ‰ä¼šå»æ‰§è¡Œï¼‰ï¼›</p><p><strong>ï¼ˆ4ï¼‰å®šæ—¶å™¨è§¦å‘è¿›ç¨‹</strong><br><strong>å®šæ—¶å™¨è§¦å‘è¿›ç¨‹</strong>å³setIntervalä¸setTimeoutæ‰€åœ¨çº¿ç¨‹ï¼›æµè§ˆå™¨å®šæ—¶è®¡æ•°å™¨å¹¶ä¸æ˜¯ç”±JSå¼•æ“è®¡æ•°çš„ï¼Œå› ä¸ºJSå¼•æ“æ˜¯å•çº¿ç¨‹çš„ï¼Œå¦‚æœå¤„äºé˜»å¡çº¿ç¨‹çŠ¶æ€å°±ä¼šå½±å“è®°è®¡æ—¶çš„å‡†ç¡®æ€§ï¼›å› æ­¤ä½¿ç”¨å•ç‹¬çº¿ç¨‹æ¥è®¡æ—¶å¹¶è§¦å‘å®šæ—¶å™¨ï¼Œè®¡æ—¶å®Œæ¯•åï¼Œæ·»åŠ åˆ°äº‹ä»¶é˜Ÿåˆ—ä¸­ï¼Œç­‰å¾…JSå¼•æ“ç©ºé—²åæ‰§è¡Œï¼Œæ‰€ä»¥å®šæ—¶å™¨ä¸­çš„ä»»åŠ¡åœ¨è®¾å®šçš„æ—¶é—´ç‚¹ä¸ä¸€å®šèƒ½å¤Ÿå‡†æ—¶æ‰§è¡Œï¼Œå®šæ—¶å™¨åªæ˜¯åœ¨æŒ‡å®šæ—¶é—´ç‚¹å°†ä»»åŠ¡æ·»åŠ åˆ°äº‹ä»¶é˜Ÿåˆ—ä¸­ï¼›</p><p>æ³¨æ„ï¼šW3Cåœ¨HTMLæ ‡å‡†ä¸­è§„å®šï¼Œå®šæ—¶å™¨çš„å®šæ—¶æ—¶é—´ä¸èƒ½å°äº4msï¼Œå¦‚æœæ˜¯å°äº4msï¼Œåˆ™é»˜è®¤ä¸º4msã€‚</p><p><strong>ï¼ˆ5ï¼‰å¼‚æ­¥httpè¯·æ±‚çº¿ç¨‹</strong></p><ul><li>XMLHttpRequestè¿æ¥åé€šè¿‡æµè§ˆå™¨æ–°å¼€ä¸€ä¸ªçº¿ç¨‹è¯·æ±‚ï¼›</li><li>æ£€æµ‹åˆ°çŠ¶æ€å˜æ›´æ—¶ï¼Œå¦‚æœè®¾ç½®æœ‰å›è°ƒå‡½æ•°ï¼Œå¼‚æ­¥çº¿ç¨‹å°±äº§ç”ŸçŠ¶æ€å˜æ›´äº‹ä»¶ï¼Œå°†å›è°ƒå‡½æ•°æ”¾å…¥äº‹ä»¶é˜Ÿåˆ—ä¸­ï¼Œç­‰å¾…JSå¼•æ“ç©ºé—²åæ‰§è¡Œï¼›</li></ul><h3 id="4-è¿›ç¨‹ä¹‹å‰çš„é€šä¿¡æ–¹å¼"><a href="#4-è¿›ç¨‹ä¹‹å‰çš„é€šä¿¡æ–¹å¼" class="headerlink" title="4. è¿›ç¨‹ä¹‹å‰çš„é€šä¿¡æ–¹å¼"></a>4. è¿›ç¨‹ä¹‹å‰çš„é€šä¿¡æ–¹å¼</h3><p><strong>ï¼ˆ1ï¼‰ç®¡é“é€šä¿¡</strong></p><p>ç®¡é“æ˜¯ä¸€ç§æœ€åŸºæœ¬çš„è¿›ç¨‹é—´é€šä¿¡æœºåˆ¶ã€‚<strong>ç®¡é“å°±æ˜¯æ“ä½œç³»ç»Ÿåœ¨å†…æ ¸ä¸­å¼€è¾Ÿçš„ä¸€æ®µç¼“å†²åŒºï¼Œè¿›ç¨‹1å¯ä»¥å°†éœ€è¦äº¤äº’çš„æ•°æ®æ‹·è´åˆ°è¿™æ®µç¼“å†²åŒºï¼Œè¿›ç¨‹2å°±å¯ä»¥è¯»å–äº†ã€‚</strong></p><p>ç®¡é“çš„ç‰¹ç‚¹ï¼š</p><ul><li>åªèƒ½å•å‘é€šä¿¡</li><li>åªèƒ½è¡€ç¼˜å…³ç³»çš„è¿›ç¨‹è¿›è¡Œé€šä¿¡</li><li>ä¾èµ–äºæ–‡ä»¶ç³»ç»Ÿ</li><li>ç”Ÿå‘½å‘¨æœŸéšè¿›ç¨‹</li><li>é¢å‘å­—èŠ‚æµçš„æœåŠ¡</li><li>ç®¡é“å†…éƒ¨æä¾›äº†åŒæ­¥æœºåˆ¶</li></ul><p><strong>ï¼ˆ2ï¼‰æ¶ˆæ¯é˜Ÿåˆ—é€šä¿¡</strong></p><p>æ¶ˆæ¯é˜Ÿåˆ—å°±æ˜¯ä¸€ä¸ªæ¶ˆæ¯çš„åˆ—è¡¨ã€‚ç”¨æˆ·å¯ä»¥åœ¨æ¶ˆæ¯é˜Ÿåˆ—ä¸­æ·»åŠ æ¶ˆæ¯ã€è¯»å–æ¶ˆæ¯ç­‰ã€‚æ¶ˆæ¯é˜Ÿåˆ—æä¾›äº†ä¸€ç§ä»ä¸€ä¸ªè¿›ç¨‹å‘å¦ä¸€ä¸ªè¿›ç¨‹å‘é€ä¸€ä¸ªæ•°æ®å—çš„æ–¹æ³•ã€‚ æ¯ä¸ªæ•°æ®å—éƒ½è¢«è®¤ä¸ºå«æœ‰ä¸€ä¸ªç±»å‹ï¼Œæ¥æ”¶è¿›ç¨‹å¯ä»¥ç‹¬ç«‹åœ°æ¥æ”¶å«æœ‰ä¸åŒç±»å‹çš„æ•°æ®ç»“æ„ã€‚å¯ä»¥é€šè¿‡å‘é€æ¶ˆæ¯æ¥é¿å…å‘½åç®¡é“çš„åŒæ­¥å’Œé˜»å¡é—®é¢˜ã€‚ä½†æ˜¯æ¶ˆæ¯é˜Ÿåˆ—ä¸å‘½åç®¡é“ä¸€æ ·ï¼Œæ¯ä¸ªæ•°æ®å—éƒ½æœ‰ä¸€ä¸ªæœ€å¤§é•¿åº¦çš„é™åˆ¶ã€‚</p><p>ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—è¿›è¡Œè¿›ç¨‹é—´é€šä¿¡ï¼Œå¯èƒ½ä¼šæ”¶åˆ°æ•°æ®å—æœ€å¤§é•¿åº¦çš„é™åˆ¶çº¦æŸç­‰ï¼Œè¿™ä¹Ÿæ˜¯è¿™ç§é€šä¿¡æ–¹å¼çš„ç¼ºç‚¹ã€‚å¦‚æœé¢‘ç¹çš„å‘ç”Ÿè¿›ç¨‹é—´çš„é€šä¿¡è¡Œä¸ºï¼Œé‚£ä¹ˆè¿›ç¨‹éœ€è¦é¢‘ç¹åœ°è¯»å–é˜Ÿåˆ—ä¸­çš„æ•°æ®åˆ°å†…å­˜ï¼Œç›¸å½“äºé—´æ¥åœ°ä»ä¸€ä¸ªè¿›ç¨‹æ‹·è´åˆ°å¦ä¸€ä¸ªè¿›ç¨‹ï¼Œè¿™éœ€è¦èŠ±è´¹æ—¶é—´ã€‚</p><p><strong>ï¼ˆ3ï¼‰ä¿¡å·é‡é€šä¿¡</strong></p><p>å…±äº«å†…å­˜æœ€å¤§çš„é—®é¢˜å°±æ˜¯å¤šè¿›ç¨‹ç«äº‰å†…å­˜çš„é—®é¢˜ï¼Œå°±åƒç±»ä¼¼äºçº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¿¡å·é‡æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ä¿¡å·é‡çš„æœ¬è´¨å°±æ˜¯ä¸€ä¸ªè®¡æ•°å™¨ï¼Œç”¨æ¥å®ç°è¿›ç¨‹ä¹‹é—´çš„äº’æ–¥ä¸åŒæ­¥ã€‚ä¾‹å¦‚ä¿¡å·é‡çš„åˆå§‹å€¼æ˜¯ 1ï¼Œç„¶å a è¿›ç¨‹æ¥è®¿é—®å†…å­˜1çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±æŠŠä¿¡å·é‡çš„å€¼è®¾ä¸º 0ï¼Œç„¶åè¿›ç¨‹b ä¹Ÿè¦æ¥è®¿é—®å†…å­˜1çš„æ—¶å€™ï¼Œçœ‹åˆ°ä¿¡å·é‡çš„å€¼ä¸º 0 å°±çŸ¥é“å·²ç»æœ‰è¿›ç¨‹åœ¨è®¿é—®å†…å­˜1äº†ï¼Œè¿™ä¸ªæ—¶å€™è¿›ç¨‹ b å°±ä¼šè®¿é—®ä¸äº†å†…å­˜1ã€‚æ‰€ä»¥è¯´ï¼Œä¿¡å·é‡ä¹Ÿæ˜¯è¿›ç¨‹ä¹‹é—´çš„ä¸€ç§é€šä¿¡æ–¹å¼ã€‚</p><p><strong>ï¼ˆ4ï¼‰ä¿¡å·é€šä¿¡</strong></p><p>ä¿¡å·ï¼ˆSignals ï¼‰æ˜¯Unixç³»ç»Ÿä¸­ä½¿ç”¨çš„æœ€å¤è€çš„è¿›ç¨‹é—´é€šä¿¡çš„æ–¹æ³•ä¹‹ä¸€ã€‚æ“ä½œç³»ç»Ÿé€šè¿‡ä¿¡å·æ¥é€šçŸ¥è¿›ç¨‹ç³»ç»Ÿä¸­å‘ç”Ÿäº†æŸç§é¢„å…ˆè§„å®šå¥½çš„äº‹ä»¶ï¼ˆä¸€ç»„äº‹ä»¶ä¸­çš„ä¸€ä¸ªï¼‰ï¼Œå®ƒä¹Ÿæ˜¯ç”¨æˆ·è¿›ç¨‹ä¹‹é—´é€šä¿¡å’ŒåŒæ­¥çš„ä¸€ç§åŸå§‹æœºåˆ¶ã€‚</p><p><strong>ï¼ˆ5ï¼‰å…±äº«å†…å­˜é€šä¿¡</strong></p><p>å…±äº«å†…å­˜å°±æ˜¯æ˜ å°„ä¸€æ®µèƒ½è¢«å…¶ä»–è¿›ç¨‹æ‰€è®¿é—®çš„å†…å­˜ï¼Œè¿™æ®µå…±äº«å†…å­˜ç”±ä¸€ä¸ªè¿›ç¨‹åˆ›å»ºï¼Œä½†å¤šä¸ªè¿›ç¨‹éƒ½å¯ä»¥è®¿é—®ï¼ˆä½¿å¤šä¸ªè¿›ç¨‹å¯ä»¥è®¿é—®åŒä¸€å—å†…å­˜ç©ºé—´ï¼‰ã€‚å…±äº«å†…å­˜æ˜¯æœ€å¿«çš„ IPC æ–¹å¼ï¼Œå®ƒæ˜¯é’ˆå¯¹å…¶ä»–è¿›ç¨‹é—´é€šä¿¡æ–¹å¼è¿è¡Œæ•ˆç‡ä½è€Œä¸“é—¨è®¾è®¡çš„ã€‚å®ƒå¾€å¾€ä¸å…¶ä»–é€šä¿¡æœºåˆ¶ï¼Œå¦‚ä¿¡å·é‡ï¼Œé…åˆä½¿ç”¨ï¼Œæ¥å®ç°è¿›ç¨‹é—´çš„åŒæ­¥å’Œé€šä¿¡ã€‚</p><p><strong>ï¼ˆ6ï¼‰å¥—æ¥å­—é€šä¿¡</strong></p><p>ä¸Šé¢è¯´çš„å…±äº«å†…å­˜ã€ç®¡é“ã€ä¿¡å·é‡ã€æ¶ˆæ¯é˜Ÿåˆ—ï¼Œä»–ä»¬éƒ½æ˜¯å¤šä¸ªè¿›ç¨‹åœ¨ä¸€å°ä¸»æœºä¹‹é—´çš„é€šä¿¡ï¼Œé‚£ä¸¤ä¸ªç›¸éš”å‡ åƒé‡Œçš„è¿›ç¨‹èƒ½å¤Ÿè¿›è¡Œé€šä¿¡å—ï¼Ÿç­”æ˜¯å¿…é¡»çš„ï¼Œè¿™ä¸ªæ—¶å€™ Socket è¿™å®¶ä¼™å°±æ´¾ä¸Šç”¨åœºäº†ï¼Œä¾‹å¦‚æˆ‘ä»¬å¹³æ—¶é€šè¿‡æµè§ˆå™¨å‘èµ·ä¸€ä¸ª http è¯·æ±‚ï¼Œç„¶åæœåŠ¡å™¨ç»™ä½ è¿”å›å¯¹åº”çš„æ•°æ®ï¼Œè¿™ç§å°±æ˜¯é‡‡ç”¨ Socket çš„é€šä¿¡æ–¹å¼äº†ã€‚</p><h3 id="5-åƒµå°¸è¿›ç¨‹å’Œå­¤å„¿è¿›ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#5-åƒµå°¸è¿›ç¨‹å’Œå­¤å„¿è¿›ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="5. åƒµå°¸è¿›ç¨‹å’Œå­¤å„¿è¿›ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ"></a>5. åƒµå°¸è¿›ç¨‹å’Œå­¤å„¿è¿›ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ</h3><ul><li><strong>å­¤å„¿è¿›ç¨‹</strong>ï¼šçˆ¶è¿›ç¨‹é€€å‡ºäº†ï¼Œè€Œå®ƒçš„ä¸€ä¸ªæˆ–å¤šä¸ªè¿›ç¨‹è¿˜åœ¨è¿è¡Œï¼Œé‚£è¿™äº›å­è¿›ç¨‹éƒ½ä¼šæˆä¸ºå­¤å„¿è¿›ç¨‹ã€‚å­¤å„¿è¿›ç¨‹å°†è¢«initè¿›ç¨‹(è¿›ç¨‹å·ä¸º1)æ‰€æ”¶å…»ï¼Œå¹¶ç”±initè¿›ç¨‹å¯¹å®ƒä»¬å®ŒæˆçŠ¶æ€æ”¶é›†å·¥ä½œã€‚</li><li><strong>åƒµå°¸è¿›ç¨‹</strong>ï¼šå­è¿›ç¨‹æ¯”çˆ¶è¿›ç¨‹å…ˆç»“æŸï¼Œè€Œçˆ¶è¿›ç¨‹åˆæ²¡æœ‰é‡Šæ”¾å­è¿›ç¨‹å ç”¨çš„èµ„æºï¼Œé‚£ä¹ˆå­è¿›ç¨‹çš„è¿›ç¨‹æè¿°ç¬¦ä»ç„¶ä¿å­˜åœ¨ç³»ç»Ÿä¸­ï¼Œè¿™ç§è¿›ç¨‹ç§°ä¹‹ä¸ºåƒµæ­»è¿›ç¨‹ã€‚</li></ul><h3 id="6-æ­»é”äº§ç”Ÿçš„åŸå› ï¼Ÿ-å¦‚æœè§£å†³æ­»é”çš„é—®é¢˜ï¼Ÿ"><a href="#6-æ­»é”äº§ç”Ÿçš„åŸå› ï¼Ÿ-å¦‚æœè§£å†³æ­»é”çš„é—®é¢˜ï¼Ÿ" class="headerlink" title="6. æ­»é”äº§ç”Ÿçš„åŸå› ï¼Ÿ å¦‚æœè§£å†³æ­»é”çš„é—®é¢˜ï¼Ÿ"></a>6. æ­»é”äº§ç”Ÿçš„åŸå› ï¼Ÿ å¦‚æœè§£å†³æ­»é”çš„é—®é¢˜ï¼Ÿ</h3><p>æ‰€è°“æ­»é”ï¼Œæ˜¯æŒ‡å¤šä¸ªè¿›ç¨‹åœ¨è¿è¡Œè¿‡ç¨‹ä¸­å› äº‰å¤ºèµ„æºè€Œé€ æˆçš„ä¸€ç§åƒµå±€ï¼Œå½“è¿›ç¨‹å¤„äºè¿™ç§åƒµæŒçŠ¶æ€æ—¶ï¼Œè‹¥æ— å¤–åŠ›ä½œç”¨ï¼Œå®ƒä»¬éƒ½å°†æ— æ³•å†å‘å‰æ¨è¿›ã€‚</p><p>ç³»ç»Ÿä¸­çš„èµ„æºå¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼š</p><ul><li>å¯å‰¥å¤ºèµ„æºï¼Œæ˜¯æŒ‡æŸè¿›ç¨‹åœ¨è·å¾—è¿™ç±»èµ„æºåï¼Œè¯¥èµ„æºå¯ä»¥å†è¢«å…¶ä»–è¿›ç¨‹æˆ–ç³»ç»Ÿå‰¥å¤ºï¼ŒCPUå’Œä¸»å­˜å‡å±äºå¯å‰¥å¤ºæ€§èµ„æºï¼›</li><li>ä¸å¯å‰¥å¤ºèµ„æºï¼Œå½“ç³»ç»ŸæŠŠè¿™ç±»èµ„æºåˆ†é…ç»™æŸè¿›ç¨‹åï¼Œå†ä¸èƒ½å¼ºè¡Œæ”¶å›ï¼Œåªèƒ½åœ¨è¿›ç¨‹ç”¨å®Œåè‡ªè¡Œé‡Šæ”¾ï¼Œå¦‚ç£å¸¦æœºã€æ‰“å°æœºç­‰ã€‚</li></ul><p><strong>äº§ç”Ÿæ­»é”çš„åŸå› ï¼š</strong></p><p><strong>ï¼ˆ1ï¼‰ç«äº‰èµ„æº</strong></p><ul><li>äº§ç”Ÿæ­»é”ä¸­çš„ç«äº‰èµ„æºä¹‹ä¸€æŒ‡çš„æ˜¯<strong>ç«äº‰ä¸å¯å‰¥å¤ºèµ„æº</strong>ï¼ˆä¾‹å¦‚ï¼šç³»ç»Ÿä¸­åªæœ‰ä¸€å°æ‰“å°æœºï¼Œå¯ä¾›è¿›ç¨‹P1ä½¿ç”¨ï¼Œå‡å®šP1å·²å ç”¨äº†æ‰“å°æœºï¼Œè‹¥P2ç»§ç»­è¦æ±‚æ‰“å°æœºæ‰“å°å°†é˜»å¡ï¼‰</li><li>äº§ç”Ÿæ­»é”ä¸­çš„ç«äº‰èµ„æºå¦å¤–ä¸€ç§èµ„æºæŒ‡çš„æ˜¯<strong>ç«äº‰ä¸´æ—¶èµ„æº</strong>ï¼ˆä¸´æ—¶èµ„æºåŒ…æ‹¬ç¡¬ä»¶ä¸­æ–­ã€ä¿¡å·ã€æ¶ˆæ¯ã€ç¼“å†²åŒºå†…çš„æ¶ˆæ¯ç­‰ï¼‰ï¼Œé€šå¸¸æ¶ˆæ¯é€šä¿¡é¡ºåºè¿›è¡Œä¸å½“ï¼Œåˆ™ä¼šäº§ç”Ÿæ­»é”</li></ul><p><strong>ï¼ˆ2ï¼‰è¿›ç¨‹é—´æ¨è¿›é¡ºåºéæ³•</strong></p><p>è‹¥P1ä¿æŒäº†èµ„æºR1ï¼ŒP2ä¿æŒäº†èµ„æºR2ï¼Œç³»ç»Ÿå¤„äºä¸å®‰å…¨çŠ¶æ€ï¼Œå› ä¸ºè¿™ä¸¤ä¸ªè¿›ç¨‹å†å‘å‰æ¨è¿›ï¼Œä¾¿å¯èƒ½å‘ç”Ÿæ­»é”ã€‚ä¾‹å¦‚ï¼Œå½“P1è¿è¡Œåˆ°P1ï¼šRequestï¼ˆR2ï¼‰æ—¶ï¼Œå°†å› R2å·²è¢«P2å ç”¨è€Œé˜»å¡ï¼›å½“P2è¿è¡Œåˆ°P2ï¼šRequestï¼ˆR1ï¼‰æ—¶ï¼Œä¹Ÿå°†å› R1å·²è¢«P1å ç”¨è€Œé˜»å¡ï¼Œäºæ˜¯å‘ç”Ÿè¿›ç¨‹æ­»é”</p><p><strong>äº§ç”Ÿæ­»é”çš„å¿…è¦æ¡ä»¶ï¼š</strong></p><ul><li>äº’æ–¥æ¡ä»¶ï¼šè¿›ç¨‹è¦æ±‚å¯¹æ‰€åˆ†é…çš„èµ„æºè¿›è¡Œæ’å®ƒæ€§æ§åˆ¶ï¼Œå³åœ¨ä¸€æ®µæ—¶é—´å†…æŸèµ„æºä»…ä¸ºä¸€è¿›ç¨‹æ‰€å ç”¨ã€‚</li><li>è¯·æ±‚å’Œä¿æŒæ¡ä»¶ï¼šå½“è¿›ç¨‹å› è¯·æ±‚èµ„æºè€Œé˜»å¡æ—¶ï¼Œå¯¹å·²è·å¾—çš„èµ„æºä¿æŒä¸æ”¾ã€‚</li><li>ä¸å‰¥å¤ºæ¡ä»¶ï¼šè¿›ç¨‹å·²è·å¾—çš„èµ„æºåœ¨æœªä½¿ç”¨å®Œä¹‹å‰ï¼Œä¸èƒ½å‰¥å¤ºï¼Œåªèƒ½åœ¨ä½¿ç”¨å®Œæ—¶ç”±è‡ªå·±é‡Šæ”¾ã€‚</li><li>ç¯è·¯ç­‰å¾…æ¡ä»¶ï¼šåœ¨å‘ç”Ÿæ­»é”æ—¶ï¼Œå¿…ç„¶å­˜åœ¨ä¸€ä¸ªè¿›ç¨‹â€”â€”èµ„æºçš„ç¯å½¢é“¾ã€‚</li></ul><p><strong>é¢„é˜²æ­»é”çš„æ–¹æ³•ï¼š</strong></p><ul><li>èµ„æºä¸€æ¬¡æ€§åˆ†é…ï¼šä¸€æ¬¡æ€§åˆ†é…æ‰€æœ‰èµ„æºï¼Œè¿™æ ·å°±ä¸ä¼šå†æœ‰è¯·æ±‚äº†ï¼ˆç ´åè¯·æ±‚æ¡ä»¶ï¼‰</li><li>åªè¦æœ‰ä¸€ä¸ªèµ„æºå¾—ä¸åˆ°åˆ†é…ï¼Œä¹Ÿä¸ç»™è¿™ä¸ªè¿›ç¨‹åˆ†é…å…¶ä»–çš„èµ„æºï¼ˆç ´åè¯·ä¿æŒæ¡ä»¶ï¼‰</li><li>å¯å‰¥å¤ºèµ„æºï¼šå³å½“æŸè¿›ç¨‹è·å¾—äº†éƒ¨åˆ†èµ„æºï¼Œä½†å¾—ä¸åˆ°å…¶å®ƒèµ„æºï¼Œåˆ™é‡Šæ”¾å·²å æœ‰çš„èµ„æºï¼ˆç ´åä¸å¯å‰¥å¤ºæ¡ä»¶ï¼‰</li><li>èµ„æºæœ‰åºåˆ†é…æ³•ï¼šç³»ç»Ÿç»™æ¯ç±»èµ„æºèµ‹äºˆä¸€ä¸ªç¼–å·ï¼Œæ¯ä¸€ä¸ªè¿›ç¨‹æŒ‰ç¼–å·é€’å¢çš„é¡ºåºè¯·æ±‚èµ„æºï¼Œé‡Šæ”¾åˆ™ç›¸åï¼ˆç ´åç¯è·¯ç­‰å¾…æ¡ä»¶ï¼‰</li></ul><h3 id="7-å¦‚ä½•å®ç°æµè§ˆå™¨å†…å¤šä¸ªæ ‡ç­¾é¡µä¹‹é—´çš„é€šä¿¡"><a href="#7-å¦‚ä½•å®ç°æµè§ˆå™¨å†…å¤šä¸ªæ ‡ç­¾é¡µä¹‹é—´çš„é€šä¿¡" class="headerlink" title="7. å¦‚ä½•å®ç°æµè§ˆå™¨å†…å¤šä¸ªæ ‡ç­¾é¡µä¹‹é—´çš„é€šä¿¡?"></a>7. å¦‚ä½•å®ç°æµè§ˆå™¨å†…å¤šä¸ªæ ‡ç­¾é¡µä¹‹é—´çš„é€šä¿¡?</h3><p>å®ç°å¤šä¸ªæ ‡ç­¾é¡µä¹‹é—´çš„é€šä¿¡ï¼Œæœ¬è´¨ä¸Šéƒ½æ˜¯é€šè¿‡ä¸­ä»‹è€…æ¨¡å¼æ¥å®ç°çš„ã€‚å› ä¸ºæ ‡ç­¾é¡µä¹‹é—´æ²¡æœ‰åŠæ³•ç›´æ¥é€šä¿¡ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ‰¾ä¸€ä¸ªä¸­ä»‹è€…ï¼Œè®©æ ‡ç­¾é¡µå’Œä¸­ä»‹è€…è¿›è¡Œé€šä¿¡ï¼Œç„¶åè®©è¿™ä¸ªä¸­ä»‹è€…æ¥è¿›è¡Œæ¶ˆæ¯çš„è½¬å‘ã€‚é€šä¿¡æ–¹æ³•å¦‚ä¸‹ï¼š</p><ul><li><strong>ä½¿ç”¨ websocket åè®®</strong>ï¼Œå› ä¸º websocket åè®®å¯ä»¥å®ç°æœåŠ¡å™¨æ¨é€ï¼Œæ‰€ä»¥æœåŠ¡å™¨å°±å¯ä»¥ç”¨æ¥å½“åšè¿™ä¸ªä¸­ä»‹è€…ã€‚æ ‡ç­¾é¡µé€šè¿‡å‘æœåŠ¡å™¨å‘é€æ•°æ®ï¼Œç„¶åç”±æœåŠ¡å™¨å‘å…¶ä»–æ ‡ç­¾é¡µæ¨é€è½¬å‘ã€‚</li><li><strong>ä½¿ç”¨ ShareWorker çš„æ–¹å¼</strong>ï¼ŒshareWorker ä¼šåœ¨é¡µé¢å­˜åœ¨çš„ç”Ÿå‘½å‘¨æœŸå†…åˆ›å»ºä¸€ä¸ªå”¯ä¸€çš„çº¿ç¨‹ï¼Œå¹¶ä¸”å¼€å¯å¤šä¸ªé¡µé¢ä¹Ÿåªä¼šä½¿ç”¨åŒä¸€ä¸ªçº¿ç¨‹ã€‚è¿™ä¸ªæ—¶å€™å…±äº«çº¿ç¨‹å°±å¯ä»¥å……å½“ä¸­ä»‹è€…çš„è§’è‰²ã€‚æ ‡ç­¾é¡µé—´é€šè¿‡å…±äº«ä¸€ä¸ªçº¿ç¨‹ï¼Œç„¶åé€šè¿‡è¿™ä¸ªå…±äº«çš„çº¿ç¨‹æ¥å®ç°æ•°æ®çš„äº¤æ¢ã€‚</li><li><strong>ä½¿ç”¨ localStorage çš„æ–¹å¼</strong>ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ªæ ‡ç­¾é¡µå¯¹ localStorage çš„å˜åŒ–äº‹ä»¶è¿›è¡Œç›‘å¬ï¼Œç„¶åå½“å¦ä¸€ä¸ªæ ‡ç­¾é¡µä¿®æ”¹æ•°æ®çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è¿™ä¸ªç›‘å¬äº‹ä»¶æ¥è·å–åˆ°æ•°æ®ã€‚è¿™ä¸ªæ—¶å€™ localStorage å¯¹è±¡å°±æ˜¯å……å½“çš„ä¸­ä»‹è€…çš„è§’è‰²ã€‚</li><li><strong>ä½¿ç”¨ postMessage æ–¹æ³•</strong>ï¼Œå¦‚æœæˆ‘ä»¬èƒ½å¤Ÿè·å¾—å¯¹åº”æ ‡ç­¾é¡µçš„å¼•ç”¨ï¼Œå°±å¯ä»¥ä½¿ç”¨postMessage æ–¹æ³•ï¼Œè¿›è¡Œé€šä¿¡ã€‚</li></ul><h3 id="8-å¯¹Service-Workerçš„ç†è§£"><a href="#8-å¯¹Service-Workerçš„ç†è§£" class="headerlink" title="8. å¯¹Service Workerçš„ç†è§£"></a>8. å¯¹Service Workerçš„ç†è§£</h3><p>Service Worker æ˜¯è¿è¡Œåœ¨æµè§ˆå™¨èƒŒåçš„<strong>ç‹¬ç«‹çº¿ç¨‹</strong>ï¼Œä¸€èˆ¬å¯ä»¥ç”¨æ¥å®ç°ç¼“å­˜åŠŸèƒ½ã€‚ä½¿ç”¨ Service Workerçš„è¯ï¼Œä¼ è¾“åè®®å¿…é¡»ä¸º <strong>HTTPS</strong>ã€‚å› ä¸º Service Worker ä¸­æ¶‰åŠåˆ°è¯·æ±‚æ‹¦æˆªï¼Œæ‰€ä»¥å¿…é¡»ä½¿ç”¨ HTTPS åè®®æ¥ä¿éšœå®‰å…¨ã€‚</p><p>Service Worker å®ç°ç¼“å­˜åŠŸèƒ½ä¸€èˆ¬åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼šé¦–å…ˆéœ€è¦å…ˆæ³¨å†Œ Service Workerï¼Œç„¶åç›‘å¬åˆ° <code>install</code> äº‹ä»¶ä»¥åå°±å¯ä»¥ç¼“å­˜éœ€è¦çš„æ–‡ä»¶ï¼Œé‚£ä¹ˆåœ¨ä¸‹æ¬¡ç”¨æˆ·è®¿é—®çš„æ—¶å€™å°±å¯ä»¥é€šè¿‡æ‹¦æˆªè¯·æ±‚çš„æ–¹å¼æŸ¥è¯¢æ˜¯å¦å­˜åœ¨ç¼“å­˜ï¼Œå­˜åœ¨ç¼“å­˜çš„è¯å°±å¯ä»¥ç›´æ¥è¯»å–ç¼“å­˜æ–‡ä»¶ï¼Œå¦åˆ™å°±å»è¯·æ±‚æ•°æ®ã€‚ä»¥ä¸‹æ˜¯è¿™ä¸ªæ­¥éª¤çš„å®ç°ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// index.js</span><span class="token keyword">if</span> <span class="token punctuation">(</span>navigator<span class="token punctuation">.</span>serviceWorker<span class="token punctuation">)</span> <span class="token punctuation">{</span>  navigator<span class="token punctuation">.</span>serviceWorker    <span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token string">'sw.js'</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>registration<span class="token punctuation">)</span> <span class="token punctuation">{</span>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'service worker æ³¨å†ŒæˆåŠŸ'</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token punctuation">.</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'servcie worker æ³¨å†Œå¤±è´¥'</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// sw.js</span><span class="token comment" spellcheck="true">// ç›‘å¬ `install` äº‹ä»¶ï¼Œå›è°ƒä¸­ç¼“å­˜æ‰€éœ€æ–‡ä»¶</span>self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'install'</span><span class="token punctuation">,</span> e <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  e<span class="token punctuation">.</span><span class="token function">waitUntil</span><span class="token punctuation">(</span>    caches<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'my-cache'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>cache<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">return</span> cache<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'./index.html'</span><span class="token punctuation">,</span> <span class="token string">'./index.js'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">// æ‹¦æˆªæ‰€æœ‰è¯·æ±‚äº‹ä»¶</span><span class="token comment" spellcheck="true">// å¦‚æœç¼“å­˜ä¸­å·²ç»æœ‰è¯·æ±‚çš„æ•°æ®å°±ç›´æ¥ç”¨ç¼“å­˜ï¼Œå¦åˆ™å»è¯·æ±‚æ•°æ®</span>self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'fetch'</span><span class="token punctuation">,</span> e <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  e<span class="token punctuation">.</span><span class="token function">respondWith</span><span class="token punctuation">(</span>    caches<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>request<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> response      <span class="token punctuation">}</span>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'fetch source'</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰“å¼€é¡µé¢ï¼Œå¯ä»¥åœ¨å¼€å‘è€…å·¥å…·ä¸­çš„ <code>Application</code> çœ‹åˆ° Service Worker å·²ç»å¯åŠ¨äº†ï¼š<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/theory/4.png" alt=""><br>åœ¨ Cache ä¸­ä¹Ÿå¯ä»¥å‘ç°æ‰€éœ€çš„æ–‡ä»¶å·²è¢«ç¼“å­˜ï¼š<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/theory/5.png" alt=""></p><h2 id="ä¸‰ã€æµè§ˆå™¨ç¼“å­˜"><a href="#ä¸‰ã€æµè§ˆå™¨ç¼“å­˜" class="headerlink" title="ä¸‰ã€æµè§ˆå™¨ç¼“å­˜"></a>ä¸‰ã€æµè§ˆå™¨ç¼“å­˜</h2><h3 id="1-å¯¹æµè§ˆå™¨çš„ç¼“å­˜æœºåˆ¶çš„ç†è§£"><a href="#1-å¯¹æµè§ˆå™¨çš„ç¼“å­˜æœºåˆ¶çš„ç†è§£" class="headerlink" title="1. å¯¹æµè§ˆå™¨çš„ç¼“å­˜æœºåˆ¶çš„ç†è§£"></a>1. å¯¹æµè§ˆå™¨çš„ç¼“å­˜æœºåˆ¶çš„ç†è§£</h3><p><strong>æµè§ˆå™¨ç¼“å­˜çš„å…¨è¿‡ç¨‹ï¼š</strong></p><ul><li>æµè§ˆå™¨ç¬¬ä¸€æ¬¡åŠ è½½èµ„æºï¼ŒæœåŠ¡å™¨è¿”å› 200ï¼Œæµè§ˆå™¨ä»æœåŠ¡å™¨ä¸‹è½½èµ„æºæ–‡ä»¶ï¼Œå¹¶ç¼“å­˜èµ„æºæ–‡ä»¶ä¸ response headerï¼Œä»¥ä¾›ä¸‹æ¬¡åŠ è½½æ—¶å¯¹æ¯”ä½¿ç”¨ï¼›</li><li>ä¸‹ä¸€æ¬¡åŠ è½½èµ„æºæ—¶ï¼Œç”±äºå¼ºåˆ¶ç¼“å­˜ä¼˜å…ˆçº§è¾ƒé«˜ï¼Œå…ˆæ¯”è¾ƒå½“å‰æ—¶é—´ä¸ä¸Šä¸€æ¬¡è¿”å› 200 æ—¶çš„æ—¶é—´å·®ï¼Œå¦‚æœæ²¡æœ‰è¶…è¿‡ cache-control è®¾ç½®çš„ max-ageï¼Œåˆ™æ²¡æœ‰è¿‡æœŸï¼Œå¹¶å‘½ä¸­å¼ºç¼“å­˜ï¼Œç›´æ¥ä»æœ¬åœ°è¯»å–èµ„æºã€‚å¦‚æœæµè§ˆå™¨ä¸æ”¯æŒHTTP1.1ï¼Œåˆ™ä½¿ç”¨ expires å¤´åˆ¤æ–­æ˜¯å¦è¿‡æœŸï¼›</li><li>å¦‚æœèµ„æºå·²è¿‡æœŸï¼Œåˆ™è¡¨æ˜å¼ºåˆ¶ç¼“å­˜æ²¡æœ‰è¢«å‘½ä¸­ï¼Œåˆ™å¼€å§‹åå•†ç¼“å­˜ï¼Œå‘æœåŠ¡å™¨å‘é€å¸¦æœ‰ If-None-Match å’Œ If-Modified-Since çš„è¯·æ±‚ï¼›</li><li>æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åï¼Œä¼˜å…ˆæ ¹æ® Etag çš„å€¼åˆ¤æ–­è¢«è¯·æ±‚çš„æ–‡ä»¶æœ‰æ²¡æœ‰åšä¿®æ”¹ï¼ŒEtag å€¼ä¸€è‡´åˆ™æ²¡æœ‰ä¿®æ”¹ï¼Œå‘½ä¸­åå•†ç¼“å­˜ï¼Œè¿”å› 304ï¼›å¦‚æœä¸ä¸€è‡´åˆ™æœ‰æ”¹åŠ¨ï¼Œç›´æ¥è¿”å›æ–°çš„èµ„æºæ–‡ä»¶å¸¦ä¸Šæ–°çš„ Etag å€¼å¹¶è¿”å› 200ï¼›</li><li>å¦‚æœæœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚æ²¡æœ‰ Etag å€¼ï¼Œåˆ™å°† If-Modified-Since å’Œè¢«è¯·æ±‚æ–‡ä»¶çš„æœ€åä¿®æ”¹æ—¶é—´åšæ¯”å¯¹ï¼Œä¸€è‡´åˆ™å‘½ä¸­åå•†ç¼“å­˜ï¼Œè¿”å› 304ï¼›ä¸ä¸€è‡´åˆ™è¿”å›æ–°çš„ last-modified å’Œæ–‡ä»¶å¹¶è¿”å› 200ï¼›</li></ul><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/theory/6.png" alt="ä¸šåŠ¡æµç¨‹å›¾1.png"><br>å¾ˆå¤šç½‘ç«™çš„èµ„æºåé¢éƒ½åŠ äº†ç‰ˆæœ¬å·ï¼Œè¿™æ ·åšçš„ç›®çš„æ˜¯ï¼šæ¯æ¬¡å‡çº§äº† JS æˆ– CSS æ–‡ä»¶åï¼Œä¸ºäº†é˜²æ­¢æµè§ˆå™¨è¿›è¡Œç¼“å­˜ï¼Œå¼ºåˆ¶æ”¹å˜ç‰ˆæœ¬å·ï¼Œå®¢æˆ·ç«¯æµè§ˆå™¨å°±ä¼šé‡æ–°ä¸‹è½½æ–°çš„ JS æˆ– CSS æ–‡ä»¶ ï¼Œä»¥ä¿è¯ç”¨æˆ·èƒ½å¤ŸåŠæ—¶è·å¾—ç½‘ç«™çš„æœ€æ–°æ›´æ–°ã€‚</p><h3 id="2-æµè§ˆå™¨èµ„æºç¼“å­˜çš„ä½ç½®æœ‰å“ªäº›ï¼Ÿ"><a href="#2-æµè§ˆå™¨èµ„æºç¼“å­˜çš„ä½ç½®æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="2. æµè§ˆå™¨èµ„æºç¼“å­˜çš„ä½ç½®æœ‰å“ªäº›ï¼Ÿ"></a>2. æµè§ˆå™¨èµ„æºç¼“å­˜çš„ä½ç½®æœ‰å“ªäº›ï¼Ÿ</h3><p>èµ„æºç¼“å­˜çš„ä½ç½®ä¸€å…±æœ‰ 3 ç§ï¼ŒæŒ‰ä¼˜å…ˆçº§ä»é«˜åˆ°ä½åˆ†åˆ«æ˜¯ï¼š</p><ol><li><p><strong>Service Workerï¼š</strong>Service Worker è¿è¡Œåœ¨ JavaScript ä¸»çº¿ç¨‹ä¹‹å¤–ï¼Œè™½ç„¶ç”±äºè„±ç¦»äº†æµè§ˆå™¨çª—ä½“æ— æ³•ç›´æ¥è®¿é—® DOMï¼Œä½†æ˜¯å®ƒå¯ä»¥å®Œæˆç¦»çº¿ç¼“å­˜ã€æ¶ˆæ¯æ¨é€ã€ç½‘ç»œä»£ç†ç­‰åŠŸèƒ½ã€‚å®ƒå¯ä»¥è®©æˆ‘ä»¬<strong>è‡ªç”±æ§åˆ¶</strong>ç¼“å­˜å“ªäº›æ–‡ä»¶ã€å¦‚ä½•åŒ¹é…ç¼“å­˜ã€å¦‚ä½•è¯»å–ç¼“å­˜ï¼Œå¹¶ä¸”<strong>ç¼“å­˜æ˜¯æŒç»­æ€§çš„</strong>ã€‚å½“ Service Worker æ²¡æœ‰å‘½ä¸­ç¼“å­˜çš„æ—¶å€™ï¼Œéœ€è¦å»è°ƒç”¨ <code>fetch</code> å‡½æ•°è·å–  æ•°æ®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæ²¡æœ‰åœ¨ Service Worker å‘½ä¸­ç¼“å­˜ï¼Œä¼šæ ¹æ®ç¼“å­˜æŸ¥æ‰¾ä¼˜å…ˆçº§å»æŸ¥æ‰¾æ•°æ®ã€‚<strong>ä½†æ˜¯ä¸ç®¡æ˜¯ä» Memory Cache ä¸­è¿˜æ˜¯ä»ç½‘ç»œè¯·æ±‚ä¸­è·å–çš„æ•°æ®ï¼Œæµè§ˆå™¨éƒ½ä¼šæ˜¾ç¤ºæ˜¯ä» Service Worker ä¸­è·å–çš„å†…å®¹ã€‚</strong></p></li><li><p><strong>Memory Cacheï¼š</strong> Memory Cache å°±æ˜¯å†…å­˜ç¼“å­˜ï¼Œå®ƒçš„æ•ˆç‡æœ€å¿«ï¼Œ<strong>ä½†æ˜¯å†…å­˜ç¼“å­˜è™½ç„¶è¯»å–é«˜æ•ˆï¼Œå¯æ˜¯ç¼“å­˜æŒç»­æ€§å¾ˆçŸ­ï¼Œä¼šéšç€è¿›ç¨‹çš„é‡Šæ”¾è€Œé‡Šæ”¾ã€‚</strong>ä¸€æ—¦æˆ‘ä»¬å…³é—­ Tab é¡µé¢ï¼Œå†…å­˜ä¸­çš„ç¼“å­˜ä¹Ÿå°±è¢«é‡Šæ”¾äº†ã€‚</p></li><li><p><strong>Disk Cacheï¼š</strong> Disk Cache ä¹Ÿå°±æ˜¯å­˜å‚¨åœ¨ç¡¬ç›˜ä¸­çš„ç¼“å­˜ï¼Œè¯»å–é€Ÿåº¦æ…¢ç‚¹ï¼Œä½†æ˜¯ä»€ä¹ˆéƒ½èƒ½å­˜å‚¨åˆ°ç£ç›˜ä¸­ï¼Œæ¯”ä¹‹ Memory Cache <strong>èƒœåœ¨å®¹é‡å’Œå­˜å‚¨æ—¶æ•ˆæ€§ä¸Šã€‚</strong>åœ¨æ‰€æœ‰æµè§ˆå™¨ç¼“å­˜ä¸­ï¼ŒDisk Cache è¦†ç›–é¢åŸºæœ¬æ˜¯æœ€å¤§çš„ã€‚å®ƒä¼šæ ¹æ® HTTP Herder ä¸­çš„å­—æ®µåˆ¤æ–­å“ªäº›èµ„æºéœ€è¦ç¼“å­˜ï¼Œå“ªäº›èµ„æºå¯ä»¥ä¸è¯·æ±‚ç›´æ¥ä½¿ç”¨ï¼Œå“ªäº›èµ„æºå·²ç»è¿‡æœŸéœ€è¦é‡æ–°è¯·æ±‚ã€‚<strong>å¹¶ä¸”å³ä½¿åœ¨è·¨ç«™ç‚¹çš„æƒ…å†µä¸‹ï¼Œç›¸åŒåœ°å€çš„èµ„æºä¸€æ—¦è¢«ç¡¬ç›˜ç¼“å­˜ä¸‹æ¥ï¼Œå°±ä¸ä¼šå†æ¬¡å»è¯·æ±‚æ•°æ®ã€‚</strong></p></li></ol><p><strong>Disk Cacheï¼š</strong> Push Cache æ˜¯ HTTP/2 ä¸­çš„å†…å®¹ï¼Œå½“ä»¥ä¸Šä¸‰ç§ç¼“å­˜éƒ½æ²¡æœ‰å‘½ä¸­æ—¶ï¼Œå®ƒæ‰ä¼šè¢«ä½¿ç”¨ã€‚å¹¶ä¸”ç¼“å­˜æ—¶é—´ä¹Ÿå¾ˆçŸ­æš‚ï¼Œåªåœ¨ä¼šè¯ï¼ˆSessionï¼‰ä¸­å­˜åœ¨ï¼Œä¸€æ—¦ä¼šè¯ç»“æŸå°±è¢«é‡Šæ”¾ã€‚å…¶å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p><ul><li>æ‰€æœ‰çš„èµ„æºéƒ½èƒ½è¢«æ¨é€ï¼Œä½†æ˜¯ Edge å’Œ Safari æµè§ˆå™¨å…¼å®¹æ€§ä¸æ€ä¹ˆå¥½</li><li>å¯ä»¥æ¨é€ <code>no-cache</code> å’Œ <code>no-store</code> çš„èµ„æº</li><li>ä¸€æ—¦è¿æ¥è¢«å…³é—­ï¼ŒPush Cache å°±è¢«é‡Šæ”¾</li><li>å¤šä¸ªé¡µé¢å¯ä»¥ä½¿ç”¨ç›¸åŒçš„ HTTP/2 è¿æ¥ï¼Œä¹Ÿå°±æ˜¯è¯´èƒ½ä½¿ç”¨åŒæ ·çš„ç¼“å­˜</li><li>Push Cache ä¸­çš„ç¼“å­˜åªèƒ½è¢«ä½¿ç”¨ä¸€æ¬¡</li><li>æµè§ˆå™¨å¯ä»¥æ‹’ç»æ¥å—å·²ç»å­˜åœ¨çš„èµ„æºæ¨é€</li><li>å¯ä»¥ç»™å…¶ä»–åŸŸåæ¨é€èµ„æº<strong>â€‹</strong></li></ul><h3 id="3-åå•†ç¼“å­˜å’Œå¼ºç¼“å­˜çš„åŒºåˆ«"><a href="#3-åå•†ç¼“å­˜å’Œå¼ºç¼“å­˜çš„åŒºåˆ«" class="headerlink" title="3. åå•†ç¼“å­˜å’Œå¼ºç¼“å­˜çš„åŒºåˆ«"></a>3. åå•†ç¼“å­˜å’Œå¼ºç¼“å­˜çš„åŒºåˆ«</h3><h4 id="ï¼ˆ1ï¼‰å¼ºç¼“å­˜"><a href="#ï¼ˆ1ï¼‰å¼ºç¼“å­˜" class="headerlink" title="ï¼ˆ1ï¼‰å¼ºç¼“å­˜"></a>ï¼ˆ1ï¼‰å¼ºç¼“å­˜</h4><p>ä½¿ç”¨å¼ºç¼“å­˜ç­–ç•¥æ—¶ï¼Œå¦‚æœç¼“å­˜èµ„æºæœ‰æ•ˆï¼Œåˆ™ç›´æ¥ä½¿ç”¨ç¼“å­˜èµ„æºï¼Œä¸å¿…å†å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ã€‚</p><p>å¼ºç¼“å­˜ç­–ç•¥å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼æ¥è®¾ç½®ï¼Œåˆ†åˆ«æ˜¯ http å¤´ä¿¡æ¯ä¸­çš„ Expires å±æ€§å’Œ Cache-Control å±æ€§ã€‚</p><p>ï¼ˆ1ï¼‰æœåŠ¡å™¨é€šè¿‡åœ¨å“åº”å¤´ä¸­æ·»åŠ  Expires å±æ€§ï¼Œæ¥æŒ‡å®šèµ„æºçš„è¿‡æœŸæ—¶é—´ã€‚åœ¨è¿‡æœŸæ—¶é—´ä»¥å†…ï¼Œè¯¥èµ„æºå¯ä»¥è¢«ç¼“å­˜ä½¿ç”¨ï¼Œä¸å¿…å†å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ã€‚è¿™ä¸ªæ—¶é—´æ˜¯ä¸€ä¸ªç»å¯¹æ—¶é—´ï¼Œå®ƒæ˜¯æœåŠ¡å™¨çš„æ—¶é—´ï¼Œå› æ­¤å¯èƒ½å­˜åœ¨è¿™æ ·çš„é—®é¢˜ï¼Œå°±æ˜¯å®¢æˆ·ç«¯çš„æ—¶é—´å’ŒæœåŠ¡å™¨ç«¯çš„æ—¶é—´ä¸ä¸€è‡´ï¼Œæˆ–è€…ç”¨æˆ·å¯ä»¥å¯¹å®¢æˆ·ç«¯æ—¶é—´è¿›è¡Œä¿®æ”¹çš„æƒ…å†µï¼Œè¿™æ ·å°±å¯èƒ½ä¼šå½±å“ç¼“å­˜å‘½ä¸­çš„ç»“æœã€‚</p><p>ï¼ˆ2ï¼‰Expires æ˜¯ http1.0 ä¸­çš„æ–¹å¼ï¼Œå› ä¸ºå®ƒçš„ä¸€äº›ç¼ºç‚¹ï¼Œåœ¨ HTTP 1.1 ä¸­æå‡ºäº†ä¸€ä¸ªæ–°çš„å¤´éƒ¨å±æ€§å°±æ˜¯ Cache-Control å±æ€§ï¼Œå®ƒæä¾›äº†å¯¹èµ„æºçš„ç¼“å­˜çš„æ›´ç²¾ç¡®çš„æ§åˆ¶ã€‚å®ƒæœ‰å¾ˆå¤šä¸åŒçš„å€¼ï¼Œ</p><p><code>Cache-Control</code>å¯è®¾ç½®çš„å­—æ®µï¼š</p><ul><li><code>public</code>ï¼šè®¾ç½®äº†è¯¥å­—æ®µå€¼çš„èµ„æºè¡¨ç¤ºå¯ä»¥è¢«ä»»ä½•å¯¹è±¡ï¼ˆåŒ…æ‹¬ï¼šå‘é€è¯·æ±‚çš„å®¢æˆ·ç«¯ã€ä»£ç†æœåŠ¡å™¨ç­‰ç­‰ï¼‰ç¼“å­˜ã€‚è¿™ä¸ªå­—æ®µå€¼ä¸å¸¸ç”¨ï¼Œä¸€èˆ¬è¿˜æ˜¯ä½¿ç”¨max-age=æ¥ç²¾ç¡®æ§åˆ¶ï¼›</li><li><code>private</code>ï¼šè®¾ç½®äº†è¯¥å­—æ®µå€¼çš„èµ„æºåªèƒ½è¢«ç”¨æˆ·æµè§ˆå™¨ç¼“å­˜ï¼Œä¸å…è®¸ä»»ä½•ä»£ç†æœåŠ¡å™¨ç¼“å­˜ã€‚åœ¨å®é™…å¼€å‘å½“ä¸­ï¼Œå¯¹äºä¸€äº›å«æœ‰ç”¨æˆ·ä¿¡æ¯çš„HTMLï¼Œé€šå¸¸éƒ½è¦è®¾ç½®è¿™ä¸ªå­—æ®µå€¼ï¼Œé¿å…ä»£ç†æœåŠ¡å™¨(CDN)ç¼“å­˜ï¼›</li><li><code>no-cache</code>ï¼šè®¾ç½®äº†è¯¥å­—æ®µéœ€è¦å…ˆå’ŒæœåŠ¡ç«¯ç¡®è®¤è¿”å›çš„èµ„æºæ˜¯å¦å‘ç”Ÿäº†å˜åŒ–ï¼Œå¦‚æœèµ„æºæœªå‘ç”Ÿå˜åŒ–ï¼Œåˆ™ç›´æ¥ä½¿ç”¨ç¼“å­˜å¥½çš„èµ„æºï¼›</li><li><code>no-store</code>ï¼šè®¾ç½®äº†è¯¥å­—æ®µè¡¨ç¤ºç¦æ­¢ä»»ä½•ç¼“å­˜ï¼Œæ¯æ¬¡éƒ½ä¼šå‘æœåŠ¡ç«¯å‘èµ·æ–°çš„è¯·æ±‚ï¼Œæ‹‰å–æœ€æ–°çš„èµ„æºï¼›</li><li><code>max-age=</code>ï¼šè®¾ç½®ç¼“å­˜çš„æœ€å¤§æœ‰æ•ˆæœŸï¼Œå•ä½ä¸ºç§’ï¼›</li><li><code>s-maxage=</code>ï¼šä¼˜å…ˆçº§é«˜äºmax-age=ï¼Œä»…é€‚ç”¨äºå…±äº«ç¼“å­˜(CDN)ï¼Œä¼˜å…ˆçº§é«˜äºmax-ageæˆ–è€…Expireså¤´ï¼›</li><li><code>max-stale[=]</code>ï¼šè®¾ç½®äº†è¯¥å­—æ®µè¡¨æ˜å®¢æˆ·ç«¯æ„¿æ„æ¥æ”¶å·²ç»è¿‡æœŸçš„èµ„æºï¼Œä½†æ˜¯ä¸èƒ½è¶…è¿‡ç»™å®šçš„æ—¶é—´é™åˆ¶ã€‚</li></ul><p>ä¸€èˆ¬æ¥è¯´åªéœ€è¦è®¾ç½®å…¶ä¸­ä¸€ç§æ–¹å¼å°±å¯ä»¥å®ç°å¼ºç¼“å­˜ç­–ç•¥ï¼Œå½“ä¸¤ç§æ–¹å¼ä¸€èµ·ä½¿ç”¨æ—¶ï¼ŒCache-Control çš„ä¼˜å…ˆçº§è¦é«˜äº Expiresã€‚</p><p><strong>no-cacheå’Œno-storeå¾ˆå®¹æ˜“æ··æ·†ï¼š</strong></p><ul><li>no-cache æ˜¯æŒ‡å…ˆè¦å’ŒæœåŠ¡å™¨ç¡®è®¤æ˜¯å¦æœ‰èµ„æºæ›´æ–°ï¼Œåœ¨è¿›è¡Œåˆ¤æ–­ã€‚ä¹Ÿå°±æ˜¯è¯´æ²¡æœ‰å¼ºç¼“å­˜ï¼Œä½†æ˜¯ä¼šæœ‰åå•†ç¼“å­˜ï¼›</li><li>no-store æ˜¯æŒ‡ä¸ä½¿ç”¨ä»»ä½•ç¼“å­˜ï¼Œæ¯æ¬¡è¯·æ±‚éƒ½ç›´æ¥ä»æœåŠ¡å™¨è·å–èµ„æºã€‚</li></ul><h4 id="ï¼ˆ2ï¼‰åå•†ç¼“å­˜"><a href="#ï¼ˆ2ï¼‰åå•†ç¼“å­˜" class="headerlink" title="ï¼ˆ2ï¼‰åå•†ç¼“å­˜"></a>ï¼ˆ2ï¼‰åå•†ç¼“å­˜</h4><p>å¦‚æœå‘½ä¸­å¼ºåˆ¶ç¼“å­˜ï¼Œæˆ‘ä»¬æ— éœ€å‘èµ·æ–°çš„è¯·æ±‚ï¼Œç›´æ¥ä½¿ç”¨ç¼“å­˜å†…å®¹ï¼Œå¦‚æœæ²¡æœ‰å‘½ä¸­å¼ºåˆ¶ç¼“å­˜ï¼Œå¦‚æœè®¾ç½®äº†åå•†ç¼“å­˜ï¼Œè¿™ä¸ªæ—¶å€™åå•†ç¼“å­˜å°±ä¼šå‘æŒ¥ä½œç”¨äº†ã€‚</p><p>ä¸Šé¢å·²ç»è¯´åˆ°äº†ï¼Œå‘½ä¸­åå•†ç¼“å­˜çš„æ¡ä»¶æœ‰ä¸¤ä¸ªï¼š</p><ul><li><code>max-age=xxx</code> è¿‡æœŸäº†</li><li>å€¼ä¸º<code>no-store</code></li></ul><p>ä½¿ç”¨åå•†ç¼“å­˜ç­–ç•¥æ—¶ï¼Œä¼šå…ˆå‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œå¦‚æœèµ„æºæ²¡æœ‰å‘ç”Ÿä¿®æ”¹ï¼Œåˆ™è¿”å›ä¸€ä¸ª 304 çŠ¶æ€ï¼Œè®©æµè§ˆå™¨ä½¿ç”¨æœ¬åœ°çš„ç¼“å­˜å‰¯æœ¬ã€‚å¦‚æœèµ„æºå‘ç”Ÿäº†ä¿®æ”¹ï¼Œåˆ™è¿”å›ä¿®æ”¹åçš„èµ„æºã€‚</p><p>åå•†ç¼“å­˜ä¹Ÿå¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼æ¥è®¾ç½®ï¼Œåˆ†åˆ«æ˜¯ http å¤´ä¿¡æ¯ä¸­çš„<strong>Etag</strong> å’Œ<strong>Last-Modified</strong>å±æ€§ã€‚</p><p>ï¼ˆ1ï¼‰æœåŠ¡å™¨é€šè¿‡åœ¨å“åº”å¤´ä¸­æ·»åŠ  Last-Modified å±æ€§æ¥æŒ‡å‡ºèµ„æºæœ€åä¸€æ¬¡ä¿®æ”¹çš„æ—¶é—´ï¼Œå½“æµè§ˆå™¨ä¸‹ä¸€æ¬¡å‘èµ·è¯·æ±‚æ—¶ï¼Œä¼šåœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ ä¸€ä¸ª If-Modified-Since çš„å±æ€§ï¼Œå±æ€§å€¼ä¸ºä¸Šä¸€æ¬¡èµ„æºè¿”å›æ—¶çš„ Last-Modified çš„å€¼ã€‚å½“è¯·æ±‚å‘é€åˆ°æœåŠ¡å™¨åæœåŠ¡å™¨ä¼šé€šè¿‡è¿™ä¸ªå±æ€§æ¥å’Œèµ„æºçš„æœ€åä¸€æ¬¡çš„ä¿®æ”¹æ—¶é—´æ¥è¿›è¡Œæ¯”è¾ƒï¼Œä»¥æ­¤æ¥åˆ¤æ–­èµ„æºæ˜¯å¦åšäº†ä¿®æ”¹ã€‚å¦‚æœèµ„æºæ²¡æœ‰ä¿®æ”¹ï¼Œé‚£ä¹ˆè¿”å› 304 çŠ¶æ€ï¼Œè®©å®¢æˆ·ç«¯ä½¿ç”¨æœ¬åœ°çš„ç¼“å­˜ã€‚å¦‚æœèµ„æºå·²ç»è¢«ä¿®æ”¹äº†ï¼Œåˆ™è¿”å›ä¿®æ”¹åçš„èµ„æºã€‚ä½¿ç”¨è¿™ç§æ–¹æ³•æœ‰ä¸€ä¸ªç¼ºç‚¹ï¼Œå°±æ˜¯ Last-Modified æ ‡æ³¨çš„æœ€åä¿®æ”¹æ—¶é—´åªèƒ½ç²¾ç¡®åˆ°ç§’çº§ï¼Œå¦‚æœæŸäº›æ–‡ä»¶åœ¨1ç§’é’Ÿä»¥å†…ï¼Œè¢«ä¿®æ”¹å¤šæ¬¡çš„è¯ï¼Œé‚£ä¹ˆæ–‡ä»¶å·²å°†æ”¹å˜äº†ä½†æ˜¯ Last-Modified å´æ²¡æœ‰æ”¹å˜ï¼Œè¿™æ ·ä¼šé€ æˆç¼“å­˜å‘½ä¸­çš„ä¸å‡†ç¡®ã€‚</p><p>ï¼ˆ2ï¼‰å› ä¸º Last-Modified çš„è¿™ç§å¯èƒ½å‘ç”Ÿçš„ä¸å‡†ç¡®æ€§ï¼Œhttp ä¸­æä¾›äº†å¦å¤–ä¸€ç§æ–¹å¼ï¼Œé‚£å°±æ˜¯ Etag å±æ€§ã€‚æœåŠ¡å™¨åœ¨è¿”å›èµ„æºçš„æ—¶å€™ï¼Œåœ¨å¤´ä¿¡æ¯ä¸­æ·»åŠ äº† Etag å±æ€§ï¼Œè¿™ä¸ªå±æ€§æ˜¯èµ„æºç”Ÿæˆçš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œå½“èµ„æºå‘ç”Ÿæ”¹å˜çš„æ—¶å€™ï¼Œè¿™ä¸ªå€¼ä¹Ÿä¼šå‘ç”Ÿæ”¹å˜ã€‚åœ¨ä¸‹ä¸€æ¬¡èµ„æºè¯·æ±‚æ—¶ï¼Œæµè§ˆå™¨ä¼šåœ¨è¯·æ±‚å¤´ä¸­æ·»åŠ ä¸€ä¸ª If-None-Match å±æ€§ï¼Œè¿™ä¸ªå±æ€§çš„å€¼å°±æ˜¯ä¸Šæ¬¡è¿”å›çš„èµ„æºçš„ Etag çš„å€¼ã€‚æœåŠ¡æ¥æ”¶åˆ°è¯·æ±‚åä¼šæ ¹æ®è¿™ä¸ªå€¼æ¥å’Œèµ„æºå½“å‰çš„ Etag çš„å€¼æ¥è¿›è¡Œæ¯”è¾ƒï¼Œä»¥æ­¤æ¥åˆ¤æ–­èµ„æºæ˜¯å¦å‘ç”Ÿæ”¹å˜ï¼Œæ˜¯å¦éœ€è¦è¿”å›èµ„æºã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæ¯” Last-Modified çš„æ–¹å¼æ›´åŠ ç²¾ç¡®ã€‚</p><p>å½“ Last-Modified å’Œ Etag å±æ€§åŒæ—¶å‡ºç°çš„æ—¶å€™ï¼ŒEtag çš„ä¼˜å…ˆçº§æ›´é«˜ã€‚ä½¿ç”¨åå•†ç¼“å­˜çš„æ—¶å€™ï¼ŒæœåŠ¡å™¨éœ€è¦è€ƒè™‘è´Ÿè½½å¹³è¡¡çš„é—®é¢˜ï¼Œå› æ­¤å¤šä¸ªæœåŠ¡å™¨ä¸Šèµ„æºçš„ Last-Modified åº”è¯¥ä¿æŒä¸€è‡´ï¼Œå› ä¸ºæ¯ä¸ªæœåŠ¡å™¨ä¸Š Etag çš„å€¼éƒ½ä¸ä¸€æ ·ï¼Œå› æ­¤åœ¨è€ƒè™‘è´Ÿè½½å¹³è¡¡æ—¶ï¼Œæœ€å¥½ä¸è¦è®¾ç½® Etag å±æ€§ã€‚</p><p><strong>æ€»ç»“ï¼š</strong></p><p>å¼ºç¼“å­˜ç­–ç•¥å’Œåå•†ç¼“å­˜ç­–ç•¥åœ¨ç¼“å­˜å‘½ä¸­æ—¶éƒ½ä¼šç›´æ¥ä½¿ç”¨æœ¬åœ°çš„ç¼“å­˜å‰¯æœ¬ï¼ŒåŒºåˆ«åªåœ¨äºåå•†ç¼“å­˜ä¼šå‘æœåŠ¡å™¨å‘é€ä¸€æ¬¡è¯·æ±‚ã€‚å®ƒä»¬ç¼“å­˜ä¸å‘½ä¸­æ—¶ï¼Œéƒ½ä¼šå‘æœåŠ¡å™¨å‘é€è¯·æ±‚æ¥è·å–èµ„æºã€‚åœ¨å®é™…çš„ç¼“å­˜æœºåˆ¶ä¸­ï¼Œå¼ºç¼“å­˜ç­–ç•¥å’Œåå•†ç¼“å­˜ç­–ç•¥æ˜¯ä¸€èµ·åˆä½œä½¿ç”¨çš„ã€‚æµè§ˆå™¨é¦–å…ˆä¼šæ ¹æ®è¯·æ±‚çš„ä¿¡æ¯åˆ¤æ–­ï¼Œå¼ºç¼“å­˜æ˜¯å¦å‘½ä¸­ï¼Œå¦‚æœå‘½ä¸­åˆ™ç›´æ¥ä½¿ç”¨èµ„æºã€‚å¦‚æœä¸å‘½ä¸­åˆ™æ ¹æ®å¤´ä¿¡æ¯å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼Œä½¿ç”¨åå•†ç¼“å­˜ï¼Œå¦‚æœåå•†ç¼“å­˜å‘½ä¸­çš„è¯ï¼Œåˆ™æœåŠ¡å™¨ä¸è¿”å›èµ„æºï¼Œæµè§ˆå™¨ç›´æ¥ä½¿ç”¨æœ¬åœ°èµ„æºçš„å‰¯æœ¬ï¼Œå¦‚æœåå•†ç¼“å­˜ä¸å‘½ä¸­ï¼Œåˆ™æµè§ˆå™¨è¿”å›æœ€æ–°çš„èµ„æºç»™æµè§ˆå™¨ã€‚</p><h3 id="4-ä¸ºä»€ä¹ˆéœ€è¦æµè§ˆå™¨ç¼“å­˜ï¼Ÿ"><a href="#4-ä¸ºä»€ä¹ˆéœ€è¦æµè§ˆå™¨ç¼“å­˜ï¼Ÿ" class="headerlink" title="4. ä¸ºä»€ä¹ˆéœ€è¦æµè§ˆå™¨ç¼“å­˜ï¼Ÿ"></a>4. ä¸ºä»€ä¹ˆéœ€è¦æµè§ˆå™¨ç¼“å­˜ï¼Ÿ</h3><p>å¯¹äºæµè§ˆå™¨çš„ç¼“å­˜ï¼Œä¸»è¦é’ˆå¯¹çš„æ˜¯å‰ç«¯çš„é™æ€èµ„æºï¼Œæœ€å¥½çš„æ•ˆæœå°±æ˜¯ï¼Œåœ¨å‘èµ·è¯·æ±‚ä¹‹åï¼Œæ‹‰å–ç›¸åº”çš„é™æ€èµ„æºï¼Œå¹¶ä¿å­˜åœ¨æœ¬åœ°ã€‚å¦‚æœæœåŠ¡å™¨çš„é™æ€èµ„æºæ²¡æœ‰æ›´æ–°ï¼Œé‚£ä¹ˆåœ¨ä¸‹æ¬¡è¯·æ±‚çš„æ—¶å€™ï¼Œå°±ç›´æ¥ä»æœ¬åœ°è¯»å–å³å¯ï¼Œå¦‚æœæœåŠ¡å™¨çš„é™æ€èµ„æºå·²ç»æ›´æ–°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å†æ¬¡è¯·æ±‚çš„æ—¶å€™ï¼Œå°±åˆ°æœåŠ¡å™¨æ‹‰å–æ–°çš„èµ„æºï¼Œå¹¶ä¿å­˜åœ¨æœ¬åœ°ã€‚è¿™æ ·å°±å¤§å¤§çš„å‡å°‘äº†è¯·æ±‚çš„æ¬¡æ•°ï¼Œæé«˜äº†ç½‘ç«™çš„æ€§èƒ½ã€‚è¿™å°±è¦ç”¨åˆ°æµè§ˆå™¨çš„ç¼“å­˜ç­–ç•¥äº†ã€‚</p><p>æ‰€è°“çš„<strong>æµè§ˆå™¨ç¼“å­˜</strong>æŒ‡çš„æ˜¯æµè§ˆå™¨å°†ç”¨æˆ·è¯·æ±‚è¿‡çš„é™æ€èµ„æºï¼Œå­˜å‚¨åˆ°ç”µè„‘æœ¬åœ°ç£ç›˜ä¸­ï¼Œå½“æµè§ˆå™¨å†æ¬¡è®¿é—®æ—¶ï¼Œå°±å¯ä»¥ç›´æ¥ä»æœ¬åœ°åŠ è½½ï¼Œä¸éœ€è¦å†å»æœåŠ¡ç«¯è¯·æ±‚äº†ã€‚</p><p>ä½¿ç”¨æµè§ˆå™¨ç¼“å­˜ï¼Œæœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š</p><ul><li>å‡å°‘äº†æœåŠ¡å™¨çš„è´Ÿæ‹…ï¼Œæé«˜äº†ç½‘ç«™çš„æ€§èƒ½</li><li>åŠ å¿«äº†å®¢æˆ·ç«¯ç½‘é¡µçš„åŠ è½½é€Ÿåº¦</li><li>å‡å°‘äº†å¤šä½™ç½‘ç»œæ•°æ®ä¼ è¾“</li></ul><h3 id="5-ç‚¹å‡»åˆ·æ–°æŒ‰é’®æˆ–è€…æŒ‰-F5ã€æŒ‰-Ctrl-F5-ï¼ˆå¼ºåˆ¶åˆ·æ–°ï¼‰ã€åœ°å€æ å›è½¦æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#5-ç‚¹å‡»åˆ·æ–°æŒ‰é’®æˆ–è€…æŒ‰-F5ã€æŒ‰-Ctrl-F5-ï¼ˆå¼ºåˆ¶åˆ·æ–°ï¼‰ã€åœ°å€æ å›è½¦æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="5. ç‚¹å‡»åˆ·æ–°æŒ‰é’®æˆ–è€…æŒ‰ F5ã€æŒ‰ Ctrl+F5 ï¼ˆå¼ºåˆ¶åˆ·æ–°ï¼‰ã€åœ°å€æ å›è½¦æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>5. ç‚¹å‡»åˆ·æ–°æŒ‰é’®æˆ–è€…æŒ‰ F5ã€æŒ‰ Ctrl+F5 ï¼ˆå¼ºåˆ¶åˆ·æ–°ï¼‰ã€åœ°å€æ å›è½¦æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><ul><li><strong>ç‚¹å‡»åˆ·æ–°æŒ‰é’®æˆ–è€…æŒ‰ F5ï¼š</strong> æµè§ˆå™¨ç›´æ¥å¯¹æœ¬åœ°çš„ç¼“å­˜æ–‡ä»¶è¿‡æœŸï¼Œä½†æ˜¯ä¼šå¸¦ä¸ŠIf-Modifed-Sinceï¼ŒIf-None-Matchï¼Œè¿™å°±æ„å‘³ç€æœåŠ¡å™¨ä¼šå¯¹æ–‡ä»¶æ£€æŸ¥æ–°é²œåº¦ï¼Œè¿”å›ç»“æœå¯èƒ½æ˜¯ 304ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ 200ã€‚</li><li><strong>ç”¨æˆ·æŒ‰ Ctrl+F5ï¼ˆå¼ºåˆ¶åˆ·æ–°ï¼‰ï¼š</strong> æµè§ˆå™¨ä¸ä»…ä¼šå¯¹æœ¬åœ°æ–‡ä»¶è¿‡æœŸï¼Œè€Œä¸”ä¸ä¼šå¸¦ä¸Š If-Modifed-Sinceï¼ŒIf-None-Matchï¼Œç›¸å½“äºä¹‹å‰ä»æ¥æ²¡æœ‰è¯·æ±‚è¿‡ï¼Œè¿”å›ç»“æœæ˜¯ 200ã€‚</li><li>åœ°å€æ å›è½¦ï¼š æµè§ˆå™¨å‘èµ·è¯·æ±‚ï¼ŒæŒ‰ç…§æ­£å¸¸æµç¨‹ï¼Œæœ¬åœ°æ£€æŸ¥æ˜¯å¦è¿‡æœŸï¼Œç„¶åæœåŠ¡å™¨æ£€æŸ¥æ–°é²œåº¦ï¼Œæœ€åè¿”å›å†…å®¹ã€‚</li></ul><h2 id="å››ã€æµè§ˆå™¨ç»„æˆ"><a href="#å››ã€æµè§ˆå™¨ç»„æˆ" class="headerlink" title="å››ã€æµè§ˆå™¨ç»„æˆ"></a>å››ã€æµè§ˆå™¨ç»„æˆ</h2><h3 id="1-å¯¹æµè§ˆå™¨çš„ç†è§£"><a href="#1-å¯¹æµè§ˆå™¨çš„ç†è§£" class="headerlink" title="1. å¯¹æµè§ˆå™¨çš„ç†è§£"></a>1. å¯¹æµè§ˆå™¨çš„ç†è§£</h3><p>æµè§ˆå™¨çš„ä¸»è¦åŠŸèƒ½æ˜¯å°†ç”¨æˆ·é€‰æ‹©çš„ web èµ„æºå‘ˆç°å‡ºæ¥ï¼Œå®ƒéœ€è¦ä»æœåŠ¡å™¨è¯·æ±‚èµ„æºï¼Œå¹¶å°†å…¶æ˜¾ç¤ºåœ¨æµè§ˆå™¨çª—å£ä¸­ï¼Œèµ„æºçš„æ ¼å¼é€šå¸¸æ˜¯ HTMLï¼Œä¹ŸåŒ…æ‹¬ PDFã€image åŠå…¶ä»–æ ¼å¼ã€‚ç”¨æˆ·ç”¨ URIï¼ˆUniform Resource Identifier ç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼‰æ¥æŒ‡å®šæ‰€è¯·æ±‚èµ„æºçš„ä½ç½®ã€‚</p><p>HTML å’Œ CSS è§„èŒƒä¸­è§„å®šäº†æµè§ˆå™¨è§£é‡Š html æ–‡æ¡£çš„æ–¹å¼ï¼Œç”± W3C ç»„ç»‡å¯¹è¿™äº›è§„èŒƒè¿›è¡Œç»´æŠ¤ï¼ŒW3C æ˜¯è´Ÿè´£åˆ¶å®š web æ ‡å‡†çš„ç»„ç»‡ã€‚ä½†æ˜¯æµè§ˆå™¨å‚å•†çº·çº·å¼€å‘è‡ªå·±çš„æ‰©å±•ï¼Œå¯¹è§„èŒƒçš„éµå¾ªå¹¶ä¸å®Œå–„ï¼Œè¿™ä¸º web å¼€å‘è€…å¸¦æ¥äº†ä¸¥é‡çš„å…¼å®¹æ€§é—®é¢˜ã€‚</p><p>æµè§ˆå™¨å¯ä»¥åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œshell å’Œ å†…æ ¸ã€‚å…¶ä¸­ shell çš„ç§ç±»ç›¸å¯¹æ¯”è¾ƒå¤šï¼Œå†…æ ¸åˆ™æ¯”è¾ƒå°‘ã€‚ä¹Ÿæœ‰ä¸€äº›æµè§ˆå™¨å¹¶ä¸åŒºåˆ†å¤–å£³å’Œå†…æ ¸ã€‚ä» Mozilla å°† Gecko ç‹¬ç«‹å‡ºæ¥åï¼Œæ‰æœ‰äº†å¤–å£³å’Œå†…æ ¸çš„æ˜ç¡®åˆ’åˆ†ã€‚</p><ul><li>shell æ˜¯æŒ‡æµè§ˆå™¨çš„å¤–å£³ï¼šä¾‹å¦‚èœå•ï¼Œå·¥å…·æ ç­‰ã€‚ä¸»è¦æ˜¯æä¾›ç»™ç”¨æˆ·ç•Œé¢æ“ä½œï¼Œå‚æ•°è®¾ç½®ç­‰ç­‰ã€‚å®ƒæ˜¯è°ƒç”¨å†…æ ¸æ¥å®ç°å„ç§åŠŸèƒ½çš„ã€‚</li><li>å†…æ ¸æ˜¯æµè§ˆå™¨çš„æ ¸å¿ƒã€‚å†…æ ¸æ˜¯åŸºäºæ ‡è®°è¯­è¨€æ˜¾ç¤ºå†…å®¹çš„ç¨‹åºæˆ–æ¨¡å—ã€‚</li></ul><h3 id="2-å¯¹æµè§ˆå™¨å†…æ ¸çš„ç†è§£"><a href="#2-å¯¹æµè§ˆå™¨å†…æ ¸çš„ç†è§£" class="headerlink" title="2. å¯¹æµè§ˆå™¨å†…æ ¸çš„ç†è§£"></a>2. å¯¹æµè§ˆå™¨å†…æ ¸çš„ç†è§£</h3><p>æµè§ˆå™¨å†…æ ¸ä¸»è¦åˆ†æˆä¸¤éƒ¨åˆ†ï¼š</p><ul><li>æ¸²æŸ“å¼•æ“çš„èŒè´£å°±æ˜¯æ¸²æŸ“ï¼Œå³åœ¨æµè§ˆå™¨çª—å£ä¸­æ˜¾ç¤ºæ‰€è¯·æ±‚çš„å†…å®¹ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¸²æŸ“å¼•æ“å¯ä»¥æ˜¾ç¤º htmlã€xml æ–‡æ¡£åŠå›¾ç‰‡ï¼Œå®ƒä¹Ÿå¯ä»¥å€ŸåŠ©æ’ä»¶æ˜¾ç¤ºå…¶ä»–ç±»å‹æ•°æ®ï¼Œä¾‹å¦‚ä½¿ç”¨ PDF é˜…è¯»å™¨æ’ä»¶ï¼Œå¯ä»¥æ˜¾ç¤º PDF æ ¼å¼ã€‚</li><li>JS å¼•æ“ï¼šè§£æå’Œæ‰§è¡Œ javascript æ¥å®ç°ç½‘é¡µçš„åŠ¨æ€æ•ˆæœã€‚</li></ul><p>æœ€å¼€å§‹æ¸²æŸ“å¼•æ“å’Œ JS å¼•æ“å¹¶æ²¡æœ‰åŒºåˆ†çš„å¾ˆæ˜ç¡®ï¼Œåæ¥ JS å¼•æ“è¶Šæ¥è¶Šç‹¬ç«‹ï¼Œå†…æ ¸å°±å€¾å‘äºåªæŒ‡æ¸²æŸ“å¼•æ“ã€‚</p><h3 id="3-å¸¸è§çš„æµè§ˆå™¨å†…æ ¸æ¯”è¾ƒ"><a href="#3-å¸¸è§çš„æµè§ˆå™¨å†…æ ¸æ¯”è¾ƒ" class="headerlink" title="3. å¸¸è§çš„æµè§ˆå™¨å†…æ ¸æ¯”è¾ƒ"></a>3. å¸¸è§çš„æµè§ˆå™¨å†…æ ¸æ¯”è¾ƒ</h3><ul><li><strong>Tridentï¼š</strong> è¿™ç§æµè§ˆå™¨å†…æ ¸æ˜¯ IE æµè§ˆå™¨ç”¨çš„å†…æ ¸ï¼Œå› ä¸ºåœ¨æ—©æœŸ IE å æœ‰å¤§é‡çš„å¸‚åœºä»½é¢ï¼Œæ‰€ä»¥è¿™ç§å†…æ ¸æ¯”è¾ƒæµè¡Œï¼Œä»¥å‰æœ‰å¾ˆå¤šç½‘é¡µä¹Ÿæ˜¯æ ¹æ®è¿™ä¸ªå†…æ ¸çš„æ ‡å‡†æ¥ç¼–å†™çš„ï¼Œä½†æ˜¯å®é™…ä¸Šè¿™ä¸ªå†…æ ¸å¯¹çœŸæ­£çš„ç½‘é¡µæ ‡å‡†æ”¯æŒä¸æ˜¯å¾ˆå¥½ã€‚ä½†æ˜¯ç”±äº IE çš„é«˜å¸‚åœºå æœ‰ç‡ï¼Œå¾®è½¯ä¹Ÿå¾ˆé•¿æ—¶é—´æ²¡æœ‰æ›´æ–° Trident å†…æ ¸ï¼Œå°±å¯¼è‡´äº† Trident å†…æ ¸å’Œ W3C æ ‡å‡†è„±èŠ‚ã€‚è¿˜æœ‰å°±æ˜¯ Trident å†…æ ¸çš„å¤§é‡ Bug ç­‰å®‰å…¨é—®é¢˜æ²¡æœ‰å¾—åˆ°è§£å†³ï¼ŒåŠ ä¸Šä¸€äº›ä¸“å®¶å­¦è€…å…¬å¼€è‡ªå·±è®¤ä¸º IE æµè§ˆå™¨ä¸å®‰å…¨çš„è§‚ç‚¹ï¼Œä½¿å¾ˆå¤šç”¨æˆ·å¼€å§‹è½¬å‘å…¶ä»–æµè§ˆå™¨ã€‚</li><li><strong>Geckoï¼š</strong> è¿™æ˜¯ Firefox å’Œ Flock æ‰€é‡‡ç”¨çš„å†…æ ¸ï¼Œè¿™ä¸ªå†…æ ¸çš„ä¼˜ç‚¹å°±æ˜¯åŠŸèƒ½å¼ºå¤§ã€ä¸°å¯Œï¼Œå¯ä»¥æ”¯æŒå¾ˆå¤šå¤æ‚ç½‘é¡µæ•ˆæœå’Œæµè§ˆå™¨æ‰©å±•æ¥å£ï¼Œä½†æ˜¯ä»£ä»·æ˜¯ä¹Ÿæ˜¾è€Œæ˜“è§å°±æ˜¯è¦æ¶ˆè€—å¾ˆå¤šçš„èµ„æºï¼Œæ¯”å¦‚å†…å­˜ã€‚</li><li><strong>Prestoï¼š</strong> Opera æ›¾ç»é‡‡ç”¨çš„å°±æ˜¯ Presto å†…æ ¸ï¼ŒPresto å†…æ ¸è¢«ç§°ä¸ºå…¬è®¤çš„æµè§ˆç½‘é¡µé€Ÿåº¦æœ€å¿«çš„å†…æ ¸ï¼Œè¿™å¾—ç›Šäºå®ƒåœ¨å¼€å‘æ—¶çš„å¤©ç”Ÿä¼˜åŠ¿ï¼Œåœ¨å¤„ç† JS è„šæœ¬ç­‰è„šæœ¬è¯­è¨€æ—¶ï¼Œä¼šæ¯”å…¶ä»–çš„å†…æ ¸å¿«3å€å·¦å³ï¼Œç¼ºç‚¹å°±æ˜¯ä¸ºäº†è¾¾åˆ°å¾ˆå¿«çš„é€Ÿåº¦è€Œä¸¢æ‰äº†ä¸€éƒ¨åˆ†ç½‘é¡µå…¼å®¹æ€§ã€‚</li><li><strong>Webkitï¼š</strong> Webkit æ˜¯ Safari é‡‡ç”¨çš„å†…æ ¸ï¼Œå®ƒçš„ä¼˜ç‚¹å°±æ˜¯ç½‘é¡µæµè§ˆé€Ÿåº¦è¾ƒå¿«ï¼Œè™½ç„¶ä¸åŠ Presto ä½†æ˜¯ä¹Ÿèƒœäº Gecko å’Œ Tridentï¼Œç¼ºç‚¹æ˜¯å¯¹äºç½‘é¡µä»£ç çš„å®¹é”™æ€§ä¸é«˜ï¼Œä¹Ÿå°±æ˜¯è¯´å¯¹ç½‘é¡µä»£ç çš„å…¼å®¹æ€§è¾ƒä½ï¼Œä¼šä½¿ä¸€äº›ç¼–å†™ä¸æ ‡å‡†çš„ç½‘é¡µæ— æ³•æ­£ç¡®æ˜¾ç¤ºã€‚WebKit å‰èº«æ˜¯ KDE å°ç»„çš„ KHTML å¼•æ“ï¼Œå¯ä»¥è¯´ WebKit æ˜¯ KHTML çš„ä¸€ä¸ªå¼€æºçš„åˆ†æ”¯ã€‚</li><li><strong>Blinkï¼š</strong> è°·æ­Œåœ¨ Chromium Blog ä¸Šå‘è¡¨åšå®¢ï¼Œç§°å°†ä¸è‹¹æœçš„å¼€æºæµè§ˆå™¨æ ¸å¿ƒ Webkit åˆ†é“æ‰¬é•³ï¼Œåœ¨ Chromium é¡¹ç›®ä¸­ç ”å‘ Blink æ¸²æŸ“å¼•æ“ï¼ˆå³æµè§ˆå™¨æ ¸å¿ƒï¼‰ï¼Œå†…ç½®äº Chrome æµè§ˆå™¨ä¹‹ä¸­ã€‚å…¶å® Blink å¼•æ“å°±æ˜¯ Webkit çš„ä¸€ä¸ªåˆ†æ”¯ï¼Œå°±åƒ webkit æ˜¯KHTML çš„åˆ†æ”¯ä¸€æ ·ã€‚Blink å¼•æ“ç°åœ¨æ˜¯è°·æ­Œå…¬å¸ä¸ Opera Software å…±åŒç ”å‘ï¼Œä¸Šé¢æåˆ°è¿‡çš„ï¼ŒOpera å¼ƒç”¨äº†è‡ªå·±çš„ Presto å†…æ ¸ï¼ŒåŠ å…¥ Google é˜µè¥ï¼Œè·Ÿéšè°·æ­Œä¸€èµ·ç ”å‘ Blinkã€‚</li></ul><h3 id="4-å¸¸è§æµè§ˆå™¨æ‰€ç”¨å†…æ ¸"><a href="#4-å¸¸è§æµè§ˆå™¨æ‰€ç”¨å†…æ ¸" class="headerlink" title="4. å¸¸è§æµè§ˆå™¨æ‰€ç”¨å†…æ ¸"></a>4. å¸¸è§æµè§ˆå™¨æ‰€ç”¨å†…æ ¸</h3><p>  ï¼ˆ1ï¼‰ IE æµè§ˆå™¨å†…æ ¸ï¼šTrident å†…æ ¸ï¼Œä¹Ÿæ˜¯ä¿—ç§°çš„ IE å†…æ ¸ï¼›</p><p> ï¼ˆ2ï¼‰ Chrome æµè§ˆå™¨å†…æ ¸ï¼šç»Ÿç§°ä¸º Chromium å†…æ ¸æˆ– Chrome å†…æ ¸ï¼Œä»¥å‰æ˜¯ Webkit å†…æ ¸ï¼Œç°åœ¨æ˜¯ Blinkå†…æ ¸ï¼›</p><p> ï¼ˆ3ï¼‰ Firefox æµè§ˆå™¨å†…æ ¸ï¼šGecko å†…æ ¸ï¼Œä¿—ç§° Firefox å†…æ ¸ï¼›</p><p> ï¼ˆ4ï¼‰ Safari æµè§ˆå™¨å†…æ ¸ï¼šWebkit å†…æ ¸ï¼›</p><p> ï¼ˆ5ï¼‰ Opera æµè§ˆå™¨å†…æ ¸ï¼šæœ€åˆæ˜¯è‡ªå·±çš„ Presto å†…æ ¸ï¼Œåæ¥åŠ å…¥è°·æ­Œå¤§å†›ï¼Œä» Webkit åˆåˆ°äº† Blink å†…æ ¸ï¼›</p><p> ï¼ˆ6ï¼‰ 360æµè§ˆå™¨ã€çŒè±¹æµè§ˆå™¨å†…æ ¸ï¼šIE + Chrome åŒå†…æ ¸ï¼›</p><p> ï¼ˆ7ï¼‰ æœç‹—ã€é¨æ¸¸ã€QQ æµè§ˆå™¨å†…æ ¸ï¼šTridentï¼ˆå…¼å®¹æ¨¡å¼ï¼‰+ Webkitï¼ˆé«˜é€Ÿæ¨¡å¼ï¼‰ï¼›</p><p> ï¼ˆ8ï¼‰ ç™¾åº¦æµè§ˆå™¨ã€ä¸–ç•Œä¹‹çª—å†…æ ¸ï¼šIE å†…æ ¸ï¼›</p><p> ï¼ˆ9ï¼‰ 2345æµè§ˆå™¨å†…æ ¸ï¼šå¥½åƒä»¥å‰æ˜¯ IE å†…æ ¸ï¼Œç°åœ¨ä¹Ÿæ˜¯ IE + Chrome åŒå†…æ ¸äº†ï¼›</p><p> ï¼ˆ10ï¼‰UC æµè§ˆå™¨å†…æ ¸ï¼šè¿™ä¸ªä¼—å£ä¸ä¸€ï¼ŒUC è¯´æ˜¯ä»–ä»¬è‡ªå·±ç ”å‘çš„ U3 å†…æ ¸ï¼Œä½†å¥½åƒè¿˜æ˜¯åŸºäº Webkit å’Œ Trident ï¼Œè¿˜æœ‰è¯´æ˜¯åŸºäºç«ç‹å†…æ ¸ã€‚</p><h3 id="5-æµè§ˆå™¨çš„ä¸»è¦ç»„æˆéƒ¨åˆ†"><a href="#5-æµè§ˆå™¨çš„ä¸»è¦ç»„æˆéƒ¨åˆ†" class="headerlink" title="5. æµè§ˆå™¨çš„ä¸»è¦ç»„æˆéƒ¨åˆ†"></a>5. æµè§ˆå™¨çš„ä¸»è¦ç»„æˆéƒ¨åˆ†</h3><ul><li><strong>â½¤æˆ·ç•Œâ¾¯</strong> åŒ…æ‹¬åœ°å€æ ã€å‰è¿›/åé€€æŒ‰é’®ã€ä¹¦ç­¾èœå•ç­‰ã€‚é™¤äº†æµè§ˆå™¨ä¸»çª—â¼æ˜¾ç¤ºçš„æ‚¨è¯·æ±‚çš„â»šâ¾¯å¤–ï¼Œå…¶ä»–æ˜¾ç¤ºçš„å„ä¸ªéƒ¨åˆ†éƒ½å±äºâ½¤æˆ·ç•Œâ¾¯ã€‚ </li><li><strong>æµè§ˆå™¨å¼•æ“</strong> åœ¨â½¤æˆ·ç•Œâ¾¯å’Œå‘ˆç°å¼•æ“ä¹‹é—´ä¼ é€æŒ‡ä»¤ã€‚ </li><li><strong>å‘ˆç°å¼•æ“</strong> è´Ÿè´£æ˜¾ç¤ºè¯·æ±‚çš„å†…å®¹ã€‚å¦‚æœè¯·æ±‚çš„å†…å®¹æ˜¯ HTMLï¼Œå®ƒå°±è´Ÿè´£è§£æ HTML å’Œ CSS å†…å®¹ï¼Œå¹¶å°†è§£æåçš„å†…å®¹æ˜¾ç¤ºåœ¨å±å¹•ä¸Šã€‚ </li><li><strong>â½¹ç»œ</strong> â½¤äºâ½¹ç»œè°ƒâ½¤ï¼Œâ½å¦‚ HTTP è¯·æ±‚ã€‚å…¶æ¥â¼ä¸å¹³å°â½†å…³ï¼Œå¹¶ä¸ºæ‰€æœ‰å¹³å°æä¾›åº•å±‚å®ç°ã€‚ </li><li><strong>â½¤æˆ·ç•Œâ¾¯åç«¯</strong> â½¤äºç»˜åˆ¶åŸºæœ¬çš„çª—â¼â¼©éƒ¨ä»¶ï¼Œâ½å¦‚ç»„åˆæ¡†å’Œçª—â¼ã€‚å…¶å…¬å¼€äº†ä¸å¹³å°â½†å…³çš„é€šâ½¤æ¥â¼ï¼Œâ½½åœ¨åº•å±‚ä½¿â½¤æ“ä½œç³»ç»Ÿçš„â½¤æˆ·ç•Œâ¾¯â½…æ³•ã€‚ </li><li><strong>JavaScript è§£é‡Šå™¨</strong>ã€‚â½¤äºè§£æå’Œæ‰§â¾ JavaScript ä»£ç ã€‚ </li><li><strong>æ•°æ®å­˜å‚¨</strong> è¿™æ˜¯æŒä¹…å±‚ã€‚æµè§ˆå™¨éœ€è¦åœ¨ç¡¬ç›˜ä¸Šä¿å­˜å„ç§æ•°æ®ï¼Œä¾‹å¦‚ Cookieã€‚æ–°çš„ HTML è§„èŒƒ (HTML5) å®šä¹‰äº†â€œâ½¹ç»œæ•°æ®åº“â€ï¼Œè¿™æ˜¯â¼€ä¸ªå®Œæ•´ï¼ˆä½†æ˜¯è½»ä¾¿ï¼‰çš„æµè§ˆå™¨å†…æ•°æ®åº“ã€‚ </li></ul><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå’Œâ¼¤å¤šæ•°æµè§ˆå™¨ä¸åŒï¼ŒChrome æµè§ˆå™¨çš„æ¯ä¸ªæ ‡ç­¾â»šéƒ½åˆ†åˆ«å¯¹åº”â¼€ä¸ªå‘ˆç°å¼•æ“å®ä¾‹ã€‚æ¯ä¸ªæ ‡ç­¾â»šéƒ½æ˜¯â¼€ä¸ªç‹¬â½´çš„è¿›ç¨‹ã€‚</p><h2 id="äº”ã€æµè§ˆå™¨æ¸²æŸ“åŸç†"><a href="#äº”ã€æµè§ˆå™¨æ¸²æŸ“åŸç†" class="headerlink" title="äº”ã€æµè§ˆå™¨æ¸²æŸ“åŸç†"></a>äº”ã€æµè§ˆå™¨æ¸²æŸ“åŸç†</h2><h3 id="1-æµè§ˆå™¨çš„æ¸²æŸ“è¿‡ç¨‹"><a href="#1-æµè§ˆå™¨çš„æ¸²æŸ“è¿‡ç¨‹" class="headerlink" title="1. æµè§ˆå™¨çš„æ¸²æŸ“è¿‡ç¨‹"></a>1. æµè§ˆå™¨çš„æ¸²æŸ“è¿‡ç¨‹</h3><p>æµè§ˆå™¨æ¸²æŸ“ä¸»è¦æœ‰ä»¥ä¸‹æ­¥éª¤ï¼š</p><ul><li>é¦–å…ˆè§£ææ”¶åˆ°çš„æ–‡æ¡£ï¼Œæ ¹æ®æ–‡æ¡£å®šä¹‰æ„å»ºä¸€æ£µ DOM æ ‘ï¼ŒDOM æ ‘æ˜¯ç”± DOM å…ƒç´ åŠå±æ€§èŠ‚ç‚¹ç»„æˆçš„ã€‚</li><li>ç„¶åå¯¹ CSS è¿›è¡Œè§£æï¼Œç”Ÿæˆ CSSOM è§„åˆ™æ ‘ã€‚</li><li>æ ¹æ® DOM æ ‘å’Œ CSSOM è§„åˆ™æ ‘æ„å»ºæ¸²æŸ“æ ‘ã€‚æ¸²æŸ“æ ‘çš„èŠ‚ç‚¹è¢«ç§°ä¸ºæ¸²æŸ“å¯¹è±¡ï¼Œæ¸²æŸ“å¯¹è±¡æ˜¯ä¸€ä¸ªåŒ…å«æœ‰é¢œè‰²å’Œå¤§å°ç­‰å±æ€§çš„çŸ©å½¢ï¼Œæ¸²æŸ“å¯¹è±¡å’Œ DOM å…ƒç´ ç›¸å¯¹åº”ï¼Œä½†è¿™ç§å¯¹åº”å…³ç³»ä¸æ˜¯ä¸€å¯¹ä¸€çš„ï¼Œä¸å¯è§çš„ DOM å…ƒç´ ä¸ä¼šè¢«æ’å…¥æ¸²æŸ“æ ‘ã€‚è¿˜æœ‰ä¸€äº› DOMå…ƒç´ å¯¹åº”å‡ ä¸ªå¯è§å¯¹è±¡ï¼Œå®ƒä»¬ä¸€èˆ¬æ˜¯ä¸€äº›å…·æœ‰å¤æ‚ç»“æ„çš„å…ƒç´ ï¼Œæ— æ³•ç”¨ä¸€ä¸ªçŸ©å½¢æ¥æè¿°ã€‚</li><li>å½“æ¸²æŸ“å¯¹è±¡è¢«åˆ›å»ºå¹¶æ·»åŠ åˆ°æ ‘ä¸­ï¼Œå®ƒä»¬å¹¶æ²¡æœ‰ä½ç½®å’Œå¤§å°ï¼Œæ‰€ä»¥å½“æµè§ˆå™¨ç”Ÿæˆæ¸²æŸ“æ ‘ä»¥åï¼Œå°±ä¼šæ ¹æ®æ¸²æŸ“æ ‘æ¥è¿›è¡Œå¸ƒå±€ï¼ˆä¹Ÿå¯ä»¥å«åšå›æµï¼‰ã€‚è¿™ä¸€é˜¶æ®µæµè§ˆå™¨è¦åšçš„äº‹æƒ…æ˜¯è¦å¼„æ¸…æ¥šå„ä¸ªèŠ‚ç‚¹åœ¨é¡µé¢ä¸­çš„ç¡®åˆ‡ä½ç½®å’Œå¤§å°ã€‚é€šå¸¸è¿™ä¸€è¡Œä¸ºä¹Ÿè¢«ç§°ä¸ºâ€œè‡ªåŠ¨é‡æ’â€ã€‚</li><li>å¸ƒå±€é˜¶æ®µç»“æŸåæ˜¯ç»˜åˆ¶é˜¶æ®µï¼Œéå†æ¸²æŸ“æ ‘å¹¶è°ƒç”¨æ¸²æŸ“å¯¹è±¡çš„ paint æ–¹æ³•å°†å®ƒä»¬çš„å†…å®¹æ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼Œç»˜åˆ¶ä½¿ç”¨ UI åŸºç¡€ç»„ä»¶ã€‚</li></ul><p>å¤§è‡´è¿‡ç¨‹å¦‚å›¾æ‰€ç¤ºï¼š<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/theory/7.png" alt=""></p><p><strong>æ³¨æ„ï¼š</strong> è¿™ä¸ªè¿‡ç¨‹æ˜¯é€æ­¥å®Œæˆçš„ï¼Œä¸ºäº†æ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼Œæ¸²æŸ“å¼•æ“å°†ä¼šå°½å¯èƒ½æ—©çš„å°†å†…å®¹å‘ˆç°åˆ°å±å¹•ä¸Šï¼Œå¹¶ä¸ä¼šç­‰åˆ°æ‰€æœ‰çš„html éƒ½è§£æå®Œæˆä¹‹åå†å»æ„å»ºå’Œå¸ƒå±€ render æ ‘ã€‚å®ƒæ˜¯è§£æå®Œä¸€éƒ¨åˆ†å†…å®¹å°±æ˜¾ç¤ºä¸€éƒ¨åˆ†å†…å®¹ï¼ŒåŒæ—¶ï¼Œå¯èƒ½è¿˜åœ¨é€šè¿‡ç½‘ç»œä¸‹è½½å…¶ä½™å†…å®¹ã€‚</p><h3 id="2-æµè§ˆå™¨æ¸²æŸ“ä¼˜åŒ–"><a href="#2-æµè§ˆå™¨æ¸²æŸ“ä¼˜åŒ–" class="headerlink" title="2. æµè§ˆå™¨æ¸²æŸ“ä¼˜åŒ–"></a>2. æµè§ˆå™¨æ¸²æŸ“ä¼˜åŒ–</h3><p><strong>ï¼ˆ1ï¼‰é’ˆå¯¹JavaScriptï¼š</strong> JavaScriptæ—¢ä¼šé˜»å¡HTMLçš„è§£æï¼Œä¹Ÿä¼šé˜»å¡CSSçš„è§£æã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥å¯¹JavaScriptçš„åŠ è½½æ–¹å¼è¿›è¡Œæ”¹å˜ï¼Œæ¥è¿›è¡Œä¼˜åŒ–ï¼š</p><p>ï¼ˆ1ï¼‰å°½é‡å°†JavaScriptæ–‡ä»¶æ”¾åœ¨bodyçš„æœ€å</p><p>ï¼ˆ2ï¼‰ bodyä¸­é—´å°½é‡ä¸è¦å†™<code>&lt;script&gt;</code>æ ‡ç­¾</p><p>ï¼ˆ3ï¼‰<code>&lt;script&gt;</code>æ ‡ç­¾çš„å¼•å…¥èµ„æºæ–¹å¼æœ‰ä¸‰ç§ï¼Œæœ‰ä¸€ç§å°±æ˜¯æˆ‘ä»¬å¸¸ç”¨çš„ç›´æ¥å¼•å…¥ï¼Œè¿˜æœ‰ä¸¤ç§å°±æ˜¯ä½¿ç”¨ async å±æ€§å’Œ defer å±æ€§æ¥å¼‚æ­¥å¼•å…¥ï¼Œä¸¤è€…éƒ½æ˜¯å»å¼‚æ­¥åŠ è½½å¤–éƒ¨çš„JSæ–‡ä»¶ï¼Œä¸ä¼šé˜»å¡DOMçš„è§£æï¼ˆå°½é‡ä½¿ç”¨å¼‚æ­¥åŠ è½½ï¼‰ã€‚ä¸‰è€…çš„åŒºåˆ«å¦‚ä¸‹ï¼š</p><ul><li><strong>script</strong> ç«‹å³åœæ­¢é¡µé¢æ¸²æŸ“å»åŠ è½½èµ„æºæ–‡ä»¶ï¼Œå½“èµ„æºåŠ è½½å®Œæ¯•åç«‹å³æ‰§è¡Œjsä»£ç ï¼Œjsä»£ç æ‰§è¡Œå®Œæ¯•åç»§ç»­æ¸²æŸ“é¡µé¢ï¼›</li><li><strong>async</strong> æ˜¯åœ¨ä¸‹è½½å®Œæˆä¹‹åï¼Œç«‹å³å¼‚æ­¥åŠ è½½ï¼ŒåŠ è½½å¥½åç«‹å³æ‰§è¡Œï¼Œå¤šä¸ªå¸¦asyncå±æ€§çš„æ ‡ç­¾ï¼Œä¸èƒ½ä¿è¯åŠ è½½çš„é¡ºåºï¼›</li><li><strong>defer</strong> æ˜¯åœ¨ä¸‹è½½å®Œæˆä¹‹åï¼Œç«‹å³å¼‚æ­¥åŠ è½½ã€‚åŠ è½½å¥½åï¼Œå¦‚æœ DOM æ ‘è¿˜æ²¡æ„å»ºå¥½ï¼Œåˆ™å…ˆç­‰ DOM æ ‘è§£æå¥½å†æ‰§è¡Œï¼›å¦‚æœDOMæ ‘å·²ç»å‡†å¤‡å¥½ï¼Œåˆ™ç«‹å³æ‰§è¡Œã€‚å¤šä¸ªå¸¦deferå±æ€§çš„æ ‡ç­¾ï¼ŒæŒ‰ç…§é¡ºåºæ‰§è¡Œã€‚</li></ul><p><strong>ï¼ˆ2ï¼‰é’ˆå¯¹CSSï¼š</strong>ä½¿ç”¨CSSæœ‰ä¸‰ç§æ–¹å¼ï¼šä½¿ç”¨<strong>linkã€@importã€å†…è”æ ·å¼</strong>ï¼Œå…¶ä¸­linkå’Œ@importéƒ½æ˜¯å¯¼å…¥å¤–éƒ¨æ ·å¼ã€‚å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«ï¼š</p><ul><li><strong>link</strong>ï¼šæµè§ˆå™¨ä¼šæ´¾å‘ä¸€ä¸ªæ–°ç­‰çº¿ç¨‹(HTTPçº¿ç¨‹)å»åŠ è½½èµ„æºæ–‡ä»¶ï¼Œä¸æ­¤åŒæ—¶GUIæ¸²æŸ“çº¿ç¨‹ä¼šç»§ç»­å‘ä¸‹æ¸²æŸ“ä»£ç </li><li><strong>@import</strong>ï¼šGUIæ¸²æŸ“çº¿ç¨‹ä¼šæš‚æ—¶åœæ­¢æ¸²æŸ“ï¼Œå»æœåŠ¡å™¨åŠ è½½èµ„æºæ–‡ä»¶ï¼Œèµ„æºæ–‡ä»¶æ²¡æœ‰è¿”å›ä¹‹å‰ä¸ä¼šç»§ç»­æ¸²æŸ“(é˜»ç¢æµè§ˆå™¨æ¸²æŸ“)</li><li><strong>style</strong>ï¼šGUIç›´æ¥æ¸²æŸ“</li></ul><p>å¤–éƒ¨æ ·å¼å¦‚æœé•¿æ—¶é—´æ²¡æœ‰åŠ è½½å®Œæ¯•ï¼Œæµè§ˆå™¨ä¸ºäº†ç”¨æˆ·ä½“éªŒï¼Œä¼šä½¿ç”¨æµè§ˆå™¨ä¼šé»˜è®¤æ ·å¼ï¼Œç¡®ä¿é¦–æ¬¡æ¸²æŸ“çš„é€Ÿåº¦ã€‚æ‰€ä»¥CSSä¸€èˆ¬å†™åœ¨headrä¸­ï¼Œè®©æµè§ˆå™¨å°½å¿«å‘é€è¯·æ±‚å»è·å–cssæ ·å¼ã€‚</p><p>æ‰€ä»¥ï¼Œåœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¯¼å…¥å¤–éƒ¨æ ·å¼ä½¿ç”¨linkï¼Œè€Œä¸ç”¨@importã€‚å¦‚æœcsså°‘ï¼Œå°½å¯èƒ½é‡‡ç”¨å†…åµŒæ ·å¼ï¼Œç›´æ¥å†™åœ¨styleæ ‡ç­¾ä¸­ã€‚</p><p><strong>ï¼ˆ3ï¼‰é’ˆå¯¹DOMæ ‘ã€CSSOMæ ‘ï¼š</strong><br>å¯ä»¥é€šè¿‡ä»¥ä¸‹å‡ ç§æ–¹å¼æ¥å‡å°‘æ¸²æŸ“çš„æ—¶é—´ï¼š</p><ul><li>HTMLæ–‡ä»¶çš„ä»£ç å±‚çº§å°½é‡ä¸è¦å¤ªæ·±</li><li>ä½¿ç”¨è¯­ä¹‰åŒ–çš„æ ‡ç­¾ï¼Œæ¥é¿å…ä¸æ ‡å‡†è¯­ä¹‰åŒ–çš„ç‰¹æ®Šå¤„ç†</li><li>å‡å°‘CSSDä»£ç çš„å±‚çº§ï¼Œå› ä¸ºé€‰æ‹©å™¨æ˜¯ä»å·¦å‘å³è¿›è¡Œè§£æçš„</li></ul><p><strong>ï¼ˆ4ï¼‰å‡å°‘å›æµä¸é‡ç»˜ï¼š</strong></p><ul><li>æ“ä½œDOMæ—¶ï¼Œå°½é‡åœ¨ä½å±‚çº§çš„DOMèŠ‚ç‚¹è¿›è¡Œæ“ä½œ</li><li>ä¸è¦ä½¿ç”¨<code>table</code>å¸ƒå±€ï¼Œ ä¸€ä¸ªå°çš„æ”¹åŠ¨å¯èƒ½ä¼šä½¿æ•´ä¸ª<code>table</code>è¿›è¡Œé‡æ–°å¸ƒå±€</li><li>ä½¿ç”¨CSSçš„è¡¨è¾¾å¼</li><li>ä¸è¦é¢‘ç¹æ“ä½œå…ƒç´ çš„æ ·å¼ï¼Œå¯¹äºé™æ€é¡µé¢ï¼Œå¯ä»¥ä¿®æ”¹ç±»åï¼Œè€Œä¸æ˜¯æ ·å¼ã€‚</li><li>ä½¿ç”¨absoluteæˆ–è€…fixedï¼Œä½¿å…ƒç´ è„±ç¦»æ–‡æ¡£æµï¼Œè¿™æ ·ä»–ä»¬å‘ç”Ÿå˜åŒ–å°±ä¸ä¼šå½±å“å…¶ä»–å…ƒç´ </li><li>é¿å…é¢‘ç¹æ“ä½œDOMï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªæ–‡æ¡£ç‰‡æ®µ<code>documentFragment</code>ï¼Œåœ¨å®ƒä¸Šé¢åº”ç”¨æ‰€æœ‰DOMæ“ä½œï¼Œæœ€åå†æŠŠå®ƒæ·»åŠ åˆ°æ–‡æ¡£ä¸­</li><li>å°†å…ƒç´ å…ˆè®¾ç½®<code>display: none</code>ï¼Œæ“ä½œç»“æŸåå†æŠŠå®ƒæ˜¾ç¤ºå‡ºæ¥ã€‚å› ä¸ºåœ¨displayå±æ€§ä¸ºnoneçš„å…ƒç´ ä¸Šè¿›è¡Œçš„DOMæ“ä½œä¸ä¼šå¼•å‘å›æµå’Œé‡ç»˜ã€‚</li><li>å°†DOMçš„å¤šä¸ªè¯»æ“ä½œï¼ˆæˆ–è€…å†™æ“ä½œï¼‰æ”¾åœ¨ä¸€èµ·ï¼Œè€Œä¸æ˜¯è¯»å†™æ“ä½œç©¿æ’ç€å†™ã€‚è¿™å¾—ç›Šäº<strong>æµè§ˆå™¨çš„æ¸²æŸ“é˜Ÿåˆ—æœºåˆ¶</strong>ã€‚</li></ul><p>æµè§ˆå™¨é’ˆå¯¹é¡µé¢çš„å›æµä¸é‡ç»˜ï¼Œè¿›è¡Œäº†è‡ªèº«çš„ä¼˜åŒ–â€”â€”<strong>æ¸²æŸ“é˜Ÿåˆ—</strong></p><p><strong>æµè§ˆå™¨ä¼šå°†æ‰€æœ‰çš„å›æµã€é‡ç»˜çš„æ“ä½œæ”¾åœ¨ä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œå½“é˜Ÿåˆ—ä¸­çš„æ“ä½œåˆ°äº†ä¸€å®šçš„æ•°é‡æˆ–è€…åˆ°äº†ä¸€å®šçš„æ—¶é—´é—´éš”ï¼Œæµè§ˆå™¨å°±ä¼šå¯¹é˜Ÿåˆ—è¿›è¡Œæ‰¹å¤„ç†ã€‚è¿™æ ·å°±ä¼šè®©å¤šæ¬¡çš„å›æµã€é‡ç»˜å˜æˆä¸€æ¬¡å›æµé‡ç»˜ã€‚</strong></p><p>å°†å¤šä¸ªè¯»æ“ä½œï¼ˆæˆ–è€…å†™æ“ä½œï¼‰æ”¾åœ¨ä¸€èµ·ï¼Œå°±ä¼šç­‰æ‰€æœ‰çš„è¯»æ“ä½œè¿›å…¥é˜Ÿåˆ—ä¹‹åæ‰§è¡Œï¼Œè¿™æ ·ï¼ŒåŸæœ¬åº”è¯¥æ˜¯è§¦å‘å¤šæ¬¡å›æµï¼Œå˜æˆäº†åªè§¦å‘ä¸€æ¬¡å›æµã€‚</p><h3 id="3-æ¸²æŸ“è¿‡ç¨‹ä¸­é‡åˆ°-JS-æ–‡ä»¶å¦‚ä½•å¤„ç†ï¼Ÿ"><a href="#3-æ¸²æŸ“è¿‡ç¨‹ä¸­é‡åˆ°-JS-æ–‡ä»¶å¦‚ä½•å¤„ç†ï¼Ÿ" class="headerlink" title="3. æ¸²æŸ“è¿‡ç¨‹ä¸­é‡åˆ° JS æ–‡ä»¶å¦‚ä½•å¤„ç†ï¼Ÿ"></a>3. æ¸²æŸ“è¿‡ç¨‹ä¸­é‡åˆ° JS æ–‡ä»¶å¦‚ä½•å¤„ç†ï¼Ÿ</h3><p>JavaScript çš„åŠ è½½ã€è§£æä¸æ‰§è¡Œä¼šé˜»å¡æ–‡æ¡£çš„è§£æï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ„å»º DOM æ—¶ï¼ŒHTML è§£æå™¨è‹¥é‡åˆ°äº† JavaScriptï¼Œé‚£ä¹ˆå®ƒä¼šæš‚åœæ–‡æ¡£çš„è§£æï¼Œå°†æ§åˆ¶æƒç§»äº¤ç»™ JavaScript å¼•æ“ï¼Œç­‰ JavaScript å¼•æ“è¿è¡Œå®Œæ¯•ï¼Œæµè§ˆå™¨å†ä»ä¸­æ–­çš„åœ°æ–¹æ¢å¤ç»§ç»­è§£ææ–‡æ¡£ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæƒ³è¦é¦–å±æ¸²æŸ“çš„è¶Šå¿«ï¼Œå°±è¶Šä¸åº”è¯¥åœ¨é¦–å±å°±åŠ è½½ JS æ–‡ä»¶ï¼Œè¿™ä¹Ÿæ˜¯éƒ½å»ºè®®å°† script æ ‡ç­¾æ”¾åœ¨ body æ ‡ç­¾åº•éƒ¨çš„åŸå› ã€‚å½“ç„¶åœ¨å½“ä¸‹ï¼Œå¹¶ä¸æ˜¯è¯´ script æ ‡ç­¾å¿…é¡»æ”¾åœ¨åº•éƒ¨ï¼Œå› ä¸ºä½ å¯ä»¥ç»™ script æ ‡ç­¾æ·»åŠ  defer æˆ–è€… async å±æ€§ã€‚</p><h3 id="4-ä»€ä¹ˆæ˜¯æ–‡æ¡£çš„é¢„è§£æï¼Ÿ"><a href="#4-ä»€ä¹ˆæ˜¯æ–‡æ¡£çš„é¢„è§£æï¼Ÿ" class="headerlink" title="4. ä»€ä¹ˆæ˜¯æ–‡æ¡£çš„é¢„è§£æï¼Ÿ"></a>4. ä»€ä¹ˆæ˜¯æ–‡æ¡£çš„é¢„è§£æï¼Ÿ</h3><p>Webkit å’Œ Firefox éƒ½åšäº†è¿™ä¸ªä¼˜åŒ–ï¼Œå½“æ‰§è¡Œ JavaScript è„šæœ¬æ—¶ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹è§£æå‰©ä¸‹çš„æ–‡æ¡£ï¼Œå¹¶åŠ è½½åé¢éœ€è¦é€šè¿‡ç½‘ç»œåŠ è½½çš„èµ„æºã€‚è¿™ç§æ–¹å¼å¯ä»¥ä½¿èµ„æºå¹¶è¡ŒåŠ è½½ä»è€Œä½¿æ•´ä½“é€Ÿåº¦æ›´å¿«ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé¢„è§£æå¹¶ä¸æ”¹å˜ DOM æ ‘ï¼Œå®ƒå°†è¿™ä¸ªå·¥ä½œç•™ç»™ä¸»è§£æè¿‡ç¨‹ï¼Œè‡ªå·±åªè§£æå¤–éƒ¨èµ„æºçš„å¼•ç”¨ï¼Œæ¯”å¦‚å¤–éƒ¨è„šæœ¬ã€æ ·å¼è¡¨åŠå›¾ç‰‡ã€‚</p><h3 id="5-CSS-å¦‚ä½•é˜»å¡æ–‡æ¡£è§£æï¼Ÿ"><a href="#5-CSS-å¦‚ä½•é˜»å¡æ–‡æ¡£è§£æï¼Ÿ" class="headerlink" title="5. CSS å¦‚ä½•é˜»å¡æ–‡æ¡£è§£æï¼Ÿ"></a>5. CSS å¦‚ä½•é˜»å¡æ–‡æ¡£è§£æï¼Ÿ</h3><p>ç†è®ºä¸Šï¼Œæ—¢ç„¶æ ·å¼è¡¨ä¸æ”¹å˜ DOM æ ‘ï¼Œä¹Ÿå°±æ²¡æœ‰å¿…è¦åœä¸‹æ–‡æ¡£çš„è§£æç­‰å¾…å®ƒä»¬ã€‚ç„¶è€Œï¼Œå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼ŒJavaScript è„šæœ¬æ‰§è¡Œæ—¶å¯èƒ½åœ¨æ–‡æ¡£çš„è§£æè¿‡ç¨‹ä¸­è¯·æ±‚æ ·å¼ä¿¡æ¯ï¼Œå¦‚æœæ ·å¼è¿˜æ²¡æœ‰åŠ è½½å’Œè§£æï¼Œè„šæœ¬å°†å¾—åˆ°é”™è¯¯çš„å€¼ï¼Œæ˜¾ç„¶è¿™å°†ä¼šå¯¼è‡´å¾ˆå¤šé—®é¢˜ã€‚æ‰€ä»¥å¦‚æœæµè§ˆå™¨å°šæœªå®Œæˆ CSSOM çš„ä¸‹è½½å’Œæ„å»ºï¼Œè€Œæˆ‘ä»¬å´æƒ³åœ¨æ­¤æ—¶è¿è¡Œè„šæœ¬ï¼Œé‚£ä¹ˆæµè§ˆå™¨å°†å»¶è¿Ÿ JavaScript è„šæœ¬æ‰§è¡Œå’Œæ–‡æ¡£çš„è§£æï¼Œç›´è‡³å…¶å®Œæˆ CSSOM çš„ä¸‹è½½å’Œæ„å»ºã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨ä¼šå…ˆä¸‹è½½å’Œæ„å»º CSSOMï¼Œç„¶åå†æ‰§è¡Œ JavaScriptï¼Œæœ€åå†ç»§ç»­æ–‡æ¡£çš„è§£æã€‚</p><h3 id="6-å¦‚ä½•ä¼˜åŒ–å…³é”®æ¸²æŸ“è·¯å¾„ï¼Ÿ"><a href="#6-å¦‚ä½•ä¼˜åŒ–å…³é”®æ¸²æŸ“è·¯å¾„ï¼Ÿ" class="headerlink" title="6. å¦‚ä½•ä¼˜åŒ–å…³é”®æ¸²æŸ“è·¯å¾„ï¼Ÿ"></a>6. å¦‚ä½•ä¼˜åŒ–å…³é”®æ¸²æŸ“è·¯å¾„ï¼Ÿ</h3><p>ä¸ºå°½å¿«å®Œæˆé¦–æ¬¡æ¸²æŸ“ï¼Œæˆ‘ä»¬éœ€è¦æœ€å¤§é™åº¦å‡å°ä»¥ä¸‹ä¸‰ç§å¯å˜å› ç´ ï¼š</p><p> ï¼ˆ1ï¼‰å…³é”®èµ„æºçš„æ•°é‡ã€‚</p><p> ï¼ˆ2ï¼‰å…³é”®è·¯å¾„é•¿åº¦ã€‚</p><p> ï¼ˆ3ï¼‰å…³é”®å­—èŠ‚çš„æ•°é‡ã€‚</p><p>å…³é”®èµ„æºæ˜¯å¯èƒ½é˜»æ­¢ç½‘é¡µé¦–æ¬¡æ¸²æŸ“çš„èµ„æºã€‚è¿™äº›èµ„æºè¶Šå°‘ï¼Œæµè§ˆå™¨çš„å·¥ä½œé‡å°±è¶Šå°ï¼Œå¯¹ CPU ä»¥åŠå…¶ä»–èµ„æºçš„å ç”¨ä¹Ÿå°±è¶Šå°‘ã€‚åŒæ ·ï¼Œå…³é”®è·¯å¾„é•¿åº¦å—æ‰€æœ‰å…³é”®èµ„æºä¸å…¶å­—èŠ‚å¤§å°ä¹‹é—´ä¾èµ–å…³ç³»å›¾çš„å½±å“ï¼šæŸäº›èµ„æºåªèƒ½åœ¨ä¸Šä¸€èµ„æºå¤„ç†å®Œæ¯•ä¹‹åæ‰èƒ½å¼€å§‹ä¸‹è½½ï¼Œå¹¶ä¸”èµ„æºè¶Šå¤§ï¼Œä¸‹è½½æ‰€éœ€çš„å¾€è¿”æ¬¡æ•°å°±è¶Šå¤šã€‚æœ€åï¼Œæµè§ˆå™¨éœ€è¦ä¸‹è½½çš„å…³é”®å­—èŠ‚è¶Šå°‘ï¼Œå¤„ç†å†…å®¹å¹¶è®©å…¶å‡ºç°åœ¨å±å¹•ä¸Šçš„é€Ÿåº¦å°±è¶Šå¿«ã€‚è¦å‡å°‘å­—èŠ‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å‡å°‘èµ„æºæ•°ï¼ˆå°†å®ƒä»¬åˆ é™¤æˆ–è®¾ä¸ºéå…³é”®èµ„æºï¼‰ï¼Œæ­¤å¤–è¿˜è¦å‹ç¼©å’Œä¼˜åŒ–å„é¡¹èµ„æºï¼Œç¡®ä¿æœ€å¤§é™åº¦å‡å°ä¼ é€å¤§å°ã€‚</p><p>ä¼˜åŒ–å…³é”®æ¸²æŸ“è·¯å¾„çš„å¸¸è§„æ­¥éª¤å¦‚ä¸‹ï¼š</p><p>ï¼ˆ1ï¼‰å¯¹å…³é”®è·¯å¾„è¿›è¡Œåˆ†æå’Œç‰¹æ€§æè¿°ï¼šèµ„æºæ•°ã€å­—èŠ‚æ•°ã€é•¿åº¦ã€‚</p><p> ï¼ˆ2ï¼‰æœ€å¤§é™åº¦å‡å°‘å…³é”®èµ„æºçš„æ•°é‡ï¼šåˆ é™¤å®ƒä»¬ï¼Œå»¶è¿Ÿå®ƒä»¬çš„ä¸‹è½½ï¼Œå°†å®ƒä»¬æ ‡è®°ä¸ºå¼‚æ­¥ç­‰ã€‚</p><p>ï¼ˆ3ï¼‰ä¼˜åŒ–å…³é”®å­—èŠ‚æ•°ä»¥ç¼©çŸ­ä¸‹è½½æ—¶é—´ï¼ˆå¾€è¿”æ¬¡æ•°ï¼‰ã€‚</p><p> ï¼ˆ4ï¼‰ä¼˜åŒ–å…¶ä½™å…³é”®èµ„æºçš„åŠ è½½é¡ºåºï¼šæ‚¨éœ€è¦å°½æ—©ä¸‹è½½æ‰€æœ‰å…³é”®èµ„äº§ï¼Œä»¥ç¼©çŸ­å…³é”®è·¯å¾„é•¿åº¦</p><h3 id="7-ä»€ä¹ˆæƒ…å†µä¼šé˜»å¡æ¸²æŸ“ï¼Ÿ"><a href="#7-ä»€ä¹ˆæƒ…å†µä¼šé˜»å¡æ¸²æŸ“ï¼Ÿ" class="headerlink" title="7. ä»€ä¹ˆæƒ…å†µä¼šé˜»å¡æ¸²æŸ“ï¼Ÿ"></a>7. ä»€ä¹ˆæƒ…å†µä¼šé˜»å¡æ¸²æŸ“ï¼Ÿ</h3><p>é¦–å…ˆæ¸²æŸ“çš„å‰ææ˜¯ç”Ÿæˆæ¸²æŸ“æ ‘ï¼Œæ‰€ä»¥ HTML å’Œ CSS è‚¯å®šä¼šé˜»å¡æ¸²æŸ“ã€‚å¦‚æœä½ æƒ³æ¸²æŸ“çš„è¶Šå¿«ï¼Œä½ è¶Šåº”è¯¥é™ä½ä¸€å¼€å§‹éœ€è¦æ¸²æŸ“çš„æ–‡ä»¶å¤§å°ï¼Œå¹¶ä¸”æ‰å¹³å±‚çº§ï¼Œä¼˜åŒ–é€‰æ‹©å™¨ã€‚ç„¶åå½“æµè§ˆå™¨åœ¨è§£æåˆ° script æ ‡ç­¾æ—¶ï¼Œä¼šæš‚åœæ„å»º DOMï¼Œå®Œæˆåæ‰ä¼šä»æš‚åœçš„åœ°æ–¹é‡æ–°å¼€å§‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä½ æƒ³é¦–å±æ¸²æŸ“çš„è¶Šå¿«ï¼Œå°±è¶Šä¸åº”è¯¥åœ¨é¦–å±å°±åŠ è½½ JS æ–‡ä»¶ï¼Œè¿™ä¹Ÿæ˜¯éƒ½å»ºè®®å°† script æ ‡ç­¾æ”¾åœ¨ body æ ‡ç­¾åº•éƒ¨çš„åŸå› ã€‚</p><p>å½“ç„¶åœ¨å½“ä¸‹ï¼Œå¹¶ä¸æ˜¯è¯´ script æ ‡ç­¾å¿…é¡»æ”¾åœ¨åº•éƒ¨ï¼Œå› ä¸ºä½ å¯ä»¥ç»™ script æ ‡ç­¾æ·»åŠ  defer æˆ–è€… async å±æ€§ã€‚å½“ script æ ‡ç­¾åŠ ä¸Š defer å±æ€§ä»¥åï¼Œè¡¨ç¤ºè¯¥ JS æ–‡ä»¶ä¼šå¹¶è¡Œä¸‹è½½ï¼Œä½†æ˜¯ä¼šæ”¾åˆ° HTML è§£æå®Œæˆåé¡ºåºæ‰§è¡Œï¼Œæ‰€ä»¥å¯¹äºè¿™ç§æƒ…å†µä½ å¯ä»¥æŠŠ script æ ‡ç­¾æ”¾åœ¨ä»»æ„ä½ç½®ã€‚å¯¹äºæ²¡æœ‰ä»»ä½•ä¾èµ–çš„ JS æ–‡ä»¶å¯ä»¥åŠ ä¸Š async å±æ€§ï¼Œè¡¨ç¤º JS æ–‡ä»¶ä¸‹è½½å’Œè§£æä¸ä¼šé˜»å¡æ¸²æŸ“ã€‚</p><h2 id="å…­ã€æµè§ˆå™¨æœ¬åœ°å­˜å‚¨"><a href="#å…­ã€æµè§ˆå™¨æœ¬åœ°å­˜å‚¨" class="headerlink" title="å…­ã€æµè§ˆå™¨æœ¬åœ°å­˜å‚¨"></a>å…­ã€æµè§ˆå™¨æœ¬åœ°å­˜å‚¨</h2><h3 id="1-æµè§ˆå™¨æœ¬åœ°å­˜å‚¨æ–¹å¼åŠä½¿ç”¨åœºæ™¯"><a href="#1-æµè§ˆå™¨æœ¬åœ°å­˜å‚¨æ–¹å¼åŠä½¿ç”¨åœºæ™¯" class="headerlink" title="1. æµè§ˆå™¨æœ¬åœ°å­˜å‚¨æ–¹å¼åŠä½¿ç”¨åœºæ™¯"></a>1. æµè§ˆå™¨æœ¬åœ°å­˜å‚¨æ–¹å¼åŠä½¿ç”¨åœºæ™¯</h3><h4 id="ï¼ˆ1ï¼‰Cookie"><a href="#ï¼ˆ1ï¼‰Cookie" class="headerlink" title="ï¼ˆ1ï¼‰Cookie"></a>ï¼ˆ1ï¼‰Cookie</h4><p>Cookieæ˜¯æœ€æ—©è¢«æå‡ºæ¥çš„æœ¬åœ°å­˜å‚¨æ–¹å¼ï¼Œåœ¨æ­¤ä¹‹å‰ï¼ŒæœåŠ¡ç«¯æ˜¯æ— æ³•åˆ¤æ–­ç½‘ç»œä¸­çš„ä¸¤ä¸ªè¯·æ±‚æ˜¯å¦æ˜¯åŒä¸€ç”¨æˆ·å‘èµ·çš„ï¼Œä¸ºè§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒCookieå°±å‡ºç°äº†ã€‚Cookieçš„å¤§å°åªæœ‰4kbï¼Œå®ƒæ˜¯ä¸€ç§çº¯æ–‡æœ¬æ–‡ä»¶ï¼Œæ¯æ¬¡å‘èµ·HTTPè¯·æ±‚éƒ½ä¼šæºå¸¦Cookieã€‚</p><p><strong>Cookieçš„ç‰¹æ€§ï¼š</strong></p><ul><li>Cookieä¸€æ—¦åˆ›å»ºæˆåŠŸï¼Œåç§°å°±æ— æ³•ä¿®æ”¹</li><li>Cookieæ˜¯æ— æ³•è·¨åŸŸåçš„ï¼Œä¹Ÿå°±æ˜¯è¯´aåŸŸåå’ŒbåŸŸåä¸‹çš„cookieæ˜¯æ— æ³•å…±äº«çš„ï¼Œè¿™ä¹Ÿæ˜¯ç”±Cookieçš„éšç§å®‰å…¨æ€§å†³å®šçš„ï¼Œè¿™æ ·å°±èƒ½å¤Ÿé˜»æ­¢éæ³•è·å–å…¶ä»–ç½‘ç«™çš„Cookie</li><li>æ¯ä¸ªåŸŸåä¸‹Cookieçš„æ•°é‡ä¸èƒ½è¶…è¿‡20ä¸ªï¼Œæ¯ä¸ªCookieçš„å¤§å°ä¸èƒ½è¶…è¿‡4kb</li><li>æœ‰å®‰å…¨é—®é¢˜ï¼Œå¦‚æœCookieè¢«æ‹¦æˆªäº†ï¼Œé‚£å°±å¯è·å¾—sessionçš„æ‰€æœ‰ä¿¡æ¯ï¼Œå³ä½¿åŠ å¯†ä¹Ÿäºäº‹æ— è¡¥ï¼Œæ— éœ€çŸ¥é“cookieçš„æ„ä¹‰ï¼Œåªè¦è½¬å‘cookieå°±èƒ½è¾¾åˆ°ç›®çš„</li><li>Cookieåœ¨è¯·æ±‚ä¸€ä¸ªæ–°çš„é¡µé¢çš„æ—¶å€™éƒ½ä¼šè¢«å‘é€è¿‡å»</li></ul><p>å¦‚æœéœ€è¦åŸŸåä¹‹é—´è·¨åŸŸå…±äº«Cookieï¼Œæœ‰ä¸¤ç§æ–¹æ³•ï¼š</p><ol><li>ä½¿ç”¨Nginxåå‘ä»£ç†</li><li>åœ¨ä¸€ä¸ªç«™ç‚¹ç™»é™†ä¹‹åï¼Œå¾€å…¶ä»–ç½‘ç«™å†™Cookieã€‚æœåŠ¡ç«¯çš„Sessionå­˜å‚¨åˆ°ä¸€ä¸ªèŠ‚ç‚¹ï¼ŒCookieå­˜å‚¨sessionId</li></ol><p><strong>Cookieçš„ä½¿ç”¨åœºæ™¯ï¼š</strong></p><ul><li>æœ€å¸¸è§çš„ä½¿ç”¨åœºæ™¯å°±æ˜¯Cookieå’Œsessionç»“åˆä½¿ç”¨ï¼Œæˆ‘ä»¬å°†sessionIdå­˜å‚¨åˆ°Cookieä¸­ï¼Œæ¯æ¬¡å‘è¯·æ±‚éƒ½ä¼šæºå¸¦è¿™ä¸ªsessionIdï¼Œè¿™æ ·æœåŠ¡ç«¯å°±çŸ¥é“æ˜¯è°å‘èµ·çš„è¯·æ±‚ï¼Œä»è€Œå“åº”ç›¸åº”çš„ä¿¡æ¯ã€‚</li><li>å¯ä»¥ç”¨æ¥ç»Ÿè®¡é¡µé¢çš„ç‚¹å‡»æ¬¡æ•°</li></ul><h4 id="ï¼ˆ2ï¼‰LocalStorage"><a href="#ï¼ˆ2ï¼‰LocalStorage" class="headerlink" title="ï¼ˆ2ï¼‰LocalStorage"></a>ï¼ˆ2ï¼‰LocalStorage</h4><p>LocalStorageæ˜¯HTML5æ–°å¼•å…¥çš„ç‰¹æ€§ï¼Œç”±äºæœ‰çš„æ—¶å€™æˆ‘ä»¬å­˜å‚¨çš„ä¿¡æ¯è¾ƒå¤§ï¼ŒCookieå°±ä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ï¼Œè¿™æ—¶å€™LocalStorageå°±æ´¾ä¸Šç”¨åœºäº†ã€‚</p><p><strong>LocalStorageçš„ä¼˜ç‚¹ï¼š</strong></p><ul><li>åœ¨å¤§å°æ–¹é¢ï¼ŒLocalStorageçš„å¤§å°ä¸€èˆ¬ä¸º5MBï¼Œå¯ä»¥å‚¨å­˜æ›´å¤šçš„ä¿¡æ¯</li><li>LocalStorageæ˜¯æŒä¹…å‚¨å­˜ï¼Œå¹¶ä¸ä¼šéšç€é¡µé¢çš„å…³é—­è€Œæ¶ˆå¤±ï¼Œé™¤éä¸»åŠ¨æ¸…ç†ï¼Œä¸ç„¶ä¼šæ°¸ä¹…å­˜åœ¨</li><li>ä»…å‚¨å­˜åœ¨æœ¬åœ°ï¼Œä¸åƒCookieé‚£æ ·æ¯æ¬¡HTTPè¯·æ±‚éƒ½ä¼šè¢«æºå¸¦</li></ul><p><strong>LocalStorageçš„ç¼ºç‚¹ï¼š</strong></p><ul><li>å­˜åœ¨æµè§ˆå™¨å…¼å®¹é—®é¢˜ï¼ŒIE8ä»¥ä¸‹ç‰ˆæœ¬çš„æµè§ˆå™¨ä¸æ”¯æŒ</li><li>å¦‚æœæµè§ˆå™¨è®¾ç½®ä¸ºéšç§æ¨¡å¼ï¼Œé‚£æˆ‘ä»¬å°†æ— æ³•è¯»å–åˆ°LocalStorage</li><li>LocalStorageå—åˆ°åŒæºç­–ç•¥çš„é™åˆ¶ï¼Œå³ç«¯å£ã€åè®®ã€ä¸»æœºåœ°å€æœ‰ä»»ä½•ä¸€ä¸ªä¸ç›¸åŒï¼Œéƒ½ä¸ä¼šè®¿é—®</li></ul><p><strong>LocalStorageçš„å¸¸ç”¨APIï¼š</strong></p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// ä¿å­˜æ•°æ®åˆ° localStorage</span>localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'key'</span><span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// ä» localStorage è·å–æ•°æ®</span><span class="token keyword">let</span> data <span class="token operator">=</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'key'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// ä» localStorage åˆ é™¤ä¿å­˜çš„æ•°æ®</span>localStorage<span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span><span class="token string">'key'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// ä» localStorage åˆ é™¤æ‰€æœ‰ä¿å­˜çš„æ•°æ®</span>localStorage<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// è·å–æŸä¸ªç´¢å¼•çš„Key</span>localStorage<span class="token punctuation">.</span><span class="token function">key</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>LocalStorageçš„ä½¿ç”¨åœºæ™¯ï¼š</strong></p><ul><li>æœ‰äº›ç½‘ç«™æœ‰æ¢è‚¤çš„åŠŸèƒ½ï¼Œè¿™æ—¶å€™å°±å¯ä»¥å°†æ¢è‚¤çš„ä¿¡æ¯å­˜å‚¨åœ¨æœ¬åœ°çš„LocalStorageä¸­ï¼Œå½“éœ€è¦æ¢è‚¤çš„æ—¶å€™ï¼Œç›´æ¥æ“ä½œLocalStorageå³å¯</li><li>åœ¨ç½‘ç«™ä¸­çš„ç”¨æˆ·æµè§ˆä¿¡æ¯ä¹Ÿä¼šå­˜å‚¨åœ¨LocalStorageä¸­ï¼Œè¿˜æœ‰ç½‘ç«™çš„ä¸€äº›ä¸å¸¸å˜åŠ¨çš„ä¸ªäººä¿¡æ¯ç­‰ä¹Ÿå¯ä»¥å­˜å‚¨åœ¨æœ¬åœ°çš„LocalStorageä¸­</li></ul><h4 id="ï¼ˆ3ï¼‰SessionStorage"><a href="#ï¼ˆ3ï¼‰SessionStorage" class="headerlink" title="ï¼ˆ3ï¼‰SessionStorage"></a>ï¼ˆ3ï¼‰SessionStorage</h4><p>SessionStorageå’ŒLocalStorageéƒ½æ˜¯åœ¨HTML5æ‰æå‡ºæ¥çš„å­˜å‚¨æ–¹æ¡ˆï¼ŒSessionStorage ä¸»è¦ç”¨äºä¸´æ—¶ä¿å­˜åŒä¸€çª—å£(æˆ–æ ‡ç­¾é¡µ)çš„æ•°æ®ï¼Œåˆ·æ–°é¡µé¢æ—¶ä¸ä¼šåˆ é™¤ï¼Œå…³é—­çª—å£æˆ–æ ‡ç­¾é¡µä¹‹åå°†ä¼šåˆ é™¤è¿™äº›æ•°æ®ã€‚</p><p><strong>SessionStorageä¸LocalStorageå¯¹æ¯”ï¼š</strong></p><ul><li>SessionStorageå’ŒLocalStorageéƒ½åœ¨<strong>æœ¬åœ°è¿›è¡Œæ•°æ®å­˜å‚¨</strong>ï¼›</li><li>SessionStorageä¹Ÿæœ‰åŒæºç­–ç•¥çš„é™åˆ¶ï¼Œä½†æ˜¯SessionStorageæœ‰ä¸€æ¡æ›´åŠ ä¸¥æ ¼çš„é™åˆ¶ï¼ŒSessionStorage<strong>åªæœ‰åœ¨åŒä¸€æµè§ˆå™¨çš„åŒä¸€çª—å£ä¸‹æ‰èƒ½å¤Ÿå…±äº«</strong>ï¼›</li><li>LocalStorageå’ŒSessionStorage<strong>éƒ½ä¸èƒ½è¢«çˆ¬è™«çˆ¬å–</strong>ï¼›</li></ul><p><strong>SessionStorageçš„å¸¸ç”¨APIï¼š</strong></p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// ä¿å­˜æ•°æ®åˆ° sessionStorage</span>sessionStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">'key'</span><span class="token punctuation">,</span> <span class="token string">'value'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// ä» sessionStorage è·å–æ•°æ®</span><span class="token keyword">let</span> data <span class="token operator">=</span> sessionStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">'key'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// ä» sessionStorage åˆ é™¤ä¿å­˜çš„æ•°æ®</span>sessionStorage<span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span><span class="token string">'key'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// ä» sessionStorage åˆ é™¤æ‰€æœ‰ä¿å­˜çš„æ•°æ®</span>sessionStorage<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// è·å–æŸä¸ªç´¢å¼•çš„Key</span>sessionStorage<span class="token punctuation">.</span><span class="token function">key</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>SessionStorageçš„ä½¿ç”¨åœºæ™¯</strong></p><ul><li>ç”±äºSessionStorageå…·æœ‰æ—¶æ•ˆæ€§ï¼Œæ‰€ä»¥å¯ä»¥ç”¨æ¥å­˜å‚¨ä¸€äº›ç½‘ç«™çš„æ¸¸å®¢ç™»å½•çš„ä¿¡æ¯ï¼Œè¿˜æœ‰ä¸´æ—¶çš„æµè§ˆè®°å½•çš„ä¿¡æ¯ã€‚å½“å…³é—­ç½‘ç«™ä¹‹åï¼Œè¿™äº›ä¿¡æ¯ä¹Ÿå°±éšä¹‹æ¶ˆé™¤äº†ã€‚</li></ul><h3 id="2-Cookieæœ‰å“ªäº›å­—æ®µï¼Œä½œç”¨åˆ†åˆ«æ˜¯ä»€ä¹ˆ"><a href="#2-Cookieæœ‰å“ªäº›å­—æ®µï¼Œä½œç”¨åˆ†åˆ«æ˜¯ä»€ä¹ˆ" class="headerlink" title="2. Cookieæœ‰å“ªäº›å­—æ®µï¼Œä½œç”¨åˆ†åˆ«æ˜¯ä»€ä¹ˆ"></a>2. Cookieæœ‰å“ªäº›å­—æ®µï¼Œä½œç”¨åˆ†åˆ«æ˜¯ä»€ä¹ˆ</h3><p><strong>Cookieç”±ä»¥ä¸‹å­—æ®µç»„æˆï¼š</strong></p><ul><li><strong>Name</strong>ï¼šcookieçš„åç§°</li><li><strong>Value</strong>ï¼šcookieçš„å€¼ï¼Œå¯¹äºè®¤è¯cookieï¼Œvalueå€¼åŒ…æ‹¬webæœåŠ¡å™¨æ‰€æä¾›çš„è®¿é—®ä»¤ç‰Œï¼›</li><li><strong>Size</strong>ï¼š cookieçš„å¤§å°</li><li><strong>Path</strong>ï¼šå¯ä»¥è®¿é—®æ­¤cookieçš„é¡µé¢è·¯å¾„ã€‚ æ¯”å¦‚domainæ˜¯abc.comï¼Œpathæ˜¯<code>/test</code>ï¼Œé‚£ä¹ˆåªæœ‰<code>/test</code>è·¯å¾„ä¸‹çš„é¡µé¢å¯ä»¥è¯»å–æ­¤cookieã€‚</li><li><strong>Secure</strong>ï¼š æŒ‡å®šæ˜¯å¦ä½¿ç”¨HTTPSå®‰å…¨åè®®å‘é€Cookieã€‚ä½¿ç”¨HTTPSå®‰å…¨åè®®ï¼Œå¯ä»¥ä¿æŠ¤Cookieåœ¨æµè§ˆå™¨å’ŒWebæœåŠ¡å™¨é—´çš„ä¼ è¾“è¿‡ç¨‹ä¸­ä¸è¢«çªƒå–å’Œç¯¡æ”¹ã€‚è¯¥æ–¹æ³•ä¹Ÿå¯ç”¨äºWebç«™ç‚¹çš„èº«ä»½é‰´åˆ«ï¼Œå³åœ¨HTTPSçš„è¿æ¥å»ºç«‹é˜¶æ®µï¼Œæµè§ˆå™¨ä¼šæ£€æŸ¥Webç½‘ç«™çš„SSLè¯ä¹¦çš„æœ‰æ•ˆæ€§ã€‚ä½†æ˜¯åŸºäºå…¼å®¹æ€§çš„åŸå› ï¼ˆæ¯”å¦‚æœ‰äº›ç½‘ç«™ä½¿ç”¨è‡ªç­¾ç½²çš„è¯ä¹¦ï¼‰åœ¨æ£€æµ‹åˆ°SSLè¯ä¹¦æ— æ•ˆæ—¶ï¼Œæµè§ˆå™¨å¹¶ä¸ä¼šç«‹å³ç»ˆæ­¢ç”¨æˆ·çš„è¿æ¥è¯·æ±‚ï¼Œè€Œæ˜¯æ˜¾ç¤ºå®‰å…¨é£é™©ä¿¡æ¯ï¼Œç”¨æˆ·ä»å¯ä»¥é€‰æ‹©ç»§ç»­è®¿é—®è¯¥ç«™ç‚¹ã€‚</li><li><strong>Domain</strong>ï¼šå¯ä»¥è®¿é—®è¯¥cookieçš„åŸŸåï¼ŒCookie æœºåˆ¶å¹¶æœªéµå¾ªä¸¥æ ¼çš„åŒæºç­–ç•¥ï¼Œå…è®¸ä¸€ä¸ªå­åŸŸå¯ä»¥è®¾ç½®æˆ–è·å–å…¶çˆ¶åŸŸçš„ Cookieã€‚å½“éœ€è¦å®ç°å•ç‚¹ç™»å½•æ–¹æ¡ˆæ—¶ï¼ŒCookie çš„ä¸Šè¿°ç‰¹æ€§éå¸¸æœ‰ç”¨ï¼Œç„¶è€Œä¹Ÿå¢åŠ äº† Cookieå—æ”»å‡»çš„å±é™©ï¼Œæ¯”å¦‚æ”»å‡»è€…å¯ä»¥å€Ÿæ­¤å‘åŠ¨ä¼šè¯å®šç½®æ”»å‡»ã€‚å› è€Œï¼Œæµè§ˆå™¨ç¦æ­¢åœ¨ Domain å±æ€§ä¸­è®¾ç½®.orgã€.com ç­‰é€šç”¨é¡¶çº§åŸŸåã€ä»¥åŠåœ¨å›½å®¶åŠåœ°åŒºé¡¶çº§åŸŸä¸‹æ³¨å†Œçš„äºŒçº§åŸŸåï¼Œä»¥å‡å°æ”»å‡»å‘ç”Ÿçš„èŒƒå›´ã€‚</li><li><strong>HTTP</strong>ï¼š è¯¥å­—æ®µåŒ…å«<code>HTTPOnly</code> å±æ€§ ï¼Œè¯¥å±æ€§ç”¨æ¥è®¾ç½®cookieèƒ½å¦é€šè¿‡è„šæœ¬æ¥è®¿é—®ï¼Œé»˜è®¤ä¸ºç©ºï¼Œå³å¯ä»¥é€šè¿‡è„šæœ¬è®¿é—®ã€‚åœ¨å®¢æˆ·ç«¯æ˜¯ä¸èƒ½é€šè¿‡jsä»£ç å»è®¾ç½®ä¸€ä¸ªhttpOnlyç±»å‹çš„cookieçš„ï¼Œè¿™ç§ç±»å‹çš„cookieåªèƒ½é€šè¿‡æœåŠ¡ç«¯æ¥è®¾ç½®ã€‚è¯¥å±æ€§ç”¨äºé˜²æ­¢å®¢æˆ·ç«¯è„šæœ¬é€šè¿‡<code>document.cookie</code>å±æ€§è®¿é—®Cookieï¼Œæœ‰åŠ©äºä¿æŠ¤Cookieä¸è¢«è·¨ç«™è„šæœ¬æ”»å‡»çªƒå–æˆ–ç¯¡æ”¹ã€‚ä½†æ˜¯ï¼ŒHTTPOnlyçš„åº”ç”¨ä»å­˜åœ¨å±€é™æ€§ï¼Œä¸€äº›æµè§ˆå™¨å¯ä»¥é˜»æ­¢å®¢æˆ·ç«¯è„šæœ¬å¯¹Cookieçš„è¯»æ“ä½œï¼Œä½†å…è®¸å†™æ“ä½œï¼›æ­¤å¤–å¤§å¤šæ•°æµè§ˆå™¨ä»å…è®¸é€šè¿‡XMLHTTPå¯¹è±¡è¯»å–HTTPå“åº”ä¸­çš„Set-Cookieå¤´ã€‚</li><li><strong>Expires/Max-size</strong> ï¼š æ­¤cookieçš„è¶…æ—¶æ—¶é—´ã€‚è‹¥è®¾ç½®å…¶å€¼ä¸ºä¸€ä¸ªæ—¶é—´ï¼Œé‚£ä¹ˆå½“åˆ°è¾¾æ­¤æ—¶é—´åï¼Œæ­¤cookieå¤±æ•ˆã€‚ä¸è®¾ç½®çš„è¯é»˜è®¤å€¼æ˜¯Sessionï¼Œæ„æ€æ˜¯cookieä¼šå’Œsessionä¸€èµ·å¤±æ•ˆã€‚å½“æµè§ˆå™¨å…³é—­(ä¸æ˜¯æµè§ˆå™¨æ ‡ç­¾é¡µï¼Œè€Œæ˜¯æ•´ä¸ªæµè§ˆå™¨) åï¼Œæ­¤cookieå¤±æ•ˆã€‚</li></ul><p><strong>æ€»ç»“ï¼š</strong><br>æœåŠ¡å™¨ç«¯å¯ä»¥ä½¿ç”¨ Set-Cookie çš„å“åº”å¤´éƒ¨æ¥é…ç½® cookie ä¿¡æ¯ã€‚ä¸€æ¡cookie åŒ…æ‹¬äº†5ä¸ªå±æ€§å€¼ expiresã€domainã€pathã€secureã€HttpOnlyã€‚å…¶ä¸­ expires æŒ‡å®šäº† cookie å¤±æ•ˆçš„æ—¶é—´ï¼Œdomain æ˜¯åŸŸåã€pathæ˜¯è·¯å¾„ï¼Œdomain å’Œ path ä¸€èµ·é™åˆ¶äº† cookie èƒ½å¤Ÿè¢«å“ªäº› url è®¿é—®ã€‚secure è§„å®šäº† cookie åªèƒ½åœ¨ç¡®ä¿å®‰å…¨çš„æƒ…å†µä¸‹ä¼ è¾“ï¼ŒHttpOnly è§„å®šäº†è¿™ä¸ª cookie åªèƒ½è¢«æœåŠ¡å™¨è®¿é—®ï¼Œä¸èƒ½ä½¿ç”¨ js è„šæœ¬è®¿é—®ã€‚</p><h3 id="3-Cookieã€LocalStorageã€SessionStorageåŒºåˆ«"><a href="#3-Cookieã€LocalStorageã€SessionStorageåŒºåˆ«" class="headerlink" title="3. Cookieã€LocalStorageã€SessionStorageåŒºåˆ«"></a>3. Cookieã€LocalStorageã€SessionStorageåŒºåˆ«</h3><p>æµè§ˆå™¨ç«¯å¸¸ç”¨çš„å­˜å‚¨æŠ€æœ¯æ˜¯ cookie ã€localStorage å’Œ sessionStorageã€‚</p><ul><li><strong>cookieï¼š</strong> å…¶å®æœ€å¼€å§‹æ˜¯æœåŠ¡å™¨ç«¯ç”¨äºè®°å½•ç”¨æˆ·çŠ¶æ€çš„ä¸€ç§æ–¹å¼ï¼Œç”±æœåŠ¡å™¨è®¾ç½®ï¼Œåœ¨å®¢æˆ·ç«¯å­˜å‚¨ï¼Œç„¶åæ¯æ¬¡å‘èµ·åŒæºè¯·æ±‚æ—¶ï¼Œå‘é€ç»™æœåŠ¡å™¨ç«¯ã€‚cookie æœ€å¤šèƒ½å­˜å‚¨ 4 k æ•°æ®ï¼Œå®ƒçš„ç”Ÿå­˜æ—¶é—´ç”± expires å±æ€§æŒ‡å®šï¼Œå¹¶ä¸” cookie åªèƒ½è¢«åŒæºçš„é¡µé¢è®¿é—®å…±äº«ã€‚</li><li><strong>sessionStorageï¼š</strong> html5 æä¾›çš„ä¸€ç§æµè§ˆå™¨æœ¬åœ°å­˜å‚¨çš„æ–¹æ³•ï¼Œå®ƒå€Ÿé‰´äº†æœåŠ¡å™¨ç«¯ session çš„æ¦‚å¿µï¼Œä»£è¡¨çš„æ˜¯ä¸€æ¬¡ä¼šè¯ä¸­æ‰€ä¿å­˜çš„æ•°æ®ã€‚å®ƒä¸€èˆ¬èƒ½å¤Ÿå­˜å‚¨ 5M æˆ–è€…æ›´å¤§çš„æ•°æ®ï¼Œå®ƒåœ¨å½“å‰çª—å£å…³é—­åå°±å¤±æ•ˆäº†ï¼Œå¹¶ä¸” sessionStorage åªèƒ½è¢«åŒä¸€ä¸ªçª—å£çš„åŒæºé¡µé¢æ‰€è®¿é—®å…±äº«ã€‚</li><li><strong>localStorageï¼š</strong> html5 æä¾›çš„ä¸€ç§æµè§ˆå™¨æœ¬åœ°å­˜å‚¨çš„æ–¹æ³•ï¼Œå®ƒä¸€èˆ¬ä¹Ÿèƒ½å¤Ÿå­˜å‚¨ 5M æˆ–è€…æ›´å¤§çš„æ•°æ®ã€‚å®ƒå’Œ sessionStorage ä¸åŒçš„æ˜¯ï¼Œé™¤éæ‰‹åŠ¨åˆ é™¤å®ƒï¼Œå¦åˆ™å®ƒä¸ä¼šå¤±æ•ˆï¼Œå¹¶ä¸” localStorage ä¹Ÿåªèƒ½è¢«åŒæºé¡µé¢æ‰€è®¿é—®å…±äº«ã€‚</li></ul><p>ä¸Šé¢å‡ ç§æ–¹å¼éƒ½æ˜¯å­˜å‚¨å°‘é‡æ•°æ®çš„æ—¶å€™çš„å­˜å‚¨æ–¹å¼ï¼Œå½“éœ€è¦åœ¨æœ¬åœ°å­˜å‚¨å¤§é‡æ•°æ®çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æµè§ˆå™¨çš„ indexDB è¿™æ˜¯æµè§ˆå™¨æä¾›çš„ä¸€ç§æœ¬åœ°çš„æ•°æ®åº“å­˜å‚¨æœºåˆ¶ã€‚å®ƒä¸æ˜¯å…³ç³»å‹æ•°æ®åº“ï¼Œå®ƒå†…éƒ¨é‡‡ç”¨å¯¹è±¡ä»“åº“çš„å½¢å¼å­˜å‚¨æ•°æ®ï¼Œå®ƒæ›´æ¥è¿‘ NoSQL æ•°æ®åº“ã€‚</p><h3 id="4-å‰ç«¯å‚¨å­˜çš„â½…å¼æœ‰å“ªäº›ï¼Ÿ"><a href="#4-å‰ç«¯å‚¨å­˜çš„â½…å¼æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="4. å‰ç«¯å‚¨å­˜çš„â½…å¼æœ‰å“ªäº›ï¼Ÿ"></a>4. å‰ç«¯å‚¨å­˜çš„â½…å¼æœ‰å“ªäº›ï¼Ÿ</h3><ul><li>cookiesï¼š åœ¨HTML5æ ‡å‡†å‰æœ¬åœ°å‚¨å­˜çš„ä¸»è¦â½…å¼ï¼Œä¼˜ç‚¹æ˜¯å…¼å®¹æ€§å¥½ï¼Œè¯·æ±‚å¤´â¾ƒå¸¦cookieâ½…ä¾¿ï¼Œç¼ºç‚¹æ˜¯â¼¤â¼©åªæœ‰4kï¼Œâ¾ƒåŠ¨è¯·æ±‚å¤´åŠ â¼Šcookieæµªè´¹æµé‡ï¼Œæ¯ä¸ªdomainé™åˆ¶20ä¸ªcookieï¼Œä½¿â½¤èµ·æ¥éº»çƒ¦ï¼Œéœ€è¦â¾ƒâ¾å°è£…ï¼›</li><li>localStorageï¼šHTML5åŠ â¼Šçš„ä»¥é”®å€¼å¯¹(Key-Value)ä¸ºæ ‡å‡†çš„â½…å¼ï¼Œä¼˜ç‚¹æ˜¯æ“ä½œâ½…ä¾¿ï¼Œæ°¸ä¹…æ€§å‚¨å­˜ï¼ˆé™¤â¾®â¼¿åŠ¨åˆ é™¤ï¼‰ï¼Œâ¼¤â¼©ä¸º5Mï¼Œå…¼å®¹IE8+ ï¼›</li><li>sessionStorageï¼šä¸localStorageåŸºæœ¬ç±»ä¼¼ï¼ŒåŒºåˆ«æ˜¯sessionStorageå½“â»šâ¾¯å…³é—­åä¼šè¢«æ¸…ç†ï¼Œâ½½ä¸”ä¸cookieã€localStorageä¸åŒï¼Œä»–ä¸èƒ½åœ¨æ‰€æœ‰åŒæºçª—â¼ä¸­å…±äº«ï¼Œæ˜¯ä¼šè¯çº§åˆ«çš„å‚¨å­˜â½…å¼ï¼› </li><li>Web SQLï¼š2010å¹´è¢«W3CåºŸå¼ƒçš„æœ¬åœ°æ•°æ®åº“æ•°æ®å­˜å‚¨â½…æ¡ˆï¼Œä½†æ˜¯ä¸»æµæµè§ˆå™¨ï¼ˆâ½•ç‹é™¤å¤–ï¼‰éƒ½å·²ç»æœ‰äº†ç›¸å…³çš„å®ç°ï¼Œweb sqlç±»ä¼¼äºSQLiteï¼Œæ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„å…³ç³»å‹æ•°æ®åº“ï¼Œâ½¤sqlè¿›â¾æ“ä½œï¼Œå½“æˆ‘ä»¬â½¤JavaScriptæ—¶è¦è¿›â¾è½¬æ¢ï¼Œè¾ƒä¸ºç¹çï¼› </li><li>IndexedDBï¼š æ˜¯è¢«æ­£å¼çº³â¼ŠHTML5æ ‡å‡†çš„æ•°æ®åº“å‚¨å­˜â½…æ¡ˆï¼Œå®ƒæ˜¯NoSQLæ•°æ®åº“ï¼Œâ½¤é”®å€¼å¯¹è¿›â¾å‚¨å­˜ï¼Œå¯ä»¥è¿›â¾å¿«é€Ÿè¯»å–æ“ä½œï¼Œâ¾®å¸¸é€‚åˆwebåœºæ™¯ï¼ŒåŒæ—¶â½¤JavaScriptè¿›â¾æ“ä½œä¼šâ¾®å¸¸ä¾¿ã€‚ </li></ul><h3 id="5-IndexedDBæœ‰å“ªäº›ç‰¹ç‚¹ï¼Ÿ"><a href="#5-IndexedDBæœ‰å“ªäº›ç‰¹ç‚¹ï¼Ÿ" class="headerlink" title="5. IndexedDBæœ‰å“ªäº›ç‰¹ç‚¹ï¼Ÿ"></a>5. IndexedDBæœ‰å“ªäº›ç‰¹ç‚¹ï¼Ÿ</h3><p>IndexedDB å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š</p><ul><li><strong>é”®å€¼å¯¹å‚¨å­˜</strong>ï¼šIndexedDB å†…éƒ¨é‡‡ç”¨å¯¹è±¡ä»“åº“ï¼ˆobject storeï¼‰å­˜æ”¾æ•°æ®ã€‚æ‰€æœ‰ç±»å‹çš„æ•°æ®éƒ½å¯ä»¥ç›´æ¥å­˜å…¥ï¼ŒåŒ…æ‹¬ JavaScript å¯¹è±¡ã€‚å¯¹è±¡ä»“åº“ä¸­ï¼Œæ•°æ®ä»¥â€é”®å€¼å¯¹â€çš„å½¢å¼ä¿å­˜ï¼Œæ¯ä¸€ä¸ªæ•°æ®è®°å½•éƒ½æœ‰å¯¹åº”çš„ä¸»é”®ï¼Œä¸»é”®æ˜¯ç‹¬ä¸€æ— äºŒçš„ï¼Œä¸èƒ½æœ‰é‡å¤ï¼Œå¦åˆ™ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚</li><li><strong>å¼‚æ­¥</strong>ï¼šIndexedDB æ“ä½œæ—¶ä¸ä¼šé”æ­»æµè§ˆå™¨ï¼Œç”¨æˆ·ä¾ç„¶å¯ä»¥è¿›è¡Œå…¶ä»–æ“ä½œï¼Œè¿™ä¸ LocalStorage å½¢æˆå¯¹æ¯”ï¼Œåè€…çš„æ“ä½œæ˜¯åŒæ­¥çš„ã€‚å¼‚æ­¥è®¾è®¡æ˜¯ä¸ºäº†é˜²æ­¢å¤§é‡æ•°æ®çš„è¯»å†™ï¼Œæ‹–æ…¢ç½‘é¡µçš„è¡¨ç°ã€‚</li><li><strong>æ”¯æŒäº‹åŠ¡</strong>ï¼šIndexedDB æ”¯æŒäº‹åŠ¡ï¼ˆtransactionï¼‰ï¼Œè¿™æ„å‘³ç€ä¸€ç³»åˆ—æ“ä½œæ­¥éª¤ä¹‹ä¸­ï¼Œåªè¦æœ‰ä¸€æ­¥å¤±è´¥ï¼Œæ•´ä¸ªäº‹åŠ¡å°±éƒ½å–æ¶ˆï¼Œæ•°æ®åº“å›æ»šåˆ°äº‹åŠ¡å‘ç”Ÿä¹‹å‰çš„çŠ¶æ€ï¼Œä¸å­˜åœ¨åªæ”¹å†™ä¸€éƒ¨åˆ†æ•°æ®çš„æƒ…å†µã€‚</li><li><strong>åŒæºé™åˆ¶ï¼š</strong> IndexedDB å—åˆ°åŒæºé™åˆ¶ï¼Œæ¯ä¸€ä¸ªæ•°æ®åº“å¯¹åº”åˆ›å»ºå®ƒçš„åŸŸåã€‚ç½‘é¡µåªèƒ½è®¿é—®è‡ªèº«åŸŸåä¸‹çš„æ•°æ®åº“ï¼Œè€Œä¸èƒ½è®¿é—®è·¨åŸŸçš„æ•°æ®åº“ã€‚</li><li><strong>å‚¨å­˜ç©ºé—´å¤§</strong>ï¼šIndexedDB çš„å‚¨å­˜ç©ºé—´æ¯” LocalStorage å¤§å¾—å¤šï¼Œä¸€èˆ¬æ¥è¯´ä¸å°‘äº 250MBï¼Œç”šè‡³æ²¡æœ‰ä¸Šé™ã€‚</li><li><strong>æ”¯æŒäºŒè¿›åˆ¶å‚¨å­˜</strong>ï¼šIndexedDB ä¸ä»…å¯ä»¥å‚¨å­˜å­—ç¬¦ä¸²ï¼Œè¿˜å¯ä»¥å‚¨å­˜äºŒè¿›åˆ¶æ•°æ®ï¼ˆArrayBuffer å¯¹è±¡å’Œ Blob å¯¹è±¡ï¼‰ã€‚</li></ul><h2 id="ä¸ƒã€æµè§ˆå™¨åŒæºç­–ç•¥"><a href="#ä¸ƒã€æµè§ˆå™¨åŒæºç­–ç•¥" class="headerlink" title="ä¸ƒã€æµè§ˆå™¨åŒæºç­–ç•¥"></a>ä¸ƒã€æµè§ˆå™¨åŒæºç­–ç•¥</h2><h3 id="1-ä»€ä¹ˆæ˜¯åŒæºç­–ç•¥"><a href="#1-ä»€ä¹ˆæ˜¯åŒæºç­–ç•¥" class="headerlink" title="1. ä»€ä¹ˆæ˜¯åŒæºç­–ç•¥"></a>1. ä»€ä¹ˆæ˜¯åŒæºç­–ç•¥</h3><p>è·¨åŸŸé—®é¢˜å…¶å®å°±æ˜¯æµè§ˆå™¨çš„åŒæºç­–ç•¥é€ æˆçš„ã€‚</p><blockquote><p>åŒæºç­–ç•¥é™åˆ¶äº†ä»åŒä¸€ä¸ªæºåŠ è½½çš„æ–‡æ¡£æˆ–è„šæœ¬å¦‚ä½•ä¸å¦ä¸€ä¸ªæºçš„èµ„æºè¿›è¡Œäº¤äº’ã€‚è¿™æ˜¯æµè§ˆå™¨çš„ä¸€ä¸ªç”¨äºéš”ç¦»æ½œåœ¨æ¶æ„æ–‡ä»¶çš„é‡è¦çš„å®‰å…¨æœºåˆ¶ã€‚åŒæºæŒ‡çš„æ˜¯ï¼š<strong>åè®®</strong>ã€<strong>ç«¯å£å·</strong>ã€<strong>åŸŸå</strong>å¿…é¡»ä¸€è‡´ã€‚</p></blockquote><p>ä¸‹è¡¨ç»™å‡ºäº†ä¸ URL <a href="http://store.company.com/dir/page.html">http://store.company.com/dir/page.html</a> çš„æºè¿›è¡Œå¯¹æ¯”çš„ç¤ºä¾‹:</p><table><thead><tr><th>URL</th><th>æ˜¯å¦è·¨åŸŸ</th><th>åŸå› </th></tr></thead><tbody><tr><td><a href="http://store.company.com/dir/page.html">http://store.company.com/dir/page.html</a></td><td>åŒæº</td><td>å®Œå…¨ç›¸åŒ</td></tr><tr><td><a href="http://store.company.com/dir/inner/another.html">http://store.company.com/dir/inner/another.html</a></td><td>åŒæº</td><td>åªæœ‰è·¯å¾„ä¸åŒ</td></tr><tr><td><a href="https://store.company.com/secure.html">https://store.company.com/secure.html</a></td><td>è·¨åŸŸ</td><td>åè®®ä¸åŒ</td></tr><tr><td><a href="http://store.company.com:81/dir/etc.html">http://store.company.com:81/dir/etc.html</a></td><td>è·¨åŸŸ</td><td>ç«¯å£ä¸åŒ ( http:// é»˜è®¤ç«¯å£æ˜¯80)</td></tr><tr><td><a href="http://news.company.com/dir/other.html">http://news.company.com/dir/other.html</a></td><td>è·¨åŸŸ</td><td>ä¸»æœºä¸åŒ</td></tr></tbody></table><p><strong>åŒæºç­–ç•¥ï¼šprotocolï¼ˆåè®®ï¼‰ã€domainï¼ˆåŸŸåï¼‰ã€portï¼ˆç«¯å£ï¼‰ä¸‰è€…å¿…é¡»ä¸€è‡´ã€‚</strong></p><p><strong>åŒæºæ”¿ç­–ä¸»è¦é™åˆ¶äº†ä¸‰ä¸ªæ–¹é¢ï¼š</strong></p><ul><li>å½“å‰åŸŸä¸‹çš„ js è„šæœ¬ä¸èƒ½å¤Ÿè®¿é—®å…¶ä»–åŸŸä¸‹çš„ cookieã€localStorage å’Œ indexDBã€‚</li><li>å½“å‰åŸŸä¸‹çš„ js è„šæœ¬ä¸èƒ½å¤Ÿæ“ä½œè®¿é—®æ“ä½œå…¶ä»–åŸŸä¸‹çš„ DOMã€‚</li><li>å½“å‰åŸŸä¸‹ ajax æ— æ³•å‘é€è·¨åŸŸè¯·æ±‚ã€‚</li></ul><p>åŒæºæ”¿ç­–çš„ç›®çš„ä¸»è¦æ˜¯ä¸ºäº†ä¿è¯ç”¨æˆ·çš„ä¿¡æ¯å®‰å…¨ï¼Œå®ƒåªæ˜¯å¯¹ js è„šæœ¬çš„ä¸€ç§é™åˆ¶ï¼Œå¹¶ä¸æ˜¯å¯¹æµè§ˆå™¨çš„é™åˆ¶ï¼Œå¯¹äºä¸€èˆ¬çš„ imgã€æˆ–è€…script è„šæœ¬è¯·æ±‚éƒ½ä¸ä¼šæœ‰è·¨åŸŸçš„é™åˆ¶ï¼Œè¿™æ˜¯å› ä¸ºè¿™äº›æ“ä½œéƒ½ä¸ä¼šé€šè¿‡å“åº”ç»“æœæ¥è¿›è¡Œå¯èƒ½å‡ºç°å®‰å…¨é—®é¢˜çš„æ“ä½œã€‚</p><h3 id="2-å¦‚ä½•è§£å†³è·¨è¶Šé—®é¢˜"><a href="#2-å¦‚ä½•è§£å†³è·¨è¶Šé—®é¢˜" class="headerlink" title="2. å¦‚ä½•è§£å†³è·¨è¶Šé—®é¢˜"></a>2. å¦‚ä½•è§£å†³è·¨è¶Šé—®é¢˜</h3><h4 id="ï¼ˆ1ï¼‰CORS"><a href="#ï¼ˆ1ï¼‰CORS" class="headerlink" title="ï¼ˆ1ï¼‰CORS"></a>ï¼ˆ1ï¼‰CORS</h4><p>ä¸‹é¢æ˜¯MDNå¯¹äºCORSçš„å®šä¹‰ï¼š</p><blockquote><p>è·¨åŸŸèµ„æºå…±äº«(CORS) æ˜¯ä¸€ç§æœºåˆ¶ï¼Œå®ƒä½¿ç”¨é¢å¤–çš„ HTTP å¤´æ¥å‘Šè¯‰æµè§ˆå™¨  è®©è¿è¡Œåœ¨ä¸€ä¸ª origin (domain)ä¸Šçš„Webåº”ç”¨è¢«å‡†è®¸è®¿é—®æ¥è‡ªä¸åŒæºæœåŠ¡å™¨ä¸Šçš„æŒ‡å®šçš„èµ„æºã€‚å½“ä¸€ä¸ªèµ„æºä»ä¸è¯¥èµ„æºæœ¬èº«æ‰€åœ¨çš„æœåŠ¡å™¨ä¸åŒçš„åŸŸã€åè®®æˆ–ç«¯å£è¯·æ±‚ä¸€ä¸ªèµ„æºæ—¶ï¼Œèµ„æºä¼šå‘èµ·ä¸€ä¸ªè·¨åŸŸHTTP è¯·æ±‚ã€‚</p></blockquote><p>CORSéœ€è¦æµè§ˆå™¨å’ŒæœåŠ¡å™¨åŒæ—¶æ”¯æŒï¼Œæ•´ä¸ªCORSè¿‡ç¨‹éƒ½æ˜¯æµè§ˆå™¨å®Œæˆçš„ï¼Œæ— éœ€ç”¨æˆ·å‚ä¸ã€‚å› æ­¤å®ç°<strong>CORSçš„å…³é”®å°±æ˜¯æœåŠ¡å™¨ï¼Œåªè¦æœåŠ¡å™¨å®ç°äº†CORSè¯·æ±‚</strong>ï¼Œå°±å¯ä»¥è·¨æºé€šä¿¡äº†ã€‚</p><p>æµè§ˆå™¨å°†CORSåˆ†ä¸º<strong>ç®€å•è¯·æ±‚</strong>å’Œ<strong>éç®€å•è¯·æ±‚</strong>ï¼š</p><p>ç®€å•è¯·æ±‚ä¸ä¼šè§¦å‘CORSé¢„æ£€è¯·æ±‚ã€‚è‹¥è¯¥è¯·æ±‚æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶ï¼Œå°±å¯ä»¥çœ‹ä½œæ˜¯ç®€å•è¯·æ±‚ï¼š</p><p><strong>1ï¼‰è¯·æ±‚æ–¹æ³•æ˜¯ä»¥ä¸‹ä¸‰ç§æ–¹æ³•ä¹‹ä¸€ï¼š</strong></p><ul><li>HEAD</li><li>GET</li><li>POST</li></ul><p><strong>2ï¼‰HTTPçš„å¤´ä¿¡æ¯ä¸è¶…å‡ºä»¥ä¸‹å‡ ç§å­—æ®µï¼š</strong></p><ul><li>Accept</li><li>Accept-Language</li><li>Content-Language</li><li>Last-Event-ID</li><li>Content-Typeï¼šåªé™äºä¸‰ä¸ªå€¼application/x-www-form-urlencodedã€multipart/form-dataã€text/plain</li></ul><p>è‹¥ä¸æ»¡è¶³ä»¥ä¸Šæ¡ä»¶ï¼Œå°±å±äºéç®€å•è¯·æ±‚äº†ã€‚</p><p><strong>ï¼ˆ1ï¼‰ç®€å•è¯·æ±‚è¿‡ç¨‹ï¼š</strong></p><p>å¯¹äºç®€å•è¯·æ±‚ï¼Œæµè§ˆå™¨ä¼šç›´æ¥å‘å‡ºCORSè¯·æ±‚ï¼Œå®ƒä¼šåœ¨è¯·æ±‚çš„å¤´ä¿¡æ¯ä¸­å¢åŠ ä¸€ä¸ªOrignå­—æ®µï¼Œè¯¥å­—æ®µç”¨æ¥è¯´æ˜æœ¬æ¬¡è¯·æ±‚æ¥è‡ªå“ªä¸ªæºï¼ˆåè®®+ç«¯å£+åŸŸåï¼‰ï¼ŒæœåŠ¡å™¨ä¼šæ ¹æ®è¿™ä¸ªå€¼æ¥å†³å®šæ˜¯å¦åŒæ„è¿™æ¬¡è¯·æ±‚ã€‚å¦‚æœOrignæŒ‡å®šçš„åŸŸååœ¨è®¸å¯èŒƒå›´ä¹‹å†…ï¼ŒæœåŠ¡å™¨è¿”å›çš„å“åº”å°±ä¼šå¤šå‡ºä»¥ä¸‹ä¿¡æ¯å¤´ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript">Access<span class="token operator">-</span>Control<span class="token operator">-</span>Allow<span class="token operator">-</span>Origin<span class="token punctuation">:</span> http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>api<span class="token punctuation">.</span>bob<span class="token punctuation">.</span>com  <span class="token comment" spellcheck="true">// å’ŒOrignä¸€ç›´</span>Access<span class="token operator">-</span>Control<span class="token operator">-</span>Allow<span class="token operator">-</span>Credentials<span class="token punctuation">:</span> <span class="token boolean">true</span>   <span class="token comment" spellcheck="true">// è¡¨ç¤ºæ˜¯å¦å…è®¸å‘é€Cookie</span>Access<span class="token operator">-</span>Control<span class="token operator">-</span>Expose<span class="token operator">-</span>Headers<span class="token punctuation">:</span> FooBar   <span class="token comment" spellcheck="true">// æŒ‡å®šè¿”å›å…¶ä»–å­—æ®µçš„å€¼</span>Content<span class="token operator">-</span>Type<span class="token punctuation">:</span> text<span class="token operator">/</span>html<span class="token punctuation">;</span> charset<span class="token operator">=</span>utf<span class="token number">-8</span>   <span class="token comment" spellcheck="true">// è¡¨ç¤ºæ–‡æ¡£ç±»å‹</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœOrignæŒ‡å®šçš„åŸŸåä¸åœ¨è®¸å¯èŒƒå›´ä¹‹å†…ï¼ŒæœåŠ¡å™¨ä¼šè¿”å›ä¸€ä¸ªæ­£å¸¸çš„HTTPå›åº”ï¼Œæµè§ˆå™¨å‘ç°æ²¡æœ‰ä¸Šé¢çš„Access-Control-Allow-Originå¤´éƒ¨ä¿¡æ¯ï¼Œå°±çŸ¥é“å‡ºé”™äº†ã€‚è¿™ä¸ªé”™è¯¯æ— æ³•é€šè¿‡çŠ¶æ€ç è¯†åˆ«ï¼Œå› ä¸ºè¿”å›çš„çŠ¶æ€ç å¯èƒ½æ˜¯200ã€‚</p><p><strong>åœ¨ç®€å•è¯·æ±‚ä¸­ï¼Œåœ¨æœåŠ¡å™¨å†…ï¼Œè‡³å°‘éœ€è¦è®¾ç½®å­—æ®µï¼š</strong><code>Access-Control-Allow-Origin</code></p><p><strong>ï¼ˆ2ï¼‰éç®€å•è¯·æ±‚è¿‡ç¨‹</strong></p><p>éç®€å•è¯·æ±‚æ˜¯å¯¹æœåŠ¡å™¨æœ‰ç‰¹æ®Šè¦æ±‚çš„è¯·æ±‚ï¼Œæ¯”å¦‚è¯·æ±‚æ–¹æ³•ä¸ºDELETEæˆ–è€…PUTç­‰ã€‚éç®€å•è¯·æ±‚çš„CORSè¯·æ±‚ä¼šåœ¨æ­£å¼é€šä¿¡ä¹‹å‰è¿›è¡Œä¸€æ¬¡HTTPæŸ¥è¯¢è¯·æ±‚ï¼Œ<strong>ç§°ä¸ºé¢„æ£€è¯·æ±‚</strong>ã€‚</p><p>æµè§ˆå™¨ä¼šè¯¢é—®æœåŠ¡å™¨ï¼Œå½“å‰æ‰€åœ¨çš„ç½‘é¡µæ˜¯å¦åœ¨æœåŠ¡å™¨å…è®¸è®¿é—®çš„èŒƒå›´å†…ï¼Œä»¥åŠå¯ä»¥ä½¿ç”¨å“ªäº›HTTPè¯·æ±‚æ–¹å¼å’Œå¤´ä¿¡æ¯å­—æ®µï¼Œåªæœ‰å¾—åˆ°è‚¯å®šçš„å›å¤ï¼Œæ‰ä¼šè¿›è¡Œæ­£å¼çš„HTTPè¯·æ±‚ï¼Œå¦åˆ™å°±ä¼šæŠ¥é”™ã€‚</p><p>é¢„æ£€è¯·æ±‚ä½¿ç”¨çš„<strong>è¯·æ±‚æ–¹æ³•æ˜¯OPTIONS</strong>ï¼Œè¡¨ç¤ºè¿™ä¸ªè¯·æ±‚æ˜¯æ¥è¯¢é—®çš„ã€‚ä»–çš„å¤´ä¿¡æ¯ä¸­çš„å…³é”®å­—æ®µæ˜¯Orignï¼Œè¡¨ç¤ºè¯·æ±‚æ¥è‡ªå“ªä¸ªæºã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå¤´ä¿¡æ¯ä¸­è¿˜åŒ…æ‹¬ä¸¤ä¸ªå­—æ®µï¼š</p><ul><li><strong>Access-Control-Request-Method</strong>ï¼šè¯¥å­—æ®µæ˜¯å¿…é¡»çš„ï¼Œç”¨æ¥åˆ—å‡ºæµè§ˆå™¨çš„CORSè¯·æ±‚ä¼šç”¨åˆ°å“ªäº›HTTPæ–¹æ³•ã€‚</li><li><strong>Access-Control-Request-Headers</strong>ï¼š è¯¥å­—æ®µæ˜¯ä¸€ä¸ªé€—å·åˆ†éš”çš„å­—ç¬¦ä¸²ï¼ŒæŒ‡å®šæµè§ˆå™¨CORSè¯·æ±‚ä¼šé¢å¤–å‘é€çš„å¤´ä¿¡æ¯å­—æ®µã€‚</li></ul><p>æœåŠ¡å™¨åœ¨æ”¶åˆ°æµè§ˆå™¨çš„é¢„æ£€è¯·æ±‚ä¹‹åï¼Œä¼šæ ¹æ®å¤´ä¿¡æ¯çš„ä¸‰ä¸ªå­—æ®µæ¥è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœè¿”å›çš„å¤´ä¿¡æ¯åœ¨ä¸­æœ‰Access-Control-Allow-Originè¿™ä¸ªå­—æ®µå°±æ˜¯å…è®¸è·¨åŸŸè¯·æ±‚ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±æ˜¯ä¸åŒæ„è¿™ä¸ªé¢„æ£€è¯·æ±‚ï¼Œå°±ä¼šæŠ¥é”™ã€‚</p><p>æœåŠ¡å™¨å›åº”çš„CORSçš„å­—æ®µå¦‚ä¸‹ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript">Access<span class="token operator">-</span>Control<span class="token operator">-</span>Allow<span class="token operator">-</span>Origin<span class="token punctuation">:</span> http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>api<span class="token punctuation">.</span>bob<span class="token punctuation">.</span>com  <span class="token comment" spellcheck="true">// å…è®¸è·¨åŸŸçš„æºåœ°å€</span>Access<span class="token operator">-</span>Control<span class="token operator">-</span>Allow<span class="token operator">-</span>Methods<span class="token punctuation">:</span> GET<span class="token punctuation">,</span> POST<span class="token punctuation">,</span> PUT <span class="token comment" spellcheck="true">// æœåŠ¡å™¨æ”¯æŒçš„æ‰€æœ‰è·¨åŸŸè¯·æ±‚çš„æ–¹æ³•</span>Access<span class="token operator">-</span>Control<span class="token operator">-</span>Allow<span class="token operator">-</span>Headers<span class="token punctuation">:</span> X<span class="token operator">-</span>Custom<span class="token operator">-</span>Header  <span class="token comment" spellcheck="true">// æœåŠ¡å™¨æ”¯æŒçš„æ‰€æœ‰å¤´ä¿¡æ¯å­—æ®µ</span>Access<span class="token operator">-</span>Control<span class="token operator">-</span>Allow<span class="token operator">-</span>Credentials<span class="token punctuation">:</span> <span class="token boolean">true</span>   <span class="token comment" spellcheck="true">// è¡¨ç¤ºæ˜¯å¦å…è®¸å‘é€Cookie</span>Access<span class="token operator">-</span>Control<span class="token operator">-</span>Max<span class="token operator">-</span>Age<span class="token punctuation">:</span> <span class="token number">1728000</span>  <span class="token comment" spellcheck="true">// ç”¨æ¥æŒ‡å®šæœ¬æ¬¡é¢„æ£€è¯·æ±‚çš„æœ‰æ•ˆæœŸï¼Œå•ä½ä¸ºç§’</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åªè¦æœåŠ¡å™¨é€šè¿‡äº†é¢„æ£€è¯·æ±‚ï¼Œåœ¨ä»¥åæ¯æ¬¡çš„CORSè¯·æ±‚éƒ½ä¼šè‡ªå¸¦ä¸€ä¸ªOriginå¤´ä¿¡æ¯å­—æ®µã€‚æœåŠ¡å™¨çš„å›åº”ï¼Œä¹Ÿéƒ½ä¼šæœ‰ä¸€ä¸ªAccess-Control-Allow-Originå¤´ä¿¡æ¯å­—æ®µã€‚</p><p><strong>åœ¨éç®€å•è¯·æ±‚ä¸­ï¼Œè‡³å°‘éœ€è¦è®¾ç½®ä»¥ä¸‹å­—æ®µï¼š</strong></p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token string">'Access-Control-Allow-Origin'</span>  <span class="token string">'Access-Control-Allow-Methods'</span><span class="token string">'Access-Control-Allow-Headers'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h5 id="å‡å°‘OPTIONSè¯·æ±‚æ¬¡æ•°ï¼š"><a href="#å‡å°‘OPTIONSè¯·æ±‚æ¬¡æ•°ï¼š" class="headerlink" title="å‡å°‘OPTIONSè¯·æ±‚æ¬¡æ•°ï¼š"></a>å‡å°‘OPTIONSè¯·æ±‚æ¬¡æ•°ï¼š</h5><p>OPTIONSè¯·æ±‚æ¬¡æ•°è¿‡å¤šå°±ä¼šæŸè€—é¡µé¢åŠ è½½çš„æ€§èƒ½ï¼Œé™ä½ç”¨æˆ·ä½“éªŒåº¦ã€‚æ‰€ä»¥å°½é‡è¦å‡å°‘OPTIONSè¯·æ±‚æ¬¡æ•°ï¼Œå¯ä»¥åç«¯åœ¨è¯·æ±‚çš„è¿”å›å¤´éƒ¨æ·»åŠ ï¼šAccess-Control-Max-Ageï¼šnumberã€‚å®ƒè¡¨ç¤ºé¢„æ£€è¯·æ±‚çš„è¿”å›ç»“æœå¯ä»¥è¢«ç¼“å­˜å¤šä¹…ï¼Œå•ä½æ˜¯ç§’ã€‚è¯¥å­—æ®µåªå¯¹å®Œå…¨ä¸€æ ·çš„URLçš„ç¼“å­˜è®¾ç½®ç”Ÿæ•ˆï¼Œæ‰€ä»¥è®¾ç½®äº†ç¼“å­˜æ—¶é—´ï¼Œåœ¨è¿™ä¸ªæ—¶é—´èŒƒå›´å†…ï¼Œå†æ¬¡å‘é€è¯·æ±‚å°±ä¸éœ€è¦è¿›è¡Œé¢„æ£€è¯·æ±‚äº†ã€‚</p><h5 id="CORSä¸­Cookieç›¸å…³é—®é¢˜ï¼š"><a href="#CORSä¸­Cookieç›¸å…³é—®é¢˜ï¼š" class="headerlink" title="CORSä¸­Cookieç›¸å…³é—®é¢˜ï¼š"></a>CORSä¸­Cookieç›¸å…³é—®é¢˜ï¼š</h5><p>åœ¨CORSè¯·æ±‚ä¸­ï¼Œå¦‚æœæƒ³è¦ä¼ é€’Cookieï¼Œå°±è¦æ»¡è¶³ä»¥ä¸‹ä¸‰ä¸ªæ¡ä»¶ï¼š</p><ul><li>åœ¨è¯·æ±‚ä¸­è®¾ç½® <code>withCredentials</code></li></ul><p>é»˜è®¤æƒ…å†µä¸‹åœ¨è·¨åŸŸè¯·æ±‚ï¼Œæµè§ˆå™¨æ˜¯ä¸å¸¦ cookie çš„ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½® withCredentials æ¥è¿›è¡Œä¼ é€’ cookie.</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// åŸç”Ÿ xml çš„è®¾ç½®æ–¹å¼</span><span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>xhr<span class="token punctuation">.</span>withCredentials <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// axios è®¾ç½®æ–¹å¼</span>axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>withCredentials <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>Access-Control-Allow-Credentials è®¾ç½®ä¸º true</li><li>Access-Control-Allow-Origin è®¾ç½®ä¸ºé <code>*</code></li></ul><h4 id="ï¼ˆ2ï¼‰JSONP"><a href="#ï¼ˆ2ï¼‰JSONP" class="headerlink" title="ï¼ˆ2ï¼‰JSONP"></a>ï¼ˆ2ï¼‰JSONP</h4><p><strong>jsonp</strong>çš„åŸç†å°±æ˜¯åˆ©ç”¨<code>&lt;script&gt;</code>æ ‡ç­¾æ²¡æœ‰è·¨åŸŸé™åˆ¶ï¼Œé€šè¿‡<code>&lt;script&gt;</code>æ ‡ç­¾srcå±æ€§ï¼Œå‘é€å¸¦æœ‰callbackå‚æ•°çš„GETè¯·æ±‚ï¼ŒæœåŠ¡ç«¯å°†æ¥å£è¿”å›æ•°æ®æ‹¼å‡‘åˆ°callbackå‡½æ•°ä¸­ï¼Œè¿”å›ç»™æµè§ˆå™¨ï¼Œæµè§ˆå™¨è§£ææ‰§è¡Œï¼Œä»è€Œå‰ç«¯æ‹¿åˆ°callbackå‡½æ•°è¿”å›çš„æ•°æ®ã€‚<br>1ï¼‰åŸç”ŸJSå®ç°ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">></span>    <span class="token keyword">var</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    script<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">'text/javascript'</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// ä¼ å‚ä¸€ä¸ªå›è°ƒå‡½æ•°åç»™åç«¯ï¼Œæ–¹ä¾¿åç«¯è¿”å›æ—¶æ‰§è¡Œè¿™ä¸ªåœ¨å‰ç«¯å®šä¹‰çš„å›è°ƒå‡½æ•°</span>    script<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">'http://www.domain2.com:8080/login?user=admin&amp;callback=handleCallback'</span><span class="token punctuation">;</span>    document<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// å›è°ƒæ‰§è¡Œå‡½æ•°</span>    <span class="token keyword">function</span> <span class="token function">handleCallback</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">alert</span><span class="token punctuation">(</span>JSON<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span> <span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœåŠ¡ç«¯è¿”å›å¦‚ä¸‹ï¼ˆè¿”å›æ—¶å³æ‰§è¡Œå…¨å±€å‡½æ•°ï¼‰ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token function">handleCallback</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"success"</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token string">"user"</span><span class="token punctuation">:</span> <span class="token string">"admin"</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>2ï¼‰Vue axioså®ç°ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">this</span><span class="token punctuation">.</span>$http <span class="token operator">=</span> axios<span class="token punctuation">;</span><span class="token keyword">this</span><span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">jsonp</span><span class="token punctuation">(</span><span class="token string">'http://www.domain2.com:8080/login'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>    params<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>    jsonp<span class="token punctuation">:</span> <span class="token string">'handleCallback'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åç«¯node.jsä»£ç ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> querystring <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'querystring'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>server<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'request'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">var</span> params <span class="token operator">=</span> querystring<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'?'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> fn <span class="token operator">=</span> params<span class="token punctuation">.</span>callback<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// jsonpè¿”å›è®¾ç½®</span>    res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string">'Content-Type'</span><span class="token punctuation">:</span> <span class="token string">'text/javascript'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>fn <span class="token operator">+</span> <span class="token string">'('</span> <span class="token operator">+</span> JSON<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">')'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token string">'8080'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Server is running at port 8080...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>JSONPçš„ç¼ºç‚¹ï¼š</strong></p><ul><li>å…·æœ‰å±€é™æ€§ï¼Œ ä»…æ”¯æŒgetæ–¹æ³•</li><li>ä¸å®‰å…¨ï¼Œå¯èƒ½ä¼šé­å—XSSæ”»å‡»</li></ul><h4 id="ï¼ˆ3ï¼‰postMessage-è·¨åŸŸ"><a href="#ï¼ˆ3ï¼‰postMessage-è·¨åŸŸ" class="headerlink" title="ï¼ˆ3ï¼‰postMessage è·¨åŸŸ"></a>ï¼ˆ3ï¼‰postMessage è·¨åŸŸ</h4><p>postMessageæ˜¯HTML5 XMLHttpRequest Level 2ä¸­çš„APIï¼Œä¸”æ˜¯ä¸ºæ•°ä¸å¤šå¯ä»¥è·¨åŸŸæ“ä½œçš„windowå±æ€§ä¹‹ä¸€ï¼Œå®ƒå¯ç”¨äºè§£å†³ä»¥ä¸‹æ–¹é¢çš„é—®é¢˜ï¼š</p><ul><li>é¡µé¢å’Œå…¶æ‰“å¼€çš„æ–°çª—å£çš„æ•°æ®ä¼ é€’</li><li>å¤šçª—å£ä¹‹é—´æ¶ˆæ¯ä¼ é€’</li><li>é¡µé¢ä¸åµŒå¥—çš„iframeæ¶ˆæ¯ä¼ é€’</li><li>ä¸Šé¢ä¸‰ä¸ªåœºæ™¯çš„è·¨åŸŸæ•°æ®ä¼ é€’</li></ul><p>ç”¨æ³•ï¼špostMessage(data,origin)æ–¹æ³•æ¥å—ä¸¤ä¸ªå‚æ•°ï¼š</p><ul><li><strong>data</strong>ï¼š html5è§„èŒƒæ”¯æŒä»»æ„åŸºæœ¬ç±»å‹æˆ–å¯å¤åˆ¶çš„å¯¹è±¡ï¼Œä½†éƒ¨åˆ†æµè§ˆå™¨åªæ”¯æŒå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥ä¼ å‚æ—¶æœ€å¥½ç”¨JSON.stringify()åºåˆ—åŒ–ã€‚</li><li><strong>origin</strong>ï¼š åè®®+ä¸»æœº+ç«¯å£å·ï¼Œä¹Ÿå¯ä»¥è®¾ç½®ä¸ºâ€*â€ï¼Œè¡¨ç¤ºå¯ä»¥ä¼ é€’ç»™ä»»æ„çª—å£ï¼Œå¦‚æœè¦æŒ‡å®šå’Œå½“å‰çª—å£åŒæºçš„è¯è®¾ç½®ä¸ºâ€/â€œã€‚</li></ul><p>1ï¼‰a.htmlï¼š(domain1.com/a.html)</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>iframe id<span class="token operator">=</span><span class="token string">"iframe"</span> src<span class="token operator">=</span><span class="token string">"http://www.domain2.com/b.html"</span> style<span class="token operator">=</span><span class="token string">"display:none;"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>iframe<span class="token operator">></span><span class="token operator">&lt;</span>script<span class="token operator">></span>           <span class="token keyword">var</span> iframe <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'iframe'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    iframe<span class="token punctuation">.</span>onload <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>            name<span class="token punctuation">:</span> <span class="token string">'aym'</span>        <span class="token punctuation">}</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// å‘domain2ä¼ é€è·¨åŸŸæ•°æ®</span>        iframe<span class="token punctuation">.</span>contentWindow<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span>JSON<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'http://www.domain2.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// æ¥å—domain2è¿”å›æ•°æ®</span>    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'data from domain2 ---> '</span> <span class="token operator">+</span> e<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>2ï¼‰b.htmlï¼š(domain2.com/b.html)</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">></span>    <span class="token comment" spellcheck="true">// æ¥æ”¶domain1çš„æ•°æ®</span>    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'data from domain1 ---> '</span> <span class="token operator">+</span> e<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">var</span> data <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>            data<span class="token punctuation">.</span>number <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// å¤„ç†åå†å‘å›domain1</span>            window<span class="token punctuation">.</span>parent<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span>JSON<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'http://www.domain1.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ï¼ˆ4ï¼‰nginxä»£ç†è·¨åŸŸ"><a href="#ï¼ˆ4ï¼‰nginxä»£ç†è·¨åŸŸ" class="headerlink" title="ï¼ˆ4ï¼‰nginxä»£ç†è·¨åŸŸ"></a>ï¼ˆ4ï¼‰nginxä»£ç†è·¨åŸŸ</h4><p>nginxä»£ç†è·¨åŸŸï¼Œå®è´¨å’ŒCORSè·¨åŸŸåŸç†ä¸€æ ·ï¼Œé€šè¿‡é…ç½®æ–‡ä»¶è®¾ç½®è¯·æ±‚å“åº”å¤´Access-Control-Allow-Originâ€¦ç­‰å­—æ®µã€‚</p><p>1ï¼‰nginxé…ç½®è§£å†³iconfontè·¨åŸŸ<br>æµè§ˆå™¨è·¨åŸŸè®¿é—®jsã€cssã€imgç­‰å¸¸è§„é™æ€èµ„æºè¢«åŒæºç­–ç•¥è®¸å¯ï¼Œä½†iconfontå­—ä½“æ–‡ä»¶(eot|otf|ttf|woff|svg)ä¾‹å¤–ï¼Œæ­¤æ—¶å¯åœ¨nginxçš„é™æ€èµ„æºæœåŠ¡å™¨ä¸­åŠ å…¥ä»¥ä¸‹é…ç½®ã€‚</p><pre class="line-numbers language-http"><code class="language-http">location / {  add_header Access-Control-Allow-Origin *;}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>2ï¼‰nginxåå‘ä»£ç†æ¥å£è·¨åŸŸ<br>è·¨åŸŸé—®é¢˜ï¼šåŒæºç­–ç•¥ä»…æ˜¯é’ˆå¯¹æµè§ˆå™¨çš„å®‰å…¨ç­–ç•¥ã€‚æœåŠ¡å™¨ç«¯è°ƒç”¨HTTPæ¥å£åªæ˜¯ä½¿ç”¨HTTPåè®®ï¼Œä¸éœ€è¦åŒæºç­–ç•¥ï¼Œä¹Ÿå°±ä¸å­˜åœ¨è·¨åŸŸé—®é¢˜ã€‚<br>å®ç°æ€è·¯ï¼šé€šè¿‡Nginxé…ç½®ä¸€ä¸ªä»£ç†æœåŠ¡å™¨åŸŸåä¸domain1ç›¸åŒï¼Œç«¯å£ä¸åŒï¼‰åšè·³æ¿æœºï¼Œåå‘ä»£ç†è®¿é—®domain2æ¥å£ï¼Œå¹¶ä¸”å¯ä»¥é¡ºä¾¿ä¿®æ”¹cookieä¸­domainä¿¡æ¯ï¼Œæ–¹ä¾¿å½“å‰åŸŸcookieå†™å…¥ï¼Œå®ç°è·¨åŸŸè®¿é—®ã€‚</p><p>nginxå…·ä½“é…ç½®ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript">#proxyæœåŠ¡å™¨server <span class="token punctuation">{</span>    listen       <span class="token number">81</span><span class="token punctuation">;</span>    server_name  www<span class="token punctuation">.</span>domain1<span class="token punctuation">.</span>com<span class="token punctuation">;</span>    location <span class="token operator">/</span> <span class="token punctuation">{</span>        proxy_pass   http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>domain2<span class="token punctuation">.</span>com<span class="token punctuation">:</span><span class="token number">8080</span><span class="token punctuation">;</span>  #åå‘ä»£ç†        proxy_cookie_domain www<span class="token punctuation">.</span>domain2<span class="token punctuation">.</span>com www<span class="token punctuation">.</span>domain1<span class="token punctuation">.</span>com<span class="token punctuation">;</span> #ä¿®æ”¹cookieé‡ŒåŸŸå        index  index<span class="token punctuation">.</span>html index<span class="token punctuation">.</span>htm<span class="token punctuation">;</span>        # å½“ç”¨webpack<span class="token operator">-</span>dev<span class="token operator">-</span>serverç­‰ä¸­é—´ä»¶ä»£ç†æ¥å£è®¿é—®nignxæ—¶ï¼Œæ­¤æ—¶æ— æµè§ˆå™¨å‚ä¸ï¼Œæ•…æ²¡æœ‰åŒæºé™åˆ¶ï¼Œä¸‹é¢çš„è·¨åŸŸé…ç½®å¯ä¸å¯ç”¨        add_header Access<span class="token operator">-</span>Control<span class="token operator">-</span>Allow<span class="token operator">-</span>Origin http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>domain1<span class="token punctuation">.</span>com<span class="token punctuation">;</span>  #å½“å‰ç«¯åªè·¨åŸŸä¸å¸¦cookieæ—¶ï¼Œå¯ä¸º<span class="token operator">*</span>        add_header Access<span class="token operator">-</span>Control<span class="token operator">-</span>Allow<span class="token operator">-</span>Credentials <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ï¼ˆ5ï¼‰nodejs-ä¸­é—´ä»¶ä»£ç†è·¨åŸŸ"><a href="#ï¼ˆ5ï¼‰nodejs-ä¸­é—´ä»¶ä»£ç†è·¨åŸŸ" class="headerlink" title="ï¼ˆ5ï¼‰nodejs ä¸­é—´ä»¶ä»£ç†è·¨åŸŸ"></a>ï¼ˆ5ï¼‰nodejs ä¸­é—´ä»¶ä»£ç†è·¨åŸŸ</h4><p>nodeä¸­é—´ä»¶å®ç°è·¨åŸŸä»£ç†ï¼ŒåŸç†å¤§è‡´ä¸nginxç›¸åŒï¼Œéƒ½æ˜¯é€šè¿‡å¯ä¸€ä¸ªä»£ç†æœåŠ¡å™¨ï¼Œå®ç°æ•°æ®çš„è½¬å‘ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è®¾ç½®cookieDomainRewriteå‚æ•°ä¿®æ”¹å“åº”å¤´ä¸­cookieä¸­åŸŸåï¼Œå®ç°å½“å‰åŸŸçš„cookieå†™å…¥ï¼Œæ–¹ä¾¿æ¥å£ç™»å½•è®¤è¯ã€‚</p><p><strong>1ï¼‰évueæ¡†æ¶çš„è·¨åŸŸ</strong><br>ä½¿ç”¨node + express + http-proxy-middlewareæ­å»ºä¸€ä¸ªproxyæœåŠ¡å™¨ã€‚</p><ul><li>å‰ç«¯ä»£ç ï¼š</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// å‰ç«¯å¼€å…³ï¼šæµè§ˆå™¨æ˜¯å¦è¯»å†™cookie</span>xhr<span class="token punctuation">.</span>withCredentials <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// è®¿é—®http-proxy-middlewareä»£ç†æœåŠ¡å™¨</span>xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'get'</span><span class="token punctuation">,</span> <span class="token string">'http://www.domain1.com:3000/login?user=admin'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>ä¸­é—´ä»¶æœåŠ¡å™¨ä»£ç ï¼š</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http-proxy-middleware'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token function">proxy</span><span class="token punctuation">(</span><span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// ä»£ç†è·¨åŸŸç›®æ ‡æ¥å£</span>    target<span class="token punctuation">:</span> <span class="token string">'http://www.domain2.com:8080'</span><span class="token punctuation">,</span>    changeOrigin<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    <span class="token comment" spellcheck="true">// ä¿®æ”¹å“åº”å¤´ä¿¡æ¯ï¼Œå®ç°è·¨åŸŸå¹¶å…è®¸å¸¦cookie</span>    onProxyRes<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>proxyRes<span class="token punctuation">,</span> req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token punctuation">{</span>        res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">'Access-Control-Allow-Origin'</span><span class="token punctuation">,</span> <span class="token string">'http://www.domain1.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">'Access-Control-Allow-Credentials'</span><span class="token punctuation">,</span> <span class="token string">'true'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token comment" spellcheck="true">// ä¿®æ”¹å“åº”ä¿¡æ¯ä¸­çš„cookieåŸŸå</span>    cookieDomainRewrite<span class="token punctuation">:</span> <span class="token string">'www.domain1.com'</span>  <span class="token comment" spellcheck="true">// å¯ä»¥ä¸ºfalseï¼Œè¡¨ç¤ºä¸ä¿®æ”¹</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Proxy server is listen at port 3000...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>2ï¼‰vueæ¡†æ¶çš„è·¨åŸŸ</strong></p><p>node + vue + webpack + webpack-dev-serveræ­å»ºçš„é¡¹ç›®ï¼Œè·¨åŸŸè¯·æ±‚æ¥å£ï¼Œç›´æ¥ä¿®æ”¹webpack.config.jsé…ç½®ã€‚å¼€å‘ç¯å¢ƒä¸‹ï¼Œvueæ¸²æŸ“æœåŠ¡å’Œæ¥å£ä»£ç†æœåŠ¡éƒ½æ˜¯webpack-dev-serveråŒä¸€ä¸ªï¼Œæ‰€ä»¥é¡µé¢ä¸ä»£ç†æ¥å£ä¹‹é—´ä¸å†è·¨åŸŸã€‚</p><p>webpack.config.jséƒ¨åˆ†é…ç½®ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>    entry<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>    module<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token operator">...</span>    devServer<span class="token punctuation">:</span> <span class="token punctuation">{</span>        historyApiFallback<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>        proxy<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>            context<span class="token punctuation">:</span> <span class="token string">'/login'</span><span class="token punctuation">,</span>            target<span class="token punctuation">:</span> <span class="token string">'http://www.domain2.com:8080'</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true">// ä»£ç†è·¨åŸŸç›®æ ‡æ¥å£</span>            changeOrigin<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>            secure<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true">// å½“ä»£ç†æŸäº›httpsæœåŠ¡æŠ¥é”™æ—¶ç”¨</span>            cookieDomainRewrite<span class="token punctuation">:</span> <span class="token string">'www.domain1.com'</span>  <span class="token comment" spellcheck="true">// å¯ä»¥ä¸ºfalseï¼Œè¡¨ç¤ºä¸ä¿®æ”¹</span>        <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        noInfo<span class="token punctuation">:</span> <span class="token boolean">true</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ï¼ˆ6ï¼‰document-domain-iframeè·¨åŸŸ"><a href="#ï¼ˆ6ï¼‰document-domain-iframeè·¨åŸŸ" class="headerlink" title="ï¼ˆ6ï¼‰document.domain + iframeè·¨åŸŸ"></a>ï¼ˆ6ï¼‰document.domain + iframeè·¨åŸŸ</h4><p>æ­¤æ–¹æ¡ˆä»…é™ä¸»åŸŸç›¸åŒï¼Œå­åŸŸä¸åŒçš„è·¨åŸŸåº”ç”¨åœºæ™¯ã€‚å®ç°åŸç†ï¼šä¸¤ä¸ªé¡µé¢éƒ½é€šè¿‡jså¼ºåˆ¶è®¾ç½®document.domainä¸ºåŸºç¡€ä¸»åŸŸï¼Œå°±å®ç°äº†åŒåŸŸã€‚<br>1ï¼‰çˆ¶çª—å£ï¼š(domain.com/a.html)</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>iframe id<span class="token operator">=</span><span class="token string">"iframe"</span> src<span class="token operator">=</span><span class="token string">"http://child.domain.com/b.html"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>iframe<span class="token operator">></span><span class="token operator">&lt;</span>script<span class="token operator">></span>    document<span class="token punctuation">.</span>domain <span class="token operator">=</span> <span class="token string">'domain.com'</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> user <span class="token operator">=</span> <span class="token string">'admin'</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>1ï¼‰å­çª—å£ï¼š(child.domain.com/a.html)</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">></span>    document<span class="token punctuation">.</span>domain <span class="token operator">=</span> <span class="token string">'domain.com'</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// è·å–çˆ¶çª—å£ä¸­å˜é‡</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'get js data from parent ---> '</span> <span class="token operator">+</span> window<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ï¼ˆ7ï¼‰location-hash-iframeè·¨åŸŸ"><a href="#ï¼ˆ7ï¼‰location-hash-iframeè·¨åŸŸ" class="headerlink" title="ï¼ˆ7ï¼‰location.hash + iframeè·¨åŸŸ"></a>ï¼ˆ7ï¼‰location.hash + iframeè·¨åŸŸ</h4><p>å®ç°åŸç†ï¼šaæ¬²ä¸bè·¨åŸŸç›¸äº’é€šä¿¡ï¼Œé€šè¿‡ä¸­é—´é¡µcæ¥å®ç°ã€‚ ä¸‰ä¸ªé¡µé¢ï¼Œä¸åŒåŸŸä¹‹é—´åˆ©ç”¨iframeçš„location.hashä¼ å€¼ï¼Œç›¸åŒåŸŸä¹‹é—´ç›´æ¥jsè®¿é—®æ¥é€šä¿¡ã€‚</p><p>å…·ä½“å®ç°ï¼šAåŸŸï¼ša.html -&gt; BåŸŸï¼šb.html -&gt; AåŸŸï¼šc.htmlï¼Œaä¸bä¸åŒåŸŸåªèƒ½é€šè¿‡hashå€¼å•å‘é€šä¿¡ï¼Œbä¸cä¹Ÿä¸åŒåŸŸä¹Ÿåªèƒ½å•å‘é€šä¿¡ï¼Œä½†cä¸aåŒåŸŸï¼Œæ‰€ä»¥cå¯é€šè¿‡parent.parentè®¿é—®aé¡µé¢æ‰€æœ‰å¯¹è±¡ã€‚</p><p>1ï¼‰a.htmlï¼š(domain1.com/a.html)</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>iframe id<span class="token operator">=</span><span class="token string">"iframe"</span> src<span class="token operator">=</span><span class="token string">"http://www.domain2.com/b.html"</span> style<span class="token operator">=</span><span class="token string">"display:none;"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>iframe<span class="token operator">></span><span class="token operator">&lt;</span>script<span class="token operator">></span>    <span class="token keyword">var</span> iframe <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'iframe'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// å‘b.htmlä¼ hashå€¼</span>    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        iframe<span class="token punctuation">.</span>src <span class="token operator">=</span> iframe<span class="token punctuation">.</span>src <span class="token operator">+</span> <span class="token string">'#user=admin'</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// å¼€æ”¾ç»™åŒåŸŸc.htmlçš„å›è°ƒæ–¹æ³•</span>    <span class="token keyword">function</span> <span class="token function">onCallback</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'data from c.html ---> '</span> <span class="token operator">+</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>2ï¼‰b.htmlï¼š(.domain2.com/b.html)</p><pre><code>&lt;iframe id="iframe" src="http://www.domain1.com/c.html" style="display:none;"&gt;&lt;/iframe&gt;&lt;script&gt;    var iframe = document.getElementById('iframe');    // ç›‘å¬a.htmlä¼ æ¥çš„hashå€¼ï¼Œå†ä¼ ç»™c.html    window.onhashchange = function () {        iframe.src = iframe.src + location.hash;    };&lt;/script&gt;</code></pre><p>3ï¼‰c.htmlï¼š(<a href="https://link.zhihu.com/?target=http%3A//www.domain1.com/c.html">http://www.domain1.com/c.html</a>)</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">></span>    <span class="token comment" spellcheck="true">// ç›‘å¬b.htmlä¼ æ¥çš„hashå€¼</span>    window<span class="token punctuation">.</span>onhashchange <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// å†é€šè¿‡æ“ä½œåŒåŸŸa.htmlçš„jså›è°ƒï¼Œå°†ç»“æœä¼ å›</span>        window<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>parent<span class="token punctuation">.</span><span class="token function">onCallback</span><span class="token punctuation">(</span><span class="token string">'hello: '</span> <span class="token operator">+</span> location<span class="token punctuation">.</span>hash<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'#user='</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ï¼ˆ8ï¼‰window-name-iframeè·¨åŸŸ"><a href="#ï¼ˆ8ï¼‰window-name-iframeè·¨åŸŸ" class="headerlink" title="ï¼ˆ8ï¼‰window.name + iframeè·¨åŸŸ"></a>ï¼ˆ8ï¼‰window.name + iframeè·¨åŸŸ</h4><p>window.nameå±æ€§çš„ç‹¬ç‰¹ä¹‹å¤„ï¼šnameå€¼åœ¨ä¸åŒçš„é¡µé¢ï¼ˆç”šè‡³ä¸åŒåŸŸåï¼‰åŠ è½½åä¾æ—§å­˜åœ¨ï¼Œå¹¶ä¸”å¯ä»¥æ”¯æŒéå¸¸é•¿çš„ name å€¼ï¼ˆ2MBï¼‰ã€‚</p><p>1ï¼‰a.htmlï¼š(domain1.com/a.html)</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> proxy <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">var</span> state <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">var</span> iframe <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'iframe'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// åŠ è½½è·¨åŸŸé¡µé¢</span>    iframe<span class="token punctuation">.</span>src <span class="token operator">=</span> url<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// onloadäº‹ä»¶ä¼šè§¦å‘2æ¬¡ï¼Œç¬¬1æ¬¡åŠ è½½è·¨åŸŸé¡µï¼Œå¹¶ç•™å­˜æ•°æ®äºwindow.name</span>    iframe<span class="token punctuation">.</span>onload <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>state <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// ç¬¬2æ¬¡onload(åŒåŸŸproxyé¡µ)æˆåŠŸåï¼Œè¯»å–åŒåŸŸwindow.nameä¸­æ•°æ®</span>            <span class="token function">callback</span><span class="token punctuation">(</span>iframe<span class="token punctuation">.</span>contentWindow<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">destoryFrame</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>state <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment" spellcheck="true">// ç¬¬1æ¬¡onload(è·¨åŸŸé¡µ)æˆåŠŸåï¼Œåˆ‡æ¢åˆ°åŒåŸŸä»£ç†é¡µé¢</span>            iframe<span class="token punctuation">.</span>contentWindow<span class="token punctuation">.</span>location <span class="token operator">=</span> <span class="token string">'http://www.domain1.com/proxy.html'</span><span class="token punctuation">;</span>            state <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>iframe<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// è·å–æ•°æ®ä»¥åé”€æ¯è¿™ä¸ªiframeï¼Œé‡Šæ”¾å†…å­˜ï¼›è¿™ä¹Ÿä¿è¯äº†å®‰å…¨ï¼ˆä¸è¢«å…¶ä»–åŸŸframe jsè®¿é—®ï¼‰</span>    <span class="token keyword">function</span> <span class="token function">destoryFrame</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        iframe<span class="token punctuation">.</span>contentWindow<span class="token punctuation">.</span>document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        iframe<span class="token punctuation">.</span>contentWindow<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>iframe<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// è¯·æ±‚è·¨åŸŸbé¡µé¢æ•°æ®</span><span class="token function">proxy</span><span class="token punctuation">(</span><span class="token string">'http://www.domain2.com/b.html'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token function">alert</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>2ï¼‰proxy.htmlï¼š(domain1.com/proxy.html)</p><p>ä¸­é—´ä»£ç†é¡µï¼Œä¸a.htmlåŒåŸŸï¼Œå†…å®¹ä¸ºç©ºå³å¯ã€‚<br>3ï¼‰b.htmlï¼š(domain2.com/b.html)</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>script<span class="token operator">></span>        window<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'This is domain2 data!'</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>é€šè¿‡iframeçš„srcå±æ€§ç”±å¤–åŸŸè½¬å‘æœ¬åœ°åŸŸï¼Œè·¨åŸŸæ•°æ®å³ç”±iframeçš„window.nameä»å¤–åŸŸä¼ é€’åˆ°æœ¬åœ°åŸŸã€‚è¿™ä¸ªå°±å·§å¦™åœ°ç»•è¿‡äº†æµè§ˆå™¨çš„è·¨åŸŸè®¿é—®é™åˆ¶ï¼Œä½†åŒæ—¶å®ƒåˆæ˜¯å®‰å…¨æ“ä½œã€‚</p><h4 id="ï¼ˆ9ï¼‰WebSocketåè®®è·¨åŸŸ"><a href="#ï¼ˆ9ï¼‰WebSocketåè®®è·¨åŸŸ" class="headerlink" title="ï¼ˆ9ï¼‰WebSocketåè®®è·¨åŸŸ"></a>ï¼ˆ9ï¼‰WebSocketåè®®è·¨åŸŸ</h4><p>WebSocket protocolæ˜¯HTML5ä¸€ç§æ–°çš„åè®®ã€‚å®ƒå®ç°äº†æµè§ˆå™¨ä¸æœåŠ¡å™¨å…¨åŒå·¥é€šä¿¡ï¼ŒåŒæ—¶å…è®¸è·¨åŸŸé€šè®¯ï¼Œæ˜¯server pushæŠ€æœ¯çš„ä¸€ç§å¾ˆå¥½çš„å®ç°ã€‚</p><p>åŸç”ŸWebSocket APIä½¿ç”¨èµ·æ¥ä¸å¤ªæ–¹ä¾¿ï¼Œæˆ‘ä»¬ä½¿ç”¨Socket.ioï¼Œå®ƒå¾ˆå¥½åœ°å°è£…äº†webSocketæ¥å£ï¼Œæä¾›äº†æ›´ç®€å•ã€çµæ´»çš„æ¥å£ï¼Œä¹Ÿå¯¹ä¸æ”¯æŒwebSocketçš„æµè§ˆå™¨æä¾›äº†å‘ä¸‹å…¼å®¹ã€‚</p><p>1ï¼‰å‰ç«¯ä»£ç ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>div<span class="token operator">></span>user inputï¼š<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"https://cdn.bootcss.com/socket.io/2.2.0/socket.io.js"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span class="token operator">&lt;</span>script<span class="token operator">></span><span class="token keyword">var</span> socket <span class="token operator">=</span> <span class="token function">io</span><span class="token punctuation">(</span><span class="token string">'http://www.domain2.com:8080'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// è¿æ¥æˆåŠŸå¤„ç†</span>socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'connect'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// ç›‘å¬æœåŠ¡ç«¯æ¶ˆæ¯</span>    socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'data from server: ---> '</span> <span class="token operator">+</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// ç›‘å¬æœåŠ¡ç«¯å…³é—­</span>    socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'disconnect'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>         console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Server socket has closed.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>onblur <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    socket<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>2ï¼‰Nodejs socketåå°ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> socket <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'socket.io'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// å¯httpæœåŠ¡</span><span class="token keyword">var</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> res<span class="token punctuation">)</span> <span class="token punctuation">{</span>    res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>        <span class="token string">'Content-type'</span><span class="token punctuation">:</span> <span class="token string">'text/html'</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token string">'8080'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Server is running at port 8080...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// ç›‘å¬socketè¿æ¥</span>socket<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>server<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'connection'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>client<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// æ¥æ”¶ä¿¡æ¯</span>    client<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>        client<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">'helloï¼š'</span> <span class="token operator">+</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'data from client: ---> '</span> <span class="token operator">+</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// æ–­å¼€å¤„ç†</span>    client<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'disconnect'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Client socket has closed.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-æ­£å‘ä»£ç†å’Œåå‘ä»£ç†çš„åŒºåˆ«"><a href="#3-æ­£å‘ä»£ç†å’Œåå‘ä»£ç†çš„åŒºåˆ«" class="headerlink" title="3. æ­£å‘ä»£ç†å’Œåå‘ä»£ç†çš„åŒºåˆ«"></a>3. æ­£å‘ä»£ç†å’Œåå‘ä»£ç†çš„åŒºåˆ«</h3><ul><li><strong>æ­£å‘ä»£ç†ï¼š</strong></li></ul><p>å®¢æˆ·ç«¯æƒ³è·å¾—ä¸€ä¸ªæœåŠ¡å™¨çš„æ•°æ®ï¼Œä½†æ˜¯å› ä¸ºç§ç§åŸå› æ— æ³•ç›´æ¥è·å–ã€‚äºæ˜¯å®¢æˆ·ç«¯è®¾ç½®äº†ä¸€ä¸ªä»£ç†æœåŠ¡å™¨ï¼Œå¹¶ä¸”æŒ‡å®šç›®æ ‡æœåŠ¡å™¨ï¼Œä¹‹åä»£ç†æœåŠ¡å™¨å‘ç›®æ ‡æœåŠ¡å™¨è½¬äº¤è¯·æ±‚å¹¶å°†è·å¾—çš„å†…å®¹å‘é€ç»™å®¢æˆ·ç«¯ã€‚è¿™æ ·æœ¬è´¨ä¸Šèµ·åˆ°äº†å¯¹çœŸå®æœåŠ¡å™¨éšè—çœŸå®å®¢æˆ·ç«¯çš„ç›®çš„ã€‚å®ç°æ­£å‘ä»£ç†éœ€è¦ä¿®æ”¹å®¢æˆ·ç«¯ï¼Œæ¯”å¦‚ä¿®æ”¹æµè§ˆå™¨é…ç½®ã€‚</p><ul><li><strong>åå‘ä»£ç†ï¼š</strong></li></ul><p>æœåŠ¡å™¨ä¸ºäº†èƒ½å¤Ÿå°†å·¥ä½œè´Ÿè½½åˆ†ä¸åˆ°å¤šä¸ªæœåŠ¡å™¨æ¥æé«˜ç½‘ç«™æ€§èƒ½ (è´Ÿè½½å‡è¡¡)ç­‰ç›®çš„ï¼Œå½“å…¶å—åˆ°è¯·æ±‚åï¼Œä¼šé¦–å…ˆæ ¹æ®è½¬å‘è§„åˆ™æ¥ç¡®å®šè¯·æ±‚åº”è¯¥è¢«è½¬å‘åˆ°å“ªä¸ªæœåŠ¡å™¨ä¸Šï¼Œç„¶åå°†è¯·æ±‚è½¬å‘åˆ°å¯¹åº”çš„çœŸå®æœåŠ¡å™¨ä¸Šã€‚è¿™æ ·æœ¬è´¨ä¸Šèµ·åˆ°äº†å¯¹å®¢æˆ·ç«¯éšè—çœŸå®æœåŠ¡å™¨çš„ä½œç”¨ã€‚<br>ä¸€èˆ¬ä½¿ç”¨åå‘ä»£ç†åï¼Œéœ€è¦é€šè¿‡ä¿®æ”¹ DNS è®©åŸŸåè§£æåˆ°ä»£ç†æœåŠ¡å™¨ IPï¼Œè¿™æ—¶æµè§ˆå™¨æ— æ³•å¯Ÿè§‰åˆ°çœŸæ­£æœåŠ¡å™¨çš„å­˜åœ¨ï¼Œå½“ç„¶ä¹Ÿå°±ä¸éœ€è¦ä¿®æ”¹é…ç½®äº†ã€‚</p><p>ä¸¤è€…åŒºåˆ«å¦‚å›¾ç¤ºï¼š<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/theory/8.png" alt=""><br>æ­£å‘ä»£ç†å’Œåå‘ä»£ç†çš„ç»“æ„æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯ client-proxy-server çš„ç»“æ„ï¼Œå®ƒä»¬ä¸»è¦çš„åŒºåˆ«å°±åœ¨äºä¸­é—´è¿™ä¸ª proxy æ˜¯å“ªä¸€æ–¹è®¾ç½®çš„ã€‚åœ¨æ­£å‘ä»£ç†ä¸­ï¼Œproxy æ˜¯ client è®¾ç½®çš„ï¼Œç”¨æ¥éšè— clientï¼›è€Œåœ¨åå‘ä»£ç†ä¸­ï¼Œproxy æ˜¯ server è®¾ç½®çš„ï¼Œç”¨æ¥éšè— serverã€‚</p><h3 id="4-Nginxçš„æ¦‚å¿µåŠå…¶å·¥ä½œåŸç†"><a href="#4-Nginxçš„æ¦‚å¿µåŠå…¶å·¥ä½œåŸç†" class="headerlink" title="4. Nginxçš„æ¦‚å¿µåŠå…¶å·¥ä½œåŸç†"></a>4. Nginxçš„æ¦‚å¿µåŠå…¶å·¥ä½œåŸç†</h3><p>Nginx æ˜¯ä¸€æ¬¾è½»é‡çº§çš„ Web æœåŠ¡å™¨ï¼Œä¹Ÿå¯ä»¥ç”¨äºåå‘ä»£ç†ã€è´Ÿè½½å¹³è¡¡å’Œ HTTP ç¼“å­˜ç­‰ã€‚Nginx ä½¿ç”¨å¼‚æ­¥äº‹ä»¶é©±åŠ¨çš„æ–¹æ³•æ¥å¤„ç†è¯·æ±‚ï¼Œæ˜¯ä¸€æ¬¾é¢å‘æ€§èƒ½è®¾è®¡çš„ HTTP æœåŠ¡å™¨ã€‚</p><p>ä¼ ç»Ÿçš„ Web æœåŠ¡å™¨å¦‚ Apache æ˜¯ process-based æ¨¡å‹çš„ï¼Œè€Œ Nginx æ˜¯åŸºäºevent-drivenæ¨¡å‹çš„ã€‚æ­£æ˜¯è¿™ä¸ªä¸»è¦çš„åŒºåˆ«å¸¦ç»™äº† Nginx åœ¨æ€§èƒ½ä¸Šçš„ä¼˜åŠ¿ã€‚</p><p>Nginx æ¶æ„çš„æœ€é¡¶å±‚æ˜¯ä¸€ä¸ª master processï¼Œè¿™ä¸ª master process ç”¨äºäº§ç”Ÿå…¶ä»–çš„ worker processï¼Œè¿™ä¸€ç‚¹å’ŒApache éå¸¸åƒï¼Œä½†æ˜¯ Nginx çš„ worker process å¯ä»¥åŒæ—¶å¤„ç†å¤§é‡çš„HTTPè¯·æ±‚ï¼Œè€Œæ¯ä¸ª Apache process åªèƒ½å¤„ç†ä¸€ä¸ªã€‚</p><h2 id="å…«ã€æµè§ˆå™¨äº‹ä»¶æœºåˆ¶"><a href="#å…«ã€æµè§ˆå™¨äº‹ä»¶æœºåˆ¶" class="headerlink" title="å…«ã€æµè§ˆå™¨äº‹ä»¶æœºåˆ¶"></a>å…«ã€æµè§ˆå™¨äº‹ä»¶æœºåˆ¶</h2><h3 id="1-äº‹ä»¶æ˜¯ä»€ä¹ˆï¼Ÿäº‹ä»¶æ¨¡å‹ï¼Ÿ"><a href="#1-äº‹ä»¶æ˜¯ä»€ä¹ˆï¼Ÿäº‹ä»¶æ¨¡å‹ï¼Ÿ" class="headerlink" title="1. äº‹ä»¶æ˜¯ä»€ä¹ˆï¼Ÿäº‹ä»¶æ¨¡å‹ï¼Ÿ"></a>1. äº‹ä»¶æ˜¯ä»€ä¹ˆï¼Ÿäº‹ä»¶æ¨¡å‹ï¼Ÿ</h3><p>äº‹ä»¶æ˜¯ç”¨æˆ·æ“ä½œç½‘é¡µæ—¶å‘ç”Ÿçš„äº¤äº’åŠ¨ä½œï¼Œæ¯”å¦‚ click/moveï¼Œ äº‹ä»¶é™¤äº†ç”¨æˆ·è§¦å‘çš„åŠ¨ä½œå¤–ï¼Œè¿˜å¯ä»¥æ˜¯æ–‡æ¡£åŠ è½½ï¼Œçª—å£æ»šåŠ¨å’Œå¤§å°è°ƒæ•´ã€‚äº‹ä»¶è¢«å°è£…æˆä¸€ä¸ª event å¯¹è±¡ï¼ŒåŒ…å«äº†è¯¥äº‹ä»¶å‘ç”Ÿæ—¶çš„æ‰€æœ‰ç›¸å…³ä¿¡æ¯ï¼ˆ event çš„å±æ€§ï¼‰ä»¥åŠå¯ä»¥å¯¹äº‹ä»¶è¿›è¡Œçš„æ“ä½œï¼ˆ event çš„æ–¹æ³•ï¼‰ã€‚</p><p>äº‹ä»¶æ˜¯ç”¨æˆ·æ“ä½œç½‘é¡µæ—¶å‘ç”Ÿçš„äº¤äº’åŠ¨ä½œæˆ–è€…ç½‘é¡µæœ¬èº«çš„ä¸€äº›æ“ä½œï¼Œç°ä»£æµè§ˆå™¨ä¸€å…±æœ‰ä¸‰ç§äº‹ä»¶æ¨¡å‹ï¼š</p><ul><li><strong>DOM0 çº§äº‹ä»¶æ¨¡å‹</strong>ï¼Œè¿™ç§æ¨¡å‹ä¸ä¼šä¼ æ’­ï¼Œæ‰€ä»¥æ²¡æœ‰äº‹ä»¶æµçš„æ¦‚å¿µï¼Œä½†æ˜¯ç°åœ¨æœ‰çš„æµè§ˆå™¨æ”¯æŒä»¥å†’æ³¡çš„æ–¹å¼å®ç°ï¼Œå®ƒå¯ä»¥åœ¨ç½‘é¡µä¸­ç›´æ¥å®šä¹‰ç›‘å¬å‡½æ•°ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ js å±æ€§æ¥æŒ‡å®šç›‘å¬å‡½æ•°ã€‚æ‰€æœ‰æµè§ˆå™¨éƒ½å…¼å®¹è¿™ç§æ–¹å¼ã€‚ç›´æ¥åœ¨domå¯¹è±¡ä¸Šæ³¨å†Œäº‹ä»¶åç§°ï¼Œå°±æ˜¯DOM0å†™æ³•ã€‚</li><li><strong>IE äº‹ä»¶æ¨¡å‹</strong>ï¼Œåœ¨è¯¥äº‹ä»¶æ¨¡å‹ä¸­ï¼Œä¸€æ¬¡äº‹ä»¶å…±æœ‰ä¸¤ä¸ªè¿‡ç¨‹ï¼Œäº‹ä»¶å¤„ç†é˜¶æ®µå’Œäº‹ä»¶å†’æ³¡é˜¶æ®µã€‚äº‹ä»¶å¤„ç†é˜¶æ®µä¼šé¦–å…ˆæ‰§è¡Œç›®æ ‡å…ƒç´ ç»‘å®šçš„ç›‘å¬äº‹ä»¶ã€‚ç„¶åæ˜¯äº‹ä»¶å†’æ³¡é˜¶æ®µï¼Œå†’æ³¡æŒ‡çš„æ˜¯äº‹ä»¶ä»ç›®æ ‡å…ƒç´ å†’æ³¡åˆ° documentï¼Œä¾æ¬¡æ£€æŸ¥ç»è¿‡çš„èŠ‚ç‚¹æ˜¯å¦ç»‘å®šäº†äº‹ä»¶ç›‘å¬å‡½æ•°ï¼Œå¦‚æœæœ‰åˆ™æ‰§è¡Œã€‚è¿™ç§æ¨¡å‹é€šè¿‡attachEvent æ¥æ·»åŠ ç›‘å¬å‡½æ•°ï¼Œå¯ä»¥æ·»åŠ å¤šä¸ªç›‘å¬å‡½æ•°ï¼Œä¼šæŒ‰é¡ºåºä¾æ¬¡æ‰§è¡Œã€‚</li><li><strong>DOM2 çº§äº‹ä»¶æ¨¡å‹</strong>ï¼Œåœ¨è¯¥äº‹ä»¶æ¨¡å‹ä¸­ï¼Œä¸€æ¬¡äº‹ä»¶å…±æœ‰ä¸‰ä¸ªè¿‡ç¨‹ï¼Œç¬¬ä¸€ä¸ªè¿‡ç¨‹æ˜¯äº‹ä»¶æ•è·é˜¶æ®µã€‚æ•è·æŒ‡çš„æ˜¯äº‹ä»¶ä» document ä¸€ç›´å‘ä¸‹ä¼ æ’­åˆ°ç›®æ ‡å…ƒç´ ï¼Œä¾æ¬¡æ£€æŸ¥ç»è¿‡çš„èŠ‚ç‚¹æ˜¯å¦ç»‘å®šäº†äº‹ä»¶ç›‘å¬å‡½æ•°ï¼Œå¦‚æœæœ‰åˆ™æ‰§è¡Œã€‚åé¢ä¸¤ä¸ªé˜¶æ®µå’Œ IE äº‹ä»¶æ¨¡å‹çš„ä¸¤ä¸ªé˜¶æ®µç›¸åŒã€‚è¿™ç§äº‹ä»¶æ¨¡å‹ï¼Œäº‹ä»¶ç»‘å®šçš„å‡½æ•°æ˜¯addEventListenerï¼Œå…¶ä¸­ç¬¬ä¸‰ä¸ªå‚æ•°å¯ä»¥æŒ‡å®šäº‹ä»¶æ˜¯å¦åœ¨æ•è·é˜¶æ®µæ‰§è¡Œã€‚</li></ul><h3 id="2-å¦‚ä½•é˜»æ­¢äº‹ä»¶å†’æ³¡"><a href="#2-å¦‚ä½•é˜»æ­¢äº‹ä»¶å†’æ³¡" class="headerlink" title="2. å¦‚ä½•é˜»æ­¢äº‹ä»¶å†’æ³¡"></a>2. å¦‚ä½•é˜»æ­¢äº‹ä»¶å†’æ³¡</h3><ul><li>æ™®é€šæµè§ˆå™¨ä½¿ç”¨ï¼ševent.stopPropagation() </li><li>IEæµè§ˆå™¨ä½¿ç”¨ï¼ševent.cancelBubble = true;</li></ul><h3 id="3-å¯¹äº‹ä»¶å§”æ‰˜çš„ç†è§£"><a href="#3-å¯¹äº‹ä»¶å§”æ‰˜çš„ç†è§£" class="headerlink" title="3. å¯¹äº‹ä»¶å§”æ‰˜çš„ç†è§£"></a>3. å¯¹äº‹ä»¶å§”æ‰˜çš„ç†è§£</h3><h4 id="ï¼ˆ1ï¼‰äº‹ä»¶å§”æ‰˜çš„æ¦‚å¿µ"><a href="#ï¼ˆ1ï¼‰äº‹ä»¶å§”æ‰˜çš„æ¦‚å¿µ" class="headerlink" title="ï¼ˆ1ï¼‰äº‹ä»¶å§”æ‰˜çš„æ¦‚å¿µ"></a>ï¼ˆ1ï¼‰äº‹ä»¶å§”æ‰˜çš„æ¦‚å¿µ</h4><p>äº‹ä»¶å§”æ‰˜æœ¬è´¨ä¸Šæ˜¯åˆ©ç”¨äº†<strong>æµè§ˆå™¨äº‹ä»¶å†’æ³¡</strong>çš„æœºåˆ¶ã€‚å› ä¸ºäº‹ä»¶åœ¨å†’æ³¡è¿‡ç¨‹ä¸­ä¼šä¸Šä¼ åˆ°çˆ¶èŠ‚ç‚¹ï¼Œçˆ¶èŠ‚ç‚¹å¯ä»¥é€šè¿‡äº‹ä»¶å¯¹è±¡è·å–åˆ°ç›®æ ‡èŠ‚ç‚¹ï¼Œå› æ­¤å¯ä»¥æŠŠå­èŠ‚ç‚¹çš„ç›‘å¬å‡½æ•°å®šä¹‰åœ¨çˆ¶èŠ‚ç‚¹ä¸Šï¼Œç”±çˆ¶èŠ‚ç‚¹çš„ç›‘å¬å‡½æ•°ç»Ÿä¸€å¤„ç†å¤šä¸ªå­å…ƒç´ çš„äº‹ä»¶ï¼Œè¿™ç§æ–¹å¼ç§°ä¸ºäº‹ä»¶å§”æ‰˜ï¼ˆäº‹ä»¶ä»£ç†ï¼‰ã€‚</p><p>ä½¿ç”¨äº‹ä»¶å§”æ‰˜å¯ä»¥ä¸å¿…è¦ä¸ºæ¯ä¸€ä¸ªå­å…ƒç´ éƒ½ç»‘å®šä¸€ä¸ªç›‘å¬äº‹ä»¶ï¼Œè¿™æ ·å‡å°‘äº†å†…å­˜ä¸Šçš„æ¶ˆè€—ã€‚å¹¶ä¸”ä½¿ç”¨äº‹ä»¶ä»£ç†è¿˜å¯ä»¥å®ç°äº‹ä»¶çš„åŠ¨æ€ç»‘å®šï¼Œæ¯”å¦‚è¯´æ–°å¢äº†ä¸€ä¸ªå­èŠ‚ç‚¹ï¼Œå¹¶ä¸éœ€è¦å•ç‹¬åœ°ä¸ºå®ƒæ·»åŠ ä¸€ä¸ªç›‘å¬äº‹ä»¶ï¼Œå®ƒç»‘å®šçš„äº‹ä»¶ä¼šäº¤ç»™çˆ¶å…ƒç´ ä¸­çš„ç›‘å¬å‡½æ•°æ¥å¤„ç†ã€‚</p><h4 id="ï¼ˆ2ï¼‰äº‹ä»¶å§”æ‰˜çš„ç‰¹ç‚¹"><a href="#ï¼ˆ2ï¼‰äº‹ä»¶å§”æ‰˜çš„ç‰¹ç‚¹" class="headerlink" title="ï¼ˆ2ï¼‰äº‹ä»¶å§”æ‰˜çš„ç‰¹ç‚¹"></a>ï¼ˆ2ï¼‰äº‹ä»¶å§”æ‰˜çš„ç‰¹ç‚¹</h4><ul><li><strong>å‡å°‘å†…å­˜æ¶ˆè€—</strong></li></ul><p>å¦‚æœæœ‰ä¸€ä¸ªåˆ—è¡¨ï¼Œåˆ—è¡¨ä¹‹ä¸­æœ‰å¤§é‡çš„åˆ—è¡¨é¡¹ï¼Œéœ€è¦åœ¨ç‚¹å‡»åˆ—è¡¨é¡¹çš„æ—¶å€™å“åº”ä¸€ä¸ªäº‹ä»¶ï¼š</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>list<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>item 1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>item 2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>item 3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>  ......  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>item n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¦‚æœç»™æ¯ä¸ªåˆ—è¡¨é¡¹ä¸€ä¸€éƒ½ç»‘å®šä¸€ä¸ªå‡½æ•°ï¼Œé‚£å¯¹äºå†…å­˜æ¶ˆè€—æ˜¯éå¸¸å¤§çš„ï¼Œæ•ˆç‡ä¸Šéœ€è¦æ¶ˆè€—å¾ˆå¤šæ€§èƒ½ã€‚å› æ­¤ï¼Œæ¯”è¾ƒå¥½çš„æ–¹æ³•å°±æ˜¯æŠŠè¿™ä¸ªç‚¹å‡»äº‹ä»¶ç»‘å®šåˆ°ä»–çš„çˆ¶å±‚ï¼Œä¹Ÿå°±æ˜¯ ul ä¸Šï¼Œç„¶ååœ¨æ‰§è¡Œäº‹ä»¶æ—¶å†å»åŒ¹é…åˆ¤æ–­ç›®æ ‡å…ƒç´ ï¼Œæ‰€ä»¥äº‹ä»¶å§”æ‰˜å¯ä»¥å‡å°‘å¤§é‡çš„å†…å­˜æ¶ˆè€—ï¼ŒèŠ‚çº¦æ•ˆç‡ã€‚</p><ul><li><strong>åŠ¨æ€ç»‘å®šäº‹ä»¶</strong></li></ul><p>ç»™ä¸Šè¿°çš„ä¾‹å­ä¸­æ¯ä¸ªåˆ—è¡¨é¡¹éƒ½ç»‘å®šäº‹ä»¶ï¼Œåœ¨å¾ˆå¤šæ—¶å€™ï¼Œéœ€è¦é€šè¿‡ AJAX æˆ–è€…ç”¨æˆ·æ“ä½œåŠ¨æ€çš„å¢åŠ æˆ–è€…å»é™¤åˆ—è¡¨é¡¹å…ƒç´ ï¼Œé‚£ä¹ˆåœ¨æ¯ä¸€æ¬¡æ”¹å˜çš„æ—¶å€™éƒ½éœ€è¦é‡æ–°ç»™æ–°å¢çš„å…ƒç´ ç»‘å®šäº‹ä»¶ï¼Œç»™å³å°†åˆ å»çš„å…ƒç´ è§£ç»‘äº‹ä»¶ï¼›å¦‚æœç”¨äº†äº‹ä»¶å§”æ‰˜å°±æ²¡æœ‰è¿™ç§éº»çƒ¦äº†ï¼Œå› ä¸ºäº‹ä»¶æ˜¯ç»‘å®šåœ¨çˆ¶å±‚çš„ï¼Œå’Œç›®æ ‡å…ƒç´ çš„å¢å‡æ˜¯æ²¡æœ‰å…³ç³»çš„ï¼Œæ‰§è¡Œåˆ°ç›®æ ‡å…ƒç´ æ˜¯åœ¨çœŸæ­£å“åº”æ‰§è¡Œäº‹ä»¶å‡½æ•°çš„è¿‡ç¨‹ä¸­å»åŒ¹é…çš„ï¼Œæ‰€ä»¥ä½¿ç”¨äº‹ä»¶åœ¨åŠ¨æ€ç»‘å®šäº‹ä»¶çš„æƒ…å†µä¸‹æ˜¯å¯ä»¥å‡å°‘å¾ˆå¤šé‡å¤å·¥ä½œçš„ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// æ¥å®ç°æŠŠ #list ä¸‹çš„ li å…ƒç´ çš„äº‹ä»¶ä»£ç†å§”æ‰˜åˆ°å®ƒçš„çˆ¶å±‚å…ƒç´ ä¹Ÿå°±æ˜¯ #list ä¸Šï¼š</span><span class="token comment" spellcheck="true">// ç»™çˆ¶å±‚å…ƒç´ ç»‘å®šäº‹ä»¶</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'list'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// å…¼å®¹æ€§å¤„ç†</span>  <span class="token keyword">var</span> event <span class="token operator">=</span> e <span class="token operator">||</span> window<span class="token punctuation">.</span>event<span class="token punctuation">;</span>  <span class="token keyword">var</span> target <span class="token operator">=</span> event<span class="token punctuation">.</span>target <span class="token operator">||</span> event<span class="token punctuation">.</span>srcElement<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// åˆ¤æ–­æ˜¯å¦åŒ¹é…ç›®æ ‡å…ƒç´ </span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>target<span class="token punctuation">.</span>nodeName<span class="token punctuation">.</span>toLocaleLowerCase <span class="token operator">===</span> <span class="token string">'li'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'the content is: '</span><span class="token punctuation">,</span> target<span class="token punctuation">.</span>innerHTML<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œ target å…ƒç´ åˆ™æ˜¯åœ¨ #list å…ƒç´ ä¹‹ä¸‹å…·ä½“è¢«ç‚¹å‡»çš„å…ƒç´ ï¼Œç„¶åé€šè¿‡åˆ¤æ–­ target çš„ä¸€äº›å±æ€§ï¼ˆæ¯”å¦‚ï¼šnodeNameï¼Œid ç­‰ç­‰ï¼‰å¯ä»¥æ›´ç²¾ç¡®åœ°åŒ¹é…åˆ°æŸä¸€ç±» #list li å…ƒç´ ä¹‹ä¸Šï¼›</p><h4 id="ï¼ˆ3ï¼‰å±€é™æ€§"><a href="#ï¼ˆ3ï¼‰å±€é™æ€§" class="headerlink" title="ï¼ˆ3ï¼‰å±€é™æ€§"></a>ï¼ˆ3ï¼‰å±€é™æ€§</h4><p>å½“ç„¶ï¼Œäº‹ä»¶å§”æ‰˜ä¹Ÿæ˜¯æœ‰å±€é™çš„ã€‚æ¯”å¦‚ focusã€blur ä¹‹ç±»çš„äº‹ä»¶æ²¡æœ‰äº‹ä»¶å†’æ³¡æœºåˆ¶ï¼Œæ‰€ä»¥æ— æ³•å®ç°äº‹ä»¶å§”æ‰˜ï¼›mousemoveã€mouseout è¿™æ ·çš„äº‹ä»¶ï¼Œè™½ç„¶æœ‰äº‹ä»¶å†’æ³¡ï¼Œä½†æ˜¯åªèƒ½ä¸æ–­é€šè¿‡ä½ç½®å»è®¡ç®—å®šä½ï¼Œå¯¹æ€§èƒ½æ¶ˆè€—é«˜ï¼Œå› æ­¤ä¹Ÿæ˜¯ä¸é€‚åˆäºäº‹ä»¶å§”æ‰˜çš„ã€‚</p><p>å½“ç„¶äº‹ä»¶å§”æ‰˜ä¸æ˜¯åªæœ‰ä¼˜ç‚¹ï¼Œå®ƒä¹Ÿæ˜¯æœ‰<strong>ç¼ºç‚¹</strong>çš„ï¼Œäº‹ä»¶å§”æ‰˜ä¼šå½±å“é¡µé¢æ€§èƒ½ï¼Œä¸»è¦å½±å“å› ç´ æœ‰ï¼š</p><ul><li>å…ƒç´ ä¸­ï¼Œç»‘å®šäº‹ä»¶å§”æ‰˜çš„æ¬¡æ•°ï¼›</li><li>ç‚¹å‡»çš„æœ€åº•å±‚å…ƒç´ ï¼Œåˆ°ç»‘å®šäº‹ä»¶å…ƒç´ ä¹‹é—´çš„<code>DOM</code>å±‚æ•°ï¼›</li></ul><p>åœ¨å¿…é¡»ä½¿ç”¨äº‹ä»¶å§”æ‰˜çš„åœ°æ–¹ï¼Œå¯ä»¥è¿›è¡Œå¦‚ä¸‹çš„å¤„ç†ï¼š</p><ul><li>åªåœ¨å¿…é¡»çš„åœ°æ–¹ï¼Œä½¿ç”¨äº‹ä»¶å§”æ‰˜ï¼Œæ¯”å¦‚ï¼š<code>ajax</code>çš„å±€éƒ¨åˆ·æ–°åŒºåŸŸ</li><li>å°½é‡çš„å‡å°‘ç»‘å®šçš„å±‚çº§ï¼Œä¸åœ¨<code>body</code>å…ƒç´ ä¸Šï¼Œè¿›è¡Œç»‘å®š</li><li>å‡å°‘ç»‘å®šçš„æ¬¡æ•°ï¼Œå¦‚æœå¯ä»¥ï¼Œé‚£ä¹ˆæŠŠå¤šä¸ªäº‹ä»¶çš„ç»‘å®šï¼Œåˆå¹¶åˆ°ä¸€æ¬¡äº‹ä»¶å§”æ‰˜ä¸­å»ï¼Œç”±è¿™ä¸ªäº‹ä»¶å§”æ‰˜çš„å›è°ƒï¼Œæ¥è¿›è¡Œåˆ†å‘ã€‚</li></ul><h3 id="4-äº‹ä»¶å§”æ‰˜çš„ä½¿ç”¨åœºæ™¯"><a href="#4-äº‹ä»¶å§”æ‰˜çš„ä½¿ç”¨åœºæ™¯" class="headerlink" title="4. äº‹ä»¶å§”æ‰˜çš„ä½¿ç”¨åœºæ™¯"></a>4. äº‹ä»¶å§”æ‰˜çš„ä½¿ç”¨åœºæ™¯</h3><p>åœºæ™¯ï¼šç»™é¡µé¢çš„æ‰€æœ‰çš„aæ ‡ç­¾æ·»åŠ clickäº‹ä»¶ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript">document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>nodeName <span class="token operator">==</span> <span class="token string">"A"</span><span class="token punctuation">)</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ä½†æ˜¯è¿™äº›aæ ‡ç­¾å¯èƒ½åŒ…å«ä¸€äº›åƒspanã€imgç­‰å…ƒç´ ï¼Œå¦‚æœç‚¹å‡»åˆ°äº†è¿™äº›aæ ‡ç­¾ä¸­çš„å…ƒç´ ï¼Œå°±ä¸ä¼šè§¦å‘clickäº‹ä»¶ï¼Œå› ä¸ºäº‹ä»¶ç»‘å®šä¸Šåœ¨aæ ‡ç­¾å…ƒç´ ä¸Šï¼Œè€Œè§¦å‘è¿™äº›å†…éƒ¨çš„å…ƒç´ æ—¶ï¼Œe.targetæŒ‡å‘çš„æ˜¯è§¦å‘clickäº‹ä»¶çš„å…ƒç´ ï¼ˆspanã€imgç­‰å…¶ä»–å…ƒç´ ï¼‰ã€‚</p><p>è¿™ç§æƒ…å†µä¸‹å°±å¯ä»¥ä½¿ç”¨äº‹ä»¶å§”æ‰˜æ¥å¤„ç†ï¼Œå°†äº‹ä»¶ç»‘å®šåœ¨aæ ‡ç­¾çš„å†…éƒ¨å…ƒç´ ä¸Šï¼Œå½“ç‚¹å‡»å®ƒçš„æ—¶å€™ï¼Œå°±ä¼šé€çº§å‘ä¸ŠæŸ¥æ‰¾ï¼ŒçŸ¥é“æ‰¾åˆ°aæ ‡ç­¾ä¸ºæ­¢ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript">document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">var</span> node <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">;</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span>nodeName <span class="token operator">!=</span> <span class="token string">"BODY"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>nodeName <span class="token operator">==</span> <span class="token string">"A"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        node <span class="token operator">=</span> node<span class="token punctuation">.</span>parentNode<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-åŒæ­¥å’Œå¼‚æ­¥çš„åŒºåˆ«"><a href="#5-åŒæ­¥å’Œå¼‚æ­¥çš„åŒºåˆ«" class="headerlink" title="5. åŒæ­¥å’Œå¼‚æ­¥çš„åŒºåˆ«"></a>5. åŒæ­¥å’Œå¼‚æ­¥çš„åŒºåˆ«</h3><ul><li><strong>åŒæ­¥</strong>æŒ‡çš„æ˜¯å½“ä¸€ä¸ªè¿›ç¨‹åœ¨æ‰§è¡ŒæŸä¸ªè¯·æ±‚æ—¶ï¼Œå¦‚æœè¿™ä¸ªè¯·æ±‚éœ€è¦ç­‰å¾…ä¸€æ®µæ—¶é—´æ‰èƒ½è¿”å›ï¼Œé‚£ä¹ˆè¿™ä¸ªè¿›ç¨‹ä¼šä¸€ç›´ç­‰å¾…ä¸‹å»ï¼Œç›´åˆ°æ¶ˆæ¯è¿”å›ä¸ºæ­¢å†ç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚</li><li><strong>å¼‚æ­¥</strong>æŒ‡çš„æ˜¯å½“ä¸€ä¸ªè¿›ç¨‹åœ¨æ‰§è¡ŒæŸä¸ªè¯·æ±‚æ—¶ï¼Œå¦‚æœè¿™ä¸ªè¯·æ±‚éœ€è¦ç­‰å¾…ä¸€æ®µæ—¶é—´æ‰èƒ½è¿”å›ï¼Œè¿™ä¸ªæ—¶å€™è¿›ç¨‹ä¼šç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œä¸ä¼šé˜»å¡ç­‰å¾…æ¶ˆæ¯çš„è¿”å›ï¼Œå½“æ¶ˆæ¯è¿”å›æ—¶ç³»ç»Ÿå†é€šçŸ¥è¿›ç¨‹è¿›è¡Œå¤„ç†ã€‚</li></ul><h3 id="6-å¯¹äº‹ä»¶å¾ªç¯çš„ç†è§£"><a href="#6-å¯¹äº‹ä»¶å¾ªç¯çš„ç†è§£" class="headerlink" title="6. å¯¹äº‹ä»¶å¾ªç¯çš„ç†è§£"></a>6. å¯¹äº‹ä»¶å¾ªç¯çš„ç†è§£</h3><p>å› ä¸º js æ˜¯å•çº¿ç¨‹è¿è¡Œçš„ï¼Œåœ¨ä»£ç æ‰§è¡Œæ—¶ï¼Œé€šè¿‡å°†ä¸åŒå‡½æ•°çš„æ‰§è¡Œä¸Šä¸‹æ–‡å‹å…¥æ‰§è¡Œæ ˆä¸­æ¥ä¿è¯ä»£ç çš„æœ‰åºæ‰§è¡Œã€‚åœ¨æ‰§è¡ŒåŒæ­¥ä»£ç æ—¶ï¼Œå¦‚æœé‡åˆ°å¼‚æ­¥äº‹ä»¶ï¼Œjs å¼•æ“å¹¶ä¸ä¼šä¸€ç›´ç­‰å¾…å…¶è¿”å›ç»“æœï¼Œè€Œæ˜¯ä¼šå°†è¿™ä¸ªäº‹ä»¶æŒ‚èµ·ï¼Œç»§ç»­æ‰§è¡Œæ‰§è¡Œæ ˆä¸­çš„å…¶ä»–ä»»åŠ¡ã€‚å½“å¼‚æ­¥äº‹ä»¶æ‰§è¡Œå®Œæ¯•åï¼Œå†å°†å¼‚æ­¥äº‹ä»¶å¯¹åº”çš„å›è°ƒåŠ å…¥åˆ°ä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—ä¸­ç­‰å¾…æ‰§è¡Œã€‚ä»»åŠ¡é˜Ÿåˆ—å¯ä»¥åˆ†ä¸ºå®ä»»åŠ¡é˜Ÿåˆ—å’Œå¾®ä»»åŠ¡é˜Ÿåˆ—ï¼Œå½“å½“å‰æ‰§è¡Œæ ˆä¸­çš„äº‹ä»¶æ‰§è¡Œå®Œæ¯•åï¼Œjs å¼•æ“é¦–å…ˆä¼šåˆ¤æ–­å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­æ˜¯å¦æœ‰ä»»åŠ¡å¯ä»¥æ‰§è¡Œï¼Œå¦‚æœæœ‰å°±å°†å¾®ä»»åŠ¡é˜Ÿé¦–çš„äº‹ä»¶å‹å…¥æ ˆä¸­æ‰§è¡Œã€‚å½“å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡éƒ½æ‰§è¡Œå®Œæˆåå†å»æ‰§è¡Œå®ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/theory/9.png" alt=""></p><p>Event Loop æ‰§è¡Œé¡ºåºå¦‚ä¸‹æ‰€ç¤ºï¼š</p><ul><li>é¦–å…ˆæ‰§è¡ŒåŒæ­¥ä»£ç ï¼Œè¿™å±äºå®ä»»åŠ¡</li><li>å½“æ‰§è¡Œå®Œæ‰€æœ‰åŒæ­¥ä»£ç åï¼Œæ‰§è¡Œæ ˆä¸ºç©ºï¼ŒæŸ¥è¯¢æ˜¯å¦æœ‰å¼‚æ­¥ä»£ç éœ€è¦æ‰§è¡Œ</li><li>æ‰§è¡Œæ‰€æœ‰å¾®ä»»åŠ¡</li><li>å½“æ‰§è¡Œå®Œæ‰€æœ‰å¾®ä»»åŠ¡åï¼Œå¦‚æœ‰å¿…è¦ä¼šæ¸²æŸ“é¡µé¢</li><li>ç„¶åå¼€å§‹ä¸‹ä¸€è½® Event Loopï¼Œæ‰§è¡Œå®ä»»åŠ¡ä¸­çš„å¼‚æ­¥ä»£ç </li></ul><h3 id="7-å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡åˆ†åˆ«æœ‰å“ªäº›"><a href="#7-å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡åˆ†åˆ«æœ‰å“ªäº›" class="headerlink" title="7. å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡åˆ†åˆ«æœ‰å“ªäº›"></a>7. å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡åˆ†åˆ«æœ‰å“ªäº›</h3><ul><li>å¾®ä»»åŠ¡åŒ…æ‹¬ï¼š promise çš„å›è°ƒã€node ä¸­çš„ process.nextTick ã€å¯¹ Dom å˜åŒ–ç›‘å¬çš„ MutationObserverã€‚</li><li>å®ä»»åŠ¡åŒ…æ‹¬ï¼š script è„šæœ¬çš„æ‰§è¡Œã€setTimeout ï¼ŒsetInterval ï¼ŒsetImmediate ä¸€ç±»çš„å®šæ—¶äº‹ä»¶ï¼Œè¿˜æœ‰å¦‚ I/O æ“ä½œã€UI æ¸²æŸ“ç­‰ã€‚</li></ul><h3 id="8-ä»€ä¹ˆæ˜¯æ‰§è¡Œæ ˆ"><a href="#8-ä»€ä¹ˆæ˜¯æ‰§è¡Œæ ˆ" class="headerlink" title="8. ä»€ä¹ˆæ˜¯æ‰§è¡Œæ ˆ"></a>8. ä»€ä¹ˆæ˜¯æ‰§è¡Œæ ˆ</h3><p>å¯ä»¥æŠŠæ‰§è¡Œæ ˆè®¤ä¸ºæ˜¯ä¸€ä¸ªå­˜å‚¨å‡½æ•°è°ƒç”¨çš„<strong>æ ˆç»“æ„</strong>ï¼Œéµå¾ªå…ˆè¿›åå‡ºçš„åŸåˆ™ã€‚<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="10.gif" alt=""><br>å½“å¼€å§‹æ‰§è¡Œ JS ä»£ç æ—¶ï¼Œæ ¹æ®å…ˆè¿›åå‡ºçš„åŸåˆ™ï¼Œåæ‰§è¡Œçš„å‡½æ•°ä¼šå…ˆå¼¹å‡ºæ ˆï¼Œå¯ä»¥çœ‹åˆ°ï¼Œ<code>foo</code> å‡½æ•°åæ‰§è¡Œï¼Œå½“æ‰§è¡Œå®Œæ¯•åå°±ä»æ ˆä¸­å¼¹å‡ºäº†ã€‚</p><p>å¹³æ—¶åœ¨å¼€å‘ä¸­ï¼Œå¯ä»¥åœ¨æŠ¥é”™ä¸­æ‰¾åˆ°æ‰§è¡Œæ ˆçš„ç—•è¿¹ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/theory/11.png" alt=""><br>å¯ä»¥çœ‹åˆ°æŠ¥é”™åœ¨ <code>foo</code> å‡½æ•°ï¼Œ<code>foo</code> å‡½æ•°åˆæ˜¯åœ¨ <code>bar</code> å‡½æ•°ä¸­è°ƒç”¨çš„ã€‚å½“ä½¿ç”¨é€’å½’æ—¶ï¼Œå› ä¸ºæ ˆå¯å­˜æ”¾çš„å‡½æ•°æ˜¯æœ‰<strong>é™åˆ¶</strong>çš„ï¼Œä¸€æ—¦å­˜æ”¾äº†è¿‡å¤šçš„å‡½æ•°ä¸”æ²¡æœ‰å¾—åˆ°é‡Šæ”¾çš„è¯ï¼Œå°±ä¼šå‡ºç°çˆ†æ ˆçš„é—®é¢˜</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/theory/12.png" alt=""></p><h3 id="9-Node-ä¸­çš„-Event-Loop-å’Œæµè§ˆå™¨ä¸­çš„æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿprocess-nextTick-æ‰§è¡Œé¡ºåºï¼Ÿ"><a href="#9-Node-ä¸­çš„-Event-Loop-å’Œæµè§ˆå™¨ä¸­çš„æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿprocess-nextTick-æ‰§è¡Œé¡ºåºï¼Ÿ" class="headerlink" title="9. Node ä¸­çš„ Event Loop å’Œæµè§ˆå™¨ä¸­çš„æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿprocess.nextTick æ‰§è¡Œé¡ºåºï¼Ÿ"></a>9. Node ä¸­çš„ Event Loop å’Œæµè§ˆå™¨ä¸­çš„æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿprocess.nextTick æ‰§è¡Œé¡ºåºï¼Ÿ</h3><p>Node ä¸­çš„ Event Loop å’Œæµè§ˆå™¨ä¸­çš„æ˜¯å®Œå…¨ä¸ç›¸åŒçš„ä¸œè¥¿ã€‚</p><p>Node çš„ Event Loop åˆ†ä¸º 6 ä¸ªé˜¶æ®µï¼Œå®ƒä»¬ä¼šæŒ‰ç…§<strong>é¡ºåº</strong>åå¤è¿è¡Œã€‚æ¯å½“è¿›å…¥æŸä¸€ä¸ªé˜¶æ®µçš„æ—¶å€™ï¼Œéƒ½ä¼šä»å¯¹åº”çš„å›è°ƒé˜Ÿåˆ—ä¸­å–å‡ºå‡½æ•°å»æ‰§è¡Œã€‚å½“é˜Ÿåˆ—ä¸ºç©ºæˆ–è€…æ‰§è¡Œçš„å›è°ƒå‡½æ•°æ•°é‡åˆ°è¾¾ç³»ç»Ÿè®¾å®šçš„é˜ˆå€¼ï¼Œå°±ä¼šè¿›å…¥ä¸‹ä¸€é˜¶æ®µã€‚<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/theory/13.png" alt=""></p><p>ï¼ˆ1ï¼‰<strong>Timersï¼ˆè®¡æ—¶å™¨é˜¶æ®µï¼‰</strong>ï¼šåˆæ¬¡è¿›å…¥äº‹ä»¶å¾ªç¯ï¼Œä¼šä»è®¡æ—¶å™¨é˜¶æ®µå¼€å§‹ã€‚æ­¤é˜¶æ®µä¼šåˆ¤æ–­æ˜¯å¦å­˜åœ¨è¿‡æœŸçš„è®¡æ—¶å™¨å›è°ƒï¼ˆåŒ…å« setTimeout å’Œ setIntervalï¼‰ï¼Œå¦‚æœå­˜åœ¨åˆ™ä¼šæ‰§è¡Œæ‰€æœ‰è¿‡æœŸçš„è®¡æ—¶å™¨å›è°ƒï¼Œæ‰§è¡Œå®Œæ¯•åï¼Œå¦‚æœå›è°ƒä¸­è§¦å‘äº†ç›¸åº”çš„å¾®ä»»åŠ¡ï¼Œä¼šæ¥ç€æ‰§è¡Œæ‰€æœ‰å¾®ä»»åŠ¡ï¼Œæ‰§è¡Œå®Œå¾®ä»»åŠ¡åå†è¿›å…¥ Pending callbacks é˜¶æ®µã€‚</p><p>ï¼ˆ2ï¼‰<strong>Pending callbacks</strong>ï¼šæ‰§è¡Œæ¨è¿Ÿåˆ°ä¸‹ä¸€ä¸ªå¾ªç¯è¿­ä»£çš„I / Oå›è°ƒï¼ˆç³»ç»Ÿè°ƒç”¨ç›¸å…³çš„å›è°ƒï¼‰ã€‚</p><p>ï¼ˆ3ï¼‰<strong>Idle/Prepare</strong>ï¼šä»…ä¾›å†…éƒ¨ä½¿ç”¨ã€‚</p><p>ï¼ˆ4ï¼‰<strong>Pollï¼ˆè½®è¯¢é˜¶æ®µï¼‰</strong>ï¼š</p><ul><li>å½“å›è°ƒé˜Ÿåˆ—ä¸ä¸ºç©ºæ—¶ï¼šä¼šæ‰§è¡Œå›è°ƒï¼Œè‹¥å›è°ƒä¸­è§¦å‘äº†ç›¸åº”çš„å¾®ä»»åŠ¡ï¼Œè¿™é‡Œçš„å¾®ä»»åŠ¡æ‰§è¡Œæ—¶æœºå’Œå…¶ä»–åœ°æ–¹æœ‰æ‰€ä¸åŒï¼Œä¸ä¼šç­‰åˆ°æ‰€æœ‰å›è°ƒæ‰§è¡Œå®Œæ¯•åæ‰æ‰§è¡Œï¼Œè€Œæ˜¯é’ˆå¯¹æ¯ä¸€ä¸ªå›è°ƒæ‰§è¡Œå®Œæ¯•åï¼Œå°±æ‰§è¡Œç›¸åº”å¾®ä»»åŠ¡ã€‚æ‰§è¡Œå®Œæ‰€æœ‰çš„å›è°ƒåï¼Œå˜ä¸ºä¸‹é¢çš„æƒ…å†µã€‚</li><li>å½“å›è°ƒé˜Ÿåˆ—ä¸ºç©ºæ—¶ï¼ˆæ²¡æœ‰å›è°ƒæˆ–æ‰€æœ‰å›è°ƒæ‰§è¡Œå®Œæ¯•ï¼‰ï¼šä½†å¦‚æœå­˜åœ¨æœ‰è®¡æ—¶å™¨ï¼ˆsetTimeoutã€setIntervalå’ŒsetImmediateï¼‰æ²¡æœ‰æ‰§è¡Œï¼Œä¼šç»“æŸè½®è¯¢é˜¶æ®µï¼Œè¿›å…¥ Check é˜¶æ®µã€‚å¦åˆ™ä¼šé˜»å¡å¹¶ç­‰å¾…ä»»ä½•æ­£åœ¨æ‰§è¡Œçš„I/Oæ“ä½œå®Œæˆï¼Œå¹¶é©¬ä¸Šæ‰§è¡Œç›¸åº”çš„å›è°ƒï¼Œç›´åˆ°æ‰€æœ‰å›è°ƒæ‰§è¡Œå®Œæ¯•ã€‚</li></ul><p>ï¼ˆ5ï¼‰<strong>Checkï¼ˆæŸ¥è¯¢é˜¶æ®µï¼‰</strong>ï¼šä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ setImmediate ç›¸å…³çš„å›è°ƒï¼Œå¦‚æœå­˜åœ¨åˆ™æ‰§è¡Œæ‰€æœ‰å›è°ƒï¼Œæ‰§è¡Œå®Œæ¯•åï¼Œå¦‚æœå›è°ƒä¸­è§¦å‘äº†ç›¸åº”çš„å¾®ä»»åŠ¡ï¼Œä¼šæ¥ç€æ‰§è¡Œæ‰€æœ‰å¾®ä»»åŠ¡ï¼Œæ‰§è¡Œå®Œå¾®ä»»åŠ¡åå†è¿›å…¥ Close callbacks é˜¶æ®µã€‚</p><p>ï¼ˆ6ï¼‰<strong>Close callbacks</strong>ï¼šæ‰§è¡Œä¸€äº›å…³é—­å›è°ƒï¼Œæ¯”å¦‚socket.on(â€˜closeâ€™, â€¦)ç­‰ã€‚</p><p>ä¸‹é¢æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼Œé¦–å…ˆåœ¨æœ‰äº›æƒ…å†µä¸‹ï¼Œå®šæ—¶å™¨çš„æ‰§è¡Œé¡ºåºå…¶å®æ˜¯<strong>éšæœº</strong>çš„</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'setTimeout'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token function">setImmediate</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'setImmediate'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯¹äºä»¥ä¸Šä»£ç æ¥è¯´ï¼Œ<code>setTimeout</code> å¯èƒ½æ‰§è¡Œåœ¨å‰ï¼Œä¹Ÿå¯èƒ½æ‰§è¡Œåœ¨å</p><ul><li>é¦–å…ˆ <code>setTimeout(fn, 0) === setTimeout(fn, 1)</code>ï¼Œè¿™æ˜¯ç”±æºç å†³å®šçš„</li><li>è¿›å…¥äº‹ä»¶å¾ªç¯ä¹Ÿæ˜¯éœ€è¦æˆæœ¬çš„ï¼Œå¦‚æœåœ¨å‡†å¤‡æ—¶å€™èŠ±è´¹äº†å¤§äº 1ms çš„æ—¶é—´ï¼Œé‚£ä¹ˆåœ¨ timer é˜¶æ®µå°±ä¼šç›´æ¥æ‰§è¡Œ <code>setTimeout</code> å›è°ƒ</li><li>é‚£ä¹ˆå¦‚æœå‡†å¤‡æ—¶é—´èŠ±è´¹å°äº 1msï¼Œé‚£ä¹ˆå°±æ˜¯ <code>setImmediate</code> å›è°ƒå…ˆæ‰§è¡Œäº†</li></ul><p>å½“ç„¶åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä»–ä»¬çš„æ‰§è¡Œé¡ºåºä¸€å®šæ˜¯å›ºå®šçš„ï¼Œæ¯”å¦‚ä»¥ä¸‹ä»£ç ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>fs<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>__filename<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'timeout'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>    <span class="token function">setImmediate</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'immediate'</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œ<code>setImmediate</code> æ°¸è¿œ<strong>å…ˆæ‰§è¡Œ</strong>ã€‚å› ä¸ºä¸¤ä¸ªä»£ç å†™åœ¨ IO å›è°ƒä¸­ï¼ŒIO å›è°ƒæ˜¯åœ¨ poll é˜¶æ®µæ‰§è¡Œï¼Œå½“å›è°ƒæ‰§è¡Œå®Œæ¯•åé˜Ÿåˆ—ä¸ºç©ºï¼Œå‘ç°å­˜åœ¨ <code>setImmediate</code> å›è°ƒï¼Œæ‰€ä»¥å°±ç›´æ¥è·³è½¬åˆ° check é˜¶æ®µå»æ‰§è¡Œå›è°ƒäº†ã€‚</p><p>ä¸Šé¢éƒ½æ˜¯ macrotask çš„æ‰§è¡Œæƒ…å†µï¼Œå¯¹äº microtask æ¥è¯´ï¼Œå®ƒä¼šåœ¨ä»¥ä¸Šæ¯ä¸ªé˜¶æ®µå®Œæˆå‰<strong>æ¸…ç©º</strong> microtask é˜Ÿåˆ—ï¼Œä¸‹å›¾ä¸­çš„ Tick å°±ä»£è¡¨äº† microtask<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/theory/14.png" alt=""></p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'timer21'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise1'</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯¹äºä»¥ä¸Šä»£ç æ¥è¯´ï¼Œå…¶å®å’Œæµè§ˆå™¨ä¸­çš„è¾“å‡ºæ˜¯ä¸€æ ·çš„ï¼Œmicrotask æ°¸è¿œæ‰§è¡Œåœ¨ macrotask å‰é¢ã€‚</p><p>æœ€åæ¥çœ‹ Node ä¸­çš„ <code>process.nextTick</code>ï¼Œè¿™ä¸ªå‡½æ•°å…¶å®æ˜¯ç‹¬ç«‹äº Event Loop ä¹‹å¤–çš„ï¼Œå®ƒæœ‰ä¸€ä¸ªè‡ªå·±çš„é˜Ÿåˆ—ï¼Œå½“æ¯ä¸ªé˜¶æ®µå®Œæˆåï¼Œå¦‚æœå­˜åœ¨ nextTick é˜Ÿåˆ—ï¼Œå°±ä¼š<strong>æ¸…ç©ºé˜Ÿåˆ—ä¸­çš„æ‰€æœ‰å›è°ƒå‡½æ•°</strong>ï¼Œå¹¶ä¸”ä¼˜å…ˆäºå…¶ä»– microtask æ‰§è¡Œã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'timer1'</span><span class="token punctuation">)</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'promise1'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>process<span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'nextTick'</span><span class="token punctuation">)</span> process<span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'nextTick'</span><span class="token punctuation">)</span>   process<span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'nextTick'</span><span class="token punctuation">)</span>     process<span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>       console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'nextTick'</span><span class="token punctuation">)</span>     <span class="token punctuation">}</span><span class="token punctuation">)</span>   <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯¹äºä»¥ä¸Šä»£ç ï¼Œæ°¸è¿œéƒ½æ˜¯å…ˆæŠŠ nextTick å…¨éƒ¨æ‰“å°å‡ºæ¥ã€‚</p><h3 id="10-äº‹ä»¶è§¦å‘çš„è¿‡ç¨‹æ˜¯æ€æ ·çš„"><a href="#10-äº‹ä»¶è§¦å‘çš„è¿‡ç¨‹æ˜¯æ€æ ·çš„" class="headerlink" title="10. äº‹ä»¶è§¦å‘çš„è¿‡ç¨‹æ˜¯æ€æ ·çš„"></a>10. äº‹ä»¶è§¦å‘çš„è¿‡ç¨‹æ˜¯æ€æ ·çš„</h3><p>äº‹ä»¶è§¦å‘æœ‰ä¸‰ä¸ªé˜¶æ®µï¼š</p><ul><li><code>window</code> å¾€äº‹ä»¶è§¦å‘å¤„ä¼ æ’­ï¼Œé‡åˆ°æ³¨å†Œçš„æ•è·äº‹ä»¶ä¼šè§¦å‘</li><li>ä¼ æ’­åˆ°äº‹ä»¶è§¦å‘å¤„æ—¶è§¦å‘æ³¨å†Œçš„äº‹ä»¶</li><li>ä»äº‹ä»¶è§¦å‘å¤„å¾€ <code>window</code> ä¼ æ’­ï¼Œé‡åˆ°æ³¨å†Œçš„å†’æ³¡äº‹ä»¶ä¼šè§¦å‘</li></ul><p>äº‹ä»¶è§¦å‘ä¸€èˆ¬æ¥è¯´ä¼šæŒ‰ç…§ä¸Šé¢çš„é¡ºåºè¿›è¡Œï¼Œä½†æ˜¯ä¹Ÿæœ‰ç‰¹ä¾‹ï¼Œ<strong>å¦‚æœç»™ä¸€ä¸ª **<code>body</code></strong> ä¸­çš„å­èŠ‚ç‚¹åŒæ—¶æ³¨å†Œå†’æ³¡å’Œæ•è·äº‹ä»¶ï¼Œäº‹ä»¶è§¦å‘ä¼šæŒ‰ç…§æ³¨å†Œçš„é¡ºåºæ‰§è¡Œã€‚**</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// ä»¥ä¸‹ä¼šå…ˆæ‰“å°å†’æ³¡ç„¶åæ˜¯æ•è·</span>node<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>  <span class="token string">'click'</span><span class="token punctuation">,</span>  event <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å†’æ³¡'</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token boolean">false</span><span class="token punctuation">)</span>node<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>  <span class="token string">'click'</span><span class="token punctuation">,</span>  event <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æ•è· '</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token boolean">true</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é€šå¸¸ä½¿ç”¨ <code>addEventListener</code> æ³¨å†Œäº‹ä»¶ï¼Œè¯¥å‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°å¯ä»¥æ˜¯å¸ƒå°”å€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯å¯¹è±¡ã€‚å¯¹äºå¸ƒå°”å€¼ <code>useCapture</code> å‚æ•°æ¥è¯´ï¼Œè¯¥å‚æ•°é»˜è®¤å€¼ä¸º <code>false</code> ï¼Œ<code>useCapture</code> å†³å®šäº†æ³¨å†Œçš„äº‹ä»¶æ˜¯æ•è·äº‹ä»¶è¿˜æ˜¯å†’æ³¡äº‹ä»¶ã€‚å¯¹äºå¯¹è±¡å‚æ•°æ¥è¯´ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‡ ä¸ªå±æ€§ï¼š</p><ul><li><code>capture</code>ï¼šå¸ƒå°”å€¼ï¼Œå’Œ <code>useCapture</code> ä½œç”¨ä¸€æ ·</li><li><code>once</code>ï¼šå¸ƒå°”å€¼ï¼Œå€¼ä¸º <code>true</code> è¡¨ç¤ºè¯¥å›è°ƒåªä¼šè°ƒç”¨ä¸€æ¬¡ï¼Œè°ƒç”¨åä¼šç§»é™¤ç›‘å¬</li><li><code>passive</code>ï¼šå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ°¸è¿œä¸ä¼šè°ƒç”¨ <code>preventDefault</code></li></ul><p>ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœåªå¸Œæœ›äº‹ä»¶åªè§¦å‘åœ¨ç›®æ ‡ä¸Šï¼Œè¿™æ—¶å€™å¯ä»¥ä½¿ç”¨ <code>stopPropagation</code> æ¥é˜»æ­¢äº‹ä»¶çš„è¿›ä¸€æ­¥ä¼ æ’­ã€‚é€šå¸¸è®¤ä¸º <code>stopPropagation</code> æ˜¯ç”¨æ¥é˜»æ­¢äº‹ä»¶å†’æ³¡çš„ï¼Œå…¶å®è¯¥å‡½æ•°ä¹Ÿå¯ä»¥é˜»æ­¢æ•è·äº‹ä»¶ã€‚</p><p><code>stopImmediatePropagation</code> åŒæ ·ä¹Ÿèƒ½å®ç°é˜»æ­¢äº‹ä»¶ï¼Œä½†æ˜¯è¿˜èƒ½é˜»æ­¢è¯¥äº‹ä»¶ç›®æ ‡æ‰§è¡Œåˆ«çš„æ³¨å†Œäº‹ä»¶ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript">node<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>  <span class="token string">'click'</span><span class="token punctuation">,</span>  event <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    event<span class="token punctuation">.</span><span class="token function">stopImmediatePropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å†’æ³¡'</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">// ç‚¹å‡» node åªä¼šæ‰§è¡Œä¸Šé¢çš„å‡½æ•°ï¼Œè¯¥å‡½æ•°ä¸ä¼šæ‰§è¡Œ</span>node<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>  <span class="token string">'click'</span><span class="token punctuation">,</span>  event <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'æ•è· '</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token boolean">true</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ä¹ã€æµè§ˆå™¨åƒåœ¾å›æ”¶æœºåˆ¶"><a href="#ä¹ã€æµè§ˆå™¨åƒåœ¾å›æ”¶æœºåˆ¶" class="headerlink" title="ä¹ã€æµè§ˆå™¨åƒåœ¾å›æ”¶æœºåˆ¶"></a>ä¹ã€æµè§ˆå™¨åƒåœ¾å›æ”¶æœºåˆ¶</h2><h3 id="1-V8çš„åƒåœ¾å›æ”¶æœºåˆ¶æ˜¯æ€æ ·çš„"><a href="#1-V8çš„åƒåœ¾å›æ”¶æœºåˆ¶æ˜¯æ€æ ·çš„" class="headerlink" title="1. V8çš„åƒåœ¾å›æ”¶æœºåˆ¶æ˜¯æ€æ ·çš„"></a>1. V8çš„åƒåœ¾å›æ”¶æœºåˆ¶æ˜¯æ€æ ·çš„</h3><p>V8 å®ç°äº†å‡†ç¡®å¼ GCï¼ŒGC ç®—æ³•é‡‡ç”¨äº†åˆ†ä»£å¼åƒåœ¾å›æ”¶æœºåˆ¶ã€‚å› æ­¤ï¼ŒV8 å°†å†…å­˜ï¼ˆå †ï¼‰åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€ç”Ÿä»£ä¸¤éƒ¨åˆ†ã€‚</p><p><strong>ï¼ˆ1ï¼‰æ–°ç”Ÿä»£ç®—æ³•</strong></p><p>æ–°ç”Ÿä»£ä¸­çš„å¯¹è±¡ä¸€èˆ¬å­˜æ´»æ—¶é—´è¾ƒçŸ­ï¼Œä½¿ç”¨ Scavenge GC ç®—æ³•ã€‚</p><p>åœ¨æ–°ç”Ÿä»£ç©ºé—´ä¸­ï¼Œå†…å­˜ç©ºé—´åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œåˆ†åˆ«ä¸º From ç©ºé—´å’Œ To ç©ºé—´ã€‚åœ¨è¿™ä¸¤ä¸ªç©ºé—´ä¸­ï¼Œå¿…å®šæœ‰ä¸€ä¸ªç©ºé—´æ˜¯ä½¿ç”¨çš„ï¼Œå¦ä¸€ä¸ªç©ºé—´æ˜¯ç©ºé—²çš„ã€‚æ–°åˆ†é…çš„å¯¹è±¡ä¼šè¢«æ”¾å…¥ From ç©ºé—´ä¸­ï¼Œå½“ From ç©ºé—´è¢«å æ»¡æ—¶ï¼Œæ–°ç”Ÿä»£ GC å°±ä¼šå¯åŠ¨äº†ã€‚ç®—æ³•ä¼šæ£€æŸ¥ From ç©ºé—´ä¸­å­˜æ´»çš„å¯¹è±¡å¹¶å¤åˆ¶åˆ° To ç©ºé—´ä¸­ï¼Œå¦‚æœæœ‰å¤±æ´»çš„å¯¹è±¡å°±ä¼šé”€æ¯ã€‚å½“å¤åˆ¶å®Œæˆåå°† From ç©ºé—´å’Œ To ç©ºé—´äº’æ¢ï¼Œè¿™æ · GC å°±ç»“æŸäº†ã€‚</p><p><strong>ï¼ˆ2ï¼‰è€ç”Ÿä»£ç®—æ³•</strong></p><p>è€ç”Ÿä»£ä¸­çš„å¯¹è±¡ä¸€èˆ¬å­˜æ´»æ—¶é—´è¾ƒé•¿ä¸”æ•°é‡ä¹Ÿå¤šï¼Œä½¿ç”¨äº†ä¸¤ä¸ªç®—æ³•ï¼Œåˆ†åˆ«æ˜¯æ ‡è®°æ¸…é™¤ç®—æ³•å’Œæ ‡è®°å‹ç¼©ç®—æ³•ã€‚</p><p>å…ˆæ¥è¯´ä¸‹ä»€ä¹ˆæƒ…å†µä¸‹å¯¹è±¡ä¼šå‡ºç°åœ¨è€ç”Ÿä»£ç©ºé—´ä¸­ï¼š</p><ul><li>æ–°ç”Ÿä»£ä¸­çš„å¯¹è±¡æ˜¯å¦å·²ç»ç»å†è¿‡ä¸€æ¬¡ Scavenge ç®—æ³•ï¼Œå¦‚æœç»å†è¿‡çš„è¯ï¼Œä¼šå°†å¯¹è±¡ä»æ–°ç”Ÿä»£ç©ºé—´ç§»åˆ°è€ç”Ÿä»£ç©ºé—´ä¸­ã€‚</li><li>To ç©ºé—´çš„å¯¹è±¡å æ¯”å¤§å°è¶…è¿‡ 25 %ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸ºäº†ä¸å½±å“åˆ°å†…å­˜åˆ†é…ï¼Œä¼šå°†å¯¹è±¡ä»æ–°ç”Ÿä»£ç©ºé—´ç§»åˆ°è€ç”Ÿä»£ç©ºé—´ä¸­ã€‚</li></ul><p>è€ç”Ÿä»£ä¸­çš„ç©ºé—´å¾ˆå¤æ‚ï¼Œæœ‰å¦‚ä¸‹å‡ ä¸ªç©ºé—´</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">enum</span> AllocationSpace <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// TODO(v8:7464): Actually map this space's memory as read-only.</span>  RO_SPACE<span class="token punctuation">,</span>    <span class="token comment" spellcheck="true">// ä¸å˜çš„å¯¹è±¡ç©ºé—´</span>  NEW_SPACE<span class="token punctuation">,</span>   <span class="token comment" spellcheck="true">// æ–°ç”Ÿä»£ç”¨äº GC å¤åˆ¶ç®—æ³•çš„ç©ºé—´</span>  OLD_SPACE<span class="token punctuation">,</span>   <span class="token comment" spellcheck="true">// è€ç”Ÿä»£å¸¸é©»å¯¹è±¡ç©ºé—´</span>  CODE_SPACE<span class="token punctuation">,</span>  <span class="token comment" spellcheck="true">// è€ç”Ÿä»£ä»£ç å¯¹è±¡ç©ºé—´</span>  MAP_SPACE<span class="token punctuation">,</span>   <span class="token comment" spellcheck="true">// è€ç”Ÿä»£ map å¯¹è±¡</span>  LO_SPACE<span class="token punctuation">,</span>    <span class="token comment" spellcheck="true">// è€ç”Ÿä»£å¤§ç©ºé—´å¯¹è±¡</span>  NEW_LO_SPACE<span class="token punctuation">,</span>  <span class="token comment" spellcheck="true">// æ–°ç”Ÿä»£å¤§ç©ºé—´å¯¹è±¡</span>  FIRST_SPACE <span class="token operator">=</span> RO_SPACE<span class="token punctuation">,</span>  LAST_SPACE <span class="token operator">=</span> NEW_LO_SPACE<span class="token punctuation">,</span>  FIRST_GROWABLE_PAGED_SPACE <span class="token operator">=</span> OLD_SPACE<span class="token punctuation">,</span>  LAST_GROWABLE_PAGED_SPACE <span class="token operator">=</span> MAP_SPACE<span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åœ¨è€ç”Ÿä»£ä¸­ï¼Œä»¥ä¸‹æƒ…å†µä¼šå…ˆå¯åŠ¨æ ‡è®°æ¸…é™¤ç®—æ³•ï¼š</p><ul><li>æŸä¸€ä¸ªç©ºé—´æ²¡æœ‰åˆ†å—çš„æ—¶å€™</li><li>ç©ºé—´ä¸­è¢«å¯¹è±¡è¶…è¿‡ä¸€å®šé™åˆ¶</li><li>ç©ºé—´ä¸èƒ½ä¿è¯æ–°ç”Ÿä»£ä¸­çš„å¯¹è±¡ç§»åŠ¨åˆ°è€ç”Ÿä»£ä¸­</li></ul><p>åœ¨è¿™ä¸ªé˜¶æ®µä¸­ï¼Œä¼šéå†å †ä¸­æ‰€æœ‰çš„å¯¹è±¡ï¼Œç„¶åæ ‡è®°æ´»çš„å¯¹è±¡ï¼Œåœ¨æ ‡è®°å®Œæˆåï¼Œé”€æ¯æ‰€æœ‰æ²¡æœ‰è¢«æ ‡è®°çš„å¯¹è±¡ã€‚åœ¨æ ‡è®°å¤§å‹å¯¹å†…å­˜æ—¶ï¼Œå¯èƒ½éœ€è¦å‡ ç™¾æ¯«ç§’æ‰èƒ½å®Œæˆä¸€æ¬¡æ ‡è®°ã€‚è¿™å°±ä¼šå¯¼è‡´ä¸€äº›æ€§èƒ½ä¸Šçš„é—®é¢˜ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œ2011 å¹´ï¼ŒV8 ä» stop-the-world æ ‡è®°åˆ‡æ¢åˆ°å¢é‡æ ‡å¿—ã€‚åœ¨å¢é‡æ ‡è®°æœŸé—´ï¼ŒGC å°†æ ‡è®°å·¥ä½œåˆ†è§£ä¸ºæ›´å°çš„æ¨¡å—ï¼Œå¯ä»¥è®© JS åº”ç”¨é€»è¾‘åœ¨æ¨¡å—é—´éš™æ‰§è¡Œä¸€ä¼šï¼Œä»è€Œä¸è‡³äºè®©åº”ç”¨å‡ºç°åœé¡¿æƒ…å†µã€‚ä½†åœ¨ 2018 å¹´ï¼ŒGC æŠ€æœ¯åˆæœ‰äº†ä¸€ä¸ªé‡å¤§çªç ´ï¼Œè¿™é¡¹æŠ€æœ¯åä¸ºå¹¶å‘æ ‡è®°ã€‚è¯¥æŠ€æœ¯å¯ä»¥è®© GC æ‰«æå’Œæ ‡è®°å¯¹è±¡æ—¶ï¼ŒåŒæ—¶å…è®¸ JS è¿è¡Œã€‚</p><p>æ¸…é™¤å¯¹è±¡åä¼šé€ æˆå †å†…å­˜å‡ºç°ç¢ç‰‡çš„æƒ…å†µï¼Œå½“ç¢ç‰‡è¶…è¿‡ä¸€å®šé™åˆ¶åä¼šå¯åŠ¨å‹ç¼©ç®—æ³•ã€‚åœ¨å‹ç¼©è¿‡ç¨‹ä¸­ï¼Œå°†æ´»çš„å¯¹è±¡å‘ä¸€ç«¯ç§»åŠ¨ï¼Œç›´åˆ°æ‰€æœ‰å¯¹è±¡éƒ½ç§»åŠ¨å®Œæˆç„¶åæ¸…ç†æ‰ä¸éœ€è¦çš„å†…å­˜ã€‚</p><h3 id="2-å“ªäº›æ“ä½œä¼šé€ æˆå†…å­˜æ³„æ¼ï¼Ÿ"><a href="#2-å“ªäº›æ“ä½œä¼šé€ æˆå†…å­˜æ³„æ¼ï¼Ÿ" class="headerlink" title="2. å“ªäº›æ“ä½œä¼šé€ æˆå†…å­˜æ³„æ¼ï¼Ÿ"></a>2. å“ªäº›æ“ä½œä¼šé€ æˆå†…å­˜æ³„æ¼ï¼Ÿ</h3><ul><li>ç¬¬ä¸€ç§æƒ…å†µæ˜¯ç”±äºä½¿ç”¨æœªå£°æ˜çš„å˜é‡ï¼Œè€Œæ„å¤–çš„åˆ›å»ºäº†ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œè€Œä½¿è¿™ä¸ªå˜é‡ä¸€ç›´ç•™åœ¨å†…å­˜ä¸­æ— æ³•è¢«å›æ”¶ã€‚</li><li>ç¬¬äºŒç§æƒ…å†µæ˜¯è®¾ç½®äº† setInterval å®šæ—¶å™¨ï¼Œè€Œå¿˜è®°å–æ¶ˆå®ƒï¼Œå¦‚æœå¾ªç¯å‡½æ•°æœ‰å¯¹å¤–éƒ¨å˜é‡çš„å¼•ç”¨çš„è¯ï¼Œé‚£ä¹ˆè¿™ä¸ªå˜é‡ä¼šè¢«ä¸€ç›´ç•™åœ¨å†…å­˜ä¸­ï¼Œè€Œæ— æ³•è¢«å›æ”¶ã€‚</li><li>ç¬¬ä¸‰ç§æƒ…å†µæ˜¯è·å–ä¸€ä¸ª DOM å…ƒç´ çš„å¼•ç”¨ï¼Œè€Œåé¢è¿™ä¸ªå…ƒç´ è¢«åˆ é™¤ï¼Œç”±äºæˆ‘ä»¬ä¸€ç›´ä¿ç•™äº†å¯¹è¿™ä¸ªå…ƒç´ çš„å¼•ç”¨ï¼Œæ‰€ä»¥å®ƒä¹Ÿæ— æ³•è¢«å›æ”¶ã€‚</li><li>ç¬¬å››ç§æƒ…å†µæ˜¯ä¸åˆç†çš„ä½¿ç”¨é—­åŒ…ï¼Œä»è€Œå¯¼è‡´æŸäº›å˜é‡ä¸€ç›´è¢«ç•™åœ¨å†…å­˜å½“ä¸­ã€‚</li></ul><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> æµè§ˆå™¨åŸç† </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æµè§ˆå™¨åŸç† </tag>
            
            <tag> æµè§ˆå®‰å…¨é—®é¢˜ </tag>
            
            <tag> æµè§ˆå™¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React</title>
      <link href="/2022/03/02/react/"/>
      <url>/2022/03/02/react/</url>
      
        <content type="html"><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/react/1.png" alt="Reacté¢è¯•é¢˜.png"></p><h2 id="ä¸€ã€ç»„ä»¶åŸºç¡€"><a href="#ä¸€ã€ç»„ä»¶åŸºç¡€" class="headerlink" title="ä¸€ã€ç»„ä»¶åŸºç¡€"></a>ä¸€ã€ç»„ä»¶åŸºç¡€</h2><h3 id="1-React-äº‹ä»¶æœºåˆ¶"><a href="#1-React-äº‹ä»¶æœºåˆ¶" class="headerlink" title="1. React äº‹ä»¶æœºåˆ¶"></a>1. React äº‹ä»¶æœºåˆ¶</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>div onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleClick<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span>ç‚¹æˆ‘<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>React å¹¶ä¸æ˜¯å°† click äº‹ä»¶ç»‘å®šåˆ°äº† div çš„çœŸå® DOM ä¸Šï¼Œè€Œæ˜¯åœ¨ document å¤„ç›‘å¬äº†æ‰€æœ‰çš„äº‹ä»¶ï¼Œå½“äº‹ä»¶å‘ç”Ÿå¹¶ä¸”å†’æ³¡åˆ° document å¤„çš„æ—¶å€™ï¼ŒReact å°†äº‹ä»¶å†…å®¹å°è£…å¹¶äº¤ç”±çœŸæ­£çš„å¤„ç†å‡½æ•°è¿è¡Œã€‚è¿™æ ·çš„æ–¹å¼ä¸ä»…ä»…å‡å°‘äº†å†…å­˜çš„æ¶ˆè€—ï¼Œè¿˜èƒ½åœ¨ç»„ä»¶æŒ‚åœ¨é”€æ¯æ—¶ç»Ÿä¸€è®¢é˜…å’Œç§»é™¤äº‹ä»¶ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œå†’æ³¡åˆ° document ä¸Šçš„äº‹ä»¶ä¹Ÿä¸æ˜¯åŸç”Ÿçš„æµè§ˆå™¨äº‹ä»¶ï¼Œè€Œæ˜¯ç”± react è‡ªå·±å®ç°çš„åˆæˆäº‹ä»¶ï¼ˆSyntheticEventï¼‰ã€‚å› æ­¤å¦‚æœä¸æƒ³è¦æ˜¯äº‹ä»¶å†’æ³¡çš„è¯åº”è¯¥è°ƒç”¨ event.preventDefault()æ–¹æ³•ï¼Œè€Œä¸æ˜¯è°ƒç”¨ event.stopProppagation()æ–¹æ³•ã€‚<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/react/2.png" alt="77fa6b2a59c92e160bc171f9c80783e7.jpg"><br>JSX ä¸Šå†™çš„äº‹ä»¶å¹¶æ²¡æœ‰ç»‘å®šåœ¨å¯¹åº”çš„çœŸå® DOM ä¸Šï¼Œè€Œæ˜¯é€šè¿‡äº‹ä»¶ä»£ç†çš„æ–¹å¼ï¼Œå°†æ‰€æœ‰çš„äº‹ä»¶éƒ½ç»Ÿä¸€ç»‘å®šåœ¨äº† <code>document</code> ä¸Šã€‚è¿™æ ·çš„æ–¹å¼ä¸ä»…å‡å°‘äº†å†…å­˜æ¶ˆè€—ï¼Œè¿˜èƒ½åœ¨ç»„ä»¶æŒ‚è½½é”€æ¯æ—¶ç»Ÿä¸€è®¢é˜…å’Œç§»é™¤äº‹ä»¶ã€‚</p><p>å¦å¤–å†’æ³¡åˆ° <code>document</code> ä¸Šçš„äº‹ä»¶ä¹Ÿä¸æ˜¯åŸç”Ÿæµè§ˆå™¨äº‹ä»¶ï¼Œè€Œæ˜¯ React è‡ªå·±å®ç°çš„åˆæˆäº‹ä»¶ï¼ˆSyntheticEventï¼‰ã€‚å› æ­¤æˆ‘ä»¬å¦‚æœä¸æƒ³è¦äº‹ä»¶å†’æ³¡çš„è¯ï¼Œè°ƒç”¨ <code>event.stopPropagation</code> æ˜¯æ— æ•ˆçš„ï¼Œè€Œåº”è¯¥è°ƒç”¨ <code>event.preventDefault</code>ã€‚</p><p>å®ç°åˆæˆäº‹ä»¶çš„ç›®çš„å¦‚ä¸‹ï¼š</p><ul><li>åˆæˆäº‹ä»¶é¦–å…ˆæŠ¹å¹³äº†æµè§ˆå™¨ä¹‹é—´çš„å…¼å®¹é—®é¢˜ï¼Œå¦å¤–è¿™æ˜¯ä¸€ä¸ªè·¨æµè§ˆå™¨åŸç”Ÿäº‹ä»¶åŒ…è£…å™¨ï¼Œèµ‹äºˆäº†è·¨æµè§ˆå™¨å¼€å‘çš„èƒ½åŠ›ï¼›</li><li>å¯¹äºåŸç”Ÿæµè§ˆå™¨äº‹ä»¶æ¥è¯´ï¼Œæµè§ˆå™¨ä¼šç»™ç›‘å¬å™¨åˆ›å»ºä¸€ä¸ªäº‹ä»¶å¯¹è±¡ã€‚å¦‚æœä½ æœ‰å¾ˆå¤šçš„äº‹ä»¶ç›‘å¬ï¼Œé‚£ä¹ˆå°±éœ€è¦åˆ†é…å¾ˆå¤šçš„äº‹ä»¶å¯¹è±¡ï¼Œé€ æˆé«˜é¢çš„å†…å­˜åˆ†é…é—®é¢˜ã€‚ä½†æ˜¯å¯¹äºåˆæˆäº‹ä»¶æ¥è¯´ï¼Œæœ‰ä¸€ä¸ªäº‹ä»¶æ± ä¸“é—¨æ¥ç®¡ç†å®ƒä»¬çš„åˆ›å»ºå’Œé”€æ¯ï¼Œå½“äº‹ä»¶éœ€è¦è¢«ä½¿ç”¨æ—¶ï¼Œå°±ä¼šä»æ± å­ä¸­å¤ç”¨å¯¹è±¡ï¼Œäº‹ä»¶å›è°ƒç»“æŸåï¼Œå°±ä¼šé”€æ¯äº‹ä»¶å¯¹è±¡ä¸Šçš„å±æ€§ï¼Œä»è€Œä¾¿äºä¸‹æ¬¡å¤ç”¨äº‹ä»¶å¯¹è±¡ã€‚</li></ul><h3 id="2-React-çš„äº‹ä»¶å’Œæ™®é€šçš„-HTML-äº‹ä»¶æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ"><a href="#2-React-çš„äº‹ä»¶å’Œæ™®é€šçš„-HTML-äº‹ä»¶æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ" class="headerlink" title="2. React çš„äº‹ä»¶å’Œæ™®é€šçš„ HTML äº‹ä»¶æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ"></a>2. React çš„äº‹ä»¶å’Œæ™®é€šçš„ HTML äº‹ä»¶æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ</h3><p>åŒºåˆ«ï¼š</p><ul><li>å¯¹äºäº‹ä»¶åç§°å‘½åæ–¹å¼ï¼ŒåŸç”Ÿäº‹ä»¶ä¸ºå…¨å°å†™ï¼Œreact äº‹ä»¶é‡‡ç”¨å°é©¼å³°ï¼›</li><li>å¯¹äºäº‹ä»¶å‡½æ•°å¤„ç†è¯­æ³•ï¼ŒåŸç”Ÿäº‹ä»¶ä¸ºå­—ç¬¦ä¸²ï¼Œreact äº‹ä»¶ä¸ºå‡½æ•°ï¼›</li><li>react äº‹ä»¶ä¸èƒ½é‡‡ç”¨ return false çš„æ–¹å¼æ¥é˜»æ­¢æµè§ˆå™¨çš„é»˜è®¤è¡Œä¸ºï¼Œè€Œå¿…é¡»è¦åœ°æ˜ç¡®åœ°è°ƒç”¨<code>preventDefault()</code>æ¥é˜»æ­¢é»˜è®¤è¡Œä¸ºã€‚</li></ul><p>åˆæˆäº‹ä»¶æ˜¯ react æ¨¡æ‹ŸåŸç”Ÿ DOM äº‹ä»¶æ‰€æœ‰èƒ½åŠ›çš„ä¸€ä¸ªäº‹ä»¶å¯¹è±¡ï¼Œå…¶ä¼˜ç‚¹å¦‚ä¸‹ï¼š</p><ul><li>å…¼å®¹æ‰€æœ‰æµè§ˆå™¨ï¼Œæ›´å¥½çš„è·¨å¹³å°ï¼›</li><li>å°†äº‹ä»¶ç»Ÿä¸€å­˜æ”¾åœ¨ä¸€ä¸ªæ•°ç»„ï¼Œé¿å…é¢‘ç¹çš„æ–°å¢ä¸åˆ é™¤ï¼ˆåƒåœ¾å›æ”¶ï¼‰ã€‚</li><li>æ–¹ä¾¿ react ç»Ÿä¸€ç®¡ç†å’Œäº‹åŠ¡æœºåˆ¶ã€‚</li></ul><p>äº‹ä»¶çš„æ‰§è¡Œé¡ºåºä¸ºåŸç”Ÿäº‹ä»¶å…ˆæ‰§è¡Œï¼Œåˆæˆäº‹ä»¶åæ‰§è¡Œï¼Œåˆæˆäº‹ä»¶ä¼šå†’æ³¡ç»‘å®šåˆ° document ä¸Šï¼Œæ‰€ä»¥å°½é‡é¿å…åŸç”Ÿäº‹ä»¶ä¸åˆæˆäº‹ä»¶æ··ç”¨ï¼Œå¦‚æœåŸç”Ÿäº‹ä»¶é˜»æ­¢å†’æ³¡ï¼Œå¯èƒ½ä¼šå¯¼è‡´åˆæˆäº‹ä»¶ä¸æ‰§è¡Œï¼Œå› ä¸ºéœ€è¦å†’æ³¡åˆ° document ä¸Šåˆæˆäº‹ä»¶æ‰ä¼šæ‰§è¡Œã€‚</p><h3 id="3-React-ç»„ä»¶ä¸­æ€ä¹ˆåšäº‹ä»¶ä»£ç†ï¼Ÿå®ƒçš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#3-React-ç»„ä»¶ä¸­æ€ä¹ˆåšäº‹ä»¶ä»£ç†ï¼Ÿå®ƒçš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="3. React ç»„ä»¶ä¸­æ€ä¹ˆåšäº‹ä»¶ä»£ç†ï¼Ÿå®ƒçš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"></a>3. React ç»„ä»¶ä¸­æ€ä¹ˆåšäº‹ä»¶ä»£ç†ï¼Ÿå®ƒçš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>React åŸºäº Virtual DOM å®ç°äº†ä¸€ä¸ª SyntheticEvent å±‚ï¼ˆåˆæˆäº‹ä»¶å±‚ï¼‰ï¼Œå®šä¹‰çš„äº‹ä»¶å¤„ç†å™¨ä¼šæ¥æ”¶åˆ°ä¸€ä¸ªåˆæˆäº‹ä»¶å¯¹è±¡çš„å®ä¾‹ï¼Œå®ƒç¬¦åˆ W3C æ ‡å‡†ï¼Œä¸”ä¸åŸç”Ÿçš„æµè§ˆå™¨äº‹ä»¶æ‹¥æœ‰åŒæ ·çš„æ¥å£ï¼Œæ”¯æŒå†’æ³¡æœºåˆ¶ï¼Œæ‰€æœ‰çš„äº‹ä»¶éƒ½è‡ªåŠ¨ç»‘å®šåœ¨æœ€å¤–å±‚ä¸Šã€‚</p><p>åœ¨ React åº•å±‚ï¼Œä¸»è¦å¯¹åˆæˆäº‹ä»¶åšäº†ä¸¤ä»¶äº‹ï¼š</p><ul><li><strong>äº‹ä»¶å§”æ´¾ï¼š</strong> React ä¼šæŠŠæ‰€æœ‰çš„äº‹ä»¶ç»‘å®šåˆ°ç»“æ„çš„æœ€å¤–å±‚ï¼Œä½¿ç”¨ç»Ÿä¸€çš„äº‹ä»¶ç›‘å¬å™¨ï¼Œè¿™ä¸ªäº‹ä»¶ç›‘å¬å™¨ä¸Šç»´æŒäº†ä¸€ä¸ªæ˜ å°„æ¥ä¿å­˜æ‰€æœ‰ç»„ä»¶å†…éƒ¨äº‹ä»¶ç›‘å¬å’Œå¤„ç†å‡½æ•°ã€‚</li><li><strong>è‡ªåŠ¨ç»‘å®šï¼š</strong> React ç»„ä»¶ä¸­ï¼Œæ¯ä¸ªæ–¹æ³•çš„ä¸Šä¸‹æ–‡éƒ½ä¼šæŒ‡å‘è¯¥ç»„ä»¶çš„å®ä¾‹ï¼Œå³è‡ªåŠ¨ç»‘å®š this ä¸ºå½“å‰ç»„ä»¶ã€‚</li></ul><h3 id="4-React-é«˜é˜¶ç»„ä»¶ã€Render-propsã€hooks-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œä¸ºä»€ä¹ˆè¦ä¸æ–­è¿­ä»£"><a href="#4-React-é«˜é˜¶ç»„ä»¶ã€Render-propsã€hooks-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œä¸ºä»€ä¹ˆè¦ä¸æ–­è¿­ä»£" class="headerlink" title="4. React é«˜é˜¶ç»„ä»¶ã€Render propsã€hooks æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œä¸ºä»€ä¹ˆè¦ä¸æ–­è¿­ä»£"></a>4. React é«˜é˜¶ç»„ä»¶ã€Render propsã€hooks æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œä¸ºä»€ä¹ˆè¦ä¸æ–­è¿­ä»£</h3><p>è¿™ä¸‰è€…æ˜¯ç›®å‰ react è§£å†³ä»£ç å¤ç”¨çš„ä¸»è¦æ–¹å¼ï¼š</p><ul><li>é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰æ˜¯ React ä¸­ç”¨äºå¤ç”¨ç»„ä»¶é€»è¾‘çš„ä¸€ç§é«˜çº§æŠ€å·§ã€‚HOC è‡ªèº«ä¸æ˜¯ React API çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒæ˜¯ä¸€ç§åŸºäº React çš„ç»„åˆç‰¹æ€§è€Œå½¢æˆçš„è®¾è®¡æ¨¡å¼ã€‚å…·ä½“è€Œè¨€ï¼Œé«˜é˜¶ç»„ä»¶æ˜¯å‚æ•°ä¸ºç»„ä»¶ï¼Œè¿”å›å€¼ä¸ºæ–°ç»„ä»¶çš„å‡½æ•°ã€‚</li><li>render props æ˜¯æŒ‡ä¸€ç§åœ¨ React ç»„ä»¶ä¹‹é—´ä½¿ç”¨ä¸€ä¸ªå€¼ä¸ºå‡½æ•°çš„ prop å…±äº«ä»£ç çš„ç®€å•æŠ€æœ¯ï¼Œæ›´å…·ä½“çš„è¯´ï¼Œrender prop æ˜¯ä¸€ä¸ªç”¨äºå‘ŠçŸ¥ç»„ä»¶éœ€è¦æ¸²æŸ“ä»€ä¹ˆå†…å®¹çš„å‡½æ•° propã€‚</li><li>é€šå¸¸ï¼Œrender props å’Œé«˜é˜¶ç»„ä»¶åªæ¸²æŸ“ä¸€ä¸ªå­èŠ‚ç‚¹ã€‚è®© Hook æ¥æœåŠ¡è¿™ä¸ªä½¿ç”¨åœºæ™¯æ›´åŠ ç®€å•ã€‚è¿™ä¸¤ç§æ¨¡å¼ä»æœ‰ç”¨æ­¦ä¹‹åœ°ï¼Œï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ªè™šæ‹Ÿæ»šåŠ¨æ¡ç»„ä»¶æˆ–è®¸ä¼šæœ‰ä¸€ä¸ª renderltem å±æ€§ï¼Œæˆ–æ˜¯ä¸€ä¸ªå¯è§çš„å®¹å™¨ç»„ä»¶æˆ–è®¸ä¼šæœ‰å®ƒè‡ªå·±çš„ DOM ç»“æ„ï¼‰ã€‚ä½†åœ¨å¤§éƒ¨åˆ†åœºæ™¯ä¸‹ï¼ŒHook è¶³å¤Ÿäº†ï¼Œå¹¶ä¸”èƒ½å¤Ÿå¸®åŠ©å‡å°‘åµŒå¥—ã€‚</li></ul><p><strong>ï¼ˆ1ï¼‰HOC</strong><br>å®˜æ–¹è§£é‡Š âˆ¶</p><blockquote><p>é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰æ˜¯ React ä¸­ç”¨äºå¤ç”¨ç»„ä»¶é€»è¾‘çš„ä¸€ç§é«˜çº§æŠ€å·§ã€‚HOC è‡ªèº«ä¸æ˜¯ React API çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒæ˜¯ä¸€ç§åŸºäº React çš„ç»„åˆç‰¹æ€§è€Œå½¢æˆçš„è®¾è®¡æ¨¡å¼ã€‚</p></blockquote><p>ç®€è¨€ä¹‹ï¼ŒHOC æ˜¯ä¸€ç§ç»„ä»¶çš„è®¾è®¡æ¨¡å¼ï¼ŒHOC æ¥å—ä¸€ä¸ªç»„ä»¶å’Œé¢å¤–çš„å‚æ•°ï¼ˆå¦‚æœéœ€è¦ï¼‰ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„ç»„ä»¶ã€‚HOC æ˜¯çº¯å‡½æ•°ï¼Œæ²¡æœ‰å‰¯ä½œç”¨ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// hocçš„å®šä¹‰</span><span class="token keyword">function</span> <span class="token function">withSubscription</span><span class="token punctuation">(</span>WrappedComponent<span class="token punctuation">,</span> selectData<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> React<span class="token punctuation">.</span>Component <span class="token punctuation">{</span>    <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>        data<span class="token punctuation">:</span> <span class="token function">selectData</span><span class="token punctuation">(</span>DataSource<span class="token punctuation">,</span> props<span class="token punctuation">)</span>      <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// ä¸€äº›é€šç”¨çš„é€»è¾‘å¤„ç†</span>    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token comment" spellcheck="true">// ... å¹¶ä½¿ç”¨æ–°æ•°æ®æ¸²æŸ“è¢«åŒ…è£…çš„ç»„ä»¶!</span>      <span class="token keyword">return</span> <span class="token operator">&lt;</span>WrappedComponent data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>data<span class="token punctuation">}</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// ä½¿ç”¨</span><span class="token keyword">const</span> BlogPostWithSubscription <span class="token operator">=</span> <span class="token function">withSubscription</span><span class="token punctuation">(</span>BlogPost<span class="token punctuation">,</span>  <span class="token punctuation">(</span>DataSource<span class="token punctuation">,</span> props<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> DataSource<span class="token punctuation">.</span><span class="token function">getBlogPost</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>HOC çš„ä¼˜ç¼ºç‚¹ âˆ¶</p><ul><li>ä¼˜ç‚¹ âˆ¶ é€»è¾‘æœç”¨ã€ä¸å½±å“è¢«åŒ…è£¹ç»„ä»¶çš„å†…éƒ¨é€»è¾‘ã€‚</li><li>ç¼ºç‚¹ âˆ¶ hoc ä¼ é€’ç»™è¢«åŒ…è£¹ç»„ä»¶çš„ props å®¹æ˜“å’Œè¢«åŒ…è£¹åçš„ç»„ä»¶é‡åï¼Œè¿›è€Œè¢«è¦†ç›–</li></ul><p><strong>ï¼ˆ2ï¼‰Render props</strong><br>å®˜æ–¹è§£é‡Š âˆ¶</p><blockquote><p>â€œrender propâ€æ˜¯æŒ‡ä¸€ç§åœ¨ React ç»„ä»¶ä¹‹é—´ä½¿ç”¨ä¸€ä¸ªå€¼ä¸ºå‡½æ•°çš„ prop å…±äº«ä»£ç çš„ç®€å•æŠ€æœ¯</p></blockquote><p>å…·æœ‰ render prop çš„ç»„ä»¶æ¥å—ä¸€ä¸ªè¿”å› React å…ƒç´ çš„å‡½æ•°ï¼Œå°† render çš„æ¸²æŸ“é€»è¾‘æ³¨å…¥åˆ°ç»„ä»¶å†…éƒ¨ã€‚åœ¨è¿™é‡Œï¼Œâ€renderâ€çš„å‘½åå¯ä»¥æ˜¯ä»»ä½•å…¶ä»–æœ‰æ•ˆçš„æ ‡è¯†ç¬¦ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// DataProviderç»„ä»¶å†…éƒ¨çš„æ¸²æŸ“é€»è¾‘å¦‚ä¸‹</span><span class="token keyword">class</span> <span class="token class-name">DataProvider</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Components</span> <span class="token punctuation">{</span>  state <span class="token operator">=</span> <span class="token punctuation">{</span>    name<span class="token punctuation">:</span> <span class="token string">"Tom"</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>div<span class="token operator">></span>        <span class="token operator">&lt;</span>p<span class="token operator">></span>å…±äº«æ•°æ®ç»„ä»¶è‡ªå·±å†…éƒ¨çš„æ¸²æŸ“é€»è¾‘<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>        <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">)</span><span class="token punctuation">}</span>      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// è°ƒç”¨æ–¹å¼</span><span class="token operator">&lt;</span>DataProvider render<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">&lt;</span>h1<span class="token operator">></span>Hello <span class="token punctuation">{</span>data<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç”±æ­¤å¯ä»¥çœ‹åˆ°ï¼Œrender props çš„ä¼˜ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ âˆ¶</p><ul><li>ä¼˜ç‚¹ï¼šæ•°æ®å…±äº«ã€ä»£ç å¤ç”¨ï¼Œå°†ç»„ä»¶å†…çš„ state ä½œä¸º props ä¼ é€’ç»™è°ƒç”¨è€…ï¼Œå°†æ¸²æŸ“é€»è¾‘äº¤ç»™è°ƒç”¨è€…ã€‚</li><li>ç¼ºç‚¹ï¼šæ— æ³•åœ¨ return è¯­å¥å¤–è®¿é—®æ•°æ®ã€åµŒå¥—å†™æ³•ä¸å¤Ÿä¼˜é›…</li></ul><p><strong>ï¼ˆ3ï¼‰Hooks</strong><br>å®˜æ–¹è§£é‡Š âˆ¶</p><blockquote><p>Hook æ˜¯ React 16.8 çš„æ–°å¢ç‰¹æ€§ã€‚å®ƒå¯ä»¥è®©ä½ åœ¨ä¸ç¼–å†™ class çš„æƒ…å†µä¸‹ä½¿ç”¨ state ä»¥åŠå…¶ä»–çš„ React ç‰¹æ€§ã€‚é€šè¿‡è‡ªå®šä¹‰ hookï¼Œå¯ä»¥å¤ç”¨ä»£ç é€»è¾‘ã€‚</p></blockquote><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// è‡ªå®šä¹‰ä¸€ä¸ªè·å–è®¢é˜…æ•°æ®çš„hook</span><span class="token keyword">function</span> <span class="token function">useSubscription</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> data <span class="token operator">=</span> DataSource<span class="token punctuation">.</span><span class="token function">getComments</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token punctuation">[</span>data<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//</span><span class="token keyword">function</span> <span class="token function">CommentList</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> <span class="token punctuation">{</span>data<span class="token punctuation">}</span> <span class="token operator">=</span> props<span class="token punctuation">;</span>  <span class="token keyword">const</span> <span class="token punctuation">[</span>subData<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useSubscription</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token operator">...</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// ä½¿ç”¨</span><span class="token operator">&lt;</span>CommentList data<span class="token operator">=</span><span class="token string">'hello'</span> <span class="token operator">/</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä»¥ä¸Šå¯ä»¥çœ‹å‡ºï¼Œhook è§£å†³äº† hoc çš„ prop è¦†ç›–çš„é—®é¢˜ï¼ŒåŒæ—¶ä½¿ç”¨çš„æ–¹å¼è§£å†³äº† render props çš„åµŒå¥—åœ°ç‹±çš„é—®é¢˜ã€‚hook çš„ä¼˜ç‚¹å¦‚ä¸‹ âˆ¶</p><ul><li>ä½¿ç”¨ç›´è§‚ï¼›</li><li>è§£å†³ hoc çš„ prop é‡åé—®é¢˜ï¼›</li><li>è§£å†³ render props å› å…±äº«æ•°æ® è€Œå‡ºç°åµŒå¥—åœ°ç‹±çš„é—®é¢˜ï¼›</li><li>èƒ½åœ¨ return ä¹‹å¤–ä½¿ç”¨æ•°æ®çš„é—®é¢˜ã€‚</li></ul><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šhook åªèƒ½åœ¨ç»„ä»¶é¡¶å±‚ä½¿ç”¨ï¼Œä¸å¯åœ¨åˆ†æ”¯è¯­å¥ä¸­ä½¿ç”¨ã€‚</p><p><strong>æ€»ç»“ âˆ¶</strong><br>Hocã€render props å’Œ hook éƒ½æ˜¯ä¸ºäº†è§£å†³ä»£ç å¤ç”¨çš„é—®é¢˜ï¼Œä½†æ˜¯ hoc å’Œ render props éƒ½æœ‰ç‰¹å®šçš„ä½¿ç”¨åœºæ™¯å’Œæ˜æ˜¾çš„ç¼ºç‚¹ã€‚hook æ˜¯ react16.8 æ›´æ–°çš„æ–°çš„ APIï¼Œè®©ç»„ä»¶é€»è¾‘å¤ç”¨æ›´ç®€æ´æ˜äº†ï¼ŒåŒæ—¶ä¹Ÿè§£å†³äº† hoc å’Œ render props çš„ä¸€äº›ç¼ºç‚¹ã€‚</p><h3 id="5-å¯¹-React-Fiber-çš„ç†è§£ï¼Œå®ƒè§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ"><a href="#5-å¯¹-React-Fiber-çš„ç†è§£ï¼Œå®ƒè§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ" class="headerlink" title="5. å¯¹ React-Fiber çš„ç†è§£ï¼Œå®ƒè§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ"></a>5. å¯¹ React-Fiber çš„ç†è§£ï¼Œå®ƒè§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ</h3><p>React V15 åœ¨æ¸²æŸ“æ—¶ï¼Œä¼šé€’å½’æ¯”å¯¹ VirtualDOM æ ‘ï¼Œæ‰¾å‡ºéœ€è¦å˜åŠ¨çš„èŠ‚ç‚¹ï¼Œç„¶ååŒæ­¥æ›´æ–°å®ƒä»¬ï¼Œ ä¸€æ°”å‘µæˆã€‚è¿™ä¸ªè¿‡ç¨‹æœŸé—´ï¼Œ React ä¼šå æ®æµè§ˆå™¨èµ„æºï¼Œè¿™ä¼šå¯¼è‡´ç”¨æˆ·è§¦å‘çš„äº‹ä»¶å¾—ä¸åˆ°å“åº”ï¼Œå¹¶ä¸”ä¼šå¯¼è‡´æ‰å¸§ï¼Œ<strong>å¯¼è‡´ç”¨æˆ·æ„Ÿè§‰åˆ°å¡é¡¿</strong>ã€‚</p><p>ä¸ºäº†ç»™ç”¨æˆ·åˆ¶é€ ä¸€ç§åº”ç”¨å¾ˆå¿«çš„â€œå‡è±¡â€ï¼Œä¸èƒ½è®©ä¸€ä¸ªä»»åŠ¡é•¿æœŸéœ¸å ç€èµ„æºã€‚ å¯ä»¥å°†æµè§ˆå™¨çš„æ¸²æŸ“ã€å¸ƒå±€ã€ç»˜åˆ¶ã€èµ„æºåŠ è½½(ä¾‹å¦‚ HTML è§£æ)ã€äº‹ä»¶å“åº”ã€è„šæœ¬æ‰§è¡Œè§†ä½œæ“ä½œç³»ç»Ÿçš„â€œè¿›ç¨‹â€ï¼Œéœ€è¦é€šè¿‡æŸäº›è°ƒåº¦ç­–ç•¥åˆç†åœ°åˆ†é… CPU èµ„æºï¼Œä»è€Œæé«˜æµè§ˆå™¨çš„ç”¨æˆ·å“åº”é€Ÿç‡, åŒæ—¶å…¼é¡¾ä»»åŠ¡æ‰§è¡Œæ•ˆç‡ã€‚</p><p>æ‰€ä»¥ React é€šè¿‡ Fiber æ¶æ„ï¼Œè®©è¿™ä¸ªæ‰§è¡Œè¿‡ç¨‹å˜æˆå¯è¢«ä¸­æ–­ã€‚â€œé€‚æ—¶â€åœ°è®©å‡º CPU æ‰§è¡Œæƒï¼Œé™¤äº†å¯ä»¥è®©æµè§ˆå™¨åŠæ—¶åœ°å“åº”ç”¨æˆ·çš„äº¤äº’ï¼Œè¿˜æœ‰å…¶ä»–å¥½å¤„:</p><ul><li>åˆ†æ‰¹å»¶æ—¶å¯¹ DOM è¿›è¡Œæ“ä½œï¼Œé¿å…ä¸€æ¬¡æ€§æ“ä½œå¤§é‡ DOM èŠ‚ç‚¹ï¼Œå¯ä»¥å¾—åˆ°æ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼›</li><li>ç»™æµè§ˆå™¨ä¸€ç‚¹å–˜æ¯çš„æœºä¼šï¼Œå®ƒä¼šå¯¹ä»£ç è¿›è¡Œç¼–è¯‘ä¼˜åŒ–ï¼ˆJITï¼‰åŠè¿›è¡Œçƒ­ä»£ç ä¼˜åŒ–ï¼Œæˆ–è€…å¯¹ reflow è¿›è¡Œä¿®æ­£ã€‚</li></ul><p><strong>æ ¸å¿ƒæ€æƒ³:</strong> Fiber ä¹Ÿç§°åç¨‹æˆ–è€…çº¤ç¨‹ã€‚å®ƒå’Œçº¿ç¨‹å¹¶ä¸ä¸€æ ·ï¼Œåç¨‹æœ¬èº«æ˜¯æ²¡æœ‰å¹¶å‘æˆ–è€…å¹¶è¡Œèƒ½åŠ›çš„ï¼ˆéœ€è¦é…åˆçº¿ç¨‹ï¼‰ï¼Œå®ƒåªæ˜¯ä¸€ç§æ§åˆ¶æµç¨‹çš„è®©å‡ºæœºåˆ¶ã€‚è®©å‡º CPU çš„æ‰§è¡Œæƒï¼Œè®© CPU èƒ½åœ¨è¿™æ®µæ—¶é—´æ‰§è¡Œå…¶ä»–çš„æ“ä½œã€‚æ¸²æŸ“çš„è¿‡ç¨‹å¯ä»¥è¢«ä¸­æ–­ï¼Œå¯ä»¥å°†æ§åˆ¶æƒäº¤å›æµè§ˆå™¨ï¼Œè®©ä½ç»™é«˜ä¼˜å…ˆçº§çš„ä»»åŠ¡ï¼Œæµè§ˆå™¨ç©ºé—²åå†æ¢å¤æ¸²æŸ“ã€‚</p><h3 id="6-React-Component-å’Œ-React-PureComponent-çš„åŒºåˆ«"><a href="#6-React-Component-å’Œ-React-PureComponent-çš„åŒºåˆ«" class="headerlink" title="6. React.Component å’Œ React.PureComponent çš„åŒºåˆ«"></a>6. React.Component å’Œ React.PureComponent çš„åŒºåˆ«</h3><p>PureComponent è¡¨ç¤ºä¸€ä¸ªçº¯ç»„ä»¶ï¼Œå¯ä»¥ç”¨æ¥ä¼˜åŒ– React ç¨‹åºï¼Œå‡å°‘ render å‡½æ•°æ‰§è¡Œçš„æ¬¡æ•°ï¼Œä»è€Œæé«˜ç»„ä»¶çš„æ€§èƒ½ã€‚</p><p>åœ¨ React ä¸­ï¼Œå½“ prop æˆ–è€… state å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¯ä»¥é€šè¿‡åœ¨ shouldComponentUpdate ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸­æ‰§è¡Œ return false æ¥é˜»æ­¢é¡µé¢çš„æ›´æ–°ï¼Œä»è€Œå‡å°‘ä¸å¿…è¦çš„ render æ‰§è¡Œã€‚React.PureComponent ä¼šè‡ªåŠ¨æ‰§è¡Œ  shouldComponentUpdateã€‚</p><p>ä¸è¿‡ï¼ŒpureComponent ä¸­çš„ shouldComponentUpdate()  è¿›è¡Œçš„æ˜¯<strong>æµ…æ¯”è¾ƒ</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœæ˜¯å¼•ç”¨æ•°æ®ç±»å‹çš„æ•°æ®ï¼Œåªä¼šæ¯”è¾ƒä¸æ˜¯åŒä¸€ä¸ªåœ°å€ï¼Œè€Œä¸ä¼šæ¯”è¾ƒè¿™ä¸ªåœ°å€é‡Œé¢çš„æ•°æ®æ˜¯å¦ä¸€è‡´ã€‚æµ…æ¯”è¾ƒä¼šå¿½ç•¥å±æ€§å’Œæˆ–çŠ¶æ€çªå˜æƒ…å†µï¼Œå…¶å®ä¹Ÿå°±æ˜¯æ•°æ®å¼•ç”¨æŒ‡é’ˆæ²¡æœ‰å˜åŒ–ï¼Œè€Œæ•°æ®å‘ç”Ÿæ”¹å˜çš„æ—¶å€™ render æ˜¯ä¸ä¼šæ‰§è¡Œçš„ã€‚å¦‚æœéœ€è¦é‡æ–°æ¸²æŸ“é‚£ä¹ˆå°±éœ€è¦é‡æ–°å¼€è¾Ÿç©ºé—´å¼•ç”¨æ•°æ®ã€‚PureComponent ä¸€èˆ¬ä¼šç”¨åœ¨ä¸€äº›çº¯å±•ç¤ºç»„ä»¶ä¸Šã€‚</p><p>ä½¿ç”¨ pureComponent çš„<strong>å¥½å¤„</strong>ï¼šå½“ç»„ä»¶æ›´æ–°æ—¶ï¼Œå¦‚æœç»„ä»¶çš„ props æˆ–è€… state éƒ½æ²¡æœ‰æ”¹å˜ï¼Œrender å‡½æ•°å°±ä¸ä¼šè§¦å‘ã€‚çœå»è™šæ‹Ÿ DOM çš„ç”Ÿæˆå’Œå¯¹æ¯”è¿‡ç¨‹ï¼Œè¾¾åˆ°æå‡æ€§èƒ½çš„ç›®çš„ã€‚è¿™æ˜¯å› ä¸º react è‡ªåŠ¨åšäº†ä¸€å±‚æµ…æ¯”è¾ƒã€‚</p><h3 id="7-Component-Element-Instance-ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«å’Œè”ç³»ï¼Ÿ"><a href="#7-Component-Element-Instance-ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«å’Œè”ç³»ï¼Ÿ" class="headerlink" title="7. Component, Element, Instance ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«å’Œè”ç³»ï¼Ÿ"></a>7. Component, Element, Instance ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«å’Œè”ç³»ï¼Ÿ</h3><ul><li><strong>å…ƒç´ ï¼š</strong> ä¸€ä¸ªå…ƒç´ <code>element</code>æ˜¯ä¸€ä¸ªæ™®é€šå¯¹è±¡(plain object)ï¼Œæè¿°äº†å¯¹äºä¸€ä¸ª DOM èŠ‚ç‚¹æˆ–è€…å…¶ä»–ç»„ä»¶<code>component</code>ï¼Œä½ æƒ³è®©å®ƒåœ¨å±å¹•ä¸Šå‘ˆç°æˆä»€ä¹ˆæ ·å­ã€‚å…ƒç´ <code>element</code>å¯ä»¥åœ¨å®ƒçš„å±æ€§<code>props</code>ä¸­åŒ…å«å…¶ä»–å…ƒç´ (è¯‘æ³¨:ç”¨äºå½¢æˆå…ƒç´ æ ‘)ã€‚åˆ›å»ºä¸€ä¸ª React å…ƒç´ <code>element</code>æˆæœ¬å¾ˆä½ã€‚å…ƒç´ <code>element</code>åˆ›å»ºä¹‹åæ˜¯ä¸å¯å˜çš„ã€‚</li><li><strong>ç»„ä»¶ï¼š</strong> ä¸€ä¸ªç»„ä»¶<code>component</code>å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼å£°æ˜ã€‚å¯ä»¥æ˜¯å¸¦æœ‰ä¸€ä¸ª<code>render()</code>æ–¹æ³•çš„ç±»ï¼Œç®€å•ç‚¹ä¹Ÿå¯ä»¥å®šä¹‰ä¸ºä¸€ä¸ªå‡½æ•°ã€‚è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œå®ƒéƒ½æŠŠå±æ€§<code>props</code>ä½œä¸ºè¾“å…¥ï¼ŒæŠŠè¿”å›çš„ä¸€æ£µå…ƒç´ æ ‘ä½œä¸ºè¾“å‡ºã€‚</li><li><strong>å®ä¾‹ï¼š</strong> ä¸€ä¸ªå®ä¾‹<code>instance</code>æ˜¯ä½ åœ¨æ‰€å†™çš„ç»„ä»¶ç±»<code>component class</code>ä¸­ä½¿ç”¨å…³é”®å­—<code>this</code>æ‰€æŒ‡å‘çš„ä¸œè¥¿(è¯‘æ³¨:ç»„ä»¶å®ä¾‹)ã€‚å®ƒç”¨æ¥å­˜å‚¨æœ¬åœ°çŠ¶æ€å’Œå“åº”ç”Ÿå‘½å‘¨æœŸäº‹ä»¶å¾ˆæœ‰ç”¨ã€‚</li></ul><p>å‡½æ•°å¼ç»„ä»¶(<code>Functional component</code>)æ ¹æœ¬æ²¡æœ‰å®ä¾‹<code>instance</code>ã€‚ç±»ç»„ä»¶(<code>Class component</code>)æœ‰å®ä¾‹<code>instance</code>ï¼Œä½†æ˜¯æ°¸è¿œä¹Ÿä¸éœ€è¦ç›´æ¥åˆ›å»ºä¸€ä¸ªç»„ä»¶çš„å®ä¾‹ï¼Œå› ä¸º React å¸®æˆ‘ä»¬åšäº†è¿™äº›ã€‚</p><h3 id="8-React-createClass-å’Œ-extends-Component-çš„åŒºåˆ«æœ‰å“ªäº›ï¼Ÿ"><a href="#8-React-createClass-å’Œ-extends-Component-çš„åŒºåˆ«æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="8. React.createClass å’Œ extends Component çš„åŒºåˆ«æœ‰å“ªäº›ï¼Ÿ"></a>8. React.createClass å’Œ extends Component çš„åŒºåˆ«æœ‰å“ªäº›ï¼Ÿ</h3><p>React.createClass å’Œ extends Component çš„ bai åŒºåˆ«ä¸»è¦åœ¨äºï¼š</p><p><strong>ï¼ˆ1ï¼‰è¯­æ³•åŒºåˆ«</strong></p><ul><li>createClass æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå·¥å‚å‡½æ•°ï¼Œextends çš„æ–¹å¼æ›´åŠ æ¥è¿‘æœ€æ–°çš„ ES6 è§„èŒƒçš„ class å†™æ³•ã€‚ä¸¤ç§æ–¹å¼åœ¨è¯­æ³•ä¸Šçš„å·®åˆ«ä¸»è¦ä½“ç°åœ¨æ–¹æ³•çš„å®šä¹‰å’Œé™æ€å±æ€§çš„å£°æ˜ä¸Šã€‚</li><li>createClass æ–¹å¼çš„æ–¹æ³•å®šä¹‰ä½¿ç”¨é€—å·ï¼Œéš”å¼€ï¼Œå› ä¸º creatClass æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¼ é€’ç»™å®ƒçš„æ˜¯ä¸€ä¸ª Objectï¼›è€Œ class çš„æ–¹å¼å®šä¹‰æ–¹æ³•æ—¶åŠ¡å¿…è°¨è®°ä¸è¦ä½¿ç”¨é€—å·éš”å¼€ï¼Œè¿™æ˜¯ ES6 class çš„è¯­æ³•è§„èŒƒã€‚</li></ul><p><strong>ï¼ˆ2ï¼‰propType å’Œ getDefaultProps</strong></p><ul><li>React.createClassï¼šé€šè¿‡ proTypes å¯¹è±¡å’Œ getDefaultProps()æ–¹æ³•æ¥è®¾ç½®å’Œè·å– props.</li><li>React.Componentï¼šé€šè¿‡è®¾ç½®ä¸¤ä¸ªå±æ€§ propTypes å’Œ defaultProps</li></ul><p><strong>ï¼ˆ3ï¼‰çŠ¶æ€çš„åŒºåˆ«</strong></p><ul><li>React.createClassï¼šé€šè¿‡ getInitialState()æ–¹æ³•è¿”å›ä¸€ä¸ªåŒ…å«åˆå§‹å€¼çš„å¯¹è±¡</li><li>React.Componentï¼šé€šè¿‡ constructor è®¾ç½®åˆå§‹çŠ¶æ€</li></ul><p><strong>ï¼ˆ4ï¼‰this åŒºåˆ«</strong></p><ul><li>React.createClassï¼šä¼šæ­£ç¡®ç»‘å®š this</li><li>React.Componentï¼šç”±äºä½¿ç”¨äº† ES6ï¼Œè¿™é‡Œä¼šæœ‰äº›å¾®ä¸åŒï¼Œå±æ€§å¹¶ä¸ä¼šè‡ªåŠ¨ç»‘å®šåˆ° React ç±»çš„å®ä¾‹ä¸Šã€‚</li></ul><p><strong>ï¼ˆ5ï¼‰Mixins</strong></p><ul><li>React.createClassï¼šä½¿ç”¨ React.createClass çš„è¯ï¼Œå¯ä»¥åœ¨åˆ›å»ºç»„ä»¶æ—¶æ·»åŠ ä¸€ä¸ªå«åš mixins çš„å±æ€§ï¼Œå¹¶å°†å¯ä¾›æ··åˆçš„ç±»çš„é›†åˆä»¥æ•°ç»„çš„å½¢å¼èµ‹ç»™ mixinsã€‚</li><li>å¦‚æœä½¿ç”¨ ES6 çš„æ–¹å¼æ¥åˆ›å»ºç»„ä»¶ï¼Œé‚£ä¹ˆ <code>React mixins</code> çš„ç‰¹æ€§å°†ä¸èƒ½è¢«ä½¿ç”¨äº†ã€‚</li></ul><h3 id="9-React-é«˜é˜¶ç»„ä»¶æ˜¯ä»€ä¹ˆï¼Œå’Œæ™®é€šç»„ä»¶æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œé€‚ç”¨ä»€ä¹ˆåœºæ™¯"><a href="#9-React-é«˜é˜¶ç»„ä»¶æ˜¯ä»€ä¹ˆï¼Œå’Œæ™®é€šç»„ä»¶æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œé€‚ç”¨ä»€ä¹ˆåœºæ™¯" class="headerlink" title="9. React é«˜é˜¶ç»„ä»¶æ˜¯ä»€ä¹ˆï¼Œå’Œæ™®é€šç»„ä»¶æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œé€‚ç”¨ä»€ä¹ˆåœºæ™¯"></a>9. React é«˜é˜¶ç»„ä»¶æ˜¯ä»€ä¹ˆï¼Œå’Œæ™®é€šç»„ä»¶æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œé€‚ç”¨ä»€ä¹ˆåœºæ™¯</h3><p>å®˜æ–¹è§£é‡Š âˆ¶</p><blockquote><p>é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰æ˜¯ React ä¸­ç”¨äºå¤ç”¨ç»„ä»¶é€»è¾‘çš„ä¸€ç§é«˜çº§æŠ€å·§ã€‚HOC è‡ªèº«ä¸æ˜¯ React API çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒæ˜¯ä¸€ç§åŸºäº React çš„ç»„åˆç‰¹æ€§è€Œå½¢æˆçš„è®¾è®¡æ¨¡å¼ã€‚</p></blockquote><p>é«˜é˜¶ç»„ä»¶ï¼ˆHOCï¼‰å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¸”è¯¥å‡½æ•°æ¥å—ä¸€ä¸ªç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„ç»„ä»¶ï¼Œå®ƒåªæ˜¯ä¸€ç§ç»„ä»¶çš„è®¾è®¡æ¨¡å¼ï¼Œè¿™ç§è®¾è®¡æ¨¡å¼æ˜¯ç”± react è‡ªèº«çš„ç»„åˆæ€§è´¨å¿…ç„¶äº§ç”Ÿçš„ã€‚æˆ‘ä»¬å°†å®ƒä»¬ç§°ä¸ºçº¯ç»„ä»¶ï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥æ¥å—ä»»ä½•åŠ¨æ€æä¾›çš„å­ç»„ä»¶ï¼Œä½†å®ƒä»¬ä¸ä¼šä¿®æ”¹æˆ–å¤åˆ¶å…¶è¾“å…¥ç»„ä»¶ä¸­çš„ä»»ä½•è¡Œä¸ºã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// hocçš„å®šä¹‰</span><span class="token keyword">function</span> <span class="token function">withSubscription</span><span class="token punctuation">(</span>WrappedComponent<span class="token punctuation">,</span> selectData<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> React<span class="token punctuation">.</span>Component <span class="token punctuation">{</span>    <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>        data<span class="token punctuation">:</span> <span class="token function">selectData</span><span class="token punctuation">(</span>DataSource<span class="token punctuation">,</span> props<span class="token punctuation">)</span>      <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// ä¸€äº›é€šç”¨çš„é€»è¾‘å¤„ç†</span>    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token comment" spellcheck="true">// ... å¹¶ä½¿ç”¨æ–°æ•°æ®æ¸²æŸ“è¢«åŒ…è£…çš„ç»„ä»¶!</span>      <span class="token keyword">return</span> <span class="token operator">&lt;</span>WrappedComponent data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>data<span class="token punctuation">}</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// ä½¿ç”¨</span><span class="token keyword">const</span> BlogPostWithSubscription <span class="token operator">=</span> <span class="token function">withSubscription</span><span class="token punctuation">(</span>BlogPost<span class="token punctuation">,</span>  <span class="token punctuation">(</span>DataSource<span class="token punctuation">,</span> props<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> DataSource<span class="token punctuation">.</span><span class="token function">getBlogPost</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>1ï¼‰HOC çš„ä¼˜ç¼ºç‚¹</strong></p><ul><li>ä¼˜ç‚¹ âˆ¶ é€»è¾‘æœç”¨ã€ä¸å½±å“è¢«åŒ…è£¹ç»„ä»¶çš„å†…éƒ¨é€»è¾‘ã€‚</li><li>ç¼ºç‚¹ âˆ¶hoc ä¼ é€’ç»™è¢«åŒ…è£¹ç»„ä»¶çš„ props å®¹æ˜“å’Œè¢«åŒ…è£¹åçš„ç»„ä»¶é‡åï¼Œè¿›è€Œè¢«è¦†ç›–</li></ul><p><strong>2ï¼‰é€‚ç”¨åœºæ™¯</strong></p><ul><li>ä»£ç å¤ç”¨ï¼Œé€»è¾‘æŠ½è±¡</li><li>æ¸²æŸ“åŠ«æŒ</li><li>State æŠ½è±¡å’Œæ›´æ”¹</li><li>Props æ›´æ”¹</li></ul><p><strong>3ï¼‰å…·ä½“åº”ç”¨ä¾‹å­</strong></p><ul><li><strong>æƒé™æ§åˆ¶ï¼š</strong> åˆ©ç”¨é«˜é˜¶ç»„ä»¶çš„ <strong>æ¡ä»¶æ¸²æŸ“</strong> ç‰¹æ€§å¯ä»¥å¯¹é¡µé¢è¿›è¡Œæƒé™æ§åˆ¶ï¼Œæƒé™æ§åˆ¶ä¸€èˆ¬åˆ†ä¸ºä¸¤ä¸ªç»´åº¦ï¼šé¡µé¢çº§åˆ«å’Œ é¡µé¢å…ƒç´ çº§åˆ«</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// HOC.js</span><span class="token keyword">function</span> <span class="token function">withAdminAuth</span><span class="token punctuation">(</span>WrappedComponent<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> React<span class="token punctuation">.</span>Component <span class="token punctuation">{</span>        state <span class="token operator">=</span> <span class="token punctuation">{</span>            isAdmin<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>        <span class="token punctuation">}</span>        <span class="token keyword">async</span> <span class="token function">UNSAFE_componentWillMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">const</span> currentRole <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getCurrentUserRole</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>                isAdmin<span class="token punctuation">:</span> currentRole <span class="token operator">===</span> <span class="token string">'Admin'</span><span class="token punctuation">,</span>            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>isAdmin<span class="token punctuation">)</span> <span class="token punctuation">{</span>                <span class="token keyword">return</span> <span class="token operator">&lt;</span>WrappedComponent <span class="token punctuation">{</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>                <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>div<span class="token operator">></span>æ‚¨æ²¡æœ‰æƒé™æŸ¥çœ‹è¯¥é¡µé¢ï¼Œè¯·è”ç³»ç®¡ç†å‘˜ï¼<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// pages/page-a.js</span><span class="token keyword">class</span> <span class="token class-name">PageA</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>    <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// something here...</span>    <span class="token punctuation">}</span>    <span class="token function">UNSAFE_componentWillMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// fetching data</span>    <span class="token punctuation">}</span>    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// render page with data</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">withAdminAuth</span><span class="token punctuation">(</span>PageA<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// pages/page-b.js</span><span class="token keyword">class</span> <span class="token class-name">PageB</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>    <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// something here...</span>        <span class="token punctuation">}</span>    <span class="token function">UNSAFE_componentWillMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// fetching data</span>    <span class="token punctuation">}</span>    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// render page with data</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">withAdminAuth</span><span class="token punctuation">(</span>PageB<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>ç»„ä»¶æ¸²æŸ“æ€§èƒ½è¿½è¸ªï¼š</strong> å€ŸåŠ©çˆ¶ç»„ä»¶å­ç»„ä»¶ç”Ÿå‘½å‘¨æœŸè§„åˆ™æ•è·å­ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼Œå¯ä»¥æ–¹ä¾¿çš„å¯¹æŸä¸ªç»„ä»¶çš„æ¸²æŸ“æ—¶é—´è¿›è¡Œè®°å½• âˆ¶</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">Home</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token operator">&lt;</span>h1<span class="token operator">></span>Hello World<span class="token punctuation">.</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">withTiming</span><span class="token punctuation">(</span>WrappedComponent<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> WrappedComponent <span class="token punctuation">{</span>    <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>start <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>end <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">UNSAFE_componentWillMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">super</span><span class="token punctuation">.</span>componentWillMount <span class="token operator">&amp;&amp;</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">componentWillMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>start <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">super</span><span class="token punctuation">.</span>componentDidMount <span class="token operator">&amp;&amp;</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">this</span><span class="token punctuation">.</span>end <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>        <span class="token template-string"><span class="token string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>WrappedComponent<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> ç»„ä»¶æ¸²æŸ“æ—¶é—´ä¸º </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>end <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span>start<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> ms`</span></span>      <span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">withTiming</span><span class="token punctuation">(</span>Home<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨æ„ï¼šwithTiming æ˜¯åˆ©ç”¨ åå‘ç»§æ‰¿ å®ç°çš„ä¸€ä¸ªé«˜é˜¶ç»„ä»¶ï¼ŒåŠŸèƒ½æ˜¯è®¡ç®—è¢«åŒ…è£¹ç»„ä»¶ï¼ˆè¿™é‡Œæ˜¯ Home ç»„ä»¶ï¼‰çš„æ¸²æŸ“æ—¶é—´ã€‚</p><ul><li><strong>é¡µé¢å¤ç”¨</strong></li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> withFetching <span class="token operator">=</span> fetching <span class="token operator">=</span><span class="token operator">></span> WrappedComponent <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> React<span class="token punctuation">.</span>Component <span class="token punctuation">{</span>        state <span class="token operator">=</span> <span class="token punctuation">{</span>            data<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token punctuation">}</span>        <span class="token keyword">async</span> <span class="token function">UNSAFE_componentWillMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetching</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>                data<span class="token punctuation">,</span>            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">return</span> <span class="token operator">&lt;</span>WrappedComponent data<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>data<span class="token punctuation">}</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// pages/page-a.js</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">withFetching</span><span class="token punctuation">(</span><span class="token function">fetching</span><span class="token punctuation">(</span><span class="token string">'science-fiction'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span>MovieList<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// pages/page-b.js</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">withFetching</span><span class="token punctuation">(</span><span class="token function">fetching</span><span class="token punctuation">(</span><span class="token string">'action'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span>MovieList<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// pages/page-other.js</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">withFetching</span><span class="token punctuation">(</span><span class="token function">fetching</span><span class="token punctuation">(</span><span class="token string">'some-other-type'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span>MovieList<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="10-å¯¹-componentWillReceiveProps-çš„ç†è§£"><a href="#10-å¯¹-componentWillReceiveProps-çš„ç†è§£" class="headerlink" title="10. å¯¹ componentWillReceiveProps çš„ç†è§£"></a>10. å¯¹ componentWillReceiveProps çš„ç†è§£</h3><p>è¯¥æ–¹æ³•å½“<code>props</code>å‘ç”Ÿå˜åŒ–æ—¶æ‰§è¡Œï¼Œåˆå§‹åŒ–<code>render</code>æ—¶ä¸æ‰§è¡Œï¼Œåœ¨è¿™ä¸ªå›è°ƒå‡½æ•°é‡Œé¢ï¼Œä½ å¯ä»¥æ ¹æ®å±æ€§çš„å˜åŒ–ï¼Œé€šè¿‡è°ƒç”¨<code>this.setState()</code>æ¥æ›´æ–°ä½ çš„ç»„ä»¶çŠ¶æ€ï¼Œæ—§çš„å±æ€§è¿˜æ˜¯å¯ä»¥é€šè¿‡<code>this.props</code>æ¥è·å–,è¿™é‡Œè°ƒç”¨æ›´æ–°çŠ¶æ€æ˜¯å®‰å…¨çš„ï¼Œå¹¶ä¸ä¼šè§¦å‘é¢å¤–çš„<code>render</code>è°ƒç”¨ã€‚</p><p><strong>ä½¿ç”¨å¥½å¤„ï¼š</strong> åœ¨è¿™ä¸ªç”Ÿå‘½å‘¨æœŸä¸­ï¼Œå¯ä»¥åœ¨å­ç»„ä»¶çš„ render å‡½æ•°æ‰§è¡Œå‰è·å–æ–°çš„ propsï¼Œä»è€Œæ›´æ–°å­ç»„ä»¶è‡ªå·±çš„ stateã€‚  å¯ä»¥å°†æ•°æ®è¯·æ±‚æ”¾åœ¨è¿™é‡Œè¿›è¡Œæ‰§è¡Œï¼Œéœ€è¦ä¼ çš„å‚æ•°åˆ™ä» componentWillReceiveProps(nextProps)ä¸­è·å–ã€‚è€Œä¸å¿…å°†æ‰€æœ‰çš„è¯·æ±‚éƒ½æ”¾åœ¨çˆ¶ç»„ä»¶ä¸­ã€‚äºæ˜¯è¯¥è¯·æ±‚åªä¼šåœ¨è¯¥ç»„ä»¶æ¸²æŸ“æ—¶æ‰ä¼šå‘å‡ºï¼Œä»è€Œå‡è½»è¯·æ±‚è´Ÿæ‹…ã€‚</p><p>componentWillReceiveProps åœ¨åˆå§‹åŒ– render çš„æ—¶å€™ä¸ä¼šæ‰§è¡Œï¼Œå®ƒä¼šåœ¨ Component æ¥å—åˆ°æ–°çš„çŠ¶æ€(Props)æ—¶è¢«è§¦å‘ï¼Œä¸€èˆ¬ç”¨äºçˆ¶ç»„ä»¶çŠ¶æ€æ›´æ–°æ—¶å­ç»„ä»¶çš„é‡æ–°æ¸²æŸ“ã€‚</p><h3 id="11-å“ªäº›æ–¹æ³•ä¼šè§¦å‘-React-é‡æ–°æ¸²æŸ“ï¼Ÿé‡æ–°æ¸²æŸ“-render-ä¼šåšäº›ä»€ä¹ˆï¼Ÿ"><a href="#11-å“ªäº›æ–¹æ³•ä¼šè§¦å‘-React-é‡æ–°æ¸²æŸ“ï¼Ÿé‡æ–°æ¸²æŸ“-render-ä¼šåšäº›ä»€ä¹ˆï¼Ÿ" class="headerlink" title="11. å“ªäº›æ–¹æ³•ä¼šè§¦å‘ React é‡æ–°æ¸²æŸ“ï¼Ÿé‡æ–°æ¸²æŸ“ render ä¼šåšäº›ä»€ä¹ˆï¼Ÿ"></a>11. å“ªäº›æ–¹æ³•ä¼šè§¦å‘ React é‡æ–°æ¸²æŸ“ï¼Ÿé‡æ–°æ¸²æŸ“ render ä¼šåšäº›ä»€ä¹ˆï¼Ÿ</h3><p><strong>ï¼ˆ1ï¼‰å“ªäº›æ–¹æ³•ä¼šè§¦å‘ react é‡æ–°æ¸²æŸ“?</strong></p><ul><li><strong>setStateï¼ˆï¼‰æ–¹æ³•è¢«è°ƒç”¨</strong></li></ul><p>setState æ˜¯ React ä¸­æœ€å¸¸ç”¨çš„å‘½ä»¤ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œæ‰§è¡Œ setState ä¼šè§¦å‘ renderã€‚ä½†æ˜¯è¿™é‡Œæœ‰ä¸ªç‚¹å€¼å¾—å…³æ³¨ï¼Œæ‰§è¡Œ setState çš„æ—¶å€™ä¸ä¸€å®šä¼šé‡æ–°æ¸²æŸ“ã€‚å½“ setState ä¼ å…¥ null æ—¶ï¼Œå¹¶ä¸ä¼šè§¦å‘ renderã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  state <span class="token operator">=</span> <span class="token punctuation">{</span>    a<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"render"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>React<span class="token punctuation">.</span>Fragement<span class="token operator">></span>        <span class="token operator">&lt;</span>p<span class="token operator">></span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>a<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span>        <span class="token operator">&lt;</span>button          onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> a<span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// è¿™é‡Œå¹¶æ²¡æœ‰æ”¹å˜ a çš„å€¼</span>          <span class="token punctuation">}</span><span class="token punctuation">}</span>        <span class="token operator">></span>          Click me        <span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span>        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span>setState <span class="token keyword">null</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span>        <span class="token operator">&lt;</span>Child <span class="token operator">/</span><span class="token operator">></span>      <span class="token operator">&lt;</span><span class="token operator">/</span>React<span class="token punctuation">.</span>Fragement<span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>çˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“</strong></li></ul><p>åªè¦çˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“äº†ï¼Œå³ä½¿ä¼ å…¥å­ç»„ä»¶çš„ props æœªå‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆå­ç»„ä»¶ä¹Ÿä¼šé‡æ–°æ¸²æŸ“ï¼Œè¿›è€Œè§¦å‘ render</p><p><strong>ï¼ˆ2ï¼‰é‡æ–°æ¸²æŸ“ render ä¼šåšäº›ä»€ä¹ˆ?</strong></p><ul><li>ä¼šå¯¹æ–°æ—§ VNode è¿›è¡Œå¯¹æ¯”ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„ Diff ç®—æ³•ã€‚</li><li>å¯¹æ–°æ—§ä¸¤æ£µæ ‘è¿›è¡Œä¸€ä¸ªæ·±åº¦ä¼˜å…ˆéå†ï¼Œè¿™æ ·æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½ä¼šä¸€ä¸ªæ ‡è®°ï¼Œåœ¨åˆ°æ·±åº¦éå†çš„æ—¶å€™ï¼Œæ¯éå†åˆ°ä¸€å’Œä¸ªèŠ‚ç‚¹ï¼Œå°±æŠŠè¯¥èŠ‚ç‚¹å’Œæ–°çš„èŠ‚ç‚¹æ ‘è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æœæœ‰å·®å¼‚å°±æ”¾åˆ°ä¸€ä¸ªå¯¹è±¡é‡Œé¢</li><li>éå†å·®å¼‚å¯¹è±¡ï¼Œæ ¹æ®å·®å¼‚çš„ç±»å‹ï¼Œæ ¹æ®å¯¹åº”å¯¹è§„åˆ™æ›´æ–° VNode</li></ul><p>React çš„å¤„ç† render çš„åŸºæœ¬æ€ç»´æ¨¡å¼æ˜¯æ¯æ¬¡ä¸€æœ‰å˜åŠ¨å°±ä¼šå»é‡æ–°æ¸²æŸ“æ•´ä¸ªåº”ç”¨ã€‚åœ¨ Virtual DOM æ²¡æœ‰å‡ºç°ä¹‹å‰ï¼Œæœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯ç›´æ¥è°ƒç”¨ innerHTMLã€‚Virtual DOM å‰å®³çš„åœ°æ–¹å¹¶ä¸æ˜¯è¯´å®ƒæ¯”ç›´æ¥æ“ä½œ DOM å¿«ï¼Œè€Œæ˜¯è¯´ä¸ç®¡æ•°æ®æ€ä¹ˆå˜ï¼Œéƒ½ä¼šå°½é‡ä»¥æœ€å°çš„ä»£ä»·å»æ›´æ–° DOMã€‚React å°† render å‡½æ•°è¿”å›çš„è™šæ‹Ÿ DOM æ ‘ä¸è€çš„è¿›è¡Œæ¯”è¾ƒï¼Œä»è€Œç¡®å®š DOM è¦ä¸è¦æ›´æ–°ã€æ€ä¹ˆæ›´æ–°ã€‚å½“ DOM æ ‘å¾ˆå¤§æ—¶ï¼Œéå†ä¸¤æ£µæ ‘è¿›è¡Œå„ç§æ¯”å¯¹è¿˜æ˜¯ç›¸å½“è€—æ€§èƒ½çš„ï¼Œç‰¹åˆ«æ˜¯åœ¨é¡¶å±‚ setState ä¸€ä¸ªå¾®å°çš„ä¿®æ”¹ï¼Œé»˜è®¤ä¼šå»éå†æ•´æ£µæ ‘ã€‚å°½ç®¡ React ä½¿ç”¨é«˜åº¦ä¼˜åŒ–çš„ Diff ç®—æ³•ï¼Œä½†æ˜¯è¿™ä¸ªè¿‡ç¨‹ä»ç„¶ä¼šæŸè€—æ€§èƒ½.</p><h3 id="12-React-å¦‚ä½•åˆ¤æ–­ä»€ä¹ˆæ—¶å€™é‡æ–°æ¸²æŸ“ç»„ä»¶ï¼Ÿ"><a href="#12-React-å¦‚ä½•åˆ¤æ–­ä»€ä¹ˆæ—¶å€™é‡æ–°æ¸²æŸ“ç»„ä»¶ï¼Ÿ" class="headerlink" title="12. React å¦‚ä½•åˆ¤æ–­ä»€ä¹ˆæ—¶å€™é‡æ–°æ¸²æŸ“ç»„ä»¶ï¼Ÿ"></a>12. React å¦‚ä½•åˆ¤æ–­ä»€ä¹ˆæ—¶å€™é‡æ–°æ¸²æŸ“ç»„ä»¶ï¼Ÿ</h3><p>ç»„ä»¶çŠ¶æ€çš„æ”¹å˜å¯ä»¥å› ä¸º<code>props</code>çš„æ”¹å˜ï¼Œæˆ–è€…ç›´æ¥é€šè¿‡<code>setState</code>æ–¹æ³•æ”¹å˜ã€‚ç»„ä»¶è·å¾—æ–°çš„çŠ¶æ€ï¼Œç„¶å React å†³å®šæ˜¯å¦åº”è¯¥é‡æ–°æ¸²æŸ“ç»„ä»¶ã€‚åªè¦ç»„ä»¶çš„ state å‘ç”Ÿå˜åŒ–ï¼ŒReact å°±ä¼šå¯¹ç»„ä»¶è¿›è¡Œé‡æ–°æ¸²æŸ“ã€‚è¿™æ˜¯å› ä¸º React ä¸­çš„<code>shouldComponentUpdate</code>æ–¹æ³•é»˜è®¤è¿”å›<code>true</code>ï¼Œè¿™å°±æ˜¯å¯¼è‡´æ¯æ¬¡æ›´æ–°éƒ½é‡æ–°æ¸²æŸ“çš„åŸå› ã€‚</p><p>å½“ React å°†è¦æ¸²æŸ“ç»„ä»¶æ—¶ä¼šæ‰§è¡Œ<code>shouldComponentUpdate</code>æ–¹æ³•æ¥çœ‹å®ƒæ˜¯å¦è¿”å›<code>true</code>ï¼ˆç»„ä»¶åº”è¯¥æ›´æ–°ï¼Œä¹Ÿå°±æ˜¯é‡æ–°æ¸²æŸ“ï¼‰ã€‚æ‰€ä»¥éœ€è¦é‡å†™<code>shouldComponentUpdate</code>æ–¹æ³•è®©å®ƒæ ¹æ®æƒ…å†µè¿”å›<code>true</code>æˆ–è€…<code>false</code>æ¥å‘Šè¯‰ React ä»€ä¹ˆæ—¶å€™é‡æ–°æ¸²æŸ“ä»€ä¹ˆæ—¶å€™è·³è¿‡é‡æ–°æ¸²æŸ“ã€‚</p><h3 id="13-React-å£°æ˜ç»„ä»¶æœ‰å“ªå‡ ç§æ–¹æ³•ï¼Œæœ‰ä»€ä¹ˆä¸åŒï¼Ÿ"><a href="#13-React-å£°æ˜ç»„ä»¶æœ‰å“ªå‡ ç§æ–¹æ³•ï¼Œæœ‰ä»€ä¹ˆä¸åŒï¼Ÿ" class="headerlink" title="13. React å£°æ˜ç»„ä»¶æœ‰å“ªå‡ ç§æ–¹æ³•ï¼Œæœ‰ä»€ä¹ˆä¸åŒï¼Ÿ"></a>13. React å£°æ˜ç»„ä»¶æœ‰å“ªå‡ ç§æ–¹æ³•ï¼Œæœ‰ä»€ä¹ˆä¸åŒï¼Ÿ</h3><p>React å£°æ˜ç»„ä»¶çš„ä¸‰ç§æ–¹å¼ï¼š</p><ul><li>å‡½æ•°å¼å®šä¹‰çš„<code>æ— çŠ¶æ€ç»„ä»¶</code></li><li>ES5 åŸç”Ÿæ–¹å¼<code>React.createClass</code>å®šä¹‰çš„ç»„ä»¶</li><li>ES6 å½¢å¼çš„<code>extends React.Component</code>å®šä¹‰çš„ç»„ä»¶</li></ul><p><strong>ï¼ˆ1ï¼‰æ— çŠ¶æ€å‡½æ•°å¼ç»„ä»¶</strong><br>å®ƒæ˜¯ä¸ºäº†åˆ›å»ºçº¯å±•ç¤ºç»„ä»¶ï¼Œè¿™ç§ç»„ä»¶åªè´Ÿè´£æ ¹æ®ä¼ å…¥çš„ props æ¥å±•ç¤ºï¼Œä¸æ¶‰åŠåˆ° state çŠ¶æ€çš„æ“ä½œ<br>ç»„ä»¶ä¸ä¼šè¢«å®ä¾‹åŒ–ï¼Œæ•´ä½“æ¸²æŸ“æ€§èƒ½å¾—åˆ°æå‡ï¼Œä¸èƒ½è®¿é—® this å¯¹è±¡ï¼Œä¸èƒ½è®¿é—®ç”Ÿå‘½å‘¨æœŸçš„æ–¹æ³•</p><p><strong>ï¼ˆ2ï¼‰ES5 åŸç”Ÿæ–¹å¼ React.createClass // RFC</strong><br>React.createClass ä¼šè‡ªç»‘å®šå‡½æ•°æ–¹æ³•ï¼Œå¯¼è‡´ä¸å¿…è¦çš„æ€§èƒ½å¼€é”€ï¼Œå¢åŠ ä»£ç è¿‡æ—¶çš„å¯èƒ½æ€§ã€‚</p><p><strong>ï¼ˆ3ï¼‰E6 ç»§æ‰¿å½¢å¼ React.Component // RCC</strong><br>ç›®å‰æä¸ºæ¨èçš„åˆ›å»ºæœ‰çŠ¶æ€ç»„ä»¶çš„æ–¹å¼ï¼Œæœ€ç»ˆä¼šå–ä»£ React.createClass å½¢å¼ï¼›ç›¸å¯¹äº React.createClass å¯ä»¥æ›´å¥½å®ç°ä»£ç å¤ç”¨ã€‚</p><p><strong>æ— çŠ¶æ€ç»„ä»¶ç›¸å¯¹äºäºåè€…çš„åŒºåˆ«ï¼š</strong><br>ä¸æ— çŠ¶æ€ç»„ä»¶ç›¸æ¯”ï¼ŒReact.createClass å’Œ React.Component éƒ½æ˜¯åˆ›å»ºæœ‰çŠ¶æ€çš„ç»„ä»¶ï¼Œè¿™äº›ç»„ä»¶æ˜¯è¦è¢«å®ä¾‹åŒ–çš„ï¼Œå¹¶ä¸”å¯ä»¥è®¿é—®ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚</p><p><strong>React.createClass ä¸ React.Component åŒºåˆ«ï¼š</strong></p><p><strong>â‘  å‡½æ•° this è‡ªç»‘å®š</strong></p><ul><li>React.createClass åˆ›å»ºçš„ç»„ä»¶ï¼Œå…¶æ¯ä¸€ä¸ªæˆå‘˜å‡½æ•°çš„ this éƒ½æœ‰ React è‡ªåŠ¨ç»‘å®šï¼Œå‡½æ•°ä¸­çš„ this ä¼šè¢«æ­£ç¡®è®¾ç½®ã€‚</li><li>React.Component åˆ›å»ºçš„ç»„ä»¶ï¼Œå…¶æˆå‘˜å‡½æ•°ä¸ä¼šè‡ªåŠ¨ç»‘å®š thisï¼Œéœ€è¦å¼€å‘è€…æ‰‹åŠ¨ç»‘å®šï¼Œå¦åˆ™ this ä¸èƒ½è·å–å½“å‰ç»„ä»¶å®ä¾‹å¯¹è±¡ã€‚</li></ul><p><strong>â‘¡ ç»„ä»¶å±æ€§ç±»å‹ propTypes åŠå…¶é»˜è®¤ props å±æ€§ defaultProps é…ç½®ä¸åŒ</strong></p><ul><li>React.createClass åœ¨åˆ›å»ºç»„ä»¶æ—¶ï¼Œæœ‰å…³ç»„ä»¶ props çš„å±æ€§ç±»å‹åŠç»„ä»¶é»˜è®¤çš„å±æ€§ä¼šä½œä¸ºç»„ä»¶å®ä¾‹çš„å±æ€§æ¥é…ç½®ï¼Œå…¶ä¸­ defaultProps æ˜¯ä½¿ç”¨ getDefaultProps çš„æ–¹æ³•æ¥è·å–é»˜è®¤ç»„ä»¶å±æ€§çš„</li><li>React.Component åœ¨åˆ›å»ºç»„ä»¶æ—¶é…ç½®è¿™ä¸¤ä¸ªå¯¹åº”ä¿¡æ¯æ—¶ï¼Œä»–ä»¬æ˜¯ä½œä¸ºç»„ä»¶ç±»çš„å±æ€§ï¼Œä¸æ˜¯ç»„ä»¶å®ä¾‹çš„å±æ€§ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„ç±»çš„é™æ€å±æ€§æ¥é…ç½®çš„ã€‚</li></ul><p><strong>â‘¢ ç»„ä»¶åˆå§‹çŠ¶æ€ state çš„é…ç½®ä¸åŒ</strong></p><ul><li>React.createClass åˆ›å»ºçš„ç»„ä»¶ï¼Œå…¶çŠ¶æ€ state æ˜¯é€šè¿‡ getInitialState æ–¹æ³•æ¥é…ç½®ç»„ä»¶ç›¸å…³çš„çŠ¶æ€ï¼›</li><li>React.Component åˆ›å»ºçš„ç»„ä»¶ï¼Œå…¶çŠ¶æ€ state æ˜¯åœ¨ constructor ä¸­åƒåˆå§‹åŒ–ç»„ä»¶å±æ€§ä¸€æ ·å£°æ˜çš„ã€‚</li></ul><h3 id="14-å¯¹æœ‰çŠ¶æ€ç»„ä»¶å’Œæ— çŠ¶æ€ç»„ä»¶çš„ç†è§£åŠä½¿ç”¨åœºæ™¯"><a href="#14-å¯¹æœ‰çŠ¶æ€ç»„ä»¶å’Œæ— çŠ¶æ€ç»„ä»¶çš„ç†è§£åŠä½¿ç”¨åœºæ™¯" class="headerlink" title="14. å¯¹æœ‰çŠ¶æ€ç»„ä»¶å’Œæ— çŠ¶æ€ç»„ä»¶çš„ç†è§£åŠä½¿ç”¨åœºæ™¯"></a>14. å¯¹æœ‰çŠ¶æ€ç»„ä»¶å’Œæ— çŠ¶æ€ç»„ä»¶çš„ç†è§£åŠä½¿ç”¨åœºæ™¯</h3><p><strong>ï¼ˆ1ï¼‰æœ‰çŠ¶æ€ç»„ä»¶</strong></p><p><strong>ç‰¹ç‚¹ï¼š</strong></p><ul><li>æ˜¯ç±»ç»„ä»¶</li><li>æœ‰ç»§æ‰¿</li><li>å¯ä»¥ä½¿ç”¨ this</li><li>å¯ä»¥ä½¿ç”¨ react çš„ç”Ÿå‘½å‘¨æœŸ</li><li>ä½¿ç”¨è¾ƒå¤šï¼Œå®¹æ˜“é¢‘ç¹è§¦å‘ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°ï¼Œå½±å“æ€§èƒ½</li><li>å†…éƒ¨ä½¿ç”¨ stateï¼Œç»´æŠ¤è‡ªèº«çŠ¶æ€çš„å˜åŒ–ï¼Œæœ‰çŠ¶æ€ç»„ä»¶æ ¹æ®å¤–éƒ¨ç»„ä»¶ä¼ å…¥çš„ props å’Œè‡ªèº«çš„ state è¿›è¡Œæ¸²æŸ“ã€‚</li></ul><p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p><ul><li>éœ€è¦ä½¿ç”¨åˆ°çŠ¶æ€çš„ã€‚</li><li>éœ€è¦ä½¿ç”¨çŠ¶æ€æ“ä½œç»„ä»¶çš„ï¼ˆæ— çŠ¶æ€ç»„ä»¶çš„ä¹Ÿå¯ä»¥å®ç°æ–°ç‰ˆæœ¬ react hooks ä¹Ÿå¯å®ç°ï¼‰</li></ul><p><strong>æ€»ç»“ï¼š</strong><br>ç±»ç»„ä»¶å¯ä»¥ç»´æŠ¤è‡ªèº«çš„çŠ¶æ€å˜é‡ï¼Œå³ç»„ä»¶çš„ state ï¼Œç±»ç»„ä»¶è¿˜æœ‰ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œå¯ä»¥è®©å¼€å‘è€…èƒ½å¤Ÿåœ¨ç»„ä»¶çš„ä¸åŒé˜¶æ®µï¼ˆæŒ‚è½½ã€æ›´æ–°ã€å¸è½½ï¼‰ï¼Œå¯¹ç»„ä»¶åšæ›´å¤šçš„æ§åˆ¶ã€‚ç±»ç»„ä»¶åˆ™æ—¢å¯ä»¥å……å½“æ— çŠ¶æ€ç»„ä»¶ï¼Œä¹Ÿå¯ä»¥å……å½“æœ‰çŠ¶æ€ç»„ä»¶ã€‚å½“ä¸€ä¸ªç±»ç»„ä»¶ä¸éœ€è¦ç®¡ç†è‡ªèº«çŠ¶æ€æ—¶ï¼Œä¹Ÿå¯ç§°ä¸ºæ— çŠ¶æ€ç»„ä»¶ã€‚</p><p><strong>ï¼ˆ2ï¼‰æ— çŠ¶æ€ç»„ä»¶</strong><br><strong>ç‰¹ç‚¹ï¼š</strong></p><ul><li>ä¸ä¾èµ–è‡ªèº«çš„çŠ¶æ€ state</li><li>å¯ä»¥æ˜¯ç±»ç»„ä»¶æˆ–è€…å‡½æ•°ç»„ä»¶ã€‚</li><li>å¯ä»¥å®Œå…¨é¿å…ä½¿ç”¨ this å…³é”®å­—ã€‚ï¼ˆç”±äºä½¿ç”¨çš„æ˜¯ç®­å¤´å‡½æ•°äº‹ä»¶æ— éœ€ç»‘å®šï¼‰</li><li>æœ‰æ›´é«˜çš„æ€§èƒ½ã€‚å½“ä¸éœ€è¦ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸé’©å­æ—¶ï¼Œåº”è¯¥é¦–å…ˆä½¿ç”¨æ— çŠ¶æ€å‡½æ•°ç»„ä»¶</li><li>ç»„ä»¶å†…éƒ¨ä¸ç»´æŠ¤ state ï¼Œåªæ ¹æ®å¤–éƒ¨ç»„ä»¶ä¼ å…¥çš„ props è¿›è¡Œæ¸²æŸ“çš„ç»„ä»¶ï¼Œå½“ props æ”¹å˜æ—¶ï¼Œç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚</li></ul><p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p><ul><li>ç»„ä»¶ä¸éœ€è¦ç®¡ç† stateï¼Œçº¯å±•ç¤º</li></ul><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>ç®€åŒ–ä»£ç ã€ä¸“æ³¨äº render</li><li>ç»„ä»¶ä¸éœ€è¦è¢«å®ä¾‹åŒ–ï¼Œæ— ç”Ÿå‘½å‘¨æœŸï¼Œæå‡æ€§èƒ½ã€‚ è¾“å‡ºï¼ˆæ¸²æŸ“ï¼‰åªå–å†³äºè¾“å…¥ï¼ˆå±æ€§ï¼‰ï¼Œæ— å‰¯ä½œç”¨</li><li>è§†å›¾å’Œæ•°æ®çš„è§£è€¦åˆ†ç¦»</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>æ— æ³•ä½¿ç”¨ ref</li><li>æ— ç”Ÿå‘½å‘¨æœŸæ–¹æ³•</li><li>æ— æ³•æ§åˆ¶ç»„ä»¶çš„é‡æ¸²æŸ“ï¼Œå› ä¸ºæ— æ³•ä½¿ç”¨ shouldComponentUpdate æ–¹æ³•ï¼Œå½“ç»„ä»¶æ¥å—åˆ°æ–°çš„å±æ€§æ—¶åˆ™ä¼šé‡æ¸²æŸ“</li></ul><p><strong>æ€»ç»“ï¼š</strong><br>ç»„ä»¶å†…éƒ¨çŠ¶æ€ä¸”ä¸å¤–éƒ¨æ— å…³çš„ç»„ä»¶ï¼Œå¯ä»¥è€ƒè™‘ç”¨çŠ¶æ€ç»„ä»¶ï¼Œè¿™æ ·çŠ¶æ€æ ‘å°±ä¸ä¼šè¿‡äºå¤æ‚ï¼Œæ˜“äºç†è§£å’Œç®¡ç†ã€‚å½“ä¸€ä¸ªç»„ä»¶ä¸éœ€è¦ç®¡ç†è‡ªèº«çŠ¶æ€æ—¶ï¼Œä¹Ÿå°±æ˜¯æ— çŠ¶æ€ç»„ä»¶ï¼Œåº”è¯¥ä¼˜å…ˆè®¾è®¡ä¸ºå‡½æ•°ç»„ä»¶ã€‚æ¯”å¦‚è‡ªå®šä¹‰çš„ <code>&lt;Button/&gt;</code>ã€ <code>&lt;Input /&gt;</code> ç­‰ç»„ä»¶ã€‚</p><h3 id="15-å¯¹-React-ä¸­-Fragment-çš„ç†è§£ï¼Œå®ƒçš„ä½¿ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#15-å¯¹-React-ä¸­-Fragment-çš„ç†è§£ï¼Œå®ƒçš„ä½¿ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="15. å¯¹ React ä¸­ Fragment çš„ç†è§£ï¼Œå®ƒçš„ä½¿ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ"></a>15. å¯¹ React ä¸­ Fragment çš„ç†è§£ï¼Œå®ƒçš„ä½¿ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>åœ¨ React ä¸­ï¼Œç»„ä»¶è¿”å›çš„å…ƒç´ åªèƒ½æœ‰ä¸€ä¸ªæ ¹å…ƒç´ ã€‚ä¸ºäº†ä¸æ·»åŠ å¤šä½™çš„ DOM èŠ‚ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Fragment æ ‡ç­¾æ¥åŒ…è£¹æ‰€æœ‰çš„å…ƒç´ ï¼ŒFragment æ ‡ç­¾ä¸ä¼šæ¸²æŸ“å‡ºä»»ä½•å…ƒç´ ã€‚React å®˜æ–¹å¯¹ Fragment çš„è§£é‡Šï¼š</p><blockquote><p>React ä¸­çš„ä¸€ä¸ªå¸¸è§æ¨¡å¼æ˜¯ä¸€ä¸ªç»„ä»¶è¿”å›å¤šä¸ªå…ƒç´ ã€‚Fragments å…è®¸ä½ å°†å­åˆ—è¡¨åˆ†ç»„ï¼Œè€Œæ— éœ€å‘ DOM æ·»åŠ é¢å¤–èŠ‚ç‚¹ã€‚</p></blockquote><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> Fragment <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token comment" spellcheck="true">// ä¸€èˆ¬å½¢å¼</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token operator">&lt;</span>React<span class="token punctuation">.</span>Fragment<span class="token operator">></span>      <span class="token operator">&lt;</span>ChildA <span class="token operator">/</span><span class="token operator">></span>      <span class="token operator">&lt;</span>ChildB <span class="token operator">/</span><span class="token operator">></span>      <span class="token operator">&lt;</span>ChildC <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span>React<span class="token punctuation">.</span>Fragment<span class="token operator">></span>  <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// ä¹Ÿå¯ä»¥å†™æˆä»¥ä¸‹å½¢å¼</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token operator">&lt;</span><span class="token operator">></span>      <span class="token operator">&lt;</span>ChildA <span class="token operator">/</span><span class="token operator">></span>      <span class="token operator">&lt;</span>ChildB <span class="token operator">/</span><span class="token operator">></span>      <span class="token operator">&lt;</span>ChildC <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">></span>  <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="16-React-å¦‚ä½•è·å–ç»„ä»¶å¯¹åº”çš„-DOM-å…ƒç´ ï¼Ÿ"><a href="#16-React-å¦‚ä½•è·å–ç»„ä»¶å¯¹åº”çš„-DOM-å…ƒç´ ï¼Ÿ" class="headerlink" title="16. React å¦‚ä½•è·å–ç»„ä»¶å¯¹åº”çš„ DOM å…ƒç´ ï¼Ÿ"></a>16. React å¦‚ä½•è·å–ç»„ä»¶å¯¹åº”çš„ DOM å…ƒç´ ï¼Ÿ</h3><p>å¯ä»¥ç”¨ ref æ¥è·å–æŸä¸ªå­èŠ‚ç‚¹çš„å®ä¾‹ï¼Œç„¶åé€šè¿‡å½“å‰ class ç»„ä»¶å®ä¾‹çš„ä¸€äº›ç‰¹å®šå±æ€§æ¥ç›´æ¥è·å–å­èŠ‚ç‚¹å®ä¾‹ã€‚ref æœ‰ä¸‰ç§å®ç°æ–¹æ³•:</p><ul><li><strong>å­—ç¬¦ä¸²æ ¼å¼</strong>ï¼šå­—ç¬¦ä¸²æ ¼å¼ï¼Œè¿™æ˜¯ React16 ç‰ˆæœ¬ä¹‹å‰ç”¨å¾—æœ€å¤šçš„ï¼Œä¾‹å¦‚ï¼š<code>&lt;p ref="info"&gt;span&lt;/p&gt;</code></li><li><strong>å‡½æ•°æ ¼å¼</strong>ï¼šref å¯¹åº”ä¸€ä¸ªæ–¹æ³•ï¼Œè¯¥æ–¹æ³•æœ‰ä¸€ä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯å¯¹åº”çš„èŠ‚ç‚¹å®ä¾‹ï¼Œä¾‹å¦‚ï¼š<code>&lt;p ref={ele =&gt; this.info = ele}&gt;&lt;/p&gt;</code></li><li><strong>createRef æ–¹æ³•</strong>ï¼šReact 16 æä¾›çš„ä¸€ä¸ª APIï¼Œä½¿ç”¨ React.createRef()æ¥å®ç°</li></ul><h3 id="17-React-ä¸­å¯ä»¥åœ¨-render-è®¿é—®-refs-å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ"><a href="#17-React-ä¸­å¯ä»¥åœ¨-render-è®¿é—®-refs-å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ" class="headerlink" title="17. React ä¸­å¯ä»¥åœ¨ render è®¿é—® refs å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ"></a>17. React ä¸­å¯ä»¥åœ¨ render è®¿é—® refs å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</h3><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span><span class="token operator">></span>  <span class="token operator">&lt;</span>span id<span class="token operator">=</span><span class="token string">"name"</span> ref<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>spanRef<span class="token punctuation">}</span><span class="token operator">></span>    <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>title<span class="token punctuation">}</span>  <span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span>  <span class="token operator">&lt;</span>span<span class="token operator">></span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>spanRef<span class="token punctuation">.</span>current <span class="token operator">?</span> <span class="token string">"æœ‰å€¼"</span> <span class="token punctuation">:</span> <span class="token string">"æ— å€¼"</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸å¯ä»¥ï¼Œrender é˜¶æ®µ DOM è¿˜æ²¡æœ‰ç”Ÿæˆï¼Œæ— æ³•è·å– DOMã€‚DOM çš„è·å–éœ€è¦åœ¨ pre-commit é˜¶æ®µå’Œ commit é˜¶æ®µï¼š<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/react/3.png" alt="image.png"></p><h3 id="18-å¯¹-React-çš„æ’æ§½-Portals-çš„ç†è§£ï¼Œå¦‚ä½•ä½¿ç”¨ï¼Œæœ‰å“ªäº›ä½¿ç”¨åœºæ™¯"><a href="#18-å¯¹-React-çš„æ’æ§½-Portals-çš„ç†è§£ï¼Œå¦‚ä½•ä½¿ç”¨ï¼Œæœ‰å“ªäº›ä½¿ç”¨åœºæ™¯" class="headerlink" title="18. å¯¹ React çš„æ’æ§½(Portals)çš„ç†è§£ï¼Œå¦‚ä½•ä½¿ç”¨ï¼Œæœ‰å“ªäº›ä½¿ç”¨åœºæ™¯"></a>18. å¯¹ React çš„æ’æ§½(Portals)çš„ç†è§£ï¼Œå¦‚ä½•ä½¿ç”¨ï¼Œæœ‰å“ªäº›ä½¿ç”¨åœºæ™¯</h3><p>React å®˜æ–¹å¯¹ Portals çš„å®šä¹‰ï¼š</p><blockquote><p>Portal æä¾›äº†ä¸€ç§å°†å­èŠ‚ç‚¹æ¸²æŸ“åˆ°å­˜åœ¨äºçˆ¶ç»„ä»¶ä»¥å¤–çš„ DOM èŠ‚ç‚¹çš„ä¼˜ç§€çš„æ–¹æ¡ˆ</p></blockquote><p>Portals æ˜¯ React 16 æä¾›çš„å®˜æ–¹è§£å†³æ–¹æ¡ˆï¼Œä½¿å¾—ç»„ä»¶å¯ä»¥è„±ç¦»çˆ¶ç»„ä»¶å±‚çº§æŒ‚è½½åœ¨ DOM æ ‘çš„ä»»ä½•ä½ç½®ã€‚é€šä¿—æ¥è®²ï¼Œå°±æ˜¯æˆ‘ä»¬ render ä¸€ä¸ªç»„ä»¶ï¼Œä½†è¿™ä¸ªç»„ä»¶çš„ DOM ç»“æ„å¹¶ä¸åœ¨æœ¬ç»„ä»¶å†…ã€‚</p><p>Portals è¯­æ³•å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript">ReactDOM<span class="token punctuation">.</span><span class="token function">createPortal</span><span class="token punctuation">(</span>child<span class="token punctuation">,</span> container<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>ç¬¬ä¸€ä¸ªå‚æ•° child æ˜¯å¯æ¸²æŸ“çš„ React å­é¡¹ï¼Œæ¯”å¦‚å…ƒç´ ï¼Œå­—ç¬¦ä¸²æˆ–è€…ç‰‡æ®µç­‰;</li><li>ç¬¬äºŒä¸ªå‚æ•° container æ˜¯ä¸€ä¸ª DOM å…ƒç´ ã€‚</li></ul><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç»„ä»¶çš„ render å‡½æ•°è¿”å›çš„å…ƒç´ ä¼šè¢«æŒ‚è½½åœ¨å®ƒçš„çˆ¶çº§ç»„ä»¶ä¸Šï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> DemoComponent <span class="token keyword">from</span> <span class="token string">'./DemoComponent'</span><span class="token punctuation">;</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// DemoComponentå…ƒç´ ä¼šè¢«æŒ‚è½½åœ¨idä¸ºparentçš„divçš„å…ƒç´ ä¸Š</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"parent"</span><span class="token operator">></span>        <span class="token operator">&lt;</span>DemoComponent <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>  <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶è€Œï¼Œæœ‰äº›å…ƒç´ éœ€è¦è¢«æŒ‚è½½åœ¨æ›´é«˜å±‚çº§çš„ä½ç½®ã€‚æœ€å…¸å‹çš„åº”ç”¨åœºæ™¯ï¼šå½“çˆ¶ç»„ä»¶å…·æœ‰<code>overflow: hidden</code>æˆ–è€…<code>z-index</code>çš„æ ·å¼è®¾ç½®æ—¶ï¼Œç»„ä»¶æœ‰å¯èƒ½è¢«å…¶ä»–å…ƒç´ é®æŒ¡ï¼Œè¿™æ—¶å°±å¯ä»¥è€ƒè™‘è¦ä¸è¦ä½¿ç”¨ Portal ä½¿ç»„ä»¶çš„æŒ‚è½½è„±ç¦»çˆ¶ç»„ä»¶ã€‚ä¾‹å¦‚ï¼šå¯¹è¯æ¡†ï¼Œæ¨¡æ€çª—ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> DemoComponent <span class="token keyword">from</span> <span class="token string">'./DemoComponent'</span><span class="token punctuation">;</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// DemoComponentå…ƒç´ ä¼šè¢«æŒ‚è½½åœ¨idä¸ºparentçš„divçš„å…ƒç´ ä¸Š</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"parent"</span><span class="token operator">></span>        <span class="token operator">&lt;</span>DemoComponent <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>  <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="19-åœ¨-React-ä¸­å¦‚ä½•é¿å…ä¸å¿…è¦çš„-renderï¼Ÿ"><a href="#19-åœ¨-React-ä¸­å¦‚ä½•é¿å…ä¸å¿…è¦çš„-renderï¼Ÿ" class="headerlink" title="19. åœ¨ React ä¸­å¦‚ä½•é¿å…ä¸å¿…è¦çš„ renderï¼Ÿ"></a>19. åœ¨ React ä¸­å¦‚ä½•é¿å…ä¸å¿…è¦çš„ renderï¼Ÿ</h3><p>React åŸºäºè™šæ‹Ÿ DOM å’Œé«˜æ•ˆ Diff ç®—æ³•çš„å®Œç¾é…åˆï¼Œå®ç°äº†å¯¹ DOM æœ€å°ç²’åº¦çš„æ›´æ–°ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒReact å¯¹ DOM çš„æ¸²æŸ“æ•ˆç‡è¶³ä»¥ä¸šåŠ¡æ—¥å¸¸ã€‚ä½†åœ¨ä¸ªåˆ«å¤æ‚ä¸šåŠ¡åœºæ™¯ä¸‹ï¼Œæ€§èƒ½é—®é¢˜ä¾ç„¶ä¼šå›°æ‰°æˆ‘ä»¬ã€‚æ­¤æ—¶éœ€è¦é‡‡å–ä¸€äº›æªæ–½æ¥æå‡è¿è¡Œæ€§èƒ½ï¼Œå…¶å¾ˆé‡è¦çš„ä¸€ä¸ªæ–¹å‘ï¼Œå°±æ˜¯é¿å…ä¸å¿…è¦çš„æ¸²æŸ“ï¼ˆRenderï¼‰ã€‚è¿™é‡Œæä¸‹ä¼˜åŒ–çš„ç‚¹ï¼š</p><ul><li><strong>shouldComponentUpdate å’Œ PureComponent</strong></li></ul><p>åœ¨ React ç±»ç»„ä»¶ä¸­ï¼Œå¯ä»¥åˆ©ç”¨ shouldComponentUpdate æˆ–è€… PureComponent æ¥å‡å°‘å› çˆ¶ç»„ä»¶æ›´æ–°è€Œè§¦å‘å­ç»„ä»¶çš„ renderï¼Œä»è€Œè¾¾åˆ°ç›®çš„ã€‚shouldComponentUpdate æ¥å†³å®šæ˜¯å¦ç»„ä»¶æ˜¯å¦é‡æ–°æ¸²æŸ“ï¼Œå¦‚æœä¸å¸Œæœ›ç»„ä»¶é‡æ–°æ¸²æŸ“ï¼Œè¿”å› false å³å¯ã€‚</p><ul><li><strong>åˆ©ç”¨é«˜é˜¶ç»„ä»¶</strong></li></ul><p>åœ¨å‡½æ•°ç»„ä»¶ä¸­ï¼Œå¹¶æ²¡æœ‰ shouldComponentUpdate è¿™ä¸ªç”Ÿå‘½å‘¨æœŸï¼Œå¯ä»¥åˆ©ç”¨é«˜é˜¶ç»„ä»¶ï¼Œå°è£…ä¸€ä¸ªç±»ä¼¼ PureComponet çš„åŠŸèƒ½</p><ul><li><strong>ä½¿ç”¨ React.memo</strong></li></ul><p>React.memo æ˜¯ React 16.6 æ–°çš„ä¸€ä¸ª APIï¼Œç”¨æ¥ç¼“å­˜ç»„ä»¶çš„æ¸²æŸ“ï¼Œé¿å…ä¸å¿…è¦çš„æ›´æ–°ï¼Œå…¶å®ä¹Ÿæ˜¯ä¸€ä¸ªé«˜é˜¶ç»„ä»¶ï¼Œä¸ PureComponent ååˆ†ç±»ä¼¼ï¼Œä½†ä¸åŒçš„æ˜¯ï¼Œ React.memo åªèƒ½ç”¨äºå‡½æ•°ç»„ä»¶ã€‚</p><h3 id="20-å¯¹-React-Intl-çš„ç†è§£ï¼Œå®ƒçš„å·¥ä½œåŸç†ï¼Ÿ"><a href="#20-å¯¹-React-Intl-çš„ç†è§£ï¼Œå®ƒçš„å·¥ä½œåŸç†ï¼Ÿ" class="headerlink" title="20. å¯¹ React-Intl çš„ç†è§£ï¼Œå®ƒçš„å·¥ä½œåŸç†ï¼Ÿ"></a>20. å¯¹ React-Intl çš„ç†è§£ï¼Œå®ƒçš„å·¥ä½œåŸç†ï¼Ÿ</h3><p>React-intl æ˜¯é›…è™çš„è¯­è¨€å›½é™…åŒ–å¼€æºé¡¹ç›® FormatJS çš„ä¸€éƒ¨åˆ†ï¼Œé€šè¿‡å…¶æä¾›çš„ç»„ä»¶å’Œ API å¯ä»¥ä¸ ReactJS ç»‘å®šã€‚</p><p>React-intl æä¾›äº†ä¸¤ç§ä½¿ç”¨æ–¹æ³•ï¼Œä¸€ç§æ˜¯å¼•ç”¨ React ç»„ä»¶ï¼Œå¦ä¸€ç§æ˜¯ç›´æ¥è°ƒå– APIï¼Œå®˜æ–¹æ›´åŠ æ¨èåœ¨ React é¡¹ç›®ä¸­ä½¿ç”¨å‰è€…ï¼Œåªæœ‰åœ¨æ— æ³•ä½¿ç”¨ React ç»„ä»¶çš„åœ°æ–¹ï¼Œæ‰åº”è¯¥è°ƒç”¨æ¡†æ¶æä¾›çš„ APIã€‚å®ƒæä¾›äº†ä¸€ç³»åˆ—çš„ React ç»„ä»¶ï¼ŒåŒ…æ‹¬æ•°å­—æ ¼å¼åŒ–ã€å­—ç¬¦ä¸²æ ¼å¼åŒ–ã€æ—¥æœŸæ ¼å¼åŒ–ç­‰ã€‚</p><p>åœ¨ React-intl ä¸­ï¼Œå¯ä»¥é…ç½®ä¸åŒçš„è¯­è¨€åŒ…ï¼Œä»–çš„å·¥ä½œåŸç†å°±æ˜¯æ ¹æ®éœ€è¦ï¼Œåœ¨è¯­è¨€åŒ…ä¹‹é—´è¿›è¡Œåˆ‡æ¢ã€‚</p><h3 id="21-å¯¹-React-context-çš„ç†è§£"><a href="#21-å¯¹-React-context-çš„ç†è§£" class="headerlink" title="21. å¯¹ React context çš„ç†è§£"></a>21. å¯¹ React context çš„ç†è§£</h3><p>åœ¨ React ä¸­ï¼Œæ•°æ®ä¼ é€’ä¸€èˆ¬ä½¿ç”¨ props ä¼ é€’æ•°æ®ï¼Œç»´æŒå•å‘æ•°æ®æµï¼Œè¿™æ ·å¯ä»¥è®©ç»„ä»¶ä¹‹é—´çš„å…³ç³»å˜å¾—ç®€å•ä¸”å¯é¢„æµ‹ï¼Œä½†æ˜¯å•é¡¹æ•°æ®æµåœ¨æŸäº›åœºæ™¯ä¸­å¹¶ä¸é€‚ç”¨ã€‚å•çº¯ä¸€å¯¹çš„çˆ¶å­ç»„ä»¶ä¼ é€’å¹¶æ— é—®é¢˜ï¼Œä½†è¦æ˜¯ç»„ä»¶ä¹‹é—´å±‚å±‚ä¾èµ–æ·±å…¥ï¼Œprops å°±éœ€è¦å±‚å±‚ä¼ é€’æ˜¾ç„¶ï¼Œè¿™æ ·åšå¤ªç¹çäº†ã€‚</p><p>Context æä¾›äº†ä¸€ç§åœ¨ç»„ä»¶ä¹‹é—´å…±äº«æ­¤ç±»å€¼çš„æ–¹å¼ï¼Œè€Œä¸å¿…æ˜¾å¼åœ°é€šè¿‡ç»„ä»¶æ ‘çš„é€å±‚ä¼ é€’ propsã€‚</p><p>å¯ä»¥æŠŠ context å½“åšæ˜¯ç‰¹å®šä¸€ä¸ªç»„ä»¶æ ‘å†…å…±äº«çš„ storeï¼Œç”¨æ¥åšæ•°æ®ä¼ é€’ã€‚<strong>ç®€å•è¯´å°±æ˜¯ï¼Œå½“ä½ ä¸æƒ³åœ¨ç»„ä»¶æ ‘ä¸­é€šè¿‡é€å±‚ä¼ é€’ props æˆ–è€… state çš„æ–¹å¼æ¥ä¼ é€’æ•°æ®æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ Context æ¥å®ç°è·¨å±‚çº§çš„ç»„ä»¶æ•°æ®ä¼ é€’ã€‚</strong></p><p>JS çš„ä»£ç å—åœ¨æ‰§è¡ŒæœŸé—´ï¼Œä¼šåˆ›å»ºä¸€ä¸ªç›¸åº”çš„ä½œç”¨åŸŸé“¾ï¼Œè¿™ä¸ªä½œç”¨åŸŸé“¾è®°å½•ç€è¿è¡Œæ—¶ JS ä»£ç å—æ‰§è¡ŒæœŸé—´æ‰€èƒ½è®¿é—®çš„æ´»åŠ¨å¯¹è±¡ï¼ŒåŒ…æ‹¬å˜é‡å’Œå‡½æ•°ï¼ŒJS ç¨‹åºé€šè¿‡ä½œç”¨åŸŸé“¾è®¿é—®åˆ°ä»£ç å—å†…éƒ¨æˆ–è€…å¤–éƒ¨çš„å˜é‡å’Œå‡½æ•°ã€‚</p><p>å‡å¦‚ä»¥ JS çš„ä½œç”¨åŸŸé“¾ä½œä¸ºç±»æ¯”ï¼ŒReact ç»„ä»¶æä¾›çš„ Context å¯¹è±¡å…¶å®å°±å¥½æ¯”ä¸€ä¸ªæä¾›ç»™å­ç»„ä»¶è®¿é—®çš„ä½œç”¨åŸŸï¼Œè€Œ Context å¯¹è±¡çš„å±æ€§å¯ä»¥çœ‹æˆä½œç”¨åŸŸä¸Šçš„æ´»åŠ¨å¯¹è±¡ã€‚ç”±äºç»„ä»¶ çš„ Context ç”±å…¶çˆ¶èŠ‚ç‚¹é“¾ä¸Šæ‰€æœ‰ç»„ä»¶é€š è¿‡ getChildContextï¼ˆï¼‰è¿”å›çš„ Context å¯¹è±¡ç»„åˆè€Œæˆï¼Œæ‰€ä»¥ï¼Œç»„ä»¶é€šè¿‡ Context æ˜¯å¯ä»¥è®¿é—®åˆ°å…¶çˆ¶ç»„ä»¶é“¾ä¸Šæ‰€æœ‰èŠ‚ç‚¹ç»„ä»¶æä¾›çš„ Context çš„å±æ€§ã€‚</p><h3 id="22-ä¸ºä»€ä¹ˆ-React-å¹¶ä¸æ¨èä¼˜å…ˆè€ƒè™‘ä½¿ç”¨-Contextï¼Ÿ"><a href="#22-ä¸ºä»€ä¹ˆ-React-å¹¶ä¸æ¨èä¼˜å…ˆè€ƒè™‘ä½¿ç”¨-Contextï¼Ÿ" class="headerlink" title="22. ä¸ºä»€ä¹ˆ React å¹¶ä¸æ¨èä¼˜å…ˆè€ƒè™‘ä½¿ç”¨ Contextï¼Ÿ"></a>22. ä¸ºä»€ä¹ˆ React å¹¶ä¸æ¨èä¼˜å…ˆè€ƒè™‘ä½¿ç”¨ Contextï¼Ÿ</h3><ul><li>Context ç›®å‰è¿˜å¤„äºå®éªŒé˜¶æ®µï¼Œå¯èƒ½ä¼šåœ¨åé¢çš„å‘è¡Œç‰ˆæœ¬ä¸­æœ‰å¾ˆå¤§çš„å˜åŒ–ï¼Œäº‹å®ä¸Šè¿™ç§æƒ…å†µå·²ç»å‘ç”Ÿäº†ï¼Œæ‰€ä»¥ä¸ºäº†é¿å…ç»™ä»Šåå‡çº§å¸¦æ¥å¤§çš„å½±å“å’Œéº»çƒ¦ï¼Œä¸å»ºè®®åœ¨ app ä¸­ä½¿ç”¨ contextã€‚</li><li>å°½ç®¡ä¸å»ºè®®åœ¨ app ä¸­ä½¿ç”¨ contextï¼Œä½†æ˜¯ç‹¬æœ‰ç»„ä»¶è€Œè¨€ï¼Œç”±äºå½±å“èŒƒå›´å°äº appï¼Œå¦‚æœå¯ä»¥åšåˆ°é«˜å†…èšï¼Œä¸ç ´åç»„ä»¶æ ‘ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ context</li><li>å¯¹äºç»„ä»¶ä¹‹é—´çš„æ•°æ®é€šä¿¡æˆ–è€…çŠ¶æ€ç®¡ç†ï¼Œæœ‰æ•ˆä½¿ç”¨ props æˆ–è€… state è§£å†³ï¼Œç„¶åå†è€ƒè™‘ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„æˆç†Ÿåº“è¿›è¡Œè§£å†³ï¼Œä»¥ä¸Šçš„æ–¹æ³•éƒ½ä¸æ˜¯æœ€ä½³çš„æ–¹æ¡ˆçš„æ—¶å€™ï¼Œåœ¨è€ƒè™‘ contextã€‚</li><li>context çš„æ›´æ–°éœ€è¦é€šè¿‡ setState()è§¦å‘ï¼Œä½†æ˜¯è¿™å¹¶ä¸æ˜¯å¾ˆå¯é çš„ï¼ŒContext æ”¯æŒè·¨ç»„ä»¶çš„è®¿é—®ï¼Œä½†æ˜¯å¦‚æœä¸­é—´çš„å­ç»„ä»¶é€šè¿‡ä¸€äº›æ–¹æ³•ä¸å½±å“æ›´æ–°ï¼Œæ¯”å¦‚ shouldComponentUpdate() è¿”å› false é‚£ä¹ˆä¸èƒ½ä¿è¯ Context çš„æ›´æ–°ä¸€å®šå¯ä»¥ä½¿ç”¨ Context çš„å­ç»„ä»¶ï¼Œå› æ­¤ï¼ŒContext çš„å¯é æ€§éœ€è¦å…³æ³¨</li></ul><h3 id="23-React-ä¸­ä»€ä¹ˆæ˜¯å—æ§ç»„ä»¶å’Œéæ§ç»„ä»¶ï¼Ÿ"><a href="#23-React-ä¸­ä»€ä¹ˆæ˜¯å—æ§ç»„ä»¶å’Œéæ§ç»„ä»¶ï¼Ÿ" class="headerlink" title="23. React ä¸­ä»€ä¹ˆæ˜¯å—æ§ç»„ä»¶å’Œéæ§ç»„ä»¶ï¼Ÿ"></a>23. React ä¸­ä»€ä¹ˆæ˜¯å—æ§ç»„ä»¶å’Œéæ§ç»„ä»¶ï¼Ÿ</h3><p><strong>ï¼ˆ1ï¼‰å—æ§ç»„ä»¶</strong><br>åœ¨ä½¿ç”¨è¡¨å•æ¥æ”¶é›†ç”¨æˆ·è¾“å…¥æ—¶ï¼Œä¾‹å¦‚<code>&lt;input&gt;&lt;select&gt;&lt;textearea&gt;</code>ç­‰å…ƒç´ éƒ½è¦ç»‘å®šä¸€ä¸ª change äº‹ä»¶ï¼Œå½“è¡¨å•çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–ï¼Œå°±ä¼šè§¦å‘ onChange äº‹ä»¶ï¼Œæ›´æ–°ç»„ä»¶çš„ stateã€‚è¿™ç§ç»„ä»¶åœ¨ React ä¸­è¢«ç§°ä¸º<strong>å—æ§ç»„ä»¶</strong>ï¼Œåœ¨å—æ§ç»„ä»¶ä¸­ï¼Œç»„ä»¶æ¸²æŸ“å‡ºçš„çŠ¶æ€ä¸å®ƒçš„ value æˆ– checked å±æ€§ç›¸å¯¹åº”ï¼Œreact é€šè¿‡è¿™ç§æ–¹å¼æ¶ˆé™¤äº†ç»„ä»¶çš„å±€éƒ¨çŠ¶æ€ï¼Œä½¿æ•´ä¸ªçŠ¶æ€å¯æ§ã€‚react å®˜æ–¹æ¨èä½¿ç”¨å—æ§è¡¨å•ç»„ä»¶ã€‚</p><p>å—æ§ç»„ä»¶æ›´æ–° state çš„æµç¨‹ï¼š</p><ul><li>å¯ä»¥é€šè¿‡åˆå§‹ state ä¸­è®¾ç½®è¡¨å•çš„é»˜è®¤å€¼</li><li>æ¯å½“è¡¨å•çš„å€¼å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè°ƒç”¨ onChange äº‹ä»¶å¤„ç†å™¨</li><li>äº‹ä»¶å¤„ç†å™¨é€šè¿‡äº‹ä»¶å¯¹è±¡ e æ‹¿åˆ°æ”¹å˜åçš„çŠ¶æ€ï¼Œå¹¶æ›´æ–°ç»„ä»¶çš„ state</li><li>ä¸€æ—¦é€šè¿‡ setState æ–¹æ³•æ›´æ–° stateï¼Œå°±ä¼šè§¦å‘è§†å›¾çš„é‡æ–°æ¸²æŸ“ï¼Œå®Œæˆè¡¨å•ç»„ä»¶çš„æ›´æ–°</li></ul><p><strong>å—æ§ç»„ä»¶ç¼ºé™·ï¼š</strong><br>è¡¨å•å…ƒç´ çš„å€¼éƒ½æ˜¯ç”± React ç»„ä»¶è¿›è¡Œç®¡ç†ï¼Œå½“æœ‰å¤šä¸ªè¾“å…¥æ¡†ï¼Œæˆ–è€…å¤šä¸ªè¿™ç§ç»„ä»¶æ—¶ï¼Œå¦‚æœæƒ³åŒæ—¶è·å–åˆ°å…¨éƒ¨çš„å€¼å°±å¿…é¡»æ¯ä¸ªéƒ½è¦ç¼–å†™äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œè¿™ä¼šè®©ä»£ç çœ‹ç€å¾ˆè‡ƒè‚¿ï¼Œæ‰€ä»¥ä¸ºäº†è§£å†³è¿™ç§æƒ…å†µï¼Œå‡ºç°äº†éå—æ§ç»„ä»¶ã€‚</p><p><strong>ï¼ˆ2ï¼‰éå—æ§ç»„ä»¶</strong><br>å¦‚æœä¸€ä¸ªè¡¨å•ç»„ä»¶æ²¡æœ‰ value propsï¼ˆå•é€‰å’Œå¤é€‰æŒ‰é’®å¯¹åº”çš„æ˜¯ checked propsï¼‰æ—¶ï¼Œå°±å¯ä»¥ç§°ä¸ºéå—æ§ç»„ä»¶ã€‚åœ¨éå—æ§ç»„ä»¶ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ª ref æ¥ä» DOM è·å¾—è¡¨å•å€¼ã€‚è€Œä¸æ˜¯ä¸ºæ¯ä¸ªçŠ¶æ€æ›´æ–°ç¼–å†™ä¸€ä¸ªäº‹ä»¶å¤„ç†ç¨‹åºã€‚</p><p>React å®˜æ–¹çš„è§£é‡Šï¼š</p><blockquote><p>è¦ç¼–å†™ä¸€ä¸ªéå—æ§ç»„ä»¶ï¼Œè€Œä¸æ˜¯ä¸ºæ¯ä¸ªçŠ¶æ€æ›´æ–°éƒ½ç¼–å†™æ•°æ®å¤„ç†å‡½æ•°ï¼Œä½ å¯ä»¥ä½¿ç”¨ ref æ¥ä» DOM èŠ‚ç‚¹ä¸­è·å–è¡¨å•æ•°æ®ã€‚<br>å› ä¸ºéå—æ§ç»„ä»¶å°†çœŸå®æ•°æ®å‚¨å­˜åœ¨ DOM èŠ‚ç‚¹ä¸­ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨éå—æ§ç»„ä»¶æ—¶ï¼Œæœ‰æ—¶å€™åè€Œæ›´å®¹æ˜“åŒæ—¶é›†æˆ React å’Œé React ä»£ç ã€‚å¦‚æœä½ ä¸ä»‹æ„ä»£ç ç¾è§‚æ€§ï¼Œå¹¶ä¸”å¸Œæœ›å¿«é€Ÿç¼–å†™ä»£ç ï¼Œä½¿ç”¨éå—æ§ç»„ä»¶å¾€å¾€å¯ä»¥å‡å°‘ä½ çš„ä»£ç é‡ã€‚å¦åˆ™ï¼Œä½ åº”è¯¥ä½¿ç”¨å—æ§ç»„ä»¶ã€‚</p></blockquote><p>ä¾‹å¦‚ï¼Œä¸‹é¢çš„ä»£ç åœ¨éå—æ§ç»„ä»¶ä¸­æ¥æ”¶å•ä¸ªå±æ€§ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">NameForm</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>handleSubmit <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleSubmit<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">handleSubmit</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"A name was submitted: "</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>input<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>    event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>form onSubmit<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleSubmit<span class="token punctuation">}</span><span class="token operator">></span>        <span class="token operator">&lt;</span>label<span class="token operator">></span>          Name<span class="token punctuation">:</span>          <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"text"</span> ref<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>input <span class="token operator">=</span> input<span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>        <span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">></span>        <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"submit"</span> value<span class="token operator">=</span><span class="token string">"Submit"</span> <span class="token operator">/</span><span class="token operator">></span>      <span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>æ€»ç»“ï¼š</strong> é¡µé¢ä¸­æ‰€æœ‰è¾“å…¥ç±»çš„ DOM å¦‚æœæ˜¯ç°ç”¨ç°å–çš„ç§°ä¸ºéå—æ§ç»„ä»¶ï¼Œè€Œé€šè¿‡ setState å°†è¾“å…¥çš„å€¼ç»´æŠ¤åˆ°äº† state ä¸­ï¼Œéœ€è¦æ—¶å†ä» state ä¸­å–å‡ºï¼Œè¿™é‡Œçš„æ•°æ®å°±å—åˆ°äº† state çš„æ§åˆ¶ï¼Œç§°ä¸ºå—æ§ç»„ä»¶ã€‚</p><h3 id="24-React-ä¸­-refs-çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿæœ‰å“ªäº›åº”ç”¨åœºæ™¯ï¼Ÿ"><a href="#24-React-ä¸­-refs-çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿæœ‰å“ªäº›åº”ç”¨åœºæ™¯ï¼Ÿ" class="headerlink" title="24. React ä¸­ refs çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿæœ‰å“ªäº›åº”ç”¨åœºæ™¯ï¼Ÿ"></a>24. React ä¸­ refs çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿæœ‰å“ªäº›åº”ç”¨åœºæ™¯ï¼Ÿ</h3><p>Refs æä¾›äº†ä¸€ç§æ–¹å¼ï¼Œç”¨äºè®¿é—®åœ¨ render æ–¹æ³•ä¸­åˆ›å»ºçš„ React å…ƒç´ æˆ– DOM èŠ‚ç‚¹ã€‚Refs åº”è¯¥è°¨æ…ä½¿ç”¨ï¼Œå¦‚ä¸‹åœºæ™¯ä½¿ç”¨ Refs æ¯”è¾ƒé€‚åˆï¼š</p><ul><li>å¤„ç†ç„¦ç‚¹ã€æ–‡æœ¬é€‰æ‹©æˆ–è€…åª’ä½“çš„æ§åˆ¶</li><li>è§¦å‘å¿…è¦çš„åŠ¨ç”»</li><li>é›†æˆç¬¬ä¸‰æ–¹ DOM åº“</li></ul><p>Refs æ˜¯ä½¿ç”¨ <code>React.createRef()</code> æ–¹æ³•åˆ›å»ºçš„ï¼Œä»–é€šè¿‡ <code>ref</code> å±æ€§é™„åŠ åˆ° React å…ƒç´ ä¸Šã€‚è¦åœ¨æ•´ä¸ªç»„ä»¶ä¸­ä½¿ç”¨ Refsï¼Œéœ€è¦å°† <code>ref</code> åœ¨æ„é€ å‡½æ•°ä¸­åˆ†é…ç»™å…¶å®ä¾‹å±æ€§ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">MyComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>myRef <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div ref<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>myRef<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç”±äºå‡½æ•°ç»„ä»¶æ²¡æœ‰å®ä¾‹ï¼Œå› æ­¤ä¸èƒ½åœ¨å‡½æ•°ç»„ä»¶ä¸Šç›´æ¥ä½¿ç”¨ <code>ref</code>ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">MyFunctionalComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token operator">&lt;</span>input <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">Parent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>textInput <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// è¿™å°†ä¸ä¼šå·¥ä½œï¼</span>    <span class="token keyword">return</span> <span class="token operator">&lt;</span>MyFunctionalComponent ref<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>textInput<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½†å¯ä»¥é€šè¿‡é—­åˆçš„å¸®åŠ©åœ¨å‡½æ•°ç»„ä»¶å†…éƒ¨è¿›è¡Œä½¿ç”¨ Refsï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">CustomTextInput</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// è¿™é‡Œå¿…é¡»å£°æ˜ textInputï¼Œè¿™æ · ref å›è°ƒæ‰å¯ä»¥å¼•ç”¨å®ƒ</span>  <span class="token keyword">let</span> textInput <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  <span class="token keyword">function</span> <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    textInput<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token punctuation">(</span>    <span class="token operator">&lt;</span>div<span class="token operator">></span>      <span class="token operator">&lt;</span>input        type<span class="token operator">=</span><span class="token string">"text"</span>        ref<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>          textInput <span class="token operator">=</span> input<span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">}</span>      <span class="token operator">/</span><span class="token operator">></span>      <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"button"</span> value<span class="token operator">=</span><span class="token string">"Focus the text input"</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>  <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>æ³¨æ„ï¼š</strong></p><ul><li>ä¸åº”è¯¥è¿‡åº¦çš„ä½¿ç”¨ Refs</li><li><code>ref</code> çš„è¿”å›å€¼å–å†³äºèŠ‚ç‚¹çš„ç±»å‹ï¼š<ul><li>å½“ <code>ref</code> å±æ€§è¢«ç”¨äºä¸€ä¸ªæ™®é€šçš„ HTML å…ƒç´ æ—¶ï¼Œ<code>React.createRef()</code> å°†æ¥æ”¶åº•å±‚ DOM å…ƒç´ ä½œä¸ºä»–çš„ <code>current</code> å±æ€§ä»¥åˆ›å»º <code>ref</code>ã€‚</li><li>å½“ <code>ref</code> å±æ€§è¢«ç”¨äºä¸€ä¸ªè‡ªå®šä¹‰çš„ç±»ç»„ä»¶æ—¶ï¼Œ<code>ref</code> å¯¹è±¡å°†æ¥æ”¶è¯¥ç»„ä»¶å·²æŒ‚è½½çš„å®ä¾‹ä½œä¸ºä»–çš„ <code>current</code>ã€‚</li></ul></li><li>å½“åœ¨çˆ¶ç»„ä»¶ä¸­éœ€è¦è®¿é—®å­ç»„ä»¶ä¸­çš„ <code>ref</code> æ—¶å¯ä½¿ç”¨ä¼ é€’ Refs æˆ–å›è°ƒ Refsã€‚</li></ul><h3 id="26-React-ç»„ä»¶çš„æ„é€ å‡½æ•°æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿå®ƒæ˜¯å¿…é¡»çš„å—ï¼Ÿ"><a href="#26-React-ç»„ä»¶çš„æ„é€ å‡½æ•°æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿå®ƒæ˜¯å¿…é¡»çš„å—ï¼Ÿ" class="headerlink" title="26. React ç»„ä»¶çš„æ„é€ å‡½æ•°æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿå®ƒæ˜¯å¿…é¡»çš„å—ï¼Ÿ"></a>26. React ç»„ä»¶çš„æ„é€ å‡½æ•°æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿå®ƒæ˜¯å¿…é¡»çš„å—ï¼Ÿ</h3><p>æ„é€ å‡½æ•°ä¸»è¦ç”¨äºä¸¤ä¸ªç›®çš„ï¼š</p><ul><li>é€šè¿‡å°†å¯¹è±¡åˆ†é…ç»™ this.state æ¥åˆå§‹åŒ–æœ¬åœ°çŠ¶æ€</li><li>å°†äº‹ä»¶å¤„ç†ç¨‹åºæ–¹æ³•ç»‘å®šåˆ°å®ä¾‹ä¸Š</li></ul><p>æ‰€ä»¥ï¼Œå½“åœ¨ React class ä¸­éœ€è¦è®¾ç½® state çš„åˆå§‹å€¼æˆ–è€…ç»‘å®šäº‹ä»¶æ—¶ï¼Œéœ€è¦åŠ ä¸Šæ„é€ å‡½æ•°ï¼Œå®˜æ–¹ Demoï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">LikeButton</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>      liked<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>handleClick <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleClick<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> liked<span class="token punctuation">:</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>liked <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> text <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>liked <span class="token operator">?</span> <span class="token string">"liked"</span> <span class="token punctuation">:</span> <span class="token string">"haven't liked"</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>div onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleClick<span class="token punctuation">}</span><span class="token operator">></span>You <span class="token punctuation">{</span>text<span class="token punctuation">}</span> <span class="token keyword">this</span><span class="token punctuation">.</span> Click to toggle<span class="token punctuation">.</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span>ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>LikeButton <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"example"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ„é€ å‡½æ•°ç”¨æ¥æ–°å»ºçˆ¶ç±»çš„ this å¯¹è±¡ï¼›å­ç±»å¿…é¡»åœ¨ constructor æ–¹æ³•ä¸­è°ƒç”¨ super æ–¹æ³•ï¼›å¦åˆ™æ–°å»ºå®ä¾‹æ—¶ä¼šæŠ¥é”™ï¼›å› ä¸ºå­ç±»æ²¡æœ‰è‡ªå·±çš„ this å¯¹è±¡ï¼Œè€Œæ˜¯ç»§æ‰¿çˆ¶ç±»çš„ this å¯¹è±¡ï¼Œç„¶åå¯¹å…¶è¿›è¡ŒåŠ å·¥ã€‚å¦‚æœä¸è°ƒç”¨ super æ–¹æ³•ï¼›å­ç±»å°±å¾—ä¸åˆ° this å¯¹è±¡ã€‚</p><p><strong>æ³¨æ„ï¼š</strong></p><ul><li>constructor () å¿…é¡»é…ä¸Š super(), å¦‚æœè¦åœ¨ constructor å†…éƒ¨ä½¿ç”¨ this.props å°±è¦ ä¼ å…¥ props , å¦åˆ™ä¸ç”¨</li><li>JavaScript ä¸­çš„ bind æ¯æ¬¡éƒ½ä¼šè¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°, ä¸ºäº†æ€§èƒ½ç­‰è€ƒè™‘, å°½é‡åœ¨ constructor ä¸­ç»‘å®šäº‹ä»¶</li></ul><h3 id="27-React-forwardRef-æ˜¯ä»€ä¹ˆï¼Ÿå®ƒæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ"><a href="#27-React-forwardRef-æ˜¯ä»€ä¹ˆï¼Ÿå®ƒæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ" class="headerlink" title="27. React.forwardRef æ˜¯ä»€ä¹ˆï¼Ÿå®ƒæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ"></a>27. React.forwardRef æ˜¯ä»€ä¹ˆï¼Ÿå®ƒæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</h3><p>React.forwardRef ä¼šåˆ›å»ºä¸€ä¸ª React ç»„ä»¶ï¼Œè¿™ä¸ªç»„ä»¶èƒ½å¤Ÿå°†å…¶æ¥å—çš„ ref å±æ€§è½¬å‘åˆ°å…¶ç»„ä»¶æ ‘ä¸‹çš„å¦ä¸€ä¸ªç»„ä»¶ä¸­ã€‚è¿™ç§æŠ€æœ¯å¹¶ä¸å¸¸è§ï¼Œä½†åœ¨ä»¥ä¸‹ä¸¤ç§åœºæ™¯ä¸­ç‰¹åˆ«æœ‰ç”¨ï¼š</p><ul><li>è½¬å‘ refs åˆ° DOM ç»„ä»¶</li><li>åœ¨é«˜é˜¶ç»„ä»¶ä¸­è½¬å‘ refs</li></ul><h3 id="28-ç±»ç»„ä»¶ä¸å‡½æ•°ç»„ä»¶æœ‰ä»€ä¹ˆå¼‚åŒï¼Ÿ"><a href="#28-ç±»ç»„ä»¶ä¸å‡½æ•°ç»„ä»¶æœ‰ä»€ä¹ˆå¼‚åŒï¼Ÿ" class="headerlink" title="28. ç±»ç»„ä»¶ä¸å‡½æ•°ç»„ä»¶æœ‰ä»€ä¹ˆå¼‚åŒï¼Ÿ"></a>28. ç±»ç»„ä»¶ä¸å‡½æ•°ç»„ä»¶æœ‰ä»€ä¹ˆå¼‚åŒï¼Ÿ</h3><p><strong>ç›¸åŒç‚¹ï¼š</strong><br>ç»„ä»¶æ˜¯ React å¯å¤ç”¨çš„æœ€å°ä»£ç ç‰‡æ®µï¼Œå®ƒä»¬ä¼šè¿”å›è¦åœ¨é¡µé¢ä¸­æ¸²æŸ“çš„ React å…ƒç´ ã€‚ä¹Ÿæ­£å› ä¸ºç»„ä»¶æ˜¯ React çš„æœ€å°ç¼–ç å•ä½ï¼Œæ‰€ä»¥æ— è®ºæ˜¯å‡½æ•°ç»„ä»¶è¿˜æ˜¯ç±»ç»„ä»¶ï¼Œåœ¨ä½¿ç”¨æ–¹å¼å’Œæœ€ç»ˆå‘ˆç°æ•ˆæœä¸Šéƒ½æ˜¯å®Œå…¨ä¸€è‡´çš„ã€‚</p><p>æˆ‘ä»¬ç”šè‡³å¯ä»¥å°†ä¸€ä¸ªç±»ç»„ä»¶æ”¹å†™æˆå‡½æ•°ç»„ä»¶ï¼Œæˆ–è€…æŠŠå‡½æ•°ç»„ä»¶æ”¹å†™æˆä¸€ä¸ªç±»ç»„ä»¶ï¼ˆè™½ç„¶å¹¶ä¸æ¨èè¿™ç§é‡æ„è¡Œä¸ºï¼‰ã€‚ä»ä½¿ç”¨è€…çš„è§’åº¦è€Œè¨€ï¼Œå¾ˆéš¾ä»ä½¿ç”¨ä½“éªŒä¸ŠåŒºåˆ†ä¸¤è€…ï¼Œè€Œä¸”åœ¨ç°ä»£æµè§ˆå™¨ä¸­ï¼Œé—­åŒ…å’Œç±»çš„æ€§èƒ½åªåœ¨æç«¯åœºæ™¯ä¸‹æ‰ä¼šæœ‰æ˜æ˜¾çš„å·®åˆ«ã€‚æ‰€ä»¥ï¼ŒåŸºæœ¬å¯è®¤ä¸ºä¸¤è€…ä½œä¸ºç»„ä»¶æ˜¯å®Œå…¨ä¸€è‡´çš„ã€‚</p><p><strong>ä¸åŒç‚¹ï¼š</strong></p><ul><li>å®ƒä»¬åœ¨å¼€å‘æ—¶çš„å¿ƒæ™ºæ¨¡å‹ä¸Šå´å­˜åœ¨å·¨å¤§çš„å·®å¼‚ã€‚ç±»ç»„ä»¶æ˜¯åŸºäºé¢å‘å¯¹è±¡ç¼–ç¨‹çš„ï¼Œå®ƒä¸»æ‰“çš„æ˜¯ç»§æ‰¿ã€ç”Ÿå‘½å‘¨æœŸç­‰æ ¸å¿ƒæ¦‚å¿µï¼›è€Œå‡½æ•°ç»„ä»¶å†…æ ¸æ˜¯å‡½æ•°å¼ç¼–ç¨‹ï¼Œä¸»æ‰“çš„æ˜¯ immutableã€æ²¡æœ‰å‰¯ä½œç”¨ã€å¼•ç”¨é€æ˜ç­‰ç‰¹ç‚¹ã€‚</li><li>ä¹‹å‰ï¼Œåœ¨ä½¿ç”¨åœºæ™¯ä¸Šï¼Œå¦‚æœå­˜åœ¨éœ€è¦ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸçš„ç»„ä»¶ï¼Œé‚£ä¹ˆä¸»æ¨ç±»ç»„ä»¶ï¼›è®¾è®¡æ¨¡å¼ä¸Šï¼Œå¦‚æœéœ€è¦ä½¿ç”¨ç»§æ‰¿ï¼Œé‚£ä¹ˆä¸»æ¨ç±»ç»„ä»¶ã€‚ä½†ç°åœ¨ç”±äº React Hooks çš„æ¨å‡ºï¼Œç”Ÿå‘½å‘¨æœŸæ¦‚å¿µçš„æ·¡å‡ºï¼Œå‡½æ•°ç»„ä»¶å¯ä»¥å®Œå…¨å–ä»£ç±»ç»„ä»¶ã€‚å…¶æ¬¡ç»§æ‰¿å¹¶ä¸æ˜¯ç»„ä»¶æœ€ä½³çš„è®¾è®¡æ¨¡å¼ï¼Œå®˜æ–¹æ›´æ¨å´‡â€œç»„åˆä¼˜äºç»§æ‰¿â€çš„è®¾è®¡æ¦‚å¿µï¼Œæ‰€ä»¥ç±»ç»„ä»¶åœ¨è¿™æ–¹é¢çš„ä¼˜åŠ¿ä¹Ÿåœ¨æ·¡å‡ºã€‚</li><li>æ€§èƒ½ä¼˜åŒ–ä¸Šï¼Œç±»ç»„ä»¶ä¸»è¦ä¾é  shouldComponentUpdate  é˜»æ–­æ¸²æŸ“æ¥æå‡æ€§èƒ½ï¼Œè€Œå‡½æ•°ç»„ä»¶ä¾é  React.memo ç¼“å­˜æ¸²æŸ“ç»“æœæ¥æå‡æ€§èƒ½ã€‚</li><li>ä»ä¸Šæ‰‹ç¨‹åº¦è€Œè¨€ï¼Œç±»ç»„ä»¶æ›´å®¹æ˜“ä¸Šæ‰‹ï¼Œä»æœªæ¥è¶‹åŠ¿ä¸Šçœ‹ï¼Œç”±äº React Hooks çš„æ¨å‡ºï¼Œå‡½æ•°ç»„ä»¶æˆäº†ç¤¾åŒºæœªæ¥ä¸»æ¨çš„æ–¹æ¡ˆã€‚</li><li>ç±»ç»„ä»¶åœ¨æœªæ¥æ—¶é—´åˆ‡ç‰‡ä¸å¹¶å‘æ¨¡å¼ä¸­ï¼Œç”±äºç”Ÿå‘½å‘¨æœŸå¸¦æ¥çš„å¤æ‚åº¦ï¼Œå¹¶ä¸æ˜“äºä¼˜åŒ–ã€‚è€Œå‡½æ•°ç»„ä»¶æœ¬èº«è½»é‡ç®€å•ï¼Œä¸”åœ¨ Hooks çš„åŸºç¡€ä¸Šæä¾›äº†æ¯”åŸå…ˆæ›´ç»†ç²’åº¦çš„é€»è¾‘ç»„ç»‡ä¸å¤ç”¨ï¼Œæ›´èƒ½é€‚åº” React çš„æœªæ¥å‘å±•ã€‚</li></ul><h2 id="äºŒã€æ•°æ®ç®¡ç†"><a href="#äºŒã€æ•°æ®ç®¡ç†" class="headerlink" title="äºŒã€æ•°æ®ç®¡ç†"></a>äºŒã€æ•°æ®ç®¡ç†</h2><h3 id="1-React-setState-è°ƒç”¨çš„åŸç†"><a href="#1-React-setState-è°ƒç”¨çš„åŸç†" class="headerlink" title="1. React setState è°ƒç”¨çš„åŸç†"></a>1. React setState è°ƒç”¨çš„åŸç†</h3><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/react/4.png" alt="image.png"><br>å…·ä½“çš„æ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹ï¼ˆæºç çº§è§£æï¼‰ï¼š</p><ul><li>é¦–å…ˆè°ƒç”¨äº†<code>setState</code> å…¥å£å‡½æ•°ï¼Œå…¥å£å‡½æ•°åœ¨è¿™é‡Œå°±æ˜¯å……å½“ä¸€ä¸ªåˆ†å‘å™¨çš„è§’è‰²ï¼Œæ ¹æ®å…¥å‚çš„ä¸åŒï¼Œå°†å…¶åˆ†å‘åˆ°ä¸åŒçš„åŠŸèƒ½å‡½æ•°ä¸­å»ï¼›</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript">ReactComponent<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>setState <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>partialState<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>updater<span class="token punctuation">.</span><span class="token function">enqueueSetState</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> partialState<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>updater<span class="token punctuation">.</span><span class="token function">enqueueCallback</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> callback<span class="token punctuation">,</span> <span class="token string">"setState"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><code>enqueueSetState</code> æ–¹æ³•å°†æ–°çš„ <code>state</code> æ”¾è¿›ç»„ä»¶çš„çŠ¶æ€é˜Ÿåˆ—é‡Œï¼Œå¹¶è°ƒç”¨ <code>enqueueUpdate</code> æ¥å¤„ç†å°†è¦æ›´æ–°çš„å®ä¾‹å¯¹è±¡ï¼›</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript">enqueueSetState<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>publicInstance<span class="token punctuation">,</span> partialState<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// æ ¹æ® this æ‹¿åˆ°å¯¹åº”çš„ç»„ä»¶å®ä¾‹</span>  <span class="token keyword">var</span> internalInstance <span class="token operator">=</span> <span class="token function">getInternalInstanceReadyForUpdate</span><span class="token punctuation">(</span>publicInstance<span class="token punctuation">,</span> <span class="token string">'setState'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// è¿™ä¸ª queue å¯¹åº”çš„å°±æ˜¯ä¸€ä¸ªç»„ä»¶å®ä¾‹çš„ state æ•°ç»„</span>  <span class="token keyword">var</span> queue <span class="token operator">=</span> internalInstance<span class="token punctuation">.</span>_pendingStateQueue <span class="token operator">||</span> <span class="token punctuation">(</span>internalInstance<span class="token punctuation">.</span>_pendingStateQueue <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  queue<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>partialState<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//  enqueueUpdate ç”¨æ¥å¤„ç†å½“å‰çš„ç»„ä»¶å®ä¾‹</span>  <span class="token function">enqueueUpdate</span><span class="token punctuation">(</span>internalInstance<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>åœ¨ <code>enqueueUpdate</code> æ–¹æ³•ä¸­å¼•å‡ºäº†ä¸€ä¸ªå…³é”®çš„å¯¹è±¡â€”â€”<code>batchingStrategy</code>ï¼Œè¯¥å¯¹è±¡æ‰€å…·å¤‡çš„<code>isBatchingUpdates</code> å±æ€§ç›´æ¥å†³å®šäº†å½“ä¸‹æ˜¯è¦èµ°æ›´æ–°æµç¨‹ï¼Œè¿˜æ˜¯åº”è¯¥æ’é˜Ÿç­‰å¾…ï¼›å¦‚æœè½®åˆ°æ‰§è¡Œï¼Œå°±è°ƒç”¨ <code>batchedUpdates</code> æ–¹æ³•æ¥ç›´æ¥å‘èµ·æ›´æ–°æµç¨‹ã€‚ç”±æ­¤å¯ä»¥æ¨æµ‹ï¼Œ<code>batchingStrategy</code> æˆ–è®¸æ­£æ˜¯ React å†…éƒ¨ä¸“é—¨ç”¨äºç®¡æ§æ‰¹é‡æ›´æ–°çš„å¯¹è±¡ã€‚</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">enqueueUpdate</span><span class="token punctuation">(</span>component<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token function">ensureInjected</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// æ³¨æ„è¿™ä¸€å¥æ˜¯é—®é¢˜çš„å…³é”®ï¼ŒisBatchingUpdatesæ ‡è¯†ç€å½“å‰æ˜¯å¦å¤„äºæ‰¹é‡åˆ›å»º/æ›´æ–°ç»„ä»¶çš„é˜¶æ®µ</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>batchingStrategy<span class="token punctuation">.</span>isBatchingUpdates<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// è‹¥å½“å‰æ²¡æœ‰å¤„äºæ‰¹é‡åˆ›å»º/æ›´æ–°ç»„ä»¶çš„é˜¶æ®µï¼Œåˆ™ç«‹å³æ›´æ–°ç»„ä»¶</span>    batchingStrategy<span class="token punctuation">.</span><span class="token function">batchedUpdates</span><span class="token punctuation">(</span>enqueueUpdate<span class="token punctuation">,</span> component<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token comment" spellcheck="true">// å¦åˆ™ï¼Œå…ˆæŠŠç»„ä»¶å¡å…¥ dirtyComponents é˜Ÿåˆ—é‡Œï¼Œè®©å®ƒâ€œå†ç­‰ç­‰â€</span>  dirtyComponents<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>component<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>component<span class="token punctuation">.</span>_updateBatchNumber <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    component<span class="token punctuation">.</span>_updateBatchNumber <span class="token operator">=</span> updateBatchNumber <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>æ³¨æ„ï¼š</strong><code>batchingStrategy</code> å¯¹è±¡å¯ä»¥ç†è§£ä¸ºâ€œé”ç®¡ç†å™¨â€ã€‚è¿™é‡Œçš„â€œé”â€ï¼Œæ˜¯æŒ‡ React å…¨å±€å”¯ä¸€çš„ <code>isBatchingUpdates</code> å˜é‡ï¼Œ<code>isBatchingUpdates</code> çš„åˆå§‹å€¼æ˜¯ <code>false</code>ï¼Œæ„å‘³ç€â€œå½“å‰å¹¶æœªè¿›è¡Œä»»ä½•æ‰¹é‡æ›´æ–°æ“ä½œâ€ã€‚æ¯å½“ React è°ƒç”¨ <code>batchedUpdate</code> å»æ‰§è¡Œæ›´æ–°åŠ¨ä½œæ—¶ï¼Œä¼šå…ˆæŠŠè¿™ä¸ªé”ç»™â€œé”ä¸Šâ€ï¼ˆç½®ä¸º <code>true</code>ï¼‰ï¼Œè¡¨æ˜â€œç°åœ¨æ­£å¤„äºæ‰¹é‡æ›´æ–°è¿‡ç¨‹ä¸­â€ã€‚å½“é”è¢«â€œé”ä¸Šâ€çš„æ—¶å€™ï¼Œä»»ä½•éœ€è¦æ›´æ–°çš„ç»„ä»¶éƒ½åªèƒ½æš‚æ—¶è¿›å…¥ <code>dirtyComponents</code> é‡Œæ’é˜Ÿç­‰å€™ä¸‹ä¸€æ¬¡çš„æ‰¹é‡æ›´æ–°ï¼Œè€Œä¸èƒ½éšæ„â€œæ’é˜Ÿâ€ã€‚æ­¤å¤„ä½“ç°çš„â€œä»»åŠ¡é”â€çš„æ€æƒ³ï¼Œæ˜¯ React é¢å¯¹å¤§é‡çŠ¶æ€ä»ç„¶èƒ½å¤Ÿå®ç°æœ‰åºåˆ†æ‰¹å¤„ç†çš„åŸºçŸ³ã€‚</p><h3 id="2-React-setState-è°ƒç”¨ä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿæ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥ï¼Ÿ"><a href="#2-React-setState-è°ƒç”¨ä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿæ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥ï¼Ÿ" class="headerlink" title="2. React setState è°ƒç”¨ä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿæ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥ï¼Ÿ"></a>2. React setState è°ƒç”¨ä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿæ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥ï¼Ÿ</h3><p><strong>ï¼ˆ1ï¼‰React ä¸­ setState åå‘ç”Ÿäº†ä»€ä¹ˆ</strong></p><p>åœ¨ä»£ç ä¸­è°ƒç”¨ setState å‡½æ•°ä¹‹åï¼ŒReact ä¼šå°†ä¼ å…¥çš„å‚æ•°å¯¹è±¡ä¸ç»„ä»¶å½“å‰çš„çŠ¶æ€åˆå¹¶ï¼Œç„¶åè§¦å‘è°ƒå’Œè¿‡ç¨‹(Reconciliation)ã€‚ç»è¿‡è°ƒå’Œè¿‡ç¨‹ï¼ŒReact ä¼šä»¥ç›¸å¯¹é«˜æ•ˆçš„æ–¹å¼æ ¹æ®æ–°çš„çŠ¶æ€æ„å»º React å…ƒç´ æ ‘å¹¶ä¸”ç€æ‰‹é‡æ–°æ¸²æŸ“æ•´ä¸ª UI ç•Œé¢ã€‚</p><p>åœ¨ React å¾—åˆ°å…ƒç´ æ ‘ä¹‹åï¼ŒReact ä¼šè‡ªåŠ¨è®¡ç®—å‡ºæ–°çš„æ ‘ä¸è€æ ‘çš„èŠ‚ç‚¹å·®å¼‚ï¼Œç„¶åæ ¹æ®å·®å¼‚å¯¹ç•Œé¢è¿›è¡Œæœ€å°åŒ–é‡æ¸²æŸ“ã€‚åœ¨å·®å¼‚è®¡ç®—ç®—æ³•ä¸­ï¼ŒReact èƒ½å¤Ÿç›¸å¯¹ç²¾ç¡®åœ°çŸ¥é“å“ªäº›ä½ç½®å‘ç”Ÿäº†æ”¹å˜ä»¥åŠåº”è¯¥å¦‚ä½•æ”¹å˜ï¼Œè¿™å°±ä¿è¯äº†æŒ‰éœ€æ›´æ–°ï¼Œè€Œä¸æ˜¯å…¨éƒ¨é‡æ–°æ¸²æŸ“ã€‚</p><p>å¦‚æœåœ¨çŸ­æ—¶é—´å†…é¢‘ç¹ setStateã€‚React ä¼šå°† state çš„æ”¹å˜å‹å…¥æ ˆä¸­ï¼Œåœ¨åˆé€‚çš„æ—¶æœºï¼Œæ‰¹é‡æ›´æ–° state å’Œè§†å›¾ï¼Œè¾¾åˆ°æé«˜æ€§èƒ½çš„æ•ˆæœã€‚</p><p><strong>ï¼ˆ2ï¼‰setState æ˜¯åŒæ­¥è¿˜æ˜¯å¼‚æ­¥çš„</strong></p><p>å‡å¦‚æ‰€æœ‰ setState æ˜¯åŒæ­¥çš„ï¼Œæ„å‘³ç€æ¯æ‰§è¡Œä¸€æ¬¡ setState æ—¶ï¼ˆæœ‰å¯èƒ½ä¸€ä¸ªåŒæ­¥ä»£ç ä¸­ï¼Œå¤šæ¬¡ setStateï¼‰ï¼Œéƒ½é‡æ–° vnode diff + dom ä¿®æ”¹ï¼Œè¿™å¯¹æ€§èƒ½æ¥è¯´æ˜¯æä¸ºä¸å¥½çš„ã€‚å¦‚æœæ˜¯å¼‚æ­¥ï¼Œåˆ™å¯ä»¥æŠŠä¸€ä¸ªåŒæ­¥ä»£ç ä¸­çš„å¤šä¸ª setState åˆå¹¶æˆä¸€æ¬¡ç»„ä»¶æ›´æ–°ã€‚æ‰€ä»¥é»˜è®¤æ˜¯å¼‚æ­¥çš„ï¼Œä½†æ˜¯åœ¨ä¸€äº›æƒ…å†µä¸‹æ˜¯åŒæ­¥çš„ã€‚</p><p>setState å¹¶ä¸æ˜¯å•çº¯åŒæ­¥/å¼‚æ­¥çš„ï¼Œå®ƒçš„è¡¨ç°ä¼šå› è°ƒç”¨åœºæ™¯çš„ä¸åŒè€Œä¸åŒã€‚åœ¨æºç ä¸­ï¼Œé€šè¿‡ isBatchingUpdates æ¥åˆ¤æ–­ setState æ˜¯å…ˆå­˜è¿› state é˜Ÿåˆ—è¿˜æ˜¯ç›´æ¥æ›´æ–°ï¼Œå¦‚æœå€¼ä¸º true åˆ™æ‰§è¡Œå¼‚æ­¥æ“ä½œï¼Œä¸º false åˆ™ç›´æ¥æ›´æ–°ã€‚</p><ul><li><strong>å¼‚æ­¥ï¼š</strong> åœ¨ React å¯ä»¥æ§åˆ¶çš„åœ°æ–¹ï¼Œå°±ä¸º trueï¼Œæ¯”å¦‚åœ¨ React ç”Ÿå‘½å‘¨æœŸäº‹ä»¶å’Œåˆæˆäº‹ä»¶ä¸­ï¼Œéƒ½ä¼šèµ°åˆå¹¶æ“ä½œï¼Œå»¶è¿Ÿæ›´æ–°çš„ç­–ç•¥ã€‚</li><li><strong>åŒæ­¥ï¼š</strong> åœ¨ React æ— æ³•æ§åˆ¶çš„åœ°æ–¹ï¼Œæ¯”å¦‚åŸç”Ÿäº‹ä»¶ï¼Œå…·ä½“å°±æ˜¯åœ¨ addEventListener ã€setTimeoutã€setInterval ç­‰äº‹ä»¶ä¸­ï¼Œå°±åªèƒ½åŒæ­¥æ›´æ–°ã€‚</li></ul><p>ä¸€èˆ¬è®¤ä¸ºï¼Œåšå¼‚æ­¥è®¾è®¡æ˜¯ä¸ºäº†æ€§èƒ½ä¼˜åŒ–ã€å‡å°‘æ¸²æŸ“æ¬¡æ•°ï¼š</p><ul><li><code>setState</code>è®¾è®¡ä¸ºå¼‚æ­¥ï¼Œå¯ä»¥æ˜¾è‘—çš„æå‡æ€§èƒ½ã€‚å¦‚æœæ¯æ¬¡è°ƒç”¨ <code>setState</code>éƒ½è¿›è¡Œä¸€æ¬¡æ›´æ–°ï¼Œé‚£ä¹ˆæ„å‘³ç€<code>render</code>å‡½æ•°ä¼šè¢«é¢‘ç¹è°ƒç”¨ï¼Œç•Œé¢é‡æ–°æ¸²æŸ“ï¼Œè¿™æ ·æ•ˆç‡æ˜¯å¾ˆä½çš„ï¼›æœ€å¥½çš„åŠæ³•åº”è¯¥æ˜¯è·å–åˆ°å¤šä¸ªæ›´æ–°ï¼Œä¹‹åè¿›è¡Œæ‰¹é‡æ›´æ–°ï¼›</li><li>å¦‚æœåŒæ­¥æ›´æ–°äº†<code>state</code>ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰æ‰§è¡Œ<code>render</code>å‡½æ•°ï¼Œé‚£ä¹ˆ<code>state</code>å’Œ<code>props</code>ä¸èƒ½ä¿æŒåŒæ­¥ã€‚<code>state</code>å’Œ<code>props</code>ä¸èƒ½ä¿æŒä¸€è‡´æ€§ï¼Œä¼šåœ¨å¼€å‘ä¸­äº§ç”Ÿå¾ˆå¤šçš„é—®é¢˜ï¼›</li></ul><h3 id="3-React-ä¸­çš„-setState-æ‰¹é‡æ›´æ–°çš„è¿‡ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#3-React-ä¸­çš„-setState-æ‰¹é‡æ›´æ–°çš„è¿‡ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="3. React ä¸­çš„ setState æ‰¹é‡æ›´æ–°çš„è¿‡ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ"></a>3. React ä¸­çš„ setState æ‰¹é‡æ›´æ–°çš„è¿‡ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>è°ƒç”¨ <code>setState</code> æ—¶ï¼Œç»„ä»¶çš„ <code>state</code> å¹¶ä¸ä¼šç«‹å³æ”¹å˜ï¼Œ <code>setState</code> åªæ˜¯æŠŠè¦ä¿®æ”¹çš„ <code>state</code> æ”¾å…¥ä¸€ä¸ªé˜Ÿåˆ—ï¼Œ <code>React</code> ä¼šä¼˜åŒ–çœŸæ­£çš„æ‰§è¡Œæ—¶æœºï¼Œå¹¶å‡ºäºæ€§èƒ½åŸå› ï¼Œä¼šå°† <code>React</code> äº‹ä»¶å¤„ç†ç¨‹åºä¸­çš„å¤šæ¬¡<code>React</code> äº‹ä»¶å¤„ç†ç¨‹åºä¸­çš„å¤šæ¬¡ <code>setState</code> çš„çŠ¶æ€ä¿®æ”¹åˆå¹¶æˆä¸€æ¬¡çŠ¶æ€ä¿®æ”¹ã€‚ æœ€ç»ˆæ›´æ–°åªäº§ç”Ÿä¸€æ¬¡ç»„ä»¶åŠå…¶å­ç»„ä»¶çš„é‡æ–°æ¸²æŸ“ï¼Œè¿™å¯¹äºå¤§å‹åº”ç”¨ç¨‹åºä¸­çš„æ€§èƒ½æå‡è‡³å…³é‡è¦ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  count<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>count <span class="token operator">+</span> <span class="token number">1</span>    <span class="token operator">===</span><span class="token operator">></span>    å…¥é˜Ÿï¼Œ<span class="token punctuation">[</span>count<span class="token operator">+</span><span class="token number">1</span>çš„ä»»åŠ¡<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  count<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>count <span class="token operator">+</span> <span class="token number">1</span>    <span class="token operator">===</span><span class="token operator">></span>    å…¥é˜Ÿï¼Œ<span class="token punctuation">[</span>count<span class="token operator">+</span><span class="token number">1</span>çš„ä»»åŠ¡ï¼Œcount<span class="token operator">+</span><span class="token number">1</span>çš„ä»»åŠ¡<span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                          â†“                                         åˆå¹¶ stateï¼Œ<span class="token punctuation">[</span>count<span class="token operator">+</span><span class="token number">1</span>çš„ä»»åŠ¡<span class="token punctuation">]</span>                                          â†“                                         æ‰§è¡Œ count<span class="token operator">+</span><span class="token number">1</span>çš„ä»»åŠ¡<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåªè¦åŒæ­¥ä»£ç è¿˜åœ¨æ‰§è¡Œï¼Œâ€œæ”’èµ·æ¥â€è¿™ä¸ªåŠ¨ä½œå°±ä¸ä¼šåœæ­¢ã€‚ï¼ˆæ³¨ï¼šè¿™é‡Œä¹‹æ‰€ä»¥å¤šæ¬¡ +1 æœ€ç»ˆåªæœ‰ä¸€æ¬¡ç”Ÿæ•ˆï¼Œæ˜¯å› ä¸ºåœ¨åŒä¸€ä¸ªæ–¹æ³•ä¸­å¤šæ¬¡ setState çš„åˆå¹¶åŠ¨ä½œä¸æ˜¯å•çº¯åœ°å°†æ›´æ–°ç´¯åŠ ã€‚æ¯”å¦‚è¿™é‡Œå¯¹äºç›¸åŒå±æ€§çš„è®¾ç½®ï¼ŒReact åªä¼šä¸ºå…¶ä¿ç•™æœ€åä¸€æ¬¡çš„æ›´æ–°ï¼‰ã€‚</p><h3 id="4-React-ä¸­æœ‰ä½¿ç”¨è¿‡-getDefaultProps-å—ï¼Ÿå®ƒæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ"><a href="#4-React-ä¸­æœ‰ä½¿ç”¨è¿‡-getDefaultProps-å—ï¼Ÿå®ƒæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ" class="headerlink" title="4. React ä¸­æœ‰ä½¿ç”¨è¿‡ getDefaultProps å—ï¼Ÿå®ƒæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ"></a>4. React ä¸­æœ‰ä½¿ç”¨è¿‡ getDefaultProps å—ï¼Ÿå®ƒæœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</h3><p>é€šè¿‡å®ç°ç»„ä»¶çš„ getDefaultPropsï¼Œå¯¹å±æ€§è®¾ç½®é»˜è®¤å€¼ï¼ˆES5 çš„å†™æ³•ï¼‰ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">var</span> ShowTitle <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createClass</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  getDefaultProps<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token punctuation">{</span>      title<span class="token punctuation">:</span> <span class="token string">"React"</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  render<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token operator">&lt;</span>h1<span class="token operator">></span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-React-ä¸­-setState-çš„ç¬¬äºŒä¸ªå‚æ•°ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#5-React-ä¸­-setState-çš„ç¬¬äºŒä¸ªå‚æ•°ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="5. React ä¸­ setState çš„ç¬¬äºŒä¸ªå‚æ•°ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ"></a>5. React ä¸­ setState çš„ç¬¬äºŒä¸ªå‚æ•°ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><code>setState</code> çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¯é€‰çš„å›è°ƒå‡½æ•°ã€‚è¿™ä¸ªå›è°ƒå‡½æ•°å°†åœ¨ç»„ä»¶é‡æ–°æ¸²æŸ“åæ‰§è¡Œã€‚ç­‰ä»·äºåœ¨ <code>componentDidUpdate</code> ç”Ÿå‘½å‘¨æœŸå†…æ‰§è¡Œã€‚é€šå¸¸å»ºè®®ä½¿ç”¨ <code>componentDidUpdate</code> æ¥ä»£æ›¿æ­¤æ–¹å¼ã€‚åœ¨è¿™ä¸ªå›è°ƒå‡½æ•°ä¸­ä½ å¯ä»¥æ‹¿åˆ°æ›´æ–°å <code>state</code> çš„å€¼ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>    key1<span class="token punctuation">:</span> newState1<span class="token punctuation">,</span>    key2<span class="token punctuation">:</span> newState2<span class="token punctuation">,</span>    <span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// ç¬¬äºŒä¸ªå‚æ•°æ˜¯ state æ›´æ–°å®Œæˆåçš„å›è°ƒå‡½æ•°</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="6-React-ä¸­çš„-setState-å’Œ-replaceState-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#6-React-ä¸­çš„-setState-å’Œ-replaceState-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="6. React ä¸­çš„ setState å’Œ replaceState çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"></a>6. React ä¸­çš„ setState å’Œ replaceState çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><strong>ï¼ˆ1ï¼‰setState()</strong><br>setState()ç”¨äºè®¾ç½®çŠ¶æ€å¯¹è±¡ï¼Œå…¶è¯­æ³•å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token function">setState</span><span class="token punctuation">(</span>object nextState<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token keyword">function</span> callback<span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>nextStateï¼Œå°†è¦è®¾ç½®çš„æ–°çŠ¶æ€ï¼Œè¯¥çŠ¶æ€ä¼šå’Œå½“å‰çš„ state åˆå¹¶</li><li>callbackï¼Œå¯é€‰å‚æ•°ï¼Œå›è°ƒå‡½æ•°ã€‚è¯¥å‡½æ•°ä¼šåœ¨ setState è®¾ç½®æˆåŠŸï¼Œä¸”ç»„ä»¶é‡æ–°æ¸²æŸ“åè°ƒç”¨ã€‚</li></ul><p>åˆå¹¶ nextState å’Œå½“å‰ stateï¼Œå¹¶é‡æ–°æ¸²æŸ“ç»„ä»¶ã€‚setState æ˜¯ React äº‹ä»¶å¤„ç†å‡½æ•°ä¸­å’Œè¯·æ±‚å›è°ƒå‡½æ•°ä¸­è§¦å‘ UI æ›´æ–°çš„ä¸»è¦æ–¹æ³•ã€‚</p><p><strong>ï¼ˆ2ï¼‰replaceState()</strong><br>replaceState()æ–¹æ³•ä¸ setState()ç±»ä¼¼ï¼Œä½†æ˜¯æ–¹æ³•åªä¼šä¿ç•™ nextState ä¸­çŠ¶æ€ï¼ŒåŸ state ä¸åœ¨ nextState ä¸­çš„çŠ¶æ€éƒ½ä¼šè¢«åˆ é™¤ã€‚å…¶è¯­æ³•å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token function">replaceState</span><span class="token punctuation">(</span>object nextState<span class="token punctuation">[</span><span class="token punctuation">,</span> <span class="token keyword">function</span> callback<span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>nextStateï¼Œå°†è¦è®¾ç½®çš„æ–°çŠ¶æ€ï¼Œè¯¥çŠ¶æ€ä¼šæ›¿æ¢å½“å‰çš„ stateã€‚</li><li>callbackï¼Œå¯é€‰å‚æ•°ï¼Œå›è°ƒå‡½æ•°ã€‚è¯¥å‡½æ•°ä¼šåœ¨ replaceState è®¾ç½®æˆåŠŸï¼Œä¸”ç»„ä»¶é‡æ–°æ¸²æŸ“åè°ƒç”¨ã€‚</li></ul><p><strong>æ€»ç»“ï¼š</strong> setState  æ˜¯ä¿®æ”¹å…¶ä¸­çš„éƒ¨åˆ†çŠ¶æ€ï¼Œç›¸å½“äº Object.assignï¼Œåªæ˜¯è¦†ç›–ï¼Œä¸ä¼šå‡å°‘åŸæ¥çš„çŠ¶æ€ã€‚è€Œ replaceState æ˜¯å®Œå…¨æ›¿æ¢åŸæ¥çš„çŠ¶æ€ï¼Œç›¸å½“äºèµ‹å€¼ï¼Œå°†åŸæ¥çš„ state æ›¿æ¢ä¸ºå¦ä¸€ä¸ªå¯¹è±¡ï¼Œå¦‚æœæ–°çŠ¶æ€å±æ€§å‡å°‘ï¼Œé‚£ä¹ˆ state ä¸­å°±æ²¡æœ‰è¿™ä¸ªçŠ¶æ€äº†ã€‚</p><h3 id="7-åœ¨-React-ä¸­ç»„ä»¶çš„-this-state-å’Œ-setState-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#7-åœ¨-React-ä¸­ç»„ä»¶çš„-this-state-å’Œ-setState-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="7. åœ¨ React ä¸­ç»„ä»¶çš„ this.state å’Œ setState æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>7. åœ¨ React ä¸­ç»„ä»¶çš„ this.state å’Œ setState æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>this.state é€šå¸¸æ˜¯ç”¨æ¥åˆå§‹åŒ– state çš„ï¼Œthis.setState æ˜¯ç”¨æ¥ä¿®æ”¹ state å€¼çš„ã€‚å¦‚æœåˆå§‹åŒ–äº† state ä¹‹åå†ä½¿ç”¨ this.stateï¼Œä¹‹å‰çš„ state ä¼šè¢«è¦†ç›–æ‰ï¼Œå¦‚æœä½¿ç”¨ this.setStateï¼Œåªä¼šæ›¿æ¢æ‰ç›¸åº”çš„ state å€¼ã€‚æ‰€ä»¥ï¼Œå¦‚æœæƒ³è¦ä¿®æ”¹ state çš„å€¼ï¼Œå°±éœ€è¦ä½¿ç”¨ setStateï¼Œè€Œä¸èƒ½ç›´æ¥ä¿®æ”¹ stateï¼Œç›´æ¥ä¿®æ”¹ state ä¹‹åé¡µé¢æ˜¯ä¸ä¼šæ›´æ–°çš„ã€‚</p><h3 id="8-state-æ˜¯æ€ä¹ˆæ³¨å…¥åˆ°ç»„ä»¶çš„ï¼Œä»-reducer-åˆ°ç»„ä»¶ç»å†äº†ä»€ä¹ˆæ ·çš„è¿‡ç¨‹"><a href="#8-state-æ˜¯æ€ä¹ˆæ³¨å…¥åˆ°ç»„ä»¶çš„ï¼Œä»-reducer-åˆ°ç»„ä»¶ç»å†äº†ä»€ä¹ˆæ ·çš„è¿‡ç¨‹" class="headerlink" title="8. state æ˜¯æ€ä¹ˆæ³¨å…¥åˆ°ç»„ä»¶çš„ï¼Œä» reducer åˆ°ç»„ä»¶ç»å†äº†ä»€ä¹ˆæ ·çš„è¿‡ç¨‹"></a>8. state æ˜¯æ€ä¹ˆæ³¨å…¥åˆ°ç»„ä»¶çš„ï¼Œä» reducer åˆ°ç»„ä»¶ç»å†äº†ä»€ä¹ˆæ ·çš„è¿‡ç¨‹</h3><p>é€šè¿‡ connect å’Œ mapStateToProps å°† state æ³¨å…¥åˆ°ç»„ä»¶ä¸­ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> connect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react-redux"</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token punctuation">{</span> setVisibilityFilter <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@/reducers/Todo/actions"</span><span class="token punctuation">;</span><span class="token keyword">import</span> Link <span class="token keyword">from</span> <span class="token string">"@/containers/Todo/components/Link"</span><span class="token punctuation">;</span><span class="token keyword">const</span> mapStateToProps <span class="token operator">=</span> <span class="token punctuation">(</span>state<span class="token punctuation">,</span> ownProps<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>  active<span class="token punctuation">:</span> ownProps<span class="token punctuation">.</span>filter <span class="token operator">===</span> state<span class="token punctuation">.</span>visibilityFilter<span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">const</span> mapDispatchToProps <span class="token operator">=</span> <span class="token punctuation">(</span>dispatch<span class="token punctuation">,</span> ownProps<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>  setFilter<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">setVisibilityFilter</span><span class="token punctuation">(</span>ownProps<span class="token punctuation">.</span>filter<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">,</span> mapDispatchToProps<span class="token punctuation">)</span><span class="token punctuation">(</span>Link<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸Šé¢ä»£ç ä¸­ï¼Œactive å°±æ˜¯æ³¨å…¥åˆ° Link ç»„ä»¶ä¸­çš„çŠ¶æ€ã€‚ mapStateToPropsï¼ˆstateï¼ŒownPropsï¼‰ä¸­å¸¦æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œå«ä¹‰æ˜¯ âˆ¶</p><ul><li>state-store ç®¡ç†çš„å…¨å±€çŠ¶æ€å¯¹è±¡ï¼Œæ‰€æœ‰éƒ½ç»„ä»¶çŠ¶æ€æ•°æ®éƒ½å­˜å‚¨åœ¨è¯¥å¯¹è±¡ä¸­ã€‚</li><li>ownProps ç»„ä»¶é€šè¿‡ props ä¼ å…¥çš„å‚æ•°ã€‚</li></ul><p><strong>reducer åˆ°ç»„ä»¶ç»å†çš„è¿‡ç¨‹ï¼š</strong></p><ul><li>reducer å¯¹ action å¯¹è±¡å¤„ç†ï¼Œæ›´æ–°ç»„ä»¶çŠ¶æ€ï¼Œå¹¶å°†æ–°çš„çŠ¶æ€å€¼è¿”å› storeã€‚</li><li>é€šè¿‡ connectï¼ˆmapStateToPropsï¼ŒmapDispatchToPropsï¼‰ï¼ˆComponentï¼‰å¯¹ç»„ä»¶ Component è¿›è¡Œå‡çº§ï¼Œæ­¤æ—¶å°†çŠ¶æ€å€¼ä» store å–å‡ºå¹¶ä½œä¸º props å‚æ•°ä¼ é€’åˆ°ç»„ä»¶ã€‚</li></ul><p><strong>é«˜é˜¶ç»„ä»¶å®ç°æºç  âˆ¶</strong></p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">"react"</span><span class="token punctuation">;</span><span class="token keyword">import</span> PropTypes <span class="token keyword">from</span> <span class="token string">"prop-types"</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// é«˜é˜¶ç»„ä»¶ contect</span><span class="token keyword">export</span> <span class="token keyword">const</span> connect <span class="token operator">=</span>  <span class="token punctuation">(</span>mapStateToProps<span class="token punctuation">,</span> mapDispatchToProps<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">(</span>WrappedComponent<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">class</span> <span class="token class-name">Connect</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>      <span class="token comment" spellcheck="true">// é€šè¿‡å¯¹contextè°ƒç”¨è·å–store</span>      <span class="token keyword">static</span> contextTypes <span class="token operator">=</span> <span class="token punctuation">{</span>        store<span class="token punctuation">:</span> PropTypes<span class="token punctuation">.</span>object<span class="token punctuation">,</span>      <span class="token punctuation">}</span><span class="token punctuation">;</span>      <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>          allProps<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token punctuation">}</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>      <span class="token comment" spellcheck="true">// ç¬¬ä¸€ééœ€åˆå§‹åŒ–æ‰€æœ‰ç»„ä»¶åˆå§‹çŠ¶æ€</span>      <span class="token function">componentWillMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span>store<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_updateProps</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        store<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">_updateProps</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// åŠ å…¥_updateProps()è‡³storeé‡Œçš„ç›‘å¬äº‹ä»¶åˆ—è¡¨</span>      <span class="token punctuation">}</span>      <span class="token comment" spellcheck="true">// æ‰§è¡Œactionåæ›´æ–°propsï¼Œä½¿ç»„ä»¶å¯ä»¥æ›´æ–°è‡³æœ€æ–°çŠ¶æ€ï¼ˆç±»ä¼¼äºsetStateï¼‰</span>      <span class="token function">_updateProps</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span>store<span class="token punctuation">;</span>        <span class="token keyword">let</span> stateProps <span class="token operator">=</span> mapStateToProps          <span class="token operator">?</span> <span class="token function">mapStateToProps</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">)</span>          <span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// é˜²æ­¢ mapStateToProps æ²¡æœ‰ä¼ å…¥</span>        <span class="token keyword">let</span> dispatchProps <span class="token operator">=</span> mapDispatchToProps          <span class="token operator">?</span> <span class="token function">mapDispatchToProps</span><span class="token punctuation">(</span>store<span class="token punctuation">.</span>dispatch<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">)</span>          <span class="token punctuation">:</span> <span class="token punctuation">{</span>              dispatch<span class="token punctuation">:</span> store<span class="token punctuation">.</span>dispatch<span class="token punctuation">,</span>            <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// é˜²æ­¢ mapDispatchToProps æ²¡æœ‰ä¼ å…¥</span>        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>          allProps<span class="token punctuation">:</span> <span class="token punctuation">{</span>            <span class="token operator">...</span>stateProps<span class="token punctuation">,</span>            <span class="token operator">...</span>dispatchProps<span class="token punctuation">,</span>            <span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">,</span>          <span class="token punctuation">}</span><span class="token punctuation">,</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>      <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token operator">&lt;</span>WrappedComponent <span class="token punctuation">{</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>allProps<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> Connect<span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="9-React-ç»„ä»¶çš„-state-å’Œ-props-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#9-React-ç»„ä»¶çš„-state-å’Œ-props-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="9. React ç»„ä»¶çš„ state å’Œ props æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>9. React ç»„ä»¶çš„ state å’Œ props æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p><strong>ï¼ˆ1ï¼‰props</strong></p><p>props æ˜¯ä¸€ä¸ªä»å¤–éƒ¨ä¼ è¿›ç»„ä»¶çš„å‚æ•°ï¼Œä¸»è¦ä½œä¸ºå°±æ˜¯ä»çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’æ•°æ®ï¼Œå®ƒå…·æœ‰å¯è¯»æ€§å’Œä¸å˜æ€§ï¼Œåªèƒ½é€šè¿‡å¤–éƒ¨ç»„ä»¶ä¸»åŠ¨ä¼ å…¥æ–°çš„ props æ¥é‡æ–°æ¸²æŸ“å­ç»„ä»¶ï¼Œå¦åˆ™å­ç»„ä»¶çš„ props ä»¥åŠå±•ç°å½¢å¼ä¸ä¼šæ”¹å˜ã€‚</p><p><strong>ï¼ˆ2ï¼‰state</strong></p><p>state çš„ä¸»è¦ä½œç”¨æ˜¯ç”¨äºç»„ä»¶ä¿å­˜ã€æ§åˆ¶ä»¥åŠä¿®æ”¹è‡ªå·±çš„çŠ¶æ€ï¼Œå®ƒåªèƒ½åœ¨ constructor ä¸­åˆå§‹åŒ–ï¼Œå®ƒç®—æ˜¯ç»„ä»¶çš„ç§æœ‰å±æ€§ï¼Œä¸å¯é€šè¿‡å¤–éƒ¨è®¿é—®å’Œä¿®æ”¹ï¼Œåªèƒ½é€šè¿‡ç»„ä»¶å†…éƒ¨çš„ this.setState æ¥ä¿®æ”¹ï¼Œä¿®æ”¹ state å±æ€§ä¼šå¯¼è‡´ç»„ä»¶çš„é‡æ–°æ¸²æŸ“ã€‚</p><p><strong>ï¼ˆ3ï¼‰åŒºåˆ«</strong></p><ul><li>props æ˜¯ä¼ é€’ç»™ç»„ä»¶çš„ï¼ˆç±»ä¼¼äºå‡½æ•°çš„å½¢å‚ï¼‰ï¼Œè€Œ state æ˜¯åœ¨ç»„ä»¶å†…è¢«ç»„ä»¶è‡ªå·±ç®¡ç†çš„ï¼ˆç±»ä¼¼äºåœ¨ä¸€ä¸ªå‡½æ•°å†…å£°æ˜çš„å˜é‡ï¼‰ã€‚</li><li>props æ˜¯ä¸å¯ä¿®æ”¹çš„ï¼Œæ‰€æœ‰ React ç»„ä»¶éƒ½å¿…é¡»åƒçº¯å‡½æ•°ä¸€æ ·ä¿æŠ¤å®ƒä»¬çš„ props ä¸è¢«æ›´æ”¹ã€‚</li><li>state æ˜¯åœ¨ç»„ä»¶ä¸­åˆ›å»ºçš„ï¼Œä¸€èˆ¬åœ¨ constructor ä¸­åˆå§‹åŒ– stateã€‚state æ˜¯å¤šå˜çš„ã€å¯ä»¥ä¿®æ”¹ï¼Œæ¯æ¬¡ setState éƒ½å¼‚æ­¥æ›´æ–°çš„ã€‚</li></ul><h3 id="10-React-ä¸­çš„-props-ä¸ºä»€ä¹ˆæ˜¯åªè¯»çš„ï¼Ÿ"><a href="#10-React-ä¸­çš„-props-ä¸ºä»€ä¹ˆæ˜¯åªè¯»çš„ï¼Ÿ" class="headerlink" title="10. React ä¸­çš„ props ä¸ºä»€ä¹ˆæ˜¯åªè¯»çš„ï¼Ÿ"></a>10. React ä¸­çš„ props ä¸ºä»€ä¹ˆæ˜¯åªè¯»çš„ï¼Ÿ</h3><p><code>this.props</code>æ˜¯ç»„ä»¶ä¹‹é—´æ²Ÿé€šçš„ä¸€ä¸ªæ¥å£ï¼ŒåŸåˆ™ä¸Šæ¥è®²ï¼Œå®ƒåªèƒ½ä»çˆ¶ç»„ä»¶æµå‘å­ç»„ä»¶ã€‚React å…·æœ‰æµ“é‡çš„å‡½æ•°å¼ç¼–ç¨‹çš„æ€æƒ³ã€‚</p><p>æåˆ°å‡½æ•°å¼ç¼–ç¨‹å°±è¦æä¸€ä¸ªæ¦‚å¿µï¼šçº¯å‡½æ•°ã€‚å®ƒæœ‰å‡ ä¸ªç‰¹ç‚¹ï¼š</p><ul><li>ç»™å®šç›¸åŒçš„è¾“å…¥ï¼Œæ€»æ˜¯è¿”å›ç›¸åŒçš„è¾“å‡ºã€‚</li><li>è¿‡ç¨‹æ²¡æœ‰å‰¯ä½œç”¨ã€‚</li><li>ä¸ä¾èµ–å¤–éƒ¨çŠ¶æ€ã€‚</li></ul><p><code>this.props</code>å°±æ˜¯æ±²å–äº†çº¯å‡½æ•°çš„æ€æƒ³ã€‚props çš„ä¸å¯ä»¥å˜æ€§å°±ä¿è¯çš„ç›¸åŒçš„è¾“å…¥ï¼Œé¡µé¢æ˜¾ç¤ºçš„å†…å®¹æ˜¯ä¸€æ ·çš„ï¼Œå¹¶ä¸”ä¸ä¼šäº§ç”Ÿå‰¯ä½œç”¨</p><h3 id="11-åœ¨-React-ä¸­ç»„ä»¶çš„-props-æ”¹å˜æ—¶æ›´æ–°ç»„ä»¶çš„æœ‰å“ªäº›æ–¹æ³•ï¼Ÿ"><a href="#11-åœ¨-React-ä¸­ç»„ä»¶çš„-props-æ”¹å˜æ—¶æ›´æ–°ç»„ä»¶çš„æœ‰å“ªäº›æ–¹æ³•ï¼Ÿ" class="headerlink" title="11. åœ¨ React ä¸­ç»„ä»¶çš„ props æ”¹å˜æ—¶æ›´æ–°ç»„ä»¶çš„æœ‰å“ªäº›æ–¹æ³•ï¼Ÿ"></a>11. åœ¨ React ä¸­ç»„ä»¶çš„ props æ”¹å˜æ—¶æ›´æ–°ç»„ä»¶çš„æœ‰å“ªäº›æ–¹æ³•ï¼Ÿ</h3><p>åœ¨ä¸€ä¸ªç»„ä»¶ä¼ å…¥çš„ props æ›´æ–°æ—¶é‡æ–°æ¸²æŸ“è¯¥ç»„ä»¶å¸¸ç”¨çš„æ–¹æ³•æ˜¯åœ¨<code>componentWillReceiveProps</code>ä¸­å°†æ–°çš„ props æ›´æ–°åˆ°ç»„ä»¶çš„ state ä¸­ï¼ˆè¿™ç§ state è¢«æˆä¸ºæ´¾ç”ŸçŠ¶æ€ï¼ˆDerived Stateï¼‰ï¼‰ï¼Œä»è€Œå®ç°é‡æ–°æ¸²æŸ“ã€‚React 16.3 ä¸­è¿˜å¼•å…¥äº†ä¸€ä¸ªæ–°çš„é’©å­å‡½æ•°<code>getDerivedStateFromProps</code>æ¥ä¸“é—¨å®ç°è¿™ä¸€éœ€æ±‚ã€‚</p><p><strong>ï¼ˆ1ï¼‰componentWillReceivePropsï¼ˆå·²åºŸå¼ƒï¼‰</strong></p><p>åœ¨ react çš„ componentWillReceiveProps(nextProps)ç”Ÿå‘½å‘¨æœŸä¸­ï¼Œå¯ä»¥åœ¨å­ç»„ä»¶çš„ render å‡½æ•°æ‰§è¡Œå‰ï¼Œé€šè¿‡ this.props è·å–æ—§çš„å±æ€§ï¼Œé€šè¿‡ nextProps è·å–æ–°çš„ propsï¼Œå¯¹æ¯”ä¸¤æ¬¡ props æ˜¯å¦ç›¸åŒï¼Œä»è€Œæ›´æ–°å­ç»„ä»¶è‡ªå·±çš„ stateã€‚</p><p>è¿™æ ·çš„å¥½å¤„æ˜¯ï¼Œå¯ä»¥å°†æ•°æ®è¯·æ±‚æ”¾åœ¨è¿™é‡Œè¿›è¡Œæ‰§è¡Œï¼Œéœ€è¦ä¼ çš„å‚æ•°åˆ™ä» componentWillReceiveProps(nextProps)ä¸­è·å–ã€‚è€Œä¸å¿…å°†æ‰€æœ‰çš„è¯·æ±‚éƒ½æ”¾åœ¨çˆ¶ç»„ä»¶ä¸­ã€‚äºæ˜¯è¯¥è¯·æ±‚åªä¼šåœ¨è¯¥ç»„ä»¶æ¸²æŸ“æ—¶æ‰ä¼šå‘å‡ºï¼Œä»è€Œå‡è½»è¯·æ±‚è´Ÿæ‹…ã€‚</p><p><strong>ï¼ˆ2ï¼‰getDerivedStateFromPropsï¼ˆ16.3 å¼•å…¥ï¼‰</strong></p><p>è¿™ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°æ˜¯ä¸ºäº†æ›¿ä»£<code>componentWillReceiveProps</code>å­˜åœ¨çš„ï¼Œæ‰€ä»¥åœ¨éœ€è¦ä½¿ç”¨<code>componentWillReceiveProps</code>æ—¶ï¼Œå°±å¯ä»¥è€ƒè™‘ä½¿ç”¨<code>getDerivedStateFromProps</code>æ¥è¿›è¡Œæ›¿ä»£ã€‚</p><p>ä¸¤è€…çš„å‚æ•°æ˜¯ä¸ç›¸åŒçš„ï¼Œè€Œ<code>getDerivedStateFromProps</code>æ˜¯ä¸€ä¸ªé™æ€å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªå‡½æ•°ä¸èƒ½é€šè¿‡ this è®¿é—®åˆ° class çš„å±æ€§ï¼Œä¹Ÿå¹¶ä¸æ¨èç›´æ¥è®¿é—®å±æ€§ã€‚è€Œæ˜¯åº”è¯¥é€šè¿‡å‚æ•°æä¾›çš„ nextProps ä»¥åŠ prevState æ¥è¿›è¡Œåˆ¤æ–­ï¼Œæ ¹æ®æ–°ä¼ å…¥çš„ props æ¥æ˜ å°„åˆ° stateã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>å¦‚æœ props ä¼ å…¥çš„å†…å®¹ä¸éœ€è¦å½±å“åˆ°ä½ çš„ stateï¼Œé‚£ä¹ˆå°±éœ€è¦è¿”å›ä¸€ä¸ª null</strong>ï¼Œè¿™ä¸ªè¿”å›å€¼æ˜¯å¿…é¡»çš„ï¼Œæ‰€ä»¥å°½é‡å°†å…¶å†™åˆ°å‡½æ•°çš„æœ«å°¾ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">static</span> <span class="token function">getDerivedStateFromProps</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">,</span> prevState<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span>type<span class="token punctuation">}</span> <span class="token operator">=</span> nextProps<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// å½“ä¼ å…¥çš„typeå‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œæ›´æ–°state</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">!==</span> prevState<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token punctuation">{</span>            type<span class="token punctuation">,</span>        <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// å¦åˆ™ï¼Œå¯¹äºstateä¸è¿›è¡Œä»»ä½•æ“ä½œ</span>    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="12-React-ä¸­æ€ä¹ˆæ£€éªŒ-propsï¼ŸéªŒè¯-props-çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#12-React-ä¸­æ€ä¹ˆæ£€éªŒ-propsï¼ŸéªŒè¯-props-çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="12. React ä¸­æ€ä¹ˆæ£€éªŒ propsï¼ŸéªŒè¯ props çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ"></a>12. React ä¸­æ€ä¹ˆæ£€éªŒ propsï¼ŸéªŒè¯ props çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p><strong>React</strong>ä¸ºæˆ‘ä»¬æä¾›äº†<strong>PropTypes</strong>ä»¥ä¾›éªŒè¯ä½¿ç”¨ã€‚å½“æˆ‘ä»¬å‘<strong>Props</strong>ä¼ å…¥çš„æ•°æ®æ— æ•ˆï¼ˆå‘ Props ä¼ å…¥çš„æ•°æ®ç±»å‹å’ŒéªŒè¯çš„æ•°æ®ç±»å‹ä¸ç¬¦ï¼‰å°±ä¼šåœ¨æ§åˆ¶å°å‘å‡ºè­¦å‘Šä¿¡æ¯ã€‚å®ƒå¯ä»¥é¿å…éšç€åº”ç”¨è¶Šæ¥è¶Šå¤æ‚ä»è€Œå‡ºç°çš„é—®é¢˜ã€‚å¹¶ä¸”ï¼Œå®ƒè¿˜å¯ä»¥è®©ç¨‹åºå˜å¾—æ›´æ˜“è¯»ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> PropTypes <span class="token keyword">from</span> <span class="token string">"prop-types"</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name">Greeting</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token operator">&lt;</span>h1<span class="token operator">></span>Hello<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span>Greeting<span class="token punctuation">.</span>propTypes <span class="token operator">=</span> <span class="token punctuation">{</span>  name<span class="token punctuation">:</span> PropTypes<span class="token punctuation">.</span>string<span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å½“ç„¶ï¼Œå¦‚æœé¡¹ç›®æ±‡ä¸­ä½¿ç”¨äº† TypeScriptï¼Œé‚£ä¹ˆå°±å¯ä»¥ä¸ç”¨ PropTypes æ¥æ ¡éªŒï¼Œè€Œä½¿ç”¨ TypeScript å®šä¹‰æ¥å£æ¥æ ¡éªŒ propsã€‚</p><h2 id="ä¸‰ã€ç”Ÿå‘½å‘¨æœŸ"><a href="#ä¸‰ã€ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="ä¸‰ã€ç”Ÿå‘½å‘¨æœŸ"></a>ä¸‰ã€ç”Ÿå‘½å‘¨æœŸ</h2><h3 id="1-React-çš„ç”Ÿå‘½å‘¨æœŸæœ‰å“ªäº›ï¼Ÿ"><a href="#1-React-çš„ç”Ÿå‘½å‘¨æœŸæœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="1. React çš„ç”Ÿå‘½å‘¨æœŸæœ‰å“ªäº›ï¼Ÿ"></a>1. React çš„ç”Ÿå‘½å‘¨æœŸæœ‰å“ªäº›ï¼Ÿ</h3><p>React é€šå¸¸å°†ç»„ä»¶ç”Ÿå‘½å‘¨æœŸåˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š</p><ul><li>è£…è½½é˜¶æ®µï¼ˆMountï¼‰ï¼Œç»„ä»¶ç¬¬ä¸€æ¬¡åœ¨ DOM æ ‘ä¸­è¢«æ¸²æŸ“çš„è¿‡ç¨‹ï¼›</li><li>æ›´æ–°è¿‡ç¨‹ï¼ˆUpdateï¼‰ï¼Œç»„ä»¶çŠ¶æ€å‘ç”Ÿå˜åŒ–ï¼Œé‡æ–°æ›´æ–°æ¸²æŸ“çš„è¿‡ç¨‹ï¼›</li><li>å¸è½½è¿‡ç¨‹ï¼ˆUnmountï¼‰ï¼Œç»„ä»¶ä» DOM æ ‘ä¸­è¢«ç§»é™¤çš„è¿‡ç¨‹ï¼›</li></ul><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/react/5.png" alt="image.png"></p><h4 id="1ï¼‰ç»„ä»¶æŒ‚è½½é˜¶æ®µ"><a href="#1ï¼‰ç»„ä»¶æŒ‚è½½é˜¶æ®µ" class="headerlink" title="1ï¼‰ç»„ä»¶æŒ‚è½½é˜¶æ®µ"></a>1ï¼‰ç»„ä»¶æŒ‚è½½é˜¶æ®µ</h4><p>æŒ‚è½½é˜¶æ®µç»„ä»¶è¢«åˆ›å»ºï¼Œç„¶åç»„ä»¶å®ä¾‹æ’å…¥åˆ° DOM ä¸­ï¼Œå®Œæˆç»„ä»¶çš„ç¬¬ä¸€æ¬¡æ¸²æŸ“ï¼Œè¯¥è¿‡ç¨‹åªä¼šå‘ç”Ÿä¸€æ¬¡ï¼Œåœ¨æ­¤é˜¶æ®µä¼šä¾æ¬¡è°ƒç”¨ä»¥ä¸‹è¿™äº›æ–¹æ³•ï¼š</p><ul><li>constructor</li><li>getDerivedStateFromProps</li><li>render</li><li>componentDidMount</li></ul><h5 id="ï¼ˆ1ï¼‰constructor"><a href="#ï¼ˆ1ï¼‰constructor" class="headerlink" title="ï¼ˆ1ï¼‰constructor"></a>ï¼ˆ1ï¼‰constructor</h5><p>ç»„ä»¶çš„æ„é€ å‡½æ•°ï¼Œç¬¬ä¸€ä¸ªè¢«æ‰§è¡Œï¼Œè‹¥æ²¡æœ‰æ˜¾å¼å®šä¹‰å®ƒï¼Œä¼šæœ‰ä¸€ä¸ªé»˜è®¤çš„æ„é€ å‡½æ•°ï¼Œä½†æ˜¯è‹¥æ˜¾å¼å®šä¹‰äº†æ„é€ å‡½æ•°ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨æ„é€ å‡½æ•°ä¸­æ‰§è¡Œ <code>super(props)</code>ï¼Œå¦åˆ™æ— æ³•åœ¨æ„é€ å‡½æ•°ä¸­æ‹¿åˆ° thisã€‚</p><p>å¦‚æœä¸åˆå§‹åŒ– state æˆ–ä¸è¿›è¡Œæ–¹æ³•ç»‘å®šï¼Œåˆ™ä¸éœ€è¦ä¸º React ç»„ä»¶å®ç°æ„é€ å‡½æ•°<strong>Constructor</strong>ã€‚</p><p>constructor ä¸­é€šå¸¸åªåšä¸¤ä»¶äº‹ï¼š</p><ul><li>åˆå§‹åŒ–ç»„ä»¶çš„ state</li><li>ç»™äº‹ä»¶å¤„ç†æ–¹æ³•ç»‘å®š this</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// ä¸è¦åœ¨æ„é€ å‡½æ•°ä¸­è°ƒç”¨ setStateï¼Œå¯ä»¥ç›´æ¥ç»™ state è®¾ç½®åˆå§‹å€¼</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span> counter<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token punctuation">}</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>handleClick <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>handleClick<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="ï¼ˆ2ï¼‰getDerivedStateFromProps"><a href="#ï¼ˆ2ï¼‰getDerivedStateFromProps" class="headerlink" title="ï¼ˆ2ï¼‰getDerivedStateFromProps"></a>ï¼ˆ2ï¼‰getDerivedStateFromProps</h5><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">static</span> <span class="token function">getDerivedStateFromProps</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> state<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™æ˜¯ä¸ªé™æ€æ–¹æ³•ï¼Œæ‰€ä»¥ä¸èƒ½åœ¨è¿™ä¸ªå‡½æ•°é‡Œä½¿ç”¨ <code>this</code>ï¼Œæœ‰ä¸¤ä¸ªå‚æ•° <code>props</code> å’Œ <code>state</code>ï¼Œåˆ†åˆ«æŒ‡æ¥æ”¶åˆ°çš„æ–°å‚æ•°å’Œå½“å‰ç»„ä»¶çš„ <code>state</code> å¯¹è±¡ï¼Œè¿™ä¸ªå‡½æ•°ä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ç”¨æ¥æ›´æ–°å½“å‰çš„ <code>state</code> å¯¹è±¡ï¼Œå¦‚æœä¸éœ€è¦æ›´æ–°å¯ä»¥è¿”å› <code>null</code>ã€‚</p><p>è¯¥å‡½æ•°ä¼šåœ¨è£…è½½æ—¶ï¼Œæ¥æ”¶åˆ°æ–°çš„ <code>props</code> æˆ–è€…è°ƒç”¨äº† <code>setState</code> å’Œ <code>forceUpdate</code> æ—¶è¢«è°ƒç”¨ã€‚å¦‚å½“æ¥æ”¶åˆ°æ–°çš„å±æ€§æƒ³ä¿®æ”¹ <code>state</code> ï¼Œå°±å¯ä»¥ä½¿ç”¨ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// å½“ props.counter å˜åŒ–æ—¶ï¼Œèµ‹å€¼ç»™ state</span><span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>      counter<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">static</span> <span class="token function">getDerivedStateFromProps</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> state<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>props<span class="token punctuation">.</span>counter <span class="token operator">!==</span> state<span class="token punctuation">.</span>counter<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">return</span> <span class="token punctuation">{</span>        counter<span class="token punctuation">:</span> props<span class="token punctuation">.</span>counter<span class="token punctuation">,</span>      <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  handleClick <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>      counter<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>counter <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>div<span class="token operator">></span>        <span class="token operator">&lt;</span>h1 onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleClick<span class="token punctuation">}</span><span class="token operator">></span>Hello<span class="token punctuation">,</span> world<span class="token operator">!</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>counter<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span>      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç°åœ¨å¯ä»¥æ˜¾å¼ä¼ å…¥ <code>counter</code> ï¼Œä½†æ˜¯è¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼Œå¦‚æœæƒ³è¦é€šè¿‡ç‚¹å‡»å®ç° <code>state.counter</code> çš„å¢åŠ ï¼Œä½†è¿™æ—¶ä¼šå‘ç°å€¼ä¸ä¼šå‘ç”Ÿä»»ä½•å˜åŒ–ï¼Œä¸€ç›´ä¿æŒ <code>props</code> ä¼ è¿›æ¥çš„å€¼ã€‚è¿™æ˜¯ç”±äºåœ¨ React 16.4^ çš„ç‰ˆæœ¬ä¸­ <code>setState</code> å’Œ <code>forceUpdate</code> ä¹Ÿä¼šè§¦å‘è¿™ä¸ªç”Ÿå‘½å‘¨æœŸï¼Œæ‰€ä»¥å½“ç»„ä»¶å†…éƒ¨ <code>state</code> å˜åŒ–åï¼Œå°±ä¼šé‡æ–°èµ°è¿™ä¸ªæ–¹æ³•ï¼ŒåŒæ—¶ä¼šæŠŠ <code>state</code> å€¼èµ‹å€¼ä¸º <code>props</code> çš„å€¼ã€‚å› æ­¤éœ€è¦å¤šåŠ ä¸€ä¸ªå­—æ®µæ¥è®°å½•ä¹‹å‰çš„ <code>props</code> å€¼ï¼Œè¿™æ ·å°±ä¼šè§£å†³ä¸Šè¿°é—®é¢˜ã€‚å…·ä½“å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// è¿™é‡Œåªåˆ—å‡ºéœ€è¦å˜åŒ–çš„åœ°æ–¹</span><span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>      <span class="token comment" spellcheck="true">// å¢åŠ ä¸€ä¸ª preCounter æ¥è®°å½•ä¹‹å‰çš„ props ä¼ æ¥çš„å€¼</span>      preCounter<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>      counter<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token keyword">static</span> <span class="token function">getDerivedStateFromProps</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> state<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// è·Ÿ state.preCounter è¿›è¡Œæ¯”è¾ƒ</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>props<span class="token punctuation">.</span>counter <span class="token operator">!==</span> state<span class="token punctuation">.</span>preCounter<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">return</span> <span class="token punctuation">{</span>        counter<span class="token punctuation">:</span> props<span class="token punctuation">.</span>counter<span class="token punctuation">,</span>        preCounter<span class="token punctuation">:</span> props<span class="token punctuation">.</span>counter<span class="token punctuation">,</span>      <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  handleClick <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>      counter<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>counter <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>div<span class="token operator">></span>        <span class="token operator">&lt;</span>h1 onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleClick<span class="token punctuation">}</span><span class="token operator">></span>Hello<span class="token punctuation">,</span> world<span class="token operator">!</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>counter<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span>      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h5 id="ï¼ˆ3ï¼‰render"><a href="#ï¼ˆ3ï¼‰render" class="headerlink" title="ï¼ˆ3ï¼‰render"></a>ï¼ˆ3ï¼‰render</h5><p>render æ˜¯ React ä¸­æœ€æ ¸å¿ƒçš„æ–¹æ³•ï¼Œä¸€ä¸ªç»„ä»¶ä¸­å¿…é¡»è¦æœ‰è¿™ä¸ªæ–¹æ³•ï¼Œå®ƒä¼šæ ¹æ®çŠ¶æ€ <code>state</code> å’Œå±æ€§ <code>props</code> æ¸²æŸ“ç»„ä»¶ã€‚è¿™ä¸ªå‡½æ•°åªåšä¸€ä»¶äº‹ï¼Œå°±æ˜¯è¿”å›éœ€è¦æ¸²æŸ“çš„å†…å®¹ï¼Œæ‰€ä»¥ä¸è¦åœ¨è¿™ä¸ªå‡½æ•°å†…åšå…¶ä»–ä¸šåŠ¡é€»è¾‘ï¼Œé€šå¸¸è°ƒç”¨è¯¥æ–¹æ³•ä¼šè¿”å›ä»¥ä¸‹ç±»å‹ä¸­ä¸€ä¸ªï¼š</p><ul><li><strong>React å…ƒç´ </strong>ï¼šè¿™é‡ŒåŒ…æ‹¬åŸç”Ÿçš„ DOM ä»¥åŠ React ç»„ä»¶ï¼›</li><li><strong>æ•°ç»„å’Œ Fragmentï¼ˆç‰‡æ®µï¼‰</strong>ï¼šå¯ä»¥è¿”å›å¤šä¸ªå…ƒç´ ï¼›</li><li><strong>Portalsï¼ˆæ’æ§½ï¼‰</strong>ï¼šå¯ä»¥å°†å­å…ƒç´ æ¸²æŸ“åˆ°ä¸åŒçš„ DOM å­æ ‘ç§ï¼›</li><li><strong>å­—ç¬¦ä¸²å’Œæ•°å­—</strong>ï¼šè¢«æ¸²æŸ“æˆ DOM ä¸­çš„ text èŠ‚ç‚¹ï¼›</li><li><strong>å¸ƒå°”å€¼æˆ– null</strong>ï¼šä¸æ¸²æŸ“ä»»ä½•å†…å®¹ã€‚</li></ul><h5 id="ï¼ˆ4ï¼‰componentDidMount"><a href="#ï¼ˆ4ï¼‰componentDidMount" class="headerlink" title="ï¼ˆ4ï¼‰componentDidMount()"></a>ï¼ˆ4ï¼‰componentDidMount()</h5><p>componentDidMount()ä¼šåœ¨ç»„ä»¶æŒ‚è½½åï¼ˆæ’å…¥ DOM æ ‘ä¸­ï¼‰ç«‹å³è°ƒã€‚è¯¥é˜¶æ®µé€šå¸¸è¿›è¡Œä»¥ä¸‹æ“ä½œï¼š</p><ul><li>æ‰§è¡Œä¾èµ–äº DOM çš„æ“ä½œï¼›</li><li>å‘é€ç½‘ç»œè¯·æ±‚ï¼›ï¼ˆå®˜æ–¹å»ºè®®ï¼‰</li><li>æ·»åŠ è®¢é˜…æ¶ˆæ¯ï¼ˆä¼šåœ¨ componentWillUnmount å–æ¶ˆè®¢é˜…ï¼‰ï¼›</li></ul><p>å¦‚æœåœ¨ <code>componentDidMount</code> ä¸­è°ƒç”¨ <code>setState</code> ï¼Œå°±ä¼šè§¦å‘ä¸€æ¬¡é¢å¤–çš„æ¸²æŸ“ï¼Œå¤šè°ƒç”¨äº†ä¸€æ¬¡ <code>render</code> å‡½æ•°ï¼Œç”±äºå®ƒæ˜¯åœ¨æµè§ˆå™¨åˆ·æ–°å±å¹•å‰æ‰§è¡Œçš„ï¼Œæ‰€ä»¥ç”¨æˆ·å¯¹æ­¤æ˜¯æ²¡æœ‰æ„ŸçŸ¥çš„ï¼Œä½†æ˜¯æˆ‘åº”å½“é¿å…è¿™æ ·ä½¿ç”¨ï¼Œè¿™æ ·ä¼šå¸¦æ¥ä¸€å®šçš„æ€§èƒ½é—®é¢˜ï¼Œå°½é‡æ˜¯åœ¨ <code>constructor</code> ä¸­åˆå§‹åŒ– <code>state</code> å¯¹è±¡ã€‚</p><p>åœ¨ç»„ä»¶è£…è½½ä¹‹åï¼Œå°†è®¡æ•°æ•°å­—å˜ä¸º 1ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>      counter<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>      counter<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"counter"</span><span class="token operator">></span>counterå€¼<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>counter<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2ï¼‰ç»„ä»¶æ›´æ–°é˜¶æ®µ"><a href="#2ï¼‰ç»„ä»¶æ›´æ–°é˜¶æ®µ" class="headerlink" title="2ï¼‰ç»„ä»¶æ›´æ–°é˜¶æ®µ"></a>2ï¼‰ç»„ä»¶æ›´æ–°é˜¶æ®µ</h4><p>å½“ç»„ä»¶çš„ <code>props</code> æ”¹å˜äº†ï¼Œæˆ–ç»„ä»¶å†…éƒ¨è°ƒç”¨äº† <code>setState/forceUpdate</code>ï¼Œä¼šè§¦å‘æ›´æ–°é‡æ–°æ¸²æŸ“ï¼Œè¿™ä¸ªè¿‡ç¨‹å¯èƒ½ä¼šå‘ç”Ÿå¤šæ¬¡ã€‚è¿™ä¸ªé˜¶æ®µä¼šä¾æ¬¡è°ƒç”¨ä¸‹é¢è¿™äº›æ–¹æ³•ï¼š</p><ul><li>getDerivedStateFromProps</li><li>shouldComponentUpdate</li><li>render</li><li>getSnapshotBeforeUpdate</li><li>componentDidUpdate</li></ul><h5 id="ï¼ˆ1ï¼‰shouldComponentUpdate"><a href="#ï¼ˆ1ï¼‰shouldComponentUpdate" class="headerlink" title="ï¼ˆ1ï¼‰shouldComponentUpdate"></a>ï¼ˆ1ï¼‰shouldComponentUpdate</h5><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token function">shouldComponentUpdate</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">,</span> nextState<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åœ¨è¯´è¿™ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¹‹å‰ï¼Œæ¥çœ‹ä¸¤ä¸ªé—®é¢˜ï¼š</p><ul><li><strong>setState å‡½æ•°åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½ä¼šå¯¼è‡´ç»„ä»¶é‡æ–°æ¸²æŸ“å—ï¼Ÿä¾‹å¦‚ä¸‹é¢è¿™ç§æƒ…å†µï¼š</strong></li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> number<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>number <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><strong>å¦‚æœæ²¡æœ‰è°ƒç”¨ setStateï¼Œprops å€¼ä¹Ÿæ²¡æœ‰å˜åŒ–ï¼Œæ˜¯ä¸æ˜¯ç»„ä»¶å°±ä¸ä¼šé‡æ–°æ¸²æŸ“ï¼Ÿ</strong></li></ul><p>ç¬¬ä¸€ä¸ªé—®é¢˜ç­”æ¡ˆæ˜¯ <strong>ä¼š</strong> ï¼Œç¬¬äºŒä¸ªé—®é¢˜å¦‚æœæ˜¯çˆ¶ç»„ä»¶é‡æ–°æ¸²æŸ“æ—¶ï¼Œä¸ç®¡ä¼ å…¥çš„ props æœ‰æ²¡æœ‰å˜åŒ–ï¼Œéƒ½ä¼šå¼•èµ·å­ç»„ä»¶çš„é‡æ–°æ¸²æŸ“ã€‚</p><p>é‚£ä¹ˆæœ‰æ²¡æœ‰ä»€ä¹ˆæ–¹æ³•è§£å†³åœ¨è¿™ä¸¤ä¸ªåœºæ™¯ä¸‹ä¸è®©ç»„ä»¶é‡æ–°æ¸²æŸ“è¿›è€Œæå‡æ€§èƒ½å‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™ <code>shouldComponentUpdate</code> ç™»åœºäº†ï¼Œè¿™ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°æ˜¯ç”¨æ¥æå‡é€Ÿåº¦çš„ï¼Œå®ƒæ˜¯åœ¨é‡æ–°æ¸²æŸ“ç»„ä»¶å¼€å§‹å‰è§¦å‘çš„ï¼Œé»˜è®¤è¿”å› <code>true</code>ï¼Œå¯ä»¥æ¯”è¾ƒ <code>this.props</code> å’Œ <code>nextProps</code> ï¼Œ<code>this.state</code> å’Œ <code>nextState</code> å€¼æ˜¯å¦å˜åŒ–ï¼Œæ¥ç¡®è®¤è¿”å› true æˆ–è€… <code>false</code>ã€‚å½“è¿”å› <code>false</code> æ—¶ï¼Œç»„ä»¶çš„æ›´æ–°è¿‡ç¨‹åœæ­¢ï¼Œåç»­çš„ <code>render</code>ã€<code>componentDidUpdate</code> ä¹Ÿä¸ä¼šè¢«è°ƒç”¨ã€‚</p><p><strong>æ³¨æ„ï¼š</strong> æ·»åŠ  <code>shouldComponentUpdate</code> æ–¹æ³•æ—¶ï¼Œä¸å»ºè®®ä½¿ç”¨æ·±åº¦ç›¸ç­‰æ£€æŸ¥ï¼ˆå¦‚ä½¿ç”¨ <code>JSON.stringify()</code>ï¼‰ï¼Œå› ä¸ºæ·±æ¯”è¾ƒæ•ˆç‡å¾ˆä½ï¼Œå¯èƒ½ä¼šæ¯”é‡æ–°æ¸²æŸ“ç»„ä»¶æ•ˆç‡è¿˜ä½ã€‚è€Œä¸”è¯¥æ–¹æ³•ç»´æŠ¤æ¯”è¾ƒå›°éš¾ï¼Œå»ºè®®ä½¿ç”¨è¯¥æ–¹æ³•ä¼šäº§ç”Ÿæ˜æ˜¾çš„æ€§èƒ½æå‡æ—¶ä½¿ç”¨ã€‚</p><h5 id="ï¼ˆ2ï¼‰getSnapshotBeforeUpdate"><a href="#ï¼ˆ2ï¼‰getSnapshotBeforeUpdate" class="headerlink" title="ï¼ˆ2ï¼‰getSnapshotBeforeUpdate"></a>ï¼ˆ2ï¼‰getSnapshotBeforeUpdate</h5><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token function">getSnapshotBeforeUpdate</span><span class="token punctuation">(</span>prevProps<span class="token punctuation">,</span> prevState<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™ä¸ªæ–¹æ³•åœ¨ <code>render</code> ä¹‹åï¼Œ<code>componentDidUpdate</code> ä¹‹å‰è°ƒç”¨ï¼Œæœ‰ä¸¤ä¸ªå‚æ•° <code>prevProps</code> å’Œ <code>prevState</code>ï¼Œè¡¨ç¤ºæ›´æ–°ä¹‹å‰çš„ <code>props</code> å’Œ <code>state</code>ï¼Œè¿™ä¸ªå‡½æ•°å¿…é¡»è¦å’Œ <code>componentDidUpdate</code> ä¸€èµ·ä½¿ç”¨ï¼Œå¹¶ä¸”è¦æœ‰ä¸€ä¸ªè¿”å›å€¼ï¼Œé»˜è®¤æ˜¯ <code>null</code>ï¼Œè¿™ä¸ªè¿”å›å€¼ä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°ä¼ ç»™ <code>componentDidUpdate</code>ã€‚</p><h5 id="ï¼ˆ3ï¼‰componentDidUpdate"><a href="#ï¼ˆ3ï¼‰componentDidUpdate" class="headerlink" title="ï¼ˆ3ï¼‰componentDidUpdate"></a>ï¼ˆ3ï¼‰componentDidUpdate</h5><p>componentDidUpdate() ä¼šåœ¨æ›´æ–°åä¼šè¢«ç«‹å³è°ƒç”¨ï¼Œé¦–æ¬¡æ¸²æŸ“ä¸ä¼šæ‰§è¡Œæ­¤æ–¹æ³•ã€‚ è¯¥é˜¶æ®µé€šå¸¸è¿›è¡Œä»¥ä¸‹æ“ä½œï¼š</p><ul><li>å½“ç»„ä»¶æ›´æ–°åï¼Œå¯¹ DOM è¿›è¡Œæ“ä½œï¼›</li><li>å¦‚æœä½ å¯¹æ›´æ–°å‰åçš„ props è¿›è¡Œäº†æ¯”è¾ƒï¼Œä¹Ÿå¯ä»¥é€‰æ‹©åœ¨æ­¤å¤„è¿›è¡Œç½‘ç»œè¯·æ±‚ï¼›ï¼ˆä¾‹å¦‚ï¼Œå½“ props æœªå‘ç”Ÿå˜åŒ–æ—¶ï¼Œåˆ™ä¸ä¼šæ‰§è¡Œç½‘ç»œè¯·æ±‚ï¼‰ã€‚</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token function">componentDidUpdate</span><span class="token punctuation">(</span>prevProps<span class="token punctuation">,</span> prevState<span class="token punctuation">,</span> snapshot<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¯¥æ–¹æ³•æœ‰ä¸‰ä¸ªå‚æ•°ï¼š</p><ul><li>prevProps: æ›´æ–°å‰çš„ props</li><li>prevState: æ›´æ–°å‰çš„ state</li><li>snapshot: getSnapshotBeforeUpdate()ç”Ÿå‘½å‘¨æœŸçš„è¿”å›å€¼</li></ul><h4 id="3ï¼‰ç»„ä»¶å¸è½½é˜¶æ®µ"><a href="#3ï¼‰ç»„ä»¶å¸è½½é˜¶æ®µ" class="headerlink" title="3ï¼‰ç»„ä»¶å¸è½½é˜¶æ®µ"></a>3ï¼‰ç»„ä»¶å¸è½½é˜¶æ®µ</h4><p>å¸è½½é˜¶æ®µåªæœ‰ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼ŒcomponentWillUnmount() ä¼šåœ¨ç»„ä»¶å¸è½½åŠé”€æ¯ä¹‹å‰ç›´æ¥è°ƒç”¨ã€‚åœ¨æ­¤æ–¹æ³•ä¸­æ‰§è¡Œå¿…è¦çš„æ¸…ç†æ“ä½œï¼š</p><ul><li>æ¸…é™¤ timerï¼Œå–æ¶ˆç½‘ç»œè¯·æ±‚æˆ–æ¸…é™¤</li><li>å–æ¶ˆåœ¨ componentDidMount() ä¸­åˆ›å»ºçš„è®¢é˜…ç­‰ï¼›</li></ul><p>è¿™ä¸ªç”Ÿå‘½å‘¨æœŸåœ¨ä¸€ä¸ªç»„ä»¶è¢«å¸è½½å’Œé”€æ¯ä¹‹å‰è¢«è°ƒç”¨ï¼Œå› æ­¤ä½ ä¸åº”è¯¥å†è¿™ä¸ªæ–¹æ³•ä¸­ä½¿ç”¨ <code>setState</code>ï¼Œå› ä¸ºç»„ä»¶ä¸€æ—¦è¢«å¸è½½ï¼Œå°±ä¸ä¼šå†è£…è½½ï¼Œä¹Ÿå°±ä¸ä¼šé‡æ–°æ¸²æŸ“ã€‚</p><h4 id="4ï¼‰é”™è¯¯å¤„ç†é˜¶æ®µ"><a href="#4ï¼‰é”™è¯¯å¤„ç†é˜¶æ®µ" class="headerlink" title="4ï¼‰é”™è¯¯å¤„ç†é˜¶æ®µ"></a>4ï¼‰é”™è¯¯å¤„ç†é˜¶æ®µ</h4><p>componentDidCatch(error, info)ï¼Œæ­¤ç”Ÿå‘½å‘¨æœŸåœ¨åä»£ç»„ä»¶æŠ›å‡ºé”™è¯¯åè¢«è°ƒç”¨ã€‚ å®ƒæ¥æ”¶ä¸¤ä¸ªå‚æ•° âˆ¶</p><ul><li>errorï¼šæŠ›å‡ºçš„é”™è¯¯ã€‚</li><li>infoï¼šå¸¦æœ‰ componentStack key çš„å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«æœ‰å…³ç»„ä»¶å¼•å‘é”™è¯¯çš„æ ˆä¿¡æ¯</li></ul><p>React å¸¸è§çš„ç”Ÿå‘½å‘¨æœŸå¦‚ä¸‹ï¼š<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/react/6.png" alt="image.png"><br><strong>React å¸¸è§ç”Ÿå‘½å‘¨æœŸçš„è¿‡ç¨‹å¤§è‡´å¦‚ä¸‹ï¼š</strong></p><ul><li>æŒ‚è½½é˜¶æ®µï¼Œé¦–å…ˆæ‰§è¡Œ constructor æ„é€ æ–¹æ³•ï¼Œæ¥åˆ›å»ºç»„ä»¶</li><li>åˆ›å»ºå®Œæˆä¹‹åï¼Œå°±ä¼šæ‰§è¡Œ render æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šè¿”å›éœ€è¦æ¸²æŸ“çš„å†…å®¹</li><li>éšåï¼ŒReact ä¼šå°†éœ€è¦æ¸²æŸ“çš„å†…å®¹æŒ‚è½½åˆ° DOM æ ‘ä¸Š</li><li><strong>æŒ‚è½½å®Œæˆä¹‹åå°±ä¼šæ‰§è¡Œ componentDidMount ç”Ÿå‘½å‘¨æœŸå‡½æ•°</strong></li><li>å¦‚æœæˆ‘ä»¬ç»™ç»„ä»¶åˆ›å»ºä¸€ä¸ª propsï¼ˆç”¨äºç»„ä»¶é€šä¿¡ï¼‰ã€è°ƒç”¨ setStateï¼ˆæ›´æ”¹ state ä¸­çš„æ•°æ®ï¼‰ã€è°ƒç”¨ forceUpdateï¼ˆå¼ºåˆ¶æ›´æ–°ç»„ä»¶ï¼‰æ—¶ï¼Œéƒ½ä¼šé‡æ–°è°ƒç”¨ render å‡½æ•°</li><li>render å‡½æ•°é‡æ–°æ‰§è¡Œä¹‹åï¼Œå°±ä¼šé‡æ–°è¿›è¡Œ DOM æ ‘çš„æŒ‚è½½</li><li><strong>æŒ‚è½½å®Œæˆä¹‹åå°±ä¼šæ‰§è¡Œ componentDidUpdate ç”Ÿå‘½å‘¨æœŸå‡½æ•°</strong></li><li><strong>å½“ç§»é™¤ç»„ä»¶æ—¶ï¼Œå°±ä¼šæ‰§è¡Œ componentWillUnmount ç”Ÿå‘½å‘¨æœŸå‡½æ•°</strong></li></ul><p><strong>React ä¸»è¦ç”Ÿå‘½å‘¨æœŸæ€»ç»“ï¼š</strong></p><ol><li><strong>getDefaultProps</strong>ï¼šè¿™ä¸ªå‡½æ•°ä¼šåœ¨ç»„ä»¶åˆ›å»ºä¹‹å‰è¢«è°ƒç”¨ä¸€æ¬¡ï¼ˆæœ‰ä¸”ä»…æœ‰ä¸€æ¬¡ï¼‰ï¼Œå®ƒè¢«ç”¨æ¥åˆå§‹åŒ–ç»„ä»¶çš„ Propsï¼›</li><li><strong>getInitialState</strong>ï¼šç”¨äºåˆå§‹åŒ–ç»„ä»¶çš„ state å€¼ï¼›</li><li><strong>componentWillMount</strong>ï¼šåœ¨ç»„ä»¶åˆ›å»ºåã€render ä¹‹å‰ï¼Œä¼šèµ°åˆ° componentWillMount é˜¶æ®µã€‚è¿™ä¸ªé˜¶æ®µæˆ‘ä¸ªäººä¸€ç›´æ²¡ç”¨è¿‡ã€éå¸¸é¸¡è‚‹ã€‚åæ¥ React å®˜æ–¹å·²ç»ä¸æ¨èå¤§å®¶åœ¨ componentWillMount é‡Œåšä»»ä½•äº‹æƒ…ã€åˆ°ç°åœ¨ <strong>React16 ç›´æ¥åºŸå¼ƒäº†è¿™ä¸ªç”Ÿå‘½å‘¨æœŸ</strong>ï¼Œè¶³è§å…¶é¸¡è‚‹ç¨‹åº¦äº†ï¼›</li><li><strong>render</strong>ï¼šè¿™æ˜¯æ‰€æœ‰ç”Ÿå‘½å‘¨æœŸä¸­å”¯ä¸€ä¸€ä¸ªä½ å¿…é¡»è¦å®ç°çš„æ–¹æ³•ã€‚ä¸€èˆ¬æ¥è¯´éœ€è¦è¿”å›ä¸€ä¸ª jsx å…ƒç´ ï¼Œè¿™æ—¶ React ä¼šæ ¹æ® props å’Œ state æ¥æŠŠç»„ä»¶æ¸²æŸ“åˆ°ç•Œé¢ä¸Šï¼›ä¸è¿‡æœ‰æ—¶ï¼Œä½ å¯èƒ½ä¸æƒ³æ¸²æŸ“ä»»ä½•ä¸œè¥¿ï¼Œè¿™ç§æƒ…å†µä¸‹è®©å®ƒè¿”å› null æˆ–è€… false å³å¯ï¼›</li><li><strong>componentDidMount</strong>ï¼šä¼šåœ¨ç»„ä»¶æŒ‚è½½åï¼ˆæ’å…¥ DOM æ ‘ä¸­åï¼‰ç«‹å³è°ƒç”¨ï¼Œæ ‡å¿—ç€ç»„ä»¶æŒ‚è½½å®Œæˆã€‚ä¸€äº›æ“ä½œå¦‚æœä¾èµ–è·å–åˆ° DOM èŠ‚ç‚¹ä¿¡æ¯ï¼Œæˆ‘ä»¬å°±ä¼šæ”¾åœ¨è¿™ä¸ªé˜¶æ®µæ¥åšã€‚æ­¤å¤–ï¼Œè¿™è¿˜æ˜¯ React å®˜æ–¹æ¨èçš„å‘èµ· ajax è¯·æ±‚çš„æ—¶æœºã€‚è¯¥æ–¹æ³•å’Œ componentWillMount ä¸€æ ·ï¼Œæœ‰ä¸”ä»…æœ‰ä¸€æ¬¡è°ƒç”¨ã€‚</li></ol><h3 id="2-React-åºŸå¼ƒäº†å“ªäº›ç”Ÿå‘½å‘¨æœŸï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ"><a href="#2-React-åºŸå¼ƒäº†å“ªäº›ç”Ÿå‘½å‘¨æœŸï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ" class="headerlink" title="2. React åºŸå¼ƒäº†å“ªäº›ç”Ÿå‘½å‘¨æœŸï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ"></a>2. React åºŸå¼ƒäº†å“ªäº›ç”Ÿå‘½å‘¨æœŸï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</h3><p>è¢«åºŸå¼ƒçš„ä¸‰ä¸ªå‡½æ•°éƒ½æ˜¯åœ¨ render ä¹‹å‰ï¼Œå› ä¸º fber çš„å‡ºç°ï¼Œå¾ˆå¯èƒ½å› ä¸ºé«˜ä¼˜å…ˆçº§ä»»åŠ¡çš„å‡ºç°è€Œæ‰“æ–­ç°æœ‰ä»»åŠ¡å¯¼è‡´å®ƒä»¬ä¼šè¢«æ‰§è¡Œå¤šæ¬¡ã€‚å¦å¤–çš„ä¸€ä¸ªåŸå› åˆ™æ˜¯ï¼ŒReact æƒ³çº¦æŸä½¿ç”¨è€…ï¼Œå¥½çš„æ¡†æ¶èƒ½å¤Ÿè®©äººä¸å¾—å·²å†™å‡ºå®¹æ˜“ç»´æŠ¤å’Œæ‰©å±•çš„ä»£ç ï¼Œè¿™ä¸€ç‚¹åˆæ˜¯ä»ä½•è°ˆèµ·ï¼Œå¯ä»¥ä»æ–°å¢åŠ ä»¥åŠå³å°†åºŸå¼ƒçš„ç”Ÿå‘½å‘¨æœŸåˆ†æå…¥æ‰‹</p><p><strong>1) componentWillMount</strong></p><p>é¦–å…ˆè¿™ä¸ªå‡½æ•°çš„åŠŸèƒ½å®Œå…¨å¯ä»¥ä½¿ç”¨ componentDidMount å’Œ constructor æ¥ä»£æ›¿ï¼Œå¼‚æ­¥è·å–çš„æ•°æ®çš„æƒ…å†µä¸Šé¢å·²ç»è¯´æ˜äº†ï¼Œè€Œå¦‚æœæŠ›å»å¼‚æ­¥è·å–æ•°æ®ï¼Œå…¶ä½™çš„å³æ˜¯åˆå§‹åŒ–è€Œå·²ï¼Œè¿™äº›åŠŸèƒ½éƒ½å¯ä»¥åœ¨ constructor ä¸­æ‰§è¡Œï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œå¦‚æœåœ¨ willMount ä¸­è®¢é˜…äº‹ä»¶ï¼Œä½†åœ¨æœåŠ¡ç«¯è¿™å¹¶ä¸ä¼šæ‰§è¡Œ willUnMount äº‹ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´æœåŠ¡ç«¯ä¼šå¯¼è‡´å†…å­˜æ³„æ¼æ‰€ä»¥ componentWilIMount å®Œå…¨å¯ä»¥ä¸ä½¿ç”¨ï¼Œä½†ä½¿ç”¨è€…æœ‰æ—¶å€™éš¾å…å› ä¸ºå„ ç§å„æ ·çš„æƒ…å†µåœ¨ componentWilMount ä¸­åšä¸€äº›æ“ä½œï¼Œé‚£ä¹ˆ React ä¸ºäº†çº¦æŸå¼€å‘è€…ï¼Œå¹²è„†å°±æŠ›æ‰äº†è¿™ä¸ª API</p><p><strong>2) componentWillReceiveProps</strong></p><p>åœ¨è€ç‰ˆæœ¬çš„ React ä¸­ï¼Œå¦‚æœç»„ä»¶è‡ªèº«çš„æŸä¸ª state è·Ÿå…¶ props å¯†åˆ‡ç›¸å…³çš„è¯ï¼Œä¸€ç›´éƒ½æ²¡æœ‰ä¸€ç§å¾ˆä¼˜é›…çš„å¤„ç†æ–¹å¼å»æ›´æ–° stateï¼Œè€Œæ˜¯éœ€è¦åœ¨ componentWilReceiveProps ä¸­åˆ¤æ–­å‰åä¸¤ä¸ª props æ˜¯å¦ç›¸åŒï¼Œå¦‚æœä¸åŒå†å°†æ–°çš„ props æ›´æ–°åˆ°ç›¸åº”çš„ state ä¸Šå»ã€‚è¿™æ ·åšä¸€æ¥ä¼šç ´å state æ•°æ®çš„å•ä¸€æ•°æ®æºï¼Œå¯¼è‡´ç»„ä»¶çŠ¶æ€å˜å¾—ä¸å¯é¢„æµ‹ï¼Œå¦ä¸€æ–¹é¢ä¹Ÿä¼šå¢åŠ ç»„ä»¶çš„é‡ç»˜æ¬¡æ•°ã€‚ç±»ä¼¼çš„ä¸šåŠ¡éœ€æ±‚ä¹Ÿæœ‰å¾ˆå¤šï¼Œå¦‚ä¸€ä¸ªå¯ä»¥æ¨ªå‘æ»‘åŠ¨çš„åˆ—è¡¨ï¼Œå½“å‰é«˜äº®çš„ Tab æ˜¾ç„¶éš¶å±äºåˆ—è¡¨è‡ªèº«çš„æ—¶ï¼Œæ ¹æ®ä¼ å…¥çš„æŸä¸ªå€¼ï¼Œç›´æ¥å®šä½åˆ°æŸä¸ª Tabã€‚ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼ŒReact å¼•å…¥äº†ç¬¬ä¸€ä¸ªæ–°çš„ç”Ÿå‘½å‘¨æœŸï¼šgetDerivedStateFromPropsã€‚å®ƒæœ‰ä»¥ä¸‹çš„ä¼˜ç‚¹ âˆ¶</p><ul><li>getDSFP æ˜¯é™æ€æ–¹æ³•ï¼Œåœ¨è¿™é‡Œä¸èƒ½ä½¿ç”¨ thisï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œå¼€å‘è€…ä¸èƒ½å†™å‡ºå‰¯ä½œç”¨çš„ä»£ç </li><li>å¼€å‘è€…åªèƒ½é€šè¿‡ prevState è€Œä¸æ˜¯ prevProps æ¥åšå¯¹æ¯”ï¼Œä¿è¯äº† state å’Œ props ä¹‹é—´çš„ç®€å•å…³ç³»ä»¥åŠä¸éœ€è¦å¤„ç†ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶ prevProps ä¸ºç©ºçš„æƒ…å†µ</li><li>åŸºäºç¬¬ä¸€ç‚¹ï¼Œå°†çŠ¶æ€å˜åŒ–ï¼ˆsetStateï¼‰å’Œæ˜‚è´µæ“ä½œï¼ˆtabChangeï¼‰åŒºåˆ†å¼€ï¼Œæ›´åŠ ä¾¿äº render å’Œ commit é˜¶æ®µæ“ä½œæˆ–è€…è¯´ä¼˜åŒ–ã€‚</li></ul><p><strong>3) componentWillUpdate</strong></p><p>ä¸ componentWillReceiveProps ç±»ä¼¼ï¼Œè®¸å¤šå¼€å‘è€…ä¹Ÿä¼šåœ¨ componentWillUpdate ä¸­æ ¹æ® props çš„å˜åŒ–å»è§¦å‘ä¸€äº›å›è°ƒ ã€‚ ä½†ä¸è®ºæ˜¯ componentWilReceiveProps è¿˜ æ˜¯ componentWilUpdateï¼Œéƒ½æœ‰å¯èƒ½åœ¨ä¸€æ¬¡æ›´æ–°ä¸­è¢«è°ƒç”¨å¤šæ¬¡ï¼Œä¹Ÿå°±æ˜¯è¯´å†™åœ¨è¿™é‡Œçš„å›è°ƒå‡½æ•°ä¹Ÿæœ‰å¯èƒ½ä¼šè¢«è°ƒç”¨å¤šæ¬¡ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸å¯å–çš„ã€‚ä¸ componentDidMount ç±» ä¼¼ï¼Œ componentDidUpdate ä¹Ÿä¸å­˜åœ¨è¿™æ ·çš„é—®é¢˜ï¼Œä¸€æ¬¡æ›´æ–°ä¸­ componentDidUpdate åªä¼šè¢«è°ƒç”¨ä¸€æ¬¡ï¼Œæ‰€ä»¥å°†åŸå…ˆå†™åœ¨ componentWillUpdate ä¸­ çš„ å› è°ƒ è¿ ç§» è‡³ componentDidUpdate å°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p>å¦å¤–ä¸€ç§æƒ…å†µåˆ™æ˜¯éœ€è¦è·å– DOM å…ƒç´ çŠ¶æ€ï¼Œä½†æ˜¯ç”±äºåœ¨ fber ä¸­ï¼Œrender å¯æ‰“æ–­ï¼Œå¯èƒ½åœ¨ wilMount ä¸­è·å–åˆ°çš„å…ƒç´ çŠ¶æ€å¾ˆå¯èƒ½ä¸å®é™…éœ€è¦çš„ä¸åŒï¼Œè¿™ä¸ªé€šå¸¸å¯ä»¥ä½¿ç”¨ç¬¬äºŒä¸ªæ–°å¢çš„ç”Ÿå‘½å‡½æ•°çš„è§£å†³ getSnapshotBeforeUpdate(prevProps, prevState)</p><p><strong>4) getSnapshotBeforeUpdate(prevProps, prevState)</strong></p><p>è¿”å›çš„å€¼ä½œä¸º componentDidUpdate çš„ç¬¬ä¸‰ä¸ªå‚æ•°ã€‚ä¸ willMount ä¸åŒçš„æ˜¯ï¼ŒgetSnapshotBeforeUpdate ä¼šåœ¨æœ€ç»ˆç¡®å®šçš„ render æ‰§è¡Œä¹‹å‰æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯èƒ½ä¿è¯å…¶è·å–åˆ°çš„å…ƒç´ çŠ¶æ€ä¸ didUpdate ä¸­è·å–åˆ°çš„å…ƒç´ çŠ¶æ€ç›¸åŒã€‚å®˜æ–¹å‚è€ƒä»£ç ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">ScrollingList</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>listRef <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">getSnapshotBeforeUpdate</span><span class="token punctuation">(</span>prevProps<span class="token punctuation">,</span> prevState<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// æˆ‘ä»¬æ˜¯å¦åœ¨ list ä¸­æ·»åŠ æ–°çš„ items ï¼Ÿ</span>    <span class="token comment" spellcheck="true">// æ•è·æ»šåŠ¨â€‹â€‹ä½ç½®ä»¥ä¾¿æˆ‘ä»¬ç¨åè°ƒæ•´æ»šåŠ¨ä½ç½®ã€‚</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>prevProps<span class="token punctuation">.</span>list<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>list<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>listRef<span class="token punctuation">.</span>current<span class="token punctuation">;</span>      <span class="token keyword">return</span> list<span class="token punctuation">.</span>scrollHeight <span class="token operator">-</span> list<span class="token punctuation">.</span>scrollTop<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">componentDidUpdate</span><span class="token punctuation">(</span>prevProps<span class="token punctuation">,</span> prevState<span class="token punctuation">,</span> snapshot<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// å¦‚æœæˆ‘ä»¬ snapshot æœ‰å€¼ï¼Œè¯´æ˜æˆ‘ä»¬åˆšåˆšæ·»åŠ äº†æ–°çš„ itemsï¼Œ</span>    <span class="token comment" spellcheck="true">// è°ƒæ•´æ»šåŠ¨ä½ç½®ä½¿å¾—è¿™äº›æ–° items ä¸ä¼šå°†æ—§çš„ items æ¨å‡ºè§†å›¾ã€‚</span>    <span class="token comment" spellcheck="true">//ï¼ˆè¿™é‡Œçš„ snapshot æ˜¯ getSnapshotBeforeUpdate çš„è¿”å›å€¼ï¼‰</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>snapshot <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>listRef<span class="token punctuation">.</span>current<span class="token punctuation">;</span>      list<span class="token punctuation">.</span>scrollTop <span class="token operator">=</span> list<span class="token punctuation">.</span>scrollHeight <span class="token operator">-</span> snapshot<span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div ref<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>listRef<span class="token punctuation">}</span><span class="token operator">></span><span class="token punctuation">{</span><span class="token comment" spellcheck="true">/* ...contents... */</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-React-16-X-ä¸­-props-æ”¹å˜ååœ¨å“ªä¸ªç”Ÿå‘½å‘¨æœŸä¸­å¤„ç†"><a href="#3-React-16-X-ä¸­-props-æ”¹å˜ååœ¨å“ªä¸ªç”Ÿå‘½å‘¨æœŸä¸­å¤„ç†" class="headerlink" title="3. React 16.X ä¸­ props æ”¹å˜ååœ¨å“ªä¸ªç”Ÿå‘½å‘¨æœŸä¸­å¤„ç†"></a>3. React 16.X ä¸­ props æ”¹å˜ååœ¨å“ªä¸ªç”Ÿå‘½å‘¨æœŸä¸­å¤„ç†</h3><p><strong>åœ¨ getDerivedStateFromProps ä¸­è¿›è¡Œå¤„ç†ã€‚</strong></p><p>è¿™ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°æ˜¯ä¸ºäº†æ›¿ä»£<code>componentWillReceiveProps</code>å­˜åœ¨çš„ï¼Œæ‰€ä»¥åœ¨éœ€è¦ä½¿ç”¨<code>componentWillReceiveProps</code>æ—¶ï¼Œå°±å¯ä»¥è€ƒè™‘ä½¿ç”¨<code>getDerivedStateFromProps</code>æ¥è¿›è¡Œæ›¿ä»£ã€‚</p><p>ä¸¤è€…çš„å‚æ•°æ˜¯ä¸ç›¸åŒçš„ï¼Œè€Œ<code>getDerivedStateFromProps</code>æ˜¯ä¸€ä¸ªé™æ€å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªå‡½æ•°ä¸èƒ½é€šè¿‡ this è®¿é—®åˆ° class çš„å±æ€§ï¼Œä¹Ÿå¹¶ä¸æ¨èç›´æ¥è®¿é—®å±æ€§ã€‚è€Œæ˜¯åº”è¯¥é€šè¿‡å‚æ•°æä¾›çš„ nextProps ä»¥åŠ prevState æ¥è¿›è¡Œåˆ¤æ–­ï¼Œæ ¹æ®æ–°ä¼ å…¥çš„ props æ¥æ˜ å°„åˆ° stateã€‚</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>å¦‚æœ props ä¼ å…¥çš„å†…å®¹ä¸éœ€è¦å½±å“åˆ°ä½ çš„ stateï¼Œé‚£ä¹ˆå°±éœ€è¦è¿”å›ä¸€ä¸ª null</strong>ï¼Œè¿™ä¸ªè¿”å›å€¼æ˜¯å¿…é¡»çš„ï¼Œæ‰€ä»¥å°½é‡å°†å…¶å†™åˆ°å‡½æ•°çš„æœ«å°¾ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">static</span> <span class="token function">getDerivedStateFromProps</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">,</span> prevState<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span>type<span class="token punctuation">}</span> <span class="token operator">=</span> nextProps<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// å½“ä¼ å…¥çš„typeå‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œæ›´æ–°state</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">!==</span> prevState<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token punctuation">{</span>            type<span class="token punctuation">,</span>        <span class="token punctuation">}</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// å¦åˆ™ï¼Œå¯¹äºstateä¸è¿›è¡Œä»»ä½•æ“ä½œ</span>    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-React-æ€§èƒ½ä¼˜åŒ–åœ¨å“ªä¸ªç”Ÿå‘½å‘¨æœŸï¼Ÿå®ƒä¼˜åŒ–çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#4-React-æ€§èƒ½ä¼˜åŒ–åœ¨å“ªä¸ªç”Ÿå‘½å‘¨æœŸï¼Ÿå®ƒä¼˜åŒ–çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="4. React æ€§èƒ½ä¼˜åŒ–åœ¨å“ªä¸ªç”Ÿå‘½å‘¨æœŸï¼Ÿå®ƒä¼˜åŒ–çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"></a>4. React æ€§èƒ½ä¼˜åŒ–åœ¨å“ªä¸ªç”Ÿå‘½å‘¨æœŸï¼Ÿå®ƒä¼˜åŒ–çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>react çš„çˆ¶çº§ç»„ä»¶çš„ render å‡½æ•°é‡æ–°æ¸²æŸ“ä¼šå¼•èµ·å­ç»„ä»¶çš„ render æ–¹æ³•çš„é‡æ–°æ¸²æŸ“ã€‚ä½†æ˜¯ï¼Œæœ‰çš„æ—¶å€™å­ç»„ä»¶çš„æ¥å—çˆ¶ç»„ä»¶çš„æ•°æ®æ²¡æœ‰å˜åŠ¨ã€‚å­ç»„ä»¶ render çš„æ‰§è¡Œä¼šå½±å“æ€§èƒ½ï¼Œè¿™æ—¶å°±å¯ä»¥ä½¿ç”¨ shouldComponentUpdate æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p>ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token function">shouldComponentUpdate</span><span class="token punctuation">(</span>nexrProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>num <span class="token operator">===</span> nexrProps<span class="token punctuation">.</span>num<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token boolean">false</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>shouldComponentUpdate æä¾›äº†ä¸¤ä¸ªå‚æ•° nextProps å’Œ nextStateï¼Œè¡¨ç¤ºä¸‹ä¸€æ¬¡ props å’Œä¸€æ¬¡ state çš„å€¼ï¼Œå½“å‡½æ•°è¿”å› false æ—¶å€™ï¼Œrender()æ–¹æ³•ä¸æ‰§è¡Œï¼Œç»„ä»¶ä¹Ÿå°±ä¸ä¼šæ¸²æŸ“ï¼Œè¿”å› true æ—¶ï¼Œç»„ä»¶ç…§å¸¸é‡æ¸²æŸ“ã€‚æ­¤æ–¹æ³•å°±æ˜¯æ‹¿å½“å‰ props ä¸­å€¼å’Œä¸‹ä¸€æ¬¡ props ä¸­çš„å€¼è¿›è¡Œå¯¹æ¯”ï¼Œæ•°æ®ç›¸ç­‰æ—¶ï¼Œè¿”å› falseï¼Œåä¹‹è¿”å› trueã€‚</p><p>éœ€è¦æ³¨æ„ï¼Œåœ¨è¿›è¡Œæ–°æ—§å¯¹æ¯”çš„æ—¶å€™ï¼Œæ˜¯<strong>æµ…å¯¹æ¯”ï¼Œ</strong>ä¹Ÿå°±æ˜¯è¯´å¦‚æœæ¯”è¾ƒçš„æ•°æ®æ—¶å¼•ç”¨æ•°æ®ç±»å‹ï¼Œåªè¦æ•°æ®çš„å¼•ç”¨çš„åœ°å€æ²¡å˜ï¼Œå³ä½¿å†…å®¹å˜äº†ï¼Œä¹Ÿä¼šè¢«åˆ¤å®šä¸º trueã€‚</p><p>é¢å¯¹è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹æ³•è¿›è¡Œè§£å†³ï¼š<br>ï¼ˆ1ï¼‰ä½¿ç”¨ setState æ”¹å˜æ•°æ®ä¹‹å‰ï¼Œå…ˆé‡‡ç”¨ ES6 ä¸­ assgin è¿›è¡Œæ‹·è´ï¼Œä½†æ˜¯ assgin åªæ·±æ‹·è´çš„æ•°æ®çš„ç¬¬ä¸€å±‚ï¼Œæ‰€ä»¥è¯´ä¸æ˜¯æœ€å®Œç¾çš„è§£å†³åŠæ³•ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> o2 <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>o2<span class="token punctuation">.</span>student<span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token string">"00000"</span><span class="token punctuation">;</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  obj<span class="token punctuation">:</span> o2<span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ï¼ˆ2ï¼‰ä½¿ç”¨ JSON.parse(JSON.stringfy())è¿›è¡Œæ·±æ‹·è´ï¼Œä½†æ˜¯é‡åˆ°æ•°æ®ä¸º undefined å’Œå‡½æ•°æ—¶å°±ä¼šé”™ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> o2 <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>JSON<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>o2<span class="token punctuation">.</span>student<span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token string">"00000"</span><span class="token punctuation">;</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  obj<span class="token punctuation">:</span> o2<span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-state-å’Œ-props-è§¦å‘æ›´æ–°çš„ç”Ÿå‘½å‘¨æœŸåˆ†åˆ«æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#5-state-å’Œ-props-è§¦å‘æ›´æ–°çš„ç”Ÿå‘½å‘¨æœŸåˆ†åˆ«æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="5. state å’Œ props è§¦å‘æ›´æ–°çš„ç”Ÿå‘½å‘¨æœŸåˆ†åˆ«æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>5. state å’Œ props è§¦å‘æ›´æ–°çš„ç”Ÿå‘½å‘¨æœŸåˆ†åˆ«æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p><strong>state æ›´æ–°æµç¨‹ï¼š</strong><br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/react/7.png" alt=""><br>è¿™ä¸ªè¿‡ç¨‹å½“ä¸­æ¶‰åŠçš„å‡½æ•°ï¼š</p><ol><li>shouldComponentUpdate: å½“ç»„ä»¶çš„ state æˆ– props å‘ç”Ÿæ”¹å˜æ—¶ï¼Œéƒ½ä¼šé¦–å…ˆè§¦å‘è¿™ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°ã€‚å®ƒä¼šæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šnextProps, nextStateâ€”â€”å®ƒä»¬åˆ†åˆ«ä»£è¡¨ä¼ å…¥çš„æ–° props å’Œæ–°çš„ state å€¼ã€‚æ‹¿åˆ°è¿™ä¸¤ä¸ªå€¼ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¸€äº›å¯¹æ¯”é€»è¾‘æ¥å†³å®šæ˜¯å¦æœ‰ re-renderï¼ˆé‡æ¸²æŸ“ï¼‰çš„å¿…è¦äº†ã€‚å¦‚æœè¯¥å‡½æ•°çš„è¿”å›å€¼ä¸º falseï¼Œåˆ™ç”Ÿå‘½å‘¨æœŸç»ˆæ­¢ï¼Œåä¹‹ç»§ç»­ï¼›</li></ol><blockquote><p>æ³¨æ„ï¼šæ­¤æ–¹æ³•ä»…ä½œä¸º<strong>æ€§èƒ½ä¼˜åŒ–çš„æ–¹å¼</strong>è€Œå­˜åœ¨ã€‚ä¸è¦ä¼å›¾ä¾é æ­¤æ–¹æ³•æ¥â€œé˜»æ­¢â€æ¸²æŸ“ï¼Œå› ä¸ºè¿™å¯èƒ½ä¼šäº§ç”Ÿ bugã€‚åº”è¯¥<strong>è€ƒè™‘ä½¿ç”¨å†…ç½®çš„ PureComponent ç»„ä»¶</strong>ï¼Œè€Œä¸æ˜¯æ‰‹åŠ¨ç¼–å†™ <code>shouldComponentUpdate()</code></p></blockquote><ol start="2"><li>componentWillUpdateï¼šå½“ç»„ä»¶çš„ state æˆ– props å‘ç”Ÿæ”¹å˜æ—¶ï¼Œä¼šåœ¨æ¸²æŸ“ä¹‹å‰è°ƒç”¨ componentWillUpdateã€‚componentWillUpdate <strong>æ˜¯ React16 åºŸå¼ƒçš„ä¸‰ä¸ªç”Ÿå‘½å‘¨æœŸä¹‹ä¸€</strong>ã€‚è¿‡å»ï¼Œæˆ‘ä»¬å¯èƒ½å¸Œæœ›èƒ½åœ¨è¿™ä¸ªé˜¶æ®µå»æ”¶é›†ä¸€äº›å¿…è¦çš„ä¿¡æ¯ï¼ˆæ¯”å¦‚æ›´æ–°å‰çš„ DOM ä¿¡æ¯ç­‰ç­‰ï¼‰ï¼Œç°åœ¨æˆ‘ä»¬å®Œå…¨å¯ä»¥åœ¨ React16 çš„ getSnapshotBeforeUpdate ä¸­å»åšè¿™äº›äº‹ï¼›</li><li>componentDidUpdateï¼šcomponentDidUpdate() ä¼šåœ¨ UI æ›´æ–°åä¼šè¢«ç«‹å³è°ƒç”¨ã€‚å®ƒæ¥æ”¶ prevPropsï¼ˆä¸Šä¸€æ¬¡çš„ props å€¼ï¼‰ä½œä¸ºå…¥å‚ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨æ­¤å¤„æˆ‘ä»¬ä»ç„¶å¯ä»¥è¿›è¡Œ props å€¼å¯¹æ¯”ï¼ˆå†æ¬¡è¯´æ˜ componentWillUpdate ç¡®å®é¸¡è‚‹å“ˆï¼‰ã€‚</li></ol><p><strong>â€‹</strong></p><p><strong>props æ›´æ–°æµç¨‹ï¼š</strong><br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/react/8.png" alt=""><br>ç›¸å¯¹äº state æ›´æ–°ï¼Œprops æ›´æ–°åå”¯ä¸€çš„åŒºåˆ«æ˜¯å¢åŠ äº†å¯¹ componentWillReceiveProps çš„è°ƒç”¨ã€‚å…³äº componentWillReceivePropsï¼Œéœ€è¦çŸ¥é“è¿™äº›äº‹æƒ…ï¼š</p><ul><li>componentWillReceivePropsï¼šå®ƒåœ¨ Component æ¥å—åˆ°æ–°çš„ props æ—¶è¢«è§¦å‘ã€‚componentWillReceiveProps ä¼šæ¥æ”¶ä¸€ä¸ªåä¸º nextProps çš„å‚æ•°ï¼ˆå¯¹åº”æ–°çš„ props å€¼ï¼‰ã€‚<strong>è¯¥ç”Ÿå‘½å‘¨æœŸæ˜¯ React16 åºŸå¼ƒæ‰çš„ä¸‰ä¸ªç”Ÿå‘½å‘¨æœŸä¹‹ä¸€</strong>ã€‚åœ¨å®ƒè¢«åºŸå¼ƒå‰ï¼Œå¯ä»¥ç”¨å®ƒæ¥æ¯”è¾ƒ this.props å’Œ nextProps æ¥é‡æ–° setStateã€‚åœ¨ React16 ä¸­ï¼Œç”¨ä¸€ä¸ªç±»ä¼¼çš„æ–°ç”Ÿå‘½å‘¨æœŸ getDerivedStateFromProps æ¥ä»£æ›¿å®ƒã€‚</li></ul><h3 id="6-React-ä¸­å‘èµ·ç½‘ç»œè¯·æ±‚åº”è¯¥åœ¨å“ªä¸ªç”Ÿå‘½å‘¨æœŸä¸­è¿›è¡Œï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ"><a href="#6-React-ä¸­å‘èµ·ç½‘ç»œè¯·æ±‚åº”è¯¥åœ¨å“ªä¸ªç”Ÿå‘½å‘¨æœŸä¸­è¿›è¡Œï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ" class="headerlink" title="6. React ä¸­å‘èµ·ç½‘ç»œè¯·æ±‚åº”è¯¥åœ¨å“ªä¸ªç”Ÿå‘½å‘¨æœŸä¸­è¿›è¡Œï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ"></a>6. React ä¸­å‘èµ·ç½‘ç»œè¯·æ±‚åº”è¯¥åœ¨å“ªä¸ªç”Ÿå‘½å‘¨æœŸä¸­è¿›è¡Œï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</h3><p>å¯¹äºå¼‚æ­¥è¯·æ±‚ï¼Œæœ€å¥½æ”¾åœ¨ componentDidMount ä¸­å»æ“ä½œï¼Œå¯¹äºåŒæ­¥çš„çŠ¶æ€æ”¹å˜ï¼Œå¯ä»¥æ”¾åœ¨ componentWillMount ä¸­ï¼Œä¸€èˆ¬ç”¨çš„æ¯”è¾ƒå°‘ã€‚</p><p>å¦‚æœè®¤ä¸ºåœ¨ componentWillMount é‡Œå‘èµ·è¯·æ±‚èƒ½ææ—©è·å¾—ç»“æœï¼Œè¿™ç§æƒ³æ³•å…¶å®æ˜¯é”™è¯¯çš„ï¼Œé€šå¸¸ componentWillMount æ¯” componentDidMount æ—©ä¸äº†å¤šå°‘å¾®ç§’ï¼Œç½‘ç»œä¸Šä»»ä½•ä¸€ç‚¹å»¶è¿Ÿï¼Œè¿™ä¸€ç‚¹å·®å¼‚éƒ½å¯å¿½ç•¥ä¸è®¡ã€‚</p><p><strong>react çš„ç”Ÿå‘½å‘¨æœŸï¼š</strong> constructor() -&gt; componentWillMount() -&gt; render() -&gt; componentDidMount()</p><p>ä¸Šé¢è¿™äº›æ–¹æ³•çš„è°ƒç”¨æ˜¯æœ‰æ¬¡åºçš„ï¼Œç”±ä¸Šè€Œä¸‹ä¾æ¬¡è°ƒç”¨ã€‚</p><ul><li>constructor è¢«è°ƒç”¨æ˜¯åœ¨ç»„ä»¶å‡†å¤‡è¦æŒ‚è½½çš„æœ€å¼€å§‹ï¼Œæ­¤æ—¶ç»„ä»¶å°šæœªæŒ‚è½½åˆ°ç½‘é¡µä¸Šã€‚</li><li>componentWillMount æ–¹æ³•çš„è°ƒç”¨åœ¨ constructor ä¹‹åï¼Œåœ¨ render ä¹‹å‰ï¼Œåœ¨è¿™æ–¹æ³•é‡Œçš„ä»£ç è°ƒç”¨ setState æ–¹æ³•ä¸ä¼šè§¦å‘é‡æ–° renderï¼Œæ‰€ä»¥å®ƒä¸€èˆ¬ä¸ä¼šç”¨æ¥ä½œåŠ è½½æ•°æ®ä¹‹ç”¨ã€‚</li><li>componentDidMount æ–¹æ³•ä¸­çš„ä»£ç ï¼Œæ˜¯åœ¨ç»„ä»¶å·²ç»å®Œå…¨æŒ‚è½½åˆ°ç½‘é¡µä¸Šæ‰ä¼šè°ƒç”¨è¢«æ‰§è¡Œï¼Œæ‰€ä»¥å¯ä»¥ä¿è¯æ•°æ®çš„åŠ è½½ã€‚æ­¤å¤–ï¼Œåœ¨è¿™æ–¹æ³•ä¸­è°ƒç”¨ setState æ–¹æ³•ï¼Œä¼šè§¦å‘é‡æ–°æ¸²æŸ“ã€‚æ‰€ä»¥ï¼Œå®˜æ–¹è®¾è®¡è¿™ä¸ªæ–¹æ³•å°±æ˜¯ç”¨æ¥åŠ è½½å¤–éƒ¨æ•°æ®ç”¨çš„ï¼Œæˆ–å¤„ç†å…¶ä»–çš„å‰¯ä½œç”¨ä»£ç ã€‚ä¸ç»„ä»¶ä¸Šçš„æ•°æ®æ— å…³çš„åŠ è½½ï¼Œä¹Ÿå¯ä»¥åœ¨ constructor é‡Œåšï¼Œä½† constructor æ˜¯åšç»„ä»¶ state åˆç»åŒ–å·¥ä½œï¼Œå¹¶ä¸æ˜¯åšåŠ è½½æ•°æ®è¿™å·¥ä½œçš„ï¼Œconstructor é‡Œä¹Ÿä¸èƒ½ setStateï¼Œè¿˜æœ‰åŠ è½½çš„æ—¶é—´å¤ªé•¿æˆ–è€…å‡ºé”™ï¼Œé¡µé¢å°±æ— æ³•åŠ è½½å‡ºæ¥ã€‚æ‰€ä»¥æœ‰å‰¯ä½œç”¨çš„ä»£ç éƒ½ä¼šé›†ä¸­åœ¨ componentDidMount æ–¹æ³•é‡Œã€‚</li></ul><p>æ€»ç»“ï¼š</p><ul><li>è·ŸæœåŠ¡å™¨ç«¯æ¸²æŸ“ï¼ˆåŒæ„ï¼‰æœ‰å…³ç³»ï¼Œå¦‚æœåœ¨ componentWillMount é‡Œé¢è·å–æ•°æ®ï¼Œfetch data ä¼šæ‰§è¡Œä¸¤æ¬¡ï¼Œä¸€æ¬¡åœ¨æœåŠ¡å™¨ç«¯ä¸€æ¬¡åœ¨å®¢æˆ·ç«¯ã€‚åœ¨ componentDidMount ä¸­å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒcomponentWillMount åŒæ ·ä¹Ÿä¼š render ä¸¤æ¬¡ã€‚</li><li>åœ¨ componentWillMount ä¸­ fetch dataï¼Œæ•°æ®ä¸€å®šåœ¨ render åæ‰èƒ½åˆ°è¾¾ï¼Œå¦‚æœå¿˜è®°äº†è®¾ç½®åˆå§‹çŠ¶æ€ï¼Œç”¨æˆ·ä½“éªŒä¸å¥½ã€‚</li><li>react16.0 ä»¥åï¼ŒcomponentWillMount å¯èƒ½ä¼šè¢«æ‰§è¡Œå¤šæ¬¡ã€‚</li></ul><h3 id="7-React-16-ä¸­æ–°ç”Ÿå‘½å‘¨æœŸæœ‰å“ªäº›"><a href="#7-React-16-ä¸­æ–°ç”Ÿå‘½å‘¨æœŸæœ‰å“ªäº›" class="headerlink" title="7. React 16 ä¸­æ–°ç”Ÿå‘½å‘¨æœŸæœ‰å“ªäº›"></a>7. React 16 ä¸­æ–°ç”Ÿå‘½å‘¨æœŸæœ‰å“ªäº›</h3><p>å…³äº React16 å¼€å§‹åº”ç”¨çš„æ–°ç”Ÿå‘½å‘¨æœŸï¼š<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/react/9.png" alt=""><br>å¯ä»¥çœ‹å‡ºï¼ŒReact16 è‡ªä¸Šè€Œä¸‹åœ°å¯¹ç”Ÿå‘½å‘¨æœŸåšäº†å¦ä¸€ç§ç»´åº¦çš„è§£è¯»ï¼š</p><ul><li><strong>Render é˜¶æ®µ</strong>ï¼šç”¨äºè®¡ç®—ä¸€äº›å¿…è¦çš„çŠ¶æ€ä¿¡æ¯ã€‚è¿™ä¸ªé˜¶æ®µå¯èƒ½ä¼šè¢« React æš‚åœï¼Œè¿™ä¸€ç‚¹å’Œ React16 å¼•å…¥çš„ Fiber æ¶æ„ï¼ˆæˆ‘ä»¬åé¢ä¼šé‡ç‚¹è®²è§£ï¼‰æ˜¯æœ‰å…³çš„ï¼›</li><li><strong>Pre-commit é˜¶æ®µ</strong>ï¼šæ‰€è°“â€œcommitâ€ï¼Œè¿™é‡ŒæŒ‡çš„æ˜¯â€œæ›´æ–°çœŸæ­£çš„ DOM èŠ‚ç‚¹â€è¿™ä¸ªåŠ¨ä½œã€‚æ‰€è°“ Pre-commitï¼Œå°±æ˜¯è¯´æˆ‘åœ¨è¿™ä¸ªé˜¶æ®µå…¶å®è¿˜å¹¶æ²¡æœ‰å»æ›´æ–°çœŸå®çš„ DOMï¼Œä¸è¿‡ DOM ä¿¡æ¯å·²ç»æ˜¯å¯ä»¥è¯»å–çš„äº†ï¼›</li><li><strong>Commit é˜¶æ®µ</strong>ï¼šåœ¨è¿™ä¸€æ­¥ï¼ŒReact ä¼šå®ŒæˆçœŸå® DOM çš„æ›´æ–°å·¥ä½œã€‚Commit é˜¶æ®µï¼Œæˆ‘ä»¬å¯ä»¥æ‹¿åˆ°çœŸå® DOMï¼ˆåŒ…æ‹¬ refsï¼‰ã€‚</li></ul><p>ä¸æ­¤åŒæ—¶ï¼Œæ–°çš„ç”Ÿå‘½å‘¨æœŸåœ¨æµç¨‹æ–¹é¢ï¼Œä»ç„¶éµå¾ªâ€œæŒ‚è½½â€ã€â€œæ›´æ–°â€ã€â€œå¸è½½â€è¿™ä¸‰ä¸ªå¹¿ä¹‰çš„åˆ’åˆ†æ–¹å¼ã€‚å®ƒä»¬åˆ†åˆ«å¯¹åº”åˆ°ï¼š</p><ul><li>æŒ‚è½½è¿‡ç¨‹ï¼š<ul><li><strong>constructor</strong></li><li><strong>getDerivedStateFromProps</strong></li><li><strong>render</strong></li><li><strong>componentDidMount</strong></li></ul></li><li>æ›´æ–°è¿‡ç¨‹ï¼š<ul><li><strong>getDerivedStateFromProps</strong></li><li><strong>shouldComponentUpdate</strong></li><li><strong>render</strong></li><li><strong>getSnapshotBeforeUpdate</strong></li><li><strong>componentDidUpdate</strong></li></ul></li><li>å¸è½½è¿‡ç¨‹ï¼š<ul><li><strong>componentWillUnmount</strong></li></ul></li></ul><h2 id="å››ã€ç»„ä»¶é€šä¿¡"><a href="#å››ã€ç»„ä»¶é€šä¿¡" class="headerlink" title="å››ã€ç»„ä»¶é€šä¿¡"></a>å››ã€ç»„ä»¶é€šä¿¡</h2><p>React ç»„ä»¶é—´é€šä¿¡å¸¸è§çš„å‡ ç§æƒ…å†µ:</p><ul><li>çˆ¶ç»„ä»¶å‘å­ç»„ä»¶é€šä¿¡</li><li>å­ç»„ä»¶å‘çˆ¶ç»„ä»¶é€šä¿¡</li><li>è·¨çº§ç»„ä»¶é€šä¿¡</li><li>éåµŒå¥—å…³ç³»çš„ç»„ä»¶é€šä¿¡</li></ul><h3 id="1-çˆ¶å­ç»„ä»¶çš„é€šä¿¡æ–¹å¼ï¼Ÿ"><a href="#1-çˆ¶å­ç»„ä»¶çš„é€šä¿¡æ–¹å¼ï¼Ÿ" class="headerlink" title="1. çˆ¶å­ç»„ä»¶çš„é€šä¿¡æ–¹å¼ï¼Ÿ"></a>1. çˆ¶å­ç»„ä»¶çš„é€šä¿¡æ–¹å¼ï¼Ÿ</h3><p><strong>çˆ¶ç»„ä»¶å‘å­ç»„ä»¶é€šä¿¡</strong>ï¼šçˆ¶ç»„ä»¶é€šè¿‡ props å‘å­ç»„ä»¶ä¼ é€’éœ€è¦çš„ä¿¡æ¯ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// å­ç»„ä»¶: Child</span><span class="token keyword">const</span> Child <span class="token operator">=</span> <span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token operator">&lt;</span>p<span class="token operator">></span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// çˆ¶ç»„ä»¶ Parent</span><span class="token keyword">const</span> Parent <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token operator">&lt;</span>Child name<span class="token operator">=</span><span class="token string">"react"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>Child<span class="token operator">></span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>å­ç»„ä»¶å‘çˆ¶ç»„ä»¶é€šä¿¡</strong>ï¼š: props+å›è°ƒçš„æ–¹å¼ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// å­ç»„ä»¶: Child</span><span class="token keyword">const</span> Child <span class="token operator">=</span> <span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> cb <span class="token operator">=</span> <span class="token punctuation">(</span>msg<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>      props<span class="token punctuation">.</span><span class="token function">callback</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token function">cb</span><span class="token punctuation">(</span><span class="token string">"ä½ å¥½!"</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span>ä½ å¥½<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">></span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// çˆ¶ç»„ä»¶ Parent</span><span class="token keyword">class</span> <span class="token class-name">Parent</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>  <span class="token function">callback</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token operator">&lt;</span>Child callback<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>callback<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>Child<span class="token operator">></span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-è·¨çº§ç»„ä»¶çš„é€šä¿¡æ–¹å¼ï¼Ÿ"><a href="#2-è·¨çº§ç»„ä»¶çš„é€šä¿¡æ–¹å¼ï¼Ÿ" class="headerlink" title="2. è·¨çº§ç»„ä»¶çš„é€šä¿¡æ–¹å¼ï¼Ÿ"></a>2. è·¨çº§ç»„ä»¶çš„é€šä¿¡æ–¹å¼ï¼Ÿ</h3><p>çˆ¶ç»„ä»¶å‘å­ç»„ä»¶çš„å­ç»„ä»¶é€šä¿¡ï¼Œå‘æ›´æ·±å±‚å­ç»„ä»¶é€šä¿¡ï¼š</p><ul><li>ä½¿ç”¨ propsï¼Œåˆ©ç”¨ä¸­é—´ç»„ä»¶å±‚å±‚ä¼ é€’,ä½†æ˜¯å¦‚æœçˆ¶ç»„ä»¶ç»“æ„è¾ƒæ·±ï¼Œé‚£ä¹ˆä¸­é—´æ¯ä¸€å±‚ç»„ä»¶éƒ½è¦å»ä¼ é€’ propsï¼Œå¢åŠ äº†å¤æ‚åº¦ï¼Œå¹¶ä¸”è¿™äº› props å¹¶ä¸æ˜¯ä¸­é—´ç»„ä»¶è‡ªå·±éœ€è¦çš„ã€‚</li><li>ä½¿ç”¨ contextï¼Œcontext ç›¸å½“äºä¸€ä¸ªå¤§å®¹å™¨ï¼Œå¯ä»¥æŠŠè¦é€šä¿¡çš„å†…å®¹æ”¾åœ¨è¿™ä¸ªå®¹å™¨ä¸­ï¼Œè¿™æ ·ä¸ç®¡åµŒå¥—å¤šæ·±ï¼Œéƒ½å¯ä»¥éšæ„å–ç”¨ï¼Œå¯¹äºè·¨è¶Šå¤šå±‚çš„å…¨å±€æ•°æ®å¯ä»¥ä½¿ç”¨ context å®ç°ã€‚</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// contextæ–¹å¼å®ç°è·¨çº§ç»„ä»¶é€šä¿¡</span><span class="token comment" spellcheck="true">// Context è®¾è®¡ç›®çš„æ˜¯ä¸ºäº†å…±äº«é‚£äº›å¯¹äºä¸€ä¸ªç»„ä»¶æ ‘è€Œè¨€æ˜¯â€œå…¨å±€â€çš„æ•°æ®</span><span class="token keyword">const</span> BatteryContext <span class="token operator">=</span> <span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">//  å­ç»„ä»¶çš„å­ç»„ä»¶</span><span class="token keyword">class</span> <span class="token class-name">GrandChild</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>BatteryContext<span class="token punctuation">.</span>Consumer<span class="token operator">></span>        <span class="token punctuation">{</span><span class="token punctuation">(</span>color<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token operator">&lt;</span>h1 style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> color<span class="token punctuation">:</span> color <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">></span>æˆ‘æ˜¯çº¢è‰²çš„<span class="token punctuation">:</span><span class="token punctuation">{</span>color<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">}</span>      <span class="token operator">&lt;</span><span class="token operator">/</span>BatteryContext<span class="token punctuation">.</span>Consumer<span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">//  å­ç»„ä»¶</span><span class="token keyword">const</span> Child <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">return</span> <span class="token operator">&lt;</span>GrandChild <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// çˆ¶ç»„ä»¶</span><span class="token keyword">class</span> <span class="token class-name">Parent</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>  state <span class="token operator">=</span> <span class="token punctuation">{</span>    color<span class="token punctuation">:</span> <span class="token string">"red"</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> <span class="token punctuation">{</span> color <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>      <span class="token operator">&lt;</span>BatteryContext<span class="token punctuation">.</span>Provider value<span class="token operator">=</span><span class="token punctuation">{</span>color<span class="token punctuation">}</span><span class="token operator">></span>        <span class="token operator">&lt;</span>Child<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>Child<span class="token operator">></span>      <span class="token operator">&lt;</span><span class="token operator">/</span>BatteryContext<span class="token punctuation">.</span>Provider<span class="token operator">></span>    <span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>###</p><h3 id="3-éåµŒå¥—å…³ç³»ç»„ä»¶çš„é€šä¿¡æ–¹å¼ï¼Ÿ"><a href="#3-éåµŒå¥—å…³ç³»ç»„ä»¶çš„é€šä¿¡æ–¹å¼ï¼Ÿ" class="headerlink" title="3. éåµŒå¥—å…³ç³»ç»„ä»¶çš„é€šä¿¡æ–¹å¼ï¼Ÿ"></a>3. éåµŒå¥—å…³ç³»ç»„ä»¶çš„é€šä¿¡æ–¹å¼ï¼Ÿ</h3><p>å³æ²¡æœ‰ä»»ä½•åŒ…å«å…³ç³»çš„ç»„ä»¶ï¼ŒåŒ…æ‹¬å…„å¼Ÿç»„ä»¶ä»¥åŠä¸åœ¨åŒä¸€ä¸ªçˆ¶çº§ä¸­çš„éå…„å¼Ÿç»„ä»¶ã€‚</p><ul><li>å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰äº‹ä»¶é€šä¿¡ï¼ˆå‘å¸ƒè®¢é˜…æ¨¡å¼ï¼‰</li><li>å¯ä»¥é€šè¿‡ redux ç­‰è¿›è¡Œå…¨å±€çŠ¶æ€ç®¡ç†</li><li>å¦‚æœæ˜¯å…„å¼Ÿç»„ä»¶é€šä¿¡ï¼Œå¯ä»¥æ‰¾åˆ°è¿™ä¸¤ä¸ªå…„å¼ŸèŠ‚ç‚¹å…±åŒçš„çˆ¶èŠ‚ç‚¹, ç»“åˆçˆ¶å­é—´é€šä¿¡æ–¹å¼è¿›è¡Œé€šä¿¡ã€‚</li></ul><h3 id="4-å¦‚ä½•è§£å†³-props-å±‚çº§è¿‡æ·±çš„é—®é¢˜"><a href="#4-å¦‚ä½•è§£å†³-props-å±‚çº§è¿‡æ·±çš„é—®é¢˜" class="headerlink" title="4. å¦‚ä½•è§£å†³ props å±‚çº§è¿‡æ·±çš„é—®é¢˜"></a>4. å¦‚ä½•è§£å†³ props å±‚çº§è¿‡æ·±çš„é—®é¢˜</h3><ul><li>ä½¿ç”¨ Context APIï¼šæä¾›ä¸€ç§ç»„ä»¶ä¹‹é—´çš„çŠ¶æ€å…±äº«ï¼Œè€Œä¸å¿…é€šè¿‡æ˜¾å¼ç»„ä»¶æ ‘é€å±‚ä¼ é€’ propsï¼›</li><li>ä½¿ç”¨ Redux ç­‰çŠ¶æ€åº“ã€‚</li></ul><h3 id="5-ç»„ä»¶é€šä¿¡çš„æ–¹å¼æœ‰å“ªäº›"><a href="#5-ç»„ä»¶é€šä¿¡çš„æ–¹å¼æœ‰å“ªäº›" class="headerlink" title="5. ç»„ä»¶é€šä¿¡çš„æ–¹å¼æœ‰å“ªäº›"></a>5. ç»„ä»¶é€šä¿¡çš„æ–¹å¼æœ‰å“ªäº›</h3><ul><li><strong>â½—ç»„ä»¶å‘â¼¦ç»„ä»¶é€šè®¯</strong>: â½—ç»„ä»¶å¯ä»¥å‘â¼¦ç»„ä»¶é€šè¿‡ä¼  props çš„â½…å¼ï¼Œå‘â¼¦ç»„ä»¶è¿›â¾é€šè®¯</li><li><strong>â¼¦ç»„ä»¶å‘â½—ç»„ä»¶é€šè®¯</strong>: props+å›è°ƒçš„â½…å¼ï¼Œâ½—ç»„ä»¶å‘â¼¦ç»„ä»¶ä¼ é€’ props è¿›â¾é€šè®¯ï¼Œæ­¤ props ä¸ºä½œâ½¤åŸŸä¸ºâ½—ç»„ä»¶â¾ƒèº«çš„å‡½ æ•°ï¼Œâ¼¦ç»„ä»¶è°ƒâ½¤è¯¥å‡½æ•°ï¼Œå°†â¼¦ç»„ä»¶æƒ³è¦ä¼ é€’çš„ä¿¡æ¯ï¼Œä½œä¸ºå‚æ•°ï¼Œä¼ é€’åˆ°â½—ç»„ä»¶çš„ä½œâ½¤åŸŸä¸­</li><li><strong>å…„å¼Ÿç»„ä»¶é€šä¿¡</strong>: æ‰¾åˆ°è¿™ä¸¤ä¸ªå…„å¼ŸèŠ‚ç‚¹å…±åŒçš„â½—èŠ‚ç‚¹,ç»“åˆä¸Šâ¾¯ä¸¤ç§â½…å¼ç”±â½—èŠ‚ç‚¹è½¬å‘ä¿¡æ¯è¿›â¾é€šä¿¡</li><li><strong>è·¨å±‚çº§é€šä¿¡</strong>: Context è®¾è®¡â½¬çš„æ˜¯ä¸ºäº†å…±äº«é‚£äº›å¯¹äºâ¼€ä¸ªç»„ä»¶æ ‘â½½â¾”æ˜¯â€œå…¨å±€â€çš„æ•°æ®ï¼Œä¾‹å¦‚å½“å‰è®¤è¯çš„â½¤æˆ·ã€ä¸»é¢˜æˆ–â¾¸é€‰è¯­â¾”ï¼Œå¯¹äºè·¨è¶Šå¤šå±‚çš„å…¨å±€æ•°æ®é€šè¿‡ Context é€šä¿¡å†é€‚åˆä¸è¿‡</li><li><strong>å‘å¸ƒè®¢é˜…æ¨¡å¼</strong>: å‘å¸ƒè€…å‘å¸ƒäº‹ä»¶ï¼Œè®¢é˜…è€…ç›‘å¬äº‹ä»¶å¹¶åšå‡ºååº”,æˆ‘ä»¬å¯ä»¥é€šè¿‡å¼•â¼Š event æ¨¡å—è¿›â¾é€šä¿¡</li><li><strong>å…¨å±€çŠ¶æ€ç®¡ç†â¼¯å…·</strong>: å€ŸåŠ© Redux æˆ–è€… Mobx ç­‰å…¨å±€çŠ¶æ€ç®¡ç†â¼¯å…·è¿›â¾é€šä¿¡,è¿™ç§â¼¯å…·ä¼šç»´æŠ¤â¼€ä¸ªå…¨å±€çŠ¶æ€ä¸­â¼¼ Store,å¹¶æ ¹æ®ä¸åŒçš„äº‹ä»¶äº§â½£æ–°çš„çŠ¶æ€</li></ul><h2 id="äº”ã€è·¯ç”±"><a href="#äº”ã€è·¯ç”±" class="headerlink" title="äº”ã€è·¯ç”±"></a>äº”ã€è·¯ç”±</h2><h3 id="1-React-Router-çš„å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-React-Router-çš„å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1. React-Router çš„å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ"></a>1. React-Router çš„å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>å®¢æˆ·ç«¯è·¯ç”±å®ç°çš„æ€æƒ³ï¼š</p><ul><li>åŸºäº hash çš„è·¯ç”±ï¼šé€šè¿‡ç›‘å¬<code>hashchange</code>äº‹ä»¶ï¼Œæ„ŸçŸ¥ hash çš„å˜åŒ–<ul><li>æ”¹å˜ hash å¯ä»¥ç›´æ¥é€šè¿‡ location.hash=xxx</li></ul></li><li>åŸºäº H5 history è·¯ç”±ï¼š<ul><li>æ”¹å˜ url å¯ä»¥é€šè¿‡ history.pushState å’Œ resplaceState ç­‰ï¼Œä¼šå°† URL å‹å…¥å †æ ˆï¼ŒåŒæ—¶èƒ½å¤Ÿåº”ç”¨ <code>history.go()</code> ç­‰ API</li><li>ç›‘å¬ url çš„å˜åŒ–å¯ä»¥é€šè¿‡è‡ªå®šä¹‰äº‹ä»¶è§¦å‘å®ç°</li></ul></li></ul><p><strong>react-router å®ç°çš„æ€æƒ³ï¼š</strong></p><ul><li>åŸºäº <code>history</code> åº“æ¥å®ç°ä¸Šè¿°ä¸åŒçš„å®¢æˆ·ç«¯è·¯ç”±å®ç°æ€æƒ³ï¼Œå¹¶ä¸”èƒ½å¤Ÿä¿å­˜å†å²è®°å½•ç­‰ï¼Œç£¨å¹³æµè§ˆå™¨å·®å¼‚ï¼Œä¸Šå±‚æ— æ„ŸçŸ¥</li><li>é€šè¿‡ç»´æŠ¤çš„åˆ—è¡¨ï¼Œåœ¨æ¯æ¬¡ URL å‘ç”Ÿå˜åŒ–çš„å›æ”¶ï¼Œé€šè¿‡é…ç½®çš„ è·¯ç”±è·¯å¾„ï¼ŒåŒ¹é…åˆ°å¯¹åº”çš„ Componentï¼Œå¹¶ä¸” render</li></ul><h3 id="2-å¦‚ä½•é…ç½®-React-Router-å®ç°è·¯ç”±åˆ‡æ¢"><a href="#2-å¦‚ä½•é…ç½®-React-Router-å®ç°è·¯ç”±åˆ‡æ¢" class="headerlink" title="2. å¦‚ä½•é…ç½® React-Router å®ç°è·¯ç”±åˆ‡æ¢"></a>2. å¦‚ä½•é…ç½® React-Router å®ç°è·¯ç”±åˆ‡æ¢</h3><p><strong>ï¼ˆ1ï¼‰ä½¿ç”¨<code>&lt;Route&gt;</code> ç»„ä»¶</strong></p><p>è·¯ç”±åŒ¹é…æ˜¯é€šè¿‡æ¯”è¾ƒ <code>&lt;Route&gt;</code> çš„ path å±æ€§å’Œå½“å‰åœ°å€çš„ pathname æ¥å®ç°çš„ã€‚å½“ä¸€ä¸ª <code>&lt;Route&gt;</code> åŒ¹é…æˆåŠŸæ—¶ï¼Œå®ƒå°†æ¸²æŸ“å…¶å†…å®¹ï¼Œå½“å®ƒä¸åŒ¹é…æ—¶å°±ä¼šæ¸²æŸ“ nullã€‚æ²¡æœ‰è·¯å¾„çš„ <code>&lt;Route&gt;</code> å°†å§‹ç»ˆè¢«åŒ¹é…ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// when location = { pathname: '/about' }</span><span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">'/about'</span> component<span class="token operator">=</span><span class="token punctuation">{</span>About<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">></span> <span class="token comment" spellcheck="true">// renders &lt;About/></span><span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">'/contact'</span> component<span class="token operator">=</span><span class="token punctuation">{</span>Contact<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">></span> <span class="token comment" spellcheck="true">// renders null</span><span class="token operator">&lt;</span>Route component<span class="token operator">=</span><span class="token punctuation">{</span>Always<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">></span> <span class="token comment" spellcheck="true">// renders &lt;Always/></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><strong>ï¼ˆ2ï¼‰ç»“åˆä½¿ç”¨ <code>&lt;Switch&gt;</code> ç»„ä»¶å’Œ <code>&lt;Route&gt;</code> ç»„ä»¶</strong></p><p><code>&lt;Switch&gt;</code> ç”¨äºå°† <code>&lt;Route&gt;</code> åˆ†ç»„ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>Switch<span class="token operator">></span>  <span class="token operator">&lt;</span>Route exact path<span class="token operator">=</span><span class="token string">"/"</span> component<span class="token operator">=</span><span class="token punctuation">{</span>Home<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>  <span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">"/about"</span> component<span class="token operator">=</span><span class="token punctuation">{</span>About<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>  <span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">"/contact"</span> component<span class="token operator">=</span><span class="token punctuation">{</span>Contact<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>Switch<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>&lt;Switch&gt;</code> ä¸æ˜¯åˆ†ç»„ <code>&lt;Route&gt;</code> æ‰€å¿…é¡»çš„ï¼Œä½†ä»–é€šå¸¸å¾ˆæœ‰ç”¨ã€‚ ä¸€ä¸ª <code>&lt;Switch&gt;</code> ä¼šéå†å…¶æ‰€æœ‰çš„å­ <code>&lt;Route&gt;</code>å…ƒç´ ï¼Œå¹¶ä»…æ¸²æŸ“ä¸å½“å‰åœ°å€åŒ¹é…çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚</p><p><strong>ï¼ˆ3ï¼‰ä½¿ç”¨ <code>&lt;Link&gt;ã€ &lt;NavLink&gt;ã€&lt;Redirect&gt;</code> ç»„ä»¶</strong></p><p><code>&lt;Link&gt;</code> ç»„ä»¶æ¥åœ¨ä½ çš„åº”ç”¨ç¨‹åºä¸­åˆ›å»ºé“¾æ¥ã€‚æ— è®ºä½ åœ¨ä½•å¤„æ¸²æŸ“ä¸€ä¸ª<code>&lt;Link&gt;</code> ï¼Œéƒ½ä¼šåœ¨åº”ç”¨ç¨‹åºçš„ HTML ä¸­æ¸²æŸ“é”šï¼ˆ<code>&lt;a&gt;</code>ï¼‰ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>Link to<span class="token operator">=</span><span class="token string">"/"</span><span class="token operator">></span>Home<span class="token operator">&lt;</span><span class="token operator">/</span>Link<span class="token operator">></span><span class="token comment" spellcheck="true">// &lt;a href='/'>Home&lt;/a></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><navlink> æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„ <link> å½“å®ƒçš„ to å±æ€§ä¸å½“å‰åœ°å€åŒ¹é…æ—¶ï¼Œå¯ä»¥å°†å…¶å®šä¹‰ä¸ºâ€æ´»è·ƒçš„â€ã€‚</navlink></p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// location = { pathname: '/react' }</span><span class="token operator">&lt;</span>NavLink to<span class="token operator">=</span><span class="token string">"/react"</span> activeClassName<span class="token operator">=</span><span class="token string">"hurray"</span><span class="token operator">></span>  React<span class="token operator">&lt;</span><span class="token operator">/</span>NavLink<span class="token operator">></span><span class="token comment" spellcheck="true">// &lt;a href='/react' className='hurray'>React&lt;/a></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å½“æˆ‘ä»¬æƒ³å¼ºåˆ¶å¯¼èˆªæ—¶ï¼Œå¯ä»¥æ¸²æŸ“ä¸€ä¸ª<code>&lt;Redirect&gt;</code>ï¼Œå½“ä¸€ä¸ª<code>&lt;Redirect&gt;</code>æ¸²æŸ“æ—¶ï¼Œå®ƒå°†ä½¿ç”¨å®ƒçš„ to å±æ€§è¿›è¡Œå®šå‘ã€‚</p><h3 id="3-React-Router-æ€ä¹ˆè®¾ç½®é‡å®šå‘ï¼Ÿ"><a href="#3-React-Router-æ€ä¹ˆè®¾ç½®é‡å®šå‘ï¼Ÿ" class="headerlink" title="3. React-Router æ€ä¹ˆè®¾ç½®é‡å®šå‘ï¼Ÿ"></a>3. React-Router æ€ä¹ˆè®¾ç½®é‡å®šå‘ï¼Ÿ</h3><p>ä½¿ç”¨<code>&lt;Redirect&gt;</code>ç»„ä»¶å®ç°è·¯ç”±çš„é‡å®šå‘ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>Switch<span class="token operator">></span>  <span class="token operator">&lt;</span>Redirect <span class="token keyword">from</span><span class="token operator">=</span><span class="token string">"/users/:id"</span> to<span class="token operator">=</span><span class="token string">"/users/profile/:id"</span> <span class="token operator">/</span><span class="token operator">></span>  <span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">"/users/profile/:id"</span> component<span class="token operator">=</span><span class="token punctuation">{</span>Profile<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>Switch<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å½“è¯·æ±‚ <code>/users/:id</code> è¢«é‡å®šå‘å» <code>'/users/profile/:id'</code>ï¼š</p><ul><li>å±æ€§ <code>from: string</code>ï¼šéœ€è¦åŒ¹é…çš„å°†è¦è¢«é‡å®šå‘è·¯å¾„ã€‚</li><li>å±æ€§ <code>to: string</code>ï¼šé‡å®šå‘çš„ URL å­—ç¬¦ä¸²</li><li>å±æ€§ <code>to: object</code>ï¼šé‡å®šå‘çš„ location å¯¹è±¡</li><li>å±æ€§ <code>push: bool</code>ï¼šè‹¥ä¸ºçœŸï¼Œé‡å®šå‘æ“ä½œå°†ä¼šæŠŠæ–°åœ°å€åŠ å…¥åˆ°è®¿é—®å†å²è®°å½•é‡Œé¢ï¼Œå¹¶ä¸”æ— æ³•å›é€€åˆ°å‰é¢çš„é¡µé¢ã€‚</li></ul><h3 id="4-react-router-é‡Œçš„-Link-æ ‡ç­¾å’Œ-a-æ ‡ç­¾çš„åŒºåˆ«"><a href="#4-react-router-é‡Œçš„-Link-æ ‡ç­¾å’Œ-a-æ ‡ç­¾çš„åŒºåˆ«" class="headerlink" title="4. react-router é‡Œçš„ Link æ ‡ç­¾å’Œ a æ ‡ç­¾çš„åŒºåˆ«"></a>4. react-router é‡Œçš„ Link æ ‡ç­¾å’Œ a æ ‡ç­¾çš„åŒºåˆ«</h3><p>ä»æœ€ç»ˆæ¸²æŸ“çš„ DOM æ¥çœ‹ï¼Œè¿™ä¸¤è€…éƒ½æ˜¯é“¾æ¥ï¼Œéƒ½æ˜¯ æ ‡ç­¾ï¼ŒåŒºåˆ«æ˜¯ âˆ¶<br><code>&lt;Link&gt;</code>æ˜¯ react-router é‡Œå®ç°è·¯ç”±è·³è½¬çš„é“¾æ¥ï¼Œä¸€èˆ¬é…åˆ<code>&lt;Route&gt;</code> ä½¿ç”¨ï¼Œreact-router æ¥ç®¡äº†å…¶é»˜è®¤çš„é“¾æ¥è·³è½¬è¡Œä¸ºï¼ŒåŒºåˆ«äºä¼ ç»Ÿçš„é¡µé¢è·³è½¬ï¼Œ<code>&lt;Link&gt;</code> çš„â€œè·³è½¬â€è¡Œä¸ºåªä¼šè§¦å‘ç›¸åŒ¹é…çš„<code>&lt;Route&gt;</code>å¯¹åº”çš„é¡µé¢å†…å®¹æ›´æ–°ï¼Œè€Œä¸ä¼šåˆ·æ–°æ•´ä¸ªé¡µé¢ã€‚</p><p><code>&lt;Link&gt;</code>åšäº† 3 ä»¶äº‹æƒ…:</p><ul><li>æœ‰ onclick é‚£å°±æ‰§è¡Œ onclick</li><li>click çš„æ—¶å€™é˜»æ­¢ a æ ‡ç­¾é»˜è®¤äº‹ä»¶</li><li>æ ¹æ®è·³è½¬ href(å³æ˜¯ to)ï¼Œç”¨ history (web å‰ç«¯è·¯ç”±ä¸¤ç§æ–¹å¼ä¹‹ä¸€ï¼Œhistory &amp; hash)è·³è½¬ï¼Œæ­¤æ—¶åªæ˜¯é“¾æ¥å˜äº†ï¼Œå¹¶æ²¡æœ‰åˆ·æ–°é¡µé¢è€Œ<code>&lt;a&gt;</code>æ ‡ç­¾å°±æ˜¯æ™®é€šçš„è¶…é“¾æ¥äº†ï¼Œç”¨äºä»å½“å‰é¡µé¢è·³è½¬åˆ° href æŒ‡å‘çš„å¦ä¸€ ä¸ªé¡µé¢(éé”šç‚¹æƒ…å†µ)ã€‚</li></ul><p>a æ ‡ç­¾é»˜è®¤äº‹ä»¶ç¦æ‰ä¹‹ååšäº†ä»€ä¹ˆæ‰å®ç°äº†è·³è½¬?</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">let</span> domArr <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">...</span>domArr<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>item<span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>    item<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        location<span class="token punctuation">.</span>href <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>href    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-React-Router-å¦‚ä½•è·å–-URL-çš„å‚æ•°å’Œå†å²å¯¹è±¡ï¼Ÿ"><a href="#5-React-Router-å¦‚ä½•è·å–-URL-çš„å‚æ•°å’Œå†å²å¯¹è±¡ï¼Ÿ" class="headerlink" title="5. React-Router å¦‚ä½•è·å– URL çš„å‚æ•°å’Œå†å²å¯¹è±¡ï¼Ÿ"></a>5. React-Router å¦‚ä½•è·å– URL çš„å‚æ•°å’Œå†å²å¯¹è±¡ï¼Ÿ</h3><p><strong>ï¼ˆ1ï¼‰è·å– URL çš„å‚æ•°</strong></p><ul><li><strong>get ä¼ å€¼</strong></li></ul><p>è·¯ç”±é…ç½®è¿˜æ˜¯æ™®é€šçš„é…ç½®ï¼Œå¦‚ï¼š<code>'admin'</code>ï¼Œä¼ å‚æ–¹å¼å¦‚ï¼š<code>'admin?id='1111''</code>ã€‚é€šè¿‡<code>this.props.location.search</code>è·å– url è·å–åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²<code>'?id='1111'</code><br>å¯ä»¥ç”¨ urlï¼Œqsï¼Œquerystringï¼Œæµè§ˆå™¨æä¾›çš„ api URLSearchParams å¯¹è±¡æˆ–è€…è‡ªå·±å°è£…çš„æ–¹æ³•å»è§£æå‡º id çš„å€¼ã€‚</p><ul><li><strong>åŠ¨æ€è·¯ç”±ä¼ å€¼</strong></li></ul><p>è·¯ç”±éœ€è¦é…ç½®æˆåŠ¨æ€è·¯ç”±ï¼šå¦‚<code>path='/admin/:id'</code>ï¼Œä¼ å‚æ–¹å¼ï¼Œå¦‚<code>'admin/111'</code>ã€‚é€šè¿‡<code>this.props.match.params.id</code> å–å¾— url ä¸­çš„åŠ¨æ€è·¯ç”± id éƒ¨åˆ†çš„å€¼ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜å¯ä»¥é€šè¿‡<code>useParamsï¼ˆHooksï¼‰</code>æ¥è·å–</p><ul><li><strong>é€šè¿‡ query æˆ– state ä¼ å€¼</strong></li></ul><p>ä¼ å‚æ–¹å¼å¦‚ï¼šåœ¨ Link ç»„ä»¶çš„ to å±æ€§ä¸­å¯ä»¥ä¼ é€’å¯¹è±¡<code>{pathname:'/admin',query:'111',state:'111'};</code>ã€‚é€šè¿‡<code>this.props.location.state</code>æˆ–<code>this.props.location.query</code>æ¥è·å–å³å¯ï¼Œä¼ é€’çš„å‚æ•°å¯ä»¥æ˜¯å¯¹è±¡ã€æ•°ç»„ç­‰ï¼Œä½†æ˜¯å­˜åœ¨ç¼ºç‚¹å°±æ˜¯åªè¦åˆ·æ–°é¡µé¢ï¼Œå‚æ•°å°±ä¼šä¸¢å¤±ã€‚</p><p><strong>ï¼ˆ2ï¼‰è·å–å†å²å¯¹è±¡</strong></p><ul><li>å¦‚æœ React &gt;= 16.8 æ—¶å¯ä»¥ä½¿ç”¨ React Router ä¸­æä¾›çš„ Hooks</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> useHistory <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react-router-dom"</span><span class="token punctuation">;</span><span class="token keyword">let</span> history <span class="token operator">=</span> <span class="token function">useHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>2.ä½¿ç”¨ this.props.history è·å–å†å²å¯¹è±¡</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">let</span> history <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>history<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="6-React-Router-4-æ€æ ·åœ¨è·¯ç”±å˜åŒ–æ—¶é‡æ–°æ¸²æŸ“åŒä¸€ä¸ªç»„ä»¶ï¼Ÿ"><a href="#6-React-Router-4-æ€æ ·åœ¨è·¯ç”±å˜åŒ–æ—¶é‡æ–°æ¸²æŸ“åŒä¸€ä¸ªç»„ä»¶ï¼Ÿ" class="headerlink" title="6. React-Router 4 æ€æ ·åœ¨è·¯ç”±å˜åŒ–æ—¶é‡æ–°æ¸²æŸ“åŒä¸€ä¸ªç»„ä»¶ï¼Ÿ"></a>6. React-Router 4 æ€æ ·åœ¨è·¯ç”±å˜åŒ–æ—¶é‡æ–°æ¸²æŸ“åŒä¸€ä¸ªç»„ä»¶ï¼Ÿ</h3><p>å½“è·¯ç”±å˜åŒ–æ—¶ï¼Œå³ç»„ä»¶çš„ props å‘ç”Ÿäº†å˜åŒ–ï¼Œä¼šè°ƒç”¨ componentWillReceiveProps ç­‰ç”Ÿå‘½å‘¨æœŸé’©å­ã€‚é‚£éœ€è¦åšçš„åªæ˜¯ï¼š å½“è·¯ç”±æ”¹å˜æ—¶ï¼Œæ ¹æ®è·¯ç”±ï¼Œä¹Ÿå»è¯·æ±‚æ•°æ®ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">NewsList</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>  componentDidMount <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">fetchData</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>location<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token function">fetchData</span><span class="token punctuation">(</span>location<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">const</span> type <span class="token operator">=</span> location<span class="token punctuation">.</span>pathname<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">'top'</span>    <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">fetchListData</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span>  <span class="token function">componentWillReceiveProps</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token keyword">if</span> <span class="token punctuation">(</span>nextProps<span class="token punctuation">.</span>location<span class="token punctuation">.</span>pathname <span class="token operator">!=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>location<span class="token punctuation">.</span>pathname<span class="token punctuation">)</span> <span class="token punctuation">{</span>         <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">fetchData</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">.</span>location<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  render <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token operator">...</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ©ç”¨ç”Ÿå‘½å‘¨æœŸ componentWillReceivePropsï¼Œè¿›è¡Œé‡æ–° render çš„é¢„å¤„ç†æ“ä½œã€‚</p><h3 id="7-React-Router-çš„è·¯ç”±æœ‰å‡ ç§æ¨¡å¼ï¼Ÿ"><a href="#7-React-Router-çš„è·¯ç”±æœ‰å‡ ç§æ¨¡å¼ï¼Ÿ" class="headerlink" title="7. React-Router çš„è·¯ç”±æœ‰å‡ ç§æ¨¡å¼ï¼Ÿ"></a>7. React-Router çš„è·¯ç”±æœ‰å‡ ç§æ¨¡å¼ï¼Ÿ</h3><p>React-Router æ”¯æŒä½¿ç”¨ hashï¼ˆå¯¹åº” HashRouterï¼‰å’Œ browserï¼ˆå¯¹åº” BrowserRouterï¼‰ ä¸¤ç§è·¯ç”±è§„åˆ™ï¼Œ react-router-dom æä¾›äº† BrowserRouter å’Œ HashRouter ä¸¤ä¸ªç»„ä»¶æ¥å®ç°åº”ç”¨çš„ UI å’Œ URL åŒæ­¥ï¼š</p><ul><li>BrowserRouter åˆ›å»ºçš„ URL æ ¼å¼ï¼š<a href="http://xxx.com/path">http://xxx.com/path</a></li><li>HashRouter åˆ›å»ºçš„ URL æ ¼å¼ï¼š<a href="http://xxx.com/#/path">http://xxx.com/#/path</a></li></ul><p><strong>ï¼ˆ1ï¼‰BrowserRouter</strong></p><p>å®ƒä½¿ç”¨ HTML5 æä¾›çš„ history APIï¼ˆpushStateã€replaceState å’Œ popstate äº‹ä»¶ï¼‰æ¥ä¿æŒ UI å’Œ URL çš„åŒæ­¥ã€‚ç”±æ­¤å¯ä»¥çœ‹å‡ºï¼Œ<strong>BrowserRouter æ˜¯ä½¿ç”¨ HTML 5 çš„ history API æ¥æ§åˆ¶è·¯ç”±è·³è½¬çš„ï¼š</strong></p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>BrowserRouter  basename<span class="token operator">=</span><span class="token punctuation">{</span>string<span class="token punctuation">}</span>  forceRefresh<span class="token operator">=</span><span class="token punctuation">{</span>bool<span class="token punctuation">}</span>  getUserConfirmation<span class="token operator">=</span><span class="token punctuation">{</span>func<span class="token punctuation">}</span>  keyLength<span class="token operator">=</span><span class="token punctuation">{</span>number<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>å…¶ä¸­çš„å±æ€§å¦‚ä¸‹ï¼š</strong></p><ul><li>basename æ‰€æœ‰è·¯ç”±çš„åŸºå‡† URLã€‚basename çš„æ­£ç¡®æ ¼å¼æ˜¯å‰é¢æœ‰ä¸€ä¸ªå‰å¯¼æ–œæ ï¼Œä½†ä¸èƒ½æœ‰å°¾éƒ¨æ–œæ ï¼›</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>BrowserRouter basename<span class="token operator">=</span><span class="token string">"/calendar"</span><span class="token operator">></span>  <span class="token operator">&lt;</span>Link to<span class="token operator">=</span><span class="token string">"/today"</span> <span class="token operator">/</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>BrowserRouter<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ç­‰åŒäº</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"/calendar/today"</span> <span class="token operator">/</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>forceRefresh å¦‚æœä¸º trueï¼Œåœ¨å¯¼èˆªçš„è¿‡ç¨‹ä¸­æ•´ä¸ªé¡µé¢å°†ä¼šåˆ·æ–°ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåªæœ‰åœ¨ä¸æ”¯æŒ HTML5 history API çš„æµè§ˆå™¨ä¸­ä½¿ç”¨æ­¤åŠŸèƒ½ï¼›</li><li>getUserConfirmation ç”¨äºç¡®è®¤å¯¼èˆªçš„å‡½æ•°ï¼Œé»˜è®¤ä½¿ç”¨ window.confirmã€‚ä¾‹å¦‚ï¼Œå½“ä» /a å¯¼èˆªè‡³ /b æ—¶ï¼Œä¼šä½¿ç”¨é»˜è®¤çš„ confirm å‡½æ•°å¼¹å‡ºä¸€ä¸ªæç¤ºï¼Œç”¨æˆ·ç‚¹å‡»ç¡®å®šåæ‰è¿›è¡Œå¯¼èˆªï¼Œå¦åˆ™ä¸åšä»»ä½•å¤„ç†ï¼›</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// è¿™æ˜¯é»˜è®¤çš„ç¡®è®¤å‡½æ•°</span><span class="token keyword">const</span> getConfirmation <span class="token operator">=</span> <span class="token punctuation">(</span>message<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  <span class="token keyword">const</span> allowTransition <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">confirm</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token function">callback</span><span class="token punctuation">(</span>allowTransition<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token operator">&lt;</span>BrowserRouter getUserConfirmation<span class="token operator">=</span><span class="token punctuation">{</span>getConfirmation<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>éœ€è¦é…åˆ<code>&lt;Prompt&gt;</code> ä¸€èµ·ä½¿ç”¨ã€‚</p></blockquote><ul><li>KeyLength ç”¨æ¥è®¾ç½® Location.Key çš„é•¿åº¦ã€‚</li></ul><p><strong>ï¼ˆ2ï¼‰HashRouter</strong></p><p>ä½¿ç”¨ URL çš„ hash éƒ¨åˆ†ï¼ˆå³ window.location.hashï¼‰æ¥ä¿æŒ UI å’Œ URL çš„åŒæ­¥ã€‚ç”±æ­¤å¯ä»¥çœ‹å‡ºï¼Œ<strong>HashRouter æ˜¯é€šè¿‡ URL çš„ hash å±æ€§æ¥æ§åˆ¶è·¯ç”±è·³è½¬çš„ï¼š</strong></p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>HashRouter basename<span class="token operator">=</span><span class="token punctuation">{</span>string<span class="token punctuation">}</span> getUserConfirmation<span class="token operator">=</span><span class="token punctuation">{</span>func<span class="token punctuation">}</span> hashType<span class="token operator">=</span><span class="token punctuation">{</span>string<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><strong>å…¶å‚æ•°å¦‚ä¸‹</strong>ï¼š</p><ul><li>basename, getUserConfirmation å’Œ <code>BrowserRouter</code> åŠŸèƒ½ä¸€æ ·ï¼›</li><li>hashType window.location.hash ä½¿ç”¨çš„ hash ç±»å‹ï¼Œæœ‰å¦‚ä¸‹å‡ ç§ï¼š<ul><li>slash - åé¢è·Ÿä¸€ä¸ªæ–œæ ï¼Œä¾‹å¦‚ #/ å’Œ #/sunshine/lollipopsï¼›</li><li>noslash - åé¢æ²¡æœ‰æ–œæ ï¼Œä¾‹å¦‚ # å’Œ #sunshine/lollipopsï¼›</li><li>hashbang - Google é£æ ¼çš„ ajax crawlableï¼Œä¾‹å¦‚ #!/ å’Œ #!/sunshine/lollipopsã€‚</li></ul></li></ul><h3 id="8-React-Router-4-çš„-Switch-æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"><a href="#8-React-Router-4-çš„-Switch-æœ‰ä»€ä¹ˆç”¨ï¼Ÿ" class="headerlink" title="8. React-Router 4 çš„ Switch æœ‰ä»€ä¹ˆç”¨ï¼Ÿ"></a>8. React-Router 4 çš„ Switch æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h3><p>Switch é€šå¸¸è¢«ç”¨æ¥åŒ…è£¹ Routeï¼Œç”¨äºæ¸²æŸ“ä¸è·¯å¾„åŒ¹é…çš„ç¬¬ä¸€ä¸ªå­ <code>&lt;Route&gt;</code> æˆ– <code>&lt;Redirect&gt;</code>ï¼Œå®ƒé‡Œé¢ä¸èƒ½æ”¾å…¶ä»–å…ƒç´ ã€‚</p><p>å‡å¦‚ä¸åŠ  <code>&lt;Switch&gt;</code> ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> Route <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-router-dom'</span><span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">"/"</span> component<span class="token operator">=</span><span class="token punctuation">{</span>Home<span class="token punctuation">}</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>Route<span class="token operator">></span><span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">"/login"</span> component<span class="token operator">=</span><span class="token punctuation">{</span>Login<span class="token punctuation">}</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>Route<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>Route ç»„ä»¶çš„ path å±æ€§ç”¨äºåŒ¹é…è·¯å¾„ï¼Œå› ä¸ºéœ€è¦åŒ¹é… <code>/</code> åˆ° <code>Home</code>ï¼ŒåŒ¹é… <code>/login</code> åˆ° <code>Login</code>ï¼Œæ‰€ä»¥éœ€è¦ä¸¤ä¸ª Routeï¼Œä½†æ˜¯ä¸èƒ½è¿™ä¹ˆå†™ã€‚è¿™æ ·å†™çš„è¯ï¼Œå½“ URL çš„ path ä¸º â€œ/loginâ€ æ—¶ï¼Œ<code>&lt;Route path="/" /&gt;</code>å’Œ<code>&lt;Route path="/login" /&gt;</code> éƒ½ä¼šè¢«åŒ¹é…ï¼Œå› æ­¤é¡µé¢ä¼šå±•ç¤º Home å’Œ Login ä¸¤ä¸ªç»„ä»¶ã€‚è¿™æ—¶å°±éœ€è¦å€ŸåŠ© <code>&lt;Switch&gt;</code> æ¥åšåˆ°åªæ˜¾ç¤ºä¸€ä¸ªåŒ¹é…ç»„ä»¶ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> Switch<span class="token punctuation">,</span> Route <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react-router-dom"</span><span class="token punctuation">;</span><span class="token operator">&lt;</span>Switch<span class="token operator">></span>  <span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">"/"</span> component<span class="token operator">=</span><span class="token punctuation">{</span>Home<span class="token punctuation">}</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>Route<span class="token operator">></span>  <span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">"/login"</span> component<span class="token operator">=</span><span class="token punctuation">{</span>Login<span class="token punctuation">}</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>Route<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>Switch<span class="token operator">></span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ­¤æ—¶ï¼Œå†è®¿é—® â€œ/loginâ€ è·¯å¾„æ—¶ï¼Œå´åªæ˜¾ç¤ºäº† Home ç»„ä»¶ã€‚è¿™æ˜¯å°±ç”¨åˆ°äº† exact å±æ€§ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯ç²¾ç¡®åŒ¹é…è·¯å¾„ï¼Œç»å¸¸ä¸<code>&lt;Switch&gt;</code> è”åˆä½¿ç”¨ã€‚åªæœ‰å½“ URL å’Œè¯¥ <code>&lt;Route&gt;</code> çš„ path å±æ€§å®Œå…¨ä¸€è‡´çš„æƒ…å†µä¸‹æ‰èƒ½åŒ¹é…ä¸Šï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> Switch<span class="token punctuation">,</span> Route <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"react-router-dom"</span><span class="token punctuation">;</span><span class="token operator">&lt;</span>Switch<span class="token operator">></span>  <span class="token operator">&lt;</span>Route exact path<span class="token operator">=</span><span class="token string">"/"</span> component<span class="token operator">=</span><span class="token punctuation">{</span>Home<span class="token punctuation">}</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>Route<span class="token operator">></span>  <span class="token operator">&lt;</span>Route exact path<span class="token operator">=</span><span class="token string">"/login"</span> component<span class="token operator">=</span><span class="token punctuation">{</span>Login<span class="token punctuation">}</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>Route<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>Switch<span class="token operator">></span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> React </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Github </tag>
            
            <tag> åšå®¢ </tag>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ€§èƒ½ä¼˜åŒ–</title>
      <link href="/2022/01/30/optimize/"/>
      <url>/2022/01/30/optimize/</url>
      
        <content type="html"><![CDATA[<p> <img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/page/1.png" alt="æ€§èƒ½ä¼˜åŒ–.png"></p><h2 id="ä¸€ã€CDN"><a href="#ä¸€ã€CDN" class="headerlink" title="ä¸€ã€CDN"></a>ä¸€ã€CDN</h2><h3 id="1-CDNçš„æ¦‚å¿µ"><a href="#1-CDNçš„æ¦‚å¿µ" class="headerlink" title="1. CDNçš„æ¦‚å¿µ"></a>1. CDNçš„æ¦‚å¿µ</h3><p>CDNï¼ˆContent Delivery Networkï¼Œ<strong>å†…å®¹åˆ†å‘ç½‘ç»œ</strong>ï¼‰æ˜¯æŒ‡ä¸€ç§é€šè¿‡äº’è”ç½‘äº’ç›¸è¿æ¥çš„ç”µè„‘ç½‘ç»œç³»ç»Ÿï¼Œåˆ©ç”¨æœ€é è¿‘æ¯ä½ç”¨æˆ·çš„æœåŠ¡å™¨ï¼Œæ›´å¿«ã€æ›´å¯é åœ°å°†éŸ³ä¹ã€å›¾ç‰‡ã€è§†é¢‘ã€åº”ç”¨ç¨‹åºåŠå…¶ä»–æ–‡ä»¶å‘é€ç»™ç”¨æˆ·ï¼Œæ¥æä¾›é«˜æ€§èƒ½ã€å¯æ‰©å±•æ€§åŠä½æˆæœ¬çš„ç½‘ç»œå†…å®¹ä¼ é€’ç»™ç”¨æˆ·ã€‚</p><p>å…¸å‹çš„CDNç³»ç»Ÿç”±ä¸‹é¢ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼š</p><ul><li><strong>åˆ†å‘æœåŠ¡ç³»ç»Ÿï¼š</strong> æœ€åŸºæœ¬çš„å·¥ä½œå•å…ƒå°±æ˜¯Cacheè®¾å¤‡ï¼Œcacheï¼ˆè¾¹ç¼˜cacheï¼‰è´Ÿè´£ç›´æ¥å“åº”æœ€ç»ˆç”¨æˆ·çš„è®¿é—®è¯·æ±‚ï¼ŒæŠŠç¼“å­˜åœ¨æœ¬åœ°çš„å†…å®¹å¿«é€Ÿåœ°æä¾›ç»™ç”¨æˆ·ã€‚åŒæ—¶cacheè¿˜è´Ÿè´£ä¸æºç«™ç‚¹è¿›è¡Œå†…å®¹åŒæ­¥ï¼ŒæŠŠæ›´æ–°çš„å†…å®¹ä»¥åŠæœ¬åœ°æ²¡æœ‰çš„å†…å®¹ä»æºç«™ç‚¹è·å–å¹¶ä¿å­˜åœ¨æœ¬åœ°ã€‚Cacheè®¾å¤‡çš„æ•°é‡ã€è§„æ¨¡ã€æ€»æœåŠ¡èƒ½åŠ›æ˜¯è¡¡é‡ä¸€ä¸ªCDNç³»ç»ŸæœåŠ¡èƒ½åŠ›çš„æœ€åŸºæœ¬çš„æŒ‡æ ‡ã€‚</li><li><strong>è´Ÿè½½å‡è¡¡ç³»ç»Ÿï¼š</strong> ä¸»è¦åŠŸèƒ½æ˜¯è´Ÿè´£å¯¹æ‰€æœ‰å‘èµ·æœåŠ¡è¯·æ±‚çš„ç”¨æˆ·è¿›è¡Œè®¿é—®è°ƒåº¦ï¼Œç¡®å®šæä¾›ç»™ç”¨æˆ·çš„æœ€ç»ˆå®é™…è®¿é—®åœ°å€ã€‚ä¸¤çº§è°ƒåº¦ä½“ç³»åˆ†ä¸ºå…¨å±€è´Ÿè½½å‡è¡¡ï¼ˆGSLBï¼‰å’Œæœ¬åœ°è´Ÿè½½å‡è¡¡ï¼ˆSLBï¼‰ã€‚<strong>å…¨å±€è´Ÿè½½å‡è¡¡</strong>ä¸»è¦æ ¹æ®ç”¨æˆ·å°±è¿‘æ€§åŸåˆ™ï¼Œé€šè¿‡å¯¹æ¯ä¸ªæœåŠ¡èŠ‚ç‚¹è¿›è¡Œâ€œæœ€ä¼˜â€åˆ¤æ–­ï¼Œç¡®å®šå‘ç”¨æˆ·æä¾›æœåŠ¡çš„cacheçš„ç‰©ç†ä½ç½®ã€‚<strong>æœ¬åœ°è´Ÿè½½å‡è¡¡</strong>ä¸»è¦è´Ÿè´£èŠ‚ç‚¹å†…éƒ¨çš„è®¾å¤‡è´Ÿè½½å‡è¡¡</li><li><strong>è¿è¥ç®¡ç†ç³»ç»Ÿï¼š</strong> è¿è¥ç®¡ç†ç³»ç»Ÿåˆ†ä¸ºè¿è¥ç®¡ç†å’Œç½‘ç»œç®¡ç†å­ç³»ç»Ÿï¼Œè´Ÿè´£å¤„ç†ä¸šåŠ¡å±‚é¢çš„ä¸å¤–ç•Œç³»ç»Ÿäº¤äº’æ‰€å¿…é¡»çš„æ”¶é›†ã€æ•´ç†ã€äº¤ä»˜å·¥ä½œï¼ŒåŒ…å«å®¢æˆ·ç®¡ç†ã€äº§å“ç®¡ç†ã€è®¡è´¹ç®¡ç†ã€ç»Ÿè®¡åˆ†æç­‰åŠŸèƒ½ã€‚</li></ul><h3 id="2-CDNçš„ä½œç”¨"><a href="#2-CDNçš„ä½œç”¨" class="headerlink" title="2. CDNçš„ä½œç”¨"></a>2. CDNçš„ä½œç”¨</h3><p>CDNä¸€èˆ¬ä¼šç”¨æ¥æ‰˜ç®¡Webèµ„æºï¼ˆåŒ…æ‹¬æ–‡æœ¬ã€å›¾ç‰‡å’Œè„šæœ¬ç­‰ï¼‰ï¼Œå¯ä¾›ä¸‹è½½çš„èµ„æºï¼ˆåª’ä½“æ–‡ä»¶ã€è½¯ä»¶ã€æ–‡æ¡£ç­‰ï¼‰ï¼Œåº”ç”¨ç¨‹åºï¼ˆé—¨æˆ·ç½‘ç«™ç­‰ï¼‰ã€‚ä½¿ç”¨CDNæ¥åŠ é€Ÿè¿™äº›èµ„æºçš„è®¿é—®ã€‚</p><p>ï¼ˆ1ï¼‰åœ¨æ€§èƒ½æ–¹é¢ï¼Œå¼•å…¥CDNçš„ä½œç”¨åœ¨äºï¼š</p><ul><li>ç”¨æˆ·æ”¶åˆ°çš„å†…å®¹æ¥è‡ªæœ€è¿‘çš„æ•°æ®ä¸­å¿ƒï¼Œå»¶è¿Ÿæ›´ä½ï¼Œå†…å®¹åŠ è½½æ›´å¿«</li><li>éƒ¨åˆ†èµ„æºè¯·æ±‚åˆ†é…ç»™äº†CDNï¼Œå‡å°‘äº†æœåŠ¡å™¨çš„è´Ÿè½½</li></ul><p>ï¼ˆ2ï¼‰åœ¨å®‰å…¨æ–¹é¢ï¼ŒCDNæœ‰åŠ©äºé˜²å¾¡DDoSã€MITMç­‰ç½‘ç»œæ”»å‡»ï¼š</p><ul><li>é’ˆå¯¹DDoSï¼šé€šè¿‡ç›‘æ§åˆ†æå¼‚å¸¸æµé‡ï¼Œé™åˆ¶å…¶è¯·æ±‚é¢‘ç‡</li><li>é’ˆå¯¹MITMï¼šä»æºæœåŠ¡å™¨åˆ° CDN èŠ‚ç‚¹åˆ° ISPï¼ˆInternet Service Providerï¼‰ï¼Œå…¨é“¾è·¯ HTTPS é€šä¿¡</li></ul><p>é™¤æ­¤ä¹‹å¤–ï¼ŒCDNä½œä¸ºä¸€ç§åŸºç¡€çš„äº‘æœåŠ¡ï¼ŒåŒæ ·å…·æœ‰èµ„æºæ‰˜ç®¡ã€æŒ‰éœ€æ‰©å±•ï¼ˆèƒ½å¤Ÿåº”å¯¹æµé‡é«˜å³°ï¼‰ç­‰æ–¹é¢çš„ä¼˜åŠ¿ã€‚</p><h3 id="3-CDNçš„åŸç†"><a href="#3-CDNçš„åŸç†" class="headerlink" title="3. CDNçš„åŸç†"></a>3. CDNçš„åŸç†</h3><p>CDNå’ŒDNSæœ‰ç€å¯†ä¸å¯åˆ†çš„è”ç³»ï¼Œå…ˆæ¥çœ‹ä¸€ä¸‹DNSçš„è§£æåŸŸåè¿‡ç¨‹ï¼Œåœ¨æµè§ˆå™¨è¾“å…¥ <a href="http://www.test.com">www.test.com</a> çš„è§£æè¿‡ç¨‹å¦‚ä¸‹ï¼š<br>ï¼ˆ1ï¼‰ æ£€æŸ¥æµè§ˆå™¨ç¼“å­˜<br>ï¼ˆ2ï¼‰æ£€æŸ¥æ“ä½œç³»ç»Ÿç¼“å­˜ï¼Œå¸¸è§çš„å¦‚hostsæ–‡ä»¶<br>ï¼ˆ3ï¼‰æ£€æŸ¥è·¯ç”±å™¨ç¼“å­˜<br>ï¼ˆ4ï¼‰å¦‚æœå‰å‡ æ­¥éƒ½æ²¡æ²¡æ‰¾åˆ°ï¼Œä¼šå‘ISP(ç½‘ç»œæœåŠ¡æä¾›å•†)çš„LDNSæœåŠ¡å™¨æŸ¥è¯¢<br>ï¼ˆ5ï¼‰å¦‚æœLDNSæœåŠ¡å™¨æ²¡æ‰¾åˆ°ï¼Œä¼šå‘æ ¹åŸŸåæœåŠ¡å™¨(Root Server)è¯·æ±‚è§£æï¼Œåˆ†ä¸ºä»¥ä¸‹å‡ æ­¥ï¼š</p><ul><li>æ ¹æœåŠ¡å™¨è¿”å›é¡¶çº§åŸŸå(TLD)æœåŠ¡å™¨å¦‚<code>.com</code>ï¼Œ<code>.cn</code>ï¼Œ<code>.org</code>ç­‰çš„åœ°å€ï¼Œè¯¥ä¾‹å­ä¸­ä¼šè¿”å›<code>.com</code>çš„åœ°å€</li><li>æ¥ç€å‘é¡¶çº§åŸŸåæœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œç„¶åä¼šè¿”å›æ¬¡çº§åŸŸå(SLD)æœåŠ¡å™¨çš„åœ°å€ï¼Œæœ¬ä¾‹å­ä¼šè¿”å›<code>.test</code>çš„åœ°å€</li><li>æ¥ç€å‘æ¬¡çº§åŸŸåæœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œç„¶åä¼šè¿”å›é€šè¿‡åŸŸåæŸ¥è¯¢åˆ°çš„ç›®æ ‡IPï¼Œæœ¬ä¾‹å­ä¼šè¿”å›<code>www.test.com</code>çš„åœ°å€</li><li>Local DNS Serverä¼šç¼“å­˜ç»“æœï¼Œå¹¶è¿”å›ç»™ç”¨æˆ·ï¼Œç¼“å­˜åœ¨ç³»ç»Ÿä¸­</li></ul><p><strong>CDNçš„å·¥ä½œåŸç†ï¼š</strong><br>ï¼ˆ1ï¼‰ç”¨æˆ·æœªä½¿ç”¨CDNç¼“å­˜èµ„æºçš„è¿‡ç¨‹ï¼š</p><ol><li>æµè§ˆå™¨é€šè¿‡DNSå¯¹åŸŸåè¿›è¡Œè§£æï¼ˆå°±æ˜¯ä¸Šé¢çš„DNSè§£æè¿‡ç¨‹ï¼‰ï¼Œä¾æ¬¡å¾—åˆ°æ­¤åŸŸåå¯¹åº”çš„IPåœ°å€</li><li>æµè§ˆå™¨æ ¹æ®å¾—åˆ°çš„IPåœ°å€ï¼Œå‘åŸŸåçš„æœåŠ¡ä¸»æœºå‘é€æ•°æ®è¯·æ±‚</li><li>æœåŠ¡å™¨å‘æµè§ˆå™¨è¿”å›å“åº”æ•°æ®</li></ol><p>ï¼ˆ2ï¼‰ç”¨æˆ·ä½¿ç”¨CDNç¼“å­˜èµ„æºçš„è¿‡ç¨‹ï¼š</p><ol><li>å¯¹äºç‚¹å‡»çš„æ•°æ®çš„URLï¼Œç»è¿‡æœ¬åœ°DNSç³»ç»Ÿçš„è§£æï¼Œå‘ç°è¯¥URLå¯¹åº”çš„æ˜¯ä¸€ä¸ªCDNä¸“ç”¨çš„DNSæœåŠ¡å™¨ï¼ŒDNSç³»ç»Ÿå°±ä¼šå°†åŸŸåè§£ææƒäº¤ç»™CNAMEæŒ‡å‘çš„CDNä¸“ç”¨çš„DNSæœåŠ¡å™¨ã€‚</li><li>CNDä¸“ç”¨DNSæœåŠ¡å™¨å°†CNDçš„å…¨å±€è´Ÿè½½å‡è¡¡è®¾å¤‡IPåœ°å€è¿”å›ç»™ç”¨æˆ·</li><li>ç”¨æˆ·å‘CDNçš„å…¨å±€è´Ÿè½½å‡è¡¡è®¾å¤‡å‘èµ·æ•°æ®è¯·æ±‚</li><li>CDNçš„å…¨å±€è´Ÿè½½å‡è¡¡è®¾å¤‡æ ¹æ®ç”¨æˆ·çš„IPåœ°å€ï¼Œä»¥åŠç”¨æˆ·è¯·æ±‚çš„å†…å®¹URLï¼Œé€‰æ‹©ä¸€å°ç”¨æˆ·æ‰€å±åŒºåŸŸçš„åŒºåŸŸè´Ÿè½½å‡è¡¡è®¾å¤‡ï¼Œå‘Šè¯‰ç”¨æˆ·å‘è¿™å°è®¾å¤‡å‘èµ·è¯·æ±‚</li><li>åŒºåŸŸè´Ÿè½½å‡è¡¡è®¾å¤‡é€‰æ‹©ä¸€å°åˆé€‚çš„ç¼“å­˜æœåŠ¡å™¨æ¥æä¾›æœåŠ¡ï¼Œå°†è¯¥ç¼“å­˜æœåŠ¡å™¨çš„IPåœ°å€è¿”å›ç»™å…¨å±€è´Ÿè½½å‡è¡¡è®¾å¤‡</li><li>å…¨å±€è´Ÿè½½å‡è¡¡è®¾å¤‡æŠŠæœåŠ¡å™¨çš„IPåœ°å€è¿”å›ç»™ç”¨æˆ·</li><li>ç”¨æˆ·å‘è¯¥ç¼“å­˜æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼Œç¼“å­˜æœåŠ¡å™¨å“åº”ç”¨æˆ·çš„è¯·æ±‚ï¼Œå°†ç”¨æˆ·æ‰€éœ€å†…å®¹å‘é€è‡³ç”¨æˆ·ç»ˆç«¯ã€‚</li></ol><p>å¦‚æœç¼“å­˜æœåŠ¡å™¨æ²¡æœ‰ç”¨æˆ·æƒ³è¦çš„å†…å®¹ï¼Œé‚£ä¹ˆç¼“å­˜æœåŠ¡å™¨å°±ä¼šå‘å®ƒçš„ä¸Šä¸€çº§ç¼“å­˜æœåŠ¡å™¨è¯·æ±‚å†…å®¹ï¼Œä»¥æ­¤ç±»æ¨ï¼Œç›´åˆ°è·å–åˆ°éœ€è¦çš„èµ„æºã€‚æœ€åå¦‚æœè¿˜æ˜¯æ²¡æœ‰ï¼Œå°±ä¼šå›åˆ°è‡ªå·±çš„æœåŠ¡å™¨å»è·å–èµ„æºã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/page/2.png" alt=""><br>CNAMEï¼ˆæ„ä¸ºï¼šåˆ«åï¼‰ï¼šåœ¨åŸŸåè§£æä¸­ï¼Œå®é™…ä¸Šè§£æå‡ºæ¥çš„æŒ‡å®šåŸŸåå¯¹åº”çš„IPåœ°å€ï¼Œæˆ–è€…è¯¥åŸŸåçš„ä¸€ä¸ªCNAMEï¼Œç„¶åå†æ ¹æ®è¿™ä¸ªCNAMEæ¥æŸ¥æ‰¾å¯¹åº”çš„IPåœ°å€ã€‚</p><h3 id="4-CDNçš„ä½¿ç”¨åœºæ™¯"><a href="#4-CDNçš„ä½¿ç”¨åœºæ™¯" class="headerlink" title="4. CDNçš„ä½¿ç”¨åœºæ™¯"></a>4. CDNçš„ä½¿ç”¨åœºæ™¯</h3><ul><li><strong>ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„CDNæœåŠ¡ï¼š</strong>å¦‚æœæƒ³è¦å¼€æºä¸€äº›é¡¹ç›®ï¼Œå¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„CDNæœåŠ¡</li><li><strong>ä½¿ç”¨CDNè¿›è¡Œé™æ€èµ„æºçš„ç¼“å­˜ï¼š</strong>å°†è‡ªå·±ç½‘ç«™çš„é™æ€èµ„æºæ”¾åœ¨CDNä¸Šï¼Œæ¯”å¦‚jsã€cssã€å›¾ç‰‡ç­‰ã€‚å¯ä»¥å°†æ•´ä¸ªé¡¹ç›®æ”¾åœ¨CDNä¸Šï¼Œå®Œæˆä¸€é”®éƒ¨ç½²ã€‚</li><li><strong>ç›´æ’­ä¼ é€ï¼š</strong>ç›´æ’­æœ¬è´¨ä¸Šæ˜¯ä½¿ç”¨æµåª’ä½“è¿›è¡Œä¼ é€ï¼ŒCDNä¹Ÿæ˜¯æ”¯æŒæµåª’ä½“ä¼ é€çš„ï¼Œæ‰€ä»¥ç›´æ’­å®Œå…¨å¯ä»¥ä½¿ç”¨CDNæ¥æé«˜è®¿é—®é€Ÿåº¦ã€‚CDNåœ¨å¤„ç†æµåª’ä½“çš„æ—¶å€™ä¸å¤„ç†æ™®é€šé™æ€æ–‡ä»¶æœ‰æ‰€ä¸åŒï¼Œæ™®é€šæ–‡ä»¶å¦‚æœåœ¨è¾¹ç¼˜èŠ‚ç‚¹æ²¡æœ‰æ‰¾åˆ°çš„è¯ï¼Œå°±ä¼šå»ä¸Šä¸€å±‚æ¥ç€å¯»æ‰¾ï¼Œä½†æ˜¯æµåª’ä½“æœ¬èº«æ•°æ®é‡å°±éå¸¸å¤§ï¼Œå¦‚æœä½¿ç”¨å›æºçš„æ–¹å¼ï¼Œå¿…ç„¶ä¼šå¸¦æ¥æ€§èƒ½é—®é¢˜ï¼Œæ‰€ä»¥æµåª’ä½“ä¸€èˆ¬é‡‡ç”¨çš„éƒ½æ˜¯ä¸»åŠ¨æ¨é€çš„æ–¹å¼æ¥è¿›è¡Œã€‚</li></ul><h2 id="äºŒã€æ‡’åŠ è½½"><a href="#äºŒã€æ‡’åŠ è½½" class="headerlink" title="äºŒã€æ‡’åŠ è½½"></a>äºŒã€æ‡’åŠ è½½</h2><h3 id="1-æ‡’åŠ è½½çš„æ¦‚å¿µ"><a href="#1-æ‡’åŠ è½½çš„æ¦‚å¿µ" class="headerlink" title="1. æ‡’åŠ è½½çš„æ¦‚å¿µ"></a>1. æ‡’åŠ è½½çš„æ¦‚å¿µ</h3><p>æ‡’åŠ è½½ä¹Ÿå«åšå»¶è¿ŸåŠ è½½ã€æŒ‰éœ€åŠ è½½ï¼ŒæŒ‡çš„æ˜¯åœ¨é•¿ç½‘é¡µä¸­å»¶è¿ŸåŠ è½½å›¾ç‰‡æ•°æ®ï¼Œæ˜¯ä¸€ç§è¾ƒå¥½çš„ç½‘é¡µæ€§èƒ½ä¼˜åŒ–çš„æ–¹å¼ã€‚åœ¨æ¯”è¾ƒé•¿çš„ç½‘é¡µæˆ–åº”ç”¨ä¸­ï¼Œå¦‚æœå›¾ç‰‡å¾ˆå¤šï¼Œæ‰€æœ‰çš„å›¾ç‰‡éƒ½è¢«åŠ è½½å‡ºæ¥ï¼Œè€Œç”¨æˆ·åªèƒ½çœ‹åˆ°å¯è§†çª—å£çš„é‚£ä¸€éƒ¨åˆ†å›¾ç‰‡æ•°æ®ï¼Œè¿™æ ·å°±æµªè´¹äº†æ€§èƒ½ã€‚</p><p>å¦‚æœä½¿ç”¨å›¾ç‰‡çš„æ‡’åŠ è½½å°±å¯ä»¥è§£å†³ä»¥ä¸Šé—®é¢˜ã€‚åœ¨æ»šåŠ¨å±å¹•ä¹‹å‰ï¼Œå¯è§†åŒ–åŒºåŸŸä¹‹å¤–çš„å›¾ç‰‡ä¸ä¼šè¿›è¡ŒåŠ è½½ï¼Œåœ¨æ»šåŠ¨å±å¹•æ—¶æ‰åŠ è½½ã€‚è¿™æ ·ä½¿å¾—ç½‘é¡µçš„åŠ è½½é€Ÿåº¦æ›´å¿«ï¼Œå‡å°‘äº†æœåŠ¡å™¨çš„è´Ÿè½½ã€‚æ‡’åŠ è½½é€‚ç”¨äºå›¾ç‰‡è¾ƒå¤šï¼Œé¡µé¢åˆ—è¡¨è¾ƒé•¿ï¼ˆé•¿åˆ—è¡¨ï¼‰çš„åœºæ™¯ä¸­ã€‚</p><h3 id="2-æ‡’åŠ è½½çš„ç‰¹ç‚¹"><a href="#2-æ‡’åŠ è½½çš„ç‰¹ç‚¹" class="headerlink" title="2. æ‡’åŠ è½½çš„ç‰¹ç‚¹"></a>2. æ‡’åŠ è½½çš„ç‰¹ç‚¹</h3><ul><li><strong>å‡å°‘æ— ç”¨èµ„æºçš„åŠ è½½</strong>ï¼šä½¿ç”¨æ‡’åŠ è½½æ˜æ˜¾å‡å°‘äº†æœåŠ¡å™¨çš„å‹åŠ›å’Œæµé‡ï¼ŒåŒæ—¶ä¹Ÿå‡å°äº†æµè§ˆå™¨çš„è´Ÿæ‹…ã€‚</li><li><strong>æå‡ç”¨æˆ·ä½“éªŒ</strong>: å¦‚æœåŒæ—¶åŠ è½½è¾ƒå¤šå›¾ç‰‡ï¼Œå¯èƒ½éœ€è¦ç­‰å¾…çš„æ—¶é—´è¾ƒé•¿ï¼Œè¿™æ ·å½±å“äº†ç”¨æˆ·ä½“éªŒï¼Œè€Œä½¿ç”¨æ‡’åŠ è½½å°±èƒ½å¤§å¤§çš„æé«˜ç”¨æˆ·ä½“éªŒã€‚</li><li><strong>é˜²æ­¢åŠ è½½è¿‡å¤šå›¾ç‰‡è€Œå½±å“å…¶ä»–èµ„æºæ–‡ä»¶çš„åŠ è½½</strong> ï¼šä¼šå½±å“ç½‘ç«™åº”ç”¨çš„æ­£å¸¸ä½¿ç”¨ã€‚</li></ul><h3 id="3-æ‡’åŠ è½½çš„å®ç°åŸç†"><a href="#3-æ‡’åŠ è½½çš„å®ç°åŸç†" class="headerlink" title="3. æ‡’åŠ è½½çš„å®ç°åŸç†"></a>3. æ‡’åŠ è½½çš„å®ç°åŸç†</h3><p>å›¾ç‰‡çš„åŠ è½½æ˜¯ç”±<code>src</code>å¼•èµ·çš„ï¼Œå½“å¯¹<code>src</code>èµ‹å€¼æ—¶ï¼Œæµè§ˆå™¨å°±ä¼šè¯·æ±‚å›¾ç‰‡èµ„æºã€‚æ ¹æ®è¿™ä¸ªåŸç†ï¼Œæˆ‘ä»¬ä½¿ç”¨HTML5 çš„<code>data-xxx</code>å±æ€§æ¥å‚¨å­˜å›¾ç‰‡çš„è·¯å¾„ï¼Œåœ¨éœ€è¦åŠ è½½å›¾ç‰‡çš„æ—¶å€™ï¼Œå°†<code>data-xxx</code>ä¸­å›¾ç‰‡çš„è·¯å¾„èµ‹å€¼ç»™<code>src</code>ï¼Œè¿™æ ·å°±å®ç°äº†å›¾ç‰‡çš„æŒ‰éœ€åŠ è½½ï¼Œå³æ‡’åŠ è½½ã€‚</p><p>æ³¨æ„ï¼š<code>data-xxx</code> ä¸­çš„<code>xxx</code>å¯ä»¥è‡ªå®šä¹‰ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨<code>data-src</code>æ¥å®šä¹‰ã€‚</p><p>æ‡’åŠ è½½çš„å®ç°é‡ç‚¹åœ¨äºç¡®å®šç”¨æˆ·éœ€è¦åŠ è½½å“ªå¼ å›¾ç‰‡ï¼Œåœ¨æµè§ˆå™¨ä¸­ï¼Œå¯è§†åŒºåŸŸå†…çš„èµ„æºå°±æ˜¯ç”¨æˆ·éœ€è¦çš„èµ„æºã€‚æ‰€ä»¥å½“å›¾ç‰‡å‡ºç°åœ¨å¯è§†åŒºåŸŸæ—¶ï¼Œè·å–å›¾ç‰‡çš„çœŸå®åœ°å€å¹¶èµ‹å€¼ç»™å›¾ç‰‡å³å¯ã€‚</p><p>ä½¿ç”¨åŸç”ŸJavaScriptå®ç°æ‡’åŠ è½½ï¼š</p><p><strong>çŸ¥è¯†ç‚¹ï¼š</strong></p><p>ï¼ˆ1ï¼‰<code>window.innerHeight</code> æ˜¯æµè§ˆå™¨å¯è§†åŒºçš„é«˜åº¦</p><p>ï¼ˆ2ï¼‰<code>document.body.scrollTop || document.documentElement.scrollTop</code> æ˜¯æµè§ˆå™¨æ»šåŠ¨çš„è¿‡çš„è·ç¦»</p><p>ï¼ˆ3ï¼‰<code>imgs.offsetTop</code> æ˜¯å…ƒç´ é¡¶éƒ¨è·ç¦»æ–‡æ¡£é¡¶éƒ¨çš„é«˜åº¦ï¼ˆåŒ…æ‹¬æ»šåŠ¨æ¡çš„è·ç¦»ï¼‰</p><p>ï¼ˆ4ï¼‰å›¾ç‰‡åŠ è½½æ¡ä»¶ï¼š<code>img.offsetTop &lt; window.innerHeight + document.body.scrollTop;</code></p><p> <strong>å›¾ç¤ºï¼š</strong><br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/page/3.png" alt=""><br><strong>ä»£ç å®ç°ï¼š</strong></p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"container"</span><span class="token operator">></span>     <span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">"loading.gif"</span>  data<span class="token operator">-</span>src<span class="token operator">=</span><span class="token string">"pic.png"</span><span class="token operator">></span>     <span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">"loading.gif"</span>  data<span class="token operator">-</span>src<span class="token operator">=</span><span class="token string">"pic.png"</span><span class="token operator">></span>     <span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">"loading.gif"</span>  data<span class="token operator">-</span>src<span class="token operator">=</span><span class="token string">"pic.png"</span><span class="token operator">></span>     <span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">"loading.gif"</span>  data<span class="token operator">-</span>src<span class="token operator">=</span><span class="token string">"pic.png"</span><span class="token operator">></span>     <span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">"loading.gif"</span>  data<span class="token operator">-</span>src<span class="token operator">=</span><span class="token string">"pic.png"</span><span class="token operator">></span>     <span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">"loading.gif"</span>  data<span class="token operator">-</span>src<span class="token operator">=</span><span class="token string">"pic.png"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token operator">&lt;</span>script<span class="token operator">></span><span class="token keyword">var</span> imgs <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">lozyLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">var</span> scrollTop <span class="token operator">=</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>scrollTop <span class="token operator">||</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>scrollTop<span class="token punctuation">;</span>        <span class="token keyword">var</span> winHeight<span class="token operator">=</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">;</span>        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> imgs<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>imgs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>offsetTop <span class="token operator">&lt;</span> scrollTop <span class="token operator">+</span> winHeight <span class="token punctuation">)</span><span class="token punctuation">{</span>                imgs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>src <span class="token operator">=</span> imgs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'data-src'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>  window<span class="token punctuation">.</span>onscroll <span class="token operator">=</span> <span class="token function">lozyLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-æ‡’åŠ è½½ä¸é¢„åŠ è½½çš„åŒºåˆ«"><a href="#4-æ‡’åŠ è½½ä¸é¢„åŠ è½½çš„åŒºåˆ«" class="headerlink" title="4. æ‡’åŠ è½½ä¸é¢„åŠ è½½çš„åŒºåˆ«"></a>4. æ‡’åŠ è½½ä¸é¢„åŠ è½½çš„åŒºåˆ«</h3><p>è¿™ä¸¤ç§æ–¹å¼éƒ½æ˜¯æé«˜ç½‘é¡µæ€§èƒ½çš„æ–¹å¼ï¼Œä¸¤è€…ä¸»è¦åŒºåˆ«æ˜¯ä¸€ä¸ªæ˜¯æå‰åŠ è½½ï¼Œä¸€ä¸ªæ˜¯è¿Ÿç¼“ç”šè‡³ä¸åŠ è½½ã€‚æ‡’åŠ è½½å¯¹æœåŠ¡å™¨å‰ç«¯æœ‰ä¸€å®šçš„ç¼“è§£å‹åŠ›ä½œç”¨ï¼Œé¢„åŠ è½½åˆ™ä¼šå¢åŠ æœåŠ¡å™¨å‰ç«¯å‹åŠ›ã€‚</p><ul><li><strong>æ‡’åŠ è½½ä¹Ÿå«å»¶è¿ŸåŠ è½½ï¼ŒæŒ‡çš„æ˜¯åœ¨é•¿ç½‘é¡µä¸­å»¶è¿ŸåŠ è½½å›¾ç‰‡çš„æ—¶æœºï¼Œå½“ç”¨æˆ·éœ€è¦è®¿é—®æ—¶ï¼Œå†å»åŠ è½½</strong>ï¼Œè¿™æ ·å¯ä»¥æé«˜ç½‘ç«™çš„é¦–å±åŠ è½½é€Ÿåº¦ï¼Œæå‡ç”¨æˆ·çš„ä½“éªŒï¼Œå¹¶ä¸”å¯ä»¥å‡å°‘æœåŠ¡å™¨çš„å‹åŠ›ã€‚å®ƒé€‚ç”¨äºå›¾ç‰‡å¾ˆå¤šï¼Œé¡µé¢å¾ˆé•¿çš„ç”µå•†ç½‘ç«™çš„åœºæ™¯ã€‚æ‡’åŠ è½½çš„å®ç°åŸç†æ˜¯ï¼Œå°†é¡µé¢ä¸Šçš„å›¾ç‰‡çš„ src å±æ€§è®¾ç½®ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œå°†å›¾ç‰‡çš„çœŸå®è·¯å¾„ä¿å­˜åœ¨ä¸€ä¸ªè‡ªå®šä¹‰å±æ€§ä¸­ï¼Œå½“é¡µé¢æ»šåŠ¨çš„æ—¶å€™ï¼Œè¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœå›¾ç‰‡è¿›å…¥é¡µé¢å¯è§†åŒºåŸŸå†…ï¼Œåˆ™ä»è‡ªå®šä¹‰å±æ€§ä¸­å–å‡ºçœŸå®è·¯å¾„èµ‹å€¼ç»™å›¾ç‰‡çš„ src å±æ€§ï¼Œä»¥æ­¤æ¥å®ç°å›¾ç‰‡çš„å»¶è¿ŸåŠ è½½ã€‚</li><li><strong>é¢„åŠ è½½æŒ‡çš„æ˜¯å°†æ‰€éœ€çš„èµ„æºæå‰è¯·æ±‚åŠ è½½åˆ°æœ¬åœ°ï¼Œè¿™æ ·åé¢åœ¨éœ€è¦ç”¨åˆ°æ—¶å°±ç›´æ¥ä»ç¼“å­˜å–èµ„æºã€‚</strong> é€šè¿‡é¢„åŠ è½½èƒ½å¤Ÿå‡å°‘ç”¨æˆ·çš„ç­‰å¾…æ—¶é—´ï¼Œæé«˜ç”¨æˆ·çš„ä½“éªŒã€‚æˆ‘äº†è§£çš„é¢„åŠ è½½çš„æœ€å¸¸ç”¨çš„æ–¹å¼æ˜¯ä½¿ç”¨ js ä¸­çš„ image å¯¹è±¡ï¼Œé€šè¿‡ä¸º image å¯¹è±¡æ¥è®¾ç½® scr å±æ€§ï¼Œæ¥å®ç°å›¾ç‰‡çš„é¢„åŠ è½½ã€‚</li></ul><h2 id="ä¸‰ã€å›æµä¸é‡ç»˜"><a href="#ä¸‰ã€å›æµä¸é‡ç»˜" class="headerlink" title="ä¸‰ã€å›æµä¸é‡ç»˜"></a>ä¸‰ã€å›æµä¸é‡ç»˜</h2><h3 id="1-å›æµä¸é‡ç»˜çš„æ¦‚å¿µåŠè§¦å‘æ¡ä»¶"><a href="#1-å›æµä¸é‡ç»˜çš„æ¦‚å¿µåŠè§¦å‘æ¡ä»¶" class="headerlink" title="1. å›æµä¸é‡ç»˜çš„æ¦‚å¿µåŠè§¦å‘æ¡ä»¶"></a>1. å›æµä¸é‡ç»˜çš„æ¦‚å¿µåŠè§¦å‘æ¡ä»¶</h3><h4 id="ï¼ˆ1ï¼‰å›æµ"><a href="#ï¼ˆ1ï¼‰å›æµ" class="headerlink" title="ï¼ˆ1ï¼‰å›æµ"></a>ï¼ˆ1ï¼‰å›æµ</h4><p>å½“æ¸²æŸ“æ ‘ä¸­éƒ¨åˆ†æˆ–è€…å…¨éƒ¨å…ƒç´ çš„å°ºå¯¸ã€ç»“æ„æˆ–è€…å±æ€§å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæµè§ˆå™¨ä¼šé‡æ–°æ¸²æŸ“éƒ¨åˆ†æˆ–è€…å…¨éƒ¨æ–‡æ¡£çš„è¿‡ç¨‹å°±ç§°ä¸º<strong>å›æµ</strong>ã€‚</p><p>ä¸‹é¢è¿™äº›æ“ä½œä¼šå¯¼è‡´å›æµï¼š</p><ul><li>é¡µé¢çš„é¦–æ¬¡æ¸²æŸ“</li><li>æµè§ˆå™¨çš„çª—å£å¤§å°å‘ç”Ÿå˜åŒ–</li><li>å…ƒç´ çš„å†…å®¹å‘ç”Ÿå˜åŒ–</li><li>å…ƒç´ çš„å°ºå¯¸æˆ–è€…ä½ç½®å‘ç”Ÿå˜åŒ–</li><li>å…ƒç´ çš„å­—ä½“å¤§å°å‘ç”Ÿå˜åŒ–</li><li>æ¿€æ´»CSSä¼ªç±»</li><li>æŸ¥è¯¢æŸäº›å±æ€§æˆ–è€…è°ƒç”¨æŸäº›æ–¹æ³•</li><li>æ·»åŠ æˆ–è€…åˆ é™¤å¯è§çš„DOMå…ƒç´ </li></ul><p>åœ¨è§¦å‘å›æµï¼ˆé‡æ’ï¼‰çš„æ—¶å€™ï¼Œç”±äºæµè§ˆå™¨æ¸²æŸ“é¡µé¢æ˜¯åŸºäºæµå¼å¸ƒå±€çš„ï¼Œæ‰€ä»¥å½“è§¦å‘å›æµæ—¶ï¼Œä¼šå¯¼è‡´å‘¨å›´çš„DOMå…ƒç´ é‡æ–°æ’åˆ—ï¼Œå®ƒçš„å½±å“èŒƒå›´æœ‰ä¸¤ç§ï¼š</p><ul><li>å…¨å±€èŒƒå›´ï¼šä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œå¯¹æ•´ä¸ªæ¸²æŸ“æ ‘è¿›è¡Œé‡æ–°å¸ƒå±€</li><li>å±€éƒ¨èŒƒå›´ï¼šå¯¹æ¸²æŸ“æ ‘çš„æŸéƒ¨åˆ†æˆ–è€…ä¸€ä¸ªæ¸²æŸ“å¯¹è±¡è¿›è¡Œé‡æ–°å¸ƒå±€</li></ul><h4 id="ï¼ˆ2ï¼‰é‡ç»˜"><a href="#ï¼ˆ2ï¼‰é‡ç»˜" class="headerlink" title="ï¼ˆ2ï¼‰é‡ç»˜"></a>ï¼ˆ2ï¼‰é‡ç»˜</h4><p>å½“é¡µé¢ä¸­æŸäº›å…ƒç´ çš„æ ·å¼å‘ç”Ÿå˜åŒ–ï¼Œä½†æ˜¯ä¸ä¼šå½±å“å…¶åœ¨æ–‡æ¡£æµä¸­çš„ä½ç½®æ—¶ï¼Œæµè§ˆå™¨å°±ä¼šå¯¹å…ƒç´ è¿›è¡Œé‡æ–°ç»˜åˆ¶ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯<strong>é‡ç»˜</strong>ã€‚</p><p>ä¸‹é¢è¿™äº›æ“ä½œä¼šå¯¼è‡´å›æµï¼š</p><ul><li>colorã€background ç›¸å…³å±æ€§ï¼šbackground-colorã€background-image ç­‰</li><li>outline ç›¸å…³å±æ€§ï¼šoutline-colorã€outline-width ã€text-decoration</li><li>border-radiusã€visibilityã€box-shadow</li></ul><p>æ³¨æ„ï¼š <strong>å½“è§¦å‘å›æµæ—¶ï¼Œä¸€å®šä¼šè§¦å‘é‡ç»˜ï¼Œä½†æ˜¯é‡ç»˜ä¸ä¸€å®šä¼šå¼•å‘å›æµã€‚</strong></p><h3 id="2-å¦‚ä½•é¿å…å›æµä¸é‡ç»˜ï¼Ÿ"><a href="#2-å¦‚ä½•é¿å…å›æµä¸é‡ç»˜ï¼Ÿ" class="headerlink" title="2. å¦‚ä½•é¿å…å›æµä¸é‡ç»˜ï¼Ÿ"></a>2. å¦‚ä½•é¿å…å›æµä¸é‡ç»˜ï¼Ÿ</h3><p><strong>å‡å°‘å›æµä¸é‡ç»˜çš„æªæ–½ï¼š</strong></p><ul><li>æ“ä½œDOMæ—¶ï¼Œå°½é‡åœ¨ä½å±‚çº§çš„DOMèŠ‚ç‚¹è¿›è¡Œæ“ä½œ</li><li>ä¸è¦ä½¿ç”¨<code>table</code>å¸ƒå±€ï¼Œ ä¸€ä¸ªå°çš„æ”¹åŠ¨å¯èƒ½ä¼šä½¿æ•´ä¸ª<code>table</code>è¿›è¡Œé‡æ–°å¸ƒå±€</li><li>ä½¿ç”¨CSSçš„è¡¨è¾¾å¼</li><li>ä¸è¦é¢‘ç¹æ“ä½œå…ƒç´ çš„æ ·å¼ï¼Œå¯¹äºé™æ€é¡µé¢ï¼Œå¯ä»¥ä¿®æ”¹ç±»åï¼Œè€Œä¸æ˜¯æ ·å¼ã€‚</li><li>ä½¿ç”¨absoluteæˆ–è€…fixedï¼Œä½¿å…ƒç´ è„±ç¦»æ–‡æ¡£æµï¼Œè¿™æ ·ä»–ä»¬å‘ç”Ÿå˜åŒ–å°±ä¸ä¼šå½±å“å…¶ä»–å…ƒç´ </li><li>é¿å…é¢‘ç¹æ“ä½œDOMï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªæ–‡æ¡£ç‰‡æ®µ<code>documentFragment</code>ï¼Œåœ¨å®ƒä¸Šé¢åº”ç”¨æ‰€æœ‰DOMæ“ä½œï¼Œæœ€åå†æŠŠå®ƒæ·»åŠ åˆ°æ–‡æ¡£ä¸­</li><li>å°†å…ƒç´ å…ˆè®¾ç½®<code>display: none</code>ï¼Œæ“ä½œç»“æŸåå†æŠŠå®ƒæ˜¾ç¤ºå‡ºæ¥ã€‚å› ä¸ºåœ¨displayå±æ€§ä¸ºnoneçš„å…ƒç´ ä¸Šè¿›è¡Œçš„DOMæ“ä½œä¸ä¼šå¼•å‘å›æµå’Œé‡ç»˜ã€‚</li><li>å°†DOMçš„å¤šä¸ªè¯»æ“ä½œï¼ˆæˆ–è€…å†™æ“ä½œï¼‰æ”¾åœ¨ä¸€èµ·ï¼Œè€Œä¸æ˜¯è¯»å†™æ“ä½œç©¿æ’ç€å†™ã€‚è¿™å¾—ç›Šäº<strong>æµè§ˆå™¨çš„æ¸²æŸ“é˜Ÿåˆ—æœºåˆ¶</strong>ã€‚</li></ul><p>æµè§ˆå™¨é’ˆå¯¹é¡µé¢çš„å›æµä¸é‡ç»˜ï¼Œè¿›è¡Œäº†è‡ªèº«çš„ä¼˜åŒ–â€”â€”<strong>æ¸²æŸ“é˜Ÿåˆ—</strong></p><p><strong>æµè§ˆå™¨ä¼šå°†æ‰€æœ‰çš„å›æµã€é‡ç»˜çš„æ“ä½œæ”¾åœ¨ä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œå½“é˜Ÿåˆ—ä¸­çš„æ“ä½œåˆ°äº†ä¸€å®šçš„æ•°é‡æˆ–è€…åˆ°äº†ä¸€å®šçš„æ—¶é—´é—´éš”ï¼Œæµè§ˆå™¨å°±ä¼šå¯¹é˜Ÿåˆ—è¿›è¡Œæ‰¹å¤„ç†ã€‚è¿™æ ·å°±ä¼šè®©å¤šæ¬¡çš„å›æµã€é‡ç»˜å˜æˆä¸€æ¬¡å›æµé‡ç»˜ã€‚</strong></p><p>ä¸Šé¢ï¼Œå°†å¤šä¸ªè¯»æ“ä½œï¼ˆæˆ–è€…å†™æ“ä½œï¼‰æ”¾åœ¨ä¸€èµ·ï¼Œå°±ä¼šç­‰æ‰€æœ‰çš„è¯»æ“ä½œè¿›å…¥é˜Ÿåˆ—ä¹‹åæ‰§è¡Œï¼Œè¿™æ ·ï¼ŒåŸæœ¬åº”è¯¥æ˜¯è§¦å‘å¤šæ¬¡å›æµï¼Œå˜æˆäº†åªè§¦å‘ä¸€æ¬¡å›æµã€‚</p><h3 id="3-å¦‚ä½•ä¼˜åŒ–åŠ¨ç”»ï¼Ÿ"><a href="#3-å¦‚ä½•ä¼˜åŒ–åŠ¨ç”»ï¼Ÿ" class="headerlink" title="3. å¦‚ä½•ä¼˜åŒ–åŠ¨ç”»ï¼Ÿ"></a>3. å¦‚ä½•ä¼˜åŒ–åŠ¨ç”»ï¼Ÿ</h3><p>å¯¹äºå¦‚ä½•ä¼˜åŒ–åŠ¨ç”»ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒåŠ¨ç”»éœ€è¦é¢‘ç¹çš„æ“ä½œDOMï¼Œå°±å°±ä¼šå¯¼è‡´é¡µé¢çš„æ€§èƒ½é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å°†åŠ¨ç”»çš„<code>position</code>å±æ€§è®¾ç½®ä¸º<code>absolute</code>æˆ–è€…<code>fixed</code>ï¼Œå°†åŠ¨ç”»è„±ç¦»æ–‡æ¡£æµï¼Œè¿™æ ·ä»–çš„å›æµå°±ä¸ä¼šå½±å“åˆ°é¡µé¢äº†ã€‚</p><h3 id="4-documentFragment-æ˜¯ä»€ä¹ˆï¼Ÿç”¨å®ƒè·Ÿç›´æ¥æ“ä½œ-DOM-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#4-documentFragment-æ˜¯ä»€ä¹ˆï¼Ÿç”¨å®ƒè·Ÿç›´æ¥æ“ä½œ-DOM-çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="4. documentFragment æ˜¯ä»€ä¹ˆï¼Ÿç”¨å®ƒè·Ÿç›´æ¥æ“ä½œ DOM çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ"></a>4. documentFragment æ˜¯ä»€ä¹ˆï¼Ÿç”¨å®ƒè·Ÿç›´æ¥æ“ä½œ DOM çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>MDNä¸­å¯¹<code>documentFragment</code>çš„è§£é‡Šï¼š</p><blockquote><p>DocumentFragmentï¼Œæ–‡æ¡£ç‰‡æ®µæ¥å£ï¼Œä¸€ä¸ªæ²¡æœ‰çˆ¶å¯¹è±¡çš„æœ€å°æ–‡æ¡£å¯¹è±¡ã€‚å®ƒè¢«ä½œä¸ºä¸€ä¸ªè½»é‡ç‰ˆçš„ Documentä½¿ç”¨ï¼Œå°±åƒæ ‡å‡†çš„documentä¸€æ ·ï¼Œå­˜å‚¨ç”±èŠ‚ç‚¹ï¼ˆnodesï¼‰ç»„æˆçš„æ–‡æ¡£ç»“æ„ã€‚ä¸documentç›¸æ¯”ï¼Œæœ€å¤§çš„åŒºåˆ«æ˜¯DocumentFragmentä¸æ˜¯çœŸå® DOM æ ‘çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒçš„å˜åŒ–ä¸ä¼šè§¦å‘ DOM æ ‘çš„é‡æ–°æ¸²æŸ“ï¼Œä¸”ä¸ä¼šå¯¼è‡´æ€§èƒ½ç­‰é—®é¢˜ã€‚</p></blockquote><p>å½“æˆ‘ä»¬æŠŠä¸€ä¸ª DocumentFragment èŠ‚ç‚¹æ’å…¥æ–‡æ¡£æ ‘æ—¶ï¼Œæ’å…¥çš„ä¸æ˜¯ DocumentFragment è‡ªèº«ï¼Œè€Œæ˜¯å®ƒçš„æ‰€æœ‰å­å­™èŠ‚ç‚¹ã€‚åœ¨é¢‘ç¹çš„DOMæ“ä½œæ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†DOMå…ƒç´ æ’å…¥DocumentFragmentï¼Œä¹‹åä¸€æ¬¡æ€§çš„å°†æ‰€æœ‰çš„å­å­™èŠ‚ç‚¹æ’å…¥æ–‡æ¡£ä¸­ã€‚å’Œç›´æ¥æ“ä½œDOMç›¸æ¯”ï¼Œå°†DocumentFragment èŠ‚ç‚¹æ’å…¥DOMæ ‘æ—¶ï¼Œä¸ä¼šè§¦å‘é¡µé¢çš„é‡ç»˜ï¼Œè¿™æ ·å°±å¤§å¤§æé«˜äº†é¡µé¢çš„æ€§èƒ½ã€‚</p><h2 id="å››ã€èŠ‚æµä¸é˜²æŠ–"><a href="#å››ã€èŠ‚æµä¸é˜²æŠ–" class="headerlink" title="å››ã€èŠ‚æµä¸é˜²æŠ–"></a>å››ã€èŠ‚æµä¸é˜²æŠ–</h2><h3 id="1-å¯¹èŠ‚æµä¸é˜²æŠ–çš„ç†è§£"><a href="#1-å¯¹èŠ‚æµä¸é˜²æŠ–çš„ç†è§£" class="headerlink" title="1. å¯¹èŠ‚æµä¸é˜²æŠ–çš„ç†è§£"></a>1. å¯¹èŠ‚æµä¸é˜²æŠ–çš„ç†è§£</h3><ul><li>å‡½æ•°é˜²æŠ–æ˜¯æŒ‡åœ¨äº‹ä»¶è¢«è§¦å‘ n ç§’åå†æ‰§è¡Œå›è°ƒï¼Œå¦‚æœåœ¨è¿™ n ç§’å†…äº‹ä»¶åˆè¢«è§¦å‘ï¼Œåˆ™é‡æ–°è®¡æ—¶ã€‚è¿™å¯ä»¥ä½¿ç”¨åœ¨ä¸€äº›ç‚¹å‡»è¯·æ±‚çš„äº‹ä»¶ä¸Šï¼Œé¿å…å› ä¸ºç”¨æˆ·çš„å¤šæ¬¡ç‚¹å‡»å‘åç«¯å‘é€å¤šæ¬¡è¯·æ±‚ã€‚</li><li>å‡½æ•°èŠ‚æµæ˜¯æŒ‡è§„å®šä¸€ä¸ªå•ä½æ—¶é—´ï¼Œåœ¨è¿™ä¸ªå•ä½æ—¶é—´å†…ï¼Œåªèƒ½æœ‰ä¸€æ¬¡è§¦å‘äº‹ä»¶çš„å›è°ƒå‡½æ•°æ‰§è¡Œï¼Œå¦‚æœåœ¨åŒä¸€ä¸ªå•ä½æ—¶é—´å†…æŸäº‹ä»¶è¢«è§¦å‘å¤šæ¬¡ï¼Œåªæœ‰ä¸€æ¬¡èƒ½ç”Ÿæ•ˆã€‚èŠ‚æµå¯ä»¥ä½¿ç”¨åœ¨ scroll å‡½æ•°çš„äº‹ä»¶ç›‘å¬ä¸Šï¼Œé€šè¿‡äº‹ä»¶èŠ‚æµæ¥é™ä½äº‹ä»¶è°ƒç”¨çš„é¢‘ç‡ã€‚</li></ul><p><strong>é˜²æŠ–å‡½æ•°çš„åº”ç”¨åœºæ™¯ï¼š</strong></p><ul><li>æŒ‰é’®æäº¤åœºæ™¯ï¼šé˜²â½Œå¤šæ¬¡æäº¤æŒ‰é’®ï¼Œåªæ‰§â¾æœ€åæäº¤çš„â¼€æ¬¡ </li><li>æœåŠ¡ç«¯éªŒè¯åœºæ™¯ï¼šè¡¨å•éªŒè¯éœ€è¦æœåŠ¡ç«¯é…åˆï¼Œåªæ‰§â¾â¼€æ®µè¿ç»­çš„è¾“â¼Šäº‹ä»¶çš„æœ€åâ¼€æ¬¡ï¼Œè¿˜æœ‰æœç´¢è”æƒ³è¯åŠŸèƒ½ç±»ä¼¼â½£å­˜ç¯å¢ƒè¯·â½¤lodash.debounce </li></ul><p><strong>èŠ‚æµå‡½æ•°çš„é€‚â½¤åœºæ™¯ï¼š</strong></p><ul><li>æ‹–æ‹½åœºæ™¯ï¼šå›ºå®šæ—¶é—´å†…åªæ‰§â¾â¼€æ¬¡ï¼Œé˜²â½Œè¶…â¾¼é¢‘æ¬¡è§¦å‘ä½ç½®å˜åŠ¨ </li><li>ç¼©æ”¾åœºæ™¯ï¼šç›‘æ§æµè§ˆå™¨resize </li><li>åŠ¨ç”»åœºæ™¯ï¼šé¿å…çŸ­æ—¶é—´å†…å¤šæ¬¡è§¦å‘åŠ¨ç”»å¼•èµ·æ€§èƒ½é—®é¢˜ </li></ul><h3 id="2-å®ç°èŠ‚æµå‡½æ•°å’Œé˜²æŠ–å‡½æ•°"><a href="#2-å®ç°èŠ‚æµå‡½æ•°å’Œé˜²æŠ–å‡½æ•°" class="headerlink" title="2. å®ç°èŠ‚æµå‡½æ•°å’Œé˜²æŠ–å‡½æ•°"></a>2. å®ç°èŠ‚æµå‡½æ•°å’Œé˜²æŠ–å‡½æ•°</h3><p><strong>å‡½æ•°é˜²æŠ–çš„å®ç°ï¼š</strong></p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">debounce</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span> wait<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">var</span> timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">var</span> context <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">,</span>      args <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>arguments<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// å¦‚æœæ­¤æ—¶å­˜åœ¨å®šæ—¶å™¨çš„è¯ï¼Œåˆ™å–æ¶ˆä¹‹å‰çš„å®šæ—¶å™¨é‡æ–°è®°æ—¶</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>timer<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>      timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// è®¾ç½®å®šæ—¶å™¨ï¼Œä½¿äº‹ä»¶é—´éš”æŒ‡å®šäº‹ä»¶åæ‰§è¡Œ</span>    timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>      fn<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span> wait<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>å‡½æ•°èŠ‚æµçš„å®ç°ï¼š</strong></p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// æ—¶é—´æˆ³ç‰ˆ</span><span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span>fn<span class="token punctuation">,</span> delay<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token keyword">var</span> preTime <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">var</span> context <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">,</span>      args <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>arguments<span class="token punctuation">]</span><span class="token punctuation">,</span>      nowTime <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// å¦‚æœä¸¤æ¬¡æ—¶é—´é—´éš”è¶…è¿‡äº†æŒ‡å®šæ—¶é—´ï¼Œåˆ™æ‰§è¡Œå‡½æ•°ã€‚</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>nowTime <span class="token operator">-</span> preTime <span class="token operator">>=</span> delay<span class="token punctuation">)</span> <span class="token punctuation">{</span>      preTime <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token keyword">return</span> fn<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// å®šæ—¶å™¨ç‰ˆ</span><span class="token keyword">function</span> throttle <span class="token punctuation">(</span>fun<span class="token punctuation">,</span> wait<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token keyword">let</span> timeout <span class="token operator">=</span> <span class="token keyword">null</span>  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">let</span> context <span class="token operator">=</span> <span class="token keyword">this</span>    <span class="token keyword">let</span> args <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>arguments<span class="token punctuation">]</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>timeout<span class="token punctuation">)</span><span class="token punctuation">{</span>      timeout <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>        fun<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> args<span class="token punctuation">)</span>        timeout <span class="token operator">=</span> <span class="token keyword">null</span>       <span class="token punctuation">}</span><span class="token punctuation">,</span> wait<span class="token punctuation">)</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="äº”ã€å›¾ç‰‡ä¼˜åŒ–"><a href="#äº”ã€å›¾ç‰‡ä¼˜åŒ–" class="headerlink" title="äº”ã€å›¾ç‰‡ä¼˜åŒ–"></a>äº”ã€å›¾ç‰‡ä¼˜åŒ–</h2><h3 id="1-å¦‚ä½•å¯¹é¡¹ç›®ä¸­çš„å›¾ç‰‡è¿›è¡Œä¼˜åŒ–ï¼Ÿ"><a href="#1-å¦‚ä½•å¯¹é¡¹ç›®ä¸­çš„å›¾ç‰‡è¿›è¡Œä¼˜åŒ–ï¼Ÿ" class="headerlink" title="1. å¦‚ä½•å¯¹é¡¹ç›®ä¸­çš„å›¾ç‰‡è¿›è¡Œä¼˜åŒ–ï¼Ÿ"></a>1. å¦‚ä½•å¯¹é¡¹ç›®ä¸­çš„å›¾ç‰‡è¿›è¡Œä¼˜åŒ–ï¼Ÿ</h3><ol><li>ä¸ç”¨å›¾ç‰‡ã€‚å¾ˆå¤šæ—¶å€™ä¼šä½¿ç”¨åˆ°å¾ˆå¤šä¿®é¥°ç±»å›¾ç‰‡ï¼Œå…¶å®è¿™ç±»ä¿®é¥°å›¾ç‰‡å®Œå…¨å¯ä»¥ç”¨ CSS å»ä»£æ›¿ã€‚</li><li>å¯¹äºç§»åŠ¨ç«¯æ¥è¯´ï¼Œå±å¹•å®½åº¦å°±é‚£ä¹ˆç‚¹ï¼Œå®Œå…¨æ²¡æœ‰å¿…è¦å»åŠ è½½åŸå›¾æµªè´¹å¸¦å®½ã€‚ä¸€èˆ¬å›¾ç‰‡éƒ½ç”¨ CDN åŠ è½½ï¼Œå¯ä»¥è®¡ç®—å‡ºé€‚é…å±å¹•çš„å®½åº¦ï¼Œç„¶åå»è¯·æ±‚ç›¸åº”è£å‰ªå¥½çš„å›¾ç‰‡ã€‚</li><li>å°å›¾ä½¿ç”¨ base64 æ ¼å¼</li><li>å°†å¤šä¸ªå›¾æ ‡æ–‡ä»¶æ•´åˆåˆ°ä¸€å¼ å›¾ç‰‡ä¸­ï¼ˆé›ªç¢§å›¾ï¼‰</li><li>é€‰æ‹©æ­£ç¡®çš„å›¾ç‰‡æ ¼å¼ï¼š<ul><li>å¯¹äºèƒ½å¤Ÿæ˜¾ç¤º WebP æ ¼å¼çš„æµè§ˆå™¨å°½é‡ä½¿ç”¨ WebP æ ¼å¼ã€‚å› ä¸º WebP æ ¼å¼å…·æœ‰æ›´å¥½çš„å›¾åƒæ•°æ®å‹ç¼©ç®—æ³•ï¼Œèƒ½å¸¦æ¥æ›´å°çš„å›¾ç‰‡ä½“ç§¯ï¼Œè€Œä¸”æ‹¥æœ‰è‚‰çœ¼è¯†åˆ«æ— å·®å¼‚çš„å›¾åƒè´¨é‡ï¼Œç¼ºç‚¹å°±æ˜¯å…¼å®¹æ€§å¹¶ä¸å¥½</li><li>å°å›¾ä½¿ç”¨ PNGï¼Œå…¶å®å¯¹äºå¤§éƒ¨åˆ†å›¾æ ‡è¿™ç±»å›¾ç‰‡ï¼Œå®Œå…¨å¯ä»¥ä½¿ç”¨ SVG ä»£æ›¿</li><li>ç…§ç‰‡ä½¿ç”¨ JPEG</li></ul></li></ol><h3 id="2-å¸¸è§çš„å›¾ç‰‡æ ¼å¼åŠä½¿ç”¨åœºæ™¯"><a href="#2-å¸¸è§çš„å›¾ç‰‡æ ¼å¼åŠä½¿ç”¨åœºæ™¯" class="headerlink" title="2. å¸¸è§çš„å›¾ç‰‡æ ¼å¼åŠä½¿ç”¨åœºæ™¯"></a>2. å¸¸è§çš„å›¾ç‰‡æ ¼å¼åŠä½¿ç”¨åœºæ™¯</h3><p>ï¼ˆ1ï¼‰<strong>BMP</strong>ï¼Œæ˜¯æ— æŸçš„ã€æ—¢æ”¯æŒç´¢å¼•è‰²ä¹Ÿæ”¯æŒç›´æ¥è‰²çš„ç‚¹é˜µå›¾ã€‚è¿™ç§å›¾ç‰‡æ ¼å¼å‡ ä¹æ²¡æœ‰å¯¹æ•°æ®è¿›è¡Œå‹ç¼©ï¼Œæ‰€ä»¥BMPæ ¼å¼çš„å›¾ç‰‡é€šå¸¸æ˜¯è¾ƒå¤§çš„æ–‡ä»¶ã€‚</p><p>ï¼ˆ2ï¼‰<strong>GIF</strong>æ˜¯æ— æŸçš„ã€é‡‡ç”¨ç´¢å¼•è‰²çš„ç‚¹é˜µå›¾ã€‚é‡‡ç”¨LZWå‹ç¼©ç®—æ³•è¿›è¡Œç¼–ç ã€‚æ–‡ä»¶å°ï¼Œæ˜¯GIFæ ¼å¼çš„ä¼˜ç‚¹ï¼ŒåŒæ—¶ï¼ŒGIFæ ¼å¼è¿˜å…·æœ‰æ”¯æŒåŠ¨ç”»ä»¥åŠé€æ˜çš„ä¼˜ç‚¹ã€‚ä½†æ˜¯GIFæ ¼å¼ä»…æ”¯æŒ8bitçš„ç´¢å¼•è‰²ï¼Œæ‰€ä»¥GIFæ ¼å¼é€‚ç”¨äºå¯¹è‰²å½©è¦æ±‚ä¸é«˜åŒæ—¶éœ€è¦æ–‡ä»¶ä½“ç§¯è¾ƒå°çš„åœºæ™¯ã€‚</p><p>ï¼ˆ3ï¼‰<strong>JPEG</strong>æ˜¯æœ‰æŸçš„ã€é‡‡ç”¨ç›´æ¥è‰²çš„ç‚¹é˜µå›¾ã€‚JPEGçš„å›¾ç‰‡çš„ä¼˜ç‚¹æ˜¯é‡‡ç”¨äº†ç›´æ¥è‰²ï¼Œå¾—ç›Šäºæ›´ä¸°å¯Œçš„è‰²å½©ï¼ŒJPEGéå¸¸é€‚åˆç”¨æ¥å­˜å‚¨ç…§ç‰‡ï¼Œä¸GIFç›¸æ¯”ï¼ŒJPEGä¸é€‚åˆç”¨æ¥å­˜å‚¨ä¼ä¸šLogoã€çº¿æ¡†ç±»çš„å›¾ã€‚å› ä¸ºæœ‰æŸå‹ç¼©ä¼šå¯¼è‡´å›¾ç‰‡æ¨¡ç³Šï¼Œè€Œç›´æ¥è‰²çš„é€‰ç”¨ï¼Œåˆä¼šå¯¼è‡´å›¾ç‰‡æ–‡ä»¶è¾ƒGIFæ›´å¤§ã€‚</p><p>ï¼ˆ4ï¼‰<strong>PNG-8</strong>æ˜¯æ— æŸçš„ã€ä½¿ç”¨ç´¢å¼•è‰²çš„ç‚¹é˜µå›¾ã€‚PNGæ˜¯ä¸€ç§æ¯”è¾ƒæ–°çš„å›¾ç‰‡æ ¼å¼ï¼ŒPNG-8æ˜¯éå¸¸å¥½çš„GIFæ ¼å¼æ›¿ä»£è€…ï¼Œåœ¨å¯èƒ½çš„æƒ…å†µä¸‹ï¼Œåº”è¯¥å°½å¯èƒ½çš„ä½¿ç”¨PNG-8è€Œä¸æ˜¯GIFï¼Œå› ä¸ºåœ¨ç›¸åŒçš„å›¾ç‰‡æ•ˆæœä¸‹ï¼ŒPNG-8å…·æœ‰æ›´å°çš„æ–‡ä»¶ä½“ç§¯ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒPNG-8è¿˜æ”¯æŒé€æ˜åº¦çš„è°ƒèŠ‚ï¼Œè€ŒGIFå¹¶ä¸æ”¯æŒã€‚é™¤ééœ€è¦åŠ¨ç”»çš„æ”¯æŒï¼Œå¦åˆ™æ²¡æœ‰ç†ç”±ä½¿ç”¨GIFè€Œä¸æ˜¯PNG-8ã€‚</p><p>ï¼ˆ5ï¼‰<strong>PNG-24</strong>æ˜¯æ— æŸçš„ã€ä½¿ç”¨ç›´æ¥è‰²çš„ç‚¹é˜µå›¾ã€‚PNG-24çš„ä¼˜ç‚¹åœ¨äºå®ƒå‹ç¼©äº†å›¾ç‰‡çš„æ•°æ®ï¼Œä½¿å¾—åŒæ ·æ•ˆæœçš„å›¾ç‰‡ï¼ŒPNG-24æ ¼å¼çš„æ–‡ä»¶å¤§å°è¦æ¯”BMPå°å¾—å¤šã€‚å½“ç„¶ï¼ŒPNG24çš„å›¾ç‰‡è¿˜æ˜¯è¦æ¯”JPEGã€GIFã€PNG-8å¤§å¾—å¤šã€‚</p><p>ï¼ˆ6ï¼‰<strong>SVG</strong>æ˜¯æ— æŸçš„çŸ¢é‡å›¾ã€‚SVGæ˜¯çŸ¢é‡å›¾æ„å‘³ç€SVGå›¾ç‰‡ç”±ç›´çº¿å’Œæ›²çº¿ä»¥åŠç»˜åˆ¶å®ƒä»¬çš„æ–¹æ³•ç»„æˆã€‚å½“æ”¾å¤§SVGå›¾ç‰‡æ—¶ï¼Œçœ‹åˆ°çš„è¿˜æ˜¯çº¿å’Œæ›²çº¿ï¼Œè€Œä¸ä¼šå‡ºç°åƒç´ ç‚¹ã€‚è¿™æ„å‘³ç€SVGå›¾ç‰‡åœ¨æ”¾å¤§æ—¶ï¼Œä¸ä¼šå¤±çœŸï¼Œæ‰€ä»¥å®ƒéå¸¸é€‚åˆç”¨æ¥ç»˜åˆ¶Logoã€Iconç­‰ã€‚</p><p>ï¼ˆ7ï¼‰<strong>WebP</strong>æ˜¯è°·æ­Œå¼€å‘çš„ä¸€ç§æ–°å›¾ç‰‡æ ¼å¼ï¼ŒWebPæ˜¯åŒæ—¶æ”¯æŒæœ‰æŸå’Œæ— æŸå‹ç¼©çš„ã€ä½¿ç”¨ç›´æ¥è‰²çš„ç‚¹é˜µå›¾ã€‚ä»åå­—å°±å¯ä»¥çœ‹å‡ºæ¥å®ƒæ˜¯ä¸ºWebè€Œç”Ÿçš„ï¼Œä»€ä¹ˆå«ä¸ºWebè€Œç”Ÿå‘¢ï¼Ÿå°±æ˜¯è¯´ç›¸åŒè´¨é‡çš„å›¾ç‰‡ï¼ŒWebPå…·æœ‰æ›´å°çš„æ–‡ä»¶ä½“ç§¯ã€‚ç°åœ¨ç½‘ç«™ä¸Šå……æ»¡äº†å¤§é‡çš„å›¾ç‰‡ï¼Œå¦‚æœèƒ½å¤Ÿé™ä½æ¯ä¸€ä¸ªå›¾ç‰‡çš„æ–‡ä»¶å¤§å°ï¼Œé‚£ä¹ˆå°†å¤§å¤§å‡å°‘æµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´çš„æ•°æ®ä¼ è¾“é‡ï¼Œè¿›è€Œé™ä½è®¿é—®å»¶è¿Ÿï¼Œæå‡è®¿é—®ä½“éªŒã€‚ç›®å‰åªæœ‰Chromeæµè§ˆå™¨å’ŒOperaæµè§ˆå™¨æ”¯æŒWebPæ ¼å¼ï¼Œå…¼å®¹æ€§ä¸å¤ªå¥½ã€‚</p><ul><li>åœ¨æ— æŸå‹ç¼©çš„æƒ…å†µä¸‹ï¼Œç›¸åŒè´¨é‡çš„WebPå›¾ç‰‡ï¼Œæ–‡ä»¶å¤§å°è¦æ¯”PNGå°26%ï¼›</li><li>åœ¨æœ‰æŸå‹ç¼©çš„æƒ…å†µä¸‹ï¼Œå…·æœ‰ç›¸åŒå›¾ç‰‡ç²¾åº¦çš„WebPå›¾ç‰‡ï¼Œæ–‡ä»¶å¤§å°è¦æ¯”JPEGå°25%~34%ï¼›</li><li>WebPå›¾ç‰‡æ ¼å¼æ”¯æŒå›¾ç‰‡é€æ˜åº¦ï¼Œä¸€ä¸ªæ— æŸå‹ç¼©çš„WebPå›¾ç‰‡ï¼Œå¦‚æœè¦æ”¯æŒé€æ˜åº¦åªéœ€è¦22%çš„æ ¼å¤–æ–‡ä»¶å¤§å°ã€‚</li></ul><h2 id="å…­ã€Webpackä¼˜åŒ–"><a href="#å…­ã€Webpackä¼˜åŒ–" class="headerlink" title="å…­ã€Webpackä¼˜åŒ–"></a>å…­ã€Webpackä¼˜åŒ–</h2><h3 id="1-å¦‚ä½•æâ¾¼webpackçš„æ‰“åŒ…é€Ÿåº¦"><a href="#1-å¦‚ä½•æâ¾¼webpackçš„æ‰“åŒ…é€Ÿåº¦" class="headerlink" title="1. å¦‚ä½•æâ¾¼webpackçš„æ‰“åŒ…é€Ÿåº¦?"></a>1. å¦‚ä½•æâ¾¼<strong>webpack</strong>çš„æ‰“åŒ…é€Ÿåº¦?</h3><h4 id="ï¼ˆ1ï¼‰ä¼˜åŒ–-Loader"><a href="#ï¼ˆ1ï¼‰ä¼˜åŒ–-Loader" class="headerlink" title="ï¼ˆ1ï¼‰ä¼˜åŒ– Loader"></a>ï¼ˆ1ï¼‰ä¼˜åŒ– Loader</h4><p>å¯¹äº Loader æ¥è¯´ï¼Œå½±å“æ‰“åŒ…æ•ˆç‡é¦–å½“å…¶å†²å¿…å± Babel äº†ã€‚å› ä¸º Babel ä¼šå°†ä»£ç è½¬ä¸ºå­—ç¬¦ä¸²ç”Ÿæˆ ASTï¼Œç„¶åå¯¹ AST ç»§ç»­è¿›è¡Œè½¬å˜æœ€åå†ç”Ÿæˆæ–°çš„ä»£ç ï¼Œé¡¹ç›®è¶Šå¤§ï¼Œ<strong>è½¬æ¢ä»£ç è¶Šå¤šï¼Œæ•ˆç‡å°±è¶Šä½</strong>ã€‚å½“ç„¶äº†ï¼Œè¿™æ˜¯å¯ä»¥ä¼˜åŒ–çš„ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬<strong>ä¼˜åŒ– Loader çš„æ–‡ä»¶æœç´¢èŒƒå›´</strong></p><pre class="line-numbers language-javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>      <span class="token punctuation">{</span>        <span class="token comment" spellcheck="true">// js æ–‡ä»¶æ‰ä½¿ç”¨ babel</span>        test<span class="token punctuation">:</span> <span class="token regex">/\.js$/</span><span class="token punctuation">,</span>        loader<span class="token punctuation">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>        <span class="token comment" spellcheck="true">// åªåœ¨ src æ–‡ä»¶å¤¹ä¸‹æŸ¥æ‰¾</span>        include<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token comment" spellcheck="true">// ä¸ä¼šå»æŸ¥æ‰¾çš„è·¯å¾„</span>        exclude<span class="token punctuation">:</span> <span class="token regex">/node_modules/</span>      <span class="token punctuation">}</span>    <span class="token punctuation">]</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯¹äº Babel æ¥è¯´ï¼Œå¸Œæœ›åªä½œç”¨åœ¨ JS ä»£ç ä¸Šçš„ï¼Œç„¶å <code>node_modules</code> ä¸­ä½¿ç”¨çš„ä»£ç éƒ½æ˜¯ç¼–è¯‘è¿‡çš„ï¼Œæ‰€ä»¥å®Œå…¨æ²¡æœ‰å¿…è¦å†å»å¤„ç†ä¸€éã€‚</p><p>å½“ç„¶è¿™æ ·åšè¿˜ä¸å¤Ÿï¼Œè¿˜å¯ä»¥å°† Babel ç¼–è¯‘è¿‡çš„æ–‡ä»¶<strong>ç¼“å­˜</strong>èµ·æ¥ï¼Œä¸‹æ¬¡åªéœ€è¦ç¼–è¯‘æ›´æ”¹è¿‡çš„ä»£ç æ–‡ä»¶å³å¯ï¼Œè¿™æ ·å¯ä»¥å¤§å¹…åº¦åŠ å¿«æ‰“åŒ…æ—¶é—´</p><pre class="line-numbers language-javascript"><code class="language-javascript">loader<span class="token punctuation">:</span> <span class="token string">'babel-loader?cacheDirectory=true'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="ï¼ˆ2ï¼‰HappyPack"><a href="#ï¼ˆ2ï¼‰HappyPack" class="headerlink" title="ï¼ˆ2ï¼‰HappyPack"></a>ï¼ˆ2ï¼‰HappyPack</h4><p>å—é™äº Node æ˜¯å•çº¿ç¨‹è¿è¡Œçš„ï¼Œæ‰€ä»¥ Webpack åœ¨æ‰“åŒ…çš„è¿‡ç¨‹ä¸­ä¹Ÿæ˜¯å•çº¿ç¨‹çš„ï¼Œç‰¹åˆ«æ˜¯åœ¨æ‰§è¡Œ Loader çš„æ—¶å€™ï¼Œé•¿æ—¶é—´ç¼–è¯‘çš„ä»»åŠ¡å¾ˆå¤šï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´ç­‰å¾…çš„æƒ…å†µã€‚</p><p><strong>HappyPack å¯ä»¥å°† Loader çš„åŒæ­¥æ‰§è¡Œè½¬æ¢ä¸ºå¹¶è¡Œçš„</strong>ï¼Œè¿™æ ·å°±èƒ½å……åˆ†åˆ©ç”¨ç³»ç»Ÿèµ„æºæ¥åŠ å¿«æ‰“åŒ…æ•ˆç‡äº†</p><pre class="line-numbers language-javascript"><code class="language-javascript">module<span class="token punctuation">:</span> <span class="token punctuation">{</span>  loaders<span class="token punctuation">:</span> <span class="token punctuation">[</span>    <span class="token punctuation">{</span>      test<span class="token punctuation">:</span> <span class="token regex">/\.js$/</span><span class="token punctuation">,</span>      include<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>      exclude<span class="token punctuation">:</span> <span class="token regex">/node_modules/</span><span class="token punctuation">,</span>      <span class="token comment" spellcheck="true">// id åé¢çš„å†…å®¹å¯¹åº”ä¸‹é¢</span>      loader<span class="token punctuation">:</span> <span class="token string">'happypack/loader?id=happybabel'</span>    <span class="token punctuation">}</span>  <span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>  <span class="token keyword">new</span> <span class="token class-name">HappyPack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>    id<span class="token punctuation">:</span> <span class="token string">'happybabel'</span><span class="token punctuation">,</span>    loaders<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'babel-loader?cacheDirectory'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token comment" spellcheck="true">// å¼€å¯ 4 ä¸ªçº¿ç¨‹</span>    threads<span class="token punctuation">:</span> <span class="token number">4</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ï¼ˆ3ï¼‰DllPlugin"><a href="#ï¼ˆ3ï¼‰DllPlugin" class="headerlink" title="ï¼ˆ3ï¼‰DllPlugin"></a>ï¼ˆ3ï¼‰DllPlugin</h4><p><strong>DllPlugin å¯ä»¥å°†ç‰¹å®šçš„ç±»åº“æå‰æ‰“åŒ…ç„¶åå¼•å…¥</strong>ã€‚è¿™ç§æ–¹å¼å¯ä»¥æå¤§çš„å‡å°‘æ‰“åŒ…ç±»åº“çš„æ¬¡æ•°ï¼Œåªæœ‰å½“ç±»åº“æ›´æ–°ç‰ˆæœ¬æ‰æœ‰éœ€è¦é‡æ–°æ‰“åŒ…ï¼Œå¹¶ä¸”ä¹Ÿå®ç°äº†å°†å…¬å…±ä»£ç æŠ½ç¦»æˆå•ç‹¬æ–‡ä»¶çš„ä¼˜åŒ–æ–¹æ¡ˆã€‚DllPluginçš„ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// å•ç‹¬é…ç½®åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­</span><span class="token comment" spellcheck="true">// webpack.dll.conf.js</span><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>  entry<span class="token punctuation">:</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// æƒ³ç»Ÿä¸€æ‰“åŒ…çš„ç±»åº“</span>    vendor<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'react'</span><span class="token punctuation">]</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  output<span class="token punctuation">:</span> <span class="token punctuation">{</span>    path<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    filename<span class="token punctuation">:</span> <span class="token string">'[name].dll.js'</span><span class="token punctuation">,</span>    library<span class="token punctuation">:</span> <span class="token string">'[name]-[hash]'</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DllPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>      <span class="token comment" spellcheck="true">// name å¿…é¡»å’Œ output.library ä¸€è‡´</span>      name<span class="token punctuation">:</span> <span class="token string">'[name]-[hash]'</span><span class="token punctuation">,</span>      <span class="token comment" spellcheck="true">// è¯¥å±æ€§éœ€è¦ä¸ DllReferencePlugin ä¸­ä¸€è‡´</span>      context<span class="token punctuation">:</span> __dirname<span class="token punctuation">,</span>      path<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">,</span> <span class="token string">'[name]-manifest.json'</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token punctuation">]</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åéœ€è¦æ‰§è¡Œè¿™ä¸ªé…ç½®æ–‡ä»¶ç”Ÿæˆä¾èµ–æ–‡ä»¶ï¼Œæ¥ä¸‹æ¥éœ€è¦ä½¿ç”¨ <code>DllReferencePlugin</code> å°†ä¾èµ–æ–‡ä»¶å¼•å…¥é¡¹ç›®ä¸­</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// webpack.conf.js</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// ...çœç•¥å…¶ä»–é…ç½®</span>  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DllReferencePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>      context<span class="token punctuation">:</span> __dirname<span class="token punctuation">,</span>      <span class="token comment" spellcheck="true">// manifest å°±æ˜¯ä¹‹å‰æ‰“åŒ…å‡ºæ¥çš„ json æ–‡ä»¶</span>      manifest<span class="token punctuation">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./dist/vendor-manifest.json'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span>  <span class="token punctuation">]</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ï¼ˆ4ï¼‰ä»£ç å‹ç¼©"><a href="#ï¼ˆ4ï¼‰ä»£ç å‹ç¼©" class="headerlink" title="ï¼ˆ4ï¼‰ä»£ç å‹ç¼©"></a>ï¼ˆ4ï¼‰ä»£ç å‹ç¼©</h4><p>åœ¨ Webpack3 ä¸­ï¼Œä¸€èˆ¬ä½¿ç”¨ <code>UglifyJS</code> æ¥å‹ç¼©ä»£ç ï¼Œä½†æ˜¯è¿™ä¸ªæ˜¯å•çº¿ç¨‹è¿è¡Œçš„ï¼Œä¸ºäº†åŠ å¿«æ•ˆç‡ï¼Œå¯ä»¥ä½¿ç”¨ <code>webpack-parallel-uglify-plugin</code> æ¥å¹¶è¡Œè¿è¡Œ <code>UglifyJS</code>ï¼Œä»è€Œæé«˜æ•ˆç‡ã€‚</p><p>åœ¨ Webpack4 ä¸­ï¼Œä¸éœ€è¦ä»¥ä¸Šè¿™äº›æ“ä½œäº†ï¼Œåªéœ€è¦å°† <code>mode</code> è®¾ç½®ä¸º <code>production</code> å°±å¯ä»¥é»˜è®¤å¼€å¯ä»¥ä¸ŠåŠŸèƒ½ã€‚ä»£ç å‹ç¼©ä¹Ÿæ˜¯æˆ‘ä»¬å¿…åšçš„æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆï¼Œå½“ç„¶æˆ‘ä»¬ä¸æ­¢å¯ä»¥å‹ç¼© JS ä»£ç ï¼Œè¿˜å¯ä»¥å‹ç¼© HTMLã€CSS ä»£ç ï¼Œå¹¶ä¸”åœ¨å‹ç¼© JS ä»£ç çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡é…ç½®å®ç°æ¯”å¦‚åˆ é™¤ <code>console.log</code> è¿™ç±»ä»£ç çš„åŠŸèƒ½ã€‚</p><h4 id="ï¼ˆ5ï¼‰å…¶ä»–"><a href="#ï¼ˆ5ï¼‰å…¶ä»–" class="headerlink" title="ï¼ˆ5ï¼‰å…¶ä»–"></a>ï¼ˆ5ï¼‰å…¶ä»–</h4><p>å¯ä»¥é€šè¿‡ä¸€äº›å°çš„ä¼˜åŒ–ç‚¹æ¥åŠ å¿«æ‰“åŒ…é€Ÿåº¦</p><ul><li><code>resolve.extensions</code>ï¼šç”¨æ¥è¡¨æ˜æ–‡ä»¶åç¼€åˆ—è¡¨ï¼Œé»˜è®¤æŸ¥æ‰¾é¡ºåºæ˜¯ <code>['.js', '.json']</code>ï¼Œå¦‚æœä½ çš„å¯¼å…¥æ–‡ä»¶æ²¡æœ‰æ·»åŠ åç¼€å°±ä¼šæŒ‰ç…§è¿™ä¸ªé¡ºåºæŸ¥æ‰¾æ–‡ä»¶ã€‚æˆ‘ä»¬åº”è¯¥å°½å¯èƒ½å‡å°‘åç¼€åˆ—è¡¨é•¿åº¦ï¼Œç„¶åå°†å‡ºç°é¢‘ç‡é«˜çš„åç¼€æ’åœ¨å‰é¢</li><li><code>resolve.alias</code>ï¼šå¯ä»¥é€šè¿‡åˆ«åçš„æ–¹å¼æ¥æ˜ å°„ä¸€ä¸ªè·¯å¾„ï¼Œèƒ½è®© Webpack æ›´å¿«æ‰¾åˆ°è·¯å¾„</li><li><code>module.noParse</code>ï¼šå¦‚æœä½ ç¡®å®šä¸€ä¸ªæ–‡ä»¶ä¸‹æ²¡æœ‰å…¶ä»–ä¾èµ–ï¼Œå°±å¯ä»¥ä½¿ç”¨è¯¥å±æ€§è®© Webpack ä¸æ‰«æè¯¥æ–‡ä»¶ï¼Œè¿™ç§æ–¹å¼å¯¹äºå¤§å‹çš„ç±»åº“å¾ˆæœ‰å¸®åŠ©</li></ul><h3 id="2-å¦‚ä½•å‡å°‘-Webpack-æ‰“åŒ…ä½“ç§¯"><a href="#2-å¦‚ä½•å‡å°‘-Webpack-æ‰“åŒ…ä½“ç§¯" class="headerlink" title="2. å¦‚ä½•å‡å°‘ Webpack æ‰“åŒ…ä½“ç§¯"></a>2. å¦‚ä½•å‡å°‘ Webpack æ‰“åŒ…ä½“ç§¯</h3><h4 id="ï¼ˆ1ï¼‰æŒ‰éœ€åŠ è½½"><a href="#ï¼ˆ1ï¼‰æŒ‰éœ€åŠ è½½" class="headerlink" title="ï¼ˆ1ï¼‰æŒ‰éœ€åŠ è½½"></a>ï¼ˆ1ï¼‰æŒ‰éœ€åŠ è½½</h4><p>åœ¨å¼€å‘ SPA é¡¹ç›®çš„æ—¶å€™ï¼Œé¡¹ç›®ä¸­éƒ½ä¼šå­˜åœ¨å¾ˆå¤šè·¯ç”±é¡µé¢ã€‚å¦‚æœå°†è¿™äº›é¡µé¢å…¨éƒ¨æ‰“åŒ…è¿›ä¸€ä¸ª JS æ–‡ä»¶çš„è¯ï¼Œè™½ç„¶å°†å¤šä¸ªè¯·æ±‚åˆå¹¶äº†ï¼Œä½†æ˜¯åŒæ ·ä¹ŸåŠ è½½äº†å¾ˆå¤šå¹¶ä¸éœ€è¦çš„ä»£ç ï¼Œè€—è´¹äº†æ›´é•¿çš„æ—¶é—´ã€‚é‚£ä¹ˆä¸ºäº†é¦–é¡µèƒ½æ›´å¿«åœ°å‘ˆç°ç»™ç”¨æˆ·ï¼Œå¸Œæœ›é¦–é¡µèƒ½åŠ è½½çš„æ–‡ä»¶ä½“ç§¯è¶Šå°è¶Šå¥½ï¼Œ<strong>è¿™æ—¶å€™å°±å¯ä»¥ä½¿ç”¨æŒ‰éœ€åŠ è½½ï¼Œå°†æ¯ä¸ªè·¯ç”±é¡µé¢å•ç‹¬æ‰“åŒ…ä¸ºä¸€ä¸ªæ–‡ä»¶</strong>ã€‚å½“ç„¶ä¸ä»…ä»…è·¯ç”±å¯ä»¥æŒ‰éœ€åŠ è½½ï¼Œå¯¹äº <code>loadash</code> è¿™ç§å¤§å‹ç±»åº“åŒæ ·å¯ä»¥ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½ã€‚</p><p>æŒ‰éœ€åŠ è½½çš„ä»£ç å®ç°è¿™é‡Œå°±ä¸è¯¦ç»†å±•å¼€äº†ï¼Œå› ä¸ºé‰´äºç”¨çš„æ¡†æ¶ä¸åŒï¼Œå®ç°èµ·æ¥éƒ½æ˜¯ä¸ä¸€æ ·çš„ã€‚å½“ç„¶äº†ï¼Œè™½ç„¶ä»–ä»¬çš„ç”¨æ³•å¯èƒ½ä¸åŒï¼Œä½†æ˜¯åº•å±‚çš„æœºåˆ¶éƒ½æ˜¯ä¸€æ ·çš„ã€‚éƒ½æ˜¯å½“ä½¿ç”¨çš„æ—¶å€™å†å»ä¸‹è½½å¯¹åº”æ–‡ä»¶ï¼Œè¿”å›ä¸€ä¸ª <code>Promise</code>ï¼Œå½“ <code>Promise</code> æˆåŠŸä»¥åå»æ‰§è¡Œå›è°ƒã€‚</p><h4 id="ï¼ˆ2ï¼‰Scope-Hoisting"><a href="#ï¼ˆ2ï¼‰Scope-Hoisting" class="headerlink" title="ï¼ˆ2ï¼‰Scope Hoisting"></a>ï¼ˆ2ï¼‰Scope Hoisting</h4><p><strong>Scope Hoisting ä¼šåˆ†æå‡ºæ¨¡å—ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œå°½å¯èƒ½çš„æŠŠæ‰“åŒ…å‡ºæ¥çš„æ¨¡å—åˆå¹¶åˆ°ä¸€ä¸ªå‡½æ•°ä¸­å»ã€‚</strong></p><p>æ¯”å¦‚å¸Œæœ›æ‰“åŒ…ä¸¤ä¸ªæ–‡ä»¶ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// test.js</span><span class="token keyword">export</span> <span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token comment" spellcheck="true">// index.js</span><span class="token keyword">import</span> <span class="token punctuation">{</span> a <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./test.js'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å¯¹äºè¿™ç§æƒ…å†µï¼Œæ‰“åŒ…å‡ºæ¥çš„ä»£ç ä¼šç±»ä¼¼è¿™æ ·ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">[</span>  <span class="token comment" spellcheck="true">/* 0 */</span>  <span class="token keyword">function</span> <span class="token punctuation">(</span>module<span class="token punctuation">,</span> exports<span class="token punctuation">,</span> require<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//...</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token comment" spellcheck="true">/* 1 */</span>  <span class="token keyword">function</span> <span class="token punctuation">(</span>module<span class="token punctuation">,</span> exports<span class="token punctuation">,</span> require<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//...</span>  <span class="token punctuation">}</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½†æ˜¯å¦‚æœä½¿ç”¨ Scope Hoisting ï¼Œä»£ç å°±ä¼šå°½å¯èƒ½çš„åˆå¹¶åˆ°ä¸€ä¸ªå‡½æ•°ä¸­å»ï¼Œä¹Ÿå°±å˜æˆäº†è¿™æ ·çš„ç±»ä¼¼ä»£ç ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">[</span>  <span class="token comment" spellcheck="true">/* 0 */</span>  <span class="token keyword">function</span> <span class="token punctuation">(</span>module<span class="token punctuation">,</span> exports<span class="token punctuation">,</span> require<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">//...</span>  <span class="token punctuation">}</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·çš„æ‰“åŒ…æ–¹å¼ç”Ÿæˆçš„ä»£ç æ˜æ˜¾æ¯”ä¹‹å‰çš„å°‘å¤šäº†ã€‚å¦‚æœåœ¨ Webpack4 ä¸­ä½ å¸Œæœ›å¼€å¯è¿™ä¸ªåŠŸèƒ½ï¼Œåªéœ€è¦å¯ç”¨ <code>optimization.concatenateModules</code> å°±å¯ä»¥äº†ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>  optimization<span class="token punctuation">:</span> <span class="token punctuation">{</span>    concatenateModules<span class="token punctuation">:</span> <span class="token boolean">true</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ï¼ˆ3ï¼‰Tree-Shaking"><a href="#ï¼ˆ3ï¼‰Tree-Shaking" class="headerlink" title="ï¼ˆ3ï¼‰Tree Shaking"></a>ï¼ˆ3ï¼‰Tree Shaking</h4><p><strong>Tree Shaking å¯ä»¥å®ç°åˆ é™¤é¡¹ç›®ä¸­æœªè¢«å¼•ç”¨çš„ä»£ç </strong>ï¼Œæ¯”å¦‚ï¼š</p><pre><code>// test.jsexport const a = 1export const b = 2// index.jsimport { a } from './test.js'</code></pre><p>å¯¹äºä»¥ä¸Šæƒ…å†µï¼Œ<code>test</code> æ–‡ä»¶ä¸­çš„å˜é‡ <code>b</code> å¦‚æœæ²¡æœ‰åœ¨é¡¹ç›®ä¸­ä½¿ç”¨åˆ°çš„è¯ï¼Œå°±ä¸ä¼šè¢«æ‰“åŒ…åˆ°æ–‡ä»¶ä¸­ã€‚</p><p>å¦‚æœä½¿ç”¨ Webpack 4 çš„è¯ï¼Œå¼€å¯ç”Ÿäº§ç¯å¢ƒå°±ä¼šè‡ªåŠ¨å¯åŠ¨è¿™ä¸ªä¼˜åŒ–åŠŸèƒ½ã€‚</p><h3 id="3-å¦‚ä½•â½¤webpackæ¥ä¼˜åŒ–å‰ç«¯æ€§èƒ½ï¼Ÿ"><a href="#3-å¦‚ä½•â½¤webpackæ¥ä¼˜åŒ–å‰ç«¯æ€§èƒ½ï¼Ÿ" class="headerlink" title="3. å¦‚ä½•â½¤webpackæ¥ä¼˜åŒ–å‰ç«¯æ€§èƒ½ï¼Ÿ"></a>3. å¦‚ä½•â½¤<strong>webpack</strong>æ¥ä¼˜åŒ–å‰ç«¯æ€§èƒ½ï¼Ÿ</h3><p>â½¤webpackä¼˜åŒ–å‰ç«¯æ€§èƒ½æ˜¯æŒ‡ä¼˜åŒ–webpackçš„è¾“å‡ºç»“æœï¼Œè®©æ‰“åŒ…çš„æœ€ç»ˆç»“æœåœ¨æµè§ˆå™¨è¿â¾å¿«é€Ÿâ¾¼æ•ˆã€‚ </p><ul><li><strong>å‹ç¼©ä»£ç </strong>ï¼šåˆ é™¤å¤šä½™çš„ä»£ç ã€æ³¨é‡Šã€ç®€åŒ–ä»£ç çš„å†™æ³•ç­‰ç­‰â½…å¼ã€‚å¯ä»¥åˆ©â½¤webpackçš„ UglifyJsPlugin å’Œ ParallelUglifyPlugin æ¥å‹ç¼©JSâ½‚ä»¶ï¼Œ åˆ©â½¤ cssnano ï¼ˆcss-loader?minimizeï¼‰æ¥å‹ç¼©css </li><li><strong>åˆ©â½¤CDNåŠ é€Ÿ</strong>: åœ¨æ„å»ºè¿‡ç¨‹ä¸­ï¼Œå°†å¼•â½¤çš„é™æ€èµ„æºè·¯å¾„ä¿®æ”¹ä¸ºCDNä¸Šå¯¹åº”çš„è·¯å¾„ã€‚å¯ä»¥åˆ©â½¤webpackå¯¹äº output å‚æ•°å’Œå„loaderçš„ publicPath å‚æ•°æ¥ä¿®æ”¹èµ„æºè·¯å¾„ </li><li><strong>Tree Shaking</strong>: å°†ä»£ç ä¸­æ°¸è¿œä¸ä¼šâ¾›åˆ°çš„â½šæ®µåˆ é™¤æ‰ã€‚å¯ä»¥é€šè¿‡åœ¨å¯åŠ¨webpackæ—¶è¿½åŠ å‚æ•° â€“optimize-minimize æ¥å®ç°</li><li><strong>Code Splitting:</strong> å°†ä»£ç æŒ‰è·¯ç”±ç»´åº¦æˆ–è€…ç»„ä»¶åˆ†å—(chunk),è¿™æ ·åšåˆ°æŒ‰éœ€åŠ è½½,åŒæ—¶å¯ä»¥å……åˆ†åˆ©â½¤æµè§ˆå™¨ç¼“å­˜ </li><li><strong>æå–å…¬å…±ç¬¬ä¸‰â½…åº“</strong>: SplitChunksPluginæ’ä»¶æ¥è¿›â¾å…¬å…±æ¨¡å—æŠ½å–,åˆ©â½¤æµè§ˆå™¨ç¼“å­˜å¯ä»¥â»“æœŸç¼“å­˜è¿™äº›â½†éœ€é¢‘ç¹å˜åŠ¨çš„å…¬å…±ä»£ç  </li></ul><h3 id="4-å¦‚ä½•æâ¾¼webpackçš„æ„å»ºé€Ÿåº¦ï¼Ÿ"><a href="#4-å¦‚ä½•æâ¾¼webpackçš„æ„å»ºé€Ÿåº¦ï¼Ÿ" class="headerlink" title="4. å¦‚ä½•æâ¾¼webpackçš„æ„å»ºé€Ÿåº¦ï¼Ÿ"></a>4. å¦‚ä½•æâ¾¼<strong>webpack</strong>çš„æ„å»ºé€Ÿåº¦ï¼Ÿ</h3><ol><li>å¤šâ¼Šâ¼æƒ…å†µä¸‹ï¼Œä½¿â½¤ CommonsChunkPlugin æ¥æå–å…¬å…±ä»£ç  </li><li>é€šè¿‡ externals é…ç½®æ¥æå–å¸¸â½¤åº“ </li><li>åˆ©â½¤ DllPlugin å’Œ DllReferencePlugin é¢„ç¼–è¯‘èµ„æºæ¨¡å— é€šè¿‡ DllPlugin æ¥å¯¹é‚£äº›æˆ‘ä»¬å¼•â½¤ä½†æ˜¯ç»å¯¹ä¸ä¼šä¿®æ”¹çš„npmåŒ…æ¥è¿›â¾é¢„ç¼–è¯‘ï¼Œå†é€šè¿‡ DllReferencePlugin å°†é¢„ç¼–è¯‘çš„æ¨¡å—åŠ è½½è¿›æ¥ã€‚ </li><li>ä½¿â½¤ Happypack å®ç°å¤šçº¿ç¨‹åŠ é€Ÿç¼–è¯‘ </li><li>ä½¿â½¤ webpack-uglify-parallel æ¥æå‡ uglifyPlugin çš„å‹ç¼©é€Ÿåº¦ã€‚ åŸç†ä¸Š webpack-uglify-parallel é‡‡â½¤äº†å¤šæ ¸å¹¶â¾å‹ç¼©æ¥æå‡å‹ç¼©é€Ÿåº¦ </li><li>ä½¿â½¤ Tree-shaking å’Œ Scope Hoisting æ¥å‰”é™¤å¤šä½™ä»£ç  </li></ol><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> æ€§èƒ½ä¼˜åŒ– </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åŠ è½½æ€§èƒ½ </tag>
            
            <tag> æ‰“åŒ…æ€§èƒ½ </tag>
            
            <tag> æ€§èƒ½ä¼˜åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åšå®¢å¼€æº</title>
      <link href="/2021/08/27/blog-open-source/"/>
      <url>/2021/08/27/blog-open-source/</url>
      
        <content type="html"><![CDATA[<h1 id="æ•ˆæœæ¼”ç¤ºï¼ˆæ´ªå«åšå®¢ï¼‰"><a href="#æ•ˆæœæ¼”ç¤ºï¼ˆæ´ªå«åšå®¢ï¼‰" class="headerlink" title="æ•ˆæœæ¼”ç¤ºï¼ˆæ´ªå«åšå®¢ï¼‰"></a>æ•ˆæœæ¼”ç¤ºï¼ˆæ´ªå«åšå®¢ï¼‰</h1><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://raw.githubusercontent.com/shw2018/cdn/master/blog_files/img/Blog-Open-Source/blog-demo1.gif" alt="æ¼”ç¤ºDemo"></p><h1 id="ç®€çŸ­ä»‹ç»"><a href="#ç®€çŸ­ä»‹ç»" class="headerlink" title="ç®€çŸ­ä»‹ç»"></a>ç®€çŸ­ä»‹ç»</h1><p>ä½¿ç”¨äº†æ´ªå«çš„åšå®¢å¼€æºï¼Œ<br>æˆ‘çš„ç½‘ç«™å€’è…¾äº†ä¸€ä¸¤å‘¨æ€»ç®—æŠŠä¸ªäººåšå®¢ç½‘ç«™å®Œå–„äº†ï¼Œç›®å‰è¿™ä¸ªç‰ˆæœ¬ä½¿ç”¨åº”è¯¥æ˜¯å¤Ÿäº†ï¼Œå½“ç„¶è¿˜æœ‰ä¸€äº›ä¼˜åŒ–é¡¹å’ŒåŠŸèƒ½å¢åŠ åç»­åœ¨æ…¢æ…¢æ›´æ–°ï¼Œä¸ºäº†å›é¦ˆå¼€æºï¼Œä»Šå¤©å‡†å¤‡æŠŠæˆ‘è‡ªå·±ä¿®æ”¹å®Œå–„çš„<code>blog</code>ç½‘ç«™æºä»£ç å¼€æºã€‚è¿™ä¸æ˜¯ç”Ÿæˆåçš„ç½‘é¡µæ–‡ä»¶ï¼Œæ˜¯æ‚¨å¯ä»¥ç›´æ¥ä½¿ç”¨çš„æºç ï¼Œæ‚¨åªéœ€è¦æŠŠåšå®¢ç›¸å…³ä¿¡æ¯æ¢æˆæ‚¨è‡ªå·±çš„å°±å¯ä»¥éƒ¨ç½²äº†ï¼Œå¯¹äºæ–°æ‰‹æˆ–è€…ä¸æ‡‚ç¼–ç¨‹çš„å°ä¼™ä¼´æ¥è¯´ï¼Œç®€ç›´æ˜¯ç¦éŸ³ï¼Œæå¤§ç®€åŒ–äº†æ‚¨æ„å»ºåšå®¢çš„å·¥ä½œé‡å’Œå¤æ‚åº¦ï¼Œæ¯ä¸ªäººéƒ½å¯ä»¥ä¸‹è½½å¹¶ä¿®æ”¹æˆè‡ªå·±å–œæ¬¢æ ·å¼ï¼å¦‚æœä½ æœ‰ä¿®æ”¹æƒ³æ³•ï¼Œæ¬¢è¿PRï¼æœ€åï¼Œæˆ‘ä»¬è¿˜æ˜¯ç»™è¿™ä¸ªå¼€æºå°é¡¹ç›®å–ä¸ªåå­—å§ï¼Œå°±å«<a href="https://github.com/shw2018/hexo-blog-fly.git">hexo-blog-fly</a>å§ï¼Œæ€ä¹ˆæ ·ï¼Ÿ&lt;&lt;&lt;&lt;&lt;<a href="https://github.com/shw2018/hexo-blog-fly">æºä»£ç ä¸‹è½½</a>&gt;&gt;&gt;&gt;&gt;</p><p>æœ¬åšå®¢åŸºäº<code>Hexo</code>æ¡†æ¶æ­å»ºï¼Œç”¨åˆ°<a href="https://github.com/shw2018/hexo-theme-matery">hexo-theme-matery</a>ä¸»é¢˜, å¹¶åœ¨æ­¤åŸºç¡€ä¹‹ä¸Šåšäº†å¾ˆå¤šä¿®æ”¹ï¼Œä¿®å¤äº†ä¸€äº›bugï¼Œå¢åŠ äº†ä¸€äº›æ–°çš„ç‰¹æ€§å’ŒåŠŸèƒ½ï¼Œåšå®¢åœ°å€ï¼š<a href="https://shw2018.github.io/">https://shw2018.github.io</a>ï¼Œåšå®¢æ¼”ç¤ºï¼š<a href="https://sunhwee.com">sunhwee.com</a>ã€‚</p><hr><h2 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h2><p><strong>åŸä¸»é¢˜ç‰¹æ€§</strong>:</p><ul><li><p>ç®€å•æ¼‚äº®ï¼Œæ–‡ç« å†…å®¹ç¾è§‚æ˜“è¯»</p></li><li><p><a href="https://material.io/">Material Design</a> è®¾è®¡</p></li><li><p>å“åº”å¼è®¾è®¡ï¼Œåšå®¢åœ¨æ¡Œé¢ç«¯ã€å¹³æ¿ã€æ‰‹æœºç­‰è®¾å¤‡ä¸Šå‡èƒ½å¾ˆå¥½çš„å±•ç°</p></li><li><p>é¦–é¡µè½®æ’­æ–‡ç« åŠæ¯å¤©åŠ¨æ€åˆ‡æ¢ <code>Banner</code> å›¾ç‰‡</p></li><li><p>ç€‘å¸ƒæµå¼çš„åšå®¢æ–‡ç« åˆ—è¡¨ï¼ˆæ–‡ç« æ— ç‰¹è‰²å›¾ç‰‡æ—¶ä¼šæœ‰ <code>24</code> å¼ æ¼‚äº®çš„å›¾ç‰‡ä»£æ›¿ï¼‰</p></li><li><p>æ—¶é—´è½´å¼çš„å½’æ¡£é¡µ</p></li><li><p><strong>è¯äº‘</strong>çš„æ ‡ç­¾é¡µå’Œ<strong>é›·è¾¾å›¾</strong>çš„åˆ†ç±»é¡µ</p></li><li><p>ä¸°å¯Œçš„å…³äºæˆ‘é¡µé¢ï¼ˆåŒ…æ‹¬å…³äºæˆ‘ã€æ–‡ç« ç»Ÿè®¡å›¾ã€æˆ‘çš„é¡¹ç›®ã€æˆ‘çš„æŠ€èƒ½ã€ç›¸å†Œç­‰ï¼‰</p></li><li><p>å¯è‡ªå®šä¹‰çš„æ•°æ®çš„å‹æƒ…é“¾æ¥é¡µé¢</p></li><li><p>æ”¯æŒæ–‡ç« ç½®é¡¶å’Œæ–‡ç« æ‰“èµ</p></li><li><p>æ”¯æŒ <code>MathJax</code></p></li><li><p><code>TOC</code> ç›®å½•</p></li><li><p>å¯è®¾ç½®å¤åˆ¶æ–‡ç« å†…å®¹æ—¶è¿½åŠ ç‰ˆæƒä¿¡æ¯</p></li><li><p>å¯è®¾ç½®é˜…è¯»æ–‡ç« æ—¶åšå¯†ç éªŒè¯</p></li><li><p><a href="https://gitalk.github.io/">Gitalk</a>ã€<a href="https://imsun.github.io/gitment/">Gitment</a>ã€<a href="https://valine.js.org/">Valine</a> å’Œ <a href="https://disqus.com/">Disqus</a> è¯„è®ºæ¨¡å—ï¼ˆæ¨èä½¿ç”¨ <code>Gitalk</code>ï¼‰</p></li><li><p>é›†æˆäº†<a href="http://busuanzi.ibruce.info/">ä¸è’œå­ç»Ÿè®¡</a>ã€è°·æ­Œåˆ†æï¼ˆ<code>Google Analytics</code>ï¼‰å’Œæ–‡ç« å­—æ•°ç»Ÿè®¡ç­‰åŠŸèƒ½</p></li><li><p>æ”¯æŒåœ¨é¦–é¡µçš„éŸ³ä¹æ’­æ”¾å’Œè§†é¢‘æ’­æ”¾åŠŸèƒ½</p><p><strong>å¢åŠ çš„å·¥ä½œæˆ–ç‰¹æ€§(æœªæ‰“é’©çš„æ˜¯å·²åšä½†è¿˜æ²¡æ›´æ–°åˆ°æºç çš„)</strong>:</p></li><li><p>ä¿®æ”¹äº†åŸä¸»é¢˜çš„ä¸€äº›å¾ˆå¤š<code>bug</code>   2019.08.05</p></li><li><p>åŠ å…¥å›¾ç‰‡æ‡’åŠ è½½åŠŸèƒ½ï¼Œåœ¨æ ¹ç›®å½•é…ç½®æ–‡ä»¶å¼€å¯å’Œå…³é—­    2019.08.09</p></li><li><p>å¢åŠ <code>ç•™è¨€æ¿</code>åŠŸèƒ½          2019.08.05</p></li><li><p>åœ¨å…³äºæ¿å—,åŠ å…¥<code>ç®€å†</code>åŠŸèƒ½é¡µ   2019.08.05</p></li><li><p>å¢åŠ è§†å¬[è§†è§‰å¬è§‰å½±éŸ³]æ¿å—       2019.08.10</p></li><li><p>æ”¯æŒ<code>emoji</code>è¡¨æƒ…ï¼Œç”¨<code>markdown emoji</code>è¯­æ³•ä¹¦å†™ç›´æ¥ç”Ÿæˆå¯¹åº”çš„èƒ½<strong>è·³è·ƒ</strong>çš„è¡¨æƒ…ã€‚  2019.08.10</p></li><li><p>å¢åŠ ç½‘ç«™è¿è¡Œæ—¶é—´æ˜¾ç¤º  2019.08.10</p></li><li><p>å¢åŠ <code>åŠ¨æ¼«æ¨¡å‹</code>     2019.08.10</p></li><li><p>æ•´ä½“æ›¿æ¢Bannerå›¾ç‰‡å’Œæ–‡ç« ç‰¹è‰²å›¾ç‰‡   2019.08.10</p></li><li><p>å¢åŠ åˆ†ç±»<code>ç›¸å†Œ</code>åŠŸèƒ½         2019.08.29</p></li><li><p>å»æ‰æ ‡ç­¾é¡µ,å°†å…¶åˆå¹¶è‡³<code>åˆ†ç±»</code>é¡µä¸­                2019.09.01</p></li><li><p>ä¿®æ”¹äº†ä¸€äº›æ§ä»¶çš„å‚æ•°   2019.09.01</p></li><li><p>ä¿®æ”¹éƒ¨åˆ†æ ·å¼,æ¯”å¦‚: æ–‡ç« å¡ç‰‡,å›ºå®šé«˜åº¦,ä½¿å…¶ä¸è‡³äºå› ä¸ºæ–‡ç« æ‘˜è¦çš„é•¿çŸ­ä¸åŒå¯¼è‡´å¡ç‰‡å¤§å°ä¸ä¸€ä½¿é¡µé¢å¸ƒå±€å¾ˆä¸ç¾è§‚,ç±»ä¼¼çš„è¿˜æœ‰å‹é“¾å¡ç‰‡,ä¼˜åŒ–äº†é¡µé¢å†…å®¹å¸ƒå±€,è§†è§‰æ›´æ•´é½ç¾è§‚          2019.09.01</p></li><li><p>è§£å†³é¦–é¡µæ–‡ç« åˆ—è¡¨å¡ç‰‡ä¸Šæ–¹ <code>border-radius</code>åœ†è§’å¤±æ•ˆçš„bug  2019.09.01</p></li><li><p>æ·»åŠ é¡µé¢æ¨±èŠ±é£˜è½åŠ¨æ•ˆ            2019.09.09</p></li><li><p>æ·»åŠ é¼ æ ‡ç‚¹å‡»çƒŸèŠ±çˆ†ç‚¸åŠ¨æ•ˆ   2019.09.09</p></li><li><p>åŠ å…¥å¤©æ°”æ¥å£æ§ä»¶   2019.09.09</p></li><li><p>åŠ å…¥é¼ æ ‡ç‚¹å‡»æ–‡å­—ç‰¹æ•ˆ   2019.09.10</p></li><li><p>æ·»åŠ é¡µé¢é›ªèŠ±é£˜è½åŠ¨æ•ˆ            2019.09.10</p></li><li><p>æ·»åŠ åœ¨çº¿èŠå¤©æ’ä»¶            2019.09.12</p></li><li><p>æŒç»­æ›´æ–°â€¦</p></li></ul><hr><p><strong>ç®€å•ä½¿ç”¨æ–¹æ³•ï¼š</strong></p><ol><li><code>star</code> æœ¬é¡¹ç›®</li><li>å®‰è£…<a href="https://git-scm.com/downloads">Git</a>, å®‰è£…<a href="https://nodejs.org/en/">nodeJS</a></li><li>ä½ å¯ä»¥ç›´æ¥<code>fork</code>ä¸€ä»½æºç åˆ°ä½ çš„ä»“åº“ï¼Œ<code>clone</code>åˆ°æœ¬åœ°</li><li>åœ¨æœ¬åœ°åšå®¢ä»“åº“è¿è¡Œ<code>npm i</code>å‘½ä»¤å®‰è£…ä¾èµ–åŒ…</li><li>ä¿®æ”¹é…ç½®ä¿¡æ¯ï¼Œæ”¹æˆè‡ªå·±çš„ä¿¡æ¯</li><li>è¿è¡Œå‘½ä»¤<code>hexo  clean</code>ï¼ˆæ¸…é™¤ç”Ÿæˆæ–‡ä»¶ï¼‰ï¼Œ<code>hexo g</code>ï¼ˆç”Ÿæˆç½‘é¡µï¼‰ï¼Œ <code>hexo  s</code>ï¼ˆæœ¬åœ°é¢„è§ˆï¼‰ï¼Œ<code>hexo d</code>ï¼ˆéƒ¨ç½²ï¼‰</li></ol><blockquote><p><strong>æ›´å¤šè¯¦æƒ…æ•™ç¨‹ï¼Œå¼ºçƒˆæ¨èçœ‹æˆ‘å†™çš„ï¼š<a href="https://sunhwee.com/posts/6e8839eb.html">Hexo+Githubåšå®¢æ­å»ºå®Œå…¨æ•™ç¨‹</a></strong></p></blockquote><blockquote><p><strong>æœ€åï¼Œå¦‚æœé¡¹ç›®å’Œæ•™ç¨‹å¯¹ä½ æœ‰æ‰€å¸®åŠ©æˆ–è€…ä½ çœ‹è§äº†è¿˜ç®—æ¯”è¾ƒå–œæ¬¢ï¼Œæ¬¢è¿ç»™æˆ‘<code>star</code>ï¼Œè°¢è°¢æ‚¨ï¼</strong></p></blockquote><p><strong>æŒç»­æ›´æ–°ä¸­â€¦ï¼Œå¦‚æœé‡åˆ°é—®é¢˜æ¬¢è¿è”ç³»æˆ‘ï¼Œåœ¨æ–‡ç« æœ€åè¯„è®ºåŒºã€ç•™è¨€å’Œè®¨è®ºã€‘ï¼Œå½“ç„¶ï¼Œæ¬¢è¿ç‚¹å‡»æ–‡ç« æœ€åçš„æ‰“èµæŒ‰é”®ï¼Œè¯·åšä¸»ä¸€æ¯å†°é˜”ä¹ï¼Œç¬‘ï½</strong><br><escape></escape></p><table>  <tbody><tr>    <td><img width="100" src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://sunhwee.com/medias/reward/alipay.bmp"></td>    <td><img width="100" src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://sunhwee.com/medias/reward/wechat.bmp"></td>    <td><img width="100" src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://sunhwee.com/medias/reward/zan.png"></td>     </tr></tbody></table><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> è½¯ä»¶å®‰è£…ä¸é…ç½® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Github </tag>
            
            <tag> åšå®¢ </tag>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vue</title>
      <link href="/2021/01/30/vue/"/>
      <url>/2021/01/30/vue/</url>
      
        <content type="html"><![CDATA[<h1 id="ç®€çŸ­ä»‹ç»"><a href="#ç®€çŸ­ä»‹ç»" class="headerlink" title="ç®€çŸ­ä»‹ç»"></a>ç®€çŸ­ä»‹ç»</h1><p><code>Vue.js</code> æ˜¯ä¸€ä¸ªæ¸è¿›å¼ <code>JavaScript</code> æ¡†æ¶ï¼Œä¸»è¦ç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢ã€‚å®ƒçš„è®¾è®¡å“²å­¦æ˜¯â€œè‡ªåº•å‘ä¸Šæ¸è¿›å¼â€ï¼Œè¿™æ„å‘³ç€å¼€å‘è€…å¯ä»¥æ ¹æ®é¡¹ç›®éœ€æ±‚ï¼Œä»ç®€å•çš„é¡µé¢å¢å¼ºåˆ°å¤æ‚çš„å•é¡µé¢åº”ç”¨<code>ï¼ˆSPAï¼‰</code>ã€‚Vue.js æ—¢è½»é‡æ˜“ç”¨ï¼ŒåˆåŠŸèƒ½å¼ºå¤§ï¼Œå¸æ”¶äº† <code>Angular</code> å’Œ <code>React</code> çš„ä¼˜ç‚¹ã€‚<br><code>å­¦ä¹ æ˜¯ä¸€é¡¹é•¿æœŸçš„ä»»åŠ¡ï¼Œè®©æˆ‘æ¥ä¸€èµ·æˆé•¿å§ï¼</code></p><hr><h2 id="åŸºç¡€"><a href="#åŸºç¡€" class="headerlink" title="åŸºç¡€"></a>åŸºç¡€</h2><h2 id="vue-å’Œ-react-æœ‰ä»€ä¹ˆä¸åŒ"><a href="#vue-å’Œ-react-æœ‰ä»€ä¹ˆä¸åŒ" class="headerlink" title="vue å’Œ react æœ‰ä»€ä¹ˆä¸åŒ"></a>vue å’Œ react æœ‰ä»€ä¹ˆä¸åŒ</h2><ol><li><strong>è®¾è®¡å“²å­¦</strong><br><code>Vue.js</code></li></ol><ul><li>æ¸è¿›å¼æ¡†æ¶ï¼š<code>Vue</code> æ˜¯ä¸€ä¸ªæ¸è¿›å¼æ¡†æ¶ï¼Œæ„å‘³ç€ä½ å¯ä»¥ä»ç®€å•çš„é¡¹ç›®å¼€å§‹ï¼Œå¹¶é€æ­¥å¼•å…¥æ›´å¤šåŠŸèƒ½å’Œå·¥å…·ï¼Œå¦‚ <code>Vue Router</code>ï¼ˆè·¯ç”±ï¼‰å’Œ <code>Pinia/Vuex</code>ï¼ˆçŠ¶æ€ç®¡ç†ï¼‰ï¼Œä»è€Œä½¿æ¡†æ¶é€‚åº”é¡¹ç›®çš„å¤æ‚æ€§ã€‚<br>åŒå‘æ•°æ®ç»‘å®šï¼šVue æä¾›äº†å†…ç½®çš„åŒå‘æ•°æ®ç»‘å®šï¼Œä½¿å¾—å¼€å‘è¡¨å•æˆ–ç”¨æˆ·è¾“å…¥ç­‰åœºæ™¯æ›´åŠ ç®€ä¾¿ã€‚<br><code>React.js</code></li></ul><p><code>UI åº“</code>ï¼š<code>React</code> æ›´åƒæ˜¯ä¸€ä¸ª UI åº“ï¼Œåªå…³æ³¨è§†å›¾å±‚ã€‚å®ƒçš„è®¾è®¡æ˜¯â€œä¸€ä¸ªå‡½æ•°è¾“å…¥çŠ¶æ€ï¼Œè¿”å›ä¸€ä¸ª UIâ€ï¼Œå¼ºè°ƒå‡½æ•°å¼ç¼–ç¨‹æ€æƒ³ã€‚å¼€å‘è€…éœ€è¦ä½¿ç”¨å…¶ä»–åº“æ¥å®Œæˆè·¯ç”±ã€çŠ¶æ€ç®¡ç†ç­‰ä»»åŠ¡ã€‚<br><code>å•å‘æ•°æ®æµ</code>ï¼š<code>React</code> å¼ºè°ƒå•å‘æ•°æ®æµï¼ˆUnidirectional Data Flowï¼‰ï¼Œæ•°æ®åªèƒ½ä»çˆ¶ç»„ä»¶ä¼ é€’åˆ°å­ç»„ä»¶ã€‚çŠ¶æ€ç®¡ç†é€šå¸¸é€šè¿‡ <code>Redux</code> æˆ–å…¶ä»–åº“å®ç°ã€‚</p><ol start="2"><li><strong>æ¨¡æ¿è¯­æ³• vs JSX</strong><br><code>Vue.js</code><br><code>æ¨¡æ¿è¯­æ³•</code>ï¼šVue ä½¿ç”¨äº†æ¨¡æ¿å’ŒæŒ‡ä»¤ï¼ˆä¾‹å¦‚ v-ifã€v-forï¼‰æ¥å®šä¹‰ UIã€‚å®ƒçš„æ¨¡æ¿è¯­æ³•ç±»ä¼¼äºæ ‡å‡†çš„ HTMLï¼Œå¼€å‘è€…å¯ä»¥ä½¿ç”¨ç®€å•çš„ HTML ç»“æ„æ¥å£°æ˜ç»„ä»¶çš„è§†å›¾é€»è¾‘ã€‚<br><code>å•æ–‡ä»¶ç»„ä»¶ï¼ˆSFC</code>ï¼‰ï¼šVue æ”¯æŒåœ¨ .vue æ–‡ä»¶ä¸­å†™ç»„ä»¶ï¼Œæ–‡ä»¶åŒ…å« <code>&lt;template&gt;ã€&lt;script&gt;</code> å’Œ <code>&lt;style&gt;</code>ï¼Œä½¿å¾—ç»“æ„æ¸…æ™°ä¸”ä¾¿äºç®¡ç†ã€‚</li></ol><p><code>React.js</code><br><code>JSX</code>ï¼šReact ä½¿ç”¨ <code>JSXï¼ˆJavaScript XMLï¼‰</code>ï¼Œå®ƒå…è®¸åœ¨ <code>JavaScript</code> ä»£ç ä¸­ç›´æ¥ç¼–å†™ç±»ä¼¼ <code>HTML</code> çš„ç»“æ„ã€‚<code>JSX</code> æœ¬è´¨ä¸Šæ˜¯è¯­æ³•ç³–ï¼Œå¼€å‘è€…éœ€è¦æŒæ¡ <code>JavaScript</code> å’Œ <code>React</code> çš„æ¦‚å¿µæ¥æœ‰æ•ˆä½¿ç”¨ JSXã€‚<br>å…¨éƒ¨ JavaScriptï¼š<code>React çš„å¼€å‘é£æ ¼æ›´è´´è¿‘çº¯ JavaScript</code>ï¼Œæ‰€æœ‰çš„é€»è¾‘å’Œæ¨¡æ¿éƒ½æ··åˆåœ¨ JavaScript ä¸­ã€‚è¿™ç»™å¼€å‘è€…æä¾›äº†æå¤§çš„çµæ´»æ€§å’Œæ§åˆ¶åŠ›ã€‚</p><ol start="3"><li><strong>æ•°æ®æµå’ŒçŠ¶æ€ç®¡ç†</strong><br><code>Vue.js</code><br><code>åŒå‘æ•°æ®ç»‘å®š</code>ï¼š<code>Vue</code> ä½¿ç”¨åŒå‘æ•°æ®ç»‘å®šæœºåˆ¶ï¼Œå¯ä»¥è½»æ¾å¤„ç†è¡¨å•å…ƒç´ çš„çŠ¶æ€åŒæ­¥ï¼Œå°¤å…¶åœ¨å°å‹é¡¹ç›®ä¸­éå¸¸æ–¹ä¾¿ã€‚<br><code>Vuex/Pinia</code>çŠ¶æ€ç®¡ç†ï¼šå¯¹äºå¤§å‹é¡¹ç›®ï¼Œ<code>Vue</code> æä¾›äº† <code>Vuex</code>æˆ– <code>Pinia</code> ä½œä¸ºé›†ä¸­å¼çš„çŠ¶æ€ç®¡ç†å·¥å…·ï¼Œå¯ä»¥ä¸ Vue çš„å“åº”å¼ç³»ç»Ÿæ— ç¼é›†æˆã€‚</li></ol><p><code>React.js</code><br><code>å•å‘æ•°æ®æµ</code>ï¼šReact å¼ºè°ƒå•å‘æ•°æ®æµï¼Œç»„ä»¶ä¹‹é—´çš„æ•°æ®ä¼ é€’åªèƒ½ä»çˆ¶åˆ°å­ï¼ŒçŠ¶æ€çš„æ›´æ–°å¿…é¡»é€šè¿‡ä¼ é€’å‡½æ•°å®ç°ã€‚<br>å¤–éƒ¨çŠ¶æ€ç®¡ç†åº“ï¼ˆå¦‚ <code>Reduxã€Recoil</code> ç­‰ï¼‰ï¼šReact æ²¡æœ‰å†…ç½®çš„å…¨å±€çŠ¶æ€ç®¡ç†å·¥å…·ï¼Œé€šå¸¸ä¾èµ–ç¬¬ä¸‰æ–¹åº“æ¥ç®¡ç†å¤æ‚çš„çŠ¶æ€ï¼ˆå¦‚ Reduxã€Recoil æˆ– Context APIï¼‰ã€‚</p><ol start="4"><li><strong>è™šæ‹Ÿ DOM</strong><br><code>Vue.js</code><br>Vue ä¹Ÿä½¿ç”¨äº†è™šæ‹Ÿ DOM æ¥ä¼˜åŒ–æ€§èƒ½ã€‚ä½† Vue çš„æ¨¡æ¿è¯­æ³•æŠ½è±¡äº†åº•å±‚çš„è™šæ‹Ÿ <code>DOM</code> å®ç°ï¼Œå¼€å‘è€…æ— éœ€ç›´æ¥æ“ä½œè™šæ‹Ÿ DOMã€‚</li></ol><p><code>React.js</code><br><code>React æ˜¯è™šæ‹Ÿ DOM çš„å‘æ˜è€…</code>ï¼ŒJSX æœ€ç»ˆè¢«ç¼–è¯‘æˆè™šæ‹Ÿ <code>DOM</code> çš„ç»“æ„ã€‚React çš„å¼€å‘è€…å¯ä»¥ç›´æ¥æ“ä½œè™šæ‹Ÿ DOMï¼Œè™½ç„¶è¿™ä¸å¸¸è§ï¼Œä½†å®ƒçš„ä½¿ç”¨çµæ´»æ€§å¾ˆé«˜ã€‚</p><ol start="5"><li><strong>æ€§èƒ½å’Œä¼˜åŒ–</strong></li></ol><ul><li><code>Vue.js</code></li></ul><p><code>Vue</code> çš„å“åº”å¼ç³»ç»Ÿåœ¨ç²¾ç¡®è¿½è¸ªç»„ä»¶çš„ä¾èµ–å…³ç³»æ–¹é¢è¡¨ç°å‡ºè‰²ï¼Œåªä¼šé‡æ–°æ¸²æŸ“éœ€è¦æ›´æ–°çš„ç»„ä»¶ï¼Œå‡å°‘äº†ä¸å¿…è¦çš„æ€§èƒ½æ¶ˆè€—ã€‚<br>Vue å†…ç½®äº†æ›´å¤šä¼˜åŒ–æªæ–½ï¼Œå°¤å…¶åœ¨ <code>Vue 3</code> ä¸­ï¼Œå€ŸåŠ© <code>Proxy</code> å®ç°äº†æ›´ç²¾ç»†çš„å“åº”è¿½è¸ªï¼Œæå‡äº†æ€§èƒ½ã€‚</p><p><code>React.js</code><br>React çš„æ€§èƒ½ä¼˜åŒ–ä¸»è¦ä¾èµ–è™šæ‹Ÿ <code>DOM</code> å’Œ <code>shouldComponentUpdate</code> æˆ– <code>React.memo</code> ç­‰æ‰‹åŠ¨æ§åˆ¶æ›´æ–°çš„æœºåˆ¶ã€‚React é¼“åŠ±å¼€å‘è€…åœ¨å¿…è¦æ—¶è¿›è¡Œæ€§èƒ½ä¼˜åŒ–ï¼Œä½†éœ€è¦æ›´å¤šæ‰‹åŠ¨å¹²é¢„ã€‚<br>React åœ¨å¤§å‹åº”ç”¨ä¸­çš„æ€§èƒ½ä¼˜åŒ–ä¾èµ–å¼€å‘è€…å¯¹ç»„ä»¶çš„æ¸²æŸ“æµç¨‹æœ‰æ›´å¤šæ§åˆ¶æƒã€‚</p><ol start="6"><li><strong>å­¦ä¹ æ›²çº¿</strong><br><code>Vue.js</code><br>Vue çš„å­¦ä¹ æ›²çº¿è¾ƒå¹³æ»‘ï¼Œå¼€å‘è€…å¯ä»¥ä½¿ç”¨ç®€å•çš„æ¨¡æ¿è¯­æ³•å’ŒæŒ‡ä»¤å¼€å§‹æ„å»ºåº”ç”¨ã€‚å…¶æ¸…æ™°çš„æ–‡æ¡£å’Œä¸€è‡´çš„ API ä½¿å¾—æ–°æ‰‹å®¹æ˜“ä¸Šæ‰‹ã€‚<br>Vue çš„æ¸è¿›å¼ç‰¹æ€§å…è®¸å¼€å‘è€…åœ¨é¡¹ç›®ä¸­é€æ­¥å¼•å…¥æ›´å¤šå¤æ‚çš„åŠŸèƒ½ï¼Œè€Œä¸å¿…ä¸€å¼€å§‹å°±æŒæ¡æ•´ä¸ªæ¡†æ¶ã€‚</li></ol><p><code>React.js</code><br>React çš„å­¦ä¹ æ›²çº¿è¾ƒé™¡å³­ï¼Œå¼€å‘è€…éœ€è¦å­¦ä¹  JSXã€ç»„ä»¶ç”Ÿå‘½å‘¨æœŸã€å‡½æ•°å¼ç¼–ç¨‹ä»¥åŠçŠ¶æ€ç®¡ç†å·¥å…·ï¼ˆå¦‚ Reduxï¼‰æ‰èƒ½æ›´é«˜æ•ˆåœ°ä½¿ç”¨ Reactã€‚<br>è™½ç„¶ä¸€å¼€å§‹å¯èƒ½å¤æ‚ï¼Œä½† React æä¾›äº†æ›´é«˜çš„çµæ´»æ€§å’Œæ§åˆ¶åŠ›ï¼Œé€‚åˆæ„å»ºé«˜åº¦å®šåˆ¶åŒ–çš„åº”ç”¨ã€‚</p><ol start="7"><li><strong>ç”Ÿæ€ç³»ç»Ÿ</strong><br><code>Vue.js</code><br>Vue çš„ç”Ÿæ€ç³»ç»Ÿç›¸å¯¹é›†ä¸­ï¼Œå®˜æ–¹å·¥å…·å¦‚ Vue Routerã€Piniaï¼ˆæˆ– Vuexï¼‰ç­‰éƒ½æ˜¯ Vue æ ¸å¿ƒå›¢é˜Ÿç»´æŠ¤çš„ï¼Œé›†æˆéå¸¸ç´§å¯†ã€‚<br>Vue åœ¨äºšæ´²ï¼Œå°¤å…¶æ˜¯åœ¨ä¸­å›½æœ‰éå¸¸å¹¿æ³›çš„ä½¿ç”¨å’Œæ”¯æŒï¼Œç¤¾åŒºéå¸¸æ´»è·ƒã€‚</li></ol><p><code>React.js</code><br>React çš„ç”Ÿæ€ç³»ç»Ÿåºå¤§ä¸”åˆ†æ•£ã€‚React æœ¬èº«åªä¸“æ³¨äºè§†å›¾å±‚ï¼Œå¼€å‘è€…éœ€è¦ä¾èµ–ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚ Reduxã€React Router ç­‰ï¼‰æ¥æ„å»ºå®Œæ•´çš„åº”ç”¨ã€‚<br>React åœ¨å…¨çƒèŒƒå›´å†…ï¼Œå°¤å…¶æ˜¯è¥¿æ–¹å¸‚åœºæœ‰å¹¿æ³›çš„æ”¯æŒï¼Œç¤¾åŒºæ´»è·ƒåº¦å’Œæ‹›è˜éœ€æ±‚å¾ˆé«˜ã€‚</p><ol start="8"><li><strong>ä½¿ç”¨åœºæ™¯</strong><br><code>Vue.js</code><br>é€‚åˆå°åˆ°ä¸­å‹çš„é¡¹ç›®ï¼Œæˆ–è€…éœ€è¦å¿«é€Ÿå¼€å‘ã€äº¤ä»˜çš„é¡¹ç›®ã€‚Vue çš„æ¸è¿›å¼æ¶æ„ä¹Ÿé€‚åˆå¤§å‹é¡¹ç›®ï¼Œä½†åœ¨éå¸¸å¤æ‚çš„åº”ç”¨ä¸­å¯èƒ½ä¸å¦‚ React çµæ´»ã€‚</li></ol><p><code>React.js</code><br>é€‚åˆå¤§å‹å¤æ‚çš„é¡¹ç›®ï¼Œå°¤å…¶æ˜¯éœ€è¦é«˜åº¦å®šåˆ¶å’Œçµæ´»æ§åˆ¶çš„åœºæ™¯ã€‚React çš„çµæ´»æ€§è®©å®ƒæˆä¸ºæ„å»ºå¤æ‚åº”ç”¨çš„çƒ­é—¨é€‰æ‹©ã€‚</p><p><code>æ€»ç»“</code><br><code>Vue.js</code>ï¼šæ›´é€‚åˆåˆå­¦è€…ï¼Œå­¦ä¹ æˆæœ¬è¾ƒä½ï¼Œé€‚åˆå¿«é€Ÿå¼€å‘å’Œä¸­å°å‹é¡¹ç›®ã€‚å…¶ç»„ä»¶åŒ–å’ŒåŒå‘æ•°æ®ç»‘å®šè®©å¼€å‘å˜å¾—ç®€å•é«˜æ•ˆï¼Œå°¤å…¶é€‚åˆéœ€è¦å¿«é€Ÿä¸Šæ‰‹å¹¶äº¤ä»˜çš„é¡¹ç›®ã€‚</p><p><code>React.js</code>ï¼šé€‚åˆæœ‰ç»éªŒçš„å¼€å‘è€…ï¼Œå­¦ä¹ æ›²çº¿è¾ƒé™¡ï¼Œä½†æä¾›äº†æ›´å¤§çš„çµæ´»æ€§å’Œæ§åˆ¶æƒï¼Œé€‚åˆå¤§å‹ã€å¤æ‚çš„é¡¹ç›®ã€‚React çš„å¼ºå¤§ç”Ÿæ€ç³»ç»Ÿå’Œç»„ä»¶å¤ç”¨èƒ½åŠ›ä½¿å…¶åœ¨å¤§å‹ä¼ä¸šåº”ç”¨ä¸­å¹¿æ³›ä½¿ç”¨ã€‚</p><p>ä¸¤è€…éƒ½æ˜¯éå¸¸ä¼˜ç§€çš„å‰ç«¯æ¡†æ¶ï¼Œé€‰æ‹© Vue è¿˜æ˜¯ React ä¸»è¦å–å†³äºé¡¹ç›®éœ€æ±‚ã€å›¢é˜Ÿç»éªŒå’Œä¸ªäººå–œå¥½ã€‚</p><hr><h2 id="ä»€ä¹ˆæ˜¯è™šæ‹Ÿ-dom"><a href="#ä»€ä¹ˆæ˜¯è™šæ‹Ÿ-dom" class="headerlink" title="ä»€ä¹ˆæ˜¯è™šæ‹Ÿ dom"></a>ä»€ä¹ˆæ˜¯è™šæ‹Ÿ dom</h2><p><strong>è™šæ‹Ÿ DOM (Virtual DOM) æ˜¯ä¸€ç§åœ¨ç°ä»£å‰ç«¯æ¡†æ¶ï¼ˆå¦‚ Vueã€Reactï¼‰ä¸­å¹¿æ³›ä½¿ç”¨çš„æ¦‚å¿µï¼Œå®ƒæ˜¯å¯¹å®é™… DOM çš„ä¸€ç§æŠ½è±¡è¡¨ç¤ºï¼Œç›®çš„æ˜¯æé«˜ç½‘é¡µçš„æ¸²æŸ“æ€§èƒ½ã€‚</strong></p><ol><li><p><em>DOM ä¸æ€§èƒ½ç“¶é¢ˆ</em><br>åœ¨ä¼ ç»Ÿçš„ç½‘é¡µå¼€å‘ä¸­ï¼Œ<code>DOM</code>ï¼ˆæ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼‰æ˜¯ HTML é¡µé¢çš„ç»“æ„åŒ–è¡¨ç¤ºï¼Œå®ƒå…è®¸ <code>JavaScript</code> æ“ä½œ <code>HTML</code> å…ƒç´ ã€‚ç„¶è€Œï¼Œæ“ä½œ <code>DOM</code> æ˜¯æ˜‚è´µçš„ï¼Œå› ä¸ºæ¯æ¬¡æ›´æ–° DOM éƒ½ä¼šè§¦å‘æµè§ˆå™¨çš„<code>é‡æ’/å›æµï¼ˆreflowï¼‰</code>å’Œ<code>é‡ç»˜ï¼ˆrepaintï¼‰</code>ï¼Œå°¤å…¶æ˜¯å½“é¡µé¢å¤æ‚æˆ–æ›´æ–°é¢‘ç¹æ—¶ï¼Œæ€§èƒ½å¼€é”€éå¸¸å¤§ã€‚</p></li><li><p><em>è™šæ‹Ÿ DOM çš„å·¥ä½œåŸç†</em><br><code>è™šæ‹Ÿ DOM</code> æ˜¯å¯¹<code>çœŸå® DOM</code>çš„ä¸€ç§è½»é‡çº§çš„è¡¨ç¤ºï¼Œå®ƒæ˜¯ä¸€ä¸ª<code>JavaScript å¯¹è±¡</code>ï¼Œä¿ç•™äº† DOM çš„ç»“æ„å’Œå±æ€§ã€‚å‰ç«¯æ¡†æ¶ä½¿ç”¨è™šæ‹Ÿ <code>DOM</code> æ¥è¿½è¸ªç•Œé¢çš„çŠ¶æ€å˜åŒ–ï¼Œå¹¶é€šè¿‡ä»¥ä¸‹æ­¥éª¤é«˜æ•ˆæ›´æ–°çœŸå® <code>DOM</code>ï¼š</p></li></ol><ul><li><p>åˆ›å»ºè™šæ‹Ÿ DOMï¼šå½“ç»„ä»¶çŠ¶æ€æˆ–æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ¡†æ¶ä¼šé¦–å…ˆåœ¨å†…å­˜ä¸­åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿ DOM æ ‘ï¼Œè€Œä¸æ˜¯ç«‹å³æ›´æ–°çœŸå® DOMã€‚</p></li><li><p>æ¯”è¾ƒå·®å¼‚ï¼ˆDiffingï¼‰ï¼š<code>æ¡†æ¶é€šè¿‡ä¸€ç§é«˜æ•ˆçš„diff ç®—æ³•æ¯”è¾ƒæ–°æ—§è™šæ‹Ÿ DOM æ ‘</code>ï¼Œæ‰¾åˆ°å“ªäº›èŠ‚ç‚¹å‘ç”Ÿäº†å˜åŒ–ã€‚</p></li><li><p>æœ€å°åŒ–æ›´æ–°ï¼ˆPatchï¼‰ï¼šæ ¹æ® diff ç®—æ³•çš„ç»“æœï¼Œ<code>æ¡†æ¶åªæ›´æ–°é‚£äº›éœ€è¦å˜åŠ¨çš„çœŸå® DOM éƒ¨åˆ†</code>ï¼Œè€Œä¸æ˜¯æ•´ä¸ªé¡µé¢é‡æ–°æ¸²æŸ“ã€‚</p></li></ul><ol start="3"><li>ä¼˜åŠ¿</li></ol><ul><li>å‡å°‘ç›´æ¥ DOM æ“ä½œï¼š<code>é€šè¿‡ diff ç®—æ³•å‡å°‘ä¸å¿…è¦çš„ DOM æ›´æ–°</code>ï¼Œ<code>é¿å…é¢‘ç¹çš„ reflow å’Œ repaint</code>ã€‚</li><li>æå‡æ€§èƒ½ï¼šç”±äºå¤§å¤šæ•°å˜åŒ–éƒ½å¯ä»¥åœ¨å†…å­˜ä¸­å¤„ç†ï¼Œ<code>åªæœ‰å½“å¿…è¦æ—¶æ‰æ“ä½œçœŸå® DOMï¼Œæ•´ä½“æ€§èƒ½æ˜¾è‘—æå‡</code>ã€‚</li><li>æ›´æµç•…çš„ç”¨æˆ·ä½“éªŒï¼šå‡å°‘ä¸å¿…è¦çš„ DOM æ“ä½œèƒ½å¸¦æ¥æ›´æµç•…çš„ç”¨æˆ·äº¤äº’ä½“</li></ul><hr><h2 id="åˆ é™¤æ•°ç»„ç”¨-delete-å’Œ-Vue-delete-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#åˆ é™¤æ•°ç»„ç”¨-delete-å’Œ-Vue-delete-æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="åˆ é™¤æ•°ç»„ç”¨ delete å’Œ Vue.delete æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>åˆ é™¤æ•°ç»„ç”¨ delete å’Œ Vue.delete æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h2><p><strong>å“åº”å¼æ”¯æŒï¼š</strong><br><code>delete</code>ï¼šä¸ä¼šè§¦å‘ Vue å“åº”å¼ç³»ç»Ÿï¼Œ<code>å› æ­¤ä¸ä¼šè‡ªåŠ¨æ›´æ–°è§†å›¾</code>ã€‚<br><code>Vue.delete</code>ï¼šä¼šè§¦å‘ Vue å“åº”å¼ç³»ç»Ÿï¼Œ<code>è§†å›¾è‡ªåŠ¨æ›´æ–°</code>ã€‚</p><p><strong>æ•°ç»„å¤„ç†ï¼š</strong><br><code>delete</code>ï¼šåˆ é™¤åæ•°ç»„é•¿åº¦ä¸å˜ï¼Œ<code>ç•™ä¸‹ "empty slot"</code>ã€‚<br><code>Vue.delete</code>ï¼šåˆ é™¤åæ•°ç»„é•¿åº¦å˜åŒ–ï¼Œ<code>ç§»é™¤å…ƒç´ å¹¶è°ƒæ•´æ•°ç»„</code>ã€‚</p><pre class="line-numbers language-javaScript"><code class="language-javaScript">let arr = [1, 2, 3];delete arr[1]; // åˆ é™¤æ•°ç»„ä¸­çš„ç¬¬äºŒä¸ªå…ƒç´ console.log(arr); // è¾“å‡º: [1, empty, 3]// Vue.deletelet vm = new Vue({  data: {    arr: [1, 2, 3]  }});Vue.delete(vm.arr, 1); // åˆ é™¤æ•°ç»„ä¸­çš„ç¬¬äºŒä¸ªå…ƒç´ console.log(vm.arr); // è¾“å‡º: [1, 3]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="watch-å’Œ-computed-çš„åŒºåˆ«ï¼Ÿ"><a href="#watch-å’Œ-computed-çš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="watch å’Œ computed çš„åŒºåˆ«ï¼Ÿ"></a>watch å’Œ computed çš„åŒºåˆ«ï¼Ÿ</h2><ol><li><p><strong>computedï¼ˆè®¡ç®—å±æ€§ï¼‰</strong><br><code>computed</code> æ˜¯åŸºäºä¾èµ–çš„ ç¼“å­˜ è®¡ç®—å±æ€§ï¼Œé€šå¸¸ç”¨äº<code>ä¾èµ–å…¶ä»–æ•°æ®</code>çš„å€¼è®¡ç®—ã€‚å®ƒä»¬åœ¨ä¾èµ–çš„æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶æ‰ä¼šé‡æ–°è®¡ç®—ï¼Œ<code>å¹¶ä¸”ç»“æœä¼šè¢«ç¼“å­˜</code>ï¼Œç›´åˆ°ä¾èµ–çš„æ•°æ®å†æ¬¡å‘ç”Ÿå˜åŒ–ã€‚</p></li><li><p><strong>watchï¼ˆä¾¦å¬å™¨ï¼‰</strong><br><code>watch</code> ç”¨äº è§‚å¯Ÿ ä¸€ä¸ªå“åº”å¼æ•°æ®çš„å˜åŒ–ï¼Œå¹¶åœ¨æ•°æ®å˜åŒ–æ—¶æ‰§è¡Œç‰¹å®šçš„å›è°ƒå‡½æ•°ã€‚å®ƒå¯ä»¥<code>æ‰§è¡Œå¼‚æ­¥æ“ä½œå’Œå¤æ‚çš„é€»è¾‘</code>ï¼Œç‰¹åˆ«é€‚åˆéœ€è¦åœ¨<code>æ•°æ®å˜åŒ–æ—¶è¿›è¡Œ å‰¯ä½œç”¨æ“ä½œ</code> çš„åœºæ™¯ï¼Œæ¯”å¦‚è¯·æ±‚ APIã€æ‰‹åŠ¨æ‰§è¡ŒæŸäº›é€»è¾‘ç­‰ã€‚</p></li></ol><hr><h2 id="v-for-æ²¡æœ‰-key-å›å‘ç”Ÿä»€ä¹ˆï¼Ÿ"><a href="#v-for-æ²¡æœ‰-key-å›å‘ç”Ÿä»€ä¹ˆï¼Ÿ" class="headerlink" title="v-for æ²¡æœ‰ key å›å‘ç”Ÿä»€ä¹ˆï¼Ÿ"></a>v-for æ²¡æœ‰ key å›å‘ç”Ÿä»€ä¹ˆï¼Ÿ</h2><ul><li>æ²¡æœ‰ key å¯èƒ½ä¼šå¯¼è‡´ <code>æ•°æ®æ¸²æŸ“é”™è¯¯</code> å’Œ <code>ç»„ä»¶çŠ¶æ€æ··ä¹±</code>ï¼Œå°¤å…¶æ˜¯åœ¨åˆ—è¡¨æ•°æ®å‘ç”Ÿå˜åŠ¨æ—¶ã€‚</li><li>ç¼ºå°‘ key è¿˜ä¼šå¯¼è‡´ Vue çš„ <code>diff ç®—æ³•æ€§èƒ½ä¸‹é™</code>ï¼Œå› ä¸º <code>Vue æ— æ³•æœ‰æ•ˆåœ°è¿½è¸ªå’Œå¤ç”¨ DOM å…ƒç´ </code>ã€‚</li><li>åº”è¯¥å§‹ç»ˆä¸º v-for åˆ—è¡¨ä¸­çš„æ¯ä¸ªé¡¹æä¾›ä¸€ä¸ªå”¯ä¸€çš„ key å±æ€§ï¼Œç¡®ä¿ Vue èƒ½å¤Ÿæ­£ç¡®åœ°ç®¡ç† DOM æ›´æ–°ã€‚</li></ul><hr><h2 id="vue-çš„åŒå‘ç»‘å®šåŸç†"><a href="#vue-çš„åŒå‘ç»‘å®šåŸç†" class="headerlink" title="vue çš„åŒå‘ç»‘å®šåŸç†"></a>vue çš„åŒå‘ç»‘å®šåŸç†</h2><p>Vue çš„åŒå‘ç»‘å®šæ˜¯é€šè¿‡ä»¥ä¸‹å‡ éƒ¨åˆ†ç»„æˆçš„ï¼š</p><ol><li><strong>æ•°æ®åŠ«æŒï¼ˆData Observerï¼‰ï¼š</strong><br>Vue åˆ©ç”¨ <code>Object.defineProperty() (Vue 2)</code> æˆ– <code>Proxy (Vue 3)</code> åŠ«æŒå¯¹è±¡çš„å±æ€§ï¼Œç›‘å¬å¯¹å±æ€§çš„è¯»å†™æ“ä½œã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒVue èƒ½å¤Ÿåœ¨æ•°æ®è¢«è®¿é—®æˆ–ä¿®æ”¹æ—¶è§¦å‘ç›¸å…³çš„é€»è¾‘ã€‚</li></ol><pre class="line-numbers language-javaScript"><code class="language-javaScript">// Vue 2.x å“åº”å¼æ•°æ®åŠ«æŒObject.defineProperty(obj, 'message', {  get() {    // ä¾èµ–æ”¶é›†    return value;  },  set(newValue) {    // é€šçŸ¥æ›´æ–°    value = newValue;  }});// Vue 3.x å“åº”å¼æ•°æ®åŠ«æŒconst observed = new Proxy(obj, {  get(target, key) {    // ä¾èµ–æ”¶é›†    return Reflect.get(target, key);  },  set(target, key, value) {    // é€šçŸ¥æ›´æ–°    return Reflect.set(target, key, value);  }});<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="2"><li><p><strong>å‘å¸ƒ-è®¢é˜…æ¨¡å¼ï¼š</strong><br>Vue å†…éƒ¨å®ç°äº†ä¸€ä¸ª <code>å‘å¸ƒ-è®¢é˜…æ¨¡å¼</code>ï¼Œæ¯ä¸ªæ•°æ®éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„ <code>ä¾èµ–æ”¶é›†å™¨ï¼ˆDep</code>ï¼‰ã€‚å½“æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒDep ä¼šé€šçŸ¥æ‰€æœ‰ä¾èµ–äºå®ƒçš„<code>è®¢é˜…è€…ï¼ˆé€šå¸¸æ˜¯æ¸²æŸ“å‡½æ•°æˆ–ç»„ä»¶ï¼‰</code>ï¼Œè§¦å‘è§†å›¾æ›´æ–°ã€‚</p></li><li><p><strong>æ¨¡æ¿ç¼–è¯‘ï¼š</strong><br>Vue ä¼šåœ¨ç¼–è¯‘æ¨¡æ¿æ—¶ç”Ÿæˆæ¸²æŸ“å‡½æ•°ï¼Œè¿™ä¸ªæ¸²æŸ“å‡½æ•°ä¼šè¢«ç»‘å®šåˆ°ç›¸åº”çš„æ•°æ®ä¸Šã€‚å½“æ•°æ®å˜åŒ–æ—¶ï¼Œæ¸²æŸ“å‡½æ•°é‡æ–°æ‰§è¡Œï¼Œä»è€Œæ›´æ–°è§†å›¾ã€‚</p></li><li><p><strong>Watcher ç›‘å¬å™¨ï¼š</strong><br><code>Watcher</code> æ˜¯ Vue ä¸­è´Ÿè´£ä¾¦å¬æ•°æ®å˜åŒ–çš„éƒ¨åˆ†ã€‚æ¯ä¸€ä¸ªç»„ä»¶å®ä¾‹éƒ½ä¼šåˆ›å»ºä¸ä¹‹ç›¸å…³çš„ Watcher å®ä¾‹ï¼Œå®ƒä¼šè§‚å¯ŸæŸä¸ªæ•°æ®æˆ–è¡¨è¾¾å¼ï¼Œä¸€æ—¦æ•°æ®å‘ç”Ÿå˜åŒ–ï¼Œ<code>Watcher</code> ä¼šæ”¶åˆ°é€šçŸ¥å¹¶è§¦å‘è§†å›¾æ›´æ–°æˆ–ç”¨æˆ·å®šä¹‰çš„å›è°ƒå‡½æ•°ã€‚</p></li></ol><hr><h2 id="Vue3-0-é‡Œä¸ºä»€ä¹ˆè¦ç”¨-Proxy-ä»£æ›¿-defineProperty"><a href="#Vue3-0-é‡Œä¸ºä»€ä¹ˆè¦ç”¨-Proxy-ä»£æ›¿-defineProperty" class="headerlink" title="Vue3.0 é‡Œä¸ºä»€ä¹ˆè¦ç”¨ Proxy ä»£æ›¿ defineProperty?"></a>Vue3.0 é‡Œä¸ºä»€ä¹ˆè¦ç”¨ Proxy ä»£æ›¿ defineProperty?</h2><ol><li><strong>ç›‘å¬æ•°ç»„å’Œå¯¹è±¡æ–°å¢ã€åˆ é™¤å±æ€§çš„èƒ½åŠ›</strong><br>åœ¨ <code>Vue 2.x</code> ä¸­ï¼Œ<code>Object.defineProperty()</code> åªèƒ½åŠ«æŒå·²ç»å­˜åœ¨çš„å±æ€§ï¼Œæ— æ³•ç›‘å¬å¯¹è±¡æ–°å¢æˆ–åˆ é™¤çš„å±æ€§ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒVue 2.x éœ€è¦ä½¿ç”¨ <code>Vue.set</code>å’Œ <code>Vue.delete</code> æ¥æ‰‹åŠ¨æ·»åŠ æˆ–åˆ é™¤å“åº”å¼å±æ€§ã€‚è¿™åœ¨å¼€å‘ä¸­æ—¢ç¹çåˆå®¹æ˜“å‡ºé”™ã€‚</li></ol><p>è€Œ <code>Proxy</code> å¯ä»¥ç›´æ¥æ‹¦æˆª<code>å¯¹è±¡çš„ä»»æ„æ“ä½œ</code>ï¼Œ<code>åŒ…æ‹¬æ–°å¢å’Œåˆ é™¤å±æ€§</code>ã€‚å› æ­¤åœ¨ Vue 3 ä¸­ï¼Œä»£ç†å¯¹è±¡ä¸å†éœ€è¦ç‰¹æ®Šçš„ <code>Vue.set</code> æˆ– <code>Vue.delete</code> æ–¹æ³•æ¥å¤„ç†æ–°å¢æˆ–åˆ é™¤å±æ€§ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// Vue 3 ä¸­ä½¿ç”¨ Proxy å¯ä»¥ç›‘å¬å±æ€§æ–°å¢ã€åˆ é™¤</span><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>  <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">{</span>    <span class="token keyword">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token comment" spellcheck="true">// å¤„ç†å±æ€§è®¿é—®</span>      <span class="token keyword">return</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token keyword">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token comment" spellcheck="true">// å¤„ç†å±æ€§è®¾ç½®</span>      target<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>      <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token function">deleteProperty</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token comment" spellcheck="true">// å¤„ç†å±æ€§åˆ é™¤</span>      <span class="token keyword">delete</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>      <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="2"><li><p><strong>æ€§èƒ½ä¼˜åŠ¿</strong><br>ç”±äº <code>Proxy</code> ä¸éœ€è¦é€’å½’éå†å¯¹è±¡çš„æ¯ä¸€ä¸ªå±æ€§ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ä¸€æ¬¡ä»£ç†å®Œæˆå¯¹æ•´ä¸ªå¯¹è±¡çš„åŠ«æŒï¼Œå› æ­¤åœ¨å¤„ç†å¤§å‹å¯¹è±¡æ—¶æ€§èƒ½æœ‰æ˜æ˜¾æå‡ã€‚æ­¤å¤–ï¼Œ<code>Proxy</code> æä¾›äº†æ›´é«˜æ•ˆçš„æ–¹å¼æ¥å¤„ç†å¯¹è±¡çš„<code>æ–°å¢ã€åˆ é™¤ã€æ•°ç»„</code>æ“ä½œç­‰ï¼Œä½¿å¾—å“åº”å¼ç³»ç»Ÿçš„æ€§èƒ½æ›´åŠ ç¨³å®šå’Œé«˜æ•ˆã€‚</p></li><li><p><strong>ä»£ç†æ›´å¤šçš„æ“ä½œ</strong><br><code>Object.defineProperty()</code> åªèƒ½æ‹¦æˆªå±æ€§çš„ <code>get</code> å’Œ <code>set</code> æ“ä½œï¼Œè€Œ <code>Proxy</code> å¯ä»¥æ‹¦æˆªæ›´å¤šç§ç±»çš„æ“ä½œï¼Œå¦‚ï¼š<br><code>has</code>ï¼šæ£€æµ‹å±æ€§æ˜¯å¦å­˜åœ¨ï¼Œå¦‚ in æ“ä½œç¬¦ã€‚<br><code>deleteProperty</code>ï¼šæ‹¦æˆªå±æ€§åˆ é™¤æ“ä½œã€‚<br><code>ownKeys</code>ï¼šæ‹¦æˆªå¯¹è±¡çš„å±æ€§æšä¸¾æ“ä½œï¼Œå¦‚ <code>Object.keys()</code>ã€‚<br><code>defineProperty</code>ï¼šæ‹¦æˆª <code>Object.defineProperty()</code> è°ƒç”¨ã€‚<br><code>getOwnPropertyDescriptor</code>ï¼šæ‹¦æˆª <code>Object.getOwnPropertyDescriptor()</code>ã€‚<br>é€šè¿‡ Proxyï¼ŒVue 3 å¯ä»¥æ›´çµæ´»ã€å…¨é¢åœ°ç›‘æ§å’Œæ§åˆ¶å¯¹è±¡çš„æ“ä½œï¼Œä»è€Œæ„å»ºå‡ºæ›´å¼ºå¤§å’Œé«˜æ•ˆçš„å“åº”å¼ç³»ç»Ÿã€‚</p></li></ol><hr><h2 id="Vue3-0-ç¼–è¯‘åšäº†å“ªäº›ä¼˜åŒ–"><a href="#Vue3-0-ç¼–è¯‘åšäº†å“ªäº›ä¼˜åŒ–" class="headerlink" title="Vue3.0 ç¼–è¯‘åšäº†å“ªäº›ä¼˜åŒ–"></a>Vue3.0 ç¼–è¯‘åšäº†å“ªäº›ä¼˜åŒ–</h2><ol><li><p><strong>ç¼–è¯‘å™¨é‡å†™</strong><br><code>Vue 3.0</code>çš„ç¼–è¯‘å™¨ç»è¿‡äº†å®Œå…¨é‡å†™ï¼Œé‡‡ç”¨äº†<code>æ¨¡å—åŒ–çš„è®¾è®¡</code>ï¼Œå…è®¸ç¼–è¯‘å™¨çš„ä¸åŒéƒ¨åˆ†èƒ½å¤Ÿå•ç‹¬ä½¿ç”¨æˆ–æ‰©å±•ã€‚æ–°çš„ç¼–è¯‘å™¨ç”Ÿæˆçš„ä»£ç æ›´åŠ é«˜æ•ˆï¼Œå ç”¨æ›´å°‘çš„ç©ºé—´ï¼Œä»è€Œæé«˜äº†<code>æ¸²æŸ“æ€§èƒ½</code>ã€‚é‡å†™åçš„ç¼–è¯‘å™¨å…·å¤‡äº†æ›´å¥½çš„<code>å¯æ‰©å±•æ€§å’Œç»´æŠ¤æ€§</code>ï¼Œ<code>æ”¯æŒæ›´å¤æ‚çš„æ¨¡æ¿è¯­æ³•</code>å’Œæ›´å¼ºå¤§çš„ä¼˜åŒ–èƒ½åŠ›ã€‚</p></li><li><p><strong>é™æ€æå‡</strong><br>Vue 3.0 ç¼–è¯‘å™¨ä¼šå¯¹æ¨¡æ¿ä¸­çš„é™æ€å†…å®¹è¿›è¡Œ<code>â€œé™æ€æå‡â€</code>ï¼Œå³å°†é‚£äº›ä¸ä¼šæ”¹å˜çš„é™æ€èŠ‚ç‚¹æå‡åˆ°æ¸²æŸ“å‡½æ•°çš„å¤–éƒ¨ã€‚è¿™æ„å‘³ç€è¿™äº›é™æ€èŠ‚ç‚¹åªä¼šè¢«åˆ›å»ºä¸€æ¬¡ï¼Œè€Œä¸ä¼šåœ¨æ¯æ¬¡æ¸²æŸ“æ—¶é‡æ–°åˆ›å»ºï¼Œä»è€Œå‡å°‘äº†<code>è™šæ‹Ÿ DOM çš„åˆ›å»ºå’Œæ¸²æŸ“å¼€é”€</code>ã€‚</p></li></ol><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// Vue 2.x æ¸²æŸ“å‡½æ•°</span><span class="token keyword">return</span> <span class="token punctuation">{</span>  tag<span class="token punctuation">:</span> <span class="token string">"div"</span><span class="token punctuation">,</span>  children<span class="token punctuation">:</span> <span class="token punctuation">[</span>    <span class="token punctuation">{</span> tag<span class="token punctuation">:</span> <span class="token string">"span"</span><span class="token punctuation">,</span> children<span class="token punctuation">:</span> <span class="token string">"Hello World"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// æ¯æ¬¡æ¸²æŸ“éƒ½ä¼šé‡æ–°åˆ›å»º</span>  <span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// Vue 3.0 æ¸²æŸ“å‡½æ•°</span><span class="token keyword">const</span> staticNode <span class="token operator">=</span> <span class="token punctuation">{</span> tag<span class="token punctuation">:</span> <span class="token string">"span"</span><span class="token punctuation">,</span> children<span class="token punctuation">:</span> <span class="token string">"Hello World"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// é™æ€æå‡</span><span class="token keyword">return</span> <span class="token punctuation">{</span>  tag<span class="token punctuation">:</span> <span class="token string">"div"</span><span class="token punctuation">,</span>  children<span class="token punctuation">:</span> <span class="token punctuation">[</span>staticNode<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// æ¯æ¬¡æ¸²æŸ“åªå¤ç”¨ staticNode</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol start="3"><li><strong>é™æ€èŠ‚ç‚¹æ ‡è®°</strong><br><code>Vue 3.0</code>ä¸­ï¼Œç¼–è¯‘å™¨ä¼šä¸ºæ¨¡æ¿ä¸­çš„é™æ€èŠ‚ç‚¹æ‰“ä¸Šæ ‡è®°ï¼Œå‘Šè¯‰<code>è™šæ‹Ÿ DOM</code>æ¸²æŸ“å¼•æ“å“ªäº›èŠ‚ç‚¹æ˜¯é™æ€çš„ï¼Œå“ªäº›æ˜¯åŠ¨æ€çš„ã€‚é€šè¿‡è¿™ç§æ ‡è®°ï¼ŒVue å¯ä»¥åœ¨æ›´æ–°æ—¶<code>è·³è¿‡é™æ€èŠ‚ç‚¹</code>ï¼Œä»è€Œå‡å°‘ä¸å¿…è¦çš„æ›´æ–°æ“ä½œã€‚å¯¹äºå¤§å¤šæ•°ä¸å˜çš„ <code>DOM ç»“æ„</code>ï¼Œè¿™å¤§å¤§æå‡äº†æ¸²æŸ“æ•ˆç‡ã€‚</li></ol><ul><li><code>Patch Flags</code>ï¼šç²¾å‡†çš„ DOM æ›´æ–°ï¼Œæé«˜è¿è¡Œæ—¶æ•ˆç‡ã€‚</li><li>å“åº”å¼ç³»ç»Ÿä¼˜åŒ–ï¼šåŸºäº <code>Proxy</code>ï¼Œæ€§èƒ½æ›´ä¼˜ï¼Œç²¾ç¡®æ€§æ›´é«˜ã€‚</li><li>å¤šæ ¹èŠ‚ç‚¹ï¼ˆFragmentï¼‰æ”¯æŒï¼šå‡å°‘ DOM å±‚çº§å¤æ‚åº¦ã€‚</li><li>Slot æ¸²æŸ“ä¼˜åŒ–ï¼š<code>é™æ€ Slot ç¼“å­˜</code>ï¼ŒåŠ¨æ€ Slot ç²¾å‡†å¤„ç†ã€‚</li><li>äº‹ä»¶å¤„ç†ä¼˜åŒ–ï¼š ç¼“å­˜é™æ€äº‹ä»¶ï¼Œå‡å°‘é‡å¤ç»‘å®šã€‚</li><li>æ›´å¥½çš„ TypeScript æ”¯æŒï¼šå¼€å‘ä½“éªŒå’Œä»£ç è´¨é‡æå‡ã€‚</li><li>ç¼–è¯‘ç¼“å­˜ï¼šé¿å…é‡å¤ç¼–è¯‘å¸¦æ¥çš„æ€§èƒ½å¼€é”€ã€‚</li></ul><hr><h2 id="Vue3-æ–°ç‰¹æ€§â€“Composition-API-ä¸-React-Hooks-çš„å¼‚åŒç‚¹"><a href="#Vue3-æ–°ç‰¹æ€§â€“Composition-API-ä¸-React-Hooks-çš„å¼‚åŒç‚¹" class="headerlink" title="Vue3 æ–°ç‰¹æ€§â€“Composition API ä¸ React Hooks çš„å¼‚åŒç‚¹"></a>Vue3 æ–°ç‰¹æ€§â€“Composition API ä¸ React Hooks çš„å¼‚åŒç‚¹</h2><p>Vue 3 çš„ Composition API å’Œ React çš„ Hooks éƒ½æ˜¯ä¸ºäº†æé«˜ç»„ä»¶é€»è¾‘å¤ç”¨æ€§ã€ä»£ç ç»„ç»‡æ€§ä»¥åŠçµæ´»æ€§è€Œå¼•å…¥çš„ç‰¹æ€§ï¼Œå®ƒä»¬çš„æ ¸å¿ƒæ€æƒ³ç±»ä¼¼ï¼Œä½†åœ¨å®ç°æ–¹å¼ã€ä½¿ç”¨åœºæ™¯å’Œå…·ä½“è®¾è®¡ä¸Šä¹Ÿæœ‰ä¸€äº›ä¸åŒã€‚</p><p><strong>å…±åŒç‚¹</strong></p><ol><li><p><code>é€»è¾‘å¤ç”¨ä¸æŠ½ç¦»</code>ï¼š<br>Vue 3 çš„ <code>Composition API</code> å’Œ <code>React Hooks</code> éƒ½èƒ½å°†ç»„ä»¶ä¸­çš„é€»è¾‘æŠ½ç¦»å‡ºæ¥ï¼Œæ–¹ä¾¿å¤ç”¨ã€‚é€šè¿‡è¿™ä¸¤è€…ï¼Œå¼€å‘è€…å¯ä»¥æ›´å¥½åœ°ç»„ç»‡å’Œå¤ç”¨å¤æ‚çš„çŠ¶æ€é€»è¾‘ï¼Œè€Œ<code>ä¸æ˜¯åƒä¼ ç»Ÿæ–¹å¼ä¸€æ ·å°†ä»£ç å †ç§¯åœ¨ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸­</code>ã€‚<br>ä¸¤è€…éƒ½å¯ä»¥ç”¨äºæŠ½è±¡ç»„ä»¶çš„é€»è¾‘ï¼Œå°†<code>çŠ¶æ€ç®¡ç†ã€äº‹ä»¶å¤„ç†ã€æ•°æ®è·å–</code>ç­‰åŠŸèƒ½æ‹†åˆ†æˆæ›´å°çš„æ¨¡å—ã€‚</p></li><li><p><code>åŸºäºå‡½æ•°çš„ APIï¼š</code><br><code>Composition API</code> å’Œ <code>Hooks</code> éƒ½æ˜¯åŸºäºå‡½æ•°çš„ APIï¼Œé€šè¿‡è°ƒç”¨å‡½æ•°æ¥è·å–å“åº”å¼çŠ¶æ€ã€æ–¹æ³•æˆ–è€…ç”Ÿå‘½å‘¨æœŸé€»è¾‘ã€‚<br>ä¸¤è€…çš„ API éƒ½æå€¡ç”¨å‡½æ•°çš„æ–¹å¼æ¥å¤„ç†çŠ¶æ€å’Œå‰¯ä½œç”¨ï¼Œè€Œä¸æ˜¯åƒä¼ ç»Ÿ <code>Vue</code>çš„ <code>dataã€methodsã€computed</code> ç­‰é€‰é¡¹å¼ API æˆ–è€…<code>React ç±»ç»„ä»¶çš„ state å’Œ setState</code>ã€‚</p></li><li><p><code>è½»æ¾ç»„åˆé€»è¾‘ï¼š</code><br><code>Composition API å’Œ Hooks</code> éƒ½æ”¯æŒå°†ä¸åŒåŠŸèƒ½çš„é€»è¾‘ç»„åˆåœ¨ä¸€èµ·ï¼Œæ–¹ä¾¿å¤„ç†å¤æ‚çš„ç»„ä»¶é€»è¾‘ã€‚ä½ å¯ä»¥å°†å¤šä¸ªåŠŸèƒ½æ¨¡å—åŒ–åï¼Œå†åœ¨ä¸€ä¸ªç»„ä»¶ä¸­ç»„åˆå®ƒä»¬ï¼Œç»„ä»¶çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ä¹Ÿéšä¹‹æå‡ã€‚</p></li></ol><p><strong>ä¸åŒç‚¹ï¼š</strong></p><ol><li>Vue 3 çš„ <code>Composition API æ‹¥æœ‰ Vue å†…ç½®çš„å“åº”å¼ç³»ç»Ÿ</code>ï¼ŒçŠ¶æ€å˜æ›´ä¼šè‡ªåŠ¨è§¦å‘æ›´æ–°ï¼›è€Œ React Hooks åˆ™ä¾èµ–ç»„ä»¶é‡æ–°æ¸²æŸ“æ¥æ›´æ–°çŠ¶æ€ã€‚</li><li>Vue çš„ Composition API æä¾›äº†æ›´å¤šå†…ç½®åŠŸèƒ½ï¼Œå¦‚ <code>watchã€computedã€å“åº”å¼ç³»ç»Ÿ</code>ç­‰ï¼›React Hooks åˆ™<code>æ›´åŠ è½»é‡ï¼Œéœ€è¦å¼€å‘è€…</code>ç”¨å…¶ä»–åº“æˆ–å·¥å…·æ¥å®ç°ç±»ä¼¼çš„åŠŸèƒ½ã€‚</li></ol><hr><blockquote><p><strong>æœ€åï¼Œå¦‚æœé¡¹ç›®å’Œæ•™ç¨‹å¯¹ä½ æœ‰æ‰€å¸®åŠ©æˆ–è€…ä½ çœ‹è§äº†è¿˜ç®—æ¯”è¾ƒå–œæ¬¢ï¼Œæ¬¢è¿ç»™æˆ‘<code>star</code>ï¼Œè°¢è°¢æ‚¨ï¼</strong></p></blockquote><p><strong>æŒç»­æ›´æ–°ä¸­â€¦ï¼Œå¦‚æœé‡åˆ°é—®é¢˜æ¬¢è¿è”ç³»æˆ‘ï¼Œåœ¨æ–‡ç« æœ€åè¯„è®ºåŒºã€ç•™è¨€å’Œè®¨è®ºã€‘ï¼Œå½“ç„¶ï¼Œæ¬¢è¿ç‚¹å‡»æ–‡ç« æœ€åçš„æ‰“èµæŒ‰é”®ï¼Œè¯·åšä¸»ä¸€æ¯å†°é˜”ä¹ï¼Œç¬‘ï½</strong><br><escape></escape></p><!-- <table>  <tr>    <td><img width="100" src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://sunhwee.com/medias/reward/alipay.bmp" ></td>    <td><img width="100" src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://sunhwee.com/medias/reward/wechat.bmp" ></td>    <td><img width="100" src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://sunhwee.com/medias/reward/zan.png" ></td>  </tr></table> --><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> vue </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Github </tag>
            
            <tag> åšå®¢ </tag>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AIæ•°å­—</title>
      <link href="/2020/08/30/digitalhuman/"/>
      <url>/2020/08/30/digitalhuman/</url>
      
        <content type="html"><![CDATA[<h1 id="ç®€çŸ­ä»‹ç»"><a href="#ç®€çŸ­ä»‹ç»" class="headerlink" title="ç®€çŸ­ä»‹ç»"></a>ç®€çŸ­ä»‹ç»</h1><p><code>AIæ•°å­—äºº</code><br>é­”çç§‘æŠ€æ˜¯ä¸€å®¶ä»¥ 3D æ•°å­—äººå’Œç”Ÿæˆå¼äººå·¥æ™ºèƒ½ ä¸ºæ ¸å¿ƒæŠ€æœ¯çš„ AI ç§‘æŠ€å…¬å¸ã€‚é­”çç§‘æŠ€å¸Œæœ›æŠŠå¤šå¹´æ²‰æ·€çš„ 3D æ•°å­—äººæŠ€æœ¯ä»¥åŠç”Ÿæˆå¼äººå·¥æ™ºèƒ½æŠ€æœ¯å€ŸåŠ©é­”çæ˜Ÿäº‘å…·èº« 3d æ•°å­—äººæ™ºèƒ½å¹³å°å¯¹å¤–æä¾›ï¼Œå¸®åŠ©å¼€å‘è€…æ„å»ºæ•°å­—äººåº”ç”¨ï¼Œä»¥æ­¤æ¨åŠ¨ AI æ—¶ä»£ä¸‹æœ€ä½³ä½“éªŒæ–°èŒƒå¼çš„å‘ç”Ÿã€‚</p><hr><h1 id="æ˜Ÿäº‘å…·èº«æ™ºèƒ½ä½“å¼€æ”¾å¹³å°èƒ½åŠ›ä»‹ç»"><a href="#æ˜Ÿäº‘å…·èº«æ™ºèƒ½ä½“å¼€æ”¾å¹³å°èƒ½åŠ›ä»‹ç»" class="headerlink" title="æ˜Ÿäº‘å…·èº«æ™ºèƒ½ä½“å¼€æ”¾å¹³å°èƒ½åŠ›ä»‹ç»"></a>æ˜Ÿäº‘å…·èº«æ™ºèƒ½ä½“å¼€æ”¾å¹³å°èƒ½åŠ›ä»‹ç»</h1><p>æ˜Ÿäº‘å…·èº«æ™ºèƒ½ä½“å¼€æ”¾å¹³å°å°†ä¼šæŠŠæ•°å­—äººç›¸å…³çš„èƒ½åŠ›æä¾›å‡ºæ¥ï¼ŒåŒ…å«ï¼š</p><h2 id="1-3D-æ•°å­—äººç”Ÿæˆä¸ç¼–è¾‘"><a href="#1-3D-æ•°å­—äººç”Ÿæˆä¸ç¼–è¾‘" class="headerlink" title="1. 3D æ•°å­—äººç”Ÿæˆä¸ç¼–è¾‘"></a>1. 3D æ•°å­—äººç”Ÿæˆä¸ç¼–è¾‘</h2><ul><li><strong>è¶…å†™å® &amp; å¤šé£æ ¼</strong>ï¼šæ”¯æŒè¶…å†™å®ã€å¡é€šã€äºŒæ¬¡å…ƒã€äººå½¢æœºå™¨äººç­‰å¤šç§å½¢è±¡ã€‚</li><li><strong>ä¸ªæ€§åŒ–å®šåˆ¶</strong>ï¼šå¯åŸºäºç…§ç‰‡æˆ–æ–‡å­—æè¿°ç”Ÿæˆç‹¬ç‰¹æ•°å­—äººã€‚</li><li><strong>é«˜ç²¾åº¦å»ºæ¨¡</strong>ï¼šç»†è…»è¿˜åŸæ¯›å‘ã€çš®è‚¤ã€æœè£…ç­‰ç»†èŠ‚ï¼Œåª²ç¾ç”µå½±çº§è§†è§‰æ•ˆæœã€‚</li></ul><h2 id="2-AI-é©±åŠ¨çš„è¯­éŸ³ä¸åŠ¨ä½œ"><a href="#2-AI-é©±åŠ¨çš„è¯­éŸ³ä¸åŠ¨ä½œ" class="headerlink" title="2. AI é©±åŠ¨çš„è¯­éŸ³ä¸åŠ¨ä½œ"></a>2. AI é©±åŠ¨çš„è¯­éŸ³ä¸åŠ¨ä½œ</h2><ul><li><strong>è‡ªç„¶è¯­éŸ³ï¼ˆTTSï¼‰</strong>ï¼šå¤šè¯­ç§ã€å¤šéŸ³è‰²ã€å¤šæƒ…æ„Ÿçš„æ‹ŸäººåŒ–è¯­éŸ³ç”Ÿæˆã€‚</li><li><strong>è¡¨æƒ…ä¸åŠ¨ä½œåŒæ­¥</strong>ï¼šæ ¹æ®æ–‡æœ¬å†…å®¹è‡ªåŠ¨ç”Ÿæˆå£å‹ã€è¡¨æƒ…ã€çœ¼ç¥ã€æ‰‹åŠ¿ã€‚</li><li><strong>æƒ…æ„ŸåŒ–è¡¨ç°</strong>ï¼šèƒ½æ ¹æ®è¯­ä¹‰è¡¨è¾¾å¾®ç¬‘ã€ç‚¹å¤´ç­‰ç»†è…»åŠ¨ä½œï¼Œæå‡äº¤æµæ„ŸæŸ“åŠ›ã€‚</li></ul><h2 id="3-å¤šæ¨¡æ€å†…å®¹ç”Ÿæˆ"><a href="#3-å¤šæ¨¡æ€å†…å®¹ç”Ÿæˆ" class="headerlink" title="3. å¤šæ¨¡æ€å†…å®¹ç”Ÿæˆ"></a>3. å¤šæ¨¡æ€å†…å®¹ç”Ÿæˆ</h2><ul><li><strong>è¯­è¨€ + å­—å¹• + åŠ¨æ•ˆ + å›¾è¡¨ + è§†é¢‘</strong> èåˆè¾“å‡ºï¼Œæ‰“é€ æ²‰æµ¸å¼è¡¨è¾¾ã€‚</li><li><strong>3D åœºæ™¯ä¸è¿é•œ</strong>ï¼šå†…ç½®å¤šç§ä¸“ä¸šé•œå¤´ä¸è¿é•œåŠ¨ç”»ï¼Œè®©å‘ˆç°æ›´å…·å½±è§†è´¨æ„Ÿã€‚</li></ul><h2 id="4-å®æ—¶äº¤äº’ä¸ä½å»¶æ—¶é©±åŠ¨"><a href="#4-å®æ—¶äº¤äº’ä¸ä½å»¶æ—¶é©±åŠ¨" class="headerlink" title="4. å®æ—¶äº¤äº’ä¸ä½å»¶æ—¶é©±åŠ¨"></a>4. å®æ—¶äº¤äº’ä¸ä½å»¶æ—¶é©±åŠ¨</h2><ul><li><strong>&lt;1 ç§’ä½å»¶æ—¶</strong>ï¼šæ”¯æŒå®æ—¶è¯­éŸ³é©±åŠ¨ä¸åé¦ˆï¼Œé€‚ç”¨äºç›´æ’­ã€å®¢æœã€AR/VR åœºæ™¯ã€‚</li><li><strong>é«˜å¹¶å‘èƒ½åŠ›</strong>ï¼šå¯åŒæ—¶é©±åŠ¨æˆåƒä¸Šä¸‡æ•°å­—äººå®ä¾‹ã€‚</li><li><strong>ç«¯ä¾§æ¸²æŸ“</strong>ï¼šç™¾å…ƒçº§èŠ¯ç‰‡ï¼ˆå¦‚ RK3588ï¼‰å³å¯å®ç°é«˜è´¨é‡ 3D å®æ—¶æ¸²æŸ“ã€‚</li></ul><h2 id="5-å¼€æ”¾-API-ä¸-SDK"><a href="#5-å¼€æ”¾-API-ä¸-SDK" class="headerlink" title="5. å¼€æ”¾ API ä¸ SDK"></a>5. å¼€æ”¾ API ä¸ SDK</h2><ul><li><strong>API æ¥å£</strong>ï¼šå¼€æ”¾æ•°å­—äººç”Ÿæˆã€è¯­éŸ³é©±åŠ¨ã€åŠ¨ä½œæ§åˆ¶ã€è§†é¢‘ç”Ÿæˆç­‰èƒ½åŠ›ã€‚</li><li><strong>SDK é›†æˆ</strong>ï¼šé€‚é…ç§»åŠ¨ç«¯ã€Webã€AR/VRã€è½¦æœºã€å¹¿å‘Šå±ç­‰å¤šç»ˆç«¯ç¯å¢ƒã€‚</li><li><strong>æ¨¡å—åŒ–è°ƒç”¨</strong>ï¼šå¯å•ç‹¬è°ƒç”¨ TTSã€3D åŠ¨ç”»ã€æ¸²æŸ“æ¨¡å—ï¼Œçµæ´»æ¥å…¥ã€‚</li></ul><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> AIæ•°å­—äººäº†è§£ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Github </tag>
            
            <tag> åšå®¢ </tag>
            
            <tag> AIæ•°å­—äºº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JavaScript</title>
      <link href="/2020/08/30/javascript/"/>
      <url>/2020/08/30/javascript/</url>
      
        <content type="html"><![CDATA[<h1 id="ç®€çŸ­ä»‹ç»"><a href="#ç®€çŸ­ä»‹ç»" class="headerlink" title="ç®€çŸ­ä»‹ç»"></a>ç®€çŸ­ä»‹ç»</h1><p><code>JavaScript</code> æ˜¯ä¸€é—¨ç”¨æ¥ä¸ç½‘é¡µäº¤äº’çš„è„šæœ¬è¯­è¨€ï¼ŒåŒ…å«ä»¥ä¸‹ä¸‰ä¸ªç»„æˆéƒ¨åˆ†ã€‚<br> 1ã€ECMAScriptï¼šç”± ECMA-262 å®šä¹‰å¹¶æä¾›æ ¸å¿ƒåŠŸèƒ½ã€‚<br> 2ã€æ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼ˆDOMï¼‰ï¼šæä¾›ä¸ç½‘é¡µå†…å®¹äº¤äº’çš„æ–¹æ³•å’Œæ¥å£ã€‚<br> 3ã€æµè§ˆå™¨å¯¹è±¡æ¨¡å‹ï¼ˆBOMï¼‰ï¼šæä¾›ä¸æµè§ˆå™¨äº¤äº’çš„æ–¹æ³•å’Œæ¥å£ã€‚<br>JavaScript çš„è¿™ä¸‰ä¸ªéƒ¨åˆ†å¾—åˆ°äº†äº”å¤§ <code>Web</code> æµè§ˆå™¨<code>ï¼ˆIEã€Firefoxã€Chromeã€Safari å’Œ Operaï¼‰</code>ä¸åŒç¨‹åº¦<br>çš„æ”¯æŒã€‚æ‰€æœ‰æµè§ˆå™¨åŸºæœ¬ä¸Šå¯¹ <code>ES5ï¼ˆECMAScript 5ï¼‰</code>æä¾›äº†å®Œå–„çš„æ”¯æŒï¼Œè€Œå¯¹ <code>ES6ï¼ˆECMAScript 6ï¼‰</code>å’Œ<br><code>ES7ï¼ˆECMAScript 7ï¼‰</code>çš„æ”¯æŒåº¦ä¹Ÿåœ¨ä¸æ–­æå‡ã€‚è¿™äº›æµè§ˆå™¨å¯¹ DOM çš„æ”¯æŒå„ä¸ç›¸åŒï¼Œä½†å¯¹ Level 3 çš„æ”¯<br>æŒæ—¥ç›Šè¶‹äºè§„èŒƒã€‚<code>HTML5</code> ä¸­æ”¶å½•çš„ <code>BOM</code> ä¼šå› æµè§ˆå™¨è€Œå¼‚ï¼Œä¸è¿‡å¼€å‘è€…ä»ç„¶å¯ä»¥å‡å®šå­˜åœ¨å¾ˆå¤§ä¸€éƒ¨åˆ†<br>å…¬å…±ç‰¹æ€§ã€‚<br><code>å­¦ä¹ æ˜¯ä¸€é¡¹é•¿æœŸçš„ä»»åŠ¡ï¼Œè®©æˆ‘æ¥ä¸€èµ·æˆé•¿å§ï¼</code></p><hr><h2 id="åŸºç¡€"><a href="#åŸºç¡€" class="headerlink" title="åŸºç¡€"></a>åŸºç¡€</h2><h2 id="JavaScriptçš„æ•°æ®ç±»å‹æœ‰å“ªäº›ï¼Ÿå¼•ç”¨ç±»å‹æœ‰å“ªäº›ï¼Ÿ"><a href="#JavaScriptçš„æ•°æ®ç±»å‹æœ‰å“ªäº›ï¼Ÿå¼•ç”¨ç±»å‹æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="JavaScriptçš„æ•°æ®ç±»å‹æœ‰å“ªäº›ï¼Ÿå¼•ç”¨ç±»å‹æœ‰å“ªäº›ï¼Ÿ"></a>JavaScriptçš„æ•°æ®ç±»å‹æœ‰å“ªäº›ï¼Ÿå¼•ç”¨ç±»å‹æœ‰å“ªäº›ï¼Ÿ</h2><p>  JavaScript ä¸­çš„æ•°æ®ç±»å‹å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼š<code>åŸºæœ¬ç±»å‹ï¼ˆåŸå§‹ç±»å‹ï¼‰</code>å’Œ <code>å¼•ç”¨ç±»å‹</code>ã€‚</p><ul><li><p>åŸå§‹ç±»å‹ï¼šNumber, String, Boolean, null,undefined, Symbol, BigIntã€‚</p></li><li><p>å¼•ç”¨ç±»å‹ï¼šObject, Array, Function, Date, RegExp, Map, Set</p><hr><h2 id="å¦‚ä½•åˆ¤æ–­JavaScriptçš„æ•°æ®ç±»å‹"><a href="#å¦‚ä½•åˆ¤æ–­JavaScriptçš„æ•°æ®ç±»å‹" class="headerlink" title="å¦‚ä½•åˆ¤æ–­JavaScriptçš„æ•°æ®ç±»å‹"></a>å¦‚ä½•åˆ¤æ–­JavaScriptçš„æ•°æ®ç±»å‹</h2></li></ul><ol><li>ä½¿ç”¨ <code>typeof</code> è¿ç®—ç¬¦<pre class="line-numbers language-javascript"><code class="language-javascript">   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token function">BigInt</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">// "bigint"</span>   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// "object"</span>   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// "object" (æ•°ç»„ä¹Ÿæ˜¯å¯¹è±¡)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li>ä½¿ç”¨ <code>instanceof</code> è¿ç®—ç¬¦<pre class="line-numbers language-javascript"><code class="language-javascript">   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">instanceof</span> <span class="token class-name">Array</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// true</span>   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// true</span>   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token keyword">instanceof</span> <span class="token class-name">Function</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// true</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li>ä½¿ç”¨ <code>Object.prototype.toString.call()</code> æ–¹æ³•<pre class="line-numbers language-javascript"><code class="language-javascript">   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>toString<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// "[object Array]"</span>   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>toString<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// "[object Object]"</span>   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>toString<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// "[object Function]"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li>ä½¿ç”¨ <code>Array.isArray()</code> æ–¹æ³•<pre class="line-numbers language-javascript"><code class="language-javascript">   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// true</span>   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// false</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li></ol><ul><li>åŸå§‹ç±»å‹å¯ä»¥ä½¿ç”¨ typeof è¿›è¡Œåˆ¤æ–­ï¼Œä½†å¯¹äº null å’Œæ•°ç»„çš„åˆ¤æ–­ä¸å¤Ÿå‡†ç¡®ã€‚</li><li>å¼•ç”¨ç±»å‹å¯ä»¥ä½¿ç”¨ instanceof å’Œ Array.isArray() è¿›è¡Œåˆ¤æ–­ï¼Œæˆ–è€…é€šè¿‡ Object.prototype.toString.call() æ¥è¿›è¡Œæ›´å‡†ç¡®çš„åˆ¤æ–­ã€‚</li><li>ç»“åˆä¸åŒçš„æ–¹æ³•ï¼Œå¯ä»¥å®ç°æ›´çµæ´»å’Œå‡†ç¡®çš„æ•°æ®ç±»å‹åˆ¤æ–­ã€‚</li></ul><hr><h2 id="æ€ä¹ˆåˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰ï¼Ÿå¦‚ä½•åˆ¤æ–­ç©ºå¯¹è±¡ï¼Ÿ"><a href="#æ€ä¹ˆåˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰ï¼Ÿå¦‚ä½•åˆ¤æ–­ç©ºå¯¹è±¡ï¼Ÿ" class="headerlink" title="æ€ä¹ˆåˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰ï¼Ÿå¦‚ä½•åˆ¤æ–­ç©ºå¯¹è±¡ï¼Ÿ"></a>æ€ä¹ˆåˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰ï¼Ÿå¦‚ä½•åˆ¤æ–­ç©ºå¯¹è±¡ï¼Ÿ</h2><ol><li><p><code>æ¯”è¾ƒå¯¹è±¡çš„å±æ€§</code></p><ul><li><p>è¦åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡çš„å±æ€§æ˜¯å¦ç›¸ç­‰ï¼Œå¯ä»¥éå†å®ƒä»¬çš„å±æ€§ï¼Œé€ä¸€æ¯”è¾ƒå€¼ã€‚</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">isEqual</span><span class="token punctuation">(</span>obj1<span class="token punctuation">,</span> obj2<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„å¼•ç”¨ç›¸åŒï¼Œåˆ™ç›´æ¥è¿”å› true</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>obj1 <span class="token operator">===</span> obj2<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// å¦‚æœä¸¤ä¸ªå¯¹è±¡å…¶ä¸­ä¸€ä¸ªä¸æ˜¯å¯¹è±¡ï¼Œæˆ–è€…å®ƒä»¬çš„ç±»å‹ä¸åŒï¼Œè¿”å› false</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> obj1 <span class="token operator">!==</span> <span class="token string">'object'</span> <span class="token operator">||</span> <span class="token keyword">typeof</span> obj2 <span class="token operator">!==</span> <span class="token string">'object'</span> <span class="token operator">||</span> obj1 <span class="token operator">===</span> <span class="token keyword">null</span> <span class="token operator">||</span> obj2 <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token comment" spellcheck="true">// è·å–ä¸¤ä¸ªå¯¹è±¡çš„å±æ€§åæ•°ç»„</span>  <span class="token keyword">const</span> keys1 <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token keyword">const</span> keys2 <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj2<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// å¦‚æœå±æ€§æ•°é‡ä¸åŒï¼Œè¿”å› false</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>keys1<span class="token punctuation">.</span>length <span class="token operator">!==</span> keys2<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token comment" spellcheck="true">// éå†å±æ€§å¹¶é€’å½’æ¯”è¾ƒ</span>  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">of</span> keys1<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// å¦‚æœ obj2 ä¸­æ²¡æœ‰ obj1 çš„æŸä¸ªå±æ€§ï¼Œæˆ–è€…å±æ€§å€¼ä¸ç›¸ç­‰ï¼Œè¿”å› false</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>keys2<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">isEqual</span><span class="token punctuation">(</span>obj1<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> obj2<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>  <span class="token punctuation">}</span>  <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment" spellcheck="true">// ç¤ºä¾‹</span><span class="token keyword">const</span> objA <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> b<span class="token punctuation">:</span> <span class="token punctuation">{</span> c<span class="token punctuation">:</span> <span class="token number">2</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token keyword">const</span> objB <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> b<span class="token punctuation">:</span> <span class="token punctuation">{</span> c<span class="token punctuation">:</span> <span class="token number">2</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">isEqual</span><span class="token punctuation">(</span>objA<span class="token punctuation">,</span> objB<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// true</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul></li></ol><pre><code>2. `åˆ¤æ–­ç©ºå¯¹è±¡`- è¦åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦ä¸ºç©ºå¯¹è±¡ï¼ˆå³æ²¡æœ‰ä»»ä½•å¯æšä¸¾çš„å±æ€§ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ `Object.keys()` æˆ– `Object.getOwnPropertyNames()` æ¥è·å–å¯¹è±¡çš„å±æ€§ï¼Œç„¶ååˆ¤æ–­å±æ€§æ•°ç»„æ˜¯å¦ä¸ºç©ºã€‚```javascript  // éå†keys  function isEmptyObject(obj) {    // åˆ¤æ–­æ˜¯å¦ä¸ºå¯¹è±¡ï¼Œä¸”æ˜¯å¦ä¸ºç©º    return obj &amp;&amp; Object.keys(obj).length === 0 &amp;&amp; obj.constructor === Object;  }  // ç¤ºä¾‹  console.log(isEmptyObject({}));      // true  console.log(isEmptyObject({ a: 1 })); // false</code></pre><hr><h2 id="0-1-0-2ä¸ºä»€ä¹ˆä¸ç­‰äº0-3ï¼Ÿ"><a href="#0-1-0-2ä¸ºä»€ä¹ˆä¸ç­‰äº0-3ï¼Ÿ" class="headerlink" title="0.1+0.2ä¸ºä»€ä¹ˆä¸ç­‰äº0.3ï¼Ÿ"></a>0.1+0.2ä¸ºä»€ä¹ˆä¸ç­‰äº0.3ï¼Ÿ</h2><p><em>åŸç†è§£é‡Š</em></p><ul><li>åœ¨äºŒè¿›åˆ¶è¡¨ç¤ºä¸­ï¼Œåƒ 0.1 å’Œ 0.2 è¿™æ ·çš„åè¿›åˆ¶å°æ•°ä¸èƒ½è¢«ç²¾ç¡®è¡¨ç¤ºã€‚å®ƒä»¬åœ¨äºŒè¿›åˆ¶ä¸­æ˜¯æ— é™å¾ªç¯çš„æ•°å€¼ï¼Œå› æ­¤è¢«æˆªæ–­ä¸ºè¿‘ä¼¼å€¼ã€‚è¿™ç§è¿‘ä¼¼å€¼åœ¨è®¡ç®—æ—¶ä¼šå¼•å‘ç²¾åº¦è¯¯å·®ã€‚</li></ul><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><ul><li>0.1 åœ¨äºŒè¿›åˆ¶ä¸­çš„è¡¨ç¤ºæ˜¯ï¼š0.0001100110011001100110011001100110011001100110011001101ï¼ˆæ— é™å¾ªç¯ï¼‰</li><li>0.2 åœ¨äºŒè¿›åˆ¶ä¸­çš„è¡¨ç¤ºæ˜¯ï¼š0.001100110011001100110011001100110011001100110011001101ï¼ˆæ— é™å¾ªç¯ï¼‰<br>å½“ä½ è¿›è¡Œ 0.1 + 0.2 çš„è®¡ç®—æ—¶ï¼ŒJavaScript å°†è¿‘ä¼¼å€¼ç›¸åŠ ï¼Œç»“æœæ˜¯ 0.30000000000000004ï¼Œè¿™å’Œä½ æœŸæœ›çš„ 0.3 ä¸å®Œå…¨ç›¸ç­‰ã€‚</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript">    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">0.1</span> <span class="token operator">+</span> <span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment" spellcheck="true">// è¾“å‡º 0.30000000000000004</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">0.1</span> <span class="token operator">+</span> <span class="token number">0.2</span> <span class="token operator">===</span> <span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// è¾“å‡º false</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><em>å¦‚ä½•è§£å†³</em><br>ä¸ºäº†é¿å…è¿™ç§ç²¾åº¦é—®é¢˜ï¼Œé€šå¸¸ä¼šä½¿ç”¨å››èˆäº”å…¥çš„æ–¹æ³•æ¥ä¿®æ­£è®¡ç®—ç»“æœã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ <code>toFixed()</code> æ–¹æ³•æˆ– <code>Number.EPSILON</code> æ¥æ¯”è¾ƒä¸¤ä¸ªæµ®ç‚¹æ•°ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript">    <span class="token keyword">let</span> sum <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0.1</span> <span class="token operator">+</span> <span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// å››èˆäº”å…¥ä¿ç•™ 1 ä½å°æ•°</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sum <span class="token operator">===</span> <span class="token string">'0.3'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       <span class="token comment" spellcheck="true">// è¾“å‡º true</span>    <span class="token comment" spellcheck="true">// ä½¿ç”¨ Number.EPSILON ï¼ˆå…è®¸å°è¯¯å·®ï¼‰</span>    <span class="token keyword">function</span> <span class="token function">areEqual</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>a <span class="token operator">-</span> b<span class="token punctuation">)</span> <span class="token operator">&lt;</span> Number<span class="token punctuation">.</span>EPSILON<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">areEqual</span><span class="token punctuation">(</span><span class="token number">0.1</span> <span class="token operator">+</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// è¾“å‡º true</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦ä¸ºç©ºå¯¹è±¡ï¼Ÿ"><a href="#å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦ä¸ºç©ºå¯¹è±¡ï¼Ÿ" class="headerlink" title="å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦ä¸ºç©ºå¯¹è±¡ï¼Ÿ"></a>å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦ä¸ºç©ºå¯¹è±¡ï¼Ÿ</h2><p><em>æ–¹æ³•ä¸€ï¼šä½¿ç”¨<code>for...in</code>å¾ªç¯</em></p><pre class="line-numbers language-javascript"><code class="language-javascript">  <span class="token comment" spellcheck="true">// éå†keys</span>  <span class="token keyword">function</span> <span class="token function">isEmptyObject</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">isEqual</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>      <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>a <span class="token operator">-</span> b<span class="token punctuation">)</span> <span class="token operator">&lt;</span> Number<span class="token punctuation">.</span>EPSILON<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">isEqual</span><span class="token punctuation">(</span><span class="token number">0.1</span> <span class="token operator">+</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// è¾“å‡º true</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="å¼ºåˆ¶ç±»å‹è½¬æ¢ã€éšå¼ç±»å‹è½¬æ¢åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿåœºæ™¯è¯´æ˜"><a href="#å¼ºåˆ¶ç±»å‹è½¬æ¢ã€éšå¼ç±»å‹è½¬æ¢åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿåœºæ™¯è¯´æ˜" class="headerlink" title="å¼ºåˆ¶ç±»å‹è½¬æ¢ã€éšå¼ç±»å‹è½¬æ¢åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿåœºæ™¯è¯´æ˜"></a>å¼ºåˆ¶ç±»å‹è½¬æ¢ã€éšå¼ç±»å‹è½¬æ¢åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿåœºæ™¯è¯´æ˜</h2><ol><li>å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œä¹Ÿç§°ä¸ºæ˜¾å¼ç±»å‹è½¬æ¢ï¼Œæ˜¯é€šè¿‡å¼€å‘è€…æ‰‹åŠ¨è°ƒç”¨å‡½æ•°æˆ–è¿ç®—ç¬¦æ¥å°†ä¸€ä¸ªå€¼è½¬æ¢ä¸ºæ‰€éœ€çš„ç±»å‹ã€‚å¸¸è§çš„ç±»å‹è½¬æ¢åŒ…æ‹¬å°†å€¼è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€æ•°å­—æˆ–å¸ƒå°”å€¼ã€‚</li></ol><p><em>å¸¸è§çš„å¼ºåˆ¶ç±»å‹è½¬æ¢æ–¹æ³•ï¼š</em></p><ul><li>è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼šä½¿ç”¨ String() å‡½æ•°æˆ–è°ƒç”¨ toString() æ–¹æ³•</li><li>è½¬æ¢ä¸ºæ•°å­—ï¼šä½¿ç”¨ Number()ã€parseInt()ã€parseFloat() å‡½æ•°</li><li>è½¬æ¢ä¸ºå¸ƒå°”å€¼ï¼šä½¿ç”¨ Boolean() å‡½æ•°<pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// å°†æ•°å­—è½¬æ¢ä¸ºå­—ç¬¦ä¸² ï¼ˆäº’è½¬ï¼‰</span><span class="token keyword">let</span> num <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">;</span><span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token function">String</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// str = "123"</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// è¾“å‡º "string"</span><span class="token comment" spellcheck="true">// å°†å€¼è½¬æ¢ä¸ºå¸ƒå°”å€¼</span><span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">let</span> isTrue <span class="token operator">=</span> <span class="token function">Boolean</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// isTrue = false, å› ä¸º 0 è½¬æ¢ä¸º false</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>isTrue<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// è¾“å‡º false</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><p>2.éšå¼ç±»å‹è½¬æ¢ï¼Œä¹Ÿç§°ä¸ºè‡ªåŠ¨ç±»å‹è½¬æ¢ï¼Œæ˜¯ JavaScript åœ¨é‡åˆ°ä¸åŒç±»å‹çš„å€¼æ—¶è‡ªåŠ¨è¿›è¡Œçš„ç±»å‹è½¬æ¢ã€‚å®ƒé€šå¸¸å‘ç”Ÿåœ¨ç®—æœ¯è¿ç®—ã€æ¯”è¾ƒæ“ä½œç­‰åœºæ™¯ä¸‹ã€‚</p><p><em>å¸¸è§çš„éšå¼ç±»å‹è½¬æ¢ï¼š</em></p><ul><li>æ•°å­—ä¸å­—ç¬¦ä¸²æ··åˆè¿ç®—æ—¶ï¼ŒJavaScript ä¼šå°†æ•°å­—è½¬æ¢ä¸ºå­—ç¬¦ä¸²è¿›è¡Œæ‹¼æ¥</li><li>ä½¿ç”¨åŒç­‰å· == è¿›è¡Œæ¯”è¾ƒæ—¶ï¼ŒJavaScript ä¼šè‡ªåŠ¨è¿›è¡Œç±»å‹è½¬æ¢ä»¥æ¯”è¾ƒå€¼</li><li>åœ¨æ¡ä»¶è¯­å¥ä¸­ï¼Œéå¸ƒå°”ç±»å‹ä¼šè¢«è‡ªåŠ¨è½¬æ¢ä¸ºå¸ƒå°”ç±»å‹</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript">  <span class="token comment" spellcheck="true">// å­—ç¬¦ä¸²ä¸æ•°å­—ç›¸åŠ </span>  <span class="token keyword">let</span> num <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>  <span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token string">"5"</span><span class="token punctuation">;</span>  <span class="token keyword">let</span> result <span class="token operator">=</span> num <span class="token operator">+</span> str<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// "10" + "5" -> "105" ï¼ˆå­—ç¬¦ä¸²æ‹¼æ¥ï¼‰</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// è¾“å‡º "105"</span>  <span class="token comment" spellcheck="true">// åŒç­‰å·æ¯”è¾ƒ</span>  <span class="token keyword">let</span> num <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token keyword">let</span> bool <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>num <span class="token operator">==</span> bool<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// è¾“å‡º trueï¼Œå› ä¸º `true` è¢«è½¬æ¢ä¸º 1</span>  <span class="token comment" spellcheck="true">// æ¡ä»¶è¯­å¥ä¸­çš„éšå¼è½¬æ¢</span>  <span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>  <span class="token keyword">if</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"True"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"False"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// è¾“å‡º "False"ï¼Œå› ä¸ºç©ºå­—ç¬¦ä¸²è¢«è½¬æ¢ä¸º `false`</span>  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><code>æ€»ç»“ï¼š</code></p><ul><li>å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼šå¼€å‘è€…ä¸»åŠ¨è°ƒç”¨å‡½æ•°å°†æ•°æ®ç±»å‹æ˜¾å¼è½¬æ¢ã€‚</li><li>éšå¼ç±»å‹è½¬æ¢ï¼šJavaScript è‡ªåŠ¨è½¬æ¢ç±»å‹ï¼Œå¯èƒ½å¯¼è‡´æ„å¤–çš„ç»“æœã€‚</li></ul><hr><h2 id="å’Œ-çš„åŒºåˆ«"><a href="#å’Œ-çš„åŒºåˆ«" class="headerlink" title="===å’Œ==çš„åŒºåˆ«"></a>===å’Œ==çš„åŒºåˆ«</h2><ul><li><p><code>===</code>ï¼šä¸¥æ ¼ç›¸ç­‰ï¼Œä¸ä¼šè¿›è¡Œç±»å‹è½¬æ¢ï¼Œåªæœ‰å½“å€¼å’Œç±»å‹éƒ½ç›¸ç­‰æ—¶æ‰è¿”å› trueã€‚</p></li><li><p><code>==</code>ï¼šå®½æ¾ç›¸ç­‰ï¼Œå…è®¸ç±»å‹è½¬æ¢ï¼Œä¼šå°†ä¸¤ä¸ªå€¼çš„ç±»å‹è½¬æ¢ä¸ºç›¸åŒç±»å‹åå†è¿›è¡Œæ¯”è¾ƒã€‚</p><pre class="line-numbers language-javaScript"><code class="language-javaScript">  1 === 1;         // true  1 === '1';       // false (ä¸åŒç±»å‹ï¼Œä¸€ä¸ªæ˜¯æ•°å­—ï¼Œä¸€ä¸ªæ˜¯å­—ç¬¦ä¸²)  true === 1;      // false (å¸ƒå°”å€¼ä¸æ•°å­—ä¸åŒç±»å‹)  null === undefined; // false (ä¸åŒç±»å‹)  // ==   0 == false;      // true (0 è¢«è½¬æ¢ä¸º false)  0 === false;     // false (ä¸åŒç±»å‹)  [] == false;     // true (ç©ºæ•°ç»„è¢«è½¬æ¢ä¸º false)  [] === false;    // false (ä¸åŒç±»å‹)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>æ€»ç»“ï¼š<code>=== æ›´ä¸¥æ ¼ã€æ›´å®‰å…¨</code>ï¼Œè€Œ <code>== å…è®¸éšå¼ç±»å‹è½¬æ¢</code>ï¼Œä½†å¯èƒ½å¯¼è‡´æ„å¤–è¡Œä¸ºã€‚</p></li></ul><hr><h2 id="å…ƒç´ æ‹–åŠ¨å¦‚ä½•å®ç°ï¼Œå®ç°åŸç†"><a href="#å…ƒç´ æ‹–åŠ¨å¦‚ä½•å®ç°ï¼Œå®ç°åŸç†" class="headerlink" title="å…ƒç´ æ‹–åŠ¨å¦‚ä½•å®ç°ï¼Œå®ç°åŸç†"></a>å…ƒç´ æ‹–åŠ¨å¦‚ä½•å®ç°ï¼Œå®ç°åŸç†</h2><p><strong>å®ç°æ­¥éª¤</strong></p><ol><li><code>ç›‘å¬ mousedown äº‹ä»¶</code>ï¼šå½“ç”¨æˆ·æŒ‰ä¸‹é¼ æ ‡æ—¶ï¼Œè®°å½•é¼ æ ‡å½“å‰ä½ç½®ï¼Œå¹¶å¼€å§‹ç›‘å¬é¼ æ ‡ç§»åŠ¨äº‹ä»¶ã€‚</li><li><code>ç›‘å¬ mousemove äº‹ä»¶</code>ï¼šåœ¨é¼ æ ‡ç§»åŠ¨è¿‡ç¨‹ä¸­ï¼Œè®¡ç®—é¼ æ ‡çš„ä½ç§»å¹¶æ›´æ–°å…ƒç´ çš„ä½ç½®ï¼Œä½¿å…¶è·Ÿéšé¼ æ ‡ç§»åŠ¨ã€‚</li><li><code>ç›‘å¬ mouseup äº‹ä»¶</code>ï¼šå½“é¼ æ ‡æ¾å¼€æ—¶ï¼Œåœæ­¢ç§»åŠ¨æ“ä½œï¼Œç§»é™¤é¼ æ ‡ç§»åŠ¨çš„ç›‘å¬å™¨ã€‚</li></ol><p><strong>å®ç°åŸç†</strong></p><ol><li><p>è·å–åˆå§‹ä½ç½®ï¼š<br>å½“ç”¨æˆ·æŒ‰ä¸‹é¼ æ ‡ï¼ˆ<code>mousedown</code>ï¼‰æ—¶ï¼Œè·å–å½“å‰é¼ æ ‡ç›¸å¯¹äºé¡µé¢çš„åæ ‡ï¼Œè®°å½•å…ƒç´ çš„åˆå§‹ä½ç½®ã€‚</p></li><li><p>è®¡ç®—ä½ç§»å¹¶æ›´æ–°ä½ç½®ï¼š</p></li></ol><p>åœ¨é¼ æ ‡ç§»åŠ¨æ—¶ï¼ˆ<code>mousemove</code>ï¼‰ï¼Œä¸æ–­è·å–æ–°çš„é¼ æ ‡ä½ç½®ï¼Œè®¡ç®—ä¸åˆå§‹æŒ‰ä¸‹æ—¶çš„å·®å€¼ï¼Œæ›´æ–°å…ƒç´ çš„ left å’Œ top æ ·å¼ï¼Œä½¿å…ƒç´ éšç€é¼ æ ‡ç§»åŠ¨ã€‚</p><ol start="3"><li>ç»“æŸæ‹–åŠ¨ï¼š<br>å½“ç”¨æˆ·æ¾å¼€é¼ æ ‡ï¼ˆ<code>mouseup</code>ï¼‰ï¼Œåœæ­¢ç›‘å¬ mousemove äº‹ä»¶ã€‚</li></ol><pre class="line-numbers language-html"><code class="language-html"><span class="token doctype">&lt;!DOCTYPE html></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width<span class="token punctuation">=</span>device-width, initial-scale<span class="token punctuation">=</span>1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style language-css">        <span class="token selector"><span class="token id">#draggable</span> </span><span class="token punctuation">{</span>            <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>            <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> skyblue<span class="token punctuation">;</span>            <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>            <span class="token property">cursor</span><span class="token punctuation">:</span> grab<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Draggable Element<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>draggable<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Drag me<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script language-javascript">        <span class="token keyword">const</span> draggable <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'draggable'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">let</span> offsetX<span class="token punctuation">,</span> offsetY<span class="token punctuation">,</span> isDragging <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// å½“é¼ æ ‡æŒ‰ä¸‹æ—¶</span>        draggable<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'mousedown'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>            isDragging <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>            offsetX <span class="token operator">=</span> event<span class="token punctuation">.</span>clientX <span class="token operator">-</span> draggable<span class="token punctuation">.</span>offsetLeft<span class="token punctuation">;</span>            offsetY <span class="token operator">=</span> event<span class="token punctuation">.</span>clientY <span class="token operator">-</span> draggable<span class="token punctuation">.</span>offsetTop<span class="token punctuation">;</span>            draggable<span class="token punctuation">.</span>style<span class="token punctuation">.</span>cursor <span class="token operator">=</span> <span class="token string">'grabbing'</span><span class="token punctuation">;</span>            <span class="token comment" spellcheck="true">// é˜²æ­¢æ–‡æœ¬é€‰æ‹©</span>            event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// å½“é¼ æ ‡ç§»åŠ¨æ—¶</span>        document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'mousemove'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>isDragging<span class="token punctuation">)</span> <span class="token punctuation">{</span>                draggable<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>clientX <span class="token operator">-</span> offsetX<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'px'</span><span class="token punctuation">;</span>                draggable<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>clientY <span class="token operator">-</span> offsetY<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'px'</span><span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment" spellcheck="true">// å½“é¼ æ ‡æ¾å¼€æ—¶</span>        document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'mouseup'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>            isDragging <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>            draggable<span class="token punctuation">.</span>style<span class="token punctuation">.</span>cursor <span class="token operator">=</span> <span class="token string">'grab'</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="èŠ‚æµå’Œé˜²æŠ–"><a href="#èŠ‚æµå’Œé˜²æŠ–" class="headerlink" title="èŠ‚æµå’Œé˜²æŠ–"></a>èŠ‚æµå’Œé˜²æŠ–</h2><ol><li><strong>èŠ‚æµ: é™ä½ç”¨æˆ·äº‹ä»¶å“åº”çš„é¢‘ç‡ï¼ˆèŠ‚æµæ˜¯æŒ‡åœ¨è§„å®šçš„æ—¶é—´é—´éš”å†…ï¼Œåªæ‰§è¡Œä¸€æ¬¡æ“ä½œï¼‰</strong><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span>func<span class="token punctuation">,</span> delay<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">let</span> lastTime <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span> <span class="token punctuation">{</span>     <span class="token keyword">const</span> now <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">if</span> <span class="token punctuation">(</span>now <span class="token operator">-</span> lastTime <span class="token operator">>=</span> delay<span class="token punctuation">)</span> <span class="token punctuation">{</span>         lastTime <span class="token operator">=</span> now<span class="token punctuation">;</span>         func<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><p>// ä½¿ç”¨<br>window.addEventListener(â€˜scrollâ€™, throttle(() =&gt; {<br>    console.log(â€˜Throttled scroll eventâ€™);<br>}, 1000));</p><pre><code>2. **é˜²æŠ–: åªå“åº”æœ€åä¸€ä¸ªç”¨æˆ·äº‹ä»¶ï¼ˆåªæœ‰åœ¨è§„å®šçš„æ—¶é—´å†…æ²¡æœ‰å†æ¬¡è§¦å‘ï¼‰**```javascriptfunction debounce(func, delay) {    let timer;    return function(...args) {        clearTimeout(timer);        timer = setTimeout(() =&gt; {            func.apply(this, args);        }, delay);    };}// ä½¿ç”¨const input = document.getElementById('searchInput');input.addEventListener('input', debounce(() =&gt; {    console.log('Debounced input event');}, 500));</code></pre><p><strong>ç»“åˆåœºæ™¯é€‰æ‹©</strong></p><ul><li><code>èŠ‚æµï¼šé€‚åˆæŒç»­è§¦å‘çš„åœºæ™¯ï¼Œä¾‹å¦‚æ»šåŠ¨ã€æ‹–æ‹½ç­‰äº‹ä»¶ï¼Œé¿å…å¤„ç†å‡½æ•°çš„é¢‘ç¹è°ƒç”¨è€Œå½±å“æ€§èƒ½ã€‚</code></li><li><code>é˜²æŠ–ï¼šé€‚åˆéæŒç»­è§¦å‘çš„åœºæ™¯ï¼Œä¾‹å¦‚æœç´¢æ¡†è¾“å…¥ã€è¡¨å•æ ¡éªŒç­‰ï¼Œåªæœ‰åœ¨ç”¨æˆ·åœæ­¢è¾“å…¥åæ‰æ‰§è¡Œæ“ä½œã€‚</code></li></ul><hr><h2 id="promise-å’Œ-async-awaitçš„å…³ç³»"><a href="#promise-å’Œ-async-awaitçš„å…³ç³»" class="headerlink" title="promise å’Œ async/awaitçš„å…³ç³»"></a>promise å’Œ async/awaitçš„å…³ç³»</h2><ul><li><code>Promise</code> æ˜¯å¼‚æ­¥å¤„ç†çš„åŸºç¡€ï¼Œå®ƒé€šè¿‡ <code>.then()</code> å’Œ <code>.catch()</code> æ¥å¤„ç†å¼‚æ­¥æ“ä½œåŠå…¶ç»“æœã€‚</li><li><code>async/await</code> æ˜¯åŸºäº <code>Promise</code> çš„<code>è¯­æ³•ç³–</code>ï¼Œä½¿å¾—å¼‚æ­¥ä»£ç çœ‹èµ·æ¥åƒåŒæ­¥ä»£ç ï¼Œå‡å°‘åµŒå¥—å’Œå¤æ‚çš„é“¾å¼è°ƒç”¨ï¼Œæé«˜äº†ä»£ç çš„å¯è¯»æ€§å’Œç»´æŠ¤æ€§ã€‚</li></ul><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">fetchData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>            <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'Data fetched'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">try</span> <span class="token punctuation">{</span>        <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetchData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// 'Data fetched'</span>    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="webworker"><a href="#webworker" class="headerlink" title="webworker"></a>webworker</h2><ol><li><p><strong>ä»€ä¹ˆæ˜¯ Web Workerï¼Ÿ</strong><br><code>Web Worker</code> æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ <code>JavaScript`` çº¿ç¨‹ï¼Œä¸ä¸»çº¿ç¨‹å¹¶è¡Œæ‰§è¡Œä»£ç ã€‚å®ƒä¸èƒ½ç›´æ¥æ“ä½œ</code>DOM<code>ï¼Œä½†å¯ä»¥é€šè¿‡æ¶ˆæ¯ä¼ é€’æœºåˆ¶ä¸ä¸»çº¿ç¨‹é€šä¿¡ã€‚</code>Web Worker<code>çš„ä¸»è¦ç”¨é€”æ˜¯åœ¨åå°è¿è¡Œé•¿æ—¶é—´è¿è¡Œçš„</code>JavaScript` ä»»åŠ¡ï¼Œä¾‹å¦‚æ•°æ®å¤„ç†ã€æ–‡ä»¶è§£æç­‰ï¼Œé¿å…åœ¨ä¸»çº¿ç¨‹ä¸Šæ‰§è¡Œè¿™äº›æ“ä½œæ—¶å‡ºç°ç•Œé¢å¡é¡¿çš„é—®é¢˜ã€‚</p></li><li><p><strong>Web Worker çš„ç‰¹æ€§</strong></p></li></ol><ul><li><p><em>ç‹¬ç«‹è¿è¡Œ</em>ï¼š<code>Web Worker</code> è¿è¡Œåœ¨æµè§ˆå™¨çš„å•ç‹¬çº¿ç¨‹ä¸­ï¼Œä¸å½±å“ä¸»çº¿ç¨‹ï¼ˆä¹Ÿå°±æ˜¯ UI çº¿ç¨‹ï¼‰çš„æ‰§è¡Œã€‚ä¸»çº¿ç¨‹è´Ÿè´£<code>å¤„ç†ç”¨æˆ·äº¤äº’</code>å’Œ <code>DOM</code> æ“ä½œï¼Œè€Œ <code>Web Worker</code> è¿è¡Œå¤æ‚è®¡ç®—ã€æ•°æ®å¤„ç†ç­‰ã€‚</p></li><li><p><em>æ— æ³•è®¿é—® DOM</em>ï¼š<code>Web Worker</code> ä¸èƒ½ç›´æ¥è®¿é—®å’Œæ“ä½œ <code>DOM</code> å…ƒç´ ï¼Œå› æ­¤å®ƒä¸é€‚åˆå¤„ç†ä¸ç”¨æˆ·ç•Œé¢ç›´æ¥ç›¸å…³çš„æ“ä½œã€‚</p></li><li><p><em>æ¶ˆæ¯ä¼ é€’</em>ï¼šä¸»çº¿ç¨‹å’Œ <code>Web Worker</code> ä¹‹é—´é€šè¿‡ <code>postMessage</code> å’Œ <code>onmessage</code> è¿›è¡Œé€šä¿¡ã€‚ä¸»çº¿ç¨‹å¯ä»¥å‘ <code>Worker</code> å‘é€æ¶ˆæ¯ï¼Œ<code>Worker</code> å¯ä»¥è¿”å›ç»“æœã€‚</p></li><li><p><em>å¼‚æ­¥æ‰§è¡Œ</em>ï¼šå› ä¸º <code>Worker</code> è¿è¡Œåœ¨ç‹¬ç«‹çš„çº¿ç¨‹ä¸­ï¼Œæ‰§è¡Œæ˜¯å¼‚æ­¥çš„ï¼Œä¸»çº¿ç¨‹ä¸ä¼šè¢«é˜»å¡ã€‚</p></li></ul><p><strong>3.1 åˆ›å»º Worker æ–‡ä»¶</strong></p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// worker.js</span>self<span class="token punctuation">.</span>onmessage <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// è·å–ä¸»çº¿ç¨‹å‘é€è¿‡æ¥çš„æ•°æ®</span>    <span class="token keyword">const</span> data <span class="token operator">=</span> event<span class="token punctuation">.</span>data<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// æ‰§è¡Œå¤æ‚çš„ä»»åŠ¡</span>    <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> data<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        result <span class="token operator">+</span><span class="token operator">=</span> i<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment" spellcheck="true">// å°†ç»“æœå‘é€å›ä¸»çº¿ç¨‹</span>    self<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>3.2 åœ¨ä¸»çº¿ç¨‹ä¸­ä½¿ç”¨ Worker</strong></p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">// main.js</span><span class="token keyword">const</span> worker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Worker</span><span class="token punctuation">(</span><span class="token string">'worker.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// å‘ Worker å‘é€æ¶ˆæ¯</span>worker<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span><span class="token number">1000000000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// æ¥æ”¶æ¥è‡ª Worker çš„ç»“æœ</span>worker<span class="token punctuation">.</span>onmessage <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Worker è®¡ç®—ç»“æœ:'</span><span class="token punctuation">,</span> event<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// å¤„ç† Worker é”™è¯¯</span>worker<span class="token punctuation">.</span>onerror <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Worker å‡ºé”™:'</span><span class="token punctuation">,</span> error<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>Web Worker å…è®¸åœ¨ä¸»çº¿ç¨‹ä¹‹å¤–è¿è¡Œ JavaScript ä»£ç ï¼Œç”¨äºå¤„ç†åå°çš„å¤æ‚è®¡ç®—ä»»åŠ¡ï¼Œé¿å…é˜»å¡ç”¨æˆ·ç•Œé¢ã€‚</li><li>é€šä¿¡æœºåˆ¶ï¼šä¸»çº¿ç¨‹å’Œ Worker é€šè¿‡ postMessage ä¼ é€’æ¶ˆæ¯ï¼Œä¸èƒ½ç›´æ¥è®¿é—® DOMã€‚</li><li>é€‚ç”¨åœºæ™¯ï¼šé€‚åˆå¤„ç†é•¿æ—¶é—´çš„è®¡ç®—ã€æ•°æ®å¤„ç†ä»»åŠ¡ï¼Œæé«˜é¡µé¢æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒ</li></ul><hr><blockquote><p><strong>æœ€åï¼Œå¦‚æœé¡¹ç›®å’Œæ•™ç¨‹å¯¹ä½ æœ‰æ‰€å¸®åŠ©æˆ–è€…ä½ çœ‹è§äº†è¿˜ç®—æ¯”è¾ƒå–œæ¬¢ï¼Œæ¬¢è¿ç»™æˆ‘<code>star</code>ï¼Œè°¢è°¢æ‚¨ï¼</strong></p></blockquote><p><strong>æŒç»­æ›´æ–°ä¸­â€¦ï¼Œå¦‚æœé‡åˆ°é—®é¢˜æ¬¢è¿è”ç³»æˆ‘ï¼Œåœ¨æ–‡ç« æœ€åè¯„è®ºåŒºã€ç•™è¨€å’Œè®¨è®ºã€‘ï¼Œå½“ç„¶ï¼Œæ¬¢è¿ç‚¹å‡»æ–‡ç« æœ€åçš„æ‰“èµæŒ‰é”®ï¼Œè¯·åšä¸»ä¸€æ¯å†°é˜”ä¹ï¼Œç¬‘ï½</strong><br><escape></escape></p><table>  <tbody><tr>    <td><img width="100" src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://sunhwee.com/medias/reward/alipay.bmp"></td>    <td><img width="100" src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://sunhwee.com/medias/reward/wechat.bmp"></td>    <td><img width="100" src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="https://sunhwee.com/medias/reward/zan.png"></td>     </tr></tbody></table><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> javaScriptå­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Github </tag>
            
            <tag> åšå®¢ </tag>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CSS</title>
      <link href="/2019/07/30/css/"/>
      <url>/2019/07/30/css/</url>
      
        <content type="html"><![CDATA[<p> <img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/CSS/1.png" alt=""></p><h2 id="ä¸€ã€CSSåŸºç¡€"><a href="#ä¸€ã€CSSåŸºç¡€" class="headerlink" title="ä¸€ã€CSSåŸºç¡€"></a>ä¸€ã€CSSåŸºç¡€</h2><h3 id="1-CSSé€‰æ‹©å™¨åŠå…¶ä¼˜å…ˆçº§"><a href="#1-CSSé€‰æ‹©å™¨åŠå…¶ä¼˜å…ˆçº§" class="headerlink" title="1. CSSé€‰æ‹©å™¨åŠå…¶ä¼˜å…ˆçº§"></a>1. CSSé€‰æ‹©å™¨åŠå…¶ä¼˜å…ˆçº§</h3><table><thead><tr><th><strong>é€‰æ‹©å™¨</strong></th><th><strong>æ ¼å¼</strong></th><th><strong>ä¼˜å…ˆçº§æƒé‡</strong></th></tr></thead><tbody><tr><td>idé€‰æ‹©å™¨</td><td>#id</td><td>100</td></tr><tr><td>ç±»é€‰æ‹©å™¨</td><td>#classname</td><td>10</td></tr><tr><td>å±æ€§é€‰æ‹©å™¨</td><td>a[ref=â€œeeeâ€]</td><td>10</td></tr><tr><td>ä¼ªç±»é€‰æ‹©å™¨</td><td>li:last-child</td><td>10</td></tr><tr><td>æ ‡ç­¾é€‰æ‹©å™¨</td><td>div</td><td>1</td></tr><tr><td>ä¼ªå…ƒç´ é€‰æ‹©å™¨</td><td>li:after</td><td>1</td></tr><tr><td>ç›¸é‚»å…„å¼Ÿé€‰æ‹©å™¨</td><td>h1+p</td><td>0</td></tr><tr><td>å­é€‰æ‹©å™¨</td><td>ul&gt;li</td><td>0</td></tr><tr><td>åä»£é€‰æ‹©å™¨</td><td>li a</td><td>0</td></tr><tr><td>é€šé…ç¬¦é€‰æ‹©å™¨</td><td>*</td><td>0</td></tr></tbody></table><p>å¯¹äºé€‰æ‹©å™¨çš„<strong>ä¼˜å…ˆçº§</strong>ï¼š</p><ul><li>æ ‡ç­¾é€‰æ‹©å™¨ã€ä¼ªå…ƒç´ é€‰æ‹©å™¨ï¼š1</li><li>ç±»é€‰æ‹©å™¨ã€ä¼ªç±»é€‰æ‹©å™¨ã€å±æ€§é€‰æ‹©å™¨ï¼š10</li><li>id é€‰æ‹©å™¨ï¼š100</li><li>å†…è”æ ·å¼ï¼š1000</li></ul><p><strong>æ³¨æ„äº‹é¡¹ï¼š</strong></p><ul><li>!importantå£°æ˜çš„æ ·å¼çš„ä¼˜å…ˆçº§æœ€é«˜ï¼›</li><li>å¦‚æœä¼˜å…ˆçº§ç›¸åŒï¼Œåˆ™æœ€åå‡ºç°çš„æ ·å¼ç”Ÿæ•ˆï¼›</li><li>ç»§æ‰¿å¾—åˆ°çš„æ ·å¼çš„ä¼˜å…ˆçº§æœ€ä½ï¼›</li><li>é€šç”¨é€‰æ‹©å™¨ï¼ˆ*ï¼‰ã€å­é€‰æ‹©å™¨ï¼ˆ&gt;ï¼‰å’Œç›¸é‚»åŒèƒé€‰æ‹©å™¨ï¼ˆ+ï¼‰å¹¶ä¸åœ¨è¿™å››ä¸ªç­‰çº§ä¸­ï¼Œæ‰€ä»¥å®ƒä»¬çš„æƒå€¼éƒ½ä¸º 0 ï¼›</li><li>æ ·å¼è¡¨çš„æ¥æºä¸åŒæ—¶ï¼Œä¼˜å…ˆçº§é¡ºåºä¸ºï¼šå†…è”æ ·å¼ &gt; å†…éƒ¨æ ·å¼ &gt; å¤–éƒ¨æ ·å¼ &gt; æµè§ˆå™¨ç”¨æˆ·è‡ªå®šä¹‰æ ·å¼ &gt; æµè§ˆå™¨é»˜è®¤æ ·å¼ã€‚</li></ul><h3 id="2-CSSä¸­å¯ç»§æ‰¿ä¸ä¸å¯ç»§æ‰¿å±æ€§æœ‰å“ªäº›"><a href="#2-CSSä¸­å¯ç»§æ‰¿ä¸ä¸å¯ç»§æ‰¿å±æ€§æœ‰å“ªäº›" class="headerlink" title="2. CSSä¸­å¯ç»§æ‰¿ä¸ä¸å¯ç»§æ‰¿å±æ€§æœ‰å“ªäº›"></a>2. CSSä¸­å¯ç»§æ‰¿ä¸ä¸å¯ç»§æ‰¿å±æ€§æœ‰å“ªäº›</h3><p><strong>ä¸€ã€æ— ç»§æ‰¿æ€§çš„å±æ€§</strong></p><ol><li><strong>display</strong>ï¼šè§„å®šå…ƒç´ åº”è¯¥ç”Ÿæˆçš„æ¡†çš„ç±»å‹</li><li><strong>æ–‡æœ¬å±æ€§</strong>ï¼š</li></ol><ul><li>vertical-alignï¼šå‚ç›´æ–‡æœ¬å¯¹é½</li><li>text-decorationï¼šè§„å®šæ·»åŠ åˆ°æ–‡æœ¬çš„è£…é¥°</li><li>text-shadowï¼šæ–‡æœ¬é˜´å½±æ•ˆæœ</li><li>white-spaceï¼šç©ºç™½ç¬¦çš„å¤„ç†</li><li>unicode-bidiï¼šè®¾ç½®æ–‡æœ¬çš„æ–¹å‘</li></ul><ol start="3"><li><strong>ç›’å­æ¨¡å‹çš„å±æ€§</strong>ï¼šwidthã€heightã€marginã€borderã€padding</li><li><strong>èƒŒæ™¯å±æ€§</strong>ï¼šbackgroundã€background-colorã€background-imageã€background-repeatã€background-positionã€background-attachment</li><li><strong>å®šä½å±æ€§</strong>ï¼šfloatã€clearã€positionã€topã€rightã€bottomã€leftã€min-widthã€min-heightã€max-widthã€max-heightã€overflowã€clipã€z-index</li><li><strong>ç”Ÿæˆå†…å®¹å±æ€§</strong>ï¼šcontentã€counter-resetã€counter-increment</li><li><strong>è½®å»“æ ·å¼å±æ€§</strong>ï¼šoutline-styleã€outline-widthã€outline-colorã€outline</li><li><strong>é¡µé¢æ ·å¼å±æ€§</strong>ï¼šsizeã€page-break-beforeã€page-break-after</li><li><strong>å£°éŸ³æ ·å¼å±æ€§</strong>ï¼špause-beforeã€pause-afterã€pauseã€cue-beforeã€cue-afterã€cueã€play-during</li></ol><p><strong>äºŒã€æœ‰ç»§æ‰¿æ€§çš„å±æ€§</strong></p><ol><li><strong>å­—ä½“ç³»åˆ—å±æ€§</strong></li></ol><ul><li>font-familyï¼šå­—ä½“ç³»åˆ—</li><li>font-weightï¼šå­—ä½“çš„ç²—ç»†</li><li>font-sizeï¼šå­—ä½“çš„å¤§å°</li><li>font-styleï¼šå­—ä½“çš„é£æ ¼</li></ul><ol start="2"><li><strong>æ–‡æœ¬ç³»åˆ—å±æ€§</strong></li></ol><ul><li>text-indentï¼šæ–‡æœ¬ç¼©è¿›</li><li>text-alignï¼šæ–‡æœ¬æ°´å¹³å¯¹é½</li><li>line-heightï¼šè¡Œé«˜</li><li>word-spacingï¼šå•è¯ä¹‹é—´çš„é—´è·</li><li>letter-spacingï¼šä¸­æ–‡æˆ–è€…å­—æ¯ä¹‹é—´çš„é—´è·</li><li>text-transformï¼šæ§åˆ¶æ–‡æœ¬å¤§å°å†™ï¼ˆå°±æ˜¯uppercaseã€lowercaseã€capitalizeè¿™ä¸‰ä¸ªï¼‰</li><li>colorï¼šæ–‡æœ¬é¢œè‰²</li></ul><ol start="3"><li><strong>å…ƒç´ å¯è§æ€§</strong></li></ol><ul><li>visibilityï¼šæ§åˆ¶å…ƒç´ æ˜¾ç¤ºéšè—</li></ul><ol start="4"><li><strong>åˆ—è¡¨å¸ƒå±€å±æ€§</strong></li></ol><ul><li>list-styleï¼šåˆ—è¡¨é£æ ¼ï¼ŒåŒ…æ‹¬list-style-typeã€list-style-imageç­‰</li></ul><ol start="5"><li><strong>å…‰æ ‡å±æ€§</strong></li></ol><ul><li>cursorï¼šå…‰æ ‡æ˜¾ç¤ºä¸ºä½•ç§å½¢æ€</li></ul><h3 id="3-displayçš„å±æ€§å€¼åŠå…¶ä½œç”¨"><a href="#3-displayçš„å±æ€§å€¼åŠå…¶ä½œç”¨" class="headerlink" title="3. displayçš„å±æ€§å€¼åŠå…¶ä½œç”¨"></a>3. displayçš„å±æ€§å€¼åŠå…¶ä½œç”¨</h3><table><thead><tr><th><strong>å±æ€§å€¼</strong></th><th><strong>ä½œç”¨</strong></th></tr></thead><tbody><tr><td>none</td><td>å…ƒç´ ä¸æ˜¾ç¤ºï¼Œå¹¶ä¸”ä¼šä»æ–‡æ¡£æµä¸­ç§»é™¤ã€‚</td></tr><tr><td>block</td><td>å—ç±»å‹ã€‚é»˜è®¤å®½åº¦ä¸ºçˆ¶å…ƒç´ å®½åº¦ï¼Œå¯è®¾ç½®å®½é«˜ï¼Œæ¢è¡Œæ˜¾ç¤ºã€‚</td></tr><tr><td>inline</td><td>è¡Œå†…å…ƒç´ ç±»å‹ã€‚é»˜è®¤å®½åº¦ä¸ºå†…å®¹å®½åº¦ï¼Œä¸å¯è®¾ç½®å®½é«˜ï¼ŒåŒè¡Œæ˜¾ç¤ºã€‚</td></tr><tr><td>inline-block</td><td>é»˜è®¤å®½åº¦ä¸ºå†…å®¹å®½åº¦ï¼Œå¯ä»¥è®¾ç½®å®½é«˜ï¼ŒåŒè¡Œæ˜¾ç¤ºã€‚</td></tr><tr><td>list-item</td><td>åƒå—ç±»å‹å…ƒç´ ä¸€æ ·æ˜¾ç¤ºï¼Œå¹¶æ·»åŠ æ ·å¼åˆ—è¡¨æ ‡è®°ã€‚</td></tr><tr><td>table</td><td>æ­¤å…ƒç´ ä¼šä½œä¸ºå—çº§è¡¨æ ¼æ¥æ˜¾ç¤ºã€‚</td></tr><tr><td>inherit</td><td>è§„å®šåº”è¯¥ä»çˆ¶å…ƒç´ ç»§æ‰¿displayå±æ€§çš„å€¼ã€‚</td></tr></tbody></table><h3 id="4-displayçš„blockã€inlineå’Œinline-blockçš„åŒºåˆ«"><a href="#4-displayçš„blockã€inlineå’Œinline-blockçš„åŒºåˆ«" class="headerlink" title="4. displayçš„blockã€inlineå’Œinline-blockçš„åŒºåˆ«"></a>4. displayçš„blockã€inlineå’Œinline-blockçš„åŒºåˆ«</h3><p>ï¼ˆ1ï¼‰<strong>blockï¼š</strong> ä¼šç‹¬å ä¸€è¡Œï¼Œå¤šä¸ªå…ƒç´ ä¼šå¦èµ·ä¸€è¡Œï¼Œå¯ä»¥è®¾ç½®widthã€heightã€marginå’Œpaddingå±æ€§ï¼›</p><p>ï¼ˆ2ï¼‰<strong>inlineï¼š</strong> å…ƒç´ ä¸ä¼šç‹¬å ä¸€è¡Œï¼Œè®¾ç½®widthã€heightå±æ€§æ— æ•ˆã€‚ä½†å¯ä»¥è®¾ç½®æ°´å¹³æ–¹å‘çš„marginå’Œpaddingå±æ€§ï¼Œä¸èƒ½è®¾ç½®å‚ç›´æ–¹å‘çš„paddingå’Œmarginï¼›</p><p>ï¼ˆ3ï¼‰<strong>inline-blockï¼š</strong> å°†å¯¹è±¡è®¾ç½®ä¸ºinlineå¯¹è±¡ï¼Œä½†å¯¹è±¡çš„å†…å®¹ä½œä¸ºblockå¯¹è±¡å‘ˆç°ï¼Œä¹‹åçš„å†…è”å¯¹è±¡ä¼šè¢«æ’åˆ—åœ¨åŒä¸€è¡Œå†…ã€‚</p><p>å¯¹äºè¡Œå†…å…ƒç´ å’Œå—çº§å…ƒç´ ï¼Œå…¶ç‰¹ç‚¹å¦‚ä¸‹ï¼š</p><p><strong>ï¼ˆ1ï¼‰è¡Œå†…å…ƒç´ </strong></p><ul><li>è®¾ç½®å®½é«˜æ— æ•ˆï¼›</li><li>å¯ä»¥è®¾ç½®æ°´å¹³æ–¹å‘çš„marginå’Œpaddingå±æ€§ï¼Œä¸èƒ½è®¾ç½®å‚ç›´æ–¹å‘çš„paddingå’Œmarginï¼›</li><li>ä¸ä¼šè‡ªåŠ¨æ¢è¡Œï¼›</li></ul><p><strong>ï¼ˆ2ï¼‰å—çº§å…ƒç´ </strong></p><ul><li>å¯ä»¥è®¾ç½®å®½é«˜ï¼›</li><li>è®¾ç½®marginå’Œpaddingéƒ½æœ‰æ•ˆï¼›</li><li>å¯ä»¥è‡ªåŠ¨æ¢è¡Œï¼›</li><li>å¤šä¸ªå—çŠ¶ï¼Œé»˜è®¤æ’åˆ—ä»ä¸Šåˆ°ä¸‹ã€‚</li></ul><h3 id="5-éšè—å…ƒç´ çš„æ–¹æ³•æœ‰å“ªäº›"><a href="#5-éšè—å…ƒç´ çš„æ–¹æ³•æœ‰å“ªäº›" class="headerlink" title="5. éšè—å…ƒç´ çš„æ–¹æ³•æœ‰å“ªäº›"></a>5. éšè—å…ƒç´ çš„æ–¹æ³•æœ‰å“ªäº›</h3><ul><li><strong>display: none</strong>ï¼šæ¸²æŸ“æ ‘ä¸ä¼šåŒ…å«è¯¥æ¸²æŸ“å¯¹è±¡ï¼Œå› æ­¤è¯¥å…ƒç´ ä¸ä¼šåœ¨é¡µé¢ä¸­å æ®ä½ç½®ï¼Œä¹Ÿä¸ä¼šå“åº”ç»‘å®šçš„ç›‘å¬äº‹ä»¶ã€‚</li><li><strong>visibility: hidden</strong>ï¼šå…ƒç´ åœ¨é¡µé¢ä¸­ä»å æ®ç©ºé—´ï¼Œä½†æ˜¯ä¸ä¼šå“åº”ç»‘å®šçš„ç›‘å¬äº‹ä»¶ã€‚</li><li><strong>opacity: 0</strong>ï¼šå°†å…ƒç´ çš„é€æ˜åº¦è®¾ç½®ä¸º 0ï¼Œä»¥æ­¤æ¥å®ç°å…ƒç´ çš„éšè—ã€‚å…ƒç´ åœ¨é¡µé¢ä¸­ä»ç„¶å æ®ç©ºé—´ï¼Œå¹¶ä¸”èƒ½å¤Ÿå“åº”å…ƒç´ ç»‘å®šçš„ç›‘å¬äº‹ä»¶ã€‚</li><li><strong>position: absolute</strong>ï¼šé€šè¿‡ä½¿ç”¨ç»å¯¹å®šä½å°†å…ƒç´ ç§»é™¤å¯è§†åŒºåŸŸå†…ï¼Œä»¥æ­¤æ¥å®ç°å…ƒç´ çš„éšè—ã€‚</li><li><strong>z-index: è´Ÿå€¼</strong>ï¼šæ¥ä½¿å…¶ä»–å…ƒç´ é®ç›–ä½è¯¥å…ƒç´ ï¼Œä»¥æ­¤æ¥å®ç°éšè—ã€‚</li><li><strong>clip/clip-path</strong> ï¼šä½¿ç”¨å…ƒç´ è£å‰ªçš„æ–¹æ³•æ¥å®ç°å…ƒç´ çš„éšè—ï¼Œè¿™ç§æ–¹æ³•ä¸‹ï¼Œå…ƒç´ ä»åœ¨é¡µé¢ä¸­å æ®ä½ç½®ï¼Œä½†æ˜¯ä¸ä¼šå“åº”ç»‘å®šçš„ç›‘å¬äº‹ä»¶ã€‚</li><li><strong>transform: scale(0,0)</strong>ï¼šå°†å…ƒç´ ç¼©æ”¾ä¸º 0ï¼Œæ¥å®ç°å…ƒç´ çš„éšè—ã€‚è¿™ç§æ–¹æ³•ä¸‹ï¼Œå…ƒç´ ä»åœ¨é¡µé¢ä¸­å æ®ä½ç½®ï¼Œä½†æ˜¯ä¸ä¼šå“åº”ç»‘å®šçš„ç›‘å¬äº‹ä»¶ã€‚</li></ul><h3 id="6-linkå’Œ-importçš„åŒºåˆ«"><a href="#6-linkå’Œ-importçš„åŒºåˆ«" class="headerlink" title="6. linkå’Œ@importçš„åŒºåˆ«"></a>6. linkå’Œ@importçš„åŒºåˆ«</h3><p>ä¸¤è€…éƒ½æ˜¯å¤–éƒ¨å¼•ç”¨CSSçš„æ–¹å¼ï¼Œå®ƒä»¬çš„åŒºåˆ«å¦‚ä¸‹ï¼š</p><ul><li>linkæ˜¯XHTMLæ ‡ç­¾ï¼Œé™¤äº†åŠ è½½CSSå¤–ï¼Œè¿˜å¯ä»¥å®šä¹‰RSSç­‰å…¶ä»–äº‹åŠ¡ï¼›@importå±äºCSSèŒƒç•´ï¼Œåªèƒ½åŠ è½½CSSã€‚</li><li>linkå¼•ç”¨CSSæ—¶ï¼Œåœ¨é¡µé¢è½½å…¥æ—¶åŒæ—¶åŠ è½½ï¼›@importéœ€è¦é¡µé¢ç½‘é¡µå®Œå…¨è½½å…¥ä»¥ååŠ è½½ã€‚</li><li>linkæ˜¯XHTMLæ ‡ç­¾ï¼Œæ— å…¼å®¹é—®é¢˜ï¼›@importæ˜¯åœ¨CSS2.1æå‡ºçš„ï¼Œä½ç‰ˆæœ¬çš„æµè§ˆå™¨ä¸æ”¯æŒã€‚</li><li>linkæ”¯æŒä½¿ç”¨Javascriptæ§åˆ¶DOMå»æ”¹å˜æ ·å¼ï¼›è€Œ@importä¸æ”¯æŒã€‚</li></ul><h3 id="7-transitionå’Œanimationçš„åŒºåˆ«"><a href="#7-transitionå’Œanimationçš„åŒºåˆ«" class="headerlink" title="7. transitionå’Œanimationçš„åŒºåˆ«"></a>7. transitionå’Œanimationçš„åŒºåˆ«</h3><ul><li><strong>transitionæ˜¯è¿‡åº¦å±æ€§</strong>ï¼Œå¼ºè°ƒè¿‡åº¦ï¼Œå®ƒçš„å®ç°éœ€è¦è§¦å‘ä¸€ä¸ªäº‹ä»¶ï¼ˆæ¯”å¦‚é¼ æ ‡ç§»åŠ¨ä¸Šå»ï¼Œç„¦ç‚¹ï¼Œç‚¹å‡»ç­‰ï¼‰æ‰æ‰§è¡ŒåŠ¨ç”»ã€‚å®ƒç±»ä¼¼äºflashçš„è¡¥é—´åŠ¨ç”»ï¼Œè®¾ç½®ä¸€ä¸ªå¼€å§‹å…³é”®å¸§ï¼Œä¸€ä¸ªç»“æŸå…³é”®å¸§ã€‚</li><li><strong>animationæ˜¯åŠ¨ç”»å±æ€§</strong>ï¼Œå®ƒçš„å®ç°ä¸éœ€è¦è§¦å‘äº‹ä»¶ï¼Œè®¾å®šå¥½æ—¶é—´ä¹‹åå¯ä»¥è‡ªå·±æ‰§è¡Œï¼Œä¸”å¯ä»¥å¾ªç¯ä¸€ä¸ªåŠ¨ç”»ã€‚å®ƒä¹Ÿç±»ä¼¼äºflashçš„è¡¥é—´åŠ¨ç”»ï¼Œä½†æ˜¯å®ƒå¯ä»¥è®¾ç½®å¤šä¸ªå…³é”®å¸§ï¼ˆç”¨@keyframeå®šä¹‰ï¼‰å®ŒæˆåŠ¨ç”»ã€‚</li></ul><h3 id="8-display-noneä¸visibility-hiddençš„åŒºåˆ«"><a href="#8-display-noneä¸visibility-hiddençš„åŒºåˆ«" class="headerlink" title="8. display:noneä¸visibility:hiddençš„åŒºåˆ«"></a>8. display:noneä¸visibility:hiddençš„åŒºåˆ«</h3><p>è¿™ä¸¤ä¸ªå±æ€§éƒ½æ˜¯è®©å…ƒç´ éšè—ï¼Œä¸å¯è§ã€‚<strong>ä¸¤è€…åŒºåˆ«å¦‚ä¸‹ï¼š</strong></p><p>ï¼ˆ1ï¼‰<strong>åœ¨æ¸²æŸ“æ ‘ä¸­</strong></p><ul><li><code>display:none</code>ä¼šè®©å…ƒç´ å®Œå…¨ä»æ¸²æŸ“æ ‘ä¸­æ¶ˆå¤±ï¼Œæ¸²æŸ“æ—¶ä¸ä¼šå æ®ä»»ä½•ç©ºé—´ï¼›</li><li><code>visibility:hidden</code>ä¸ä¼šè®©å…ƒç´ ä»æ¸²æŸ“æ ‘ä¸­æ¶ˆå¤±ï¼Œæ¸²æŸ“çš„å…ƒç´ è¿˜ä¼šå æ®ç›¸åº”çš„ç©ºé—´ï¼Œåªæ˜¯å†…å®¹ä¸å¯è§ã€‚</li></ul><p>ï¼ˆ2ï¼‰<strong>æ˜¯å¦æ˜¯ç»§æ‰¿å±æ€§</strong></p><ul><li><code>display:none</code>æ˜¯éç»§æ‰¿å±æ€§ï¼Œå­å­™èŠ‚ç‚¹ä¼šéšç€çˆ¶èŠ‚ç‚¹ä»æ¸²æŸ“æ ‘æ¶ˆå¤±ï¼Œé€šè¿‡ä¿®æ”¹å­å­™èŠ‚ç‚¹çš„å±æ€§ä¹Ÿæ— æ³•æ˜¾ç¤ºï¼›</li><li><code>visibility:hidden</code>æ˜¯ç»§æ‰¿å±æ€§ï¼Œå­å­™èŠ‚ç‚¹æ¶ˆå¤±æ˜¯ç”±äºç»§æ‰¿äº†<code>hidden</code>ï¼Œé€šè¿‡è®¾ç½®<code>visibility:visible</code>å¯ä»¥è®©å­å­™èŠ‚ç‚¹æ˜¾ç¤ºï¼›<br>ï¼ˆ3ï¼‰ä¿®æ”¹å¸¸è§„æ–‡æ¡£æµä¸­å…ƒç´ çš„ <code>display</code> é€šå¸¸ä¼šé€ æˆæ–‡æ¡£çš„é‡æ’ï¼Œä½†æ˜¯ä¿®æ”¹<code>visibility</code>å±æ€§åªä¼šé€ æˆæœ¬å…ƒç´ çš„é‡ç»˜ï¼›</li></ul><p>ï¼ˆ4ï¼‰å¦‚æœä½¿ç”¨è¯»å±å™¨ï¼Œè®¾ç½®ä¸º<code>display:none</code>çš„å†…å®¹ä¸ä¼šè¢«è¯»å–ï¼Œè®¾ç½®ä¸º<code>visibility:hidden</code>çš„å†…å®¹ä¼šè¢«è¯»å–ã€‚</p><h3 id="9-ä¼ªå…ƒç´ å’Œä¼ªç±»çš„åŒºåˆ«å’Œä½œç”¨ï¼Ÿ"><a href="#9-ä¼ªå…ƒç´ å’Œä¼ªç±»çš„åŒºåˆ«å’Œä½œç”¨ï¼Ÿ" class="headerlink" title="9. ä¼ªå…ƒç´ å’Œä¼ªç±»çš„åŒºåˆ«å’Œä½œç”¨ï¼Ÿ"></a>9. <strong>ä¼ªå…ƒç´ å’Œä¼ªç±»çš„åŒºåˆ«å’Œä½œç”¨ï¼Ÿ</strong></h3><ul><li>ä¼ªå…ƒç´ ï¼šåœ¨å†…å®¹å…ƒç´ çš„å‰åæ’å…¥é¢å¤–çš„å…ƒç´ æˆ–æ ·å¼ï¼Œä½†æ˜¯è¿™äº›å…ƒç´ å®é™…ä¸Šå¹¶ä¸åœ¨æ–‡æ¡£ä¸­ç”Ÿæˆã€‚å®ƒä»¬åªåœ¨å¤–éƒ¨æ˜¾ç¤ºå¯è§ï¼Œä½†ä¸ä¼šåœ¨æ–‡æ¡£çš„æºä»£ç ä¸­æ‰¾åˆ°å®ƒä»¬ï¼Œå› æ­¤ï¼Œç§°ä¸ºâ€œä¼ªâ€å…ƒç´ ã€‚ä¾‹å¦‚ï¼š</li></ul><pre class="line-numbers language-css"><code class="language-css"><span class="token selector">p<span class="token pseudo-element">::before</span> </span><span class="token punctuation">{</span><span class="token property">content</span><span class="token punctuation">:</span><span class="token string">"ç¬¬ä¸€ç« ï¼š"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector">p<span class="token pseudo-element">::after</span> </span><span class="token punctuation">{</span><span class="token property">content</span><span class="token punctuation">:</span><span class="token string">"Hot!"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector">p<span class="token pseudo-element">::first-line</span> </span><span class="token punctuation">{</span><span class="token property">background</span><span class="token punctuation">:</span>red<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector">p<span class="token pseudo-element">::first-letter</span> </span><span class="token punctuation">{</span><span class="token property">font-size</span><span class="token punctuation">:</span><span class="token number">30</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><ul><li>ä¼ªç±»ï¼šå°†ç‰¹æ®Šçš„æ•ˆæœæ·»åŠ åˆ°ç‰¹å®šé€‰æ‹©å™¨ä¸Šã€‚å®ƒæ˜¯å·²æœ‰å…ƒç´ ä¸Šæ·»åŠ ç±»åˆ«çš„ï¼Œä¸ä¼šäº§ç”Ÿæ–°çš„å…ƒç´ ã€‚ä¾‹å¦‚ï¼š</li></ul><pre class="line-numbers language-css"><code class="language-css"><span class="token selector">a<span class="token pseudo-class">:hover</span> </span><span class="token punctuation">{</span><span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#FF00FF</span><span class="token punctuation">}</span><span class="token selector">p<span class="token pseudo-class">:first-child</span> </span><span class="token punctuation">{</span><span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><strong>æ€»ç»“ï¼š</strong> ä¼ªç±»æ˜¯é€šè¿‡åœ¨å…ƒç´ é€‰æ‹©å™¨ä¸ŠåŠ â¼Šä¼ªç±»æ”¹å˜å…ƒç´ çŠ¶æ€ï¼Œâ½½ä¼ªå…ƒç´ é€šè¿‡å¯¹å…ƒç´ çš„æ“ä½œè¿›â¾å¯¹å…ƒç´ çš„æ”¹å˜ã€‚ </p><h3 id="10-å¯¹requestAnimationframeçš„ç†è§£"><a href="#10-å¯¹requestAnimationframeçš„ç†è§£" class="headerlink" title="10. å¯¹requestAnimationframeçš„ç†è§£"></a>10. å¯¹requestAnimationframeçš„ç†è§£</h3><p>å®ç°åŠ¨ç”»æ•ˆæœçš„æ–¹æ³•æ¯”è¾ƒå¤šï¼ŒJavascript ä¸­å¯ä»¥é€šè¿‡å®šæ—¶å™¨ setTimeout æ¥å®ç°ï¼ŒCSS3 ä¸­å¯ä»¥ä½¿ç”¨ transition å’Œ animation æ¥å®ç°ï¼ŒHTML5 ä¸­çš„ canvas ä¹Ÿå¯ä»¥å®ç°ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒHTML5 æä¾›ä¸€ä¸ªä¸“é—¨ç”¨äºè¯·æ±‚åŠ¨ç”»çš„APIï¼Œé‚£å°±æ˜¯ requestAnimationFrameï¼Œé¡¾åæ€ä¹‰å°±æ˜¯<strong>è¯·æ±‚åŠ¨ç”»å¸§</strong>ã€‚</p><p>MDNå¯¹è¯¥æ–¹æ³•çš„æè¿°ï¼š</p><blockquote><p>window.requestAnimationFrame() å‘Šè¯‰æµè§ˆå™¨â€”â€”ä½ å¸Œæœ›æ‰§è¡Œä¸€ä¸ªåŠ¨ç”»ï¼Œå¹¶ä¸”è¦æ±‚æµè§ˆå™¨åœ¨ä¸‹æ¬¡é‡ç»˜ä¹‹å‰è°ƒç”¨æŒ‡å®šçš„å›è°ƒå‡½æ•°æ›´æ–°åŠ¨ç”»ã€‚è¯¥æ–¹æ³•éœ€è¦ä¼ å…¥ä¸€ä¸ªå›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¯¥å›è°ƒå‡½æ•°ä¼šåœ¨æµè§ˆå™¨ä¸‹ä¸€æ¬¡é‡ç»˜ä¹‹å‰æ‰§è¡Œã€‚</p></blockquote><p><strong>è¯­æ³•ï¼š</strong> <code>window.requestAnimationFrame(callback);</code>  å…¶ä¸­ï¼Œcallbackæ˜¯<strong>ä¸‹ä¸€æ¬¡é‡ç»˜ä¹‹å‰æ›´æ–°åŠ¨ç”»å¸§æ‰€è°ƒç”¨çš„å‡½æ•°</strong>(å³ä¸Šé¢æ‰€è¯´çš„å›è°ƒå‡½æ•°)ã€‚è¯¥å›è°ƒå‡½æ•°ä¼šè¢«ä¼ å…¥DOMHighResTimeStampå‚æ•°ï¼Œå®ƒè¡¨ç¤ºrequestAnimationFrame() å¼€å§‹å»æ‰§è¡Œå›è°ƒå‡½æ•°çš„æ—¶åˆ»ã€‚è¯¥æ–¹æ³•å±äº<strong>å®ä»»åŠ¡</strong>ï¼Œæ‰€ä»¥ä¼šåœ¨æ‰§è¡Œå®Œå¾®ä»»åŠ¡ä¹‹åå†å»æ‰§è¡Œã€‚</p><p><strong>å–æ¶ˆåŠ¨ç”»ï¼š</strong> ä½¿ç”¨cancelAnimationFrame()æ¥å–æ¶ˆæ‰§è¡ŒåŠ¨ç”»ï¼Œè¯¥æ–¹æ³•æ¥æ”¶ä¸€ä¸ªå‚æ•°â€”â€”requestAnimationFrameé»˜è®¤è¿”å›çš„idï¼Œåªéœ€è¦ä¼ å…¥è¿™ä¸ªidå°±å¯ä»¥å–æ¶ˆåŠ¨ç”»äº†ã€‚</p><p><strong>ä¼˜åŠ¿ï¼š</strong></p><ul><li><strong>CPUèŠ‚èƒ½</strong>ï¼šä½¿ç”¨SetTinterval å®ç°çš„åŠ¨ç”»ï¼Œå½“é¡µé¢è¢«éšè—æˆ–æœ€å°åŒ–æ—¶ï¼ŒSetTinterval ä»ç„¶åœ¨åå°æ‰§è¡ŒåŠ¨ç”»ä»»åŠ¡ï¼Œç”±äºæ­¤æ—¶é¡µé¢å¤„äºä¸å¯è§æˆ–ä¸å¯ç”¨çŠ¶æ€ï¼Œåˆ·æ–°åŠ¨ç”»æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œå®Œå…¨æ˜¯æµªè´¹CPUèµ„æºã€‚è€ŒRequestAnimationFrameåˆ™å®Œå…¨ä¸åŒï¼Œå½“é¡µé¢å¤„ç†æœªæ¿€æ´»çš„çŠ¶æ€ä¸‹ï¼Œè¯¥é¡µé¢çš„å±å¹•åˆ·æ–°ä»»åŠ¡ä¹Ÿä¼šè¢«ç³»ç»Ÿæš‚åœï¼Œå› æ­¤è·Ÿç€ç³»ç»Ÿèµ°çš„RequestAnimationFrameä¹Ÿä¼šåœæ­¢æ¸²æŸ“ï¼Œå½“é¡µé¢è¢«æ¿€æ´»æ—¶ï¼ŒåŠ¨ç”»å°±ä»ä¸Šæ¬¡åœç•™çš„åœ°æ–¹ç»§ç»­æ‰§è¡Œï¼Œæœ‰æ•ˆèŠ‚çœäº†CPUå¼€é”€ã€‚</li><li><strong>å‡½æ•°èŠ‚æµ</strong>ï¼šåœ¨é«˜é¢‘ç‡äº‹ä»¶( resize, scroll ç­‰)ä¸­ï¼Œä¸ºäº†é˜²æ­¢åœ¨ä¸€ä¸ªåˆ·æ–°é—´éš”å†…å‘ç”Ÿå¤šæ¬¡å‡½æ•°æ‰§è¡Œï¼ŒRequestAnimationFrameå¯ä¿è¯æ¯ä¸ªåˆ·æ–°é—´éš”å†…ï¼Œå‡½æ•°åªè¢«æ‰§è¡Œä¸€æ¬¡ï¼Œè¿™æ ·æ—¢èƒ½ä¿è¯æµç•…æ€§ï¼Œä¹Ÿèƒ½æ›´å¥½çš„èŠ‚çœå‡½æ•°æ‰§è¡Œçš„å¼€é”€ï¼Œä¸€ä¸ªåˆ·æ–°é—´éš”å†…å‡½æ•°æ‰§è¡Œå¤šæ¬¡æ—¶æ²¡æœ‰æ„ä¹‰çš„ï¼Œå› ä¸ºå¤šæ•°æ˜¾ç¤ºå™¨æ¯16.7msåˆ·æ–°ä¸€æ¬¡ï¼Œå¤šæ¬¡ç»˜åˆ¶å¹¶ä¸ä¼šåœ¨å±å¹•ä¸Šä½“ç°å‡ºæ¥ã€‚</li><li><strong>å‡å°‘DOMæ“ä½œ</strong>ï¼šrequestAnimationFrame ä¼šæŠŠæ¯ä¸€å¸§ä¸­çš„æ‰€æœ‰DOMæ“ä½œé›†ä¸­èµ·æ¥ï¼Œåœ¨ä¸€æ¬¡é‡ç»˜æˆ–å›æµä¸­å°±å®Œæˆï¼Œå¹¶ä¸”é‡ç»˜æˆ–å›æµçš„æ—¶é—´é—´éš”ç´§ç´§è·Ÿéšæµè§ˆå™¨çš„åˆ·æ–°é¢‘ç‡ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œè¿™ä¸ªé¢‘ç‡ä¸ºæ¯ç§’60å¸§ã€‚</li></ul><p><strong>setTimeoutæ‰§è¡ŒåŠ¨ç”»çš„ç¼ºç‚¹</strong>ï¼šå®ƒé€šè¿‡è®¾å®šé—´éš”æ—¶é—´æ¥ä¸æ–­æ”¹å˜å›¾åƒä½ç½®ï¼Œè¾¾åˆ°åŠ¨ç”»æ•ˆæœã€‚ä½†æ˜¯å®¹æ˜“å‡ºç°å¡é¡¿ã€æŠ–åŠ¨çš„ç°è±¡ï¼›åŸå› æ˜¯ï¼š</p><ul><li>settimeoutä»»åŠ¡è¢«æ”¾å…¥å¼‚æ­¥é˜Ÿåˆ—ï¼Œåªæœ‰å½“ä¸»çº¿ç¨‹ä»»åŠ¡æ‰§è¡Œå®Œåæ‰ä¼šæ‰§è¡Œé˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼Œå› æ­¤å®é™…æ‰§è¡Œæ—¶é—´æ€»æ˜¯æ¯”è®¾å®šæ—¶é—´è¦æ™šï¼›</li><li>settimeoutçš„å›ºå®šæ—¶é—´é—´éš”ä¸ä¸€å®šä¸å±å¹•åˆ·æ–°é—´éš”æ—¶é—´ç›¸åŒï¼Œä¼šå¼•èµ·ä¸¢å¸§ã€‚</li></ul><h3 id="11-å¯¹ç›’æ¨¡å‹çš„ç†è§£"><a href="#11-å¯¹ç›’æ¨¡å‹çš„ç†è§£" class="headerlink" title="11. å¯¹ç›’æ¨¡å‹çš„ç†è§£"></a>11. å¯¹ç›’æ¨¡å‹çš„ç†è§£</h3><p>CSS3ä¸­çš„ç›’æ¨¡å‹æœ‰ä»¥ä¸‹ä¸¤ç§ï¼šæ ‡å‡†ç›’å­æ¨¡å‹ã€IEç›’å­æ¨¡å‹<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/CSS/2.png" alt=""><br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/CSS/3.png" alt=""><br>ç›’æ¨¡å‹éƒ½æ˜¯ç”±å››ä¸ªéƒ¨åˆ†ç»„æˆçš„ï¼Œåˆ†åˆ«æ˜¯marginã€borderã€paddingå’Œcontentã€‚</p><p>æ ‡å‡†ç›’æ¨¡å‹å’ŒIEç›’æ¨¡å‹çš„åŒºåˆ«åœ¨äºè®¾ç½®widthå’Œheightæ—¶ï¼Œæ‰€å¯¹åº”çš„èŒƒå›´ä¸åŒï¼š</p><ul><li>æ ‡å‡†ç›’æ¨¡å‹çš„widthå’Œheightå±æ€§çš„èŒƒå›´åªåŒ…å«äº†contentï¼Œ</li><li>IEç›’æ¨¡å‹çš„widthå’Œheightå±æ€§çš„èŒƒå›´åŒ…å«äº†borderã€paddingå’Œcontentã€‚</li></ul><p>å¯ä»¥é€šè¿‡ä¿®æ”¹å…ƒç´ çš„box-sizingå±æ€§æ¥æ”¹å˜å…ƒç´ çš„ç›’æ¨¡å‹ï¼š</p><ul><li><code>box-sizeing: content-box</code>è¡¨ç¤ºæ ‡å‡†ç›’æ¨¡å‹ï¼ˆé»˜è®¤å€¼ï¼‰</li><li><code>box-sizeing: border-box</code>è¡¨ç¤ºIEç›’æ¨¡å‹ï¼ˆæ€ªå¼‚ç›’æ¨¡å‹ï¼‰</li></ul><h3 id="12-ä¸ºä»€ä¹ˆæœ‰æ—¶å€™â½¤translateæ¥æ”¹å˜ä½ç½®â½½ä¸æ˜¯å®šä½ï¼Ÿ"><a href="#12-ä¸ºä»€ä¹ˆæœ‰æ—¶å€™â½¤translateæ¥æ”¹å˜ä½ç½®â½½ä¸æ˜¯å®šä½ï¼Ÿ" class="headerlink" title="12. ä¸ºä»€ä¹ˆæœ‰æ—¶å€™â½¤translateæ¥æ”¹å˜ä½ç½®â½½ä¸æ˜¯å®šä½ï¼Ÿ"></a>12. ä¸ºä»€ä¹ˆæœ‰æ—¶å€™â½¤<strong>translate</strong>æ¥æ”¹å˜ä½ç½®â½½ä¸æ˜¯å®šä½ï¼Ÿ</h3><p>translate æ˜¯ transform å±æ€§çš„â¼€ä¸ªå€¼ã€‚æ”¹å˜transformæˆ–opacityä¸ä¼šè§¦å‘æµè§ˆå™¨é‡æ–°å¸ƒå±€ï¼ˆreflowï¼‰æˆ–é‡ç»˜ï¼ˆrepaintï¼‰ï¼Œåªä¼šè§¦å‘å¤åˆï¼ˆcompositionsï¼‰ã€‚â½½æ”¹å˜ç»å¯¹å®šä½ä¼šè§¦å‘é‡æ–°å¸ƒå±€ï¼Œè¿›â½½è§¦å‘é‡ç»˜å’Œå¤åˆã€‚transformä½¿æµè§ˆå™¨ä¸ºå…ƒç´ åˆ›å»ºâ¼€ä¸ª GPU å›¾å±‚ï¼Œä½†æ”¹å˜ç»å¯¹å®šä½ä¼šä½¿â½¤åˆ° CPUã€‚ å› æ­¤translate()æ›´â¾¼æ•ˆï¼Œå¯ä»¥ç¼©çŸ­å¹³æ»‘åŠ¨ç”»çš„ç»˜åˆ¶æ—¶é—´ã€‚ â½½translateæ”¹å˜ä½ç½®æ—¶ï¼Œå…ƒç´ ä¾ç„¶ä¼šå æ®å…¶åŸå§‹ç©ºé—´ï¼Œç»å¯¹å®šä½å°±ä¸ä¼šå‘â½£è¿™ç§æƒ…å†µã€‚</p><h3 id="13-li-ä¸-li-ä¹‹é—´æœ‰çœ‹ä¸è§çš„ç©ºç™½é—´éš”æ˜¯ä»€ä¹ˆåŸå› å¼•èµ·çš„ï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿ"><a href="#13-li-ä¸-li-ä¹‹é—´æœ‰çœ‹ä¸è§çš„ç©ºç™½é—´éš”æ˜¯ä»€ä¹ˆåŸå› å¼•èµ·çš„ï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿ" class="headerlink" title="13. li ä¸ li ä¹‹é—´æœ‰çœ‹ä¸è§çš„ç©ºç™½é—´éš”æ˜¯ä»€ä¹ˆåŸå› å¼•èµ·çš„ï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿ"></a>13. li ä¸ li ä¹‹é—´æœ‰çœ‹ä¸è§çš„ç©ºç™½é—´éš”æ˜¯ä»€ä¹ˆåŸå› å¼•èµ·çš„ï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿ</h3><p>æµè§ˆå™¨ä¼šæŠŠinlineå†…è”å…ƒç´ é—´çš„ç©ºç™½å­—ç¬¦ï¼ˆç©ºæ ¼ã€æ¢è¡Œã€Tabç­‰ï¼‰æ¸²æŸ“æˆä¸€ä¸ªç©ºæ ¼ã€‚ä¸ºäº†ç¾è§‚ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ª<code>&lt;li&gt;</code>æ”¾åœ¨ä¸€è¡Œï¼Œè¿™å¯¼è‡´<code>&lt;li&gt;</code>æ¢è¡Œåäº§ç”Ÿæ¢è¡Œå­—ç¬¦ï¼Œå®ƒå˜æˆä¸€ä¸ªç©ºæ ¼ï¼Œå ç”¨äº†ä¸€ä¸ªå­—ç¬¦çš„å®½åº¦ã€‚</p><p><strong>è§£å†³åŠæ³•ï¼š</strong></p><p>ï¼ˆ1ï¼‰ä¸º<code>&lt;li&gt;</code>è®¾ç½®float:leftã€‚ä¸è¶³ï¼šæœ‰äº›å®¹å™¨æ˜¯ä¸èƒ½è®¾ç½®æµ®åŠ¨ï¼Œå¦‚å·¦å³åˆ‡æ¢çš„ç„¦ç‚¹å›¾ç­‰ã€‚</p><p>ï¼ˆ2ï¼‰å°†æ‰€æœ‰<code>&lt;li&gt;</code>å†™åœ¨åŒä¸€è¡Œã€‚ä¸è¶³ï¼šä»£ç ä¸ç¾è§‚ã€‚</p><p>ï¼ˆ3ï¼‰å°†<code>&lt;ul&gt;</code>å†…çš„å­—ç¬¦å°ºå¯¸ç›´æ¥è®¾ä¸º0ï¼Œå³font-size:0ã€‚ä¸è¶³ï¼š<code>&lt;ul&gt;</code>ä¸­çš„å…¶ä»–å­—ç¬¦å°ºå¯¸ä¹Ÿè¢«è®¾ä¸º0ï¼Œéœ€è¦é¢å¤–é‡æ–°è®¾å®šå…¶ä»–å­—ç¬¦å°ºå¯¸ï¼Œä¸”åœ¨Safariæµè§ˆå™¨ä¾ç„¶ä¼šå‡ºç°ç©ºç™½é—´éš”ã€‚</p><p>ï¼ˆ4ï¼‰æ¶ˆé™¤<code>&lt;ul&gt;</code>çš„å­—ç¬¦é—´éš”letter-spacing:-8pxï¼Œä¸è¶³ï¼šè¿™ä¹Ÿè®¾ç½®äº†<code>&lt;li&gt;</code>å†…çš„å­—ç¬¦é—´éš”ï¼Œå› æ­¤éœ€è¦å°†<code>&lt;li&gt;</code>å†…çš„å­—ç¬¦é—´éš”è®¾ä¸ºé»˜è®¤letter-spacing:normalã€‚</p><h3 id="14-CSS3ä¸­æœ‰å“ªäº›æ–°ç‰¹æ€§"><a href="#14-CSS3ä¸­æœ‰å“ªäº›æ–°ç‰¹æ€§" class="headerlink" title="14. CSS3ä¸­æœ‰å“ªäº›æ–°ç‰¹æ€§"></a>14. CSS3ä¸­æœ‰å“ªäº›æ–°ç‰¹æ€§</h3><ul><li>æ–°å¢å„ç§CSSé€‰æ‹©å™¨ ï¼ˆ: not(.input)ï¼šæ‰€æœ‰ class ä¸æ˜¯â€œinputâ€çš„èŠ‚ç‚¹ï¼‰</li><li>åœ†è§’ ï¼ˆborder-radius:8pxï¼‰</li><li>å¤šåˆ—å¸ƒå±€ ï¼ˆmulti-column layoutï¼‰</li><li>é˜´å½±å’Œåå°„ ï¼ˆShadoweflectï¼‰</li><li>æ–‡å­—ç‰¹æ•ˆ ï¼ˆtext-shadowï¼‰</li><li>æ–‡å­—æ¸²æŸ“ ï¼ˆText-decorationï¼‰</li><li>çº¿æ€§æ¸å˜ ï¼ˆgradientï¼‰</li><li>æ—‹è½¬ ï¼ˆtransformï¼‰</li><li>å¢åŠ äº†æ—‹è½¬,ç¼©æ”¾,å®šä½,å€¾æ–œ,åŠ¨ç”»,å¤šèƒŒæ™¯</li></ul><h3 id="15-æ›¿æ¢å…ƒç´ çš„æ¦‚å¿µåŠè®¡ç®—è§„åˆ™"><a href="#15-æ›¿æ¢å…ƒç´ çš„æ¦‚å¿µåŠè®¡ç®—è§„åˆ™" class="headerlink" title="15. æ›¿æ¢å…ƒç´ çš„æ¦‚å¿µåŠè®¡ç®—è§„åˆ™"></a>15. æ›¿æ¢å…ƒç´ çš„æ¦‚å¿µåŠè®¡ç®—è§„åˆ™</h3><p>é€šè¿‡ä¿®æ”¹æŸä¸ªå±æ€§å€¼å‘ˆç°çš„å†…å®¹å°±å¯ä»¥è¢«æ›¿æ¢çš„å…ƒç´ å°±ç§°ä¸ºâ€œæ›¿æ¢å…ƒç´ â€ã€‚</p><p>æ›¿æ¢å…ƒç´ é™¤äº†å†…å®¹å¯æ›¿æ¢è¿™ä¸€ç‰¹æ€§ä»¥å¤–ï¼Œè¿˜æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼š</p><ul><li><strong>å†…å®¹çš„å¤–è§‚ä¸å—é¡µé¢ä¸Šçš„CSSçš„å½±å“</strong>ï¼šç”¨ä¸“ä¸šçš„è¯è®²å°±æ˜¯åœ¨æ ·å¼è¡¨ç°åœ¨CSSä½œç”¨åŸŸä¹‹å¤–ã€‚å¦‚ä½•æ›´æ”¹æ›¿æ¢å…ƒç´ æœ¬èº«çš„å¤–è§‚éœ€è¦ç±»ä¼¼appearanceå±æ€§ï¼Œæˆ–è€…æµè§ˆå™¨è‡ªèº«æš´éœ²çš„ä¸€äº›æ ·å¼æ¥å£ã€‚</li><li><strong>æœ‰è‡ªå·±çš„å°ºå¯¸</strong>ï¼šåœ¨Webä¸­ï¼Œå¾ˆå¤šæ›¿æ¢å…ƒç´ åœ¨æ²¡æœ‰æ˜ç¡®å°ºå¯¸è®¾å®šçš„æƒ…å†µä¸‹ï¼Œå…¶é»˜è®¤çš„å°ºå¯¸ï¼ˆä¸åŒ…æ‹¬è¾¹æ¡†ï¼‰æ˜¯300åƒç´ Ã—150åƒç´ ï¼Œå¦‚</li><li><strong>åœ¨å¾ˆå¤šCSSå±æ€§ä¸Šæœ‰è‡ªå·±çš„ä¸€å¥—è¡¨ç°è§„åˆ™</strong>ï¼šæ¯”è¾ƒå…·æœ‰ä»£è¡¨æ€§çš„å°±æ˜¯vertical-alignå±æ€§ï¼Œå¯¹äºæ›¿æ¢å…ƒç´ å’Œéæ›¿æ¢å…ƒç´ ï¼Œvertical-alignå±æ€§å€¼çš„è§£é‡Šæ˜¯ä¸ä¸€æ ·çš„ã€‚æ¯”æ–¹è¯´vertical-alignçš„é»˜è®¤å€¼çš„baselineï¼Œå¾ˆç®€å•çš„å±æ€§å€¼ï¼ŒåŸºçº¿ä¹‹æ„ï¼Œè¢«å®šä¹‰ä¸ºå­—ç¬¦xçš„ä¸‹è¾¹ç¼˜ï¼Œè€Œæ›¿æ¢å…ƒç´ çš„åŸºçº¿å´è¢«ç¡¬ç”Ÿç”Ÿå®šä¹‰æˆäº†å…ƒç´ çš„ä¸‹è¾¹ç¼˜ã€‚</li><li><strong>æ‰€æœ‰çš„æ›¿æ¢å…ƒç´ éƒ½æ˜¯å†…è”æ°´å¹³å…ƒç´ </strong>ï¼šä¹Ÿå°±æ˜¯æ›¿æ¢å…ƒç´ å’Œæ›¿æ¢å…ƒç´ ã€æ›¿æ¢å…ƒç´ å’Œæ–‡å­—éƒ½æ˜¯å¯ä»¥åœ¨ä¸€è¡Œæ˜¾ç¤ºçš„ã€‚ä½†æ˜¯ï¼Œæ›¿æ¢å…ƒç´ é»˜è®¤çš„displayå€¼å´æ˜¯ä¸ä¸€æ ·çš„ï¼Œæœ‰çš„æ˜¯inlineï¼Œæœ‰çš„æ˜¯inline-blockã€‚</li></ul><p>æ›¿æ¢å…ƒç´ çš„å°ºå¯¸ä»å†…è€Œå¤–åˆ†ä¸ºä¸‰ç±»ï¼š</p><ul><li><strong>å›ºæœ‰å°ºå¯¸ï¼š</strong> æŒ‡çš„æ˜¯æ›¿æ¢å†…å®¹åŸæœ¬çš„å°ºå¯¸ã€‚ä¾‹å¦‚ï¼Œå›¾ç‰‡ã€è§†é¢‘ä½œä¸ºä¸€ä¸ªç‹¬ç«‹æ–‡ä»¶å­˜åœ¨çš„æ—¶å€™ï¼Œéƒ½æ˜¯æœ‰ç€è‡ªå·±çš„å®½åº¦å’Œé«˜åº¦çš„ã€‚</li><li><strong>HTMLå°ºå¯¸ï¼š</strong> åªèƒ½é€šè¿‡HTMLåŸç”Ÿå±æ€§æ”¹å˜ï¼Œè¿™äº›HTMLåŸç”Ÿå±æ€§åŒ…æ‹¬çš„widthå’Œheightå±æ€§ã€çš„sizeå±æ€§ã€‚</li><li><strong>CSSå°ºå¯¸ï¼š</strong> ç‰¹æŒ‡å¯ä»¥é€šè¿‡CSSçš„widthå’Œheightæˆ–è€…max-width/min-widthå’Œmax-height/min-heightè®¾ç½®çš„å°ºå¯¸ï¼Œå¯¹åº”ç›’å°ºå¯¸ä¸­çš„content boxã€‚</li></ul><p>è¿™ä¸‰å±‚ç»“æ„çš„è®¡ç®—è§„åˆ™å…·ä½“å¦‚ä¸‹ï¼š<br>ï¼ˆ1ï¼‰å¦‚æœæ²¡æœ‰CSSå°ºå¯¸å’ŒHTMLå°ºå¯¸ï¼Œåˆ™ä½¿ç”¨å›ºæœ‰å°ºå¯¸ä½œä¸ºæœ€ç»ˆçš„å®½é«˜ã€‚<br>ï¼ˆ2ï¼‰å¦‚æœæ²¡æœ‰CSSå°ºå¯¸ï¼Œåˆ™ä½¿ç”¨HTMLå°ºå¯¸ä½œä¸ºæœ€ç»ˆçš„å®½é«˜ã€‚<br>ï¼ˆ3ï¼‰å¦‚æœæœ‰CSSå°ºå¯¸ï¼Œåˆ™æœ€ç»ˆå°ºå¯¸ç”±CSSå±æ€§å†³å®šã€‚<br>ï¼ˆ4ï¼‰å¦‚æœâ€œå›ºæœ‰å°ºå¯¸â€å«æœ‰å›ºæœ‰çš„å®½é«˜æ¯”ä¾‹ï¼ŒåŒæ—¶ä»…è®¾ç½®äº†å®½åº¦æˆ–ä»…è®¾ç½®äº†é«˜åº¦ï¼Œåˆ™å…ƒç´ ä¾ç„¶æŒ‰ç…§å›ºæœ‰çš„å®½é«˜æ¯”ä¾‹æ˜¾ç¤ºã€‚<br>ï¼ˆ5ï¼‰å¦‚æœä¸Šé¢çš„æ¡ä»¶éƒ½ä¸ç¬¦åˆï¼Œåˆ™æœ€ç»ˆå®½åº¦è¡¨ç°ä¸º300åƒç´ ï¼Œé«˜åº¦ä¸º150åƒç´ ã€‚<br>ï¼ˆ6ï¼‰å†…è”æ›¿æ¢å…ƒç´ å’Œå—çº§æ›¿æ¢å…ƒç´ ä½¿ç”¨ä¸Šé¢åŒä¸€å¥—å°ºå¯¸è®¡ç®—è§„åˆ™ã€‚</p><h3 id="16-å¸¸è§çš„å›¾ç‰‡æ ¼å¼åŠä½¿ç”¨åœºæ™¯"><a href="#16-å¸¸è§çš„å›¾ç‰‡æ ¼å¼åŠä½¿ç”¨åœºæ™¯" class="headerlink" title="16. å¸¸è§çš„å›¾ç‰‡æ ¼å¼åŠä½¿ç”¨åœºæ™¯"></a>16. å¸¸è§çš„å›¾ç‰‡æ ¼å¼åŠä½¿ç”¨åœºæ™¯</h3><p>ï¼ˆ1ï¼‰<strong>BMP</strong>ï¼Œæ˜¯æ— æŸçš„ã€æ—¢æ”¯æŒç´¢å¼•è‰²ä¹Ÿæ”¯æŒç›´æ¥è‰²çš„ç‚¹é˜µå›¾ã€‚è¿™ç§å›¾ç‰‡æ ¼å¼å‡ ä¹æ²¡æœ‰å¯¹æ•°æ®è¿›è¡Œå‹ç¼©ï¼Œæ‰€ä»¥BMPæ ¼å¼çš„å›¾ç‰‡é€šå¸¸æ˜¯è¾ƒå¤§çš„æ–‡ä»¶ã€‚</p><p>ï¼ˆ2ï¼‰<strong>GIF</strong>æ˜¯æ— æŸçš„ã€é‡‡ç”¨ç´¢å¼•è‰²çš„ç‚¹é˜µå›¾ã€‚é‡‡ç”¨LZWå‹ç¼©ç®—æ³•è¿›è¡Œç¼–ç ã€‚æ–‡ä»¶å°ï¼Œæ˜¯GIFæ ¼å¼çš„ä¼˜ç‚¹ï¼ŒåŒæ—¶ï¼ŒGIFæ ¼å¼è¿˜å…·æœ‰æ”¯æŒåŠ¨ç”»ä»¥åŠé€æ˜çš„ä¼˜ç‚¹ã€‚ä½†æ˜¯GIFæ ¼å¼ä»…æ”¯æŒ8bitçš„ç´¢å¼•è‰²ï¼Œæ‰€ä»¥GIFæ ¼å¼é€‚ç”¨äºå¯¹è‰²å½©è¦æ±‚ä¸é«˜åŒæ—¶éœ€è¦æ–‡ä»¶ä½“ç§¯è¾ƒå°çš„åœºæ™¯ã€‚</p><p>ï¼ˆ3ï¼‰<strong>JPEG</strong>æ˜¯æœ‰æŸçš„ã€é‡‡ç”¨ç›´æ¥è‰²çš„ç‚¹é˜µå›¾ã€‚JPEGçš„å›¾ç‰‡çš„ä¼˜ç‚¹æ˜¯é‡‡ç”¨äº†ç›´æ¥è‰²ï¼Œå¾—ç›Šäºæ›´ä¸°å¯Œçš„è‰²å½©ï¼ŒJPEGéå¸¸é€‚åˆç”¨æ¥å­˜å‚¨ç…§ç‰‡ï¼Œä¸GIFç›¸æ¯”ï¼ŒJPEGä¸é€‚åˆç”¨æ¥å­˜å‚¨ä¼ä¸šLogoã€çº¿æ¡†ç±»çš„å›¾ã€‚å› ä¸ºæœ‰æŸå‹ç¼©ä¼šå¯¼è‡´å›¾ç‰‡æ¨¡ç³Šï¼Œè€Œç›´æ¥è‰²çš„é€‰ç”¨ï¼Œåˆä¼šå¯¼è‡´å›¾ç‰‡æ–‡ä»¶è¾ƒGIFæ›´å¤§ã€‚</p><p>ï¼ˆ4ï¼‰<strong>PNG-8</strong>æ˜¯æ— æŸçš„ã€ä½¿ç”¨ç´¢å¼•è‰²çš„ç‚¹é˜µå›¾ã€‚PNGæ˜¯ä¸€ç§æ¯”è¾ƒæ–°çš„å›¾ç‰‡æ ¼å¼ï¼ŒPNG-8æ˜¯éå¸¸å¥½çš„GIFæ ¼å¼æ›¿ä»£è€…ï¼Œåœ¨å¯èƒ½çš„æƒ…å†µä¸‹ï¼Œåº”è¯¥å°½å¯èƒ½çš„ä½¿ç”¨PNG-8è€Œä¸æ˜¯GIFï¼Œå› ä¸ºåœ¨ç›¸åŒçš„å›¾ç‰‡æ•ˆæœä¸‹ï¼ŒPNG-8å…·æœ‰æ›´å°çš„æ–‡ä»¶ä½“ç§¯ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒPNG-8è¿˜æ”¯æŒé€æ˜åº¦çš„è°ƒèŠ‚ï¼Œè€ŒGIFå¹¶ä¸æ”¯æŒã€‚é™¤ééœ€è¦åŠ¨ç”»çš„æ”¯æŒï¼Œå¦åˆ™æ²¡æœ‰ç†ç”±ä½¿ç”¨GIFè€Œä¸æ˜¯PNG-8ã€‚</p><p>ï¼ˆ5ï¼‰<strong>PNG-24</strong>æ˜¯æ— æŸçš„ã€ä½¿ç”¨ç›´æ¥è‰²çš„ç‚¹é˜µå›¾ã€‚PNG-24çš„ä¼˜ç‚¹åœ¨äºå®ƒå‹ç¼©äº†å›¾ç‰‡çš„æ•°æ®ï¼Œä½¿å¾—åŒæ ·æ•ˆæœçš„å›¾ç‰‡ï¼ŒPNG-24æ ¼å¼çš„æ–‡ä»¶å¤§å°è¦æ¯”BMPå°å¾—å¤šã€‚å½“ç„¶ï¼ŒPNG24çš„å›¾ç‰‡è¿˜æ˜¯è¦æ¯”JPEGã€GIFã€PNG-8å¤§å¾—å¤šã€‚</p><p>ï¼ˆ6ï¼‰<strong>SVG</strong>æ˜¯æ— æŸçš„çŸ¢é‡å›¾ã€‚SVGæ˜¯çŸ¢é‡å›¾æ„å‘³ç€SVGå›¾ç‰‡ç”±ç›´çº¿å’Œæ›²çº¿ä»¥åŠç»˜åˆ¶å®ƒä»¬çš„æ–¹æ³•ç»„æˆã€‚å½“æ”¾å¤§SVGå›¾ç‰‡æ—¶ï¼Œçœ‹åˆ°çš„è¿˜æ˜¯çº¿å’Œæ›²çº¿ï¼Œè€Œä¸ä¼šå‡ºç°åƒç´ ç‚¹ã€‚SVGå›¾ç‰‡åœ¨æ”¾å¤§æ—¶ï¼Œä¸ä¼šå¤±çœŸï¼Œæ‰€ä»¥å®ƒé€‚åˆç”¨æ¥ç»˜åˆ¶Logoã€Iconç­‰ã€‚</p><p>ï¼ˆ7ï¼‰<strong>WebP</strong>æ˜¯è°·æ­Œå¼€å‘çš„ä¸€ç§æ–°å›¾ç‰‡æ ¼å¼ï¼ŒWebPæ˜¯åŒæ—¶æ”¯æŒæœ‰æŸå’Œæ— æŸå‹ç¼©çš„ã€ä½¿ç”¨ç›´æ¥è‰²çš„ç‚¹é˜µå›¾ã€‚ä»åå­—å°±å¯ä»¥çœ‹å‡ºæ¥å®ƒæ˜¯ä¸ºWebè€Œç”Ÿçš„ï¼Œä»€ä¹ˆå«ä¸ºWebè€Œç”Ÿå‘¢ï¼Ÿå°±æ˜¯è¯´ç›¸åŒè´¨é‡çš„å›¾ç‰‡ï¼ŒWebPå…·æœ‰æ›´å°çš„æ–‡ä»¶ä½“ç§¯ã€‚ç°åœ¨ç½‘ç«™ä¸Šå……æ»¡äº†å¤§é‡çš„å›¾ç‰‡ï¼Œå¦‚æœèƒ½å¤Ÿé™ä½æ¯ä¸€ä¸ªå›¾ç‰‡çš„æ–‡ä»¶å¤§å°ï¼Œé‚£ä¹ˆå°†å¤§å¤§å‡å°‘æµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´çš„æ•°æ®ä¼ è¾“é‡ï¼Œè¿›è€Œé™ä½è®¿é—®å»¶è¿Ÿï¼Œæå‡è®¿é—®ä½“éªŒã€‚ç›®å‰åªæœ‰Chromeæµè§ˆå™¨å’ŒOperaæµè§ˆå™¨æ”¯æŒWebPæ ¼å¼ï¼Œå…¼å®¹æ€§ä¸å¤ªå¥½ã€‚</p><ul><li>åœ¨æ— æŸå‹ç¼©çš„æƒ…å†µä¸‹ï¼Œç›¸åŒè´¨é‡çš„WebPå›¾ç‰‡ï¼Œæ–‡ä»¶å¤§å°è¦æ¯”PNGå°26%ï¼›</li><li>åœ¨æœ‰æŸå‹ç¼©çš„æƒ…å†µä¸‹ï¼Œå…·æœ‰ç›¸åŒå›¾ç‰‡ç²¾åº¦çš„WebPå›¾ç‰‡ï¼Œæ–‡ä»¶å¤§å°è¦æ¯”JPEGå°25%~34%ï¼›</li><li>WebPå›¾ç‰‡æ ¼å¼æ”¯æŒå›¾ç‰‡é€æ˜åº¦ï¼Œä¸€ä¸ªæ— æŸå‹ç¼©çš„WebPå›¾ç‰‡ï¼Œå¦‚æœè¦æ”¯æŒé€æ˜åº¦åªéœ€è¦22%çš„æ ¼å¤–æ–‡ä»¶å¤§å°ã€‚</li></ul><h3 id="17-å¯¹-CSSSprites-çš„ç†è§£"><a href="#17-å¯¹-CSSSprites-çš„ç†è§£" class="headerlink" title="17. å¯¹ CSSSprites çš„ç†è§£"></a>17. å¯¹ CSSSprites çš„ç†è§£</h3><p>CSSSpritesï¼ˆç²¾çµå›¾ï¼‰ï¼Œå°†ä¸€ä¸ªé¡µé¢æ¶‰åŠåˆ°çš„æ‰€æœ‰å›¾ç‰‡éƒ½åŒ…å«åˆ°ä¸€å¼ å¤§å›¾ä¸­å»ï¼Œç„¶ååˆ©ç”¨CSSçš„ background-imageï¼Œbackground-repeatï¼Œbackground-positionå±æ€§çš„ç»„åˆè¿›è¡ŒèƒŒæ™¯å®šä½ã€‚</p><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>åˆ©ç”¨<code>CSS Sprites</code>èƒ½å¾ˆå¥½åœ°å‡å°‘ç½‘é¡µçš„httpè¯·æ±‚ï¼Œä»è€Œå¤§å¤§æé«˜äº†é¡µé¢çš„æ€§èƒ½ï¼Œè¿™æ˜¯<code>CSS Sprites</code>æœ€å¤§çš„ä¼˜ç‚¹ï¼›</li><li><code>CSS Sprites</code>èƒ½å‡å°‘å›¾ç‰‡çš„å­—èŠ‚ï¼ŒæŠŠ3å¼ å›¾ç‰‡åˆå¹¶æˆ1å¼ å›¾ç‰‡çš„å­—èŠ‚æ€»æ˜¯å°äºè¿™3å¼ å›¾ç‰‡çš„å­—èŠ‚æ€»å’Œã€‚</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>åœ¨å›¾ç‰‡åˆå¹¶æ—¶ï¼Œè¦æŠŠå¤šå¼ å›¾ç‰‡æœ‰åºçš„ã€åˆç†çš„åˆå¹¶æˆä¸€å¼ å›¾ç‰‡ï¼Œè¿˜è¦ç•™å¥½è¶³å¤Ÿçš„ç©ºé—´ï¼Œé˜²æ­¢æ¿å—å†…å‡ºç°ä¸å¿…è¦çš„èƒŒæ™¯ã€‚åœ¨å®½å±åŠé«˜åˆ†è¾¨ç‡ä¸‹çš„è‡ªé€‚åº”é¡µé¢ï¼Œå¦‚æœèƒŒæ™¯ä¸å¤Ÿå®½ï¼Œå¾ˆå®¹æ˜“å‡ºç°èƒŒæ™¯æ–­è£‚ï¼›</li><li><code>CSSSprites</code>åœ¨å¼€å‘çš„æ—¶å€™ç›¸å¯¹æ¥è¯´æœ‰ç‚¹éº»çƒ¦ï¼Œéœ€è¦å€ŸåŠ©<code>photoshop</code>æˆ–å…¶ä»–å·¥å…·æ¥å¯¹æ¯ä¸ªèƒŒæ™¯å•å…ƒæµ‹é‡å…¶å‡†ç¡®çš„ä½ç½®ã€‚</li><li>ç»´æŠ¤æ–¹é¢ï¼š<code>CSS Sprites</code>åœ¨ç»´æŠ¤çš„æ—¶å€™æ¯”è¾ƒéº»çƒ¦ï¼Œé¡µé¢èƒŒæ™¯æœ‰å°‘è®¸æ”¹åŠ¨æ—¶ï¼Œå°±è¦æ”¹è¿™å¼ åˆå¹¶çš„å›¾ç‰‡ï¼Œæ— éœ€æ”¹çš„åœ°æ–¹å°½é‡ä¸è¦åŠ¨ï¼Œè¿™æ ·é¿å…æ”¹åŠ¨æ›´å¤šçš„<code>CSS</code>ï¼Œå¦‚æœåœ¨åŸæ¥çš„åœ°æ–¹æ”¾ä¸ä¸‹ï¼Œåˆåªèƒ½ï¼ˆæœ€å¥½ï¼‰å¾€ä¸‹åŠ å›¾ç‰‡ï¼Œè¿™æ ·å›¾ç‰‡çš„å­—èŠ‚å°±å¢åŠ äº†ï¼Œè¿˜è¦æ”¹åŠ¨<code>CSS</code>ã€‚</li></ul><h3 id="18-ä»€ä¹ˆæ˜¯ç‰©ç†åƒç´ ï¼Œé€»è¾‘åƒç´ å’Œåƒç´ å¯†åº¦ï¼Œä¸ºä»€ä¹ˆåœ¨ç§»åŠ¨ç«¯å¼€å‘æ—¶éœ€è¦ç”¨åˆ°-3x-2xè¿™ç§å›¾ç‰‡ï¼Ÿ"><a href="#18-ä»€ä¹ˆæ˜¯ç‰©ç†åƒç´ ï¼Œé€»è¾‘åƒç´ å’Œåƒç´ å¯†åº¦ï¼Œä¸ºä»€ä¹ˆåœ¨ç§»åŠ¨ç«¯å¼€å‘æ—¶éœ€è¦ç”¨åˆ°-3x-2xè¿™ç§å›¾ç‰‡ï¼Ÿ" class="headerlink" title="18. ä»€ä¹ˆæ˜¯ç‰©ç†åƒç´ ï¼Œé€»è¾‘åƒç´ å’Œåƒç´ å¯†åº¦ï¼Œä¸ºä»€ä¹ˆåœ¨ç§»åŠ¨ç«¯å¼€å‘æ—¶éœ€è¦ç”¨åˆ°@3x, @2xè¿™ç§å›¾ç‰‡ï¼Ÿ"></a>18. ä»€ä¹ˆæ˜¯ç‰©ç†åƒç´ ï¼Œé€»è¾‘åƒç´ å’Œåƒç´ å¯†åº¦ï¼Œä¸ºä»€ä¹ˆåœ¨ç§»åŠ¨ç«¯å¼€å‘æ—¶éœ€è¦ç”¨åˆ°@3x, @2xè¿™ç§å›¾ç‰‡ï¼Ÿ</h3><p>ä»¥ iPhone XS ä¸ºä¾‹ï¼Œå½“å†™ CSS ä»£ç æ—¶ï¼Œé’ˆå¯¹äºå•ä½ pxï¼Œå…¶å®½åº¦ä¸º 414px &amp; 896pxï¼Œä¹Ÿå°±æ˜¯è¯´å½“èµ‹äºˆä¸€ä¸ª DIVå…ƒç´ å®½åº¦ä¸º 414pxï¼Œè¿™ä¸ª DIV å°±ä¼šå¡«æ»¡æ‰‹æœºçš„å®½åº¦ï¼›</p><p>è€Œå¦‚æœæœ‰ä¸€æŠŠå°ºå­æ¥å®é™…æµ‹é‡è¿™éƒ¨æ‰‹æœºçš„ç‰©ç†åƒç´ ï¼Œå®é™…ä¸º 1242*2688 ç‰©ç†åƒç´ ï¼›ç»è¿‡è®¡ç®—å¯çŸ¥ï¼Œ1242/414=3ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨å•è¾¹ä¸Šï¼Œä¸€ä¸ªé€»è¾‘åƒç´ =3ä¸ªç‰©ç†åƒç´ ï¼Œå°±è¯´è¿™ä¸ªå±å¹•çš„åƒç´ å¯†åº¦ä¸º 3ï¼Œä¹Ÿå°±æ˜¯å¸¸è¯´çš„ 3 å€å±ã€‚</p><p>å¯¹äºå›¾ç‰‡æ¥è¯´ï¼Œä¸ºäº†ä¿è¯å…¶ä¸å¤±çœŸï¼Œ1 ä¸ªå›¾ç‰‡åƒç´ è‡³å°‘è¦å¯¹åº”ä¸€ä¸ªç‰©ç†åƒç´ ï¼Œå‡å¦‚åŸå§‹å›¾ç‰‡æ˜¯ 500300 åƒç´ ï¼Œé‚£ä¹ˆåœ¨ 3 å€å±ä¸Šå°±è¦æ”¾ä¸€ä¸ª 1500900 åƒç´ çš„å›¾ç‰‡æ‰èƒ½ä¿è¯ 1 ä¸ªç‰©ç†åƒç´ è‡³å°‘å¯¹åº”ä¸€ä¸ªå›¾ç‰‡åƒç´ ï¼Œæ‰èƒ½ä¸å¤±çœŸã€‚<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="4.jpg" alt=""><br>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥é’ˆå¯¹æ‰€æœ‰å±å¹•ï¼Œéƒ½åªæä¾›æœ€é«˜æ¸…å›¾ç‰‡ã€‚è™½ç„¶ä½å¯†åº¦å±å¹•ç”¨ä¸åˆ°é‚£ä¹ˆå¤šå›¾ç‰‡åƒç´ ï¼Œè€Œä¸”ä¼šå› ä¸ºä¸‹è½½å¤šä½™çš„åƒç´ é€ æˆå¸¦å®½æµªè´¹å’Œä¸‹è½½å»¶è¿Ÿï¼Œä½†ä»ç»“æœä¸Šè¯´èƒ½ä¿è¯å›¾ç‰‡åœ¨æ‰€æœ‰å±å¹•ä¸Šéƒ½ä¸ä¼šå¤±çœŸã€‚</p><p>è¿˜å¯ä»¥ä½¿ç”¨ CSS åª’ä½“æŸ¥è¯¢æ¥åˆ¤æ–­ä¸åŒçš„åƒç´ å¯†åº¦ï¼Œä»è€Œé€‰æ‹©ä¸åŒçš„å›¾ç‰‡:</p><pre class="line-numbers language-javascript"><code class="language-javascript">my<span class="token operator">-</span>image <span class="token punctuation">{</span> background<span class="token punctuation">:</span> <span class="token punctuation">(</span>low<span class="token punctuation">.</span>png<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>@media only screen and <span class="token punctuation">(</span>min<span class="token operator">-</span>device<span class="token operator">-</span>pixel<span class="token operator">-</span>ratio<span class="token punctuation">:</span> <span class="token number">1.5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  #my<span class="token operator">-</span>image <span class="token punctuation">{</span> background<span class="token punctuation">:</span> <span class="token punctuation">(</span>high<span class="token punctuation">.</span>png<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h3 id="19-margin-å’Œ-padding-çš„ä½¿ç”¨åœºæ™¯"><a href="#19-margin-å’Œ-padding-çš„ä½¿ç”¨åœºæ™¯" class="headerlink" title="19. margin å’Œ padding çš„ä½¿ç”¨åœºæ™¯"></a>19. <strong>margin å’Œ padding çš„ä½¿ç”¨åœºæ™¯</strong></h3><ul><li>éœ€è¦åœ¨borderå¤–ä¾§æ·»åŠ ç©ºç™½ï¼Œä¸”ç©ºç™½å¤„ä¸éœ€è¦èƒŒæ™¯ï¼ˆè‰²ï¼‰æ—¶ï¼Œä½¿ç”¨ marginï¼›</li><li>éœ€è¦åœ¨borderå†…æµ‹æ·»åŠ ç©ºç™½ï¼Œä¸”ç©ºç™½å¤„éœ€è¦èƒŒæ™¯ï¼ˆè‰²ï¼‰æ—¶ï¼Œä½¿ç”¨ paddingã€‚</li></ul><h3 id="20-å¯¹line-height-çš„ç†è§£åŠå…¶èµ‹å€¼æ–¹å¼"><a href="#20-å¯¹line-height-çš„ç†è§£åŠå…¶èµ‹å€¼æ–¹å¼" class="headerlink" title="20. å¯¹line-height çš„ç†è§£åŠå…¶èµ‹å€¼æ–¹å¼"></a>20. å¯¹<strong>line-height çš„ç†è§£åŠå…¶èµ‹å€¼æ–¹å¼</strong></h3><p><strong>ï¼ˆ1ï¼‰line-heightçš„æ¦‚å¿µï¼š</strong></p><ul><li>line-height æŒ‡ä¸€è¡Œæ–‡æœ¬çš„é«˜åº¦ï¼ŒåŒ…å«äº†å­—é—´è·ï¼Œå®é™…ä¸Šæ˜¯ä¸‹ä¸€è¡ŒåŸºçº¿åˆ°ä¸Šä¸€è¡ŒåŸºçº¿è·ç¦»ï¼›</li><li>å¦‚æœä¸€ä¸ªæ ‡ç­¾æ²¡æœ‰å®šä¹‰ height å±æ€§ï¼Œé‚£ä¹ˆå…¶æœ€ç»ˆè¡¨ç°çš„é«˜åº¦ç”± line-height å†³å®šï¼›</li><li>ä¸€ä¸ªå®¹å™¨æ²¡æœ‰è®¾ç½®é«˜åº¦ï¼Œé‚£ä¹ˆæ’‘å¼€å®¹å™¨é«˜åº¦çš„æ˜¯ line-heightï¼Œè€Œä¸æ˜¯å®¹å™¨å†…çš„æ–‡æœ¬å†…å®¹ï¼›</li><li>æŠŠ line-height å€¼è®¾ç½®ä¸º height ä¸€æ ·å¤§å°çš„å€¼å¯ä»¥å®ç°å•è¡Œæ–‡å­—çš„å‚ç›´å±…ä¸­ï¼›</li><li>line-height å’Œ height éƒ½èƒ½æ’‘å¼€ä¸€ä¸ªé«˜åº¦ï¼›</li></ul><p><strong>ï¼ˆ2ï¼‰line-height çš„èµ‹å€¼æ–¹å¼ï¼š</strong></p><ul><li>å¸¦å•ä½ï¼špx æ˜¯å›ºå®šå€¼ï¼Œè€Œ em ä¼šå‚è€ƒçˆ¶å…ƒç´  font-size å€¼è®¡ç®—è‡ªèº«çš„è¡Œé«˜</li><li>çº¯æ•°å­—ï¼šä¼šæŠŠæ¯”ä¾‹ä¼ é€’ç»™åä»£ã€‚ä¾‹å¦‚ï¼Œçˆ¶çº§è¡Œé«˜ä¸º 1.5ï¼Œå­å…ƒç´ å­—ä½“ä¸º 18pxï¼Œåˆ™å­å…ƒç´ è¡Œé«˜ä¸º 1.5 * 18 = 27px</li><li>ç™¾åˆ†æ¯”ï¼šå°†è®¡ç®—åçš„å€¼ä¼ é€’ç»™åä»£</li></ul><h3 id="21-CSS-ä¼˜åŒ–å’Œæé«˜æ€§èƒ½çš„æ–¹æ³•æœ‰å“ªäº›ï¼Ÿ"><a href="#21-CSS-ä¼˜åŒ–å’Œæé«˜æ€§èƒ½çš„æ–¹æ³•æœ‰å“ªäº›ï¼Ÿ" class="headerlink" title="21. CSS ä¼˜åŒ–å’Œæé«˜æ€§èƒ½çš„æ–¹æ³•æœ‰å“ªäº›ï¼Ÿ"></a>21. CSS ä¼˜åŒ–å’Œæé«˜æ€§èƒ½çš„æ–¹æ³•æœ‰å“ªäº›ï¼Ÿ</h3><p><strong>åŠ è½½æ€§èƒ½ï¼š</strong></p><p>ï¼ˆ1ï¼‰csså‹ç¼©ï¼šå°†å†™å¥½çš„cssè¿›è¡Œæ‰“åŒ…å‹ç¼©ï¼Œå¯ä»¥å‡å°æ–‡ä»¶ä½“ç§¯ã€‚</p><p>ï¼ˆ2ï¼‰csså•ä¸€æ ·å¼ï¼šå½“éœ€è¦ä¸‹è¾¹è·å’Œå·¦è¾¹è·çš„æ—¶å€™ï¼Œå¾ˆå¤šæ—¶å€™ä¼šé€‰æ‹©ä½¿ç”¨ margin:top 0 bottom 0ï¼›ä½†margin-bottom:bottom;margin-left:left;æ‰§è¡Œæ•ˆç‡ä¼šæ›´é«˜ã€‚</p><p>ï¼ˆ3ï¼‰å‡å°‘ä½¿ç”¨@importï¼Œå»ºè®®ä½¿ç”¨linkï¼Œå› ä¸ºåè€…åœ¨é¡µé¢åŠ è½½æ—¶ä¸€èµ·åŠ è½½ï¼Œå‰è€…æ˜¯ç­‰å¾…é¡µé¢åŠ è½½å®Œæˆä¹‹åå†è¿›è¡ŒåŠ è½½ã€‚</p><p><strong>é€‰æ‹©å™¨æ€§èƒ½ï¼š</strong></p><p>ï¼ˆ1ï¼‰å…³é”®é€‰æ‹©å™¨ï¼ˆkey selectorï¼‰ã€‚é€‰æ‹©å™¨çš„æœ€åé¢çš„éƒ¨åˆ†ä¸ºå…³é”®é€‰æ‹©å™¨ï¼ˆå³ç”¨æ¥åŒ¹é…ç›®æ ‡å…ƒç´ çš„éƒ¨åˆ†ï¼‰ã€‚CSSé€‰æ‹©ç¬¦æ˜¯ä»å³åˆ°å·¦è¿›è¡ŒåŒ¹é…çš„ã€‚å½“ä½¿ç”¨åä»£é€‰æ‹©å™¨çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šéå†æ‰€æœ‰å­å…ƒç´ æ¥ç¡®å®šæ˜¯å¦æ˜¯æŒ‡å®šçš„å…ƒç´ ç­‰ç­‰ï¼›</p><p>ï¼ˆ2ï¼‰å¦‚æœè§„åˆ™æ‹¥æœ‰IDé€‰æ‹©å™¨ä½œä¸ºå…¶å…³é”®é€‰æ‹©å™¨ï¼Œåˆ™ä¸è¦ä¸ºè§„åˆ™å¢åŠ æ ‡ç­¾ã€‚è¿‡æ»¤æ‰æ— å…³çš„è§„åˆ™ï¼ˆè¿™æ ·æ ·å¼ç³»ç»Ÿå°±ä¸ä¼šæµªè´¹æ—¶é—´å»åŒ¹é…å®ƒä»¬äº†ï¼‰ã€‚</p><p>ï¼ˆ3ï¼‰é¿å…ä½¿ç”¨é€šé…è§„åˆ™ï¼Œå¦‚*{}è®¡ç®—æ¬¡æ•°æƒŠäººï¼Œåªå¯¹éœ€è¦ç”¨åˆ°çš„å…ƒç´ è¿›è¡Œé€‰æ‹©ã€‚</p><p>ï¼ˆ4ï¼‰å°½é‡å°‘çš„å»å¯¹æ ‡ç­¾è¿›è¡Œé€‰æ‹©ï¼Œè€Œæ˜¯ç”¨classã€‚</p><p>ï¼ˆ5ï¼‰å°½é‡å°‘çš„å»ä½¿ç”¨åä»£é€‰æ‹©å™¨ï¼Œé™ä½é€‰æ‹©å™¨çš„æƒé‡å€¼ã€‚åä»£é€‰æ‹©å™¨çš„å¼€é”€æ˜¯æœ€é«˜çš„ï¼Œå°½é‡å°†é€‰æ‹©å™¨çš„æ·±åº¦é™åˆ°æœ€ä½ï¼Œæœ€é«˜ä¸è¦è¶…è¿‡ä¸‰å±‚ï¼Œæ›´å¤šçš„ä½¿ç”¨ç±»æ¥å…³è”æ¯ä¸€ä¸ªæ ‡ç­¾å…ƒç´ ã€‚</p><p>ï¼ˆ6ï¼‰äº†è§£å“ªäº›å±æ€§æ˜¯å¯ä»¥é€šè¿‡ç»§æ‰¿è€Œæ¥çš„ï¼Œç„¶åé¿å…å¯¹è¿™äº›å±æ€§é‡å¤æŒ‡å®šè§„åˆ™ã€‚</p><p><strong>æ¸²æŸ“æ€§èƒ½ï¼š</strong></p><p>ï¼ˆ1ï¼‰æ…é‡ä½¿ç”¨é«˜æ€§èƒ½å±æ€§ï¼šæµ®åŠ¨ã€å®šä½ã€‚</p><p>ï¼ˆ2ï¼‰å°½é‡å‡å°‘é¡µé¢é‡æ’ã€é‡ç»˜ã€‚</p><p>ï¼ˆ3ï¼‰å»é™¤ç©ºè§„åˆ™ï¼šï½›ï½ã€‚ç©ºè§„åˆ™çš„äº§ç”ŸåŸå› ä¸€èˆ¬æ¥è¯´æ˜¯ä¸ºäº†é¢„ç•™æ ·å¼ã€‚å»é™¤è¿™äº›ç©ºè§„åˆ™æ— ç–‘èƒ½å‡å°‘cssæ–‡æ¡£ä½“ç§¯ã€‚</p><p>ï¼ˆ4ï¼‰å±æ€§å€¼ä¸º0æ—¶ï¼Œä¸åŠ å•ä½ã€‚</p><p>ï¼ˆ5ï¼‰å±æ€§å€¼ä¸ºæµ®åŠ¨å°æ•°0.**ï¼Œå¯ä»¥çœç•¥å°æ•°ç‚¹ä¹‹å‰çš„0ã€‚</p><p>ï¼ˆ6ï¼‰æ ‡å‡†åŒ–å„ç§æµè§ˆå™¨å‰ç¼€ï¼šå¸¦æµè§ˆå™¨å‰ç¼€çš„åœ¨å‰ã€‚æ ‡å‡†å±æ€§åœ¨åã€‚</p><p>ï¼ˆ7ï¼‰ä¸ä½¿ç”¨@importå‰ç¼€ï¼Œå®ƒä¼šå½±å“cssçš„åŠ è½½é€Ÿåº¦ã€‚</p><p>ï¼ˆ8ï¼‰é€‰æ‹©å™¨ä¼˜åŒ–åµŒå¥—ï¼Œå°½é‡é¿å…å±‚çº§è¿‡æ·±ã€‚</p><p>ï¼ˆ9ï¼‰cssé›ªç¢§å›¾ï¼ŒåŒä¸€é¡µé¢ç›¸è¿‘éƒ¨åˆ†çš„å°å›¾æ ‡ï¼Œæ–¹ä¾¿ä½¿ç”¨ï¼Œå‡å°‘é¡µé¢çš„è¯·æ±‚æ¬¡æ•°ï¼Œä½†æ˜¯åŒæ—¶å›¾ç‰‡æœ¬èº«ä¼šå˜å¤§ï¼Œä½¿ç”¨æ—¶ï¼Œä¼˜åŠ£è€ƒè™‘æ¸…æ¥šï¼Œå†ä½¿ç”¨ã€‚</p><p>ï¼ˆ10ï¼‰æ­£ç¡®ä½¿ç”¨displayçš„å±æ€§ï¼Œç”±äºdisplayçš„ä½œç”¨ï¼ŒæŸäº›æ ·å¼ç»„åˆä¼šæ— æ•ˆï¼Œå¾’å¢æ ·å¼ä½“ç§¯çš„åŒæ—¶ä¹Ÿå½±å“è§£ææ€§èƒ½ã€‚</p><p>ï¼ˆ11ï¼‰ä¸æ»¥ç”¨webå­—ä½“ã€‚å¯¹äºä¸­æ–‡ç½‘ç«™æ¥è¯´WebFontså¯èƒ½å¾ˆé™Œç”Ÿï¼Œå›½å¤–å´å¾ˆæµè¡Œã€‚web fontsé€šå¸¸ä½“ç§¯åºå¤§ï¼Œè€Œä¸”ä¸€äº›æµè§ˆå™¨åœ¨ä¸‹è½½web fontsæ—¶ä¼šé˜»å¡é¡µé¢æ¸²æŸ“æŸä¼¤æ€§èƒ½ã€‚</p><p><strong>å¯ç»´æŠ¤æ€§ã€å¥å£®æ€§ï¼š</strong></p><p>ï¼ˆ1ï¼‰å°†å…·æœ‰ç›¸åŒå±æ€§çš„æ ·å¼æŠ½ç¦»å‡ºæ¥ï¼Œæ•´åˆå¹¶é€šè¿‡classåœ¨é¡µé¢ä¸­è¿›è¡Œä½¿ç”¨ï¼Œæé«˜cssçš„å¯ç»´æŠ¤æ€§ã€‚</p><p>ï¼ˆ2ï¼‰æ ·å¼ä¸å†…å®¹åˆ†ç¦»ï¼šå°†cssä»£ç å®šä¹‰åˆ°å¤–éƒ¨cssä¸­ã€‚</p><h3 id="22-CSSé¢„å¤„ç†å™¨-åå¤„ç†å™¨æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆè¦ä½¿ç”¨å®ƒä»¬ï¼Ÿ"><a href="#22-CSSé¢„å¤„ç†å™¨-åå¤„ç†å™¨æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆè¦ä½¿ç”¨å®ƒä»¬ï¼Ÿ" class="headerlink" title="22. CSSé¢„å¤„ç†å™¨/åå¤„ç†å™¨æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆè¦ä½¿ç”¨å®ƒä»¬ï¼Ÿ"></a>22. CSSé¢„å¤„ç†å™¨/åå¤„ç†å™¨æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆè¦ä½¿ç”¨å®ƒä»¬ï¼Ÿ</h3><p><strong>é¢„å¤„ç†å™¨ï¼Œ</strong> å¦‚ï¼š<code>less</code>ï¼Œ<code>sass</code>ï¼Œ<code>stylus</code>ï¼Œç”¨æ¥é¢„ç¼–è¯‘<code>sass</code>æˆ–è€…<code>less</code>ï¼Œå¢åŠ äº†<code>css</code>ä»£ç çš„å¤ç”¨æ€§ã€‚å±‚çº§ï¼Œ<code>mixin</code>ï¼Œ å˜é‡ï¼Œå¾ªç¯ï¼Œ å‡½æ•°ç­‰å¯¹ç¼–å†™ä»¥åŠå¼€å‘UIç»„ä»¶éƒ½æä¸ºæ–¹ä¾¿ã€‚</p><p><strong>åå¤„ç†å™¨ï¼Œ</strong> å¦‚ï¼š <code>postCss</code>ï¼Œé€šå¸¸æ˜¯åœ¨å®Œæˆçš„æ ·å¼è¡¨ä¸­æ ¹æ®<code>css</code>è§„èŒƒå¤„ç†<code>css</code>ï¼Œè®©å…¶æ›´åŠ æœ‰æ•ˆã€‚ç›®å‰æœ€å¸¸åšçš„æ˜¯ç»™<code>css</code>å±æ€§æ·»åŠ æµè§ˆå™¨ç§æœ‰å‰ç¼€ï¼Œå®ç°è·¨æµè§ˆå™¨å…¼å®¹æ€§çš„é—®é¢˜ã€‚</p><p><code>css</code>é¢„å¤„ç†å™¨ä¸º<code>css</code>å¢åŠ ä¸€äº›ç¼–ç¨‹ç‰¹æ€§ï¼Œæ— éœ€è€ƒè™‘æµè§ˆå™¨çš„å…¼å®¹é—®é¢˜ï¼Œå¯ä»¥åœ¨<code>CSS</code>ä¸­ä½¿ç”¨å˜é‡ï¼Œç®€å•çš„é€»è¾‘ç¨‹åºï¼Œå‡½æ•°ç­‰åœ¨ç¼–ç¨‹è¯­è¨€ä¸­çš„ä¸€äº›åŸºæœ¬çš„æ€§èƒ½ï¼Œå¯ä»¥è®©<code>css</code>æ›´åŠ çš„ç®€æ´ï¼Œå¢åŠ é€‚åº”æ€§ä»¥åŠå¯è¯»æ€§ï¼Œå¯ç»´æŠ¤æ€§ç­‰ã€‚</p><p>å…¶å®ƒ<code>css</code>é¢„å¤„ç†å™¨è¯­è¨€ï¼š<code>Sassï¼ˆScssï¼‰</code>, <code>Less</code>, <code>Stylus</code>, <code>Turbine</code>, <code>Swithch css</code>, <code>CSS Cacheer</code>, <code>DT Css</code>ã€‚</p><p>ä½¿ç”¨åŸå› ï¼š</p><ul><li>ç»“æ„æ¸…æ™°ï¼Œ ä¾¿äºæ‰©å±•</li><li>å¯ä»¥å¾ˆæ–¹ä¾¿çš„å±è”½æµè§ˆå™¨ç§æœ‰è¯­æ³•çš„å·®å¼‚</li><li>å¯ä»¥è½»æ¾å®ç°å¤šé‡ç»§æ‰¿</li><li>å®Œç¾çš„å…¼å®¹äº†<code>CSS</code>ä»£ç ï¼Œå¯ä»¥åº”ç”¨åˆ°è€é¡¹ç›®ä¸­</li></ul><h3 id="23-before-å’Œ-after-çš„åŒå†’å·å’Œå•å†’å·æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"><a href="#23-before-å’Œ-after-çš„åŒå†’å·å’Œå•å†’å·æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ" class="headerlink" title="23. ::before å’Œ :after çš„åŒå†’å·å’Œå•å†’å·æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"></a>23. ::before å’Œ :after çš„åŒå†’å·å’Œå•å†’å·æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h3><p>ï¼ˆ1ï¼‰å†’å·(<code>:</code>)ç”¨äº<code>CSS3</code>ä¼ªç±»ï¼ŒåŒå†’å·(<code>::</code>)ç”¨äº<code>CSS3</code>ä¼ªå…ƒç´ ã€‚<br>ï¼ˆ2ï¼‰<code>::before</code>å°±æ˜¯ä»¥ä¸€ä¸ªå­å…ƒç´ çš„å­˜åœ¨ï¼Œå®šä¹‰åœ¨å…ƒç´ ä¸»ä½“å†…å®¹ä¹‹å‰çš„ä¸€ä¸ªä¼ªå…ƒç´ ã€‚å¹¶ä¸å­˜åœ¨äº<code>dom</code>ä¹‹ä¸­ï¼Œåªå­˜åœ¨åœ¨é¡µé¢ä¹‹ä¸­ã€‚</p><p><strong>æ³¨æ„ï¼š</strong> <code>:before</code>å’Œ <code>:after</code> è¿™ä¸¤ä¸ªä¼ªå…ƒç´ ï¼Œæ˜¯åœ¨<code>CSS2.1</code>é‡Œæ–°å‡ºç°çš„ã€‚èµ·åˆï¼Œä¼ªå…ƒç´ çš„å‰ç¼€ä½¿ç”¨çš„æ˜¯å•å†’å·è¯­æ³•ï¼Œä½†éšç€<code>Web</code>çš„è¿›åŒ–ï¼Œåœ¨<code>CSS3</code>çš„è§„èŒƒé‡Œï¼Œä¼ªå…ƒç´ çš„è¯­æ³•è¢«ä¿®æ”¹æˆä½¿ç”¨åŒå†’å·ï¼Œæˆä¸º<code>::before</code>ã€<code>::after</code>ã€‚</p><h3 id="24-display-inline-block-ä»€ä¹ˆæ—¶å€™ä¼šæ˜¾ç¤ºé—´éš™ï¼Ÿ"><a href="#24-display-inline-block-ä»€ä¹ˆæ—¶å€™ä¼šæ˜¾ç¤ºé—´éš™ï¼Ÿ" class="headerlink" title="24. display:inline-block ä»€ä¹ˆæ—¶å€™ä¼šæ˜¾ç¤ºé—´éš™ï¼Ÿ"></a>24. display:inline-block ä»€ä¹ˆæ—¶å€™ä¼šæ˜¾ç¤ºé—´éš™ï¼Ÿ</h3><ul><li>æœ‰ç©ºæ ¼æ—¶ä¼šæœ‰é—´éš™ï¼Œå¯ä»¥åˆ é™¤ç©ºæ ¼è§£å†³ï¼›</li><li><code>margin</code>æ­£å€¼æ—¶ï¼Œå¯ä»¥è®©<code>margin</code>ä½¿ç”¨è´Ÿå€¼è§£å†³ï¼›</li><li>ä½¿ç”¨<code>font-size</code>æ—¶ï¼Œå¯é€šè¿‡è®¾ç½®<code>font-size:0</code>ã€<code>letter-spacing</code>ã€<code>word-spacing</code>è§£å†³ï¼›</li></ul><h3 id="25-å•è¡Œã€å¤šè¡Œæ–‡æœ¬æº¢å‡ºéšè—"><a href="#25-å•è¡Œã€å¤šè¡Œæ–‡æœ¬æº¢å‡ºéšè—" class="headerlink" title="25. å•è¡Œã€å¤šè¡Œæ–‡æœ¬æº¢å‡ºéšè—"></a>25. å•è¡Œã€å¤šè¡Œæ–‡æœ¬æº¢å‡ºéšè—</h3><ul><li>å•è¡Œæ–‡æœ¬æº¢å‡º</li></ul><pre class="line-numbers language-css"><code class="language-css"><span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>            // æº¢å‡ºéšè—<span class="token property">text-overflow</span><span class="token punctuation">:</span> ellipsis<span class="token punctuation">;</span>      // æº¢å‡ºç”¨çœç•¥å·æ˜¾ç¤º<span class="token property">white-space</span><span class="token punctuation">:</span> nowrap<span class="token punctuation">;</span>         // è§„å®šæ®µè½ä¸­çš„æ–‡æœ¬ä¸è¿›è¡Œæ¢è¡Œ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ul><li>å¤šè¡Œæ–‡æœ¬æº¢å‡º</li></ul><pre class="line-numbers language-css"><code class="language-css"><span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>            // æº¢å‡ºéšè—<span class="token property">text-overflow</span><span class="token punctuation">:</span> ellipsis<span class="token punctuation">;</span>     // æº¢å‡ºç”¨çœç•¥å·æ˜¾ç¤º<span class="token property">display</span><span class="token punctuation">:</span>-webkit-box<span class="token punctuation">;</span>         // ä½œä¸ºå¼¹æ€§ä¼¸ç¼©ç›’å­æ¨¡å‹æ˜¾ç¤ºã€‚<span class="token property">-webkit-box-orient</span><span class="token punctuation">:</span>vertical<span class="token punctuation">;</span> // è®¾ç½®ä¼¸ç¼©ç›’å­çš„å­å…ƒç´ æ’åˆ—æ–¹å¼ï¼šä»ä¸Šåˆ°ä¸‹å‚ç›´æ’åˆ—<span class="token property">-webkit-line-clamp</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">;</span>        // æ˜¾ç¤ºçš„è¡Œæ•°<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ³¨æ„ï¼šç”±äºä¸Šé¢çš„ä¸‰ä¸ªå±æ€§éƒ½æ˜¯ CSS3 çš„å±æ€§ï¼Œæ²¡æœ‰æµè§ˆå™¨å¯ä»¥å…¼å®¹ï¼Œæ‰€ä»¥è¦åœ¨å‰é¢åŠ ä¸€ä¸ª<code>-webkit-</code> æ¥å…¼å®¹ä¸€éƒ¨åˆ†æµè§ˆå™¨ã€‚</p><h3 id="26-Sassã€Less-æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆè¦ä½¿ç”¨ä»–ä»¬ï¼Ÿ"><a href="#26-Sassã€Less-æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆè¦ä½¿ç”¨ä»–ä»¬ï¼Ÿ" class="headerlink" title="26. Sassã€Less æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆè¦ä½¿ç”¨ä»–ä»¬ï¼Ÿ"></a>26. Sassã€Less æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆè¦ä½¿ç”¨ä»–ä»¬ï¼Ÿ</h3><p>ä»–ä»¬éƒ½æ˜¯ CSS é¢„å¤„ç†å™¨ï¼Œæ˜¯ CSS ä¸Šçš„ä¸€ç§æŠ½è±¡å±‚ã€‚ä»–ä»¬æ˜¯ä¸€ç§ç‰¹æ®Šçš„è¯­æ³•/è¯­è¨€ç¼–è¯‘æˆ CSSã€‚ ä¾‹å¦‚ Less æ˜¯ä¸€ç§åŠ¨æ€æ ·å¼è¯­è¨€ï¼Œå°† CSS èµ‹äºˆäº†åŠ¨æ€è¯­è¨€çš„ç‰¹æ€§ï¼Œå¦‚å˜é‡ï¼Œç»§æ‰¿ï¼Œè¿ç®—ï¼Œ å‡½æ•°ï¼ŒLESS æ—¢å¯ä»¥åœ¨å®¢æˆ·ç«¯ä¸Šè¿è¡Œ (æ”¯æŒ IE 6+, Webkit, Firefox)ï¼Œä¹Ÿå¯ä»¥åœ¨æœåŠ¡ç«¯è¿è¡Œ (å€ŸåŠ© Node.js)ã€‚ </p><p><strong>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å®ƒä»¬ï¼Ÿ</strong></p><ul><li>ç»“æ„æ¸…æ™°ï¼Œä¾¿äºæ‰©å±•ã€‚ å¯ä»¥æ–¹ä¾¿åœ°å±è”½æµè§ˆå™¨ç§æœ‰è¯­æ³•å·®å¼‚ã€‚å°è£…å¯¹æµè§ˆå™¨è¯­æ³•å·®å¼‚çš„é‡å¤å¤„ç†ï¼Œ å‡å°‘æ— æ„ä¹‰çš„æœºæ¢°åŠ³åŠ¨ã€‚ </li><li>å¯ä»¥è½»æ¾å®ç°å¤šé‡ç»§æ‰¿ã€‚ å®Œå…¨å…¼å®¹ CSS ä»£ç ï¼Œå¯ä»¥æ–¹ä¾¿åœ°åº”ç”¨åˆ°è€é¡¹ç›®ä¸­ã€‚LESS åªæ˜¯åœ¨ CSS è¯­æ³•ä¸Šåšäº†æ‰©å±•ï¼Œæ‰€ä»¥è€çš„ CSS ä»£ç ä¹Ÿå¯ä»¥ä¸ LESS ä»£ç ä¸€åŒç¼–è¯‘ã€‚</li></ul><h3 id="27-å¯¹åª’ä½“æŸ¥è¯¢çš„ç†è§£ï¼Ÿ"><a href="#27-å¯¹åª’ä½“æŸ¥è¯¢çš„ç†è§£ï¼Ÿ" class="headerlink" title="27. å¯¹åª’ä½“æŸ¥è¯¢çš„ç†è§£ï¼Ÿ"></a>27. å¯¹åª’ä½“æŸ¥è¯¢çš„ç†è§£ï¼Ÿ</h3><p>åª’ä½“æŸ¥è¯¢ç”±â¼€ä¸ªå¯é€‰çš„åª’ä½“ç±»å‹å’Œé›¶ä¸ªæˆ–å¤šä¸ªä½¿â½¤åª’ä½“åŠŸèƒ½çš„é™åˆ¶äº†æ ·å¼è¡¨èŒƒå›´çš„è¡¨è¾¾å¼ç»„æˆï¼Œä¾‹å¦‚å®½åº¦ã€â¾¼åº¦å’Œé¢œâ¾Šã€‚åª’ä½“æŸ¥è¯¢ï¼Œæ·»åŠ â¾ƒCSS3ï¼Œå…è®¸å†…å®¹çš„å‘ˆç°é’ˆå¯¹â¼€ä¸ªç‰¹å®šèŒƒå›´çš„è¾“å‡ºè®¾å¤‡â½½è¿›â¾è£å‰ªï¼Œâ½½ä¸å¿…æ”¹å˜å†…å®¹æœ¬èº«ï¼Œé€‚åˆwebâ½¹â»šåº”å¯¹ä¸åŒå‹å·çš„è®¾å¤‡â½½åšå‡ºå¯¹åº”çš„å“åº”é€‚é…ã€‚ </p><p>åª’ä½“æŸ¥è¯¢åŒ…å«â¼€ä¸ªå¯é€‰çš„åª’ä½“ç±»å‹å’Œæ»¡â¾œCSS3è§„èŒƒçš„æ¡ä»¶ä¸‹ï¼ŒåŒ…å«é›¶ä¸ªæˆ–å¤šä¸ªè¡¨è¾¾å¼ï¼Œè¿™äº›è¡¨è¾¾å¼æè¿°äº†åª’ä½“ç‰¹å¾ï¼Œæœ€ç»ˆä¼šè¢«è§£æä¸ºtrueæˆ–falseã€‚å¦‚æœåª’ä½“æŸ¥è¯¢ä¸­æŒ‡å®šçš„åª’ä½“ç±»å‹åŒ¹é…å±•ç¤ºâ½‚æ¡£æ‰€ä½¿â½¤çš„è®¾å¤‡ç±»å‹ï¼Œå¹¶ä¸”æ‰€æœ‰çš„è¡¨è¾¾å¼çš„å€¼éƒ½æ˜¯trueï¼Œé‚£ä¹ˆè¯¥åª’ä½“æŸ¥è¯¢çš„ç»“æœä¸ºtrueã€‚é‚£ä¹ˆåª’ä½“æŸ¥è¯¢å†…çš„æ ·å¼å°†ä¼šâ½£æ•ˆã€‚ </p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> linkå…ƒç´ ä¸­çš„CSSåª’ä½“æŸ¥è¯¢ <span class="token operator">--</span><span class="token operator">></span> <span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string">"stylesheet"</span> media<span class="token operator">=</span><span class="token string">"(max-width: 800px)"</span> href<span class="token operator">=</span><span class="token string">"example.css"</span> <span class="token operator">/</span><span class="token operator">></span> <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> æ ·å¼è¡¨ä¸­çš„CSSåª’ä½“æŸ¥è¯¢ <span class="token operator">--</span><span class="token operator">></span> <span class="token operator">&lt;</span>style<span class="token operator">></span> @media <span class="token punctuation">(</span>max<span class="token operator">-</span>width<span class="token punctuation">:</span> 600px<span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token punctuation">.</span>facet_sidebar <span class="token punctuation">{</span>     display<span class="token punctuation">:</span> none<span class="token punctuation">;</span>   <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç®€å•æ¥è¯´ï¼Œä½¿ç”¨ @media æŸ¥è¯¢ï¼Œå¯ä»¥é’ˆå¯¹ä¸åŒçš„åª’ä½“ç±»å‹å®šä¹‰ä¸åŒçš„æ ·å¼ã€‚@media å¯ä»¥é’ˆå¯¹ä¸åŒçš„å±å¹•å°ºå¯¸è®¾ç½®ä¸åŒçš„æ ·å¼ï¼Œç‰¹åˆ«æ˜¯éœ€è¦è®¾ç½®è®¾è®¡å“åº”å¼çš„é¡µé¢ï¼Œ@media æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚å½“é‡ç½®æµè§ˆå™¨å¤§å°çš„è¿‡ç¨‹ä¸­ï¼Œé¡µé¢ä¹Ÿä¼šæ ¹æ®æµè§ˆå™¨çš„å®½åº¦å’Œé«˜åº¦é‡æ–°æ¸²æŸ“é¡µé¢ã€‚</p><h3 id="28-å¯¹-CSS-å·¥ç¨‹åŒ–çš„ç†è§£"><a href="#28-å¯¹-CSS-å·¥ç¨‹åŒ–çš„ç†è§£" class="headerlink" title="28. å¯¹ CSS å·¥ç¨‹åŒ–çš„ç†è§£"></a>28. å¯¹ CSS å·¥ç¨‹åŒ–çš„ç†è§£</h3><p>CSS å·¥ç¨‹åŒ–æ˜¯ä¸ºäº†è§£å†³ä»¥ä¸‹é—®é¢˜ï¼š</p><ol><li><strong>å®è§‚è®¾è®¡</strong>ï¼šCSS ä»£ç å¦‚ä½•ç»„ç»‡ã€å¦‚ä½•æ‹†åˆ†ã€æ¨¡å—ç»“æ„æ€æ ·è®¾è®¡ï¼Ÿ</li><li><strong>ç¼–ç ä¼˜åŒ–</strong>ï¼šæ€æ ·å†™å‡ºæ›´å¥½çš„ CSSï¼Ÿ</li><li><strong>æ„å»º</strong>ï¼šå¦‚ä½•å¤„ç†æˆ‘çš„ CSSï¼Œæ‰èƒ½è®©å®ƒçš„æ‰“åŒ…ç»“æœæœ€ä¼˜ï¼Ÿ</li><li><strong>å¯ç»´æŠ¤æ€§</strong>ï¼šä»£ç å†™å®Œäº†ï¼Œå¦‚ä½•æœ€å°åŒ–å®ƒåç»­çš„å˜æ›´æˆæœ¬ï¼Ÿå¦‚ä½•ç¡®ä¿ä»»ä½•ä¸€ä¸ªåŒäº‹éƒ½èƒ½è½»æ¾æ¥æ‰‹ï¼Ÿ</li></ol><p>ä»¥ä¸‹ä¸‰ä¸ªæ–¹å‘éƒ½æ˜¯æ—¶ä¸‹æ¯”è¾ƒæµè¡Œçš„ã€æ™®é€‚æ€§éå¸¸å¥½çš„ CSS å·¥ç¨‹åŒ–å®è·µï¼š</p><ul><li>é¢„å¤„ç†å™¨ï¼šLessã€ Sass ç­‰ï¼›</li><li>é‡è¦çš„å·¥ç¨‹åŒ–æ’ä»¶ï¼š PostCssï¼›</li><li>Webpack loader ç­‰ ã€‚</li></ul><p>åŸºäºè¿™ä¸‰ä¸ªæ–¹å‘ï¼Œå¯ä»¥è¡ç”Ÿå‡ºä¸€äº›å…·æœ‰å…¸å‹æ„ä¹‰çš„å­é—®é¢˜ï¼Œè¿™é‡Œæˆ‘ä»¬é€ä¸ªæ¥çœ‹ï¼š</p><p><strong>ï¼ˆ1ï¼‰é¢„å¤„ç†å™¨ï¼šä¸ºä»€ä¹ˆè¦ç”¨é¢„å¤„ç†å™¨ï¼Ÿå®ƒçš„å‡ºç°æ˜¯ä¸ºäº†è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ</strong></p><p>é¢„å¤„ç†å™¨ï¼Œå…¶å®å°±æ˜¯ CSS ä¸–ç•Œçš„â€œè½®å­â€ã€‚é¢„å¤„ç†å™¨æ”¯æŒæˆ‘ä»¬å†™ä¸€ç§ç±»ä¼¼ CSSã€ä½†å®é™…å¹¶ä¸æ˜¯ CSS çš„è¯­è¨€ï¼Œç„¶åæŠŠå®ƒç¼–è¯‘æˆ CSS ä»£ç ï¼š<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/CSS/5.png" alt=""><br>é‚£ä¸ºä»€ä¹ˆå†™ CSS ä»£ç å†™å¾—å¥½å¥½çš„ï¼Œååè¦è½¬å»å†™â€œç±» CSSâ€å‘¢ï¼Ÿè¿™å°±å’Œæœ¬æ¥ç”¨ JS ä¹Ÿå¯ä»¥å®ç°æ‰€æœ‰åŠŸèƒ½ï¼Œä½†æœ€åå´å†™ React çš„ jsx æˆ–è€… Vue çš„æ¨¡æ¿è¯­æ³•ä¸€æ ·â€”â€”ä¸ºäº†çˆ½ï¼è¦æƒ³çŸ¥é“æœ‰äº†é¢„å¤„ç†å™¨æœ‰å¤šçˆ½ï¼Œé¦–å…ˆè¦çŸ¥é“çš„æ˜¯ä¼ ç»Ÿ CSS æœ‰å¤šä¸çˆ½ã€‚éšç€å‰ç«¯ä¸šåŠ¡å¤æ‚åº¦çš„æé«˜ï¼Œå‰ç«¯å·¥ç¨‹ä¸­å¯¹ CSS æå‡ºäº†ä»¥ä¸‹çš„è¯‰æ±‚ï¼š</p><ol><li>å®è§‚è®¾è®¡ä¸Šï¼šæˆ‘ä»¬å¸Œæœ›èƒ½ä¼˜åŒ– CSS æ–‡ä»¶çš„ç›®å½•ç»“æ„ï¼Œå¯¹ç°æœ‰çš„ CSS æ–‡ä»¶å®ç°å¤ç”¨ï¼›</li><li>ç¼–ç ä¼˜åŒ–ä¸Šï¼šæˆ‘ä»¬å¸Œæœ›èƒ½å†™å‡ºç»“æ„æ¸…æ™°ã€ç®€æ˜æ˜“æ‡‚çš„ CSSï¼Œéœ€è¦å®ƒå…·æœ‰ä¸€ç›®äº†ç„¶çš„åµŒå¥—å±‚çº§å…³ç³»ï¼Œè€Œä¸æ˜¯æ— å·®åˆ«çš„ä¸€é“ºåˆ°åº•å†™æ³•ï¼›æˆ‘ä»¬å¸Œæœ›å®ƒå…·æœ‰å˜é‡ç‰¹å¾ã€è®¡ç®—èƒ½åŠ›ã€å¾ªç¯èƒ½åŠ›ç­‰ç­‰æ›´å¼ºçš„å¯ç¼–ç¨‹æ€§ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥å°‘å†™ä¸€äº›æ— ç”¨çš„ä»£ç ï¼›</li><li>å¯ç»´æŠ¤æ€§ä¸Šï¼šæ›´å¼ºçš„å¯ç¼–ç¨‹æ€§æ„å‘³ç€æ›´ä¼˜è´¨çš„ä»£ç ç»“æ„ï¼Œå®ç°å¤ç”¨æ„å‘³ç€æ›´ç®€å•çš„ç›®å½•ç»“æ„å’Œæ›´å¼ºçš„æ‹“å±•èƒ½åŠ›ï¼Œè¿™ä¸¤ç‚¹å¦‚æœèƒ½åšåˆ°ï¼Œè‡ªç„¶ä¼šå¸¦æ¥æ›´å¼ºçš„å¯ç»´æŠ¤æ€§ã€‚</li></ol><p>è¿™ä¸‰ç‚¹æ˜¯ä¼ ç»Ÿ CSS æ‰€åšä¸åˆ°çš„ï¼Œä¹Ÿæ­£æ˜¯é¢„å¤„ç†å™¨æ‰€è§£å†³æ‰çš„é—®é¢˜ã€‚é¢„å¤„ç†å™¨æ™®éä¼šå…·å¤‡è¿™æ ·çš„ç‰¹æ€§ï¼š</p><ul><li>åµŒå¥—ä»£ç çš„èƒ½åŠ›ï¼Œé€šè¿‡åµŒå¥—æ¥åæ˜ ä¸åŒ css å±æ€§ä¹‹é—´çš„å±‚çº§å…³ç³» ï¼›</li><li>æ”¯æŒå®šä¹‰ css å˜é‡ï¼›</li><li>æä¾›è®¡ç®—å‡½æ•°ï¼›</li><li>å…è®¸å¯¹ä»£ç ç‰‡æ®µè¿›è¡Œ extend å’Œ mixinï¼›</li><li>æ”¯æŒå¾ªç¯è¯­å¥çš„ä½¿ç”¨ï¼›</li><li>æ”¯æŒå°† CSS æ–‡ä»¶æ¨¡å—åŒ–ï¼Œå®ç°å¤ç”¨ã€‚</li></ul><p><strong>ï¼ˆ2ï¼‰PostCssï¼šPostCss æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿæˆ‘ä»¬åœ¨ä»€ä¹ˆåœºæ™¯ä¸‹ä¼šä½¿ç”¨ PostCssï¼Ÿ</strong></p><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/CSS/6.png" alt=""><br>å®ƒå’Œé¢„å¤„ç†å™¨çš„ä¸åŒå°±åœ¨äºï¼Œé¢„å¤„ç†å™¨å¤„ç†çš„æ˜¯ ç±»CSSï¼Œè€Œ PostCss å¤„ç†çš„å°±æ˜¯ CSS æœ¬èº«ã€‚Babel å¯ä»¥å°†é«˜ç‰ˆæœ¬çš„ JS ä»£ç è½¬æ¢ä¸ºä½ç‰ˆæœ¬çš„ JS ä»£ç ã€‚PostCss åšçš„æ˜¯ç±»ä¼¼çš„äº‹æƒ…ï¼šå®ƒå¯ä»¥ç¼–è¯‘å°šæœªè¢«æµè§ˆå™¨å¹¿æ³›æ”¯æŒçš„å…ˆè¿›çš„ CSS è¯­æ³•ï¼Œè¿˜å¯ä»¥è‡ªåŠ¨ä¸ºä¸€äº›éœ€è¦é¢å¤–å…¼å®¹çš„è¯­æ³•å¢åŠ å‰ç¼€ã€‚æ›´å¼ºçš„æ˜¯ï¼Œç”±äº PostCss æœ‰ç€å¼ºå¤§çš„æ’ä»¶æœºåˆ¶ï¼Œæ”¯æŒå„ç§å„æ ·çš„æ‰©å±•ï¼Œæå¤§åœ°å¼ºåŒ–äº† CSS çš„èƒ½åŠ›ã€‚</p><p>PostCss åœ¨ä¸šåŠ¡ä¸­çš„ä½¿ç”¨åœºæ™¯éå¸¸å¤šï¼š</p><ul><li>æé«˜ CSS ä»£ç çš„å¯è¯»æ€§ï¼šPostCss å…¶å®å¯ä»¥åšç±»ä¼¼é¢„å¤„ç†å™¨èƒ½åšçš„å·¥ä½œï¼›</li><li>å½“æˆ‘ä»¬çš„ CSS ä»£ç éœ€è¦é€‚é…ä½ç‰ˆæœ¬æµè§ˆå™¨æ—¶ï¼ŒPostCss çš„ <a href="https://github.com/postcss/autoprefixer">Autoprefixer</a> æ’ä»¶å¯ä»¥å¸®åŠ©æˆ‘ä»¬è‡ªåŠ¨å¢åŠ æµè§ˆå™¨å‰ç¼€ï¼›</li><li>å…è®¸æˆ‘ä»¬ç¼–å†™é¢å‘æœªæ¥çš„ CSSï¼šPostCss èƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬ç¼–è¯‘ CSS next ä»£ç ï¼›</li></ul><p><strong>ï¼ˆ3ï¼‰Webpack èƒ½å¤„ç† CSS å—ï¼Ÿå¦‚ä½•å®ç°ï¼Ÿ</strong><br>Webpack èƒ½å¤„ç† CSS å—ï¼š</p><ul><li><strong>Webpack åœ¨è£¸å¥”çš„çŠ¶æ€ä¸‹ï¼Œæ˜¯ä¸èƒ½å¤„ç† CSS çš„</strong>ï¼ŒWebpack æœ¬èº«æ˜¯ä¸€ä¸ªé¢å‘ JavaScript ä¸”åªèƒ½å¤„ç† JavaScript ä»£ç çš„æ¨¡å—åŒ–æ‰“åŒ…å·¥å…·ï¼›</li><li>Webpack åœ¨ loader çš„è¾…åŠ©ä¸‹ï¼Œæ˜¯å¯ä»¥å¤„ç† CSS çš„ã€‚</li></ul><p>å¦‚ä½•ç”¨ Webpack å®ç°å¯¹ CSS çš„å¤„ç†ï¼š</p><ul><li>Webpack ä¸­æ“ä½œ CSS éœ€è¦ä½¿ç”¨çš„ä¸¤ä¸ªå…³é”®çš„ loaderï¼šcss-loader å’Œ style-loader</li><li>æ³¨æ„ï¼Œç­”å‡ºâ€œç”¨ä»€ä¹ˆâ€æœ‰æ—¶å€™å¯èƒ½è¿˜ä¸å¤Ÿï¼Œé¢è¯•å®˜ä¼šæ€€ç–‘ä½ æ˜¯ä¸æ˜¯åœ¨èƒŒç­”æ¡ˆï¼Œæ‰€ä»¥ä½ è¿˜éœ€è¦äº†è§£æ¯ä¸ª loader éƒ½åšäº†ä»€ä¹ˆäº‹æƒ…ï¼š<ul><li>css-loaderï¼šå¯¼å…¥ CSS æ¨¡å—ï¼Œå¯¹ CSS ä»£ç è¿›è¡Œç¼–è¯‘å¤„ç†ï¼›</li><li>style-loaderï¼šåˆ›å»ºstyleæ ‡ç­¾ï¼ŒæŠŠ CSS å†…å®¹å†™å…¥æ ‡ç­¾ã€‚</li></ul></li></ul><p>åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œ<strong>css-loader çš„æ‰§è¡Œé¡ºåºä¸€å®šè¦å®‰æ’åœ¨ style-loader çš„å‰é¢</strong>ã€‚å› ä¸ºåªæœ‰å®Œæˆäº†ç¼–è¯‘è¿‡ç¨‹ï¼Œæ‰å¯ä»¥å¯¹ css ä»£ç è¿›è¡Œæ’å…¥ï¼›è‹¥æå‰æ’å…¥äº†æœªç¼–è¯‘çš„ä»£ç ï¼Œé‚£ä¹ˆ webpack æ˜¯æ— æ³•ç†è§£è¿™å¨ä¸œè¥¿çš„ï¼Œå®ƒä¼šæ— æƒ…æŠ¥é”™ã€‚</p><h3 id="29-å¦‚ä½•åˆ¤æ–­å…ƒç´ æ˜¯å¦åˆ°è¾¾å¯è§†åŒºåŸŸ"><a href="#29-å¦‚ä½•åˆ¤æ–­å…ƒç´ æ˜¯å¦åˆ°è¾¾å¯è§†åŒºåŸŸ" class="headerlink" title="29. å¦‚ä½•åˆ¤æ–­å…ƒç´ æ˜¯å¦åˆ°è¾¾å¯è§†åŒºåŸŸ"></a>29. å¦‚ä½•åˆ¤æ–­å…ƒç´ æ˜¯å¦åˆ°è¾¾å¯è§†åŒºåŸŸ</h3><p>ä»¥å›¾ç‰‡æ˜¾ç¤ºä¸ºä¾‹ï¼š</p><ul><li><code>window.innerHeight</code> æ˜¯æµè§ˆå™¨å¯è§†åŒºçš„é«˜åº¦ï¼›</li><li><code>document.body.scrollTop || document.documentElement.scrollTop</code> æ˜¯æµè§ˆå™¨æ»šåŠ¨çš„è¿‡çš„è·ç¦»ï¼›</li><li><code>imgs.offsetTop</code> æ˜¯å…ƒç´ é¡¶éƒ¨è·ç¦»æ–‡æ¡£é¡¶éƒ¨çš„é«˜åº¦ï¼ˆåŒ…æ‹¬æ»šåŠ¨æ¡çš„è·ç¦»ï¼‰ï¼›</li><li>å†…å®¹è¾¾åˆ°æ˜¾ç¤ºåŒºåŸŸçš„ï¼š<code>img.offsetTop &lt; window.innerHeight + document.body.scrollTop;</code></li></ul><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/CSS/7.png" alt=""></p><h3 id="30-z-indexå±æ€§åœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä¼šå¤±æ•ˆ"><a href="#30-z-indexå±æ€§åœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä¼šå¤±æ•ˆ" class="headerlink" title="30. z-indexå±æ€§åœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä¼šå¤±æ•ˆ"></a>30. z-indexå±æ€§åœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä¼šå¤±æ•ˆ</h3><p>é€šå¸¸ z-index çš„ä½¿ç”¨æ˜¯åœ¨æœ‰ä¸¤ä¸ªé‡å çš„æ ‡ç­¾ï¼Œåœ¨ä¸€å®šçš„æƒ…å†µä¸‹æ§åˆ¶å…¶ä¸­ä¸€ä¸ªåœ¨å¦ä¸€ä¸ªçš„ä¸Šæ–¹æˆ–è€…ä¸‹æ–¹å‡ºç°ã€‚z-indexå€¼è¶Šå¤§å°±è¶Šæ˜¯åœ¨ä¸Šå±‚ã€‚z-indexå…ƒç´ çš„positionå±æ€§éœ€è¦æ˜¯relativeï¼Œabsoluteæˆ–æ˜¯fixedã€‚</p><p>z-indexå±æ€§åœ¨ä¸‹åˆ—æƒ…å†µä¸‹ä¼šå¤±æ•ˆï¼š</p><ul><li>çˆ¶å…ƒç´ positionä¸ºrelativeæ—¶ï¼Œå­å…ƒç´ çš„z-indexå¤±æ•ˆã€‚è§£å†³ï¼šçˆ¶å…ƒç´ positionæ”¹ä¸ºabsoluteæˆ–staticï¼›</li><li>å…ƒç´ æ²¡æœ‰è®¾ç½®positionå±æ€§ä¸ºéstaticå±æ€§ã€‚è§£å†³ï¼šè®¾ç½®è¯¥å…ƒç´ çš„positionå±æ€§ä¸ºrelativeï¼Œabsoluteæˆ–æ˜¯fixedä¸­çš„ä¸€ç§ï¼›</li><li>å…ƒç´ åœ¨è®¾ç½®z-indexçš„åŒæ—¶è¿˜è®¾ç½®äº†floatæµ®åŠ¨ã€‚è§£å†³ï¼šfloatå»é™¤ï¼Œæ”¹ä¸ºdisplayï¼šinline-blockï¼›</li></ul><h3 id="31-CSS3ä¸­çš„transformæœ‰å“ªäº›å±æ€§"><a href="#31-CSS3ä¸­çš„transformæœ‰å“ªäº›å±æ€§" class="headerlink" title="31. CSS3ä¸­çš„transformæœ‰å“ªäº›å±æ€§"></a>31. CSS3ä¸­çš„transformæœ‰å“ªäº›å±æ€§</h3><h2 id="äºŒã€é¡µé¢å¸ƒå±€"><a href="#äºŒã€é¡µé¢å¸ƒå±€" class="headerlink" title="äºŒã€é¡µé¢å¸ƒå±€"></a>äºŒã€é¡µé¢å¸ƒå±€</h2><h3 id="1-å¸¸è§çš„CSSå¸ƒå±€å•ä½"><a href="#1-å¸¸è§çš„CSSå¸ƒå±€å•ä½" class="headerlink" title="1. å¸¸è§çš„CSSå¸ƒå±€å•ä½"></a>1. å¸¸è§çš„CSSå¸ƒå±€å•ä½</h3><p>å¸¸ç”¨çš„å¸ƒå±€å•ä½åŒ…æ‹¬åƒç´ ï¼ˆ<code>px</code>ï¼‰ï¼Œç™¾åˆ†æ¯”ï¼ˆ<code>%</code>ï¼‰ï¼Œ<code>em</code>ï¼Œ<code>rem</code>ï¼Œ<code>vw/vh</code>ã€‚</p><p><strong>ï¼ˆ1ï¼‰åƒç´ </strong>ï¼ˆ<code>px</code>ï¼‰æ˜¯é¡µé¢å¸ƒå±€çš„åŸºç¡€ï¼Œä¸€ä¸ªåƒç´ è¡¨ç¤ºç»ˆç«¯ï¼ˆç”µè„‘ã€æ‰‹æœºã€å¹³æ¿ç­‰ï¼‰å±å¹•æ‰€èƒ½æ˜¾ç¤ºçš„æœ€å°çš„åŒºåŸŸï¼Œåƒç´ åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼šCSSåƒç´ å’Œç‰©ç†åƒç´ ï¼š</p><ul><li><strong>CSSåƒç´ </strong>ï¼šä¸ºwebå¼€å‘è€…æä¾›ï¼Œåœ¨CSSä¸­ä½¿ç”¨çš„ä¸€ä¸ªæŠ½è±¡å•ä½ï¼›</li><li><strong>ç‰©ç†åƒç´ </strong>ï¼šåªä¸è®¾å¤‡çš„ç¡¬ä»¶å¯†åº¦æœ‰å…³ï¼Œä»»ä½•è®¾å¤‡çš„ç‰©ç†åƒç´ éƒ½æ˜¯å›ºå®šçš„ã€‚</li></ul><p><strong>ï¼ˆ2ï¼‰ç™¾åˆ†æ¯”</strong>ï¼ˆ<code>%</code>ï¼‰ï¼Œå½“æµè§ˆå™¨çš„å®½åº¦æˆ–è€…é«˜åº¦å‘ç”Ÿå˜åŒ–æ—¶ï¼Œé€šè¿‡ç™¾åˆ†æ¯”å•ä½å¯ä»¥ä½¿å¾—æµè§ˆå™¨ä¸­çš„ç»„ä»¶çš„å®½å’Œé«˜éšç€æµè§ˆå™¨çš„å˜åŒ–è€Œå˜åŒ–ï¼Œä»è€Œå®ç°å“åº”å¼çš„æ•ˆæœã€‚ä¸€èˆ¬è®¤ä¸ºå­å…ƒç´ çš„ç™¾åˆ†æ¯”ç›¸å¯¹äºç›´æ¥çˆ¶å…ƒç´ ã€‚</p><p><strong>ï¼ˆ3ï¼‰emå’Œrem</strong>ç›¸å¯¹äºpxæ›´å…·çµæ´»æ€§ï¼Œå®ƒä»¬éƒ½æ˜¯ç›¸å¯¹é•¿åº¦å•ä½ï¼Œå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«ï¼š<strong>emç›¸å¯¹äºçˆ¶å…ƒç´ ï¼Œremç›¸å¯¹äºæ ¹å…ƒç´ ã€‚</strong></p><ul><li><strong>emï¼š</strong> æ–‡æœ¬ç›¸å¯¹é•¿åº¦å•ä½ã€‚ç›¸å¯¹äºå½“å‰å¯¹è±¡å†…æ–‡æœ¬çš„å­—ä½“å°ºå¯¸ã€‚å¦‚æœå½“å‰è¡Œå†…æ–‡æœ¬çš„å­—ä½“å°ºå¯¸æœªè¢«äººä¸ºè®¾ç½®ï¼Œåˆ™ç›¸å¯¹äºæµè§ˆå™¨çš„é»˜è®¤å­—ä½“å°ºå¯¸(é»˜è®¤16px)ã€‚(ç›¸å¯¹çˆ¶å…ƒç´ çš„å­—ä½“å¤§å°å€æ•°)ã€‚</li><li><strong>remï¼š</strong> remæ˜¯CSS3æ–°å¢çš„ä¸€ä¸ªç›¸å¯¹å•ä½ï¼Œç›¸å¯¹äºæ ¹å…ƒç´ ï¼ˆhtmlå…ƒç´ ï¼‰çš„font-sizeçš„å€æ•°ã€‚<strong>ä½œç”¨</strong>ï¼šåˆ©ç”¨remå¯ä»¥å®ç°ç®€å•çš„å“åº”å¼å¸ƒå±€ï¼Œå¯ä»¥åˆ©ç”¨htmlå…ƒç´ ä¸­å­—ä½“çš„å¤§å°ä¸å±å¹•é—´çš„æ¯”å€¼æ¥è®¾ç½®font-sizeçš„å€¼ï¼Œä»¥æ­¤å®ç°å½“å±å¹•åˆ†è¾¨ç‡å˜åŒ–æ—¶è®©å…ƒç´ ä¹Ÿéšä¹‹å˜åŒ–ã€‚</li></ul><p><strong>ï¼ˆ4ï¼‰vw/vh</strong>æ˜¯ä¸è§†å›¾çª—å£æœ‰å…³çš„å•ä½ï¼Œvwè¡¨ç¤ºç›¸å¯¹äºè§†å›¾çª—å£çš„å®½åº¦ï¼Œvhè¡¨ç¤ºç›¸å¯¹äºè§†å›¾çª—å£é«˜åº¦ï¼Œé™¤äº†vwå’Œvhå¤–ï¼Œè¿˜æœ‰vminå’Œvmaxä¸¤ä¸ªç›¸å…³çš„å•ä½ã€‚</p><ul><li>vwï¼šç›¸å¯¹äºè§†çª—çš„å®½åº¦ï¼Œè§†çª—å®½åº¦æ˜¯100vwï¼›</li><li>vhï¼šç›¸å¯¹äºè§†çª—çš„é«˜åº¦ï¼Œè§†çª—é«˜åº¦æ˜¯100vhï¼›</li><li>vminï¼švwå’Œvhä¸­çš„è¾ƒå°å€¼ï¼›</li><li>vmaxï¼švwå’Œvhä¸­çš„è¾ƒå¤§å€¼ï¼›</li></ul><p><strong>vw/vh</strong> å’Œç™¾åˆ†æ¯”å¾ˆç±»ä¼¼ï¼Œä¸¤è€…çš„åŒºåˆ«ï¼š</p><ul><li>ç™¾åˆ†æ¯”ï¼ˆ<code>%</code>ï¼‰ï¼šå¤§éƒ¨åˆ†ç›¸å¯¹äºç¥–å…ˆå…ƒç´ ï¼Œä¹Ÿæœ‰ç›¸å¯¹äºè‡ªèº«çš„æƒ…å†µæ¯”å¦‚ï¼ˆborder-radiusã€translateç­‰)</li><li>vw/vmï¼šç›¸å¯¹äºè§†çª—çš„å°ºå¯¸</li></ul><h3 id="2-pxã€emã€remçš„åŒºåˆ«åŠä½¿ç”¨åœºæ™¯"><a href="#2-pxã€emã€remçš„åŒºåˆ«åŠä½¿ç”¨åœºæ™¯" class="headerlink" title="2. pxã€emã€remçš„åŒºåˆ«åŠä½¿ç”¨åœºæ™¯"></a>2. pxã€emã€remçš„åŒºåˆ«åŠä½¿ç”¨åœºæ™¯</h3><p><strong>ä¸‰è€…çš„åŒºåˆ«ï¼š</strong></p><ul><li>pxæ˜¯å›ºå®šçš„åƒç´ ï¼Œä¸€æ—¦è®¾ç½®äº†å°±æ— æ³•å› ä¸ºé€‚åº”é¡µé¢å¤§å°è€Œæ”¹å˜ã€‚</li><li>emå’Œremç›¸å¯¹äºpxæ›´å…·æœ‰çµæ´»æ€§ï¼Œä»–ä»¬æ˜¯ç›¸å¯¹é•¿åº¦å•ä½ï¼Œå…¶é•¿åº¦ä¸æ˜¯å›ºå®šçš„ï¼Œæ›´é€‚ç”¨äºå“åº”å¼å¸ƒå±€ã€‚</li><li>emæ˜¯ç›¸å¯¹äºå…¶çˆ¶å…ƒç´ æ¥è®¾ç½®å­—ä½“å¤§å°ï¼Œè¿™æ ·å°±ä¼šå­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œè¿›è¡Œä»»ä½•å…ƒç´ è®¾ç½®ï¼Œéƒ½æœ‰å¯èƒ½éœ€è¦çŸ¥é“ä»–çˆ¶å…ƒç´ çš„å¤§å°ã€‚è€Œremæ˜¯ç›¸å¯¹äºæ ¹å…ƒç´ ï¼Œè¿™æ ·å°±æ„å‘³ç€ï¼Œåªéœ€è¦åœ¨æ ¹å…ƒç´ ç¡®å®šä¸€ä¸ªå‚è€ƒå€¼ã€‚</li></ul><p><strong>ä½¿ç”¨åœºæ™¯ï¼š</strong></p><ul><li>å¯¹äºåªéœ€è¦é€‚é…å°‘éƒ¨åˆ†ç§»åŠ¨è®¾å¤‡ï¼Œä¸”åˆ†è¾¨ç‡å¯¹é¡µé¢å½±å“ä¸å¤§çš„ï¼Œä½¿ç”¨pxå³å¯ ã€‚</li><li>å¯¹äºéœ€è¦é€‚é…å„ç§ç§»åŠ¨è®¾å¤‡ï¼Œä½¿ç”¨remï¼Œä¾‹å¦‚éœ€è¦é€‚é…iPhoneå’ŒiPadç­‰åˆ†è¾¨ç‡å·®åˆ«æ¯”è¾ƒæŒºå¤§çš„è®¾å¤‡ã€‚</li></ul><h3 id="3-ä¸¤æ å¸ƒå±€çš„å®ç°"><a href="#3-ä¸¤æ å¸ƒå±€çš„å®ç°" class="headerlink" title="3. ä¸¤æ å¸ƒå±€çš„å®ç°"></a>3. ä¸¤æ å¸ƒå±€çš„å®ç°</h3><p>ä¸€èˆ¬ä¸¤æ å¸ƒå±€æŒ‡çš„æ˜¯<strong>å·¦è¾¹ä¸€æ å®½åº¦å›ºå®šï¼Œå³è¾¹ä¸€æ å®½åº¦è‡ªé€‚åº”</strong>ï¼Œä¸¤æ å¸ƒå±€çš„å…·ä½“å®ç°ï¼š</p><ul><li>åˆ©ç”¨æµ®åŠ¨ï¼Œå°†å·¦è¾¹å…ƒç´ å®½åº¦è®¾ç½®ä¸º200pxï¼Œå¹¶ä¸”è®¾ç½®å‘å·¦æµ®åŠ¨ã€‚å°†å³è¾¹å…ƒç´ çš„margin-leftè®¾ç½®ä¸º200pxï¼Œå®½åº¦è®¾ç½®ä¸ºautoï¼ˆé»˜è®¤ä¸ºautoï¼Œæ’‘æ»¡æ•´ä¸ªçˆ¶å…ƒç´ ï¼‰ã€‚</li></ul><pre class="line-numbers language-css"><code class="language-css"><span class="token selector"><span class="token class">.outer</span> </span><span class="token punctuation">{</span>  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.left</span> </span><span class="token punctuation">{</span>  <span class="token property">float</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>  <span class="token property">background</span><span class="token punctuation">:</span> tomato<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.right</span> </span><span class="token punctuation">{</span>  <span class="token property">margin-left</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>  <span class="token property">width</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>  <span class="token property">background</span><span class="token punctuation">:</span> gold<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>åˆ©ç”¨æµ®åŠ¨ï¼Œå·¦ä¾§å…ƒç´ è®¾ç½®å›ºå®šå¤§å°ï¼Œå¹¶å·¦æµ®åŠ¨ï¼Œå³ä¾§å…ƒç´ è®¾ç½®overflow: hidden; è¿™æ ·å³è¾¹å°±è§¦å‘äº†BFCï¼ŒBFCçš„åŒºåŸŸä¸ä¼šä¸æµ®åŠ¨å…ƒç´ å‘ç”Ÿé‡å ï¼Œæ‰€ä»¥ä¸¤ä¾§å°±ä¸ä¼šå‘ç”Ÿé‡å ã€‚</li></ul><pre class="line-numbers language-css"><code class="language-css"><span class="token selector"><span class="token class">.left</span></span><span class="token punctuation">{</span>     <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>     <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>     <span class="token property">background</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>     <span class="token property">float</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token selector"><span class="token class">.right</span></span><span class="token punctuation">{</span>     <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">300</span>px<span class="token punctuation">;</span>     <span class="token property">background</span><span class="token punctuation">:</span> blue<span class="token punctuation">;</span>     <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span> <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>åˆ©ç”¨flexå¸ƒå±€ï¼Œå°†å·¦è¾¹å…ƒç´ è®¾ç½®ä¸ºå›ºå®šå®½åº¦200pxï¼Œå°†å³è¾¹çš„å…ƒç´ è®¾ç½®ä¸ºflex:1ã€‚</li></ul><pre class="line-numbers language-css"><code class="language-css"><span class="token selector"><span class="token class">.outer</span> </span><span class="token punctuation">{</span>  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.left</span> </span><span class="token punctuation">{</span>  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>  <span class="token property">background</span><span class="token punctuation">:</span> tomato<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.right</span> </span><span class="token punctuation">{</span>  <span class="token property">flex</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token property">background</span><span class="token punctuation">:</span> gold<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>åˆ©ç”¨ç»å¯¹å®šä½ï¼Œå°†çˆ¶çº§å…ƒç´ è®¾ç½®ä¸ºç›¸å¯¹å®šä½ã€‚å·¦è¾¹å…ƒç´ è®¾ç½®ä¸ºabsoluteå®šä½ï¼Œå¹¶ä¸”å®½åº¦è®¾ç½®ä¸º200pxã€‚å°†å³è¾¹å…ƒç´ çš„margin-leftçš„å€¼è®¾ç½®ä¸º200pxã€‚</li></ul><pre class="line-numbers language-css"><code class="language-css"><span class="token selector"><span class="token class">.outer</span> </span><span class="token punctuation">{</span>  <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.left</span> </span><span class="token punctuation">{</span>  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>  <span class="token property">background</span><span class="token punctuation">:</span> tomato<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.right</span> </span><span class="token punctuation">{</span>  <span class="token property">margin-left</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>  <span class="token property">background</span><span class="token punctuation">:</span> gold<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>åˆ©ç”¨ç»å¯¹å®šä½ï¼Œå°†çˆ¶çº§å…ƒç´ è®¾ç½®ä¸ºç›¸å¯¹å®šä½ã€‚å·¦è¾¹å…ƒç´ å®½åº¦è®¾ç½®ä¸º200pxï¼Œå³è¾¹å…ƒç´ è®¾ç½®ä¸ºç»å¯¹å®šä½ï¼Œå·¦è¾¹å®šä½ä¸º200pxï¼Œå…¶ä½™æ–¹å‘å®šä½ä¸º0ã€‚</li></ul><pre class="line-numbers language-css"><code class="language-css"><span class="token selector"><span class="token class">.outer</span> </span><span class="token punctuation">{</span>  <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.left</span> </span><span class="token punctuation">{</span>  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>  <span class="token property">background</span><span class="token punctuation">:</span> tomato<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.right</span> </span><span class="token punctuation">{</span>  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>  <span class="token property">top</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token property">right</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token property">bottom</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token property">left</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>  <span class="token property">background</span><span class="token punctuation">:</span> gold<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-ä¸‰æ å¸ƒå±€çš„å®ç°"><a href="#4-ä¸‰æ å¸ƒå±€çš„å®ç°" class="headerlink" title="4. ä¸‰æ å¸ƒå±€çš„å®ç°"></a>4. ä¸‰æ å¸ƒå±€çš„å®ç°</h3><p>ä¸‰æ å¸ƒå±€ä¸€èˆ¬æŒ‡çš„æ˜¯é¡µé¢ä¸­ä¸€å…±æœ‰ä¸‰æ ï¼Œ<strong>å·¦å³ä¸¤æ å®½åº¦å›ºå®šï¼Œä¸­é—´è‡ªé€‚åº”çš„å¸ƒå±€</strong>ï¼Œä¸‰æ å¸ƒå±€çš„å…·ä½“å®ç°ï¼š</p><ul><li>åˆ©ç”¨<strong>ç»å¯¹å®šä½</strong>ï¼Œå·¦å³ä¸¤æ è®¾ç½®ä¸ºç»å¯¹å®šä½ï¼Œä¸­é—´è®¾ç½®å¯¹åº”æ–¹å‘å¤§å°çš„marginçš„å€¼ã€‚</li></ul><pre class="line-numbers language-css"><code class="language-css"><span class="token selector"><span class="token class">.outer</span> </span><span class="token punctuation">{</span>  <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.left</span> </span><span class="token punctuation">{</span>  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>  <span class="token property">background</span><span class="token punctuation">:</span> tomato<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.right</span> </span><span class="token punctuation">{</span>  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>  <span class="token property">top</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token property">right</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>  <span class="token property">background</span><span class="token punctuation">:</span> gold<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.center</span> </span><span class="token punctuation">{</span>  <span class="token property">margin-left</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>  <span class="token property">margin-right</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>  <span class="token property">background</span><span class="token punctuation">:</span> lightgreen<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>åˆ©ç”¨flexå¸ƒå±€ï¼Œå·¦å³ä¸¤æ è®¾ç½®å›ºå®šå¤§å°ï¼Œä¸­é—´ä¸€æ è®¾ç½®ä¸ºflex:1ã€‚</li></ul><pre class="line-numbers language-css"><code class="language-css"><span class="token selector"><span class="token class">.outer</span> </span><span class="token punctuation">{</span>  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.left</span> </span><span class="token punctuation">{</span>  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>  <span class="token property">background</span><span class="token punctuation">:</span> tomato<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.right</span> </span><span class="token punctuation">{</span>  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>  <span class="token property">background</span><span class="token punctuation">:</span> gold<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.center</span> </span><span class="token punctuation">{</span>  <span class="token property">flex</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token property">background</span><span class="token punctuation">:</span> lightgreen<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>åˆ©ç”¨æµ®åŠ¨ï¼Œå·¦å³ä¸¤æ è®¾ç½®å›ºå®šå¤§å°ï¼Œå¹¶è®¾ç½®å¯¹åº”æ–¹å‘çš„æµ®åŠ¨ã€‚ä¸­é—´ä¸€æ è®¾ç½®å·¦å³ä¸¤ä¸ªæ–¹å‘çš„marginå€¼ï¼Œæ³¨æ„è¿™ç§æ–¹å¼<strong>ï¼Œä¸­é—´ä¸€æ å¿…é¡»æ”¾åˆ°æœ€åï¼š</strong></li></ul><pre class="line-numbers language-css"><code class="language-css"><span class="token selector"><span class="token class">.outer</span> </span><span class="token punctuation">{</span>  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.left</span> </span><span class="token punctuation">{</span>  <span class="token property">float</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>  <span class="token property">background</span><span class="token punctuation">:</span> tomato<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.right</span> </span><span class="token punctuation">{</span>  <span class="token property">float</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>  <span class="token property">background</span><span class="token punctuation">:</span> gold<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.center</span> </span><span class="token punctuation">{</span>  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>  <span class="token property">margin-left</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>  <span class="token property">margin-right</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>  <span class="token property">background</span><span class="token punctuation">:</span> lightgreen<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>åœ£æ¯å¸ƒå±€ï¼Œåˆ©ç”¨æµ®åŠ¨å’Œè´Ÿè¾¹è·æ¥å®ç°ã€‚çˆ¶çº§å…ƒç´ è®¾ç½®å·¦å³çš„ paddingï¼Œä¸‰åˆ—å‡è®¾ç½®å‘å·¦æµ®åŠ¨ï¼Œä¸­é—´ä¸€åˆ—æ”¾åœ¨æœ€å‰é¢ï¼Œå®½åº¦è®¾ç½®ä¸ºçˆ¶çº§å…ƒç´ çš„å®½åº¦ï¼Œå› æ­¤åé¢ä¸¤åˆ—éƒ½è¢«æŒ¤åˆ°äº†ä¸‹ä¸€è¡Œï¼Œé€šè¿‡è®¾ç½® margin è´Ÿå€¼å°†å…¶ç§»åŠ¨åˆ°ä¸Šä¸€è¡Œï¼Œå†åˆ©ç”¨ç›¸å¯¹å®šä½ï¼Œå®šä½åˆ°ä¸¤è¾¹ã€‚</li></ul><pre class="line-numbers language-css"><code class="language-css"><span class="token selector"><span class="token class">.outer</span> </span><span class="token punctuation">{</span>  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>  <span class="token property">padding-left</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>  <span class="token property">padding-right</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.left</span> </span><span class="token punctuation">{</span>  <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>  <span class="token property">left</span><span class="token punctuation">:</span> -<span class="token number">100</span>px<span class="token punctuation">;</span>  <span class="token property">float</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>  <span class="token property">margin-left</span><span class="token punctuation">:</span> -<span class="token number">100%</span><span class="token punctuation">;</span>  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>  <span class="token property">background</span><span class="token punctuation">:</span> tomato<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.right</span> </span><span class="token punctuation">{</span>  <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>  <span class="token property">left</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>  <span class="token property">float</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>  <span class="token property">margin-left</span><span class="token punctuation">:</span> -<span class="token number">200</span>px<span class="token punctuation">;</span>  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>  <span class="token property">background</span><span class="token punctuation">:</span> gold<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.center</span> </span><span class="token punctuation">{</span>  <span class="token property">float</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100%</span><span class="token punctuation">;</span>  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>  <span class="token property">background</span><span class="token punctuation">:</span> lightgreen<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>åŒé£ç¿¼å¸ƒå±€ï¼ŒåŒé£ç¿¼å¸ƒå±€ç›¸å¯¹äºåœ£æ¯å¸ƒå±€æ¥è¯´ï¼Œå·¦å³ä½ç½®çš„ä¿ç•™æ˜¯é€šè¿‡ä¸­é—´åˆ—çš„ margin å€¼æ¥å®ç°çš„ï¼Œè€Œä¸æ˜¯é€šè¿‡çˆ¶å…ƒç´ çš„ padding æ¥å®ç°çš„ã€‚æœ¬è´¨ä¸Šæ¥è¯´ï¼Œä¹Ÿæ˜¯é€šè¿‡æµ®åŠ¨å’Œå¤–è¾¹è·è´Ÿå€¼æ¥å®ç°çš„ã€‚</li></ul><pre class="line-numbers language-css"><code class="language-css"><span class="token selector"><span class="token class">.outer</span> </span><span class="token punctuation">{</span>  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.left</span> </span><span class="token punctuation">{</span>  <span class="token property">float</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>  <span class="token property">margin-left</span><span class="token punctuation">:</span> -<span class="token number">100%</span><span class="token punctuation">;</span>  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>  <span class="token property">background</span><span class="token punctuation">:</span> tomato<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.right</span> </span><span class="token punctuation">{</span>  <span class="token property">float</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>  <span class="token property">margin-left</span><span class="token punctuation">:</span> -<span class="token number">200</span>px<span class="token punctuation">;</span>  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>  <span class="token property">background</span><span class="token punctuation">:</span> gold<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.wrapper</span> </span><span class="token punctuation">{</span>  <span class="token property">float</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100%</span><span class="token punctuation">;</span>  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>  <span class="token property">background</span><span class="token punctuation">:</span> lightgreen<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.center</span> </span><span class="token punctuation">{</span>  <span class="token property">margin-left</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>  <span class="token property">margin-right</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="5-æ°´å¹³å‚ç›´å±…ä¸­çš„å®ç°"><a href="#5-æ°´å¹³å‚ç›´å±…ä¸­çš„å®ç°" class="headerlink" title="5. æ°´å¹³å‚ç›´å±…ä¸­çš„å®ç°"></a>5. æ°´å¹³å‚ç›´å±…ä¸­çš„å®ç°</h3><ul><li>åˆ©ç”¨ç»å¯¹å®šä½ï¼Œå…ˆå°†å…ƒç´ çš„å·¦ä¸Šè§’é€šè¿‡top:50%å’Œleft:50%å®šä½åˆ°é¡µé¢çš„ä¸­å¿ƒï¼Œç„¶åå†é€šè¿‡translateæ¥è°ƒæ•´å…ƒç´ çš„ä¸­å¿ƒç‚¹åˆ°é¡µé¢çš„ä¸­å¿ƒã€‚è¯¥æ–¹æ³•éœ€è¦<strong>è€ƒè™‘æµè§ˆå™¨å…¼å®¹é—®é¢˜ã€‚</strong></li></ul><pre class="line-numbers language-css"><code class="language-css"><span class="token selector"><span class="token class">.parent</span> </span><span class="token punctuation">{</span>    <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token selector"><span class="token class">.child</span> </span><span class="token punctuation">{</span>    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>    <span class="token property">left</span><span class="token punctuation">:</span> <span class="token number">50%</span><span class="token punctuation">;</span>    <span class="token property">top</span><span class="token punctuation">:</span> <span class="token number">50%</span><span class="token punctuation">;</span>    <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate</span><span class="token punctuation">(</span>-<span class="token number">50%</span>,-<span class="token number">50%</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>åˆ©ç”¨ç»å¯¹å®šä½ï¼Œè®¾ç½®å››ä¸ªæ–¹å‘çš„å€¼éƒ½ä¸º0ï¼Œå¹¶å°†marginè®¾ç½®ä¸ºautoï¼Œç”±äºå®½é«˜å›ºå®šï¼Œå› æ­¤å¯¹åº”æ–¹å‘å®ç°å¹³åˆ†ï¼Œå¯ä»¥å®ç°æ°´å¹³å’Œå‚ç›´æ–¹å‘ä¸Šçš„å±…ä¸­ã€‚è¯¥æ–¹æ³•é€‚ç”¨äº<strong>ç›’å­æœ‰å®½é«˜</strong>çš„æƒ…å†µï¼š</li></ul><pre class="line-numbers language-css"><code class="language-css"><span class="token selector"><span class="token class">.parent</span> </span><span class="token punctuation">{</span>    <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.child</span> </span><span class="token punctuation">{</span>    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>    <span class="token property">top</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token property">bottom</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token property">left</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token property">right</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token property">margin</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>åˆ©ç”¨ç»å¯¹å®šä½ï¼Œå…ˆå°†å…ƒç´ çš„å·¦ä¸Šè§’é€šè¿‡top:50%å’Œleft:50%å®šä½åˆ°é¡µé¢çš„ä¸­å¿ƒï¼Œç„¶åå†é€šè¿‡marginè´Ÿå€¼æ¥è°ƒæ•´å…ƒç´ çš„ä¸­å¿ƒç‚¹åˆ°é¡µé¢çš„ä¸­å¿ƒã€‚è¯¥æ–¹æ³•é€‚ç”¨äº<strong>ç›’å­å®½é«˜å·²çŸ¥</strong>çš„æƒ…å†µ</li></ul><pre class="line-numbers language-css"><code class="language-css"><span class="token selector"><span class="token class">.parent</span> </span><span class="token punctuation">{</span>    <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.child</span> </span><span class="token punctuation">{</span>    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>    <span class="token property">top</span><span class="token punctuation">:</span> <span class="token number">50%</span><span class="token punctuation">;</span>    <span class="token property">left</span><span class="token punctuation">:</span> <span class="token number">50%</span><span class="token punctuation">;</span>    <span class="token property">margin-top</span><span class="token punctuation">:</span> -<span class="token number">50</span>px<span class="token punctuation">;</span>     <span class="token comment" spellcheck="true">/* è‡ªèº« height çš„ä¸€åŠ */</span>    <span class="token property">margin-left</span><span class="token punctuation">:</span> -<span class="token number">50</span>px<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">/* è‡ªèº« width çš„ä¸€åŠ */</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>ä½¿ç”¨flexå¸ƒå±€ï¼Œé€šè¿‡align-items:centerå’Œjustify-content:centerè®¾ç½®å®¹å™¨çš„å‚ç›´å’Œæ°´å¹³æ–¹å‘ä¸Šä¸ºå±…ä¸­å¯¹é½ï¼Œç„¶åå®ƒçš„å­å…ƒç´ ä¹Ÿå¯ä»¥å®ç°å‚ç›´å’Œæ°´å¹³çš„å±…ä¸­ã€‚è¯¥æ–¹æ³•è¦<strong>è€ƒè™‘å…¼å®¹çš„é—®é¢˜</strong>ï¼Œè¯¥æ–¹æ³•åœ¨ç§»åŠ¨ç«¯ç”¨çš„è¾ƒå¤šï¼š</li></ul><pre class="line-numbers language-css"><code class="language-css"><span class="token selector"><span class="token class">.parent</span> </span><span class="token punctuation">{</span>    <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>    <span class="token property">justify-content</span><span class="token punctuation">:</span>center<span class="token punctuation">;</span>    <span class="token property">align-items</span><span class="token punctuation">:</span>center<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="6-å¦‚ä½•æ ¹æ®è®¾è®¡ç¨¿è¿›è¡Œç§»åŠ¨ç«¯é€‚é…ï¼Ÿ"><a href="#6-å¦‚ä½•æ ¹æ®è®¾è®¡ç¨¿è¿›è¡Œç§»åŠ¨ç«¯é€‚é…ï¼Ÿ" class="headerlink" title="6. å¦‚ä½•æ ¹æ®è®¾è®¡ç¨¿è¿›è¡Œç§»åŠ¨ç«¯é€‚é…ï¼Ÿ"></a>6. å¦‚ä½•æ ¹æ®è®¾è®¡ç¨¿è¿›è¡Œç§»åŠ¨ç«¯é€‚é…ï¼Ÿ</h3><p>ç§»åŠ¨ç«¯é€‚é…ä¸»è¦æœ‰ä¸¤ä¸ªç»´åº¦ï¼š</p><ul><li><strong>é€‚é…ä¸åŒåƒç´ å¯†åº¦ï¼Œ</strong> é’ˆå¯¹ä¸åŒçš„åƒç´ å¯†åº¦ï¼Œä½¿ç”¨ CSS åª’ä½“æŸ¥è¯¢ï¼Œé€‰æ‹©ä¸åŒç²¾åº¦çš„å›¾ç‰‡ï¼Œä»¥ä¿è¯å›¾ç‰‡ä¸ä¼šå¤±çœŸï¼›</li><li><strong>é€‚é…ä¸åŒå±å¹•å¤§å°ï¼Œ</strong> ç”±äºä¸åŒçš„å±å¹•æœ‰ç€ä¸åŒçš„é€»è¾‘åƒç´ å¤§å°ï¼Œæ‰€ä»¥å¦‚æœç›´æ¥ä½¿ç”¨ px ä½œä¸ºå¼€å‘å•ä½ï¼Œä¼šä½¿å¾—å¼€å‘çš„é¡µé¢åœ¨æŸä¸€æ¬¾æ‰‹æœºä¸Šå¯ä»¥å‡†ç¡®æ˜¾ç¤ºï¼Œä½†æ˜¯åœ¨å¦ä¸€æ¬¾æ‰‹æœºä¸Šå°±ä¼šå¤±çœŸã€‚ä¸ºäº†é€‚é…ä¸åŒå±å¹•çš„å¤§å°ï¼Œåº”æŒ‰ç…§æ¯”ä¾‹æ¥è¿˜åŸè®¾è®¡ç¨¿çš„å†…å®¹ã€‚</li></ul><p>ä¸ºäº†èƒ½è®©é¡µé¢çš„å°ºå¯¸è‡ªé€‚åº”ï¼Œå¯ä»¥ä½¿ç”¨ remï¼Œemï¼Œvwï¼Œvh ç­‰ç›¸å¯¹å•ä½ã€‚</p><h3 id="7-å¯¹Flexå¸ƒå±€çš„ç†è§£åŠå…¶ä½¿ç”¨åœºæ™¯"><a href="#7-å¯¹Flexå¸ƒå±€çš„ç†è§£åŠå…¶ä½¿ç”¨åœºæ™¯" class="headerlink" title="7. å¯¹Flexå¸ƒå±€çš„ç†è§£åŠå…¶ä½¿ç”¨åœºæ™¯"></a>7. å¯¹Flexå¸ƒå±€çš„ç†è§£åŠå…¶ä½¿ç”¨åœºæ™¯</h3><p>Flexæ˜¯FlexibleBoxçš„ç¼©å†™ï¼Œæ„ä¸ºâ€å¼¹æ€§å¸ƒå±€â€ï¼Œç”¨æ¥ä¸ºç›’çŠ¶æ¨¡å‹æä¾›æœ€å¤§çš„çµæ´»æ€§ã€‚ä»»ä½•ä¸€ä¸ªå®¹å™¨éƒ½å¯ä»¥æŒ‡å®šä¸ºFlexå¸ƒå±€ã€‚è¡Œå†…å…ƒç´ ä¹Ÿå¯ä»¥ä½¿ç”¨Flexå¸ƒå±€ã€‚æ³¨æ„ï¼Œè®¾ä¸ºFlexå¸ƒå±€ä»¥åï¼Œ<strong>å­å…ƒç´ çš„floatã€clearå’Œvertical-alignå±æ€§å°†å¤±æ•ˆ</strong>ã€‚é‡‡ç”¨Flexå¸ƒå±€çš„å…ƒç´ ï¼Œç§°ä¸ºFlexå®¹å™¨ï¼ˆflex containerï¼‰ï¼Œç®€ç§°â€å®¹å™¨â€ã€‚å®ƒçš„æ‰€æœ‰å­å…ƒç´ è‡ªåŠ¨æˆä¸ºå®¹å™¨æˆå‘˜ï¼Œç§°ä¸ºFlexé¡¹ç›®ï¼ˆflex itemï¼‰ï¼Œç®€ç§°â€é¡¹ç›®â€ã€‚å®¹å™¨é»˜è®¤å­˜åœ¨ä¸¤æ ¹è½´ï¼šæ°´å¹³çš„ä¸»è½´ï¼ˆmain axisï¼‰å’Œå‚ç›´çš„äº¤å‰è½´ï¼ˆcross axisï¼‰ï¼Œé¡¹ç›®é»˜è®¤æ²¿æ°´å¹³ä¸»è½´æ’åˆ—ã€‚</p><p>ä»¥ä¸‹6ä¸ªå±æ€§è®¾ç½®åœ¨<strong>å®¹å™¨ä¸Š</strong>ï¼š</p><ul><li>flex-directionå±æ€§å†³å®šä¸»è½´çš„æ–¹å‘ï¼ˆå³é¡¹ç›®çš„æ’åˆ—æ–¹å‘ï¼‰ã€‚</li><li>flex-wrapå±æ€§å®šä¹‰ï¼Œå¦‚æœä¸€æ¡è½´çº¿æ’ä¸ä¸‹ï¼Œå¦‚ä½•æ¢è¡Œã€‚</li><li>flex-flowå±æ€§æ˜¯flex-directionå±æ€§å’Œflex-wrapå±æ€§çš„ç®€å†™å½¢å¼ï¼Œé»˜è®¤å€¼ä¸ºrow nowrapã€‚</li><li>justify-contentå±æ€§å®šä¹‰äº†é¡¹ç›®åœ¨ä¸»è½´ä¸Šçš„å¯¹é½æ–¹å¼ã€‚</li><li>align-itemså±æ€§å®šä¹‰é¡¹ç›®åœ¨äº¤å‰è½´ä¸Šå¦‚ä½•å¯¹é½ã€‚</li><li>align-contentå±æ€§å®šä¹‰äº†å¤šæ ¹è½´çº¿çš„å¯¹é½æ–¹å¼ã€‚å¦‚æœé¡¹ç›®åªæœ‰ä¸€æ ¹è½´çº¿ï¼Œè¯¥å±æ€§ä¸èµ·ä½œç”¨ã€‚</li></ul><p>ä»¥ä¸‹6ä¸ªå±æ€§è®¾ç½®åœ¨<strong>é¡¹ç›®ä¸Š</strong>ï¼š</p><ul><li>orderå±æ€§å®šä¹‰é¡¹ç›®çš„æ’åˆ—é¡ºåºã€‚æ•°å€¼è¶Šå°ï¼Œæ’åˆ—è¶Šé å‰ï¼Œé»˜è®¤ä¸º0ã€‚</li><li>flex-growå±æ€§å®šä¹‰é¡¹ç›®çš„æ”¾å¤§æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º0ï¼Œå³å¦‚æœå­˜åœ¨å‰©ä½™ç©ºé—´ï¼Œä¹Ÿä¸æ”¾å¤§ã€‚</li><li>flex-shrinkå±æ€§å®šä¹‰äº†é¡¹ç›®çš„ç¼©å°æ¯”ä¾‹ï¼Œé»˜è®¤ä¸º1ï¼Œå³å¦‚æœç©ºé—´ä¸è¶³ï¼Œè¯¥é¡¹ç›®å°†ç¼©å°ã€‚</li><li>flex-basiså±æ€§å®šä¹‰äº†åœ¨åˆ†é…å¤šä½™ç©ºé—´ä¹‹å‰ï¼Œé¡¹ç›®å æ®çš„ä¸»è½´ç©ºé—´ã€‚æµè§ˆå™¨æ ¹æ®è¿™ä¸ªå±æ€§ï¼Œè®¡ç®—ä¸»è½´æ˜¯å¦æœ‰å¤šä½™ç©ºé—´ã€‚å®ƒçš„é»˜è®¤å€¼ä¸ºautoï¼Œå³é¡¹ç›®çš„æœ¬æ¥å¤§å°ã€‚</li><li>flexå±æ€§æ˜¯flex-growï¼Œflex-shrinkå’Œflex-basisçš„ç®€å†™ï¼Œé»˜è®¤å€¼ä¸º0 1 autoã€‚</li><li>align-selfå±æ€§å…è®¸å•ä¸ªé¡¹ç›®æœ‰ä¸å…¶ä»–é¡¹ç›®ä¸ä¸€æ ·çš„å¯¹é½æ–¹å¼ï¼Œå¯è¦†ç›–align-itemså±æ€§ã€‚é»˜è®¤å€¼ä¸ºautoï¼Œè¡¨ç¤ºç»§æ‰¿çˆ¶å…ƒç´ çš„align-itemså±æ€§ï¼Œå¦‚æœæ²¡æœ‰çˆ¶å…ƒç´ ï¼Œåˆ™ç­‰åŒäºstretchã€‚</li></ul><p><strong>ç®€å•æ¥è¯´ï¼š</strong><br>flexå¸ƒå±€æ˜¯CSS3æ–°å¢çš„ä¸€ç§å¸ƒå±€æ–¹å¼ï¼Œå¯ä»¥é€šè¿‡å°†ä¸€ä¸ªå…ƒç´ çš„displayå±æ€§å€¼è®¾ç½®ä¸ºflexä»è€Œä½¿å®ƒæˆä¸ºä¸€ä¸ªflexå®¹å™¨ï¼Œå®ƒçš„æ‰€æœ‰å­å…ƒç´ éƒ½ä¼šæˆä¸ºå®ƒçš„é¡¹ç›®ã€‚ä¸€ä¸ªå®¹å™¨é»˜è®¤æœ‰ä¸¤æ¡è½´ï¼šä¸€ä¸ªæ˜¯æ°´å¹³çš„ä¸»è½´ï¼Œä¸€ä¸ªæ˜¯ä¸ä¸»è½´å‚ç›´çš„äº¤å‰è½´ã€‚å¯ä»¥ä½¿ç”¨flex-directionæ¥æŒ‡å®šä¸»è½´çš„æ–¹å‘ã€‚å¯ä»¥ä½¿ç”¨justify-contentæ¥æŒ‡å®šå…ƒç´ åœ¨ä¸»è½´ä¸Šçš„æ’åˆ—æ–¹å¼ï¼Œä½¿ç”¨align-itemsæ¥æŒ‡å®šå…ƒç´ åœ¨äº¤å‰è½´ä¸Šçš„æ’åˆ—æ–¹å¼ã€‚è¿˜å¯ä»¥ä½¿ç”¨flex-wrapæ¥è§„å®šå½“ä¸€è¡Œæ’åˆ—ä¸ä¸‹æ—¶çš„æ¢è¡Œæ–¹å¼ã€‚å¯¹äºå®¹å™¨ä¸­çš„é¡¹ç›®ï¼Œå¯ä»¥ä½¿ç”¨orderå±æ€§æ¥æŒ‡å®šé¡¹ç›®çš„æ’åˆ—é¡ºåºï¼Œè¿˜å¯ä»¥ä½¿ç”¨flex-growæ¥æŒ‡å®šå½“æ’åˆ—ç©ºé—´æœ‰å‰©ä½™çš„æ—¶å€™ï¼Œé¡¹ç›®çš„æ”¾å¤§æ¯”ä¾‹ï¼Œè¿˜å¯ä»¥ä½¿ç”¨flex-shrinkæ¥æŒ‡å®šå½“æ’åˆ—ç©ºé—´ä¸è¶³æ—¶ï¼Œé¡¹ç›®çš„ç¼©å°æ¯”ä¾‹ã€‚</p><h3 id="8-å“åº”å¼è®¾è®¡çš„æ¦‚å¿µåŠåŸºæœ¬åŸç†"><a href="#8-å“åº”å¼è®¾è®¡çš„æ¦‚å¿µåŠåŸºæœ¬åŸç†" class="headerlink" title="8. å“åº”å¼è®¾è®¡çš„æ¦‚å¿µåŠåŸºæœ¬åŸç†"></a>8. å“åº”å¼è®¾è®¡çš„æ¦‚å¿µåŠåŸºæœ¬åŸç†</h3><p>å“åº”å¼ç½‘ç«™è®¾è®¡<code>ï¼ˆResponsive Web design</code>ï¼‰æ˜¯ä¸€ä¸ªç½‘ç«™èƒ½å¤Ÿå…¼å®¹å¤šä¸ªç»ˆç«¯ï¼Œè€Œä¸æ˜¯ä¸ºæ¯ä¸€ä¸ªç»ˆç«¯åšä¸€ä¸ªç‰¹å®šçš„ç‰ˆæœ¬ã€‚</p><p>å…³äºåŸç†ï¼š åŸºæœ¬åŸç†æ˜¯é€šè¿‡åª’ä½“æŸ¥è¯¢<code>ï¼ˆ@mediaï¼‰</code>æŸ¥è¯¢æ£€æµ‹ä¸åŒçš„è®¾å¤‡å±å¹•å°ºå¯¸åšå¤„ç†ã€‚<br>å…³äºå…¼å®¹ï¼š é¡µé¢å¤´éƒ¨å¿…é¡»æœ‰mateå£°æ˜çš„<code>viewport</code>ã€‚</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>â€™viewportâ€™<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>â€width<span class="token punctuation">=</span>device-width,<span class="token punctuation">"</span></span> <span class="token attr-name">initial-scale</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1.<span class="token punctuation">"</span></span> <span class="token attr-name">maximum-scale</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1,user-scalable<span class="token punctuation">=</span>noâ€<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="ä¸‰ã€å®šä½ä¸æµ®åŠ¨"><a href="#ä¸‰ã€å®šä½ä¸æµ®åŠ¨" class="headerlink" title="ä¸‰ã€å®šä½ä¸æµ®åŠ¨"></a>ä¸‰ã€å®šä½ä¸æµ®åŠ¨</h2><h3 id="1-ä¸ºä»€ä¹ˆéœ€è¦æ¸…é™¤æµ®åŠ¨ï¼Ÿæ¸…é™¤æµ®åŠ¨çš„æ–¹å¼"><a href="#1-ä¸ºä»€ä¹ˆéœ€è¦æ¸…é™¤æµ®åŠ¨ï¼Ÿæ¸…é™¤æµ®åŠ¨çš„æ–¹å¼" class="headerlink" title="1. ä¸ºä»€ä¹ˆéœ€è¦æ¸…é™¤æµ®åŠ¨ï¼Ÿæ¸…é™¤æµ®åŠ¨çš„æ–¹å¼"></a>1. ä¸ºä»€ä¹ˆéœ€è¦æ¸…é™¤æµ®åŠ¨ï¼Ÿæ¸…é™¤æµ®åŠ¨çš„æ–¹å¼</h3><p><strong>æµ®åŠ¨çš„å®šä¹‰ï¼š</strong> éIEæµè§ˆå™¨ä¸‹ï¼Œå®¹å™¨ä¸è®¾é«˜åº¦ä¸”å­å…ƒç´ æµ®åŠ¨æ—¶ï¼Œå®¹å™¨é«˜åº¦ä¸èƒ½è¢«å†…å®¹æ’‘å¼€ã€‚ æ­¤æ—¶ï¼Œå†…å®¹ä¼šæº¢å‡ºåˆ°å®¹å™¨å¤–é¢è€Œå½±å“å¸ƒå±€ã€‚è¿™ç§ç°è±¡è¢«ç§°ä¸ºæµ®åŠ¨ï¼ˆæº¢å‡ºï¼‰ã€‚</p><p><strong>æµ®åŠ¨çš„å·¥ä½œåŸç†ï¼š</strong></p><ul><li>æµ®åŠ¨å…ƒç´ è„±ç¦»æ–‡æ¡£æµï¼Œä¸å æ®ç©ºé—´ï¼ˆå¼•èµ·â€œé«˜åº¦å¡Œé™·â€ç°è±¡ï¼‰</li><li>æµ®åŠ¨å…ƒç´ ç¢°åˆ°åŒ…å«å®ƒçš„è¾¹æ¡†æˆ–è€…å…¶ä»–æµ®åŠ¨å…ƒç´ çš„è¾¹æ¡†åœç•™</li></ul><p>æµ®åŠ¨å…ƒç´ å¯ä»¥å·¦å³ç§»åŠ¨ï¼Œç›´åˆ°é‡åˆ°å¦ä¸€ä¸ªæµ®åŠ¨å…ƒç´ æˆ–è€…é‡åˆ°å®ƒå¤–è¾¹ç¼˜çš„åŒ…å«æ¡†ã€‚æµ®åŠ¨æ¡†ä¸å±äºæ–‡æ¡£æµä¸­çš„æ™®é€šæµï¼Œå½“å…ƒç´ æµ®åŠ¨ä¹‹åï¼Œä¸ä¼šå½±å“å—çº§å…ƒç´ çš„å¸ƒå±€ï¼Œåªä¼šå½±å“å†…è”å…ƒç´ å¸ƒå±€ã€‚æ­¤æ—¶æ–‡æ¡£æµä¸­çš„æ™®é€šæµå°±ä¼šè¡¨ç°å¾—è¯¥æµ®åŠ¨æ¡†ä¸å­˜åœ¨ä¸€æ ·çš„å¸ƒå±€æ¨¡å¼ã€‚å½“åŒ…å«æ¡†çš„é«˜åº¦å°äºæµ®åŠ¨æ¡†çš„æ—¶å€™ï¼Œæ­¤æ—¶å°±ä¼šå‡ºç°â€œé«˜åº¦å¡Œé™·â€ã€‚</p><p><strong>æµ®åŠ¨å…ƒç´ å¼•èµ·çš„é—®é¢˜ï¼Ÿ</strong></p><ul><li>çˆ¶å…ƒç´ çš„é«˜åº¦æ— æ³•è¢«æ’‘å¼€ï¼Œå½±å“ä¸çˆ¶å…ƒç´ åŒçº§çš„å…ƒç´ </li><li>ä¸æµ®åŠ¨å…ƒç´ åŒçº§çš„éæµ®åŠ¨å…ƒç´ ä¼šè·Ÿéšå…¶å</li><li>è‹¥æµ®åŠ¨çš„å…ƒç´ ä¸æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œåˆ™è¯¥å…ƒç´ ä¹‹å‰çš„å…ƒç´ ä¹Ÿè¦æµ®åŠ¨ï¼Œå¦åˆ™ä¼šå½±å“é¡µé¢çš„æ˜¾ç¤ºç»“æ„</li></ul><p><strong>æ¸…é™¤æµ®åŠ¨çš„æ–¹å¼å¦‚ä¸‹ï¼š</strong></p><ul><li>ç»™çˆ¶çº§divå®šä¹‰<code>height</code>å±æ€§</li><li>æœ€åä¸€ä¸ªæµ®åŠ¨å…ƒç´ ä¹‹åæ·»åŠ ä¸€ä¸ªç©ºçš„divæ ‡ç­¾ï¼Œå¹¶æ·»åŠ <code>clear:both</code>æ ·å¼</li><li>åŒ…å«æµ®åŠ¨å…ƒç´ çš„çˆ¶çº§æ ‡ç­¾æ·»åŠ <code>overflow:hidden</code>æˆ–è€…<code>overflow:auto</code></li><li>ä½¿ç”¨ :after ä¼ªå…ƒç´ ã€‚ç”±äºIE6-7ä¸æ”¯æŒ :afterï¼Œä½¿ç”¨ zoom:1 è§¦å‘ hasLayout**</li></ul><pre class="line-numbers language-css"><code class="language-css"><span class="token selector"><span class="token class">.clearfix</span><span class="token pseudo-element">:after</span></span><span class="token punctuation">{</span>    <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">"\200B"</span><span class="token punctuation">;</span>    <span class="token property">display</span><span class="token punctuation">:</span> table<span class="token punctuation">;</span>     <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token property">clear</span><span class="token punctuation">:</span> both<span class="token punctuation">;</span>  <span class="token punctuation">}</span>  <span class="token selector"><span class="token class">.clearfix</span></span><span class="token punctuation">{</span>    *<span class="token property">zoom</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-ä½¿ç”¨-clear-å±æ€§æ¸…é™¤æµ®åŠ¨çš„åŸç†ï¼Ÿ"><a href="#2-ä½¿ç”¨-clear-å±æ€§æ¸…é™¤æµ®åŠ¨çš„åŸç†ï¼Ÿ" class="headerlink" title="2. ä½¿ç”¨ clear å±æ€§æ¸…é™¤æµ®åŠ¨çš„åŸç†ï¼Ÿ"></a>2. ä½¿ç”¨ clear å±æ€§æ¸…é™¤æµ®åŠ¨çš„åŸç†ï¼Ÿ</h3><p>ä½¿ç”¨clearå±æ€§æ¸…é™¤æµ®åŠ¨ï¼Œå…¶è¯­æ³•å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-css"><code class="language-css"><span class="token property">clear</span><span class="token punctuation">:</span>none|left|right|both<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¦‚æœå•çœ‹å­—é¢æ„æ€ï¼Œclear:left æ˜¯â€œæ¸…é™¤å·¦æµ®åŠ¨â€ï¼Œclear:right æ˜¯â€œæ¸…é™¤å³æµ®åŠ¨â€ï¼Œå®é™…ä¸Šï¼Œè¿™ç§è§£é‡Šæ˜¯æœ‰é—®é¢˜çš„ï¼Œå› ä¸ºæµ®åŠ¨ä¸€ç›´è¿˜åœ¨ï¼Œå¹¶æ²¡æœ‰æ¸…é™¤ã€‚</p><p>å®˜æ–¹å¯¹clearå±æ€§è§£é‡Šï¼šâ€œ<strong>å…ƒç´ ç›’å­çš„è¾¹ä¸èƒ½å’Œå‰é¢çš„æµ®åŠ¨å…ƒç´ ç›¸é‚»</strong>â€ï¼Œå¯¹å…ƒç´ è®¾ç½®clearå±æ€§æ˜¯ä¸ºäº†é¿å…æµ®åŠ¨å…ƒç´ å¯¹è¯¥å…ƒç´ çš„å½±å“ï¼Œè€Œä¸æ˜¯æ¸…é™¤æ‰æµ®åŠ¨ã€‚</p><p>è¿˜éœ€è¦æ³¨æ„ clear å±æ€§æŒ‡çš„æ˜¯å…ƒç´ ç›’å­çš„è¾¹ä¸èƒ½å’Œå‰é¢çš„æµ®åŠ¨å…ƒç´ ç›¸é‚»ï¼Œæ³¨æ„è¿™é‡Œâ€œ<strong>å‰é¢çš„</strong>â€3ä¸ªå­—ï¼Œä¹Ÿå°±æ˜¯clearå±æ€§å¯¹â€œåé¢çš„â€æµ®åŠ¨å…ƒç´ æ˜¯ä¸é—»ä¸é—®çš„ã€‚è€ƒè™‘åˆ°floatå±æ€§è¦ä¹ˆæ˜¯leftï¼Œè¦ä¹ˆæ˜¯rightï¼Œä¸å¯èƒ½åŒæ—¶å­˜åœ¨ï¼ŒåŒæ—¶ç”±äºclearå±æ€§å¯¹â€œåé¢çš„â€æµ®åŠ¨å…ƒç´ ä¸é—»ä¸é—®ï¼Œå› æ­¤ï¼Œå½“clear:leftæœ‰æ•ˆçš„æ—¶å€™ï¼Œclear:rightå¿…å®šæ— æ•ˆï¼Œä¹Ÿå°±æ˜¯æ­¤æ—¶clear:leftç­‰åŒäºè®¾ç½®clear:bothï¼›åŒæ ·åœ°ï¼Œclear:rightå¦‚æœæœ‰æ•ˆä¹Ÿæ˜¯ç­‰åŒäºè®¾ç½®clear:bothã€‚ç”±æ­¤å¯è§ï¼Œclear:leftå’Œclear:rightè¿™ä¸¤ä¸ªå£°æ˜å°±æ²¡æœ‰ä»»ä½•ä½¿ç”¨çš„ä»·å€¼ï¼Œè‡³å°‘åœ¨CSSä¸–ç•Œä¸­æ˜¯å¦‚æ­¤ï¼Œç›´æ¥ä½¿ç”¨clear:bothå§ã€‚</p><p>ä¸€èˆ¬ä½¿ç”¨ä¼ªå…ƒç´ çš„æ–¹å¼æ¸…é™¤æµ®åŠ¨ï¼š</p><pre class="line-numbers language-css"><code class="language-css"><span class="token selector"><span class="token class">.clear</span><span class="token pseudo-element">::after</span></span><span class="token punctuation">{</span>  <span class="token property">content</span><span class="token punctuation">:</span><span class="token string">''</span><span class="token punctuation">;</span>  <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>   <span class="token property">clear</span><span class="token punctuation">:</span>both<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>clearå±æ€§åªæœ‰å—çº§å…ƒç´ æ‰æœ‰æ•ˆçš„ï¼Œè€Œ::afterç­‰ä¼ªå…ƒç´ é»˜è®¤éƒ½æ˜¯å†…è”æ°´å¹³ï¼Œè¿™å°±æ˜¯å€ŸåŠ©ä¼ªå…ƒç´ æ¸…é™¤æµ®åŠ¨å½±å“æ—¶éœ€è¦è®¾ç½®displayå±æ€§å€¼çš„åŸå› ã€‚</p><h3 id="3-å¯¹BFCçš„ç†è§£ï¼Œå¦‚ä½•åˆ›å»ºBFC"><a href="#3-å¯¹BFCçš„ç†è§£ï¼Œå¦‚ä½•åˆ›å»ºBFC" class="headerlink" title="3. å¯¹BFCçš„ç†è§£ï¼Œå¦‚ä½•åˆ›å»ºBFC"></a>3. å¯¹BFCçš„ç†è§£ï¼Œå¦‚ä½•åˆ›å»ºBFC</h3><p>å…ˆæ¥çœ‹ä¸¤ä¸ªç›¸å…³çš„æ¦‚å¿µï¼š</p><ul><li>Box: Box æ˜¯ CSS å¸ƒå±€çš„å¯¹è±¡å’ŒåŸºæœ¬å•ä½ï¼Œâ¼€ä¸ªâ»šâ¾¯æ˜¯ç”±å¾ˆå¤šä¸ª Box ç»„æˆçš„ï¼Œè¿™ä¸ªBoxå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„ç›’æ¨¡å‹ã€‚ </li><li>Formatting contextï¼šå—çº§ä¸Šä¸‹â½‚æ ¼å¼åŒ–ï¼Œå®ƒæ˜¯â»šâ¾¯ä¸­çš„â¼€å—æ¸²æŸ“åŒºåŸŸï¼Œå¹¶ä¸”æœ‰â¼€å¥—æ¸²æŸ“è§„åˆ™ï¼Œå®ƒå†³å®šäº†å…¶â¼¦å…ƒç´ å°†å¦‚ä½•å®šä½ï¼Œä»¥åŠå’Œå…¶ä»–å…ƒç´ çš„å…³ç³»å’Œç›¸äº’ä½œâ½¤ã€‚ </li></ul><p>å—æ ¼å¼åŒ–ä¸Šä¸‹æ–‡ï¼ˆBlock Formatting Contextï¼ŒBFCï¼‰æ˜¯Webé¡µé¢çš„å¯è§†åŒ–CSSæ¸²æŸ“çš„ä¸€éƒ¨åˆ†ï¼Œæ˜¯å¸ƒå±€è¿‡ç¨‹ä¸­ç”Ÿæˆå—çº§ç›’å­çš„åŒºåŸŸï¼Œä¹Ÿæ˜¯æµ®åŠ¨å…ƒç´ ä¸å…¶ä»–å…ƒç´ çš„äº¤äº’é™å®šåŒºåŸŸã€‚</p><p>é€šä¿—æ¥è®²ï¼šBFCæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å¸ƒå±€ç¯å¢ƒï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªå®¹å™¨ï¼Œåœ¨è¿™ä¸ªå®¹å™¨ä¸­æŒ‰ç…§ä¸€å®šè§„åˆ™è¿›è¡Œç‰©å“æ‘†æ”¾ï¼Œå¹¶ä¸”ä¸ä¼šå½±å“å…¶å®ƒç¯å¢ƒä¸­çš„ç‰©å“ã€‚å¦‚æœä¸€ä¸ªå…ƒç´ ç¬¦åˆè§¦å‘BFCçš„æ¡ä»¶ï¼Œåˆ™BFCä¸­çš„å…ƒç´ å¸ƒå±€ä¸å—å¤–éƒ¨å½±å“ã€‚</p><p><strong>åˆ›å»ºBFCçš„æ¡ä»¶ï¼š</strong></p><ul><li>æ ¹å…ƒç´ ï¼šbodyï¼›</li><li>å…ƒç´ è®¾ç½®æµ®åŠ¨ï¼šfloat é™¤ none ä»¥å¤–çš„å€¼ï¼›</li><li>å…ƒç´ è®¾ç½®ç»å¯¹å®šä½ï¼šposition (absoluteã€fixed)ï¼›</li><li>display å€¼ä¸ºï¼šinline-blockã€table-cellã€table-captionã€flexç­‰ï¼›</li><li>overflow å€¼ä¸ºï¼šhiddenã€autoã€scrollï¼›</li></ul><p><strong>BFCçš„ç‰¹ç‚¹ï¼š</strong></p><ul><li>å‚ç›´æ–¹å‘ä¸Šï¼Œè‡ªä¸Šè€Œä¸‹æ’åˆ—ï¼Œå’Œæ–‡æ¡£æµçš„æ’åˆ—æ–¹å¼ä¸€è‡´ã€‚</li><li>åœ¨BFCä¸­ä¸Šä¸‹ç›¸é‚»çš„ä¸¤ä¸ªå®¹å™¨çš„marginä¼šé‡å </li><li>è®¡ç®—BFCçš„é«˜åº¦æ—¶ï¼Œéœ€è¦è®¡ç®—æµ®åŠ¨å…ƒç´ çš„é«˜åº¦</li><li>BFCåŒºåŸŸä¸ä¼šä¸æµ®åŠ¨çš„å®¹å™¨å‘ç”Ÿé‡å </li><li>BFCæ˜¯ç‹¬ç«‹çš„å®¹å™¨ï¼Œå®¹å™¨å†…éƒ¨å…ƒç´ ä¸ä¼šå½±å“å¤–éƒ¨å…ƒç´ </li><li>æ¯ä¸ªå…ƒç´ çš„å·¦marginå€¼å’Œå®¹å™¨çš„å·¦borderç›¸æ¥è§¦</li></ul><p><strong>BFCçš„ä½œç”¨ï¼š</strong></p><ul><li><strong>è§£å†³marginçš„é‡å é—®é¢˜</strong>ï¼šç”±äºBFCæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„åŒºåŸŸï¼Œå†…éƒ¨çš„å…ƒç´ å’Œå¤–éƒ¨çš„å…ƒç´ äº’ä¸å½±å“ï¼Œå°†ä¸¤ä¸ªå…ƒç´ å˜ä¸ºä¸¤ä¸ªBFCï¼Œå°±è§£å†³äº†marginé‡å çš„é—®é¢˜ã€‚</li><li><strong>è§£å†³é«˜åº¦å¡Œé™·çš„é—®é¢˜</strong>ï¼šåœ¨å¯¹å­å…ƒç´ è®¾ç½®æµ®åŠ¨åï¼Œçˆ¶å…ƒç´ ä¼šå‘ç”Ÿé«˜åº¦å¡Œé™·ï¼Œä¹Ÿå°±æ˜¯çˆ¶å…ƒç´ çš„é«˜åº¦å˜ä¸º0ã€‚è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåªéœ€è¦æŠŠçˆ¶å…ƒç´ å˜æˆä¸€ä¸ªBFCã€‚å¸¸ç”¨çš„åŠæ³•æ˜¯ç»™çˆ¶å…ƒç´ è®¾ç½®<code>overflow:hidden</code>ã€‚</li><li><strong>åˆ›å»ºè‡ªé€‚åº”ä¸¤æ å¸ƒå±€</strong>ï¼šå¯ä»¥ç”¨æ¥åˆ›å»ºè‡ªé€‚åº”ä¸¤æ å¸ƒå±€ï¼šå·¦è¾¹çš„å®½åº¦å›ºå®šï¼Œå³è¾¹çš„å®½åº¦è‡ªé€‚åº”ã€‚</li></ul><pre class="line-numbers language-css"><code class="language-css"><span class="token selector"><span class="token class">.left</span></span><span class="token punctuation">{</span>     <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>     <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">200</span>px<span class="token punctuation">;</span>     <span class="token property">background</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>     <span class="token property">float</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token selector"><span class="token class">.right</span></span><span class="token punctuation">{</span>     <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">300</span>px<span class="token punctuation">;</span>     <span class="token property">background</span><span class="token punctuation">:</span> blue<span class="token punctuation">;</span>     <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span> <span class="token punctuation">}</span>&lt;div class=<span class="token string">"left"</span>>&lt;/div>&lt;div class=<span class="token string">"right"</span>>&lt;/div><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å·¦ä¾§è®¾ç½®<code>float:left</code>ï¼Œå³ä¾§è®¾ç½®<code>overflow: hidden</code>ã€‚è¿™æ ·å³è¾¹å°±è§¦å‘äº†BFCï¼ŒBFCçš„åŒºåŸŸä¸ä¼šä¸æµ®åŠ¨å…ƒç´ å‘ç”Ÿé‡å ï¼Œæ‰€ä»¥ä¸¤ä¾§å°±ä¸ä¼šå‘ç”Ÿé‡å ï¼Œå®ç°äº†è‡ªé€‚åº”ä¸¤æ å¸ƒå±€ã€‚</p><h3 id="4-ä»€ä¹ˆæ˜¯marginé‡å é—®é¢˜ï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿ"><a href="#4-ä»€ä¹ˆæ˜¯marginé‡å é—®é¢˜ï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿ" class="headerlink" title="4. ä»€ä¹ˆæ˜¯marginé‡å é—®é¢˜ï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿ"></a>4. ä»€ä¹ˆæ˜¯marginé‡å é—®é¢˜ï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿ</h3><p><strong>é—®é¢˜æè¿°ï¼š</strong><br>ä¸¤ä¸ªå—çº§å…ƒç´ çš„ä¸Šå¤–è¾¹è·å’Œä¸‹å¤–è¾¹è·å¯èƒ½ä¼šåˆå¹¶ï¼ˆæŠ˜å ï¼‰ä¸ºä¸€ä¸ªå¤–è¾¹è·ï¼Œå…¶å¤§å°ä¼šå–å…¶ä¸­å¤–è¾¹è·å€¼å¤§çš„é‚£ä¸ªï¼Œè¿™ç§è¡Œä¸ºå°±æ˜¯å¤–è¾¹è·æŠ˜å ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>æµ®åŠ¨çš„å…ƒç´ å’Œç»å¯¹å®šä½</strong>è¿™ç§è„±ç¦»æ–‡æ¡£æµçš„å…ƒç´ çš„å¤–è¾¹è·ä¸ä¼šæŠ˜å ã€‚é‡å åªä¼šå‡ºç°åœ¨<strong>å‚ç›´æ–¹å‘</strong>ã€‚</p><p><strong>è®¡ç®—åŸåˆ™ï¼š</strong><br>æŠ˜å åˆå¹¶åå¤–è¾¹è·çš„è®¡ç®—åŸåˆ™å¦‚ä¸‹ï¼š</p><ul><li>å¦‚æœä¸¤è€…éƒ½æ˜¯æ­£æ•°ï¼Œé‚£ä¹ˆå°±å»æœ€å¤§è€…</li><li>å¦‚æœæ˜¯ä¸€æ­£ä¸€è´Ÿï¼Œå°±ä¼šæ­£å€¼å‡å»è´Ÿå€¼çš„ç»å¯¹å€¼</li><li>ä¸¤ä¸ªéƒ½æ˜¯è´Ÿå€¼æ—¶ï¼Œç”¨0å‡å»ä¸¤ä¸ªä¸­ç»å¯¹å€¼å¤§çš„é‚£ä¸ª</li></ul><p><strong>è§£å†³åŠæ³•ï¼š</strong><br>å¯¹äºæŠ˜å çš„æƒ…å†µï¼Œä¸»è¦æœ‰ä¸¤ç§ï¼š<strong>å…„å¼Ÿä¹‹é—´é‡å </strong>å’Œ<strong>çˆ¶å­ä¹‹é—´é‡å </strong><br>ï¼ˆ1ï¼‰å…„å¼Ÿä¹‹é—´é‡å </p><ul><li>åº•éƒ¨å…ƒç´ å˜ä¸ºè¡Œå†…ç›’å­ï¼š<code>display: inline-block</code></li><li>åº•éƒ¨å…ƒç´ è®¾ç½®æµ®åŠ¨ï¼š<code>float</code></li><li>åº•éƒ¨å…ƒç´ çš„positionçš„å€¼ä¸º<code>absolute/fixed</code></li></ul><p>ï¼ˆ2ï¼‰çˆ¶å­ä¹‹é—´é‡å </p><ul><li>çˆ¶å…ƒç´ åŠ å…¥ï¼š<code>overflow: hidden</code></li><li>çˆ¶å…ƒç´ æ·»åŠ é€æ˜è¾¹æ¡†ï¼š<code>border:1px solid transparent</code></li><li>å­å…ƒç´ å˜ä¸ºè¡Œå†…ç›’å­ï¼š<code>display: inline-block</code></li><li>å­å…ƒç´ åŠ å…¥æµ®åŠ¨å±æ€§æˆ–å®šä½</li></ul><h3 id="5-å…ƒç´ çš„å±‚å é¡ºåº"><a href="#5-å…ƒç´ çš„å±‚å é¡ºåº" class="headerlink" title="5. å…ƒç´ çš„å±‚å é¡ºåº"></a>5. å…ƒç´ çš„å±‚å é¡ºåº</h3><p>å±‚å é¡ºåºï¼Œè‹±æ–‡ç§°ä½œ stacking orderï¼Œè¡¨ç¤ºå…ƒç´ å‘ç”Ÿå±‚å æ—¶æœ‰ç€ç‰¹å®šçš„å‚ç›´æ˜¾ç¤ºé¡ºåºã€‚ä¸‹é¢æ˜¯ç›’æ¨¡å‹çš„å±‚å è§„åˆ™ï¼š<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/CSS/8.png" alt=""><br>å¯¹äºä¸Šå›¾ï¼Œç”±ä¸Šåˆ°ä¸‹åˆ†åˆ«æ˜¯ï¼š<br>ï¼ˆ1ï¼‰èƒŒæ™¯å’Œè¾¹æ¡†ï¼šå»ºç«‹å½“å‰å±‚å ä¸Šä¸‹æ–‡å…ƒç´ çš„èƒŒæ™¯å’Œè¾¹æ¡†ã€‚<br>ï¼ˆ2ï¼‰è´Ÿçš„z-indexï¼šå½“å‰å±‚å ä¸Šä¸‹æ–‡ä¸­ï¼Œz-indexå±æ€§å€¼ä¸ºè´Ÿçš„å…ƒç´ ã€‚<br>ï¼ˆ3ï¼‰å—çº§ç›’ï¼šæ–‡æ¡£æµå†…éè¡Œå†…çº§éå®šä½åä»£å…ƒç´ ã€‚<br>ï¼ˆ4ï¼‰æµ®åŠ¨ç›’ï¼šéå®šä½æµ®åŠ¨å…ƒç´ ã€‚<br>ï¼ˆ5ï¼‰è¡Œå†…ç›’ï¼šæ–‡æ¡£æµå†…è¡Œå†…çº§éå®šä½åä»£å…ƒç´ ã€‚<br>ï¼ˆ6ï¼‰z-index:0ï¼šå±‚å çº§æ•°ä¸º0çš„å®šä½å…ƒç´ ã€‚<br>ï¼ˆ7ï¼‰æ­£z-indexï¼šz-indexå±æ€§å€¼ä¸ºæ­£çš„å®šä½å…ƒç´ ã€‚</p><p><strong>æ³¨æ„:</strong> å½“å®šä½å…ƒç´ z-index:autoï¼Œç”Ÿæˆç›’åœ¨å½“å‰å±‚å ä¸Šä¸‹æ–‡ä¸­çš„å±‚çº§ä¸º 0ï¼Œä¸ä¼šå»ºç«‹æ–°çš„å±‚å ä¸Šä¸‹æ–‡ï¼Œé™¤éæ˜¯æ ¹å…ƒç´ ã€‚</p><h3 id="6-positionçš„å±æ€§æœ‰å“ªäº›ï¼ŒåŒºåˆ«æ˜¯ä»€ä¹ˆ"><a href="#6-positionçš„å±æ€§æœ‰å“ªäº›ï¼ŒåŒºåˆ«æ˜¯ä»€ä¹ˆ" class="headerlink" title="6. positionçš„å±æ€§æœ‰å“ªäº›ï¼ŒåŒºåˆ«æ˜¯ä»€ä¹ˆ"></a>6. positionçš„å±æ€§æœ‰å“ªäº›ï¼ŒåŒºåˆ«æ˜¯ä»€ä¹ˆ</h3><p>positionæœ‰ä»¥ä¸‹å±æ€§å€¼ï¼š</p><table><thead><tr><th>å±æ€§å€¼</th><th>æ¦‚è¿°</th></tr></thead><tbody><tr><td>absolute</td><td>ç”Ÿæˆç»å¯¹å®šä½çš„å…ƒç´ ï¼Œç›¸å¯¹äºstaticå®šä½ä»¥å¤–çš„ä¸€ä¸ªçˆ¶å…ƒç´ è¿›è¡Œå®šä½ã€‚å…ƒç´ çš„ä½ç½®é€šè¿‡leftã€topã€rightã€bottomå±æ€§è¿›è¡Œè§„å®šã€‚</td></tr><tr><td>relative</td><td>ç”Ÿæˆç›¸å¯¹å®šä½çš„å…ƒç´ ï¼Œç›¸å¯¹äºå…¶åŸæ¥çš„ä½ç½®è¿›è¡Œå®šä½ã€‚å…ƒç´ çš„ä½ç½®é€šè¿‡leftã€topã€rightã€bottomå±æ€§è¿›è¡Œè§„å®šã€‚</td></tr><tr><td>fixed</td><td>ç”Ÿæˆç»å¯¹å®šä½çš„å…ƒç´ ï¼ŒæŒ‡å®šå…ƒç´ ç›¸å¯¹äºå±å¹•è§†â¼ï¼ˆviewportï¼‰çš„ä½ç½®æ¥æŒ‡å®šå…ƒç´ ä½ç½®ã€‚å…ƒç´ çš„ä½ç½®åœ¨å±å¹•æ»šåŠ¨æ—¶ä¸ä¼šæ”¹å˜ï¼Œâ½å¦‚å›åˆ°é¡¶éƒ¨çš„æŒ‰é’®â¼€èˆ¬éƒ½æ˜¯â½¤æ­¤å®šä½â½…å¼ã€‚</td></tr><tr><td>static</td><td>é»˜è®¤å€¼ï¼Œæ²¡æœ‰å®šä½ï¼Œå…ƒç´ å‡ºç°åœ¨æ­£å¸¸çš„æ–‡æ¡£æµä¸­ï¼Œä¼šå¿½ç•¥ top, bottom, left, right æˆ–è€… z-index å£°æ˜ï¼Œå—çº§å…ƒç´ ä»ä¸Šå¾€ä¸‹çºµå‘æ’å¸ƒï¼Œâ¾çº§å…ƒç´ ä»å·¦å‘å³æ’åˆ—ã€‚</td></tr><tr><td>inherit</td><td>è§„å®šä»çˆ¶å…ƒç´ ç»§æ‰¿positionå±æ€§çš„å€¼</td></tr></tbody></table><p>å‰é¢ä¸‰è€…çš„å®šä½æ–¹å¼å¦‚ä¸‹ï¼š</p><ul><li><strong>relativeï¼š</strong> å…ƒç´ çš„å®šä½æ°¸è¿œæ˜¯ç›¸å¯¹äºå…ƒç´ è‡ªèº«ä½ç½®çš„ï¼Œå’Œå…¶ä»–å…ƒç´ æ²¡å…³ç³»ï¼Œä¹Ÿä¸ä¼šå½±å“å…¶ä»–å…ƒç´ ã€‚</li></ul><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/CSS/9.png" alt=""></p><ul><li><strong>fixedï¼š</strong> å…ƒç´ çš„å®šä½æ˜¯ç›¸å¯¹äº window ï¼ˆæˆ–è€… iframeï¼‰è¾¹ç•Œçš„ï¼Œå’Œå…¶ä»–å…ƒç´ æ²¡æœ‰å…³ç³»ã€‚ä½†æ˜¯å®ƒå…·æœ‰ç ´åæ€§ï¼Œä¼šå¯¼è‡´å…¶ä»–å…ƒç´ ä½ç½®çš„å˜åŒ–ã€‚</li></ul><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/CSS/10.png" alt=""></p><ul><li><strong>absoluteï¼š</strong> å…ƒç´ çš„å®šä½ç›¸å¯¹äºå‰ä¸¤è€…è¦å¤æ‚è®¸å¤šã€‚å¦‚æœä¸º absolute è®¾ç½®äº† topã€leftï¼Œæµè§ˆå™¨ä¼šæ ¹æ®ä»€ä¹ˆå»ç¡®å®šå®ƒçš„çºµå‘å’Œæ¨ªå‘çš„åç§»é‡å‘¢ï¼Ÿç­”æ¡ˆæ˜¯æµè§ˆå™¨ä¼šé€’å½’æŸ¥æ‰¾è¯¥å…ƒç´ çš„æ‰€æœ‰çˆ¶å…ƒç´ ï¼Œå¦‚æœæ‰¾åˆ°ä¸€ä¸ªè®¾ç½®äº†<code>position:relative/absolute/fixed</code>çš„å…ƒç´ ï¼Œå°±ä»¥è¯¥å…ƒç´ ä¸ºåŸºå‡†å®šä½ï¼Œå¦‚æœæ²¡æ‰¾åˆ°ï¼Œå°±ä»¥æµè§ˆå™¨è¾¹ç•Œå®šä½ã€‚å¦‚ä¸‹ä¸¤ä¸ªå›¾æ‰€ç¤ºï¼š</li></ul><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/CSS/11.png" alt=""><br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/CSS/12.png" alt=""></p><h3 id="7-displayã€floatã€positionçš„å…³ç³»"><a href="#7-displayã€floatã€positionçš„å…³ç³»" class="headerlink" title="7. displayã€floatã€positionçš„å…³ç³»"></a>7. <strong>displayã€floatã€positionçš„å…³ç³»</strong></h3><p>ï¼ˆ1ï¼‰é¦–å…ˆåˆ¤æ–­displayå±æ€§æ˜¯å¦ä¸ºnoneï¼Œå¦‚æœä¸ºnoneï¼Œåˆ™positionå’Œfloatå±æ€§çš„å€¼ä¸å½±å“å…ƒç´ æœ€åçš„è¡¨ç°ã€‚</p><p>ï¼ˆ2ï¼‰ç„¶ååˆ¤æ–­positionçš„å€¼æ˜¯å¦ä¸ºabsoluteæˆ–è€…fixedï¼Œå¦‚æœæ˜¯ï¼Œåˆ™floatå±æ€§å¤±æ•ˆï¼Œå¹¶ä¸”displayçš„å€¼åº”è¯¥è¢«è®¾ç½®ä¸ºtableæˆ–è€…blockï¼Œå…·ä½“è½¬æ¢éœ€è¦çœ‹åˆå§‹è½¬æ¢å€¼ã€‚</p><p>ï¼ˆ3ï¼‰å¦‚æœpositionçš„å€¼ä¸ä¸ºabsoluteæˆ–è€…fixedï¼Œåˆ™åˆ¤æ–­floatå±æ€§çš„å€¼æ˜¯å¦ä¸ºnoneï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™displayçš„å€¼åˆ™æŒ‰ä¸Šé¢çš„è§„åˆ™è½¬æ¢ã€‚æ³¨æ„ï¼Œå¦‚æœpositionçš„å€¼ä¸ºrelativeå¹¶ä¸”floatå±æ€§çš„å€¼å­˜åœ¨ï¼Œåˆ™relativeç›¸å¯¹äºæµ®åŠ¨åçš„æœ€ç»ˆä½ç½®å®šä½ã€‚</p><p>ï¼ˆ4ï¼‰å¦‚æœfloatçš„å€¼ä¸ºnoneï¼Œåˆ™åˆ¤æ–­å…ƒç´ æ˜¯å¦ä¸ºæ ¹å…ƒç´ ï¼Œå¦‚æœæ˜¯æ ¹å…ƒç´ åˆ™displayå±æ€§æŒ‰ç…§ä¸Šé¢çš„è§„åˆ™è½¬æ¢ï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™ä¿æŒæŒ‡å®šçš„displayå±æ€§å€¼ä¸å˜ã€‚</p><p>æ€»çš„æ¥è¯´ï¼Œå¯ä»¥æŠŠå®ƒçœ‹ä½œæ˜¯ä¸€ä¸ªç±»ä¼¼ä¼˜å…ˆçº§çš„æœºåˆ¶ï¼Œâ€position:absoluteâ€å’Œâ€position:fixedâ€ä¼˜å…ˆçº§æœ€é«˜ï¼Œæœ‰å®ƒå­˜åœ¨çš„æ—¶å€™ï¼Œæµ®åŠ¨ä¸èµ·ä½œç”¨ï¼Œâ€™displayâ€™çš„å€¼ä¹Ÿéœ€è¦è°ƒæ•´ï¼›å…¶æ¬¡ï¼Œå…ƒç´ çš„â€™floatâ€™ç‰¹æ€§çš„å€¼ä¸æ˜¯â€noneâ€çš„æ—¶å€™æˆ–è€…å®ƒæ˜¯æ ¹å…ƒç´ çš„æ—¶å€™ï¼Œè°ƒæ•´â€™displayâ€™çš„å€¼ï¼›æœ€åï¼Œéæ ¹å…ƒç´ ï¼Œå¹¶ä¸”éæµ®åŠ¨å…ƒç´ ï¼Œå¹¶ä¸”éç»å¯¹å®šä½çš„å…ƒç´ ï¼Œâ€™displayâ€™ç‰¹æ€§å€¼åŒè®¾ç½®å€¼ã€‚</p><h3 id="8-absoluteä¸fixedå…±åŒç‚¹ä¸ä¸åŒç‚¹"><a href="#8-absoluteä¸fixedå…±åŒç‚¹ä¸ä¸åŒç‚¹" class="headerlink" title="8. absoluteä¸fixedå…±åŒç‚¹ä¸ä¸åŒç‚¹"></a>8. absoluteä¸fixedå…±åŒç‚¹ä¸ä¸åŒç‚¹</h3><p><strong>å…±åŒç‚¹ï¼š</strong></p><ul><li>æ”¹å˜è¡Œå†…å…ƒç´ çš„å‘ˆç°æ–¹å¼ï¼Œå°†displayç½®ä¸ºinline-block  </li><li>ä½¿å…ƒç´ è„±ç¦»æ™®é€šæ–‡æ¡£æµï¼Œä¸å†å æ®æ–‡æ¡£ç‰©ç†ç©ºé—´</li><li>è¦†ç›–éå®šä½æ–‡æ¡£å…ƒç´ </li></ul><p><strong>ä¸åŒç‚¹ï¼š</strong></p><ul><li>abuseluteä¸fixedçš„æ ¹å…ƒç´ ä¸åŒï¼Œabuseluteçš„æ ¹å…ƒç´ å¯ä»¥è®¾ç½®ï¼Œfixedæ ¹å…ƒç´ æ˜¯æµè§ˆå™¨ã€‚</li><li>åœ¨æœ‰æ»šåŠ¨æ¡çš„é¡µé¢ä¸­ï¼Œabsoluteä¼šè·Ÿç€çˆ¶å…ƒç´ è¿›è¡Œç§»åŠ¨ï¼Œfixedå›ºå®šåœ¨é¡µé¢çš„å…·ä½“ä½ç½®ã€‚</li></ul><h3 id="9-å¯¹-sticky-å®šä½çš„ç†è§£"><a href="#9-å¯¹-sticky-å®šä½çš„ç†è§£" class="headerlink" title="9. å¯¹ sticky å®šä½çš„ç†è§£"></a>9. å¯¹ sticky å®šä½çš„ç†è§£</h3><p>sticky è‹±æ–‡å­—é¢æ„æ€æ˜¯ç²˜è´´ï¼Œæ‰€ä»¥å¯ä»¥æŠŠå®ƒç§°ä¹‹ä¸ºç²˜æ€§å®šä½ã€‚è¯­æ³•ï¼š<strong>position: sticky;</strong> åŸºäºç”¨æˆ·çš„æ»šåŠ¨ä½ç½®æ¥å®šä½ã€‚</p><p>ç²˜æ€§å®šä½çš„å…ƒç´ æ˜¯ä¾èµ–äºç”¨æˆ·çš„æ»šåŠ¨ï¼Œåœ¨ <strong>position:relative</strong> ä¸ <strong>position:fixed</strong> å®šä½ä¹‹é—´åˆ‡æ¢ã€‚å®ƒçš„è¡Œä¸ºå°±åƒ <strong>position:relative;</strong> è€Œå½“é¡µé¢æ»šåŠ¨è¶…å‡ºç›®æ ‡åŒºåŸŸæ—¶ï¼Œå®ƒçš„è¡¨ç°å°±åƒ <strong>position:fixed;</strong>ï¼Œå®ƒä¼šå›ºå®šåœ¨ç›®æ ‡ä½ç½®ã€‚å…ƒç´ å®šä½è¡¨ç°ä¸ºåœ¨è·¨è¶Šç‰¹å®šé˜ˆå€¼å‰ä¸ºç›¸å¯¹å®šä½ï¼Œä¹‹åä¸ºå›ºå®šå®šä½ã€‚è¿™ä¸ªç‰¹å®šé˜ˆå€¼æŒ‡çš„æ˜¯ top, right, bottom æˆ– left ä¹‹ä¸€ï¼Œæ¢è¨€ä¹‹ï¼ŒæŒ‡å®š top, right, bottom æˆ– left å››ä¸ªé˜ˆå€¼å…¶ä¸­ä¹‹ä¸€ï¼Œæ‰å¯ä½¿ç²˜æ€§å®šä½ç”Ÿæ•ˆã€‚å¦åˆ™å…¶è¡Œä¸ºä¸ç›¸å¯¹å®šä½ç›¸åŒã€‚</p><h2 id="å››ã€åœºæ™¯åº”ç”¨"><a href="#å››ã€åœºæ™¯åº”ç”¨" class="headerlink" title="å››ã€åœºæ™¯åº”ç”¨"></a>å››ã€åœºæ™¯åº”ç”¨</h2><h3 id="1-å®ç°ä¸€ä¸ªä¸‰è§’å½¢"><a href="#1-å®ç°ä¸€ä¸ªä¸‰è§’å½¢" class="headerlink" title="1. å®ç°ä¸€ä¸ªä¸‰è§’å½¢"></a>1. å®ç°ä¸€ä¸ªä¸‰è§’å½¢</h3><p>CSSç»˜åˆ¶ä¸‰è§’å½¢ä¸»è¦ç”¨åˆ°çš„æ˜¯borderå±æ€§ï¼Œä¹Ÿå°±æ˜¯è¾¹æ¡†ã€‚</p><p>å¹³æ—¶åœ¨ç»™ç›’å­è®¾ç½®è¾¹æ¡†æ—¶ï¼Œå¾€å¾€éƒ½è®¾ç½®å¾ˆçª„ï¼Œå°±å¯èƒ½è¯¯ä»¥ä¸ºè¾¹æ¡†æ˜¯ç”±çŸ©å½¢ç»„æˆçš„ã€‚å®é™…ä¸Šï¼Œborderå±æ€§æ˜¯å³ä¸‰è§’å½¢ç»„æˆçš„ï¼Œä¸‹é¢çœ‹ä¸€ä¸ªä¾‹å­ï¼š</p><pre class="line-numbers language-css"><code class="language-css"><span class="token selector">div </span><span class="token punctuation">{</span>    <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token property">border</span><span class="token punctuation">:</span> <span class="token number">100</span>px solid<span class="token punctuation">;</span>    <span class="token property">border-color</span><span class="token punctuation">:</span> orange blue red green<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å°†å…ƒç´ çš„é•¿å®½éƒ½è®¾ç½®ä¸º0ï¼Œæ˜¾ç¤ºå‡ºæ¥çš„æ•ˆæœæ˜¯è¿™æ ·çš„ï¼š<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/CSS/13.png" alt=""><br>æ‰€ä»¥å¯ä»¥æ ¹æ®borderè¿™ä¸ªç‰¹æ€§æ¥ç»˜åˆ¶ä¸‰è§’å½¢ï¼š<br><strong>ï¼ˆ1ï¼‰ä¸‰è§’1</strong></p><pre class="line-numbers language-css"><code class="language-css"><span class="token selector">div </span><span class="token punctuation">{</span>    <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token property">border-top</span><span class="token punctuation">:</span> <span class="token number">50</span>px solid red<span class="token punctuation">;</span>    <span class="token property">border-right</span><span class="token punctuation">:</span> <span class="token number">50</span>px solid transparent<span class="token punctuation">;</span>    <span class="token property">border-left</span><span class="token punctuation">:</span> <span class="token number">50</span>px solid transparent<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/CSS/14.png" alt=""><br><strong>ï¼ˆ2ï¼‰ä¸‰è§’2</strong></p><pre class="line-numbers language-css"><code class="language-css"><span class="token selector">div </span><span class="token punctuation">{</span>    <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token property">border-bottom</span><span class="token punctuation">:</span> <span class="token number">50</span>px solid red<span class="token punctuation">;</span>    <span class="token property">border-right</span><span class="token punctuation">:</span> <span class="token number">50</span>px solid transparent<span class="token punctuation">;</span>    <span class="token property">border-left</span><span class="token punctuation">:</span> <span class="token number">50</span>px solid transparent<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/CSS/15.png" alt=""><br><strong>ï¼ˆ3ï¼‰ä¸‰è§’3</strong></p><pre class="line-numbers language-css"><code class="language-css"><span class="token selector">div </span><span class="token punctuation">{</span>    <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token property">border-left</span><span class="token punctuation">:</span> <span class="token number">50</span>px solid red<span class="token punctuation">;</span>    <span class="token property">border-top</span><span class="token punctuation">:</span> <span class="token number">50</span>px solid transparent<span class="token punctuation">;</span>    <span class="token property">border-bottom</span><span class="token punctuation">:</span> <span class="token number">50</span>px solid transparent<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/CSS/16.png" alt=""><br><strong>ï¼ˆ4ï¼‰ä¸‰è§’4</strong></p><pre class="line-numbers language-css"><code class="language-css"><span class="token selector">div </span><span class="token punctuation">{</span>    <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token property">border-right</span><span class="token punctuation">:</span> <span class="token number">50</span>px solid red<span class="token punctuation">;</span>    <span class="token property">border-top</span><span class="token punctuation">:</span> <span class="token number">50</span>px solid transparent<span class="token punctuation">;</span>    <span class="token property">border-bottom</span><span class="token punctuation">:</span> <span class="token number">50</span>px solid transparent<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/CSS/17.png" alt=""><br><strong>ï¼ˆ5ï¼‰ä¸‰è§’5</strong></p><pre class="line-numbers language-css"><code class="language-css"><span class="token selector">div </span><span class="token punctuation">{</span>    <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token property">border-top</span><span class="token punctuation">:</span> <span class="token number">100</span>px solid red<span class="token punctuation">;</span>    <span class="token property">border-right</span><span class="token punctuation">:</span> <span class="token number">100</span>px solid transparent<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/CSS/18.png" alt=""><br>è¿˜æœ‰å¾ˆå¤šï¼Œå°±ä¸ä¸€ä¸€å®ç°äº†ï¼Œæ€»ä½“çš„åŸåˆ™å°±æ˜¯é€šè¿‡ä¸Šä¸‹å·¦å³è¾¹æ¡†æ¥æ§åˆ¶ä¸‰è§’å½¢çš„æ–¹å‘ï¼Œç”¨è¾¹æ¡†çš„å®½åº¦æ¯”æ¥æ§åˆ¶ä¸‰è§’å½¢çš„è§’åº¦ã€‚</p><h3 id="2-å®ç°ä¸€ä¸ªæ‰‡å½¢"><a href="#2-å®ç°ä¸€ä¸ªæ‰‡å½¢" class="headerlink" title="2. å®ç°ä¸€ä¸ªæ‰‡å½¢"></a>2. å®ç°ä¸€ä¸ªæ‰‡å½¢</h3><p>ç”¨CSSå®ç°æ‰‡å½¢çš„æ€è·¯å’Œä¸‰è§’å½¢åŸºæœ¬ä¸€è‡´ï¼Œå°±æ˜¯å¤šäº†ä¸€ä¸ªåœ†è§’çš„æ ·å¼ï¼Œå®ç°ä¸€ä¸ª90Â°çš„æ‰‡å½¢ï¼š</p><pre class="line-numbers language-css"><code class="language-css"><span class="token selector">div</span><span class="token punctuation">{</span>    <span class="token property">border</span><span class="token punctuation">:</span> <span class="token number">100</span>px solid transparent<span class="token punctuation">;</span>    <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token property">heigt</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token property">border-radius</span><span class="token punctuation">:</span> <span class="token number">100</span>px<span class="token punctuation">;</span>    <span class="token property">border-top-color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/CSS/19.png" alt=""></p><h3 id="3-å®ç°ä¸€ä¸ªå®½é«˜è‡ªé€‚åº”çš„æ­£æ–¹å½¢"><a href="#3-å®ç°ä¸€ä¸ªå®½é«˜è‡ªé€‚åº”çš„æ­£æ–¹å½¢" class="headerlink" title="3. å®ç°ä¸€ä¸ªå®½é«˜è‡ªé€‚åº”çš„æ­£æ–¹å½¢"></a>3. å®ç°ä¸€ä¸ªå®½é«˜è‡ªé€‚åº”çš„æ­£æ–¹å½¢</h3><ul><li>åˆ©ç”¨vwæ¥å®ç°ï¼š</li></ul><pre class="line-numbers language-css"><code class="language-css"><span class="token selector"><span class="token class">.square</span> </span><span class="token punctuation">{</span>  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">10%</span><span class="token punctuation">;</span>  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">10</span>vw<span class="token punctuation">;</span>  <span class="token property">background</span><span class="token punctuation">:</span> tomato<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>åˆ©ç”¨å…ƒç´ çš„margin/paddingç™¾åˆ†æ¯”æ˜¯ç›¸å¯¹çˆ¶å…ƒç´ widthçš„æ€§è´¨æ¥å®ç°ï¼š</li></ul><pre class="line-numbers language-css"><code class="language-css"><span class="token selector"><span class="token class">.square</span> </span><span class="token punctuation">{</span>  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">20%</span><span class="token punctuation">;</span>  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>  <span class="token property">padding-top</span><span class="token punctuation">:</span> <span class="token number">20%</span><span class="token punctuation">;</span>  <span class="token property">background</span><span class="token punctuation">:</span> orange<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>åˆ©ç”¨å­å…ƒç´ çš„margin-topçš„å€¼æ¥å®ç°ï¼š</li></ul><pre class="line-numbers language-css"><code class="language-css"><span class="token selector"><span class="token class">.square</span> </span><span class="token punctuation">{</span>  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">30%</span><span class="token punctuation">;</span>  <span class="token property">overflow</span><span class="token punctuation">:</span> hidden<span class="token punctuation">;</span>  <span class="token property">background</span><span class="token punctuation">:</span> yellow<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token class">.square</span><span class="token pseudo-element">::after</span> </span><span class="token punctuation">{</span>  <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">;</span>  <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>  <span class="token property">margin-top</span><span class="token punctuation">:</span> <span class="token number">100%</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-ç”»ä¸€æ¡0-5pxçš„çº¿"><a href="#4-ç”»ä¸€æ¡0-5pxçš„çº¿" class="headerlink" title="4. ç”»ä¸€æ¡0.5pxçš„çº¿"></a>4. ç”»ä¸€æ¡0.5pxçš„çº¿</h3><ul><li><strong>é‡‡ç”¨transform: scale()çš„æ–¹å¼</strong>ï¼Œè¯¥æ–¹æ³•ç”¨æ¥å®šä¹‰å…ƒç´ çš„2D ç¼©æ”¾è½¬æ¢ï¼š</li></ul><pre class="line-numbers language-css"><code class="language-css"><span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">scale</span><span class="token punctuation">(</span><span class="token number">0.5</span>,<span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><strong>é‡‡ç”¨meta viewportçš„æ–¹å¼</strong></li></ul><pre class="line-numbers language-css"><code class="language-css">&lt;meta name=<span class="token string">"viewport"</span> content=<span class="token string">"width=device-width, initial-scale=0.5, minimum-scale=0.5, maximum-scale=0.5"</span>/><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™æ ·å°±èƒ½ç¼©æ”¾åˆ°åŸæ¥çš„0.5å€ï¼Œå¦‚æœæ˜¯1pxé‚£ä¹ˆå°±ä¼šå˜æˆ0.5pxã€‚viewportåªé’ˆå¯¹äºç§»åŠ¨ç«¯ï¼Œåªåœ¨ç§»åŠ¨ç«¯ä¸Šæ‰èƒ½çœ‹åˆ°æ•ˆæœ</p><h3 id="5-è®¾ç½®å°äº12pxçš„å­—ä½“"><a href="#5-è®¾ç½®å°äº12pxçš„å­—ä½“" class="headerlink" title="5. è®¾ç½®å°äº12pxçš„å­—ä½“"></a>5. è®¾ç½®å°äº12pxçš„å­—ä½“</h3><p>åœ¨è°·æ­Œä¸‹cssè®¾ç½®å­—ä½“å¤§å°ä¸º12pxåŠä»¥ä¸‹æ—¶ï¼Œæ˜¾ç¤ºéƒ½æ˜¯ä¸€æ ·å¤§å°ï¼Œéƒ½æ˜¯é»˜è®¤12pxã€‚</p><p><strong>è§£å†³åŠæ³•ï¼š</strong></p><ul><li>ä½¿ç”¨Webkitçš„å†…æ ¸çš„-webkit-text-size-adjustçš„ç§æœ‰CSSå±æ€§æ¥è§£å†³ï¼Œåªè¦åŠ äº†-webkit-text-size-adjust:none;å­—ä½“å¤§å°å°±ä¸å—é™åˆ¶äº†ã€‚ä½†æ˜¯chromeæ›´æ–°åˆ°27ç‰ˆæœ¬ä¹‹åå°±ä¸å¯ä»¥ç”¨äº†ã€‚æ‰€ä»¥é«˜ç‰ˆæœ¬chromeè°·æ­Œæµè§ˆå™¨å·²ç»ä¸å†æ”¯æŒ-webkit-text-size-adjustæ ·å¼ï¼Œæ‰€ä»¥è¦ä½¿ç”¨æ—¶å€™æ…ç”¨ã€‚</li><li>ä½¿ç”¨css3çš„transformç¼©æ”¾å±æ€§-webkit-transform:scale(0.5); æ³¨æ„-webkit-transform:scale(0.75);æ”¶ç¼©çš„æ˜¯æ•´ä¸ªå…ƒç´ çš„å¤§å°ï¼Œè¿™æ—¶å€™ï¼Œå¦‚æœæ˜¯å†…è”å…ƒç´ ï¼Œå¿…é¡»è¦å°†å†…è”å…ƒç´ è½¬æ¢æˆå—å…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨displayï¼šblock/inline-block/â€¦ï¼›</li><li>ä½¿ç”¨å›¾ç‰‡ï¼šå¦‚æœæ˜¯å†…å®¹å›ºå®šä¸å˜æƒ…å†µä¸‹ï¼Œä½¿ç”¨å°†å°äº12pxæ–‡å­—å†…å®¹åˆ‡å‡ºåšå›¾ç‰‡ï¼Œè¿™æ ·ä¸å½±å“å…¼å®¹ä¹Ÿä¸å½±å“ç¾è§‚ã€‚</li></ul><h3 id="6-å¦‚ä½•è§£å†³-1px-é—®é¢˜ï¼Ÿ"><a href="#6-å¦‚ä½•è§£å†³-1px-é—®é¢˜ï¼Ÿ" class="headerlink" title="6. å¦‚ä½•è§£å†³ 1px é—®é¢˜ï¼Ÿ"></a>6. å¦‚ä½•è§£å†³ 1px é—®é¢˜ï¼Ÿ</h3><p>1px é—®é¢˜æŒ‡çš„æ˜¯ï¼šåœ¨ä¸€äº› <code>Retinaå±å¹•</code> çš„æœºå‹ä¸Šï¼Œç§»åŠ¨ç«¯é¡µé¢çš„ 1px ä¼šå˜å¾—å¾ˆç²—ï¼Œå‘ˆç°å‡ºä¸æ­¢ 1px çš„æ•ˆæœã€‚åŸå› å¾ˆç®€å•â€”â€”CSS ä¸­çš„ 1px å¹¶ä¸èƒ½å’Œç§»åŠ¨è®¾å¤‡ä¸Šçš„ 1px åˆ’ç­‰å·ã€‚å®ƒä»¬ä¹‹é—´çš„æ¯”ä¾‹å…³ç³»æœ‰ä¸€ä¸ªä¸“é—¨çš„å±æ€§æ¥æè¿°ï¼š</p><pre class="line-numbers language-html"><code class="language-html">window.devicePixelRatio = è®¾å¤‡çš„ç‰©ç†åƒç´  / CSSåƒç´ ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‰“å¼€ Chrome æµè§ˆå™¨ï¼Œå¯åŠ¨ç§»åŠ¨ç«¯è°ƒè¯•æ¨¡å¼ï¼Œåœ¨æ§åˆ¶å°å»è¾“å‡ºè¿™ä¸ª <code>devicePixelRatio</code> çš„å€¼ã€‚è¿™é‡Œé€‰ä¸­ iPhone6/7/8 è¿™ç³»åˆ—çš„æœºå‹ï¼Œè¾“å‡ºçš„ç»“æœå°±æ˜¯2ï¼š<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/CSS/20.png" alt=""><br>è¿™å°±æ„å‘³ç€è®¾ç½®çš„ 1px CSS åƒç´ ï¼Œåœ¨è¿™ä¸ªè®¾å¤‡ä¸Šå®é™…ä¼šç”¨ 2 ä¸ªç‰©ç†åƒç´ å•å…ƒæ¥è¿›è¡Œæ¸²æŸ“ï¼Œæ‰€ä»¥å®é™…çœ‹åˆ°çš„ä¸€å®šä¼šæ¯” 1px ç²—ä¸€äº›ã€‚<br><strong>è§£å†³1px é—®é¢˜çš„ä¸‰ç§æ€è·¯ï¼š</strong></p><h4 id="æ€è·¯ä¸€ï¼šç›´æ¥å†™-0-5px"><a href="#æ€è·¯ä¸€ï¼šç›´æ¥å†™-0-5px" class="headerlink" title="æ€è·¯ä¸€ï¼šç›´æ¥å†™ 0.5px"></a>æ€è·¯ä¸€ï¼šç›´æ¥å†™ 0.5px</h4><p>å¦‚æœä¹‹å‰ 1px çš„æ ·å¼è¿™æ ·å†™ï¼š</p><pre class="line-numbers language-css"><code class="language-css"><span class="token property">border</span><span class="token punctuation">:</span><span class="token number">1</span>px solid <span class="token hexcode">#333</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯ä»¥å…ˆåœ¨ JS ä¸­æ‹¿åˆ° window.devicePixelRatio çš„å€¼ï¼Œç„¶åæŠŠè¿™ä¸ªå€¼é€šè¿‡ JSX æˆ–è€…æ¨¡æ¿è¯­æ³•ç»™åˆ° CSS çš„ data é‡Œï¼Œè¾¾åˆ°è¿™æ ·çš„æ•ˆæœï¼ˆè¿™é‡Œç”¨ JSX è¯­æ³•åšç¤ºèŒƒï¼‰ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"container"</span> data<span class="token operator">-</span>device<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>window<span class="token punctuation">.</span>devicePixelRatio<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åå°±å¯ä»¥åœ¨ CSS ä¸­ç”¨å±æ€§é€‰æ‹©å™¨æ¥å‘½ä¸­ devicePixelRatio ä¸ºæŸä¸€å€¼çš„æƒ…å†µï¼Œæ¯”å¦‚è¯´è¿™é‡Œå°è¯•å‘½ä¸­ devicePixelRatio ä¸º2çš„æƒ…å†µï¼š</p><pre class="line-numbers language-css"><code class="language-css"><span class="token selector"><span class="token id">#container</span><span class="token attribute">[data-device="2"]</span> </span><span class="token punctuation">{</span>  <span class="token property">border</span><span class="token punctuation">:</span><span class="token number">0.5</span>px solid <span class="token hexcode">#333</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ç›´æ¥æŠŠ 1px æ”¹æˆ 1/devicePixelRatio åçš„å€¼ï¼Œè¿™æ˜¯ç›®å‰ä¸ºæ­¢æœ€ç®€å•çš„ä¸€ç§æ–¹æ³•ã€‚è¿™ç§æ–¹æ³•çš„ç¼ºé™·åœ¨äºå…¼å®¹æ€§ä¸è¡Œï¼ŒIOS ç³»ç»Ÿéœ€è¦8åŠä»¥ä¸Šçš„ç‰ˆæœ¬ï¼Œå®‰å“ç³»ç»Ÿåˆ™ç›´æ¥ä¸å…¼å®¹ã€‚</p><h4 id="æ€è·¯äºŒï¼šä¼ªå…ƒç´ å…ˆæ”¾å¤§åç¼©å°"><a href="#æ€è·¯äºŒï¼šä¼ªå…ƒç´ å…ˆæ”¾å¤§åç¼©å°" class="headerlink" title="æ€è·¯äºŒï¼šä¼ªå…ƒç´ å…ˆæ”¾å¤§åç¼©å°"></a>æ€è·¯äºŒï¼šä¼ªå…ƒç´ å…ˆæ”¾å¤§åç¼©å°</h4><p>è¿™ä¸ªæ–¹æ³•çš„å¯è¡Œæ€§ä¼šæ›´é«˜ï¼Œå…¼å®¹æ€§ä¹Ÿæ›´å¥½ã€‚å”¯ä¸€çš„ç¼ºç‚¹æ˜¯ä»£ç ä¼šå˜å¤šã€‚</p><p>æ€è·¯æ˜¯<strong>å…ˆæ”¾å¤§ã€åç¼©å°ï¼šåœ¨ç›®æ ‡å…ƒç´ çš„åé¢è¿½åŠ ä¸€ä¸ª ::after ä¼ªå…ƒç´ ï¼Œè®©è¿™ä¸ªå…ƒç´ å¸ƒå±€ä¸º absolute ä¹‹åã€æ•´ä¸ªä¼¸å±•å¼€é“ºåœ¨ç›®æ ‡å…ƒç´ ä¸Šï¼Œç„¶åæŠŠå®ƒçš„å®½å’Œé«˜éƒ½è®¾ç½®ä¸ºç›®æ ‡å…ƒç´ çš„ä¸¤å€ï¼Œborderå€¼è®¾ä¸º 1pxã€‚æ¥ç€å€ŸåŠ© CSS åŠ¨ç”»ç‰¹æ•ˆä¸­çš„æ”¾ç¼©èƒ½åŠ›ï¼ŒæŠŠæ•´ä¸ªä¼ªå…ƒç´ ç¼©å°ä¸ºåŸæ¥çš„ 50%ã€‚æ­¤æ—¶ï¼Œä¼ªå…ƒç´ çš„å®½é«˜åˆšå¥½å¯ä»¥å’ŒåŸæœ‰çš„ç›®æ ‡å…ƒç´ å¯¹é½ï¼Œè€Œ border ä¹Ÿç¼©å°ä¸ºäº† 1px çš„äºŒåˆ†ä¹‹ä¸€ï¼Œé—´æ¥åœ°å®ç°äº† 0.5px çš„æ•ˆæœã€‚</strong></p><p>ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-css"><code class="language-css"><span class="token selector"><span class="token id">#container</span><span class="token attribute">[data-device="2"]</span> </span><span class="token punctuation">{</span>    <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token selector"><span class="token id">#container</span><span class="token attribute">[data-device="2"]</span><span class="token pseudo-element">::after</span></span><span class="token punctuation">{</span>      <span class="token property">position</span><span class="token punctuation">:</span>absolute<span class="token punctuation">;</span>      <span class="token property">top</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token property">left</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>      <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">200%</span><span class="token punctuation">;</span>      <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">200%</span><span class="token punctuation">;</span>      <span class="token property">content</span><span class="token punctuation">:</span><span class="token string">""</span><span class="token punctuation">;</span>      <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">scale</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token property">transform-origin</span><span class="token punctuation">:</span> left top<span class="token punctuation">;</span>      <span class="token property">box-sizing</span><span class="token punctuation">:</span> border-box<span class="token punctuation">;</span>      <span class="token property">border</span><span class="token punctuation">:</span> <span class="token number">1</span>px solid <span class="token hexcode">#333</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="æ€è·¯ä¸‰ï¼šviewport-ç¼©æ”¾æ¥è§£å†³"><a href="#æ€è·¯ä¸‰ï¼šviewport-ç¼©æ”¾æ¥è§£å†³" class="headerlink" title="æ€è·¯ä¸‰ï¼šviewport ç¼©æ”¾æ¥è§£å†³"></a>æ€è·¯ä¸‰ï¼šviewport ç¼©æ”¾æ¥è§£å†³</h4><p>è¿™ä¸ªæ€è·¯å°±æ˜¯å¯¹ meta æ ‡ç­¾é‡Œå‡ ä¸ªå…³é”®å±æ€§ä¸‹æ‰‹ï¼š</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>initial-scale<span class="token punctuation">=</span>0.5, maximum-scale<span class="token punctuation">=</span>0.5, minimum-scale<span class="token punctuation">=</span>0.5, user-scalable<span class="token punctuation">=</span>no<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™é‡Œé’ˆå¯¹åƒç´ æ¯”ä¸º2çš„é¡µé¢ï¼ŒæŠŠæ•´ä¸ªé¡µé¢ç¼©æ”¾ä¸ºäº†åŸæ¥çš„1/2å¤§å°ã€‚è¿™æ ·ï¼Œæœ¬æ¥å ç”¨2ä¸ªç‰©ç†åƒç´ çš„ 1px æ ·å¼ï¼Œç°åœ¨å ç”¨çš„å°±æ˜¯æ ‡å‡†çš„ä¸€ä¸ªç‰©ç†åƒç´ ã€‚æ ¹æ®åƒç´ æ¯”çš„ä¸åŒï¼Œè¿™ä¸ªç¼©æ”¾æ¯”ä¾‹å¯ä»¥è¢«è®¡ç®—ä¸ºä¸åŒçš„å€¼ï¼Œç”¨ js ä»£ç å®ç°å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token keyword">const</span> scale <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> window<span class="token punctuation">.</span>devicePixelRatio<span class="token punctuation">;</span><span class="token comment" spellcheck="true">// è¿™é‡Œ metaEl æŒ‡çš„æ˜¯ meta æ ‡ç­¾å¯¹åº”çš„ Dom</span>metaEl<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'content'</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token string">`width=device-width,user-scalable=no,initial-scale=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>scale<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,maximum-scale=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>scale<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,minimum-scale=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>scale<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·è§£å†³äº†ï¼Œä½†è¿™æ ·åšçš„å‰¯ä½œç”¨ä¹Ÿå¾ˆå¤§ï¼Œæ•´ä¸ªé¡µé¢è¢«ç¼©æ”¾äº†ã€‚è¿™æ—¶ 1px å·²ç»è¢«å¤„ç†æˆç‰©ç†åƒç´ å¤§å°ï¼Œè¿™æ ·çš„å¤§å°åœ¨æ‰‹æœºä¸Šæ˜¾ç¤ºè¾¹æ¡†å¾ˆåˆé€‚ã€‚ä½†æ˜¯ï¼Œä¸€äº›åŸæœ¬ä¸éœ€è¦è¢«ç¼©å°çš„å†…å®¹ï¼Œæ¯”å¦‚æ–‡å­—ã€å›¾ç‰‡ç­‰ï¼Œä¹Ÿè¢«æ— å·®åˆ«ç¼©å°æ‰äº†ã€‚</p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> CSS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Github </tag>
            
            <tag> åšå®¢ </tag>
            
            <tag> CSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTML</title>
      <link href="/2019/06/10/html/"/>
      <url>/2019/06/10/html/</url>
      
        <content type="html"><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/HTML/1.png" alt="HTMLé¢è¯•é¢˜.png"></p><h3 id="1-srcå’Œhrefçš„åŒºåˆ«"><a href="#1-srcå’Œhrefçš„åŒºåˆ«" class="headerlink" title="1. srcå’Œhrefçš„åŒºåˆ«"></a>1. srcå’Œhrefçš„åŒºåˆ«</h3><p>srcå’Œhreféƒ½æ˜¯<strong>ç”¨æ¥å¼•ç”¨å¤–éƒ¨çš„èµ„æº</strong>ï¼Œå®ƒä»¬çš„åŒºåˆ«å¦‚ä¸‹ï¼š</p><ul><li><strong>srcï¼š</strong> è¡¨ç¤ºå¯¹èµ„æºçš„å¼•ç”¨ï¼Œå®ƒæŒ‡å‘çš„å†…å®¹ä¼šåµŒå…¥åˆ°å½“å‰æ ‡ç­¾æ‰€åœ¨çš„ä½ç½®ã€‚srcä¼šå°†å…¶æŒ‡å‘çš„èµ„æºä¸‹è½½å¹¶åº”â½¤åˆ°â½‚æ¡£å†…ï¼Œå¦‚è¯·æ±‚jsè„šæœ¬ã€‚å½“æµè§ˆå™¨è§£æåˆ°è¯¥å…ƒç´ æ—¶ï¼Œä¼šæš‚åœå…¶ä»–èµ„æºçš„ä¸‹è½½å’Œå¤„ç†ï¼Œç›´åˆ°å°†è¯¥èµ„æºåŠ è½½ã€ç¼–è¯‘ã€æ‰§â¾å®Œæ¯•ï¼Œæ‰€ä»¥â¼€èˆ¬jsè„šæœ¬ä¼šæ”¾åœ¨é¡µé¢åº•éƒ¨ã€‚</li><li><strong>hrefï¼š</strong> è¡¨ç¤ºè¶…æ–‡æœ¬å¼•ç”¨ï¼Œå®ƒæŒ‡å‘ä¸€äº›ç½‘ç»œèµ„æºï¼Œå»ºç«‹å’Œå½“å‰å…ƒç´ æˆ–æœ¬æ–‡æ¡£çš„é“¾æ¥å…³ç³»ã€‚å½“æµè§ˆå™¨è¯†åˆ«åˆ°å®ƒä»–æŒ‡å‘çš„â½‚ä»¶æ—¶ï¼Œå°±ä¼šå¹¶â¾ä¸‹è½½èµ„æºï¼Œä¸ä¼šåœâ½Œå¯¹å½“å‰â½‚æ¡£çš„å¤„ç†ã€‚ å¸¸ç”¨åœ¨aã€linkç­‰æ ‡ç­¾ä¸Šã€‚</li></ul><h3 id="2-å¯¹HTMLè¯­ä¹‰åŒ–çš„ç†è§£"><a href="#2-å¯¹HTMLè¯­ä¹‰åŒ–çš„ç†è§£" class="headerlink" title="2. å¯¹HTMLè¯­ä¹‰åŒ–çš„ç†è§£"></a>2. å¯¹HTMLè¯­ä¹‰åŒ–çš„ç†è§£</h3><p><strong>è¯­ä¹‰åŒ–æ˜¯æŒ‡æ ¹æ®å†…å®¹çš„ç»“æ„åŒ–ï¼ˆå†…å®¹è¯­ä¹‰åŒ–ï¼‰ï¼Œé€‰æ‹©åˆé€‚çš„æ ‡ç­¾ï¼ˆä»£ç è¯­ä¹‰åŒ–ï¼‰</strong>ã€‚é€šä¿—æ¥è®²å°±æ˜¯ç”¨æ­£ç¡®çš„æ ‡ç­¾åšæ­£ç¡®çš„äº‹æƒ…ã€‚</p><p>è¯­ä¹‰åŒ–çš„ä¼˜ç‚¹å¦‚ä¸‹ï¼š</p><ul><li>å¯¹æœºå™¨å‹å¥½ï¼Œå¸¦æœ‰è¯­ä¹‰çš„æ–‡å­—è¡¨ç°åŠ›ä¸°å¯Œï¼Œæ›´é€‚åˆæœç´¢å¼•æ“çš„çˆ¬è™«çˆ¬å–æœ‰æ•ˆä¿¡æ¯ï¼Œæœ‰åˆ©äºSEOã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¯­ä¹‰ç±»è¿˜æ”¯æŒè¯»å±è½¯ä»¶ï¼Œæ ¹æ®æ–‡ç« å¯ä»¥è‡ªåŠ¨ç”Ÿæˆç›®å½•ï¼›</li><li>å¯¹å¼€å‘è€…å‹å¥½ï¼Œä½¿ç”¨è¯­ä¹‰ç±»æ ‡ç­¾å¢å¼ºäº†å¯è¯»æ€§ï¼Œç»“æ„æ›´åŠ æ¸…æ™°ï¼Œå¼€å‘è€…èƒ½æ¸…æ™°çš„çœ‹å‡ºç½‘é¡µçš„ç»“æ„ï¼Œä¾¿äºå›¢é˜Ÿçš„å¼€å‘ä¸ç»´æŠ¤ã€‚</li></ul><p> å¸¸è§çš„è¯­ä¹‰åŒ–æ ‡ç­¾ï¼š</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>header</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>header</span><span class="token punctuation">></span></span>  å¤´éƒ¨<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nav</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nav</span><span class="token punctuation">></span></span>  å¯¼èˆªæ <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>section</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>section</span><span class="token punctuation">></span></span>  åŒºå—ï¼ˆæœ‰è¯­ä¹‰åŒ–çš„divï¼‰<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>main</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>main</span><span class="token punctuation">></span></span>  ä¸»è¦åŒºåŸŸ<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>article</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>article</span><span class="token punctuation">></span></span>  ä¸»è¦å†…å®¹<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>aside</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>aside</span><span class="token punctuation">></span></span>  ä¾§è¾¹æ <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>footer</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>footer</span><span class="token punctuation">></span></span>  åº•éƒ¨<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-DOCTYPE-â½‚æ¡£ç±»å‹-çš„ä½œâ½¤"><a href="#3-DOCTYPE-â½‚æ¡£ç±»å‹-çš„ä½œâ½¤" class="headerlink" title="3. DOCTYPE(â½‚æ¡£ç±»å‹) çš„ä½œâ½¤"></a>3. DOCTYPE(â½‚æ¡£ç±»å‹) çš„ä½œâ½¤</h3><p>DOCTYPEæ˜¯HTML5ä¸­ä¸€ç§æ ‡å‡†é€šç”¨æ ‡è®°è¯­è¨€çš„æ–‡æ¡£ç±»å‹å£°æ˜ï¼Œå®ƒçš„ç›®çš„æ˜¯<strong>å‘Šè¯‰æµè§ˆå™¨ï¼ˆè§£æå™¨ï¼‰åº”è¯¥ä»¥ä»€ä¹ˆæ ·ï¼ˆhtmlæˆ–xhtmlï¼‰çš„æ–‡æ¡£ç±»å‹å®šä¹‰æ¥è§£ææ–‡æ¡£</strong>ï¼Œä¸åŒçš„æ¸²æŸ“æ¨¡å¼ä¼šå½±å“æµè§ˆå™¨å¯¹ CSS ä»£ç ç”šâ¾„ JavaScript è„šæœ¬çš„è§£æã€‚å®ƒå¿…é¡»å£°æ˜åœ¨HTMLâ½‚æ¡£çš„ç¬¬â¼€â¾ã€‚</p><p>æµè§ˆå™¨æ¸²æŸ“é¡µé¢çš„ä¸¤ç§æ¨¡å¼ï¼ˆå¯é€šè¿‡document.compatModeè·å–ï¼Œæ¯”å¦‚ï¼Œè¯­é›€å®˜ç½‘çš„æ–‡æ¡£ç±»å‹æ˜¯<strong>CSS1Compat</strong>ï¼‰ï¼š</p><ul><li><strong>CSS1Compatï¼šæ ‡å‡†æ¨¡å¼ï¼ˆStrick modeï¼‰</strong>ï¼Œé»˜è®¤æ¨¡å¼ï¼Œæµè§ˆå™¨ä½¿ç”¨W3Cçš„æ ‡å‡†è§£ææ¸²æŸ“é¡µé¢ã€‚åœ¨æ ‡å‡†æ¨¡å¼ä¸­ï¼Œæµè§ˆå™¨ä»¥å…¶æ”¯æŒçš„æœ€é«˜æ ‡å‡†å‘ˆç°é¡µé¢ã€‚</li><li><strong>BackCompatï¼šæ€ªå¼‚æ¨¡å¼(æ··æ‚æ¨¡å¼)(Quick mode)</strong>ï¼Œæµè§ˆå™¨ä½¿ç”¨è‡ªå·±çš„æ€ªå¼‚æ¨¡å¼è§£ææ¸²æŸ“é¡µé¢ã€‚åœ¨æ€ªå¼‚æ¨¡å¼ä¸­ï¼Œé¡µé¢ä»¥ä¸€ç§æ¯”è¾ƒå®½æ¾çš„å‘åå…¼å®¹çš„æ–¹å¼æ˜¾ç¤ºã€‚</li></ul><h3 id="4-scriptæ ‡ç­¾ä¸­deferå’Œasyncçš„åŒºåˆ«"><a href="#4-scriptæ ‡ç­¾ä¸­deferå’Œasyncçš„åŒºåˆ«" class="headerlink" title="4. scriptæ ‡ç­¾ä¸­deferå’Œasyncçš„åŒºåˆ«"></a>4. scriptæ ‡ç­¾ä¸­deferå’Œasyncçš„åŒºåˆ«</h3><p>å¦‚æœæ²¡æœ‰deferæˆ–asyncå±æ€§ï¼Œæµè§ˆå™¨ä¼šç«‹å³åŠ è½½å¹¶æ‰§è¡Œç›¸åº”çš„è„šæœ¬ã€‚å®ƒä¸ä¼šç­‰å¾…åç»­åŠ è½½çš„æ–‡æ¡£å…ƒç´ ï¼Œè¯»å–åˆ°å°±ä¼šå¼€å§‹åŠ è½½å’Œæ‰§è¡Œï¼Œè¿™æ ·å°±é˜»å¡äº†åç»­æ–‡æ¡£çš„åŠ è½½ã€‚</p><p>ä¸‹å›¾å¯ä»¥ç›´è§‚çš„çœ‹å‡ºä¸‰è€…ä¹‹é—´çš„åŒºåˆ«:<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="/medias/HTML/2.png" alt="image.png"><br>å…¶ä¸­è“è‰²ä»£è¡¨jsè„šæœ¬ç½‘ç»œåŠ è½½æ—¶é—´ï¼Œçº¢è‰²ä»£è¡¨jsè„šæœ¬æ‰§è¡Œæ—¶é—´ï¼Œç»¿è‰²ä»£è¡¨htmlè§£æã€‚</p><p><strong>defer å’Œ asyncå±æ€§éƒ½æ˜¯å»å¼‚æ­¥åŠ è½½å¤–éƒ¨çš„JSè„šæœ¬æ–‡ä»¶ï¼Œå®ƒä»¬éƒ½ä¸ä¼šé˜»å¡é¡µé¢çš„è§£æ</strong>ï¼Œå…¶åŒºåˆ«å¦‚ä¸‹ï¼š</p><ul><li><strong>æ‰§è¡Œé¡ºåºï¼š</strong> å¤šä¸ªå¸¦asyncå±æ€§çš„æ ‡ç­¾ï¼Œä¸èƒ½ä¿è¯åŠ è½½çš„é¡ºåºï¼›å¤šä¸ªå¸¦deferå±æ€§çš„æ ‡ç­¾ï¼ŒæŒ‰ç…§åŠ è½½é¡ºåºæ‰§è¡Œï¼›</li><li><strong>è„šæœ¬æ˜¯å¦å¹¶è¡Œæ‰§è¡Œï¼š</strong>asyncå±æ€§ï¼Œè¡¨ç¤º<strong>åç»­æ–‡æ¡£çš„åŠ è½½å’Œæ‰§è¡Œä¸jsè„šæœ¬çš„åŠ è½½å’Œæ‰§è¡Œæ˜¯å¹¶è¡Œè¿›è¡Œçš„</strong>ï¼Œå³å¼‚æ­¥æ‰§è¡Œï¼›deferå±æ€§ï¼ŒåŠ è½½åç»­æ–‡æ¡£çš„è¿‡ç¨‹å’Œjsè„šæœ¬çš„åŠ è½½(æ­¤æ—¶ä»…åŠ è½½ä¸æ‰§è¡Œ)æ˜¯å¹¶è¡Œè¿›è¡Œçš„(å¼‚æ­¥)ï¼Œjsè„šæœ¬éœ€è¦ç­‰åˆ°æ–‡æ¡£æ‰€æœ‰å…ƒç´ è§£æå®Œæˆä¹‹åæ‰æ‰§è¡Œï¼ŒDOMContentLoadedäº‹ä»¶è§¦å‘æ‰§è¡Œä¹‹å‰ã€‚</li></ul><h3 id="5-å¸¸â½¤çš„metaæ ‡ç­¾æœ‰å“ªäº›"><a href="#5-å¸¸â½¤çš„metaæ ‡ç­¾æœ‰å“ªäº›" class="headerlink" title="5. å¸¸â½¤çš„metaæ ‡ç­¾æœ‰å“ªäº›"></a>5. å¸¸â½¤çš„metaæ ‡ç­¾æœ‰å“ªäº›</h3><p><code>meta</code> æ ‡ç­¾ç”± <code>name</code> å’Œ <code>content</code> å±æ€§å®šä¹‰ï¼Œ<strong>ç”¨æ¥æè¿°ç½‘é¡µæ–‡æ¡£çš„å±æ€§</strong>ï¼Œæ¯”å¦‚ç½‘é¡µçš„ä½œè€…ï¼Œç½‘é¡µæè¿°ï¼Œå…³é”®è¯ç­‰ï¼Œé™¤äº†HTTPæ ‡å‡†å›ºå®šäº†ä¸€äº›<code>name</code>ä½œä¸ºå¤§å®¶ä½¿ç”¨çš„å…±è¯†ï¼Œå¼€å‘è€…è¿˜å¯ä»¥è‡ªå®šä¹‰nameã€‚</p><p>å¸¸ç”¨çš„metaæ ‡ç­¾ï¼š<br>ï¼ˆ1ï¼‰<code>charset</code>ï¼Œç”¨æ¥æè¿°HTMLæ–‡æ¡£çš„ç¼–ç ç±»å‹ï¼š</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ï¼ˆ2ï¼‰ <code>keywords</code>ï¼Œé¡µé¢å…³é”®è¯ï¼š</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>keywords<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>å…³é”®è¯<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ï¼ˆ3ï¼‰<code>description</code>ï¼Œé¡µé¢æè¿°ï¼š</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>description<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>é¡µé¢æè¿°å†…å®¹<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ï¼ˆ4ï¼‰<code>refresh</code>ï¼Œé¡µé¢é‡å®šå‘å’Œåˆ·æ–°ï¼š</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>refresh<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0;url<span class="token punctuation">=</span><span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ï¼ˆ5ï¼‰<code>viewport</code>ï¼Œé€‚é…ç§»åŠ¨ç«¯ï¼Œå¯ä»¥æ§åˆ¶è§†å£çš„å¤§å°å’Œæ¯”ä¾‹ï¼š</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width<span class="token punctuation">=</span>device-width, initial-scale<span class="token punctuation">=</span>1, maximum-scale<span class="token punctuation">=</span>1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å…¶ä¸­ï¼Œ<code>content</code> å‚æ•°æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p><ul><li><code>width viewport</code> ï¼šå®½åº¦(æ•°å€¼/device-width)</li><li><code>height viewport</code> ï¼šé«˜åº¦(æ•°å€¼/device-height)</li><li><code>initial-scale</code> ï¼šåˆå§‹ç¼©æ”¾æ¯”ä¾‹</li><li><code>maximum-scale</code> ï¼šæœ€å¤§ç¼©æ”¾æ¯”ä¾‹</li><li><code>minimum-scale</code> ï¼šæœ€å°ç¼©æ”¾æ¯”ä¾‹</li><li><code>user-scalable</code> ï¼šæ˜¯å¦å…è®¸ç”¨æˆ·ç¼©æ”¾(yes/noï¼‰</li></ul><p>ï¼ˆ6ï¼‰æœç´¢å¼•æ“ç´¢å¼•æ–¹å¼ï¼š</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>robots<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>index,follow<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å…¶ä¸­ï¼Œ<code>content</code> å‚æ•°æœ‰ä»¥ä¸‹å‡ ç§ï¼š</p><ul><li><code>all</code>ï¼šæ–‡ä»¶å°†è¢«æ£€ç´¢ï¼Œä¸”é¡µé¢ä¸Šçš„é“¾æ¥å¯ä»¥è¢«æŸ¥è¯¢ï¼›</li><li><code>none</code>ï¼šæ–‡ä»¶å°†ä¸è¢«æ£€ç´¢ï¼Œä¸”é¡µé¢ä¸Šçš„é“¾æ¥ä¸å¯ä»¥è¢«æŸ¥è¯¢ï¼›</li><li><code>index</code>ï¼šæ–‡ä»¶å°†è¢«æ£€ç´¢ï¼›</li><li><code>follow</code>ï¼šé¡µé¢ä¸Šçš„é“¾æ¥å¯ä»¥è¢«æŸ¥è¯¢ï¼›</li><li><code>noindex</code>ï¼šæ–‡ä»¶å°†ä¸è¢«æ£€ç´¢ï¼›</li><li><code>nofollow</code>ï¼šé¡µé¢ä¸Šçš„é“¾æ¥ä¸å¯ä»¥è¢«æŸ¥è¯¢ã€‚</li></ul><h3 id="6-HTML5æœ‰å“ªäº›æ›´æ–°"><a href="#6-HTML5æœ‰å“ªäº›æ›´æ–°" class="headerlink" title="6. HTML5æœ‰å“ªäº›æ›´æ–°"></a>6. HTML5æœ‰å“ªäº›æ›´æ–°</h3><h4 id="1-è¯­ä¹‰åŒ–æ ‡ç­¾"><a href="#1-è¯­ä¹‰åŒ–æ ‡ç­¾" class="headerlink" title="1. è¯­ä¹‰åŒ–æ ‡ç­¾"></a>1. è¯­ä¹‰åŒ–æ ‡ç­¾</h4><ul><li>headerï¼šå®šä¹‰æ–‡æ¡£çš„é¡µçœ‰ï¼ˆå¤´éƒ¨ï¼‰ï¼›</li><li>navï¼šå®šä¹‰å¯¼èˆªé“¾æ¥çš„éƒ¨åˆ†ï¼›</li><li>footerï¼šå®šä¹‰æ–‡æ¡£æˆ–èŠ‚çš„é¡µè„šï¼ˆåº•éƒ¨ï¼‰ï¼›</li><li>articleï¼šå®šä¹‰æ–‡ç« å†…å®¹ï¼›</li><li>sectionï¼šå®šä¹‰æ–‡æ¡£ä¸­çš„èŠ‚ï¼ˆsectionã€åŒºæ®µï¼‰ï¼›</li><li>asideï¼šå®šä¹‰å…¶æ‰€å¤„å†…å®¹ä¹‹å¤–çš„å†…å®¹ï¼ˆä¾§è¾¹ï¼‰ï¼›</li></ul><h4 id="2-åª’ä½“æ ‡ç­¾"><a href="#2-åª’ä½“æ ‡ç­¾" class="headerlink" title="2. åª’ä½“æ ‡ç­¾"></a>2. åª’ä½“æ ‡ç­¾</h4><p>ï¼ˆ1ï¼‰ audioï¼šéŸ³é¢‘</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>audio</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span><span class="token punctuation">'</span></span> <span class="token attr-name">controls</span> <span class="token attr-name">autoplay</span> <span class="token attr-name">loop</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>true<span class="token punctuation">'</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>audio</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å±æ€§ï¼š</p><ul><li>controls æ§åˆ¶é¢æ¿</li><li>autoplay è‡ªåŠ¨æ’­æ”¾</li><li>loop=â€˜trueâ€™ å¾ªç¯æ’­æ”¾</li></ul><p>ï¼ˆ2ï¼‰videoè§†é¢‘</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>video</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span><span class="token punctuation">'</span></span> <span class="token attr-name">poster</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>imgs/aa.jpg<span class="token punctuation">'</span></span> <span class="token attr-name">controls</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>video</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å±æ€§ï¼š</p><ul><li>posterï¼šæŒ‡å®šè§†é¢‘è¿˜æ²¡æœ‰å®Œå…¨ä¸‹è½½å®Œæ¯•ï¼Œæˆ–è€…ç”¨æˆ·è¿˜æ²¡æœ‰ç‚¹å‡»æ’­æ”¾å‰æ˜¾ç¤ºçš„å°é¢ã€‚é»˜è®¤æ˜¾ç¤ºå½“å‰è§†é¢‘æ–‡ä»¶çš„ç¬¬ä¸€é’ˆç”»é¢ï¼Œå½“ç„¶é€šè¿‡posterä¹Ÿå¯ä»¥è‡ªå·±æŒ‡å®šã€‚</li><li>controls æ§åˆ¶é¢æ¿</li><li>width</li><li>height</li></ul><p>ï¼ˆ3ï¼‰sourceæ ‡ç­¾<br>å› ä¸ºæµè§ˆå™¨å¯¹è§†é¢‘æ ¼å¼æ”¯æŒç¨‹åº¦ä¸ä¸€æ ·ï¼Œä¸ºäº†èƒ½å¤Ÿå…¼å®¹ä¸åŒçš„æµè§ˆå™¨ï¼Œå¯ä»¥é€šè¿‡sourceæ¥æŒ‡å®šè§†é¢‘æºã€‚</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>video</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>aa.flv<span class="token punctuation">'</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>video/flv<span class="token punctuation">'</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>source</span><span class="token punctuation">></span></span>     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>aa.mp4<span class="token punctuation">'</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>video/mp4<span class="token punctuation">'</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>source</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>video</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="3-è¡¨å•"><a href="#3-è¡¨å•" class="headerlink" title="3. è¡¨å•"></a>3. è¡¨å•</h4><p><strong>è¡¨å•ç±»å‹ï¼š</strong></p><ul><li>email ï¼šèƒ½å¤ŸéªŒè¯å½“å‰è¾“å…¥çš„é‚®ç®±åœ°å€æ˜¯å¦åˆæ³•</li><li>url ï¼š éªŒè¯URL</li><li>number ï¼š åªèƒ½è¾“å…¥æ•°å­—ï¼Œå…¶ä»–è¾“å…¥ä¸äº†ï¼Œè€Œä¸”è‡ªå¸¦ä¸Šä¸‹å¢å¤§å‡å°ç®­å¤´ï¼Œmaxå±æ€§å¯ä»¥è®¾ç½®ä¸ºæœ€å¤§å€¼ï¼Œminå¯ä»¥è®¾ç½®ä¸ºæœ€å°å€¼ï¼Œvalueä¸ºé»˜è®¤å€¼ã€‚</li><li>search ï¼š è¾“å…¥æ¡†åé¢ä¼šç»™æä¾›ä¸€ä¸ªå°å‰ï¼Œå¯ä»¥åˆ é™¤è¾“å…¥çš„å†…å®¹ï¼Œæ›´åŠ äººæ€§åŒ–ã€‚</li><li>range ï¼š å¯ä»¥æä¾›ç»™ä¸€ä¸ªèŒƒå›´ï¼Œå…¶ä¸­å¯ä»¥è®¾ç½®maxå’Œminä»¥åŠvalueï¼Œå…¶ä¸­valueå±æ€§å¯ä»¥è®¾ç½®ä¸ºé»˜è®¤å€¼</li><li>color ï¼š æä¾›äº†ä¸€ä¸ªé¢œè‰²æ‹¾å–å™¨</li><li>time ï¼š æ—¶åˆ†ç§’</li><li>data ï¼š æ—¥æœŸé€‰æ‹©å¹´æœˆæ—¥</li><li>datatime ï¼š æ—¶é—´å’Œæ—¥æœŸ(ç›®å‰åªæœ‰Safariæ”¯æŒ)</li><li>datatime-local ï¼šæ—¥æœŸæ—¶é—´æ§ä»¶</li><li>week ï¼šå‘¨æ§ä»¶</li><li>monthï¼šæœˆæ§ä»¶</li></ul><p><strong>è¡¨å•å±æ€§ï¼š</strong></p><ul><li>placeholder ï¼šæç¤ºä¿¡æ¯</li><li>autofocus ï¼šè‡ªåŠ¨è·å–ç„¦ç‚¹</li><li>autocomplete=â€œonâ€ æˆ–è€… autocomplete=â€œoffâ€ ä½¿ç”¨è¿™ä¸ªå±æ€§éœ€è¦æœ‰ä¸¤ä¸ªå‰æï¼š<ul><li>è¡¨å•å¿…é¡»æäº¤è¿‡</li><li>å¿…é¡»æœ‰nameå±æ€§ã€‚</li></ul></li><li>requiredï¼šè¦æ±‚è¾“å…¥æ¡†ä¸èƒ½ä¸ºç©ºï¼Œå¿…é¡»æœ‰å€¼æ‰èƒ½å¤Ÿæäº¤ã€‚</li><li>pattern=â€ â€œ é‡Œé¢å†™å…¥æƒ³è¦çš„æ­£åˆ™æ¨¡å¼ï¼Œä¾‹å¦‚æ‰‹æœºå·patte=â€^(+86)?\d{10}$â€</li><li>multipleï¼šå¯ä»¥é€‰æ‹©å¤šä¸ªæ–‡ä»¶æˆ–è€…å¤šä¸ªé‚®ç®±</li><li>form=â€ formè¡¨å•çš„IDâ€</li></ul><p><strong>è¡¨å•äº‹ä»¶ï¼š</strong></p><ul><li>oninput æ¯å½“inputé‡Œçš„è¾“å…¥æ¡†å†…å®¹å‘ç”Ÿå˜åŒ–éƒ½ä¼šè§¦å‘æ­¤äº‹ä»¶ã€‚</li><li>oninvalid å½“éªŒè¯ä¸é€šè¿‡æ—¶è§¦å‘æ­¤äº‹ä»¶ã€‚</li></ul><h4 id="4-è¿›åº¦æ¡ã€åº¦é‡å™¨"><a href="#4-è¿›åº¦æ¡ã€åº¦é‡å™¨" class="headerlink" title="4. è¿›åº¦æ¡ã€åº¦é‡å™¨"></a>4. è¿›åº¦æ¡ã€åº¦é‡å™¨</h4><ul><li>progressæ ‡ç­¾ï¼šç”¨æ¥è¡¨ç¤ºä»»åŠ¡çš„è¿›åº¦ï¼ˆIEã€Safariä¸æ”¯æŒï¼‰ï¼Œmaxç”¨æ¥è¡¨ç¤ºä»»åŠ¡çš„è¿›åº¦ï¼Œvalueè¡¨ç¤ºå·²å®Œæˆå¤šå°‘</li><li>meterå±æ€§ï¼šç”¨æ¥æ˜¾ç¤ºå‰©ä½™å®¹é‡æˆ–å‰©ä½™åº“å­˜ï¼ˆIEã€Safariä¸æ”¯æŒï¼‰<ul><li>high/lowï¼šè§„å®šè¢«è§†ä½œé«˜/ä½çš„èŒƒå›´</li><li>max/minï¼šè§„å®šæœ€å¤§/å°å€¼</li><li>valueï¼šè§„å®šå½“å‰åº¦é‡å€¼</li></ul></li></ul><p>è®¾ç½®è§„åˆ™ï¼šmin &lt; low &lt; high &lt; max</p><h4 id="5-DOMæŸ¥è¯¢æ“ä½œ"><a href="#5-DOMæŸ¥è¯¢æ“ä½œ" class="headerlink" title="5.DOMæŸ¥è¯¢æ“ä½œ"></a>5.DOMæŸ¥è¯¢æ“ä½œ</h4><ul><li>document.querySelector()</li><li>document.querySelectorAll()</li></ul><p>å®ƒä»¬é€‰æ‹©çš„å¯¹è±¡å¯ä»¥æ˜¯æ ‡ç­¾ï¼Œå¯ä»¥æ˜¯ç±»(éœ€è¦åŠ ç‚¹)ï¼Œå¯ä»¥æ˜¯ID(éœ€è¦åŠ #)</p><h4 id="6-Webå­˜å‚¨"><a href="#6-Webå­˜å‚¨" class="headerlink" title="6. Webå­˜å‚¨"></a>6. Webå­˜å‚¨</h4><p>HTML5 æä¾›äº†ä¸¤ç§åœ¨å®¢æˆ·ç«¯å­˜å‚¨æ•°æ®çš„æ–°æ–¹æ³•ï¼š</p><ul><li>localStorage - æ²¡æœ‰æ—¶é—´é™åˆ¶çš„æ•°æ®å­˜å‚¨</li><li>sessionStorage - é’ˆå¯¹ä¸€ä¸ª session çš„æ•°æ®å­˜å‚¨</li></ul><h4 id="7-å…¶ä»–"><a href="#7-å…¶ä»–" class="headerlink" title="7. å…¶ä»–"></a>7. å…¶ä»–</h4><ul><li>æ‹–æ”¾ï¼šæ‹–æ”¾æ˜¯ä¸€ç§å¸¸è§çš„ç‰¹æ€§ï¼Œå³æŠ“å–å¯¹è±¡ä»¥åæ‹–åˆ°å¦ä¸€ä¸ªä½ç½®ã€‚è®¾ç½®å…ƒç´ å¯æ‹–æ”¾ï¼š</li></ul><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">draggable</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>ç”»å¸ƒï¼ˆcanvas ï¼‰ï¼š canvas å…ƒç´ ä½¿ç”¨ JavaScript åœ¨ç½‘é¡µä¸Šç»˜åˆ¶å›¾åƒã€‚ç”»å¸ƒæ˜¯ä¸€ä¸ªçŸ©å½¢åŒºåŸŸï¼Œå¯ä»¥æ§åˆ¶å…¶æ¯ä¸€åƒç´ ã€‚canvas æ‹¥æœ‰å¤šç§ç»˜åˆ¶è·¯å¾„ã€çŸ©å½¢ã€åœ†å½¢ã€å­—ç¬¦ä»¥åŠæ·»åŠ å›¾åƒçš„æ–¹æ³•ã€‚</li></ul><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>myCanvas<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>200<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>100<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>SVGï¼šSVG æŒ‡å¯ä¼¸ç¼©çŸ¢é‡å›¾å½¢ï¼Œç”¨äºå®šä¹‰ç”¨äºç½‘ç»œçš„åŸºäºçŸ¢é‡çš„å›¾å½¢ï¼Œä½¿ç”¨ XML æ ¼å¼å®šä¹‰å›¾å½¢ï¼Œå›¾åƒåœ¨æ”¾å¤§æˆ–æ”¹å˜å°ºå¯¸çš„æƒ…å†µä¸‹å…¶å›¾å½¢è´¨é‡ä¸ä¼šæœ‰æŸå¤±ï¼Œå®ƒæ˜¯ä¸‡ç»´ç½‘è”ç›Ÿçš„æ ‡å‡†</li><li>åœ°ç†å®šä½ï¼šGeolocationï¼ˆåœ°ç†å®šä½ï¼‰ç”¨äºå®šä½ç”¨æˆ·çš„ä½ç½®ã€‚â€˜</li></ul><p><strong>æ€»ç»“ï¼š</strong><br>ï¼ˆ1ï¼‰æ–°å¢è¯­ä¹‰åŒ–æ ‡ç­¾ï¼šnavã€headerã€footerã€asideã€sectionã€article<br>ï¼ˆ2ï¼‰éŸ³é¢‘ã€è§†é¢‘æ ‡ç­¾ï¼šaudioã€video<br>ï¼ˆ3ï¼‰æ•°æ®å­˜å‚¨ï¼šlocalStorageã€sessionStorage<br>ï¼ˆ4ï¼‰canvasï¼ˆç”»å¸ƒï¼‰ã€Geolocationï¼ˆåœ°ç†å®šä½ï¼‰ã€websocketï¼ˆé€šä¿¡åè®®ï¼‰<br>ï¼ˆ5ï¼‰inputæ ‡ç­¾æ–°å¢å±æ€§ï¼šplaceholderã€autocompleteã€autofocusã€required<br>ï¼ˆ6ï¼‰history APIï¼šgoã€forwardã€backã€pushstate</p><p><strong>ç§»é™¤çš„å…ƒç´ æœ‰ï¼š</strong></p><ul><li>çº¯è¡¨ç°çš„å…ƒç´ ï¼šbasefontï¼Œbigï¼Œcenterï¼Œfont, sï¼Œstrikeï¼Œttï¼Œu;</li><li>å¯¹å¯ç”¨æ€§äº§ç”Ÿè´Ÿé¢å½±å“çš„å…ƒç´ ï¼šframeï¼Œframesetï¼Œnoframesï¼›</li></ul><h3 id="7-imgçš„srcsetå±æ€§çš„ä½œâ½¤ï¼Ÿ"><a href="#7-imgçš„srcsetå±æ€§çš„ä½œâ½¤ï¼Ÿ" class="headerlink" title="7. imgçš„srcsetå±æ€§çš„ä½œâ½¤ï¼Ÿ"></a>7. imgçš„srcsetå±æ€§çš„ä½œâ½¤ï¼Ÿ</h3><p>å“åº”å¼é¡µé¢ä¸­ç»å¸¸ç”¨åˆ°æ ¹æ®å±å¹•å¯†åº¦è®¾ç½®ä¸åŒçš„å›¾ç‰‡ã€‚è¿™æ—¶å°±ç”¨åˆ°äº† img æ ‡ç­¾çš„srcsetå±æ€§ã€‚srcsetå±æ€§ç”¨äºè®¾ç½®ä¸åŒå±å¹•å¯†åº¦ä¸‹ï¼Œimg ä¼šè‡ªåŠ¨åŠ è½½ä¸åŒçš„å›¾ç‰‡ã€‚ç”¨æ³•å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>image-128.png<span class="token punctuation">"</span></span> <span class="token attr-name">srcset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>image-256.png 2x<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä½¿ç”¨ä¸Šé¢çš„ä»£ç ï¼Œå°±èƒ½å®ç°åœ¨å±å¹•å¯†åº¦ä¸º1xçš„æƒ…å†µä¸‹åŠ è½½image-128.png, å±å¹•å¯†åº¦ä¸º2xæ—¶åŠ è½½image-256.pngã€‚</p><p>æŒ‰ç…§ä¸Šé¢çš„å®ç°ï¼Œä¸åŒçš„å±å¹•å¯†åº¦éƒ½è¦è®¾ç½®å›¾ç‰‡åœ°å€ï¼Œç›®å‰çš„å±å¹•å¯†åº¦æœ‰1x,2x,3x,4xå››ç§ï¼Œå¦‚æœæ¯ä¸€ä¸ªå›¾ç‰‡éƒ½è®¾ç½®4å¼ å›¾ç‰‡ï¼ŒåŠ è½½å°±ä¼šå¾ˆæ…¢ã€‚æ‰€ä»¥å°±æœ‰äº†æ–°çš„srcsetæ ‡å‡†ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>image-128.png<span class="token punctuation">"</span></span>     <span class="token attr-name">srcset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>image-128.png 128w, image-256.png 256w, image-512.png 512w<span class="token punctuation">"</span></span>     <span class="token attr-name">sizes</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>(max-width: 360px) 340px, 128px<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å…¶ä¸­srcsetæŒ‡å®šå›¾ç‰‡çš„åœ°å€å’Œå¯¹åº”çš„å›¾ç‰‡è´¨é‡ã€‚sizesç”¨æ¥è®¾ç½®å›¾ç‰‡çš„å°ºå¯¸é›¶ç•Œç‚¹ã€‚å¯¹äº srcset ä¸­çš„ w å•ä½ï¼Œå¯ä»¥ç†è§£æˆå›¾ç‰‡è´¨é‡ã€‚å¦‚æœå¯è§†åŒºåŸŸå°äºè¿™ä¸ªè´¨é‡çš„å€¼ï¼Œå°±å¯ä»¥ä½¿ç”¨ã€‚æµè§ˆå™¨ä¼šè‡ªåŠ¨é€‰æ‹©ä¸€ä¸ªæœ€å°çš„å¯ç”¨å›¾ç‰‡ã€‚</p><p>sizesè¯­æ³•å¦‚ä¸‹ï¼š</p><pre class="line-numbers language-html"><code class="language-html">sizes="[media query] [length], [media query] [length] ... "<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>sizeså°±æ˜¯æŒ‡é»˜è®¤æ˜¾ç¤º128px, å¦‚æœè§†åŒºå®½åº¦å¤§äº360px, åˆ™æ˜¾ç¤º340pxã€‚</p><h3 id="8-è¡Œå†…å…ƒç´ æœ‰å“ªäº›ï¼Ÿå—çº§å…ƒç´ æœ‰å“ªäº›ï¼Ÿ-ç©º-void-å…ƒç´ æœ‰é‚£äº›ï¼Ÿ"><a href="#8-è¡Œå†…å…ƒç´ æœ‰å“ªäº›ï¼Ÿå—çº§å…ƒç´ æœ‰å“ªäº›ï¼Ÿ-ç©º-void-å…ƒç´ æœ‰é‚£äº›ï¼Ÿ" class="headerlink" title="8.  è¡Œå†…å…ƒç´ æœ‰å“ªäº›ï¼Ÿå—çº§å…ƒç´ æœ‰å“ªäº›ï¼Ÿ ç©º(void)å…ƒç´ æœ‰é‚£äº›ï¼Ÿ"></a>8.  è¡Œå†…å…ƒç´ æœ‰å“ªäº›ï¼Ÿå—çº§å…ƒç´ æœ‰å“ªäº›ï¼Ÿ ç©º(void)å…ƒç´ æœ‰é‚£äº›ï¼Ÿ</h3><ul><li>è¡Œå†…å…ƒç´ æœ‰ï¼š<code>a b span img input select strong</code>ï¼›</li><li>å—çº§å…ƒç´ æœ‰ï¼š<code>div ul ol li dl dt dd h1 h2 h3 h4 h5 h6 p</code>ï¼›</li></ul><p>ç©ºå…ƒç´ ï¼Œå³æ²¡æœ‰å†…å®¹çš„HTMLå…ƒç´ ã€‚ç©ºå…ƒç´ æ˜¯åœ¨å¼€å§‹æ ‡ç­¾ä¸­å…³é—­çš„ï¼Œä¹Ÿå°±æ˜¯ç©ºå…ƒç´ æ²¡æœ‰é—­åˆæ ‡ç­¾ï¼š</p><ul><li>å¸¸è§çš„æœ‰ï¼š<code>&lt;br&gt;</code>ã€<code>&lt;hr&gt;</code>ã€<code>&lt;img&gt;</code>ã€<code>&lt;input&gt;</code>ã€<code>&lt;link&gt;</code>ã€<code>&lt;meta&gt;</code>ï¼›</li><li>é²œè§çš„æœ‰ï¼š<code>&lt;area&gt;</code>ã€<code>&lt;base&gt;</code>ã€<code>&lt;col&gt;</code>ã€<code>&lt;colgroup&gt;</code>ã€<code>&lt;command&gt;</code>ã€<code>&lt;embed&gt;</code>ã€<code>&lt;keygen&gt;</code>ã€<code>&lt;param&gt;</code>ã€<code>&lt;source&gt;</code>ã€<code>&lt;track&gt;</code>ã€<code>&lt;wbr&gt;</code>ã€‚</li></ul><h3 id="9-è¯´ä¸€ä¸‹-web-worker"><a href="#9-è¯´ä¸€ä¸‹-web-worker" class="headerlink" title="9. è¯´ä¸€ä¸‹ web worker"></a>9. è¯´ä¸€ä¸‹ web worker</h3><p>åœ¨ HTML é¡µé¢ä¸­ï¼Œå¦‚æœåœ¨æ‰§è¡Œè„šæœ¬æ—¶ï¼Œé¡µé¢çš„çŠ¶æ€æ˜¯ä¸å¯ç›¸åº”çš„ï¼Œç›´åˆ°è„šæœ¬æ‰§è¡Œå®Œæˆåï¼Œé¡µé¢æ‰å˜æˆå¯ç›¸åº”ã€‚web worker æ˜¯è¿è¡Œåœ¨åå°çš„ jsï¼Œç‹¬ç«‹äºå…¶ä»–è„šæœ¬ï¼Œä¸ä¼šå½±å“é¡µé¢çš„æ€§èƒ½ã€‚ å¹¶ä¸”é€šè¿‡ postMessage å°†ç»“æœå›ä¼ åˆ°ä¸»çº¿ç¨‹ã€‚è¿™æ ·åœ¨è¿›è¡Œå¤æ‚æ“ä½œçš„æ—¶å€™ï¼Œå°±ä¸ä¼šé˜»å¡ä¸»çº¿ç¨‹äº†ã€‚ </p><p>å¦‚ä½•åˆ›å»º web workerï¼š </p><ol><li>æ£€æµ‹æµè§ˆå™¨å¯¹äº web worker çš„æ”¯æŒæ€§ </li><li>åˆ›å»º web worker æ–‡ä»¶ï¼ˆjsï¼Œå›ä¼ å‡½æ•°ç­‰ï¼‰ </li><li>åˆ›å»º web worker å¯¹è±¡</li></ol><h3 id="10-HTML5çš„ç¦»çº¿å‚¨å­˜æ€ä¹ˆä½¿ç”¨ï¼Œå®ƒçš„å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆ"><a href="#10-HTML5çš„ç¦»çº¿å‚¨å­˜æ€ä¹ˆä½¿ç”¨ï¼Œå®ƒçš„å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆ" class="headerlink" title="10. HTML5çš„ç¦»çº¿å‚¨å­˜æ€ä¹ˆä½¿ç”¨ï¼Œå®ƒçš„å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆ"></a>10. HTML5çš„ç¦»çº¿å‚¨å­˜æ€ä¹ˆä½¿ç”¨ï¼Œå®ƒçš„å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆ</h3><p>ç¦»çº¿å­˜å‚¨æŒ‡çš„æ˜¯ï¼šåœ¨ç”¨æˆ·æ²¡æœ‰ä¸å› ç‰¹ç½‘è¿æ¥æ—¶ï¼Œå¯ä»¥æ­£å¸¸è®¿é—®ç«™ç‚¹æˆ–åº”ç”¨ï¼Œåœ¨ç”¨æˆ·ä¸å› ç‰¹ç½‘è¿æ¥æ—¶ï¼Œæ›´æ–°ç”¨æˆ·æœºå™¨ä¸Šçš„ç¼“å­˜æ–‡ä»¶ã€‚</p><p><strong>åŸç†ï¼š</strong>HTML5çš„ç¦»çº¿å­˜å‚¨æ˜¯åŸºäºä¸€ä¸ªæ–°å»ºçš„ <code>.appcache</code> æ–‡ä»¶çš„ç¼“å­˜æœºåˆ¶(ä¸æ˜¯å­˜å‚¨æŠ€æœ¯)ï¼Œé€šè¿‡è¿™ä¸ªæ–‡ä»¶ä¸Šçš„è§£ææ¸…å•ç¦»çº¿å­˜å‚¨èµ„æºï¼Œè¿™äº›èµ„æºå°±ä¼šåƒcookieä¸€æ ·è¢«å­˜å‚¨äº†ä¸‹æ¥ã€‚ä¹‹åå½“ç½‘ç»œåœ¨å¤„äºç¦»çº¿çŠ¶æ€ä¸‹æ—¶ï¼Œæµè§ˆå™¨ä¼šé€šè¿‡è¢«ç¦»çº¿å­˜å‚¨çš„æ•°æ®è¿›è¡Œé¡µé¢å±•ç¤º</p><p><strong>ä½¿ç”¨æ–¹æ³•ï¼š</strong><br>ï¼ˆ1ï¼‰åˆ›å»ºä¸€ä¸ªå’Œ html åŒåçš„ manifest æ–‡ä»¶ï¼Œç„¶ååœ¨é¡µé¢å¤´éƒ¨åŠ å…¥ manifest å±æ€§ï¼š</p><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span> <span class="token attr-name">manifest</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>index.manifest<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ï¼ˆ2ï¼‰åœ¨ <code>cache.manifest</code> æ–‡ä»¶ä¸­ç¼–å†™éœ€è¦ç¦»çº¿å­˜å‚¨çš„èµ„æºï¼š</p><pre class="line-numbers language-html"><code class="language-html">CACHE MANIFEST    #v0.11    CACHE:    js/app.js    css/style.css    NETWORK:    resourse/logo.png    FALLBACK:    / /offline.html<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><strong>CACHE</strong>: è¡¨ç¤ºéœ€è¦ç¦»çº¿å­˜å‚¨çš„èµ„æºåˆ—è¡¨ï¼Œç”±äºåŒ…å« manifest æ–‡ä»¶çš„é¡µé¢å°†è¢«è‡ªåŠ¨ç¦»çº¿å­˜å‚¨ï¼Œæ‰€ä»¥ä¸éœ€è¦æŠŠé¡µé¢è‡ªèº«ä¹Ÿåˆ—å‡ºæ¥ã€‚</li><li><strong>NETWORK</strong>: è¡¨ç¤ºåœ¨å®ƒä¸‹é¢åˆ—å‡ºæ¥çš„èµ„æºåªæœ‰åœ¨åœ¨çº¿çš„æƒ…å†µä¸‹æ‰èƒ½è®¿é—®ï¼Œä»–ä»¬ä¸ä¼šè¢«ç¦»çº¿å­˜å‚¨ï¼Œæ‰€ä»¥åœ¨ç¦»çº¿æƒ…å†µä¸‹æ— æ³•ä½¿ç”¨è¿™äº›èµ„æºã€‚ä¸è¿‡ï¼Œå¦‚æœåœ¨ CACHE å’Œ NETWORK ä¸­æœ‰ä¸€ä¸ªç›¸åŒçš„èµ„æºï¼Œé‚£ä¹ˆè¿™ä¸ªèµ„æºè¿˜æ˜¯ä¼šè¢«ç¦»çº¿å­˜å‚¨ï¼Œä¹Ÿå°±æ˜¯è¯´ CACHE çš„ä¼˜å…ˆçº§æ›´é«˜ã€‚</li><li><strong>FALLBACK</strong>: è¡¨ç¤ºå¦‚æœè®¿é—®ç¬¬ä¸€ä¸ªèµ„æºå¤±è´¥ï¼Œé‚£ä¹ˆå°±ä½¿ç”¨ç¬¬äºŒä¸ªèµ„æºæ¥æ›¿æ¢ä»–ï¼Œæ¯”å¦‚ä¸Šé¢è¿™ä¸ªæ–‡ä»¶è¡¨ç¤ºçš„å°±æ˜¯å¦‚æœè®¿é—®æ ¹ç›®å½•ä¸‹ä»»ä½•ä¸€ä¸ªèµ„æºå¤±è´¥äº†ï¼Œé‚£ä¹ˆå°±å»è®¿é—® offline.html ã€‚</li></ul><p>ï¼ˆ3ï¼‰åœ¨ç¦»çº¿çŠ¶æ€æ—¶ï¼Œæ“ä½œ <code>window.applicationCache</code> è¿›è¡Œç¦»çº¿ç¼“å­˜çš„æ“ä½œã€‚</p><p><strong>å¦‚ä½•æ›´æ–°ç¼“å­˜ï¼š</strong></p><p>ï¼ˆ1ï¼‰æ›´æ–° manifest æ–‡ä»¶</p><p> ï¼ˆ2ï¼‰é€šè¿‡ javascript æ“ä½œ</p><p> ï¼ˆ3ï¼‰æ¸…é™¤æµè§ˆå™¨ç¼“å­˜</p><p><strong>æ³¨æ„äº‹é¡¹ï¼š</strong></p><p> ï¼ˆ1ï¼‰æµè§ˆå™¨å¯¹ç¼“å­˜æ•°æ®çš„å®¹é‡é™åˆ¶å¯èƒ½ä¸å¤ªä¸€æ ·ï¼ˆæŸäº›æµè§ˆå™¨è®¾ç½®çš„é™åˆ¶æ˜¯æ¯ä¸ªç«™ç‚¹ 5MBï¼‰ã€‚</p><p> ï¼ˆ2ï¼‰å¦‚æœ manifest æ–‡ä»¶ï¼Œæˆ–è€…å†…éƒ¨åˆ—ä¸¾çš„æŸä¸€ä¸ªæ–‡ä»¶ä¸èƒ½æ­£å¸¸ä¸‹è½½ï¼Œæ•´ä¸ªæ›´æ–°è¿‡ç¨‹éƒ½å°†å¤±è´¥ï¼Œæµè§ˆå™¨ç»§ç»­å…¨éƒ¨ä½¿ç”¨è€çš„ç¼“å­˜ã€‚</p><p> ï¼ˆ3ï¼‰å¼•ç”¨ manifest çš„ html å¿…é¡»ä¸ manifest æ–‡ä»¶åŒæºï¼Œåœ¨åŒä¸€ä¸ªåŸŸä¸‹ã€‚</p><p> ï¼ˆ4ï¼‰FALLBACK ä¸­çš„èµ„æºå¿…é¡»å’Œ manifest æ–‡ä»¶åŒæºã€‚</p><p> ï¼ˆ5ï¼‰å½“ä¸€ä¸ªèµ„æºè¢«ç¼“å­˜åï¼Œè¯¥æµè§ˆå™¨ç›´æ¥è¯·æ±‚è¿™ä¸ªç»å¯¹è·¯å¾„ä¹Ÿä¼šè®¿é—®ç¼“å­˜ä¸­çš„èµ„æºã€‚</p><p> ï¼ˆ6ï¼‰ç«™ç‚¹ä¸­çš„å…¶ä»–é¡µé¢å³ä½¿æ²¡æœ‰è®¾ç½® manifest å±æ€§ï¼Œè¯·æ±‚çš„èµ„æºå¦‚æœåœ¨ç¼“å­˜ä¸­ä¹Ÿä»ç¼“å­˜ä¸­è®¿é—®ã€‚</p><p>ï¼ˆ7ï¼‰å½“ manifest æ–‡ä»¶å‘ç”Ÿæ”¹å˜æ—¶ï¼Œèµ„æºè¯·æ±‚æœ¬èº«ä¹Ÿä¼šè§¦å‘æ›´æ–°ã€‚</p><h3 id="11-æµè§ˆå™¨æ˜¯å¦‚ä½•å¯¹-HTML5-çš„ç¦»çº¿å‚¨å­˜èµ„æºè¿›è¡Œç®¡ç†å’ŒåŠ è½½ï¼Ÿ"><a href="#11-æµè§ˆå™¨æ˜¯å¦‚ä½•å¯¹-HTML5-çš„ç¦»çº¿å‚¨å­˜èµ„æºè¿›è¡Œç®¡ç†å’ŒåŠ è½½ï¼Ÿ" class="headerlink" title="11. æµè§ˆå™¨æ˜¯å¦‚ä½•å¯¹ HTML5 çš„ç¦»çº¿å‚¨å­˜èµ„æºè¿›è¡Œç®¡ç†å’ŒåŠ è½½ï¼Ÿ"></a>11. æµè§ˆå™¨æ˜¯å¦‚ä½•å¯¹ HTML5 çš„ç¦»çº¿å‚¨å­˜èµ„æºè¿›è¡Œç®¡ç†å’ŒåŠ è½½ï¼Ÿ</h3><ul><li><strong>åœ¨çº¿çš„æƒ…å†µä¸‹</strong>ï¼Œæµè§ˆå™¨å‘ç° html å¤´éƒ¨æœ‰ manifest å±æ€§ï¼Œå®ƒä¼šè¯·æ±‚ manifest æ–‡ä»¶ï¼Œå¦‚æœæ˜¯ç¬¬ä¸€æ¬¡è®¿é—®é¡µé¢ ï¼Œé‚£ä¹ˆæµè§ˆå™¨å°±ä¼šæ ¹æ® manifest æ–‡ä»¶çš„å†…å®¹ä¸‹è½½ç›¸åº”çš„èµ„æºå¹¶ä¸”è¿›è¡Œç¦»çº¿å­˜å‚¨ã€‚å¦‚æœå·²ç»è®¿é—®è¿‡é¡µé¢å¹¶ä¸”èµ„æºå·²ç»è¿›è¡Œç¦»çº¿å­˜å‚¨äº†ï¼Œé‚£ä¹ˆæµè§ˆå™¨å°±ä¼šä½¿ç”¨ç¦»çº¿çš„èµ„æºåŠ è½½é¡µé¢ï¼Œç„¶åæµè§ˆå™¨ä¼šå¯¹æ¯”æ–°çš„ manifest æ–‡ä»¶ä¸æ—§çš„ manifest æ–‡ä»¶ï¼Œå¦‚æœæ–‡ä»¶æ²¡æœ‰å‘ç”Ÿæ”¹å˜ï¼Œå°±ä¸åšä»»ä½•æ“ä½œï¼Œå¦‚æœæ–‡ä»¶æ”¹å˜äº†ï¼Œå°±ä¼šé‡æ–°ä¸‹è½½æ–‡ä»¶ä¸­çš„èµ„æºå¹¶è¿›è¡Œç¦»çº¿å­˜å‚¨ã€‚</li><li><strong>ç¦»çº¿çš„æƒ…å†µä¸‹</strong>ï¼Œæµè§ˆå™¨ä¼šç›´æ¥ä½¿ç”¨ç¦»çº¿å­˜å‚¨çš„èµ„æºã€‚</li></ul><h3 id="12-titleä¸h1çš„åŒºåˆ«ã€bä¸strongçš„åŒºåˆ«ã€iä¸emçš„åŒºåˆ«ï¼Ÿ"><a href="#12-titleä¸h1çš„åŒºåˆ«ã€bä¸strongçš„åŒºåˆ«ã€iä¸emçš„åŒºåˆ«ï¼Ÿ" class="headerlink" title="12. titleä¸h1çš„åŒºåˆ«ã€bä¸strongçš„åŒºåˆ«ã€iä¸emçš„åŒºåˆ«ï¼Ÿ"></a>12. titleä¸h1çš„åŒºåˆ«ã€bä¸strongçš„åŒºåˆ«ã€iä¸emçš„åŒºåˆ«ï¼Ÿ</h3><ul><li>strongæ ‡ç­¾æœ‰è¯­ä¹‰ï¼Œæ˜¯èµ·åˆ°åŠ é‡è¯­æ°”çš„æ•ˆæœï¼Œè€Œbæ ‡ç­¾æ˜¯æ²¡æœ‰çš„ï¼Œbæ ‡ç­¾åªæ˜¯ä¸€ä¸ªç®€å•åŠ ç²—æ ‡ç­¾ã€‚bæ ‡ç­¾ä¹‹é—´çš„å­—ç¬¦éƒ½è®¾ä¸ºç²—ä½“ï¼Œstrongæ ‡ç­¾åŠ å¼ºå­—ç¬¦çš„è¯­æ°”éƒ½æ˜¯é€šè¿‡ç²—ä½“æ¥å®ç°çš„ï¼Œè€Œæœç´¢å¼•æ“æ›´ä¾§é‡strongæ ‡ç­¾ã€‚</li><li>titleå±æ€§æ²¡æœ‰æ˜ç¡®æ„ä¹‰åªè¡¨ç¤ºæ˜¯ä¸ªæ ‡é¢˜ï¼ŒH1åˆ™è¡¨ç¤ºå±‚æ¬¡æ˜ç¡®çš„æ ‡é¢˜ï¼Œå¯¹é¡µé¢ä¿¡æ¯çš„æŠ“å–æœ‰å¾ˆå¤§çš„å½±å“</li><li><strong>iå†…å®¹å±•ç¤ºä¸ºæ–œä½“ï¼Œemè¡¨ç¤ºå¼ºè°ƒçš„æ–‡æœ¬</strong></li></ul><h3 id="13-iframe-æœ‰é‚£äº›ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ"><a href="#13-iframe-æœ‰é‚£äº›ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ" class="headerlink" title="13. iframe æœ‰é‚£äº›ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ"></a>13. <strong>iframe æœ‰é‚£äº›ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Ÿ</strong></h3><p>iframe å…ƒç´ ä¼šåˆ›å»ºåŒ…å«å¦å¤–ä¸€ä¸ªæ–‡æ¡£çš„å†…è”æ¡†æ¶ï¼ˆå³è¡Œå†…æ¡†æ¶ï¼‰ã€‚</p><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>ç”¨æ¥åŠ è½½é€Ÿåº¦è¾ƒæ…¢çš„å†…å®¹ï¼ˆå¦‚å¹¿å‘Šï¼‰</li><li>å¯ä»¥ä½¿è„šæœ¬å¯ä»¥å¹¶è¡Œä¸‹è½½</li><li>å¯ä»¥å®ç°è·¨å­åŸŸé€šä¿¡</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>iframe ä¼šé˜»å¡ä¸»é¡µé¢çš„ onload äº‹ä»¶</li><li>æ— æ³•è¢«ä¸€äº›æœç´¢å¼•æ“ç´¢è¯†åˆ«</li><li>ä¼šäº§ç”Ÿå¾ˆå¤šé¡µé¢ï¼Œä¸å®¹æ˜“ç®¡ç†</li></ul><h3 id="14-label-çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•ä½¿ç”¨ï¼Ÿ"><a href="#14-label-çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•ä½¿ç”¨ï¼Ÿ" class="headerlink" title="14. label çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•ä½¿ç”¨ï¼Ÿ"></a>14. label çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•ä½¿ç”¨ï¼Ÿ</h3><p>labelæ ‡ç­¾æ¥å®šä¹‰è¡¨å•æ§ä»¶çš„å…³ç³»ï¼šå½“ç”¨æˆ·é€‰æ‹©labelæ ‡ç­¾æ—¶ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨å°†ç„¦ç‚¹è½¬åˆ°å’Œlabelæ ‡ç­¾ç›¸å…³çš„è¡¨å•æ§ä»¶ä¸Šã€‚</p><ul><li>ä½¿ç”¨æ–¹æ³•1ï¼š</li></ul><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mobile<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Number:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mobile<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li>ä½¿ç”¨æ–¹æ³•2ï¼š</li></ul><pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span><span class="token punctuation">></span></span>Date:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="15-Canvaså’ŒSVGçš„åŒºåˆ«"><a href="#15-Canvaså’ŒSVGçš„åŒºåˆ«" class="headerlink" title="15. Canvaså’ŒSVGçš„åŒºåˆ«"></a>15. Canvaså’ŒSVGçš„åŒºåˆ«</h3><p><strong>ï¼ˆ1ï¼‰SVGï¼š</strong><br>SVGå¯ç¼©æ”¾çŸ¢é‡å›¾å½¢ï¼ˆScalable Vector Graphicsï¼‰æ˜¯åŸºäºå¯æ‰©å±•æ ‡è®°è¯­è¨€XMLæè¿°çš„2Då›¾å½¢çš„è¯­è¨€ï¼ŒSVGåŸºäºXMLå°±æ„å‘³ç€SVG DOMä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯å¯ç”¨çš„ï¼Œå¯ä»¥ä¸ºæŸä¸ªå…ƒç´ é™„åŠ Javascriptäº‹ä»¶å¤„ç†å™¨ã€‚åœ¨ SVG ä¸­ï¼Œæ¯ä¸ªè¢«ç»˜åˆ¶çš„å›¾å½¢å‡è¢«è§†ä¸ºå¯¹è±¡ã€‚å¦‚æœ SVG å¯¹è±¡çš„å±æ€§å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆæµè§ˆå™¨èƒ½å¤Ÿè‡ªåŠ¨é‡ç°å›¾å½¢ã€‚</p><p>å…¶ç‰¹ç‚¹å¦‚ä¸‹ï¼š</p><ul><li>ä¸ä¾èµ–åˆ†è¾¨ç‡</li><li>æ”¯æŒäº‹ä»¶å¤„ç†å™¨</li><li>æœ€é€‚åˆå¸¦æœ‰å¤§å‹æ¸²æŸ“åŒºåŸŸçš„åº”ç”¨ç¨‹åºï¼ˆæ¯”å¦‚è°·æ­Œåœ°å›¾ï¼‰</li><li>å¤æ‚åº¦é«˜ä¼šå‡æ…¢æ¸²æŸ“é€Ÿåº¦ï¼ˆä»»ä½•è¿‡åº¦ä½¿ç”¨ DOM çš„åº”ç”¨éƒ½ä¸å¿«ï¼‰</li><li>ä¸é€‚åˆæ¸¸æˆåº”ç”¨</li></ul><p><strong>ï¼ˆ2ï¼‰Canvasï¼š</strong><br>Canvasæ˜¯ç”»å¸ƒï¼Œé€šè¿‡Javascriptæ¥ç»˜åˆ¶2Då›¾å½¢ï¼Œæ˜¯é€åƒç´ è¿›è¡Œæ¸²æŸ“çš„ã€‚å…¶ä½ç½®å‘ç”Ÿæ”¹å˜ï¼Œå°±ä¼šé‡æ–°è¿›è¡Œç»˜åˆ¶ã€‚</p><p>å…¶ç‰¹ç‚¹å¦‚ä¸‹ï¼š</p><ul><li>ä¾èµ–åˆ†è¾¨ç‡</li><li>ä¸æ”¯æŒäº‹ä»¶å¤„ç†å™¨</li><li>å¼±çš„æ–‡æœ¬æ¸²æŸ“èƒ½åŠ›</li><li>èƒ½å¤Ÿä»¥ .png æˆ– .jpg æ ¼å¼ä¿å­˜ç»“æœå›¾åƒ</li><li>æœ€é€‚åˆå›¾åƒå¯†é›†å‹çš„æ¸¸æˆï¼Œå…¶ä¸­çš„è®¸å¤šå¯¹è±¡ä¼šè¢«é¢‘ç¹é‡ç»˜</li></ul><p>æ³¨ï¼šçŸ¢é‡å›¾ï¼Œä¹Ÿç§°ä¸ºé¢å‘å¯¹è±¡çš„å›¾åƒæˆ–ç»˜å›¾å›¾åƒï¼Œåœ¨æ•°å­¦ä¸Šå®šä¹‰ä¸ºä¸€ç³»åˆ—ç”±çº¿è¿æ¥çš„ç‚¹ã€‚çŸ¢é‡æ–‡ä»¶ä¸­çš„å›¾å½¢å…ƒç´ ç§°ä¸ºå¯¹è±¡ã€‚æ¯ä¸ªå¯¹è±¡éƒ½æ˜¯ä¸€ä¸ªè‡ªæˆä¸€ä½“çš„å®ä½“ï¼Œå®ƒå…·æœ‰é¢œè‰²ã€å½¢çŠ¶ã€è½®å»“ã€å¤§å°å’Œå±å¹•ä½ç½®ç­‰å±æ€§ã€‚</p><h3 id="16-head-æ ‡ç­¾æœ‰ä»€ä¹ˆä½œç”¨ï¼Œå…¶ä¸­ä»€ä¹ˆæ ‡ç­¾å¿…ä¸å¯å°‘ï¼Ÿ"><a href="#16-head-æ ‡ç­¾æœ‰ä»€ä¹ˆä½œç”¨ï¼Œå…¶ä¸­ä»€ä¹ˆæ ‡ç­¾å¿…ä¸å¯å°‘ï¼Ÿ" class="headerlink" title="16. head æ ‡ç­¾æœ‰ä»€ä¹ˆä½œç”¨ï¼Œå…¶ä¸­ä»€ä¹ˆæ ‡ç­¾å¿…ä¸å¯å°‘ï¼Ÿ"></a>16. head æ ‡ç­¾æœ‰ä»€ä¹ˆä½œç”¨ï¼Œå…¶ä¸­ä»€ä¹ˆæ ‡ç­¾å¿…ä¸å¯å°‘ï¼Ÿ</h3> æ ‡ç­¾ç”¨äºå®šä¹‰æ–‡æ¡£çš„å¤´éƒ¨ï¼Œå®ƒæ˜¯æ‰€æœ‰å¤´éƒ¨å…ƒç´ çš„å®¹å™¨ã€‚ ä¸­çš„å…ƒç´ å¯ä»¥å¼•ç”¨è„šæœ¬ã€æŒ‡ç¤ºæµè§ˆå™¨åœ¨å“ªé‡Œæ‰¾åˆ°æ ·å¼è¡¨ã€æä¾›å…ƒä¿¡æ¯ç­‰ã€‚<p>æ–‡æ¡£çš„å¤´éƒ¨æè¿°äº†æ–‡æ¡£çš„å„ç§å±æ€§å’Œä¿¡æ¯ï¼ŒåŒ…æ‹¬æ–‡æ¡£çš„æ ‡é¢˜ã€åœ¨ Web ä¸­çš„ä½ç½®ä»¥åŠå’Œå…¶ä»–æ–‡æ¡£çš„å…³ç³»ç­‰ã€‚ç»å¤§å¤šæ•°æ–‡æ¡£å¤´éƒ¨åŒ…å«çš„æ•°æ®éƒ½ä¸ä¼šçœŸæ­£ä½œä¸ºå†…å®¹æ˜¾ç¤ºç»™è¯»è€…ã€‚</p><p>ä¸‹é¢è¿™äº›æ ‡ç­¾å¯ç”¨åœ¨ head éƒ¨åˆ†ï¼š<code>&lt;base&gt;, &lt;link&gt;, &lt;meta&gt;, &lt;script&gt;, &lt;style&gt;, &lt;title&gt;</code>ã€‚ </p><p>å…¶ä¸­ <code>&lt;title&gt;</code> å®šä¹‰æ–‡æ¡£çš„æ ‡é¢˜ï¼Œå®ƒæ˜¯ head éƒ¨åˆ†ä¸­å”¯ä¸€å¿…éœ€çš„å…ƒç´ ã€‚</p><h3 id="17-æ–‡æ¡£å£°æ˜ï¼ˆDoctypeï¼‰å’Œ-lt-Doctype-html-gt-æœ‰ä½•ä½œç”¨-ä¸¥æ ¼æ¨¡å¼ä¸æ··æ‚æ¨¡å¼å¦‚ä½•åŒºåˆ†ï¼Ÿå®ƒä»¬æœ‰ä½•æ„ä¹‰"><a href="#17-æ–‡æ¡£å£°æ˜ï¼ˆDoctypeï¼‰å’Œ-lt-Doctype-html-gt-æœ‰ä½•ä½œç”¨-ä¸¥æ ¼æ¨¡å¼ä¸æ··æ‚æ¨¡å¼å¦‚ä½•åŒºåˆ†ï¼Ÿå®ƒä»¬æœ‰ä½•æ„ä¹‰" class="headerlink" title="17. æ–‡æ¡£å£°æ˜ï¼ˆDoctypeï¼‰å’Œ<!Doctype html>æœ‰ä½•ä½œç”¨? ä¸¥æ ¼æ¨¡å¼ä¸æ··æ‚æ¨¡å¼å¦‚ä½•åŒºåˆ†ï¼Ÿå®ƒä»¬æœ‰ä½•æ„ä¹‰?"></a>17. æ–‡æ¡£å£°æ˜ï¼ˆDoctypeï¼‰å’Œ<code>&lt;!Doctype html&gt;</code>æœ‰ä½•ä½œç”¨? ä¸¥æ ¼æ¨¡å¼ä¸æ··æ‚æ¨¡å¼å¦‚ä½•åŒºåˆ†ï¼Ÿå®ƒä»¬æœ‰ä½•æ„ä¹‰?</h3><p><strong>æ–‡æ¡£å£°æ˜çš„ä½œç”¨ï¼š</strong> æ–‡æ¡£å£°æ˜æ˜¯ä¸ºäº†å‘Šè¯‰æµè§ˆå™¨ï¼Œå½“å‰<code>HTML</code>æ–‡æ¡£ä½¿ç”¨ä»€ä¹ˆç‰ˆæœ¬çš„<code>HTML</code>æ¥å†™çš„ï¼Œè¿™æ ·æµè§ˆå™¨æ‰èƒ½æŒ‰ç…§å£°æ˜çš„ç‰ˆæœ¬æ¥æ­£ç¡®çš„è§£æã€‚</p><p><strong>çš„ä½œç”¨ï¼š</strong><code>&lt;!doctype html&gt;</code> çš„ä½œç”¨å°±æ˜¯è®©æµè§ˆå™¨è¿›å…¥æ ‡å‡†æ¨¡å¼ï¼Œä½¿ç”¨æœ€æ–°çš„ <code>HTML5</code> æ ‡å‡†æ¥è§£ææ¸²æŸ“é¡µé¢ï¼›å¦‚æœä¸å†™ï¼Œæµè§ˆå™¨å°±ä¼šè¿›å…¥æ··æ‚æ¨¡å¼ï¼Œæˆ‘ä»¬éœ€è¦é¿å…æ­¤ç±»æƒ…å†µå‘ç”Ÿã€‚</p><p><strong>ä¸¥æ ¼æ¨¡å¼ä¸æ··æ‚æ¨¡å¼çš„åŒºåˆ†ï¼š</strong></p><ul><li><strong>ä¸¥æ ¼æ¨¡å¼</strong>ï¼š åˆç§°ä¸ºæ ‡å‡†æ¨¡å¼ï¼ŒæŒ‡æµè§ˆå™¨æŒ‰ç…§<code>W3C</code>æ ‡å‡†è§£æä»£ç ï¼›</li><li><strong>æ··æ‚æ¨¡å¼</strong>ï¼š åˆç§°æ€ªå¼‚æ¨¡å¼ã€å…¼å®¹æ¨¡å¼ï¼Œæ˜¯æŒ‡æµè§ˆå™¨ç”¨è‡ªå·±çš„æ–¹å¼è§£æä»£ç ã€‚æ··æ‚æ¨¡å¼é€šå¸¸æ¨¡æ‹Ÿè€å¼æµè§ˆå™¨çš„è¡Œä¸ºï¼Œä»¥é˜²æ­¢è€ç«™ç‚¹æ— æ³•å·¥ä½œï¼›</li></ul><p><strong>åŒºåˆ†</strong>ï¼šç½‘é¡µä¸­çš„<code>DTD</code>ï¼Œç›´æ¥å½±å“åˆ°ä½¿ç”¨çš„æ˜¯ä¸¥æ ¼æ¨¡å¼è¿˜æ˜¯æµè§ˆæ¨¡å¼ï¼Œå¯ä»¥è¯´<code>DTD</code>çš„ä½¿ç”¨ä¸è¿™ä¸¤ç§æ–¹å¼çš„åŒºåˆ«æ¯æ¯ç›¸å…³ã€‚</p><ul><li>å¦‚æœæ–‡æ¡£åŒ…å«ä¸¥æ ¼çš„<code>DOCTYPE</code> ï¼Œé‚£ä¹ˆå®ƒä¸€èˆ¬ä»¥ä¸¥æ ¼æ¨¡å¼å‘ˆç°ï¼ˆ<strong>ä¸¥æ ¼ DTD â€”â€”ä¸¥æ ¼æ¨¡å¼</strong>ï¼‰ï¼›</li><li>åŒ…å«è¿‡æ¸¡ <code>DTD</code> å’Œ <code>URI</code> çš„ <code>DOCTYPE</code> ï¼Œä¹Ÿä»¥ä¸¥æ ¼æ¨¡å¼å‘ˆç°ï¼Œä½†æœ‰è¿‡æ¸¡ <code>DTD</code> è€Œæ²¡æœ‰ <code>URI</code> ï¼ˆç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦ï¼Œå°±æ˜¯å£°æ˜æœ€åçš„åœ°å€ï¼‰ä¼šå¯¼è‡´é¡µé¢ä»¥æ··æ‚æ¨¡å¼å‘ˆç°ï¼ˆ<strong>æœ‰ URI çš„è¿‡æ¸¡ DTD â€”â€”ä¸¥æ ¼æ¨¡å¼ï¼›æ²¡æœ‰ URI çš„è¿‡æ¸¡ DTD â€”â€”æ··æ‚æ¨¡å¼</strong>ï¼‰ï¼›</li><li><code>DOCTYPE</code> ä¸å­˜åœ¨æˆ–å½¢å¼ä¸æ­£ç¡®ä¼šå¯¼è‡´æ–‡æ¡£ä»¥æ··æ‚æ¨¡å¼å‘ˆç°ï¼ˆ<strong>DTDä¸å­˜åœ¨æˆ–è€…æ ¼å¼ä¸æ­£ç¡®â€”â€”æ··æ‚æ¨¡å¼</strong>ï¼‰ï¼›</li><li><code>HTML5</code> æ²¡æœ‰ <code>DTD</code> ï¼Œå› æ­¤ä¹Ÿå°±æ²¡æœ‰ä¸¥æ ¼æ¨¡å¼ä¸æ··æ‚æ¨¡å¼çš„åŒºåˆ«ï¼Œ<code>HTML5</code> æœ‰ç›¸å¯¹å®½æ¾çš„ æ³•ï¼Œå®ç°æ—¶ï¼Œå·²ç»å°½å¯èƒ½å¤§çš„å®ç°äº†å‘åå…¼å®¹(<strong>HTML5 æ²¡æœ‰ä¸¥æ ¼å’Œæ··æ‚ä¹‹åˆ†</strong>)ã€‚</li></ul><p>æ€»ä¹‹ï¼Œ<strong>ä¸¥æ ¼æ¨¡å¼è®©å„ä¸ªæµè§ˆå™¨ç»Ÿä¸€æ‰§è¡Œä¸€å¥—è§„èŒƒå…¼å®¹æ¨¡å¼ä¿è¯äº†æ—§ç½‘ç«™çš„æ­£å¸¸è¿è¡Œã€‚</strong></p><h3 id="18-æµè§ˆå™¨ä¹±ç çš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿ"><a href="#18-æµè§ˆå™¨ä¹±ç çš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿ" class="headerlink" title="18. æµè§ˆå™¨ä¹±ç çš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿ"></a>18. æµè§ˆå™¨ä¹±ç çš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿ</h3><p><strong>äº§ç”Ÿä¹±ç çš„åŸå› ï¼š</strong></p><ul><li>ç½‘é¡µæºä»£ç æ˜¯<code>gbk</code>çš„ç¼–ç ï¼Œè€Œå†…å®¹ä¸­çš„ä¸­æ–‡å­—æ˜¯<code>utf-8</code>ç¼–ç çš„ï¼Œè¿™æ ·æµè§ˆå™¨æ‰“å¼€å³ä¼šå‡ºç°<code>html</code>ä¹±ç ï¼Œåä¹‹ä¹Ÿä¼šå‡ºç°ä¹±ç ï¼›</li><li><code>html</code>ç½‘é¡µç¼–ç æ˜¯<code>gbk</code>ï¼Œè€Œç¨‹åºä»æ•°æ®åº“ä¸­è°ƒå‡ºå‘ˆç°æ˜¯<code>utf-8</code>ç¼–ç çš„å†…å®¹ä¹Ÿä¼šé€ æˆç¼–ç ä¹±ç ï¼›</li><li>æµè§ˆå™¨ä¸èƒ½è‡ªåŠ¨æ£€æµ‹ç½‘é¡µç¼–ç ï¼Œé€ æˆç½‘é¡µä¹±ç ã€‚</li></ul><p><strong>è§£å†³åŠæ³•ï¼š</strong></p><ul><li>ä½¿ç”¨è½¯ä»¶ç¼–è¾‘HTMLç½‘é¡µå†…å®¹ï¼›</li><li>å¦‚æœç½‘é¡µè®¾ç½®ç¼–ç æ˜¯<code>gbk</code>ï¼Œè€Œæ•°æ®åº“å‚¨å­˜æ•°æ®ç¼–ç æ ¼å¼æ˜¯<code>UTF-8</code>ï¼Œæ­¤æ—¶éœ€è¦ç¨‹åºæŸ¥è¯¢æ•°æ®åº“æ•°æ®æ˜¾ç¤ºæ•°æ®å‰è¿›ç¨‹åºè½¬ç ï¼›</li><li>å¦‚æœæµè§ˆå™¨æµè§ˆæ—¶å€™å‡ºç°ç½‘é¡µä¹±ç ï¼Œåœ¨æµè§ˆå™¨ä¸­æ‰¾åˆ°è½¬æ¢ç¼–ç çš„èœå•è¿›è¡Œè½¬æ¢ã€‚</li></ul><h3 id="19-æ¸è¿›å¢å¼ºå’Œä¼˜é›…é™çº§ä¹‹é—´çš„åŒºåˆ«"><a href="#19-æ¸è¿›å¢å¼ºå’Œä¼˜é›…é™çº§ä¹‹é—´çš„åŒºåˆ«" class="headerlink" title="19. æ¸è¿›å¢å¼ºå’Œä¼˜é›…é™çº§ä¹‹é—´çš„åŒºåˆ«"></a>19. æ¸è¿›å¢å¼ºå’Œä¼˜é›…é™çº§ä¹‹é—´çš„åŒºåˆ«</h3><p><strong>ï¼ˆ1ï¼‰æ¸è¿›å¢å¼ºï¼ˆprogressive enhancementï¼‰</strong>ï¼šä¸»è¦æ˜¯é’ˆå¯¹ä½ç‰ˆæœ¬çš„æµè§ˆå™¨è¿›è¡Œé¡µé¢é‡æ„ï¼Œä¿è¯åŸºæœ¬çš„åŠŸèƒ½æƒ…å†µä¸‹ï¼Œå†é’ˆå¯¹é«˜çº§æµè§ˆå™¨è¿›è¡Œæ•ˆæœã€äº¤äº’ç­‰æ–¹é¢çš„æ”¹è¿›å’Œè¿½åŠ åŠŸèƒ½ï¼Œä»¥è¾¾åˆ°æ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚<br><strong>ï¼ˆ2ï¼‰ä¼˜é›…é™çº§ graceful degradation</strong>ï¼š ä¸€å¼€å§‹å°±æ„å»ºå®Œæ•´çš„åŠŸèƒ½ï¼Œç„¶åå†é’ˆå¯¹ä½ç‰ˆæœ¬çš„æµè§ˆå™¨è¿›è¡Œå…¼å®¹ã€‚</p><p><strong>ä¸¤è€…åŒºåˆ«ï¼š</strong></p><ul><li>ä¼˜é›…é™çº§æ˜¯ä»å¤æ‚çš„ç°çŠ¶å¼€å§‹çš„ï¼Œå¹¶è¯•å›¾å‡å°‘ç”¨æˆ·ä½“éªŒçš„ä¾›ç»™ï¼›è€Œæ¸è¿›å¢å¼ºæ˜¯ä»ä¸€ä¸ªéå¸¸åŸºç¡€çš„ï¼Œèƒ½å¤Ÿèµ·ä½œç”¨çš„ç‰ˆæœ¬å¼€å§‹çš„ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šä¸æ–­æ‰©å……ï¼Œä»¥é€‚åº”æœªæ¥ç¯å¢ƒçš„éœ€è¦ï¼›</li><li>é™çº§ï¼ˆåŠŸèƒ½è¡°ç«­ï¼‰æ„å‘³ç€å¾€å›çœ‹ï¼Œè€Œæ¸è¿›å¢å¼ºåˆ™æ„å‘³ç€å¾€å‰çœ‹ï¼ŒåŒæ—¶ä¿è¯å…¶æ ¹åŸºå¤„äºå®‰å…¨åœ°å¸¦ã€‚</li></ul><p>â€œä¼˜é›…é™çº§â€è§‚ç‚¹è®¤ä¸ºåº”è¯¥é’ˆå¯¹é‚£äº›æœ€é«˜çº§ã€æœ€å®Œå–„çš„æµè§ˆå™¨æ¥è®¾è®¡ç½‘ç«™ã€‚è€Œå°†é‚£äº›è¢«è®¤ä¸ºâ€œè¿‡æ—¶â€æˆ–æœ‰åŠŸèƒ½ç¼ºå¤±çš„æµè§ˆå™¨ä¸‹çš„æµ‹è¯•å·¥ä½œå®‰æ’åœ¨å¼€å‘å‘¨æœŸçš„æœ€åé˜¶æ®µï¼Œå¹¶æŠŠæµ‹è¯•å¯¹è±¡é™å®šä¸ºä¸»æµæµè§ˆå™¨ï¼ˆå¦‚ IEã€Mozilla ç­‰ï¼‰çš„å‰ä¸€ä¸ªç‰ˆæœ¬ã€‚ åœ¨è¿™ç§è®¾è®¡èŒƒä¾‹ä¸‹ï¼Œæ—§ç‰ˆçš„æµè§ˆå™¨è¢«è®¤ä¸ºä»…èƒ½æä¾›â€œç®€é™‹å´æ— å¦¨ (poor, but passable)â€ çš„æµè§ˆä½“éªŒã€‚å¯ä»¥åšä¸€äº›å°çš„è°ƒæ•´æ¥é€‚åº”æŸä¸ªç‰¹å®šçš„æµè§ˆå™¨ã€‚ä½†ç”±äºå®ƒä»¬å¹¶éæˆ‘ä»¬æ‰€å…³æ³¨çš„ç„¦ç‚¹ï¼Œå› æ­¤é™¤äº†ä¿®å¤è¾ƒå¤§çš„é”™è¯¯ä¹‹å¤–ï¼Œå…¶å®ƒçš„å·®å¼‚å°†è¢«ç›´æ¥å¿½ç•¥ã€‚ </p><p>â€œæ¸è¿›å¢å¼ºâ€è§‚ç‚¹åˆ™è®¤ä¸ºåº”å…³æ³¨äºå†…å®¹æœ¬èº«ã€‚å†…å®¹æ˜¯å»ºç«‹ç½‘ç«™çš„è¯±å› ï¼Œæœ‰çš„ç½‘ç«™å±•ç¤ºå®ƒï¼Œæœ‰çš„åˆ™æ”¶é›†å®ƒï¼Œæœ‰çš„å¯»æ±‚ï¼Œæœ‰çš„æ“ä½œï¼Œè¿˜æœ‰çš„ç½‘ç«™ç”šè‡³ä¼šåŒ…å«ä»¥ä¸Šçš„ç§ç§ï¼Œä½†ç›¸åŒç‚¹æ˜¯å®ƒä»¬å…¨éƒ½æ¶‰åŠåˆ°å†…å®¹ã€‚è¿™ä½¿å¾—â€œæ¸è¿›å¢å¼ºâ€æˆä¸ºä¸€ç§æ›´ä¸ºåˆç†çš„è®¾è®¡èŒƒä¾‹ã€‚è¿™ä¹Ÿæ˜¯å®ƒç«‹å³è¢« Yahoo æ‰€é‡‡çº³å¹¶ç”¨ä»¥æ„å»ºå…¶â€œåˆ†çº§å¼æµè§ˆå™¨æ”¯æŒ (Graded Browser Support)â€ç­–ç•¥çš„åŸå› æ‰€åœ¨ã€‚ </p><h3 id="20-è¯´ä¸€ä¸‹-HTML5-drag-API"><a href="#20-è¯´ä¸€ä¸‹-HTML5-drag-API" class="headerlink" title="20. è¯´ä¸€ä¸‹ HTML5 drag API"></a>20. è¯´ä¸€ä¸‹ HTML5 drag API</h3><ul><li>dragstartï¼šäº‹ä»¶ä¸»ä½“æ˜¯è¢«æ‹–æ”¾å…ƒç´ ï¼Œåœ¨å¼€å§‹æ‹–æ”¾è¢«æ‹–æ”¾å…ƒç´ æ—¶è§¦å‘ã€‚ </li><li>dargï¼šäº‹ä»¶ä¸»ä½“æ˜¯è¢«æ‹–æ”¾å…ƒç´ ï¼Œåœ¨æ­£åœ¨æ‹–æ”¾è¢«æ‹–æ”¾å…ƒç´ æ—¶è§¦å‘ã€‚ </li><li>dragenterï¼šäº‹ä»¶ä¸»ä½“æ˜¯ç›®æ ‡å…ƒç´ ï¼Œåœ¨è¢«æ‹–æ”¾å…ƒç´ è¿›å…¥æŸå…ƒç´ æ—¶è§¦å‘ã€‚ </li><li>dragoverï¼šäº‹ä»¶ä¸»ä½“æ˜¯ç›®æ ‡å…ƒç´ ï¼Œåœ¨è¢«æ‹–æ”¾åœ¨æŸå…ƒç´ å†…ç§»åŠ¨æ—¶è§¦å‘ã€‚ </li><li>dragleaveï¼šäº‹ä»¶ä¸»ä½“æ˜¯ç›®æ ‡å…ƒç´ ï¼Œåœ¨è¢«æ‹–æ”¾å…ƒç´ ç§»å‡ºç›®æ ‡å…ƒç´ æ˜¯è§¦å‘ã€‚ </li><li>dropï¼šäº‹ä»¶ä¸»ä½“æ˜¯ç›®æ ‡å…ƒç´ ï¼Œåœ¨ç›®æ ‡å…ƒç´ å®Œå…¨æ¥å—è¢«æ‹–æ”¾å…ƒç´ æ—¶è§¦å‘ã€‚ </li><li>dragendï¼šäº‹ä»¶ä¸»ä½“æ˜¯è¢«æ‹–æ”¾å…ƒç´ ï¼Œåœ¨æ•´ä¸ªæ‹–æ”¾æ“ä½œç»“æŸæ—¶è§¦å‘ã€‚</li></ul><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      <categories>
          
          <category> HTML </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Github </tag>
            
            <tag> åšå®¢ </tag>
            
            <tag> HTML </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
